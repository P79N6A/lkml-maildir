Date: Thu, 8 Jan 2009 10:30:52 -0500 (EST)
From: Steven Rostedt <>
Subject: Re: [PATCH -v7][RFC]: mutex: implement adaptive spinning
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2009/1/8/201

On Thu, 8 Jan 2009, Steven Rostedt wrote:
> > > > +	/*
> > > > +	 * We need to validate that we can do a
> > > > +	 * get_cpu() and that we have the percpu area.
> > > > +	 */
> > > > +	if (!cpu_online(cpu))
> > > > +		goto out;
> > > 
> > > Should we need to do a "get_cpu" or something? Couldn't the CPU disappear 
> > > between these two calls. Or does it do a stop-machine and the preempt 
> > > disable will protect us?
> > 
> > Did you miss the preempt_disable() a bit up?
> 
> No, let me rephrase it better. Does the preempt_disable protect against
> another CPU from going off line? Does taking a CPU off line do a 
> stop_machine?
I just looked at the cpu hotplug code, and it does call stop machine. All 
is in order ;-)
-- Steve