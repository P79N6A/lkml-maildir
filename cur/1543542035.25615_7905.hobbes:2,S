Date: Tue, 22 Aug 2000 12:35:35 +0100 (BST)
From: Tigran Aivazian <>
Subject: DEC21150 bridge and unsupported 3COM NIC
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2000/8/22/56

Hi guys,
Let's have a look at what's going on with the DEC21150 bridge, this is on
2.4 TODO list.
Have a look at this lspci -tv output, obtained under 2.2.x:
-+-[20]---00.0  3Com Corporation: Unknown device 5257
 \-[00]-+-00.0  Intel Corporation 440BX/ZX - 82443BX/ZX Host bridge
        +-01.0-[01]----00.0  ATI Technologies Inc 3D Rage P/M Mobility AGP 2x
        +-03.0  Texas Instruments PCI1225
        +-03.1  Texas Instruments PCI1225
        +-07.0  Intel Corporation 82371AB PIIX4 ISA
        +-07.1  Intel Corporation 82371AB PIIX4 IDE
        +-07.2  Intel Corporation 82371AB PIIX4 USB
        +-07.3  Intel Corporation 82371AB PIIX4 ACPI
        +-08.0  ESS Technology ES1978 Maestro 2E
        \-11.0-[02]--+-05.0  CMD Technology Inc PCI0646
                     +-07.0  Adaptec AIC-7880U
                     \-08.0  3Com Corporation 3c905C-TX [Fast Etherlink]
And this obtained under 2.4.x:
-[00]-+-00.0  Intel Corporation 440BX/ZX - 82443BX/ZX Host bridge
      +-01.0-[01]----00.0  ATI Technologies Inc 3D Rage P/M Mobility AGP 2x
      +-03.0  Texas Instruments PCI1225
      +-03.1  Texas Instruments PCI1225
      +-07.0  Intel Corporation 82371AB PIIX4 ISA
      +-07.1  Intel Corporation 82371AB PIIX4 IDE
      +-07.2  Intel Corporation 82371AB PIIX4 USB
      +-07.3  Intel Corporation 82371AB PIIX4 ACPI
      +-08.0  ESS Technology ES1978 Maestro 2E
      \-11.0-[02]----00.0  3Com Corporation: Unknown device 5257
So, under 2.2.x the PCMCIA 3c905C-TX appears as if it was on the docking 
station, i.e. on the same PCI bus as Adaptec SCSI HBA. But on 2.2.x I don't
even see the 905 but the driver (3c59x) sees it and works just fine.
This is extremely strange.
Also, what about the "unknown 3COM 5257 device" - the one on the docking
station - is someone working on the driver? The existing drivers don't seem
to support it.
Regards,
Tigran
Here is entire lspci -vvx for completeness.
00:00.0 Host bridge: Intel Corporation 440BX/ZX - 82443BX/ZX Host bridge (rev 03)
	Control: I/O- Mem+ BusMaster+ SpecCycle- MemWINV- VGASnoop- ParErr- Stepping- SERR+ FastB2B-
	Status: Cap+ 66Mhz- UDF- FastB2B- ParErr- DEVSEL=medium >TAbort- <TAbort- <MAbort+ >SERR- <PERR-
	Latency: 32 set
	Region 0: Memory at f0000000 (32-bit, prefetchable)
	Capabilities: [a0] AGP version 1.0
		Status: RQ=31 SBA+ 64bit- FW- Rate=x1,x2
		Command: RQ=0 SBA- AGP- 64bit- FW- Rate=<none>
00: 86 80 90 71 06 01 10 22 03 00 00 06 00 20 00 00
10: 08 00 00 f0 00 00 00 00 00 00 00 00 00 00 00 00
20: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
30: 00 00 00 00 a0 00 00 00 00 00 00 00 00 00 00 00
00:01.0 PCI bridge: Intel Corporation 440BX/ZX - 82443BX/ZX AGP bridge (rev 03) (prog-if 00 [Normal decode])
	Control: I/O+ Mem+ BusMaster+ SpecCycle+ MemWINV+ VGASnoop- ParErr- Stepping- SERR+ FastB2B-
	Status: Cap- 66Mhz+ UDF- FastB2B- ParErr- DEVSEL=medium >TAbort- <TAbort- <MAbort- >SERR- <PERR-
	Latency: 32 set
	Bus: primary=00, secondary=01, subordinate=01, sec-latency=32
	I/O behind bridge: 0000e000-0000efff
	Memory behind bridge: fc000000-feffffff
	Prefetchable memory behind bridge: f6000000-f6ffffff
	BridgeCtl: Parity- SERR- NoISA+ VGA+ MAbort- >Reset- FastB2B+
00: 86 80 91 71 1f 01 20 02 03 00 04 06 00 20 01 00
10: 00 00 00 00 00 00 00 00 00 01 01 20 e0 e0 a0 22
20: 00 fc f0 fe 00 f6 f0 f6 00 00 00 00 00 00 00 00
30: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 8c 00
00:03.0 CardBus bridge: Texas Instruments PCI1225 (rev 01)
	Subsystem: Dell Computer Corporation: Unknown device 00aa
	Control: I/O+ Mem+ BusMaster+ SpecCycle- MemWINV- VGASnoop- ParErr- Stepping- SERR- FastB2B-
	Status: Cap+ 66Mhz- UDF- FastB2B- ParErr- DEVSEL=medium >TAbort- <TAbort- <MAbort- >SERR- <PERR-
	Latency: 32 set, cache line size 08
	Interrupt: pin A routed to IRQ 0
	Region 0: Memory at <ignored> (32-bit, non-prefetchable)
	Bus: primary=00, secondary=20, subordinate=22, sec-latency=32
	Memory window 0: 60000000-60021000 (prefetchable)
	I/O window 0: 00000200-0000027f
	I/O window 1: 00000000-00000003
	BridgeCtl: Parity- SERR- ISA- VGA- MAbort- >Reset- 16bInt+ PostWrite+
	16-bit legacy interface ports at 0001
00: 4c 10 1c ac 07 00 10 02 01 00 07 06 08 20 82 00
10: 00 00 00 68 a0 00 00 02 00 20 22 20 00 00 00 60
20: 00 10 02 60 00 00 00 00 00 00 00 00 00 02 00 00
30: 7c 02 00 00 00 00 00 00 00 00 00 00 0b 01 80 07
40: 28 10 aa 00 01 00 00 00 00 00 00 00 00 00 00 00
50: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
60: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
70: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
00:03.1 CardBus bridge: Texas Instruments PCI1225 (rev 01)
	Subsystem: Dell Computer Corporation: Unknown device 00aa
	Control: I/O+ Mem+ BusMaster+ SpecCycle- MemWINV- VGASnoop- ParErr- Stepping- SERR- FastB2B-
	Status: Cap+ 66Mhz- UDF- FastB2B- ParErr- DEVSEL=medium >TAbort- <TAbort- <MAbort- >SERR- <PERR-
	Latency: 32 set, cache line size 08
	Interrupt: pin A routed to IRQ 0
	Region 0: Memory at <ignored> (32-bit, non-prefetchable)
	Bus: primary=00, secondary=23, subordinate=25, sec-latency=32
	I/O window 0: 00000000-00000003
	I/O window 1: 00000000-00000003
	BridgeCtl: Parity- SERR- ISA- VGA- MAbort- >Reset+ 16bInt+ PostWrite+
	16-bit legacy interface ports at 0001
00: 4c 10 1c ac 07 00 10 02 01 00 07 06 08 20 82 00
10: 00 10 00 68 a0 00 00 02 00 23 25 20 00 00 00 00
20: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
30: 00 00 00 00 00 00 00 00 00 00 00 00 0b 01 c0 07
40: 28 10 aa 00 01 00 00 00 00 00 00 00 00 00 00 00
50: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
60: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
70: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
00:07.0 Bridge: Intel Corporation 82371AB PIIX4 ISA (rev 02)
	Control: I/O+ Mem+ BusMaster+ SpecCycle+ MemWINV- VGASnoop- ParErr- Stepping- SERR+ FastB2B-
	Status: Cap- 66Mhz- UDF- FastB2B+ ParErr- DEVSEL=medium >TAbort- <TAbort- <MAbort- >SERR- <PERR-
	Latency: 0 set
00: 86 80 10 71 0f 01 80 02 02 00 80 06 00 00 80 00
10: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
20: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
30: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
00:07.1 IDE interface: Intel Corporation 82371AB PIIX4 IDE (rev 01) (prog-if 80 [Master])
	Control: I/O+ Mem- BusMaster+ SpecCycle- MemWINV- VGASnoop- ParErr- Stepping- SERR- FastB2B-
	Status: Cap- 66Mhz- UDF- FastB2B+ ParErr- DEVSEL=medium >TAbort- <TAbort- <MAbort- >SERR- <PERR-
	Latency: 32 set
	Region 4: I/O ports at 0860
00: 86 80 11 71 05 00 80 02 01 80 01 01 00 20 00 00
10: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
20: 61 08 00 00 00 00 00 00 00 00 00 00 00 00 00 00
30: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
00:07.2 USB Controller: Intel Corporation 82371AB PIIX4 USB (rev 01) (prog-if 00 [UHCI])
	Control: I/O+ Mem- BusMaster+ SpecCycle- MemWINV- VGASnoop- ParErr- Stepping- SERR- FastB2B-
	Status: Cap- 66Mhz- UDF- FastB2B+ ParErr- DEVSEL=medium >TAbort- <TAbort- <MAbort- >SERR- <PERR-
	Latency: 32 set
	Interrupt: pin D routed to IRQ 11
	Region 4: I/O ports at dce0
00: 86 80 12 71 05 00 80 02 01 00 03 0c 00 20 00 00
10: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
20: e1 dc 00 00 00 00 00 00 00 00 00 00 00 00 00 00
30: 00 00 00 00 00 00 00 00 00 00 00 00 0b 04 00 00
00:07.3 Bridge: Intel Corporation 82371AB PIIX4 ACPI (rev 03)
	Control: I/O+ Mem+ BusMaster- SpecCycle- MemWINV- VGASnoop- ParErr- Stepping- SERR- FastB2B-
	Status: Cap- 66Mhz- UDF- FastB2B+ ParErr- DEVSEL=medium >TAbort- <TAbort- <MAbort- >SERR- <PERR-
00: 86 80 13 71 03 00 80 02 03 00 80 06 00 00 00 00
10: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
20: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
30: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
00:08.0 Multimedia audio controller: ESS Technology ES1978 Maestro 2E (rev 10)
	Subsystem: Dell Computer Corporation: Unknown device 00aa
	Control: I/O+ Mem- BusMaster+ SpecCycle- MemWINV- VGASnoop- ParErr- Stepping- SERR- FastB2B-
	Status: Cap+ 66Mhz- UDF- FastB2B+ ParErr- DEVSEL=medium >TAbort- <TAbort- <MAbort- >SERR- <PERR-
	Latency: 2 min, 24 max, 32 set
	Interrupt: pin A routed to IRQ 5
	Region 0: I/O ports at d800
	Capabilities: [c0] Power Management version 2
		Flags: PMEClk- AuxPwr- DSI+ D1+ D2+ PME-
		Status: D0 PME-Enable- DSel=0 DScale=0 PME-
00: 5d 12 78 19 05 00 90 02 10 00 01 04 00 20 00 00
10: 01 d8 00 00 00 00 00 00 00 00 00 00 00 00 00 00
20: 00 00 00 00 00 00 00 00 00 00 00 00 28 10 aa 00
30: 00 00 00 00 c0 00 00 00 00 00 00 00 05 01 02 18
00:11.0 PCI bridge: Digital Equipment Corporation DECchip 21150 (rev 04) (prog-if 00 [Normal decode])
	Control: I/O+ Mem+ BusMaster+ SpecCycle- MemWINV- VGASnoop- ParErr- Stepping- SERR+ FastB2B-
	Status: Cap+ 66Mhz- UDF- FastB2B+ ParErr- DEVSEL=medium >TAbort- <TAbort- <MAbort- >SERR- <PERR-
	Latency: 32 set, cache line size 08
	Bus: primary=00, secondary=02, subordinate=02, sec-latency=32
	I/O behind bridge: 0000f000-0000ffff
	Memory behind bridge: fa000000-fbffffff
	Prefetchable memory behind bridge: 00000000f5000000-00000000f5f00000
	BridgeCtl: Parity- SERR+ NoISA+ VGA- MAbort- >Reset- FastB2B-
	Capabilities: [dc] Power Management version 1
		Flags: PMEClk- AuxPwr- DSI- D1- D2- PME-
		Status: D0 PME-Enable- DSel=0 DScale=0 PME-
00: 11 10 22 00 07 01 90 02 04 00 04 06 08 20 01 00
10: 00 00 00 00 00 00 00 00 00 02 02 20 f1 f1 80 22
20: 00 fa f0 fb 01 f5 f1 f5 00 00 00 00 00 00 00 00
30: 00 00 00 00 dc 00 00 00 00 00 00 00 00 00 06 02
01:00.0 VGA compatible controller: ATI Technologies Inc 3D Rage P/M Mobility AGP 2x (rev 64) (prog-if 00 [VGA])
	Subsystem: Dell Computer Corporation: Unknown device 00aa
	Control: I/O+ Mem+ BusMaster+ SpecCycle- MemWINV- VGASnoop- ParErr- Stepping+ SERR- FastB2B-
	Status: Cap+ 66Mhz- UDF- FastB2B+ ParErr- DEVSEL=medium >TAbort- <TAbort- <MAbort- >SERR- <PERR-
	Latency: 8 min, 32 set, cache line size 08
	Interrupt: pin A routed to IRQ 11
	Region 0: Memory at fd000000 (32-bit, non-prefetchable)
	Region 1: I/O ports at ec00
	Region 2: Memory at fcfff000 (32-bit, non-prefetchable)
	Capabilities: [50] AGP version 1.0
		Status: RQ=255 SBA+ 64bit- FW- Rate=x1,x2
		Command: RQ=0 SBA- AGP- 64bit- FW- Rate=<none>
	Capabilities: [5c] Power Management version 1
		Flags: PMEClk- AuxPwr- DSI- D1+ D2+ PME-
		Status: D0 PME-Enable- DSel=0 DScale=0 PME-
00: 02 10 4d 4c 87 00 90 02 64 00 00 03 08 20 00 00
10: 00 00 00 fd 01 ec 00 00 00 f0 ff fc 00 00 00 00
20: 00 00 00 00 00 00 00 00 00 00 00 00 28 10 aa 00
30: 00 00 00 00 50 00 00 00 00 00 00 00 0b 01 08 00
02:05.0 IDE interface: CMD Technology Inc PCI0646 (rev 07) (prog-if 8f [Master SecP SecO PriP PriO])
	Subsystem: CMD Technology Inc: Unknown device 0646
	Control: I/O+ Mem- BusMaster+ SpecCycle- MemWINV- VGASnoop- ParErr- Stepping- SERR- FastB2B-
	Status: Cap+ 66Mhz- UDF- FastB2B+ ParErr- DEVSEL=medium >TAbort- <TAbort- <MAbort- >SERR- <PERR-
	Latency: 2 min, 4 max, 32 set
	Interrupt: pin A routed to IRQ 10
	Region 0: I/O ports at fcf8
	Region 1: I/O ports at fcf0
	Region 2: I/O ports at fce0
	Region 3: I/O ports at fcd8
	Region 4: I/O ports at fcc0
	Capabilities: [60] Power Management version 1
		Flags: PMEClk- AuxPwr- DSI+ D1+ D2+ PME-
		Status: D0 PME-Enable- DSel=0 DScale=3 PME-
00: 95 10 46 06 05 00 90 02 07 8f 01 01 00 20 00 00
10: f9 fc 00 00 f1 fc 00 00 e1 fc 00 00 d9 fc 00 00
20: c1 fc 00 00 00 00 00 00 00 00 00 00 95 10 46 06
30: 00 00 00 00 60 00 00 00 00 00 00 00 0a 01 02 04
02:07.0 SCSI storage controller: Adaptec AIC-7880U (rev 01)
	Subsystem: Adaptec: Unknown device 7880
	Control: I/O+ Mem+ BusMaster+ SpecCycle- MemWINV- VGASnoop- ParErr- Stepping- SERR- FastB2B-
	Status: Cap+ 66Mhz- UDF- FastB2B+ ParErr- DEVSEL=medium >TAbort- <TAbort- <MAbort- >SERR- <PERR-
	Latency: 8 min, 8 max, 32 set, cache line size 08
	Interrupt: pin A routed to IRQ 10
	Region 0: I/O ports at f800
	Region 1: Memory at fafff000 (32-bit, non-prefetchable)
	Expansion ROM at fb000000 [disabled]
	Capabilities: [dc] Power Management version 1
		Flags: PMEClk- AuxPwr- DSI+ D1- D2- PME-
		Status: D0 PME-Enable- DSel=0 DScale=0 PME-
00: 04 90 78 80 07 00 90 02 01 00 00 01 08 20 00 00
10: 01 f8 00 00 00 f0 ff fa 00 00 00 00 00 00 00 00
20: 00 00 00 00 00 00 00 00 00 00 00 00 04 90 80 78
30: 00 00 00 fb dc 00 00 00 00 00 00 00 0a 01 08 08
02:08.0 Ethernet controller: 3Com Corporation 3c905C-TX [Fast Etherlink] (rev 6c)
	Subsystem: Dell Computer Corporation: Unknown device 00a8
	Control: I/O+ Mem+ BusMaster+ SpecCycle- MemWINV+ VGASnoop- ParErr- Stepping- SERR+ FastB2B-
	Status: Cap+ 66Mhz- UDF- FastB2B- ParErr- DEVSEL=medium >TAbort- <TAbort- <MAbort- >SERR- <PERR-
	Latency: 10 min, 10 max, 32 set, cache line size 08
	Interrupt: pin A routed to IRQ 10
	Region 0: I/O ports at fc00
	Region 1: Memory at faffec00 (32-bit, non-prefetchable)
	Expansion ROM at fb000000 [disabled]
	Capabilities: [dc] Power Management version 2
		Flags: PMEClk- AuxPwr- DSI- D1+ D2+ PME+
		Status: D0 PME-Enable+ DSel=0 DScale=2 PME-
00: b7 10 00 92 17 01 10 02 6c 00 00 02 08 20 00 00
10: 01 fc 00 00 00 ec ff fa 00 00 00 00 00 00 00 00
20: 00 00 00 00 00 00 00 00 00 00 00 00 28 10 a8 00
30: 00 00 00 fb dc 00 00 00 00 00 00 00 0a 01 0a 0a
20:00.0 Ethernet controller: 3Com Corporation: Unknown device 5257 (rev 10)
	Subsystem: 3Com Corporation: Unknown device 5c57
	Control: I/O+ Mem+ BusMaster+ SpecCycle- MemWINV- VGASnoop- ParErr- Stepping- SERR- FastB2B-
	Status: Cap+ 66Mhz- UDF- FastB2B- ParErr- DEVSEL=medium >TAbort- <TAbort- <MAbort- >SERR- <PERR-
	Latency: 10 min, 5 max, 0 set, cache line size 08
	Interrupt: pin A routed to IRQ 3
	Region 0: I/O ports at 0200
	Region 1: Memory at 60021000 (32-bit, non-prefetchable)
	Region 2: Memory at 60020000 (32-bit, non-prefetchable)
	Expansion ROM at 60000000 [disabled]
	Capabilities: [50] Power Management version 1
		Flags: PMEClk- AuxPwr+ DSI- D1+ D2+ PME-
		Status: D0 PME-Enable- DSel=0 DScale=1 PME-
00: b7 10 57 52 07 00 10 02 10 00 00 02 08 00 00 00
10: 01 02 00 00 00 10 02 60 00 00 02 60 00 00 00 00
20: 00 00 00 00 00 00 00 00 90 00 00 00 b7 10 57 5c
30: 01 00 00 60 50 00 00 00 00 00 00 00 03 01 0a 05
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.kernel.org
Please read the FAQ at 
http://www.tux.org/lkml/