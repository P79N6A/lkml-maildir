Date: 15 Jan 00 21:55:26 GMT
From: (Tom Crane)
Subject: Re: [2.3.3x] ALI M15x3 chipset support (EXPERIMENTAL)
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2000/1/16/86

In article <fa.in6m4av.u5iq9d@ifi.uio.no>, Andrzej Krzysztofowicz <ankry@green.mif.pg.gda.pl> writes:
Hi,
>> >From dmesg I have,
>> 
>> ALI15X3: MultiWord DMA enabled
>> hda: Maxtor 90680D4, 2014MB w/256kB Cache, CHS=826/255/63, (U)DMA
>                                                              ^^^^
> This means that kernel decides your chipset is not UDMA capable, while the
> drive is...
> 
> Note, that driver author (from ALI) suggested that for M5229 rev. <= 0x20
> UDMA is "not stable", so it should be disabled by the driver...
Thanks for pointing this out. Do you know what the upgrade possibilities 
to a later rev. are? I could not find any useful info on Ali's website. Is
the rev. 0x20 code h/w or firmware in the chip? If f/w can it be upgraded?
Does anybody know the nature of the 'instability' ? 
> I observe, that for many BIOSes timings are calculated basing on maximum
> possible PCI clock (42.5 MHz ?) rather than on currently being set one.
> It effects in a bit worse transfer results. To test it you can try:
> 
> 1. put the idebus=... parameter to the kernel during boot
>    (I use idebus=30, as set on my MoBo)
> 2. hdparm -d0 ...
> 3. hdpatm -p ...        # calculate new timings
> 4. hdparm -X34 ...
> 5. hdparm -d1 ...
> 
> Difference shouldn't be meaningfull, but results slightly better.
I hope to try this once I have backed-up my root HD. I'm puzzled by the
argument to idebus. Where do you get the 30 from? I cannot find any
mention of ide bus speeds in my MB manual. It just says it supports 'bus
master ide dma 33MHz/sec'... 
On a related issue: I find kernel 2.3.37 which I am running at the moment
does not report the "ide: Assuming xxMHz system bus speed..." at all.
Previously I was running 2.3.24 which did report 40MHz assumed speed. I
did a quick grep of the two sources and the routines for this in
drivers/block/{ide.c,ali15x3.c} are the same. Any idea whats going on? 
Regards
Tom.
-- 
Tom Crane, Dept. Physics, Royal Holloway, University of London, Egham Hill,
Egham, Surrey, TW20 0EX, England. 
Email:	uhap023@vms.rhbnc.ac.uk
SPAN:   19.875
Fax:    01784 472794
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.rutgers.edu
Please read the FAQ at 
http://www.tux.org/lkml/