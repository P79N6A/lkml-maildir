Date: Mon, 08 May 2006 23:57:54 +0200
From: Matthieu CASTET <>
Subject: Re: libata PATA patch update
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2006/5/8/189

Hi Alan,
Le Mon, 08 May 2006 17:06:40 +0100, Alan Cox a écrit :
> I've posted a new patch versus 2.6.17-rc3 up at the usual location.
> 
> 
http://zeniv.linux.org.uk/~alan/IDE
> 
Aren't there a bug in via cable detect ?
The via ide driver do
pci_read_config_dword(dev, VIA_UDMA_TIMING, &u);
for (i = 24; i >= 0; i -= 8)
                                if (((u >> i) & 0x10) ||
                                    (((u >> i) & 0x20) &&
                                     (((u >> i) & 7) < 6))) {
                                        /* BIOS 80-wire bit or
                                         * UDMA w/ < 60ns/cycle
                                         */
                                        vdev->via_80w |= (1 << (1 - (i >> 4)));
                                }
80w = (vdev->via_80w >> hwif->channel) & 1;
upper bit are for channel 0 and lower bit for channel 1.
the pata driver do
pci_read_config_dword(pdev, 0x50, &ata66);
80w = ata66 & (0x1010 << (16 * ap->hard_port_no))
upper bit are for channel 1 and lower bit for channel 0.
at boot VIA_UDMA_TIMING is 0xf1f1e6e6 for a 80w cable on channel 0 and 40w
cable on channel 1.
Pata driver set my UDMA100 disk at UDMA33.
Matthieu.
PS : any idea in order to allow to work my cdrw drive, that don't return
interrupt when setting xfermode ?
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.kernel.org
More majordomo info at  
http://vger.kernel.org/majordomo-info.html
Please read the FAQ at  
http://www.tux.org/lkml/