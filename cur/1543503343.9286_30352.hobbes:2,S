Date: Tue, 20 Jul 1999 12:15:18 +0200
From: Kurt Garloff <>
Subject: Re: SMP compile problem in locks....
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/1999/7/20/27

On Mon, Jul 19, 1999 at 05:41:30PM -0700, Raj, Ashok wrote:
> Hello.
> 
> Iam trying to compile my module for SMP support but having problems with
> some comile flags.
> 
> iam defining __SMP__ is there something else i need to define?
> 
> iam seeing NO_PROC_ID, current undefined...
> 
> am i missing any switches?
Try the options the kernel uses:
gcc -D__KERNEL__ -I/usr/src/linux/include  -Wall -Wstrict-prototypes -O2
 -fomit-frame-pointer -pipe -fno-strength-reduce -m486 -DCPU=486
 -DMODULE -D__SMP__ -c YOURMODULE.c -o YOURMODULE.o
You may use -fschedule-insns2 -mpentiumpro -DCPU=686 instead of
-fno-strength-.... if compiling a 2.2 kernel for 686 with egcs-1.1.x
In 2.2, your the kernel configuration now includes the SMP switch:
CONFIG_SMP, but you still should use -D__SMP__
Regards,
-- 
Kurt Garloff  <garloff@suse.de>           SuSE GmbH, NÃ¼rnberg, FRG
Linux kernel development;      SCSI drivers: tmscsim(DC390), DC395
[unhandled content-type:application/pgp-signature]