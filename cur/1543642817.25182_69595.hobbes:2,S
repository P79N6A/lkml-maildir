Date: Tue, 10 Sep 2002 09:43:20 -0500
From: "Cameron, Steve" <>
Subject: RE: [RFC] Multi-path IO in 2.5/2.6 ?
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2002/9/10/7

Alan Cox wrote:
> On Tue, 2002-09-10 at 15:06, Cameron, Steve wrote:
> > We can use the md driver for this.  However, we cannot boot from
> > such a multipath device.  Lilo and grub do not understand md multipath
> > devices, nor do anaconda or other installers.  (Enhancing all of those,
> > I'd like to avoid.  Cramming multipath i/o into the low level driver
> > would accomplish that, but, too yucky.) 
> > 
> > If there is work going on to enhance the multipath support in linux
> > it would be nice if you could boot from and install to such devices.
> 
> Booting from them is a BIOS matter. If the BIOS can do the block loads
> off the multipath device we can do the rest. The probe stuff 
> can be done
> in the boot initrd - as some vendors handle raid for example.
Well, the BIOS can do it if it has one working path, right?
(I think the md information is at the end of the partition,)
Maybe it will have some trouble if the primary path is failed,
but ignoring that for now.  In the normal case, the bios shouldn't
even have to know it's a multipath device, right?
lilo and grub as they stand today, and anaconda (et al) as it 
stands today, cannot do it.  They can do RAID1 md devices only.  
lilo for example will complain if you try to run it with 
boot=/dev/md0, and /dev/md0 is not a RAID1 device.   At least 
it did when I tried it.  When I looked at the lilo source, it
goes through each disk in the raid device and puts the boot 
code on each one, a la RAID1.  No provision is made for any other
kind of raid.  Raid 5, naturally is much harder, and is unlikely
to have BIOS support, so this is understandable.  Multipath seems
much closer to raid1 in terms of what's necessary for booting,
that is, much much easier than raid 5.  I tried hacking on lilo a
bit, but so far, I am unsuccessful.  I think grub cannot even do
RAID1.
I agree in principle, the initrd scripts can insmod multipath.o
to get things rolling, etc.  The trouble comes from lilo, grub 
and install time configuration.
-- steve
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.kernel.org
More majordomo info at  
http://vger.kernel.org/majordomo-info.html
Please read the FAQ at  
http://www.tux.org/lkml/