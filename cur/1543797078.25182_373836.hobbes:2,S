Date: Wed, 07 Dec 2005 09:11:07 -0500
From: Trond Myklebust <>
Subject: Re: another nfs puzzle
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2005/12/7/134

On Wed, 2005-12-07 at 09:01 -0500, Peter Staubach wrote:
> Kenny Simpson wrote:
> 
> >Hi again,
> >  I am seeing some odd behavior with O_DIRECT.  If a file opened with O_DIRECT has a page mmap'd,
> >and the file is extended via pwrite, then the mmap'd region seems to get lost - i.e. it neither
> >takes up system memory, nor does it get written out.
> > 
> >
> 
> I don't think that I understand why or how the kernel allows a file,
> which was opened with O_DIRECT, to be mmap'd.  The use of O_DIRECT
> implies no caching and mmap implies the use of caching.
In this context it doesn't matter whether or not the you use the same
file descriptor. The problem is the same if my process opens the file
for O_DIRECT and then your process open it for normal I/O, and mmaps it.
Cheers,
  Trond
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.kernel.org
More majordomo info at  
http://vger.kernel.org/majordomo-info.html
Please read the FAQ at  
http://www.tux.org/lkml/