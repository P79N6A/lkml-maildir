Date: Sat, 16 Feb 2008 12:36:10 +0100
From: Sam Ravnborg <>
Subject: Re: 2.6.25-rc2 vdso_install breaks user "make install"
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2008/2/16/73

On Fri, Feb 15, 2008 at 07:42:11PM -0800, Roland McGrath wrote:
> Perhaps it makes more sense to have vdso_install be a dependency of
> modules_install rather than install, since they both put things in /lib/modules.
> The installed vdso images are potentially useful for a kernel when you
> aren't bothering to build or install any modules, but those images are only
> ever useful for sophisticated debugging uses anyway.
> 
> Sam, any thoughts?  (See arch/x86/Makefile and arch/powerpc/Makefile.)
Installing the vdso files as aprt of modules_install would be
unintuitive as this has nothing to do with modules.
And since you wrote:
> useful for sophisticated debugging uses anyway
I suggest to make the vdso_install step independent as
in following patch.
[Note: help docs needs to mention the new target].
This solves the issue at ahnd and still gives us the posibility
to install the files should they be needed.
	Sam
diff --git a/arch/powerpc/Makefile b/arch/powerpc/Makefile
index 6845482..1c6ce35 100644
--- a/arch/powerpc/Makefile
+++ b/arch/powerpc/Makefile
@@ -176,7 +176,7 @@ define archhelp
   @echo '  *_defconfig     - Select default config from arch/$(ARCH)/configs'
 endef
 
-install: vdso_install
+install:
 	$(Q)$(MAKE) $(build)=$(boot) install
 
 vdso_install:
diff --git a/arch/x86/Makefile b/arch/x86/Makefile
index 204af43..f1e739a 100644
--- a/arch/x86/Makefile
+++ b/arch/x86/Makefile
@@ -229,7 +229,7 @@ zdisk bzdisk: vmlinux
 fdimage fdimage144 fdimage288 isoimage: vmlinux
 	$(Q)$(MAKE) $(build)=$(boot) BOOTIMAGE=$(KBUILD_IMAGE) $@
 
-install: vdso_install
+install:
 	$(Q)$(MAKE) $(build)=$(boot) BOOTIMAGE=$(KBUILD_IMAGE) install
 
 PHONY += vdso_install