Date: Tue, 6 May 2003 14:17:29 +0200 (MET DST)
From: Bartlomiej Zolnierkiewicz <>
Subject: Re: promise NEITHER IDE PORT ENABLED
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2003/5/6/117

Hi,
It is a config error, CONFIG_PDC202XX_FORCE depends on
CONFIG_BLK_DEV_PDC202XX_NEW. So even if you set it manually
in .config to y, the change won't be propagated.
Here is a quick patch to make force option visible for both old/new pdc.
More elegant solution will be to split force option for old/new pdc
as suggested by #fixme in Config.in.
Patch agaist 2.4.21-rc1, if it works for you please forward to Marcello.
Regards,
--
Bartlomiej
On Tue, 6 May 2003, Carl-Daniel Hailfinger wrote:
> Alan,
>
> could you please elaborate which of the options you meant is missing
> below? Thanks.
>
> Javi Pardo (DAKOTA) wrote:
> > Alan Cox wrote:
> >>Carl-Daniel Hailfinger wrote:
> >>
> >>>could you please take a look at this? I thought the IDE code in
> >>>2.4.21-rc1 is able to force enable the ports of a promise controller.
> >>
> >>It can - if you set the configuration option to do so
> >>
> >
> > i am the problem with the PDC20267 Chipset.
> >
> > i am downloaded the kernel 2.4.20 and 2.4.21-rc1
> > and i am set this options for IDE
> >
> > CONFIG_BLK_DEV_PDC202XX=y
> > # CONFIG_PDC202XX_BURST is not set
> > CONFIG_PDC202XX_FORCE=y                      <- this options force IDE detections
> > CONFIG_BLK_DEV_VIA82CXXX=y
> > # CONFIG_IDE_CHIPSETS is not set
> > CONFIG_IDEDMA_AUTO=y
> > # CONFIG_IDEDMA_IVB is not set
> > # CONFIG_DMA_NONPCI is not set
> > CONFIG_BLK_DEV_IDE_MODES=y
> > CONFIG_BLK_DEV_ATARAID=y
> > CONFIG_BLK_DEV_ATARAID_PDC=y
> > # CONFIG_BLK_DEV_ATARAID_HPT is not set
> >
> >
> > the kernel 2.4.20 and 2.4.21-rc1 NO detect the ide channels and mi system crashes
> >
> > wath is the problem? i am select all correct options but no work...
>
> Regards,
> Carl-Daniel
--- linux-2.4.21-rc1/drivers/ide/Config.in	Sat Apr 26 17:10:47 2003
+++ linux/drivers/ide/Config.in	Tue May  6 13:46:15 2003
@@ -66,7 +66,7 @@
 	    dep_bool     '      Special UDMA Feature' CONFIG_PDC202XX_BURST $CONFIG_BLK_DEV_PDC202XX_OLD $CONFI_BLK_DEV_IDEDMA_PCI
 	    dep_tristate '    PROMISE PDC202{68|69|70|71|75|76|77} support' CONFIG_BLK_DEV_PDC202XX_NEW $CONFIG_BLK_DEV_IDEDMA_PCI
 		# FIXME - probably wants to be one for old and for new
-	    dep_bool     '      Special FastTrak Feature' CONFIG_PDC202XX_FORCE $CONFIG_BLK_DEV_PDC202XX_NEW
+	    dep_bool     '    Special FastTrak Feature' CONFIG_PDC202XX_FORCE
 	    dep_tristate '    RZ1000 chipset bugfix/support' CONFIG_BLK_DEV_RZ1000 $CONFIG_X86
 	    dep_tristate '    SCx200 chipset support' CONFIG_BLK_DEV_SC1200 $CONFIG_BLK_DEV_IDEDMA_PCI
 	    dep_tristate '    ServerWorks OSB4/CSB5/CSB6 chipsets support' CONFIG_BLK_DEV_SVWKS $CONFIG_BLK_DEV_IDEDMA_PCI