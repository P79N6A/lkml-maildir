Date: Fri, 10 Mar 2006 21:08:25 -0600
From: "Greg Scott" <>
Subject: RE: Router stops routing after changing MAC Address
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2006/3/10/311

> I think you're not testing hotswapping machines with equal 
> MAC addresses here, you're testing hot-changing the MAC 
> address for a gateway IP. The machine on the "right side" 
> that the machine on the left side is pinging probably still 
> has the old MAC address for its gateway in it's ARP cache, 
> so the echo reply will be sent to the wrong MAC address. (
> Or am I talking nonsense here?)
>
> --Bart
I sometimes wonder if I'm going crazy myself.  :)
My ultimate goal is to hotswap machines with equal MAC Addresses.  I
built up two machines, hotswapped, and pinged to each one - and it all
worked.  Who would have believed they would refuse to forward packets
when I tried to put them into production?  After my installation went
haywire, my little testbed right now has one gateway in the middle and
one system on the right and one on the left.  So, yes, right now I am
hot-changing MAC addresses on this gateway, trying to get closer to the
problem where routers don't route when the MAC Address is different than
the hardware MAC Address.
Anyway, just to be completely anal about this I put the original MAC
Addresses on the middle gateway and set up the system on the right to
ping the middle gateway.  This worked.  With the pings still going, I
fudged the MAC Addresses in the middle gateway.  The echo replies to the
right stopped for about 30 seconds while its ARP cache cleared.  After
about 30 seconds, the echo replies started coming again as expected.
But the left could never ping the right after fudging MAC Addresses on
the middle gateway.  
So far, no matter what, left and right do not see eachother when the
middle has fudged MAC Addresses.  But when middle has hardware MAC
Addresses, left and right see each other just fine.  
I don't see any way the problem could be related to ARP caches.
- Greg
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.kernel.org
More majordomo info at  
http://vger.kernel.org/majordomo-info.html
Please read the FAQ at  
http://www.tux.org/lkml/