Date: Thu, 16 Nov 2006 16:13:53 -0500
From: 	Valdis.Kletnieks@vt ...
Subject: Re: CIFS close with pending writes
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2006/11/16/202

On Wed, 15 Nov 2006 14:29:53 +0100, Christian said:
I was hitting this under 2.6.19-rc5-mm1 as well:
> [ 7190.693567] CIFS does not yet support partial page writes on O_WRONLY files
I get that one even without "heavy stressing" - just doing a CIFS mount of
a share from our NetApp and trying to copy a file onto it will trigger
this variant.  'cat /etc/motd >> /mnt/server/my_dir/foo' triggers it.
(changing the shell redirect to '1<>/mnt/server/my_dir/foo' solves THIS one,
and creates the second flavor:
> [ 7190.693600]  CIFS VFS: close with pending writes
Happens every time you close a file after writing anything other than an
exact multiple of 4K.
Some quick testing indicates that this works properly under -rc5-mm2 (in fact,
I didn't report it against -mm1 because when I discovered it the other day, I
already knew -mm2 was out...)
[unhandled content-type:application/pgp-signature]