Date: Fri, 30 Jan 2009 06:20:07 +0100
From: Willy Tarreau <>
Subject: Re: Vramfs: filesystem driver to utilize extra RAM on VGA devices
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2009/1/30/2

On Thu, Jan 29, 2009 at 08:46:06PM -0800, H. Peter Anvin wrote:
> Jonathan Campbell wrote:
> > I don't really see the similarity between the MTD subsystem and dividing
> > vram up by files. Video cards don't have "erase blocks". And MTD is not
> > a filesystem. And the onboard memory mtd driver (map system RAM) only
> > handles one fixed region determined at load time.
> > 
> > Vramfs on the other hand determines what resources to use at mount time.
> > It supports multiple mounts, one per PCI device, if you want the
> > combined VRAM of two VGA cards in your system.
> > 
> > I don't think vramfs would fit well into the MTD subsystem.
> 
> Think about it this way: it is a continuum of facilities.  Why is VRAM
> different than, say, external DRAM that can only be accessed via a DMA
> engine?  Now swap the DRAM with NAND flash and perform the same exercise.
> 
> Perhaps the most important reason is that you want to be able to use
> this as backing store for swap.  Currently the mm doesn't handle swap
> which is much faster than filesystems very well, but that should be
> possible to address.
Also, MTD allows you to map *part* of the VRAM. On my laptop, I only
map 56 MB out of the 64 MB of VRAM, which still allows me to use the
VGA normally. And BTW, I map this VRAM as a fast swap memory.
In fact, I see little use to the VRAMFS for the average user. Still
it might have been a nice coding exercice for Jonathan.
Willy