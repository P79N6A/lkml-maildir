Date: Thu, 20 Mar 2008 15:45:55 -0700
From: Andrew Morton <>
Subject: Re: [mmotm] iscsi_ibft build error
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2008/3/20/265

On Wed, 19 Mar 2008 11:56:55 -0700
Randy Dunlap <randy.dunlap@oracle.com> wrote:
> mmotm-2008-0318-1720/drivers/firmware/iscsi_ibft.c: In function 'ibft_show_attribute':
> mmotm-2008-0318-1720/drivers/firmware/iscsi_ibft.c:521: error: implicit declaration of function 'capable'
> mmotm-2008-0318-1720/drivers/firmware/iscsi_ibft.c:521: error: 'CAP_SYS_ADMIN' undeclared (first use in this function)
> mmotm-2008-0318-1720/drivers/firmware/iscsi_ibft.c:521: error: (Each undeclared identifier is reported only once
> mmotm-2008-0318-1720/drivers/firmware/iscsi_ibft.c:521: error: for each function it appears in.)
> make[3]: *** [drivers/firmware/iscsi_ibft.o] Error 1
> 
--- a/drivers/firmware/iscsi_ibft.c~scsi-add-iscsi-ibft-support-fix
+++ a/drivers/firmware/iscsi_ibft.c
@@ -65,6 +65,7 @@
 
 
 #include <linux/blkdev.h>
+#include <linux/capability.h>
 #include <linux/ctype.h>
 #include <linux/device.h>
 #include <linux/err.h>
should do the trick.
Does this driver actually need to run capable(CAP_SYS_ADMIN)?  Can we not
rely upon permissions of the reelvant sysfs file?