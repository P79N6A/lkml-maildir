Date: Sun, 18 Jul 1999 20:58:10 +0100 (GMT)
From: Tim Waugh <>
Subject: Re: gdb strangness Under 2.3.11-pre1
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/1999/7/18/103

On Sun, 18 Jul 1999, Alexander Viro wrote:
> > do the messages go away?
> 
> See if the following patch will help. It boots, runs and leak had gone. No
> problems so far. I'm submitting it to Linus.
Yes, that works fine here.  No worrying messages.
But lazy-tlb tasks don't show up in 'ps'.  That is, unless you apply this
patch.. ;-)
--- linux/fs/proc/array.c~	Sun Jul 18 20:49:57 1999
+++ linux/fs/proc/array.c	Sun Jul 18 20:54:47 1999
@@ -459,7 +459,7 @@
 	p = find_task_by_pid(pid);
 	read_unlock(&tasklist_lock);	/* FIXME!! This should be done after the last use */
 
-	if (!p || !p->mm)
+	if (!p || !p->mm || (p->flags & PF_LAZY_TLB))
 		return 0;
 	return get_array(p, p->mm->env_start, p->mm->env_end, buffer);
 }
@@ -1378,7 +1378,8 @@
 		ok = p->dumpable;
 		if(!cap_issubset(p->cap_permitted, current->cap_permitted))
 			ok=0;			
-		if(!p->mm)	/* Scooby scooby doo where are you ? */
+		if(!(p->flags & PF_LAZY_TLB) && !p->mm)
+			/* Scooby scooby doo, where are you ? */
 			p=NULL;
 	}
 		
I think that deals with all of the things to watch for in proc/array.c
now.
Tim.
*/
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.rutgers.edu
Please read the FAQ at 
http://www.tux.org/lkml/