Date: Thu, 27 Sep 2007 16:05:33 +0100
From: "Jan Beulich" <>
Subject: Re: [PATCH] Module use count must be updated as bridges are created/destroyed
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2007/9/27/141

>> >Sounds like a module utilities problem since unloading one module doesn't
>> >normally unload others.
>> 
>> I have to disagree here - 'modprobe -r' is specifically unloading all modules the
>> specified one references as long as they have a use count of zero. The
>> difference to other networking modules is that the latter normally don't export
>> symbols, and hence don't have dependent modules (and thus cannot be
>> subject of implicit unloading). Bridge does have dependents, and hence must
>> avoid implicit unloading by managing its use count.
>
>I want keep the behavior that:
>	modprobe -r bridge
>removes all bridges.  It is too useful and may already be in some user scripts.
So we have an unsolvable problem here then, unless infrastructure gets added
that allows a module to declare itself as not-implicit-unload-safe, forcing
modprobe -r to keep its hands off it. Ugly.
Jan
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.kernel.org
More majordomo info at  
http://vger.kernel.org/majordomo-info.html
Please read the FAQ at  
http://www.tux.org/lkml/