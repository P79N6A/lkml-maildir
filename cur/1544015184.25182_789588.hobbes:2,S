Date: Fri, 9 Jan 2009 15:25:52 -0800
From: Jesse Barnes <>
Subject: Re: [PATCH 4/8] PCI PCIe portdrv: Do not enable port device before setting up interrupts
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2009/1/9/446

On Sunday, January 4, 2009 2:54 pm Rafael J. Wysocki wrote:
> From: Rafael J. Wysocki <rjw@sisk.pl>
>
> The PCI Express port driver calls pci_enable_device() before setting
> up interrupts, which is wrong, because if there is an interrupt pin
> configured for the port, pci_enable_device() will likely set up an
> interrupt link for it.  However, this shouldn't be done if either
> MSI or MSI-X interrupt mode is chosen for the port.
>
> The solution is to call pci_enable_device() after setting up
> interrupts, because in that case the interrupt link won't be set up
> if MSI or MSI-X are enabled.
Hm, wonder how this bug stuck around for so long...  Good catch.
-- 
Jesse Barnes, Intel Open Source Technology Center