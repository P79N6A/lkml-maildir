Date: Thu, 19 Apr 2007 09:42:54 -0700
From: Andrew Morton <>
Subject: Re: dio_get_page() lockdep complaints
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2007/4/19/273

On Thu, 19 Apr 2007 18:57:41 +0400 "Vladimir V. Saveliev" <vs@namesys.com> wrote:
> > It's a bit odd that reiserfs is playing with file contents within
> > file_operations.release(): there could be other files open against that
> > inode.  One would expect this sort of thing to be happening in an
> > inode_operation.  But it's been like that for a long time.
> > 
> 
> reiserfs needs to "pack" file tail when last process which opened a file closes it.
> Can you see more suitable place where that could be performed?
No, you're right - I got my ->release() and ->flush() mixed up.
Possibly one could perform this operation on the final iput(), but I suspect the
locking situation there would be even more complex.
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.kernel.org
More majordomo info at  
http://vger.kernel.org/majordomo-info.html
Please read the FAQ at  
http://www.tux.org/lkml/