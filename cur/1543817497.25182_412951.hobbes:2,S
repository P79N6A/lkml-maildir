Date: Sat, 01 Apr 2006 12:56:55 +1000
From: Nick Piggin <>
Subject: Re: Synchronizing Bit operations V2
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2006/3/31/312

Christoph Lameter wrote:
> On Fri, 31 Mar 2006, Nick Piggin wrote:
>>You acknowledge that you have to fix ia64 to match current semantics
>>first, right?
> 
> 
> Right. I believe I have done so by making both smb_mb_* full barriers.
All bitop and atomic test_and_set, inc_return, etc etc (ie. everything
that modifies the operand and returns something) needs to be a full
barrier before and after too.
>>Now people seem to be worried about the performance impact that will
>>have, so I simply suggest that adding two or three new macros for the
>>important cases to give you a 90% solution.
> 
> 
> We could transition some key locations of core code to use _mode bitops
> if there are performance problems.
> 
> 
>>I think Documentation/atomic_ops.txt isn't bad. smp_mb__* really
>>is a smp_mb, which can be optimised sometimes.
> 
> 
> Ok. Then we are on the same page and the solution I presented may be 
> acceptable. I have a new rev here that changes the naming a bit but I 
> think we are okay right?
Not sure, to be honest. I think it is probably something which needs
input from all the other arch people, and Linus, if you intend to use
it to introduce new types of barriers.
-- 
SUSE Labs, Novell Inc.
Send instant messages to your online friends 
http://au.messenger.yahoo.com
 
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.kernel.org
More majordomo info at  
http://vger.kernel.org/majordomo-info.html
Please read the FAQ at  
http://www.tux.org/lkml/