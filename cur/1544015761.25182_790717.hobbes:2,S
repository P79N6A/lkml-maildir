Date: Mon, 12 Jan 2009 19:32:44 +0200
From: Avi Kivity <>
Subject: Re: [PATCH -v8][RFC] mutex: implement adaptive spinning
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2009/1/12/286

Peter Zijlstra wrote:
> Spinlocks can use 'pure' MCS locks.
> 
How about this, then.  In mutex_lock(), keep wait_lock locked and only 
release it when scheduling out.  Waiter spinning naturally follows.  If 
spinlocks are cache friendly (are they today?) we inherit that.  If 
there is no contention on the mutex, then we don't need to reacquire the 
wait_lock on mutex_unlock() (not that the atomic op is that expensive 
these days).
-- 
error compiling committee.c: too many arguments to function