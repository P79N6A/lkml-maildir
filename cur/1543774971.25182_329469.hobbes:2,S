Date: Tue, 28 Jun 2005 16:27:23 +0200
From: Ernst Herzberg <>
Subject: Re: dirty md raid5 slab bio leak
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2005/6/28/198

On Dienstag 28 Juni 2005 06:13, Neil Brown wrote:
> On Tuesday June 28, neilb@cse.unsw.edu.au wrote:
> > I just checked my test machine (running 2.6.12-rc3-mm3) and it had a
> > really large number of bio and biovec-1 in use too (and it's been
> > sitting fairly idle for several days).
> >
> > I've quickly reviewed the raid1 code and I cannot see a bio leak
> > (though that doesn't mean there isn't one..)
> >
> > If anyone else has a large 'bio' slab, please report the configuration
> > (kernel, is md in use, etc).
>
> It's OK, I found it.  The bio leaks when writing the md superblock.
>
Thanks.
Even here is my forgotten setup, for completeness:
c64 ~ # cat /proc/mdstat
Personalities : [linear] [raid0] [raid1] [raid5]
md2 : active raid1 sdb1[1] sda1[0]
      192640 blocks [2/2] [UU]
md1 : active raid5 sdd2[3] sdc2[2] sdb2[1] sda2[0]
      5855424 blocks level 5, 64k chunk, algorithm 2 [4/4] [UUUU]
md0 : active raid5 sdd3[3] sdc3[2] sdb3[1] sda3[0]
      345220416 blocks level 5, 64k chunk, algorithm 2 [4/4] [UUUU]
unused devices: <none>
c64 ~ # mount
/dev/md0 on / type reiserfs (rw,noatime)
proc on /proc type proc (rw)
sysfs on /sys type sysfs (rw)
udev on /dev type tmpfs (rw,nosuid)
devpts on /dev/pts type devpts (rw)
/dev/md2 on /boot type ext3 (rw,noatime)
none on /dev/shm type tmpfs (rw)
usbfs on /proc/bus/usb type usbfs (rw)
c64 ~ # cat /proc/swaps
Filename                                Type            Size    Used    
Priority
/dev/md/1                               partition       5855416 169236  -1
The failed disk was /dev/sdd, so only raid5 was involved. The 
partitions /dev/sdc1 and /dev/sdd1 are not used.
<earny>
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.kernel.org
More majordomo info at  
http://vger.kernel.org/majordomo-info.html
Please read the FAQ at  
http://www.tux.org/lkml/