Date: Mon, 12 Mar 2007 10:08:29 +0100
From: Jiri Slaby <>
Subject: Re: Keyboard stops working after *lock [Was: 2.6.21-rc2-mm1]
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2007/3/12/55

Jiri Kosina napsal(a):
> On Sun, 11 Mar 2007, Jiri Slaby wrote:
> 
>>> -	/* make sure the unused bits in the last byte are zeros */
>>> -	if (count > 0 && size > 0)
>>> -		data[(offset+count*size-1)/8] = 0;
>>> -
>> No, this doesn't help -- -rc3-mm2 minus this behaves exactly the same. 
[...]
> Otherwise, would you care to bisect?
Bisecting figured out the culprit:
Commit: 17230acdc71137622ca7dfd789b3944c75d39404
Author: Alan Stern <stern@rowland.harvard.edu> Mon, 19 Feb 2007 15:52:45 -0500
     UHCI: Eliminate asynchronous skeleton Queue Headers
     This patch (as856) attempts to improve the performance of uhci-hcd by
     removing the asynchronous skeleton Queue Headers.  They don't contain
     any useful information but the controller has to read through them at
     least once every millisecond, incurring a non-zero DMA overhead.
     Now all the asynchronous queues are combined, along with the period-1
     interrupt queue, into a single list with a single skeleton QH.  The
     start of the low-speed control, full-speed control, and bulk sublists
     is determined by linear search.  Since there should rarely be more
     than a couple of QHs in the list, the searches should incur a much
     smaller total load than keeping the skeleton QHs.
     Signed-off-by: Alan Stern <stern@rowland.harvard.edu>
     Signed-off-by: Greg Kroah-Hartman <gregkh@suse.de>
-mm minus (only) this one is OK.
regards,
-- 
http://www.fi.muni.cz/~xslaby/
            Jiri Slaby
faculty of informatics, masaryk university, brno, cz
e-mail: jirislaby gmail com, gpg pubkey fingerprint:
B674 9967 0407 CE62 ACC8  22A0 32CC 55C3 39D4 7A7E
Hnus <hnus@fi.muni.cz> is an alias for /dev/null
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.kernel.org
More majordomo info at  
http://vger.kernel.org/majordomo-info.html
Please read the FAQ at  
http://www.tux.org/lkml/