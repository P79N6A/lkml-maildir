Date: Wed, 18 Jan 2006 08:52:49 -0800
From: Bryan O'Sullivan <>
Subject: Re: Why is wmb() a no-op on x86_64?
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2006/1/18/237

On Wed, 2006-01-18 at 17:29 +0100, Andi Kleen wrote:
> Actually it is a compiler optimizer barrier, not a no-op.
Sorry, braino.
> Hmm, I suppose one could add a wc_wmb() or somesuch, but WC 
> is currently deeply architecture specific so I'm not sure
> how you can even use it portably.
> 
> Why do you need the barrier?
On x86_64, we fiddle with the MTRRs to enable write combining, which
makes a huge difference to performance.  It's not clear to me what we
should even do on other architectures, since the only generic entry
point that even exposes write combining is pci_mmap_page_range, which is
for PCI mmap through userspace, and half the arches I've looked at
ignore its write_combine parameter.
	<b
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.kernel.org
More majordomo info at  
http://vger.kernel.org/majordomo-info.html
Please read the FAQ at  
http://www.tux.org/lkml/