Date: Wed, 21 Mar 2007 17:21:55 -0600
From: Robert Hancock <>
Subject: Re: [PATCH] I/O space boot parameter
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2007/3/21/397

Daniel Yeisley wrote:
>> Ah.  Others are working on providing a fix for this too, but it is being
>> done in the drivers themselves, not in the pci core.  Look in the
>> linux-pci mailing list archives for those patches (I don't think they
>> every went into mainline for some reason, but I might be wrong...)
>>
>> I suggest you work with those developers, as they have the same issue
>> that you are trying to solve here.
>>
> 
> I have seen some patches that make the drivers I/O port free here:
> 
http://lkml.org/lkml/2006/2/26/261
> 
> I checked and they still aren't in the mainline.  
> 
> I don't know that it matters though because I see all the disks attached
> to the system regardless of whether or not the adapters get I/O space.
> The real issue I have is with all the error messages I get at boot.  I
> see 40+ messages that say "PCI: Failed to allocate I/O
> resource..." (from setup-res.c) when the kernel tries to allocate the
> I/O space and can't.  The modules load fine.  I see all the disks just
> fine.  But that many error messages tends to raise concerns and causes
> support calls from customers.
I don't think this can be handled entirely at the driver level. Assuming 
that the IO regions get allocated at bootup, and there's not enough 
space for all devices' IO space to fit, there's no guarantee that the 
ones that didn't fit are the ones where using the IO space is optional, 
and so you could end up with some broken devices.
I suppose you could handle this by assigning the devices who had no 
space assigned by the BIOS last, so that we wouldn't try to assign those 
until we'd already assigned everything else..
-- 
Robert Hancock      Saskatoon, SK, Canada
To email, remove "nospam" from hancockr@nospamshaw.ca
Home Page: 
http://www.roberthancock.com/
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.kernel.org
More majordomo info at  
http://vger.kernel.org/majordomo-info.html
Please read the FAQ at  
http://www.tux.org/lkml/