Date: Thu, 04 Apr 2002 16:38:23 -0800
From: Dave Hansen <>
Subject: BKL in tiglusb release function
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2002/4/4/245

Is there a reason for the BKL to be used in tiglusb_release()?  Are you 
worried about a race between open and release, or were you just 
following examples from other code?
I'm sure we can remove it safely.  We might need another lock, but it 
won't be much.
-- 
Dave Hansen
haveblue@us.ibm.com
--- linux-2.5.8-pre1-clean/drivers/usb/tiglusb.c	Thu Apr  4 08:58:26 2002
+++ linux/drivers/usb/tiglusb.c	Thu Apr  4 16:29:31 2002
@@ -128,7 +128,6 @@
 {
 	ptiglusb_t s = (ptiglusb_t) file->private_data;
 
-	lock_kernel ();
 	down (&s->mutex);
 	s->state = _stopped;
 	up (&s->mutex);
@@ -139,7 +138,6 @@
 		wake_up (&s->remove_ok);
 
 	s->opened = 0;
-	unlock_kernel ();
 
 	return 0;
 }