Date: Fri, 11 Aug 2000 20:21:44 -0700
From: Wallace Huang <>
Subject: [CHECKER] null ptr checking
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2000/8/11/187

Hi Everyone,
I'm Wallace, another member of Dawson's group, and I've been working on a
checker that make sure folks check return values from allocation functions
for NULL before using.  I believe Dawson sent out a log with respect to
just kmalloc/vmalloc; I've expanded it to include others.  
Right now, we're just using the obvious "if it's named alloc" heuristic to
find new functions, but if any of you are aware of other ones that don't
fall in this category, please let me know.
There are a few false positives.  Some are due to kprintf's and the like,
and this has already been fixed.  The rest involve freeing on error paths,
which I'll also fix shortly.  
We're working on identifying more functions that can return NULL pointers,
as well as coupling alloc's with their respective free's.  Again, if you
have any heurstics about identifying such pairings, I would appreciate
your input.
-Wallace
CONFIRMED [UNCHECK]
/u3/whuang/mc/linux-2.3.99/arch/i386/kernel/setup.c:756:setup_arch: ERROR: Unchecked use of malloc'd var 'res'
/u3/whuang/mc/linux-2.3.99/arch/i386/kernel/setup.c:761:setup_arch: ERROR: Unchecked use of malloc'd var 'res'
/u3/whuang/mc/linux-2.3.99/arch/i386/kernel/setup.c:762:setup_arch: ERROR: Unchecked use of malloc'd var 'res'
/u3/whuang/mc/linux-2.3.99/arch/i386/kernel/setup.c:763:setup_arch: ERROR: Unchecked use of malloc'd var 'res'
/u3/whuang/mc/linux-2.3.99/arch/i386/kernel/setup.c:764:setup_arch: ERROR: Unchecked use of malloc'd var 'res'
/u3/whuang/mc/linux-2.3.99/arch/i386/kernel/setup.c:766:setup_arch: ERROR: Unchecked use of malloc'd var 'res'
/u3/whuang/mc/linux-2.3.99/arch/i386/kernel/setup.c:767:setup_arch: ERROR: Unchecked use of malloc'd var 'res'
/u3/whuang/mc/linux-2.3.99/arch/i386/kernel/setup.c:768:setup_arch: ERROR: Unchecked use of malloc'd var 'res'
/u3/whuang/mc/linux-2.3.99/arch/i386/kernel/setup.c:769:setup_arch: ERROR: Unchecked use of malloc'd var 'res'
/u3/whuang/mc/linux-2.3.99/arch/i386/kernel/setup.c:776:setup_arch: ERROR: Unchecked use of malloc'd var 'res'
/u3/whuang/mc/linux-2.3.99/arch/i386/kernel/setup.c:777:setup_arch: ERROR:Unchecked use of malloc'd var 'res'
-->	res = alloc_bootmem_low(sizeof(struct resource));
		switch (e820.map[i].type) {
		case E820_RAM:	res->name = "System RAM"; break;
		case E820_ACPI:	res->name = "ACPI Tables"; break;
		case E820_NVS:	res->name = "ACPI Non-volatile Storage"; break;
		default:	res->name = "reserved";
		}
		res->start = e820.map[i].addr;
		res->end = res->start + e820.map[i].size - 1;
		res->flags = IORESOURCE_MEM | IORESOURCE_BUSY;
		request_resource(&iomem_resource, res);
pretty standard violation.  Macro is defined bootmem.h, but can't find
implementation (maybe asm?)
--------------------------------------------------
FALSE POSITIVE
/u3/whuang/mc/linux-2.3.99/arch/i386/kernel/smpboot.c:132:smp_alloc_memory: ERROR: Unchecked use of malloc'd var 'trampoline_base'
	trampoline_base = (void *) alloc_bootmem_low_pages(PAGE_SIZE);
	/*
	 * Has to be in very low memory so we can execute
	 * real-mode AP code.
	 */
	if (__pa(trampoline_base) >= 0x9F000)
		BUG();
--> def of __pa, all from include/asm-i386/page.h
#define __PAGE_OFFSET		(0xC0000000)
...
#define __pa(x)			((unsigned long)(x)-PAGE_OFFSET)
Non-standard math comparison (if the ptr is NULL, it will wrap around and
pass the if-test).
--------------------------------------------------
POSSIBLE -- if I spent some time figuring out the macros and defines...
/u3/whuang/mc/linux-2.3.99/arch/i386/mm/init.c:294:fixrange_init: ERROR: Unchecked use of malloc'd var 'pte'
/u3/whuang/mc/linux-2.3.99/arch/i386/mm/init.c:295:fixrange_init: ERROR: Unchecked use of malloc'd var 'pte'
		pte = (pte_t *) alloc_bootmem_low_pages(PAGE_SIZE);
-->	set_pmd(pmd, __pmd(_KERNPG_TABLE + __pa(pte)));
		if (pte != pte_offset(pmd, 0))
			BUG();
/* from page.h */
typedef struct { unsigned long long pmd; } pmd_t;
#define __pmd(x) ((pmd_t) { (x) } )
/* from pgtable.h */
#define __pmd_offset(address) \
		(((address) >> PMD_SHIFT) & (PTRS_PER_PMD-1))
/u3/whuang/mc/linux-2.3.99/arch/i386/mm/init.c:350:pagetable_init: ERROR: Unchecked use of malloc'd var 'pte'
/u3/whuang/mc/linux-2.3.99/arch/i386/mm/init.c:352:pagetable_init: ERROR: Unchecked use of malloc'd var 'pte'
/u3/whuang/mc/linux-2.3.99/arch/i386/mm/init.c:355:pagetable_init: ERROR: Unchecked use of malloc'd var 'pte'
/u3/whuang/mc/linux-2.3.99/arch/i386/mm/init.c:359:pagetable_init: ERROR: Unchecked use of malloc'd var 'pte'
			pte = (pte_t *) alloc_bootmem_low_pages(PAGE_SIZE);
			set_pmd(pmd, __pmd(_KERNPG_TABLE + __pa(pte)));
			if (pte != pte_offset(pmd, 0))
				BUG();
			for (k = 0; k < PTRS_PER_PTE; pte++, k++) {
				vaddr = i*PGDIR_SIZE + j*PMD_SIZE + k*PAGE_SIZE;
				if (vaddr >= end)
					break;
				*pte = mk_pte_phys(__pa(vaddr), PAGE_KERNEL);
Similar to above
--------------------------------------------------
/u3/whuang/mc/linux-2.3.99/arch/i386/mm/ioremap.c:80:remap_area_pages: ERROR: did not free pmd on error path
/u3/whuang/mc/linux-2.3.99/drivers/atm/atmtcp.c:58:atmtcp_send_control: ERROR: did not free skb on error path
--------------------------------------------------
FALSE POSITVE -- POSSIBLE
/u3/whuang/mc/linux-2.3.99/drivers/atm/fore200e.c:1752:fore200e_getstats: ERROR: did not free fore200e on error path
    if (fore200e->stats == NULL) {
-->	fore200e->stats = fore200e_kmalloc(sizeof(struct stats), GFP_KERNEL | GFP_DMA);
		if (fore200e->stats == NULL)
	   	 return -ENOMEM;
    }
    
    stats_dma_addr = fore200e->bus->dma_map(fore200e, fore200e->stats, sizeof(struct stats), FORE200E_DMA_FROMDEVICE);
    
    FORE200E_NEXT_ENTRY(cmdq->head, QUEUE_SIZE_CMD);
    opcode.opcode = OPCODE_GET_STATS;
    opcode.pad    = 0;
    fore200e->bus->write(stats_dma_addr, &entry->cp_entry->cmd.stats_block.stats_haddr);
    
    *entry->status = STATUS_PENDING;
    fore200e->bus->write(*(u32*)&opcode, (u32*)&entry->cp_entry->cmd.stats_block.opcode);
    ok = fore200e_poll(fore200e, (u32 *) entry->status, STATUS_COMPLETE, 400);
    *entry->status = STATUS_FREE;
    fore200e->bus->dma_unmap(fore200e, stats_dma_addr, sizeof(struct stats), FORE200E_DMA_FROMDEVICE);
    
    if (ok == 0) {
		printk(FORE200E "unable to get statistics from device %s\n", fore200e->name);
-->	return -EIO;
    }
    return 0;
the stats field doesn't get freed on a non-error path here, so I'm
inclined to think false positive.
--------------------------------------------------
POSSIBLE
/u3/whuang/mc/linux-2.3.99/drivers/atm/fore200e.c:2031:fore200e_get_esi: ERROR: Unchecked use of malloc'd var 'prom'
    struct prom_data* prom = fore200e_kmalloc(sizeof(struct prom_data), GFP_KERNEL | GFP_DMA);
    int ok, i;
    ok = fore200e->bus->prom_read(fore200e, prom);
Okay, this starts a chain of fn calls that do some vm munging with prom.
There is an address check, way, way later--but it could be caught up here.
--------------------------------------------------
CONFIRMED [UNCHECK]
/u3/whuang/mc/linux-2.3.99/drivers/block/cpqarray.c:1361:sendcmd: ERROR: Unchecked use of malloc'd var 'c'
/u3/whuang/mc/linux-2.3.99/drivers/block/cpqarray.c:1362:sendcmd: ERROR: Unchecked use of malloc'd var 'c'
/u3/whuang/mc/linux-2.3.99/drivers/block/cpqarray.c:1363:sendcmd: ERROR: Unchecked use of malloc'd var 'c'
/u3/whuang/mc/linux-2.3.99/drivers/block/cpqarray.c:1364:sendcmd: ERROR: Unchecked use of malloc'd var 'c'
/u3/whuang/mc/linux-2.3.99/drivers/block/cpqarray.c:1367:sendcmd: ERROR: Unchecked use of malloc'd var 'c'
/u3/whuang/mc/linux-2.3.99/drivers/block/cpqarray.c:1368:sendcmd: ERROR: Unchecked use of malloc'd var 'c'
/u3/whuang/mc/linux-2.3.99/drivers/block/cpqarray.c:1369:sendcmd: ERROR: Unchecked use of malloc'd var 'c'
/u3/whuang/mc/linux-2.3.99/drivers/block/cpqarray.c:1370:sendcmd: ERROR: Unchecked use of malloc'd var 'c'
/u3/whuang/mc/linux-2.3.99/drivers/block/cpqarray.c:1371:sendcmd: ERROR: Unchecked use of malloc'd var 'c'
/u3/whuang/mc/linux-2.3.99/drivers/block/cpqarray.c:1374:sendcmd: ERROR: Unchecked use of malloc'd var 'c'
/u3/whuang/mc/linux-2.3.99/drivers/block/cpqarray.c:1376:sendcmd: ERROR: Unchecked use of malloc'd var 'c'
/u3/whuang/mc/linux-2.3.99/drivers/block/cpqarray.c:1378:sendcmd: ERROR: Unchecked use of malloc'd var 'c'
/u3/whuang/mc/linux-2.3.99/drivers/block/cpqarray.c:1379:sendcmd: ERROR: Unchecked use of malloc'd var 'c'
/u3/whuang/mc/linux-2.3.99/drivers/block/cpqarray.c:1380:sendcmd: ERROR: Unchecked use of malloc'd var 'c'
/u3/whuang/mc/linux-2.3.99/drivers/block/cpqarray.c:1381:sendcmd: ERROR: Unchecked use of malloc'd var 'c'
/u3/whuang/mc/linux-2.3.99/drivers/block/cpqarray.c:1402:sendcmd: ERROR: Unchecked use of malloc'd var 'c'
/u3/whuang/mc/linux-2.3.99/drivers/block/cpqarray.c:1405:sendcmd: ERROR: Unchecked use of malloc'd var 'c'
/u3/whuang/mc/linux-2.3.99/drivers/block/cpqarray.c:1410:sendcmd: ERROR: Unchecked use of malloc'd var 'c'
/u3/whuang/mc/linux-2.3.99/drivers/block/cpqarray.c:1418:sendcmd: ERROR: Unchecked use of malloc'd var 'c'
/u3/whuang/mc/linux-2.3.99/drivers/block/cpqarray.c:1422:sendcmd: ERROR: Unchecked use of malloc'd var 'c'
/u3/whuang/mc/linux-2.3.99/drivers/block/cpqarray.c:1423:sendcmd: ERROR: Unchecked use of malloc'd var 'c'
/u3/whuang/mc/linux-2.3.99/drivers/block/cpqarray.c:1428:sendcmd: ERROR: Unchecked use of malloc'd var 'c'
/u3/whuang/mc/linux-2.3.99/drivers/block/cpqarray.c:1430:sendcmd: ERROR: Unchecked use of malloc'd var 'c'
/u3/whuang/mc/linux-2.3.99/drivers/block/cpqarray.c:1434:sendcmd: ERROR: Unchecked use of malloc'd var 'c'
-->c = cmd_alloc(info_p);
	c->ctlr = ctlr;
	c->hdr.unit = log_unit;
	c->hdr.prio = 0;
	c->hdr.size = sizeof(rblk_t) >> 2;
	c->size += sizeof(rblk_t);
so begins a long line of unchecked accesses.  cmd_alloc use kmalloc
underneath.
--------------------------------------------------
CONFIRMED [UNCHECK]
/u3/whuang/mc/linux-2.3.99/drivers/block/md.c:1899:autorun_devices: ERROR: Unchecked use of malloc'd var 'mddev'
/u3/whuang/mc/linux-2.3.99/drivers/block/md.c:1901:autorun_devices: ERROR: Unchecked use of malloc'd var 'mddev'
/u3/whuang/mc/linux-2.3.99/drivers/block/md.c:1905:autorun_devices: ERROR:Unchecked use of malloc'd var 'mddev'
		mddev = alloc_mddev(md_kdev);
		printk("created md%d\n", mdidx(mddev));
		ITERATE_RDEV_GENERIC(candidates,pending,rdev,tmp) {
			bind_rdev_to_array(rdev, mddev);
			md_list_del(&rdev->pending);
			MD_INIT_LIST_HEAD(&rdev->pending);
		}
		autorun_array(mddev);
this is what the called fn does...
static void autorun_array (mddev_t *mddev)
{
...
-->if (mddev->disks.prev == &mddev->disks) {
		MD_BUG();
		return;
	}
--------------------------------------------------
FALSE POSITIVE [FREE_FN]
/u3/whuang/mc/linux-2.3.99/drivers/char/agp/agpgart_fe.c:920:agpioc_allocate_wrap: ERROR: did not free memory on error path
	if (copy_to_user((void *) arg, &alloc, sizeof(agp_allocate))) {
		agp_free_memory_wrap(memory);
		return -EFAULT;
	}
easily fixed by adding free function pairs
--------------------------------------------------
CONFIRMED [UNCHECK]
/u3/whuang/mc/linux-2.3.99/drivers/char/console.c:2436:con_init: ERROR: Unchecked use of malloc'd var 'vc_cons'
/u3/whuang/mc/linux-2.3.99/drivers/char/console.c:2438:con_init: ERROR: Unchecked use of malloc'd var 'vc_cons'
/u3/whuang/mc/linux-2.3.99/drivers/char/console.c:2440:con_init: ERROR: Unchecked use of malloc'd var 'vc_cons'
/u3/whuang/mc/linux-2.3.99/drivers/char/console.c:2441:con_init: ERROR: Unchecked use of malloc'd var 'vc_cons'
/u3/whuang/mc/linux-2.3.99/drivers/char/console.c:2442:con_init: ERROR: Unchecked use of malloc'd var 'vc_cons'
/u3/whuang/mc/linux-2.3.99/drivers/char/console.c:2446:con_init: ERROR: Unchecked use of malloc'd var 'vc_cons'
/u3/whuang/mc/linux-2.3.99/drivers/char/console.c:2449:con_init: ERROR: Unchecked use of malloc'd var 'vc_cons'
-->	vc_cons[currcons].d = (struct vc_data *)
				alloc_bootmem(sizeof(struct vc_data));
		vt_cons[currcons] = (struct vt_struct *)
				alloc_bootmem(sizeof(struct vt_struct));
		visual_init(currcons, 1);
		screenbuf = (unsigned short *) alloc_bootmem(screenbuf_size);
		kmalloced = 0;
		vc_init(currcons, video_num_lines, video_num_columns, 
			currcons || !sw->con_save_screen);
		for (j=k=0; j<16; j++) {
			vc_cons[currcons].d->vc_palette[k++] = default_red[j] ;
			vc_cons[currcons].d->vc_palette[k++] = default_grn[j] ;
			vc_cons[currcons].d->vc_palette[k++] = default_blu[j] ;
		}
--------------------------------------------------
FALSE POSITIVE [FREE_FN}
/u3/whuang/mc/linux-2.3.99/drivers/char/cpia.c:2467:cpia_open: ERROR: did not free cam on error path
/u3/whuang/mc/linux-2.3.99/drivers/char/cpia.c:2477:cpia_open: ERROR: did not free cam on error path
	if (cam->ops->open(cam->lowlevel_data)) {
		rvfree(cam->decompressed_frame.data, CPIA_MAX_FRAME_SIZE);
		cam->decompressed_frame.data = NULL;
		rvfree(cam->raw_image, CPIA_MAX_IMAGE_SIZE);
		cam->raw_image = NULL;
		return -ENODEV;
	}
not completely sure here because we're not properly reporting field names,
but I believe it's refering to raw_image, which does get freed here.
Similar error for 2477.
--------------------------------------------------
/u3/whuang/mc/linux-2.3.99/drivers/char/drm/bufs.c:108:drm_addmap: ERROR: did not free map on error path
--------------------------------------------------
CONFIRMED [UNCHECK]
/u3/whuang/mc/linux-2.3.99/drivers/char/drm/bufs.c:125:drm_addmap: ERROR: Unchecked use of malloc'd var 'dev'
	if (dev->maplist) {
		++dev->map_count;
		dev->maplist = drm_realloc(dev->maplist,
					   (dev->map_count-1)
					   * sizeof(*dev->maplist),
					   dev->map_count
					   * sizeof(*dev->maplist),
					   DRM_MEM_MAPS);
	} else {
		dev->map_count = 1;
		dev->maplist = drm_alloc(dev->map_count*sizeof(*dev->maplist),
					 DRM_MEM_MAPS);
	}
	dev->maplist[dev->map_count-1] = map;
memory in maplist array is used before check...
--------------------------------------------------
/u3/whuang/mc/linux-2.3.99/drivers/char/drm/bufs.c:212:drm_addbufs: ERROR: did not free entry on error path
--------------------------------------------------
/u3/whuang/mc/linux-2.3.99/drivers/char/drm/bufs.c:237:drm_addbufs: ERROR: Unchecked use of malloc'd var 'dma'
/u3/whuang/mc/linux-2.3.99/drivers/char/drm/bufs.c:272:drm_addbufs: ERROR: Unchecked use of malloc'd var 'dma'
-->dma->pagelist = drm_realloc(dma->pagelist,
				    dma->page_count * sizeof(*dma->pagelist),
				    (dma->page_count + (count << page_order))
				    * sizeof(*dma->pagelist),
				    DRM_MEM_PAGES);
	DRM_DEBUG("pagelist: %d entries\n",
		  dma->page_count + (count << page_order));
	entry->buf_size	  = size;
	entry->page_order = page_order;
	byte_count	  = 0;
	page_count	  = 0;
	while (entry->buf_count < count) {
		if (!(page = drm_alloc_pages(page_order, DRM_MEM_DMA))) break;
		entry->seglist[entry->seg_count++] = page;
		for (i = 0; i < (1 << page_order); i++) {
			DRM_DEBUG("page %d @ 0x%08lx\n",
				  dma->page_count + page_count,
				  page + PAGE_SIZE * i);
-->		dma->pagelist[dma->page_count + page_count++]
				= page + PAGE_SIZE * i;
		}
--------------------------------------------------
FALSE POSITIVE [FREE_FN]
/u3/whuang/mc/linux-2.3.99/drivers/char/drm/bufs.c:60:drm_addmap: ERROR: did not free map on error path
/u3/whuang/mc/linux-2.3.99/drivers/char/drm/bufs.c:67:drm_addmap: ERROR: did not free map on error path
/u3/whuang/mc/linux-2.3.99/drivers/char/drm/bufs.c:78:drm_addmap: ERROR: id not free map on error path
/u3/whuang/mc/linux-2.3.99/drivers/char/drm/bufs.c:99:drm_addmap: ERROR: id not free map on error path
again, expand the free checker to handle more fns
--------------------------------------------------
CONFIRMED [UNCHECK]
/u3/whuang/mc/linux-2.3.99/drivers/char/drm/context.c:116:drm_alloc_queue: ERROR: Unchecked use of malloc'd var 'queue'
-->	dev->queuelist = drm_realloc(dev->queuelist,
					     oldslots,
					     newslots,
					     DRM_MEM_QUEUES);
		if (!dev->queuelist) {
			up(&dev->struct_sem);
			DRM_DEBUG("out of memory\n");
			return -ENOMEM;
		}
	}
-->dev->queuelist[dev->queue_count-1] = queue;
/u3/whuang/mc/linux-2.3.99/drivers/char/drm/context.c:96:drm_alloc_queue: ERROR: Unchecked use of malloc'd var 'queue'
/u3/whuang/mc/linux-2.3.99/drivers/char/drm/context.c:97:drm_alloc_queue: ERROR: Unchecked use of malloc'd var 'queue'
-->queue = drm_alloc(sizeof(*queue), DRM_MEM_QUEUES);
	memset(queue, 0, sizeof(*queue));
	atomic_set(&queue->use_count, 1);
--------------------------------------------------
CONFIRMED [UNCHECK]
/u3/whuang/mc/linux-2.3.99/drivers/char/drm/dma.c:41:drm_dma_setup: ERROR: Unchecked use of malloc'd var 'dev'
/u3/whuang/mc/linux-2.3.99/drivers/char/drm/dma.c:43:drm_dma_setup: ERROR:Unchecked use of malloc'd var 'dev'
	dev->dma = drm_alloc(sizeof(*dev->dma), DRM_MEM_DRIVER);
	memset(dev->dma, 0, sizeof(*dev->dma));
	for (i = 0; i <= DRM_MAX_ORDER; i++)
		memset(&dev->dma->bufs[i], 0, sizeof(dev->dma->bufs[0]));
--------------------------------------------------
CONFIRMED [UNCHECK]
/u3/whuang/mc/linux-2.3.99/drivers/char/drm/fops.c:48:drm_open_helper: ERROR: Unchecked use of malloc'd var 'priv'
/u3/whuang/mc/linux-2.3.99/drivers/char/drm/fops.c:49:drm_open_helper: ERROR: Unchecked use of malloc'd var 'priv'
/u3/whuang/mc/linux-2.3.99/drivers/char/drm/fops.c:50:drm_open_helper: ERROR: Unchecked use of malloc'd var 'priv'
/u3/whuang/mc/linux-2.3.99/drivers/char/drm/fops.c:51:drm_open_helper: ERROR: Unchecked use of malloc'd var 'priv'
/u3/whuang/mc/linux-2.3.99/drivers/char/drm/fops.c:52:drm_open_helper: ERROR: Unchecked use of malloc'd var 'priv'
/u3/whuang/mc/linux-2.3.99/drivers/char/drm/fops.c:53:drm_open_helper: ERROR: Unchecked use of malloc'd var 'priv'
/u3/whuang/mc/linux-2.3.99/drivers/char/drm/fops.c:54:drm_open_helper: ERROR: Unchecked use of malloc'd var 'priv'
/u3/whuang/mc/linux-2.3.99/drivers/char/drm/fops.c:55:drm_open_helper: ERROR: Unchecked use of malloc'd var 'priv'
/u3/whuang/mc/linux-2.3.99/drivers/char/drm/fops.c:59:drm_open_helper: ERROR: Unchecked use of malloc'd var 'priv'
/u3/whuang/mc/linux-2.3.99/drivers/char/drm/fops.c:60:drm_open_helper: ERROR: Unchecked use of malloc'd var 'priv'
/u3/whuang/mc/linux-2.3.99/drivers/char/drm/fops.c:61:drm_open_helper: ERROR: Unchecked use of malloc'd var 'priv'
/u3/whuang/mc/linux-2.3.99/drivers/char/drm/fops.c:62:drm_open_helper: ERROR: Unchecked use of malloc'd var 'priv'
/u3/whuang/mc/linux-2.3.99/drivers/char/drm/fops.c:64:drm_open_helper: ERROR: Unchecked use of malloc'd var 'priv'
/u3/whuang/mc/linux-2.3.99/drivers/char/drm/fops.c:65:drm_open_helper: ERROR: Unchecked use of malloc'd var 'priv'
/u3/whuang/mc/linux-2.3.99/drivers/char/drm/fops.c:66:drm_open_helper: ERROR: Unchecked use of malloc'd var 'priv'
/u3/whuang/mc/linux-2.3.99/drivers/char/drm/fops.c:67:drm_open_helper: ERROR: Unchecked use of malloc'd var 'priv'
-->priv		    = drm_alloc(sizeof(*priv), DRM_MEM_FILES);
	memset(priv, 0, sizeof(*priv));
...
it all begins on fops.c:47
--------------------------------------------------
CONFIRMED [UNCHECK]
/u3/whuang/mc/linux-2.3.99/drivers/char/drm/ioctl.c:83:drm_setunique: ERROR: Unchecked use of malloc'd var 'dev'
	dev->unique_len = u.unique_len;
	dev->unique	= drm_alloc(u.unique_len + 1, DRM_MEM_DRIVER);
	copy_from_user_ret(dev->unique, u.unique, dev->unique_len,
			   -EFAULT);
	dev->unique[dev->unique_len] = '\0';
--------------------------------------------------
CONFIRMED [UNCHECK]
/u3/whuang/mc/linux-2.3.99/drivers/char/drm/lists.c:42:drm_waitlist_create: ERROR: Unchecked use of malloc'd var 'bl'
/u3/whuang/mc/linux-2.3.99/drivers/char/drm/lists.c:43:drm_waitlist_create: ERROR: Unchecked use of malloc'd var 'bl'
/u3/whuang/mc/linux-2.3.99/drivers/char/drm/lists.c:44:drm_waitlist_create: ERROR: Unchecked use of malloc'd var 'bl'
==>bl->bufs       = drm_alloc((bl->count + 2) * sizeof(*bl->bufs),
				   DRM_MEM_BUFLISTS);
	bl->rp	       = bl->bufs;
	bl->wp	       = bl->bufs;
	bl->end	       = &bl->bufs[bl->count+1];
--------------------------------------------------
POSSIBLE [UNCHECK]
/u3/whuang/mc/linux-2.3.99/drivers/char/ftape/zftape/zftape-vtbl.c:102:zft_init_vtbl: ERROR: Unchecked use of malloc'd var '__new'
/u3/whuang/mc/linux-2.3.99/drivers/char/ftape/zftape/zftape-vtbl.c:104:zft_init_vtbl: ERROR: Unchecked use of malloc'd var '__new'
	new = zft_kmalloc(sizeof(zft_volinfo));
==>list_add(&new->node, &zft_vtbl);
	new = zft_kmalloc(sizeof(zft_volinfo));
==>list_add(&new->node, &zft_vtbl);
/u3/whuang/mc/linux-2.3.99/drivers/char/ftape/zftape/zftape-vtbl.c:71:zft_new_vtbl_entry: ERROR: Unchecked use of malloc'd var '__new'
	zft_volinfo *new = zft_kmalloc(sizeof(zft_volinfo));
==>list_add(&new->node, tmp);
Hmm, does he want null entries?  Probably not...
--------------------------------------------------
/u3/whuang/mc/linux-2.3.99/drivers/char/istallion.c:4604:stli_findeisabrds: ERROR: did not free brdp on error path
/u3/whuang/mc/linux-2.3.99/drivers/char/stallion.c:1081:stl_open: ERROR: did not free portp on error path
/u3/whuang/mc/linux-2.3.99/drivers/char/stallion.c:1082:stl_open: ERROR: did not free portp on error path
/u3/whuang/mc/linux-2.3.99/drivers/char/stallion.c:1092:stl_open: ERROR: did not free portp on error path
/u3/whuang/mc/linux-2.3.99/drivers/char/stallion.c:1096:stl_open: ERROR: did not free portp on error path
/u3/whuang/mc/linux-2.3.99/drivers/char/stallion.c:1099:stl_open: ERROR: did not free portp on error path
/u3/whuang/mc/linux-2.3.99/drivers/char/stallion.c:1105:stl_open: ERROR: did not free portp on error path
/u3/whuang/mc/linux-2.3.99/drivers/char/zr36120.c:772:zoran_open: ERROR: did not free ztv on error path
/u3/whuang/mc/linux-2.3.99/drivers/i2o/i2o_lan.c:596:i2o_lan_receive_post: ERROR: did not free skb on error path
--------------------------------------------------
CONFIRMED [UNCHECK]
/u3/whuang/mc/linux-2.3.99/drivers/ide/ide-tape.c:3398:idetape_onstream_read_back_buffer: ERROR: Unchecked use of malloc'd var 'stage'
/u3/whuang/mc/linux-2.3.99/drivers/ide/ide-tape.c:3399:idetape_onstream_read_back_buffer: ERROR: Unchecked use of malloc'd var 'stage'
/u3/whuang/mc/linux-2.3.99/drivers/ide/ide-tape.c:3400:idetape_onstream_read_back_buffer: ERROR: Unchecked use of malloc'd var 'stage'
/u3/whuang/mc/linux-2.3.99/drivers/ide/ide-tape.c:3401:idetape_onstream_read_back_buffer: ERROR: Unchecked use of malloc'd var 'stage'
/u3/whuang/mc/linux-2.3.99/drivers/ide/ide-tape.c:3406:idetape_onstream_read_back_buffer: ERROR: Unchecked use of malloc'd var 'stage'
/u3/whuang/mc/linux-2.3.99/drivers/ide/ide-tape.c:3411:idetape_onstream_read_back_buffer: ERROR: Unchecked use of malloc'd var 'stage'
/u3/whuang/mc/linux-2.3.99/drivers/ide/ide-tape.c:3412:idetape_onstream_read_back_buffer: ERROR: Unchecked use of malloc'd var 'stage'
/u3/whuang/mc/linux-2.3.99/drivers/ide/ide-tape.c:3414:idetape_onstream_read_back_buffer: ERROR: Unchecked use of malloc'd var 'stage'
/u3/whuang/mc/linux-2.3.99/drivers/ide/ide-tape.c:3415:idetape_onstream_read_back_buffer: ERROR: Unchecked use of malloc'd var 'stage'
==>	stage = __idetape_kmalloc_stage(tape, 0, 0);
		if (!first)
			first = stage;
		aux = stage->aux;
		p = stage->bh->b_data;
		...
--------------------------------------------------
/u3/whuang/mc/linux-2.3.99/drivers/ide/ide-tape.c:3720:idetape_add_chrdev_write_request: ERROR: did not free new_stage on error path
/u3/whuang/mc/linux-2.3.99/drivers/ieee1394/ieee1394_transactions.c:510:hpsb_lock: ERROR: did not free packet on error path
/u3/whuang/mc/linux-2.3.99/drivers/ieee1394/raw1394.c:781:dev_write: ERROR: did not free req on error path
/u3/whuang/mc/linux-2.3.99/drivers/isdn/act2000/capi.c:185:actcapi_listen_req: ERROR: did not free skb on error path
/u3/whuang/mc/linux-2.3.99/drivers/isdn/act2000/capi.c:206:actcapi_connect_req: ERROR: did not free skb on error path
/u3/whuang/mc/linux-2.3.99/drivers/isdn/act2000/capi.c:250:actcapi_manufacturer_req_net: ERROR: did not free skb on error path
/u3/whuang/mc/linux-2.3.99/drivers/isdn/act2000/capi.c:278:actcapi_manufacturer_req_v42: ERROR: did not free skb on error path
/u3/whuang/mc/linux-2.3.99/drivers/isdn/act2000/capi.c:300:actcapi_manufacturer_req_errh: ERROR: did not free skb on error path
/u3/whuang/mc/linux-2.3.99/drivers/isdn/act2000/capi.c:327:actcapi_manufacturer_req_msn: ERROR: did not free skb on error path
--------------------------------------------------
/u3/whuang/mc/linux-2.3.99/drivers/isdn/avmb1/capi.c:1341:capinc_raw_write: ERROR: Unchecked use of malloc'd var 'skb'
/u3/whuang/mc/linux-2.3.99/drivers/isdn/avmb1/capi.c:1342:capinc_raw_write: ERROR: Unchecked use of malloc'd var 'skb'
/u3/whuang/mc/linux-2.3.99/drivers/isdn/avmb1/capi.c:1343:capinc_raw_write: ERROR: Unchecked use of malloc'd var 'skb'
/u3/whuang/mc/linux-2.3.99/drivers/isdn/avmb1/capi.c:1352:capinc_raw_write: ERROR: Unchecked use of malloc'd var 'skb'
/u3/whuang/mc/linux-2.3.99/drivers/isdn/avmb1/capi.c:1358:capinc_raw_write: ERROR: Unchecked use of malloc'd var 'skb'
/u3/whuang/mc/linux-2.3.99/drivers/isdn/avmb1/capi.c:1359:capinc_raw_write: ERROR: Unchecked use of malloc'd var 'skb'
/u3/whuang/mc/linux-2.3.99/drivers/isdn/avmb1/capi.c:932:capi_write: ERROR: Unchecked use of malloc'd var 'skb'
/u3/whuang/mc/linux-2.3.99/drivers/isdn/avmb1/capi.c:933:capi_write: ERROR: Unchecked use of malloc'd var 'skb'
/u3/whuang/mc/linux-2.3.99/drivers/isdn/avmb1/capi.c:936:capi_write: ERROR: Unchecked use of malloc'd var 'skb'
/u3/whuang/mc/linux-2.3.99/drivers/isdn/avmb1/capi.c:937:capi_write: ERROR: Unchecked use of malloc'd var 'skb'
/u3/whuang/mc/linux-2.3.99/drivers/isdn/avmb1/capi.c:938:capi_write: ERROR: Unchecked use of malloc'd var 'skb'
/u3/whuang/mc/linux-2.3.99/drivers/isdn/avmb1/capi.c:939:capi_write: ERROR: Unchecked use of malloc'd var 'skb'
/u3/whuang/mc/linux-2.3.99/drivers/isdn/avmb1/capi.c:944:capi_write: ERROR: Unchecked use of malloc'd var 'skb'
/u3/whuang/mc/linux-2.3.99/drivers/isdn/avmb1/capi.c:948:capi_write: ERROR: Unchecked use of malloc'd var 'skb'
/u3/whuang/mc/linux-2.3.99/drivers/isdn/avmb1/capi.c:950:capi_write: ERROR: Unchecked use of malloc'd var 'skb'
/u3/whuang/mc/linux-2.3.99/drivers/isdn/avmb1/capi.c:953:capi_write: ERROR: Unchecked use of malloc'd var 'skb'
/u3/whuang/mc/linux-2.3.99/drivers/isdn/avmb1/capi.c:956:capi_write: ERROR: Unchecked use of malloc'd var 'skb'
...needd to find implementations of skb_* fn's
--------------------------------------------------
/u3/whuang/mc/linux-2.3.99/drivers/isdn/avmb1/capidrv.c:676:send_message: ERROR: Unchecked use of malloc'd var 'skb'
/u3/whuang/mc/linux-2.3.99/drivers/isdn/avmb1/capidrv.c:677:send_message: ERROR: Unchecked use of malloc'd var 'skb'
--------------------------------------------------
/u3/whuang/mc/linux-2.3.99/drivers/isdn/eicon/eicon_idi.c:3226:eicon_idi_manage: ERROR: did not free skb on error path
/u3/whuang/mc/linux-2.3.99/drivers/isdn/eicon/eicon_idi.c:3230:eicon_idi_manage: ERROR: did not free skb on error path
/u3/whuang/mc/linux-2.3.99/drivers/isdn/eicon/eicon_idi.c:422:idi_do_req: ERROR: did not free skb on error path
--------------------------------------------------
/u3/whuang/mc/linux-2.3.99/drivers/isdn/hisax/isdnl2.c:1378:l2_pull_iqueue: ERROR: Unchecked use of malloc'd var 'skb'
/u3/whuang/mc/linux-2.3.99/drivers/isdn/hisax/isdnl2.c:1379:l2_pull_iqueue: ERROR: Unchecked use of malloc'd var 'skb'
/u3/whuang/mc/linux-2.3.99/drivers/isdn/hisax/isdnl2.c:1382:l2_pull_iqueue: ERROR: Unchecked use of malloc'd var 'skb'
--------------------------------------------------
/u3/whuang/mc/linux-2.3.99/drivers/net/appletalk/cops.c:803:cops_rx: ERROR: Unchecked use of malloc'd var 'skb'
/u3/whuang/mc/linux-2.3.99/drivers/net/appletalk/cops.c:816:cops_rx: ERROR: Unchecked use of malloc'd var 'skb'
/u3/whuang/mc/linux-2.3.99/drivers/net/appletalk/cops.c:823:cops_rx: ERROR: Unchecked use of malloc'd var 'skb'
/u3/whuang/mc/linux-2.3.99/drivers/net/appletalk/cops.c:824:cops_rx: ERROR: Unchecked use of malloc'd var 'skb'
/u3/whuang/mc/linux-2.3.99/drivers/net/appletalk/cops.c:833:cops_rx: ERROR: Unchecked use of malloc'd var 'skb'
/u3/whuang/mc/linux-2.3.99/drivers/net/appletalk/cops.c:837:cops_rx: ERROR: Unchecked use of malloc'd var 'skb'
/u3/whuang/mc/linux-2.3.99/drivers/net/appletalk/cops.c:838:cops_rx: ERROR: Unchecked use of malloc'd var 'skb'
/u3/whuang/mc/linux-2.3.99/drivers/net/appletalk/cops.c:839:cops_rx: ERROR: Unchecked use of malloc'd var 'skb'
/u3/whuang/mc/linux-2.3.99/drivers/net/appletalk/cops.c:843:cops_rx: ERROR: Unchecked use of malloc'd var 'skb'
/u3/whuang/mc/linux-2.3.99/drivers/net/appletalk/cops.c:846:cops_rx: ERROR: Unchecked use of malloc'd var 'skb'
--------------------------------------------------
/u3/whuang/mc/linux-2.3.99/drivers/net/appletalk/ltpc.c:1145:ltpc_probe: ERROR: did not free ltdmabuf on error path
/u3/whuang/mc/linux-2.3.99/drivers/net/appletalk/ltpc.c:1181:ltpc_probe: ERROR: did not free ltdmabuf on error path
--------------------------------------------------
CONFIRMED [UNCHECK]
/u3/whuang/mc/linux-2.3.99/drivers/net/arcnet/arc-rimi.c:348:arcrimi_setup: ERROR: Unchecked use of malloc'd var 'dev'
/u3/whuang/mc/linux-2.3.99/drivers/net/arcnet/arc-rimi.c:349:arcrimi_setup: ERROR: Unchecked use of malloc'd var 'dev'
/u3/whuang/mc/linux-2.3.99/drivers/net/arcnet/arc-rimi.c:350:arcrimi_setup: ERROR: Unchecked use of malloc'd var 'dev'
/u3/whuang/mc/linux-2.3.99/drivers/net/arcnet/arc-rimi.c:356:arcrimi_setup: ERROR: Unchecked use of malloc'd var 'dev'
/u3/whuang/mc/linux-2.3.99/drivers/net/arcnet/arc-rimi.c:358:arcrimi_setup: ERROR: Unchecked use of malloc'd var 'dev'
/u3/whuang/mc/linux-2.3.99/drivers/net/arcnet/arc-rimi.c:360:arcrimi_setup: ERROR: Unchecked use of malloc'd var 'dev'
/u3/whuang/mc/linux-2.3.99/drivers/net/arcnet/arc-rimi.c:363:arcrimi_setup: ERROR: Unchecked use of malloc'd var 'dev'
/u3/whuang/mc/linux-2.3.99/drivers/net/arcnet/arc-rimi.c:365:arcrimi_setup: ERROR: Unchecked use of malloc'd var 'dev'
/u3/whuang/mc/linux-2.3.99/drivers/net/arcnet/arc-rimi.c:366:arcrimi_setup: ERROR: Unchecked use of malloc'd var 'dev'
==>dev = alloc_bootmem(sizeof(struct net_device) + 10);
	memset(dev, 0, sizeof(struct net_device) + 10);
	dev->name = (char *) (dev + 1);
	dev->init = arcrimi_probe;
--------------------------------------------------
CONFIRMED [UNCHECK]
/u3/whuang/mc/linux-2.3.99/drivers/net/arcnet/com20020-isa.c:198:com20020isa_setup: ERROR: Unchecked use of malloc'd var 'dev'
/u3/whuang/mc/linux-2.3.99/drivers/net/arcnet/com20020-isa.c:199:com20020isa_setup: ERROR: Unchecked use of malloc'd var 'dev'
/u3/whuang/mc/linux-2.3.99/drivers/net/arcnet/com20020-isa.c:200:com20020isa_setup: ERROR: Unchecked use of malloc'd var 'dev'
/u3/whuang/mc/linux-2.3.99/drivers/net/arcnet/com20020-isa.c:201:com20020isa_setup: ERROR: Unchecked use of malloc'd var 'dev'
/u3/whuang/mc/linux-2.3.99/drivers/net/arcnet/com20020-isa.c:213:com20020isa_setup: ERROR: Unchecked use of malloc'd var 'dev'
/u3/whuang/mc/linux-2.3.99/drivers/net/arcnet/com20020-isa.c:215:com20020isa_setup: ERROR: Unchecked use of malloc'd var 'dev'
/u3/whuang/mc/linux-2.3.99/drivers/net/arcnet/com20020-isa.c:217:com20020isa_setup: ERROR: Unchecked use of malloc'd var 'dev'
/u3/whuang/mc/linux-2.3.99/drivers/net/arcnet/com20020-isa.c:220:com20020isa_setup: ERROR: Unchecked use of malloc'd var 'dev'
/u3/whuang/mc/linux-2.3.99/drivers/net/arcnet/com20020-isa.c:222:com20020isa_setup: ERROR: Unchecked use of malloc'd var 'dev'
/u3/whuang/mc/linux-2.3.99/drivers/net/arcnet/com20020-isa.c:223:com20020isa_setup: ERROR: Unchecked use of malloc'd var 'dev'
==>dev = alloc_bootmem(sizeof(struct net_device) + sizeof(struct arcnet_local) + 10);
	memset(dev, 0, sizeof(struct net_device) + sizeof(struct arcnet_local) + 10);
	lp = dev->priv = (struct arcnet_local *) (dev + 1);
	dev->name = (char *) (lp + 1);
	dev->init = com20020isa_probe;
--------------------------------------------------
/u3/whuang/mc/linux-2.3.99/drivers/net/arcnet/com20020-pci.c:80:com20020pci_probe: ERROR: did not free dev on error path
--------------------------------------------------
CONFIRMED [UNCHECK]
/u3/whuang/mc/linux-2.3.99/drivers/net/arcnet/com90io.c:431:com90io_setup: ERROR: Unchecked use of malloc'd var 'dev'
/u3/whuang/mc/linux-2.3.99/drivers/net/arcnet/com90io.c:432:com90io_setup: ERROR: Unchecked use of malloc'd var 'dev'
/u3/whuang/mc/linux-2.3.99/drivers/net/arcnet/com90io.c:433:com90io_setup: ERROR: Unchecked use of malloc'd var 'dev'
/u3/whuang/mc/linux-2.3.99/drivers/net/arcnet/com90io.c:439:com90io_setup: ERROR: Unchecked use of malloc'd var 'dev'
/u3/whuang/mc/linux-2.3.99/drivers/net/arcnet/com90io.c:441:com90io_setup: ERROR: Unchecked use of malloc'd var 'dev'
/u3/whuang/mc/linux-2.3.99/drivers/net/arcnet/com90io.c:444:com90io_setup: ERROR: Unchecked use of malloc'd var 'dev'
/u3/whuang/mc/linux-2.3.99/drivers/net/arcnet/com90io.c:446:com90io_setup: ERROR: Unchecked use of malloc'd var 'dev'
/u3/whuang/mc/linux-2.3.99/drivers/net/arcnet/com90io.c:447:com90io_setup: ERROR: Unchecked use of malloc'd var 'dev'
==>dev = alloc_bootmem(sizeof(struct net_device) + 10);
	memset(dev, 0, sizeof(struct net_device) + 10);
	dev->name = (char *) (dev + 1);
	dev->init = com90io_probe;
--------------------------------------------------
/u3/whuang/mc/linux-2.3.99/drivers/net/arcnet/com90xx.c:508:com90xx_found: ERROR: did not free dev on error path
--------------------------------------------------
CONFIRMED [UNCHECK]
/u3/whuang/mc/linux-2.3.99/drivers/net/arcnet/com90xx.c:680:com90xx_setup: ERROR: Unchecked use of malloc'd var 'dev'
/u3/whuang/mc/linux-2.3.99/drivers/net/arcnet/com90xx.c:681:com90xx_setup: ERROR: Unchecked use of malloc'd var 'dev'
/u3/whuang/mc/linux-2.3.99/drivers/net/arcnet/com90xx.c:682:com90xx_setup: ERROR: Unchecked use of malloc'd var 'dev'
/u3/whuang/mc/linux-2.3.99/drivers/net/arcnet/com90xx.c:688:com90xx_setup: ERROR: Unchecked use of malloc'd var 'dev'
/u3/whuang/mc/linux-2.3.99/drivers/net/arcnet/com90xx.c:690:com90xx_setup: ERROR: Unchecked use of malloc'd var 'dev'
/u3/whuang/mc/linux-2.3.99/drivers/net/arcnet/com90xx.c:692:com90xx_setup: ERROR: Unchecked use of malloc'd var 'dev'
/u3/whuang/mc/linux-2.3.99/drivers/net/arcnet/com90xx.c:695:com90xx_setup: ERROR: Unchecked use of malloc'd var 'dev'
/u3/whuang/mc/linux-2.3.99/drivers/net/arcnet/com90xx.c:697:com90xx_setup: ERROR: Unchecked use of malloc'd var 'dev'
/u3/whuang/mc/linux-2.3.99/drivers/net/arcnet/com90xx.c:698:com90xx_setup: ERROR: Unchecked use of malloc'd var 'dev'
==>dev = alloc_bootmem(sizeof(struct net_device) + 10);
	memset(dev, 0, sizeof(struct net_device) + 10);
	dev->name = (char *) (dev + 1);
	dev->init = com90xx_probe;
	...
--------------------------------------------------
/u3/whuang/mc/linux-2.3.99/drivers/net/fc/iph5526.c:3144:rx_net_packet: ERROR: Unchecked use of malloc'd var 'skb'
/u3/whuang/mc/linux-2.3.99/drivers/net/fc/iph5526.c:3145:rx_net_packet: ERROR: Unchecked use of malloc'd var 'skb'
/u3/whuang/mc/linux-2.3.99/drivers/net/fc/iph5526.c:3146:rx_net_packet: ERROR: Unchecked use of malloc'd var 'skb'
/u3/whuang/mc/linux-2.3.99/drivers/net/fc/iph5526.c:3147:rx_net_packet: ERROR: Unchecked use of malloc'd var 'skb'
/u3/whuang/mc/linux-2.3.99/drivers/net/fc/iph5526.c:3152:rx_net_packet: ERROR: Unchecked use of malloc'd var 'skb'
/u3/whuang/mc/linux-2.3.99/drivers/net/fc/iph5526.c:3153:rx_net_packet: ERROR: Unchecked use of malloc'd var 'skb'
/u3/whuang/mc/linux-2.3.99/drivers/net/fc/iph5526.c:3154:rx_net_packet: ERROR: Unchecked use of malloc'd var 'skb'
--------------------------------------------------
/u3/whuang/mc/linux-2.3.99/drivers/net/irda/irtty.c:255:irtty_open: ERROR: did not free dev on error path
/u3/whuang/mc/linux-2.3.99/drivers/net/irda/nsc-ircc.c:354:nsc_ircc_open: ERROR: did not free dev on error path
/u3/whuang/mc/linux-2.3.99/drivers/net/irda/toshoboe.c:854:toshoboe_open: ERROR: did not free dev on error path
/u3/whuang/mc/linux-2.3.99/drivers/net/irda/w83977af_ir.c:262:w83977af_open: ERROR: did not free dev on error path
--------------------------------------------------
/u3/whuang/mc/linux-2.3.99/drivers/net/pcmcia/xircom_tulip_cb.c:2375:tulip_init_ring: ERROR: Unchecked use of malloc'd var 'skb'
/u3/whuang/mc/linux-2.3.99/drivers/net/skfp/skfddi.c:1960:mac_drv_requeue_rxd: ERROR: Using 'skb' illegally!
/u3/whuang/mc/linux-2.3.99/drivers/net/skfp/skfddi.c:425:skfp_probe: ERROR: did not free tmp on error path
--------------------------------------------------
/u3/whuang/mc/linux-2.3.99/drivers/net/tokenring/lanstreamer.c:1408:streamer_arb_cmd: ERROR: Unchecked use of malloc'd var 'mac_frame'
/u3/whuang/mc/linux-2.3.99/drivers/net/tokenring/lanstreamer.c:1426:streamer_arb_cmd: ERROR: Unchecked use of malloc'd var 'mac_frame'
/u3/whuang/mc/linux-2.3.99/drivers/net/tokenring/lanstreamer.c:1427:streamer_arb_cmd: ERROR: Unchecked use of malloc'd var 'mac_frame'
/u3/whuang/mc/linux-2.3.99/drivers/net/tokenring/lanstreamer.c:1428:streamer_arb_cmd: ERROR: Unchecked use of malloc'd var 'mac_frame'
==>	mac_frame = dev_alloc_skb(frame_len);
		/* Walk the buffer chain, creating the frame */
		do {
			...
-->		memcpy_fromio(skb_put(mac_frame, buffer_len),
				      frame_data, buffer_len);
		} while (next_ptr && (buff_off = next_ptr));
		...
-->	mac_frame->dev = dev;
		mac_frame->protocol = tr_type_trans(mac_frame, dev);
		netif_rx(mac_frame);
--------------------------------------------------
FALSE POSITIVE [FREE_FN]
/u3/whuang/mc/linux-2.3.99/drivers/net/tokenring/lanstreamer.c:355:streamer_reset: ERROR: did not free skb on error path
/u3/whuang/mc/linux-2.3.99/drivers/net/tokenring/lanstreamer.c:389:streamer_reset: ERROR: did not free skb on error path
/u3/whuang/mc/linux-2.3.99/drivers/net/tokenring/lanstreamer.c:669:streamer_open: ERROR: did not free skb on error path
/u3/whuang/mc/linux-2.3.99/drivers/net/tokenring/lanstreamer.c:686:streamer_open: ERROR: did not free skb on error path
--------------------------------------------------
CONFIRMED [UNCHECK]
/u3/whuang/mc/linux-2.3.99/drivers/net/tokenring/olympic.c:1233:olympic_arb_cmd: ERROR: Unchecked use of malloc'd var 'mac_frame'
/u3/whuang/mc/linux-2.3.99/drivers/net/tokenring/olympic.c:1244:olympic_arb_cmd: ERROR: Unchecked use of malloc'd var 'mac_frame'
/u3/whuang/mc/linux-2.3.99/drivers/net/tokenring/olympic.c:1245:olympic_arb_cmd: ERROR: Unchecked use of malloc'd var 'mac_frame'
/u3/whuang/mc/linux-2.3.99/drivers/net/tokenring/olympic.c:1246:olympic_arb_cmd: ERROR: Unchecked use of malloc'd var 'mac_frame'
==>	mac_frame = dev_alloc_skb(frame_len) ; 
		/* Walk the buffer chain, creating the frame */
		do {
			frame_data = buf_ptr+offsetof(struct mac_receive_buffer,frame_data) ; 
			buffer_len = ntohs(readw(buf_ptr+offsetof(struct mac_receive_buffer,buffer_length))); 
-->		memcpy_fromio(skb_put(mac_frame, buffer_len), frame_data , buffer_len ) ;
-->		next_ptr=readw(buf_ptr+offsetof(struct mac_receive_buffer,next)); 
		} while (next_ptr && (buf_ptr=olympic_priv->olympic_lap + ntohs(next_ptr)));
		...
--------------------------------------------------
/u3/whuang/mc/linux-2.3.99/drivers/net/tokenring/olympic.c:539:olympic_open: ERROR: did not free skb on error path
--------------------------------------------------
CONFIRMED [UNCHECK]
/u3/whuang/mc/linux-2.3.99/drivers/net/tokenring/smctr.c:3955:smctr_process_rx_packet: ERROR: Unchecked use of malloc'd var 'skb'
/u3/whuang/mc/linux-2.3.99/drivers/net/tokenring/smctr.c:3958:smctr_process_rx_packet: ERROR: Unchecked use of malloc'd var 'skb'
/u3/whuang/mc/linux-2.3.99/drivers/net/tokenring/smctr.c:3959:smctr_process_rx_packet: ERROR: Unchecked use of malloc'd var 'skb'
/u3/whuang/mc/linux-2.3.99/drivers/net/tokenring/smctr.c:3963:smctr_process_rx_packet: ERROR: Unchecked use of malloc'd var 'skb'
/u3/whuang/mc/linux-2.3.99/drivers/net/tokenring/smctr.c:3966:smctr_process_rx_packet: ERROR: Unchecked use of malloc'd var 'skb'
/u3/whuang/mc/linux-2.3.99/drivers/net/tokenring/smctr.c:3967:smctr_process_rx_packet: ERROR: Unchecked use of malloc'd var 'skb'
/u3/whuang/mc/linux-2.3.99/drivers/net/tokenring/smctr.c:3968:smctr_process_rx_packet: ERROR: Unchecked use of malloc'd var 'skb'
==>             skb = dev_alloc_skb(size);
                skb->len = size;
                /* Slide data into a sleek skb. */
                skb_put(skb, skb->len);
                memcpy(skb->data, rmf, skb->len);
--------------------------------------------------
POSSIBLE [UNCHECK]
/u3/whuang/mc/linux-2.3.99/drivers/net/tokenring/smctr.c:404:smctr_alloc_shared_memory: ERROR: Unchecked use of malloc'd var 'tp'
/u3/whuang/mc/linux-2.3.99/drivers/net/tokenring/smctr.c:410:smctr_alloc_shared_memory: ERROR: Unchecked use of malloc'd var 'tp'
/u3/whuang/mc/linux-2.3.99/drivers/net/tokenring/smctr.c:427:smctr_alloc_shared_memory: ERROR: Unchecked use of malloc'd var 'tp'
allocating from its own pool--no explicit return NULL
--------------------------------------------------
CONFIRMED [UNCHECK]
/u3/whuang/mc/linux-2.3.99/drivers/net/tokenring/smctr.c:4627:smctr_rx_frame: ERROR: Unchecked use of malloc'd var 'skb'
/u3/whuang/mc/linux-2.3.99/drivers/net/tokenring/smctr.c:4630:smctr_rx_frame: ERROR: Unchecked use of malloc'd var 'skb'
/u3/whuang/mc/linux-2.3.99/drivers/net/tokenring/smctr.c:4632:smctr_rx_frame: ERROR: Unchecked use of malloc'd var 'skb'
/u3/whuang/mc/linux-2.3.99/drivers/net/tokenring/smctr.c:4637:smctr_rx_frame: ERROR: Unchecked use of malloc'd var 'skb'
/u3/whuang/mc/linux-2.3.99/drivers/net/tokenring/smctr.c:4640:smctr_rx_frame: ERROR: Unchecked use of malloc'd var 'skb'
/u3/whuang/mc/linux-2.3.99/drivers/net/tokenring/smctr.c:4641:smctr_rx_frame: ERROR: Unchecked use of malloc'd var 'skb'
/u3/whuang/mc/linux-2.3.99/drivers/net/tokenring/smctr.c:4642:smctr_rx_frame: ERROR: Unchecked use of malloc'd var 'skb'
==>                             skb = dev_alloc_skb(rx_size);
-->                             skb_put(skb, rx_size);
-->                             memcpy(skb->data, pbuff, rx_size);
                                sti();
                                /* Update Counters */
                                tp->MacStat.rx_packets++;
                                tp->MacStat.rx_bytes += skb->len;
                                /* Kick the packet on up. */
                                skb->dev = dev;
                                skb->protocol = tr_type_trans(skb, dev);
                                netif_rx(skb);
---------------------------------------------------
/u3/whuang/mc/linux-2.3.99/drivers/net/tokenring/tms380tr.c:2168:tms380tr_rcv_status_irq: ERROR: Using 'skb' illegally!
/u3/whuang/mc/linux-2.3.99/drivers/net/tokenring/tms380tr.c:2173:tms380tr_rcv_status_irq: ERROR: Using 'skb' illegally!
/u3/whuang/mc/linux-2.3.99/drivers/net/tulip/tulip_core.c:1039:tulip_init_one: ERROR: Unchecked use of malloc'd var 'tp'
/u3/whuang/mc/linux-2.3.99/drivers/net/tulip/tulip_core.c:557:tulip_init_ring: ERROR: Unchecked use of malloc'd var 'skb'
/u3/whuang/mc/linux-2.3.99/drivers/net/wan/comx-hw-mixcom.c:151:hscx_empty_fifo: ERROR: Using 'hw' illegally!
--------------------------------------------------
CONFIRMED [UNCHECK]
/u3/whuang/mc/linux-2.3.99/drivers/pci/pci.c:1004:pci_alloc_primary_bus: ERROR: Unchecked use of malloc'd var 'b'
/u3/whuang/mc/linux-2.3.99/drivers/pci/pci.c:1006:pci_alloc_primary_bus: ERROR: Unchecked use of malloc'd var 'b'
/u3/whuang/mc/linux-2.3.99/drivers/pci/pci.c:1007:pci_alloc_primary_bus: ERROR: Unchecked use of malloc'd var 'b'
/u3/whuang/mc/linux-2.3.99/drivers/pci/pci.c:1008:pci_alloc_primary_bus: ERROR: Unchecked use of malloc'd var 'b'
/u3/whuang/mc/linux-2.3.99/drivers/pci/pci.c:1009:pci_alloc_primary_bus: ERROR: Unchecked use of malloc'd var 'b'
==>b = pci_alloc_bus();
	list_add_tail(&b->node, &pci_root_buses);
	b->number = b->secondary = bus;
	b->resource[0] = &ioport_resource;
	b->resource[1] = &iomem_resource;
--------------------------------------------------
CONFIRMED [UNCHECK]
/u3/whuang/mc/linux-2.3.99/drivers/pci/pci.c:640:pci_add_new_bus: ERROR: Unchecked use of malloc'd var 'child'
/u3/whuang/mc/linux-2.3.99/drivers/pci/pci.c:641:pci_add_new_bus: ERROR: Unchecked use of malloc'd var 'child'
/u3/whuang/mc/linux-2.3.99/drivers/pci/pci.c:642:pci_add_new_bus: ERROR: Unchecked use of malloc'd var 'child'
/u3/whuang/mc/linux-2.3.99/drivers/pci/pci.c:643:pci_add_new_bus: ERROR: Unchecked use of malloc'd var 'child'
/u3/whuang/mc/linux-2.3.99/drivers/pci/pci.c:644:pci_add_new_bus: ERROR: Unchecked use of malloc'd var 'child'
/u3/whuang/mc/linux-2.3.99/drivers/pci/pci.c:645:pci_add_new_bus: ERROR: Unchecked use of malloc'd var 'child'
/u3/whuang/mc/linux-2.3.99/drivers/pci/pci.c:651:pci_add_new_bus: ERROR: Unchecked use of malloc'd var 'child'
/u3/whuang/mc/linux-2.3.99/drivers/pci/pci.c:652:pci_add_new_bus: ERROR: Unchecked use of malloc'd var 'child'
/u3/whuang/mc/linux-2.3.99/drivers/pci/pci.c:653:pci_add_new_bus: ERROR: Unchecked use of malloc'd var 'child'
/u3/whuang/mc/linux-2.3.99/drivers/pci/pci.c:655:pci_add_new_bus: ERROR: Unchecked use of malloc'd var 'child'
	child = pci_alloc_bus();
==>list_add_tail(&child->node, &parent->children);
	child->self = dev;
	dev->subordinate = child;
	child->parent = parent;
	child->ops = parent->ops;
	child->sysdata = parent->sysdata;
--------------------------------------------------
CONFIRMED [UNCHECK]
/u3/whuang/mc/linux-2.3.99/drivers/scsi/aha1542.c:697:aha1542_queuecommand: ERROR: Unchecked use of malloc'd var 'SCpnt'
		SCpnt->host_scribble = (unsigned char *) scsi_malloc(512);
		sgpnt = (struct scatterlist *) SCpnt->request_buffer;
		cptr = (struct chain *) SCpnt->host_scribble;
--------------------------------------------------
CONFIRMED [UNCHECK]
/u3/whuang/mc/linux-2.3.99/drivers/scsi/aha1740.c:393:aha1740_queuecommand: ERROR: Unchecked use of malloc'd var 'SCpnt'
	SCpnt->host_scribble = (unsigned char *) scsi_malloc(512);
	sgpnt = (struct scatterlist *) SCpnt->request_buffer;
	cptr = (struct aha1740_chain *) SCpnt->host_scribble; 
--------------------------------------------------
CONFIRMED [UNCHECK]
/u3/whuang/mc/linux-2.3.99/drivers/scsi/eata_dma_proc.c:169:eata_proc_info: ERROR: Unchecked use of malloc'd var 'scmd'
/u3/whuang/mc/linux-2.3.99/drivers/scsi/eata_dma_proc.c:170:eata_proc_info: ERROR: Unchecked use of malloc'd var 'scmd'
/u3/whuang/mc/linux-2.3.99/drivers/scsi/eata_dma_proc.c:176:eata_proc_info: ERROR: Unchecked use of malloc'd var 'scmd'
/u3/whuang/mc/linux-2.3.99/drivers/scsi/eata_dma_proc.c:294:eata_proc_info: ERROR: Unchecked use of malloc'd var 'scmd'
/u3/whuang/mc/linux-2.3.99/drivers/scsi/eata_dma_proc.c:295:eata_proc_info: ERROR: Unchecked use of malloc'd var 'scmd'
/u3/whuang/mc/linux-2.3.99/drivers/scsi/eata_dma_proc.c:301:eata_proc_info: ERROR: Unchecked use of malloc'd var 'scmd'
/u3/whuang/mc/linux-2.3.99/drivers/scsi/eata_dma_proc.c:336:eata_proc_info: ERROR: Unchecked use of malloc'd var 'scmd'
==>scmd  = scsi_allocate_request(SDev);
	...
	scmd->sr_cmd_len = 10;
	scmd->sr_data_direction = SCSI_DATA_READ;
	...
lots more below
--------------------------------------------------
CONFIRMED [UNCHECK]
/u3/whuang/mc/linux-2.3.99/drivers/scsi/gdth.c:3577:gdth_flush: ERROR: Unchecked use of malloc'd var 'scp'
/u3/whuang/mc/linux-2.3.99/drivers/scsi/gdth.c:3578:gdth_flush: ERROR: Unchecked use of malloc'd var 'scp'
/u3/whuang/mc/linux-2.3.99/drivers/scsi/gdth.c:3589:gdth_flush: ERROR: Unchecked use of malloc'd var 'scp'
/u3/whuang/mc/linux-2.3.99/drivers/scsi/gdth.c:3592:gdth_flush: ERROR: Unchecked use of malloc'd var 'scp'
==>scp  = scsi_allocate_device(sdev, 1, FALSE);
    scp->cmd_len = 12;
    scp->use_sg = 0;
--------------------------------------------------
CONFIRMED [UNCHECK]
/u3/whuang/mc/linux-2.3.99/drivers/scsi/gdth.c:3617:gdth_halt: ERROR: Unchecked use of malloc'd var 'scp'
/u3/whuang/mc/linux-2.3.99/drivers/scsi/gdth.c:3618:gdth_halt: ERROR: Unchecked use of malloc'd var 'scp'
/u3/whuang/mc/linux-2.3.99/drivers/scsi/gdth.c:3624:gdth_halt: ERROR: Unchecked use of malloc'd var 'scp'
/u3/whuang/mc/linux-2.3.99/drivers/scsi/gdth.c:3625:gdth_halt: ERROR: Unchecked use of malloc'd var 'scp'
	scp  = scsi_allocate_device(sdev, 1, FALSE);
        scp->cmd_len = 12;
        scp->use_sg = 0;
--------------------------------------------------
/u3/whuang/mc/linux-2.3.99/drivers/scsi/gdth_proc.c:421:gdth_get_info: ERROR: Unchecked use of malloc'd var 'scp'
/u3/whuang/mc/linux-2.3.99/drivers/scsi/gdth_proc.c:422:gdth_get_info: ERROR: Unchecked use of malloc'd var 'scp'
/u3/whuang/mc/linux-2.3.99/drivers/scsi/gdth_proc.c:43:gdth_set_info: ERROR: Unchecked use of malloc'd var 'scp'
/u3/whuang/mc/linux-2.3.99/drivers/scsi/gdth_proc.c:44:gdth_set_info: ERROR: Unchecked use of malloc'd var 'scp'
/u3/whuang/mc/linux-2.3.99/drivers/scsi/gdth_proc.c:50:gdth_set_info: ERROR: Unchecked use of malloc'd var 'scp'
/u3/whuang/mc/linux-2.3.99/drivers/scsi/gdth_proc.c:528:gdth_get_info: ERROR: Unchecked use of malloc'd var 'scp'
/u3/whuang/mc/linux-2.3.99/drivers/scsi/gdth_proc.c:529:gdth_get_info: ERROR: Unchecked use of malloc'd var 'scp'
/u3/whuang/mc/linux-2.3.99/drivers/scsi/gdth_proc.c:52:gdth_set_info: ERROR: Unchecked use of malloc'd var 'scp'
/u3/whuang/mc/linux-2.3.99/drivers/scsi/gdth_proc.c:548:gdth_get_info: ERROR: Unchecked use of malloc'd var 'scp'
/u3/whuang/mc/linux-2.3.99/drivers/scsi/gdth_proc.c:549:gdth_get_info: ERROR: Unchecked use of malloc'd var 'scp'
/u3/whuang/mc/linux-2.3.99/drivers/scsi/gdth_proc.c:599:gdth_get_info: ERROR: Unchecked use of malloc'd var 'scp'
/u3/whuang/mc/linux-2.3.99/drivers/scsi/gdth_proc.c:600:gdth_get_info: ERROR: Unchecked use of malloc'd var 'scp'
/u3/whuang/mc/linux-2.3.99/drivers/scsi/gdth_proc.c:61:gdth_set_info: ERROR: Unchecked use of malloc'd var 'scp'
/u3/whuang/mc/linux-2.3.99/drivers/scsi/gdth_proc.c:646:gdth_get_info: ERROR: Unchecked use of malloc'd var 'scp'
/u3/whuang/mc/linux-2.3.99/drivers/scsi/gdth_proc.c:647:gdth_get_info: ERROR: Unchecked use of malloc'd var 'scp'
/u3/whuang/mc/linux-2.3.99/drivers/scsi/gdth_proc.c:743:gdth_get_info: ERROR: Unchecked use of malloc'd var 'scp'
/u3/whuang/mc/linux-2.3.99/drivers/scsi/gdth_proc.c:744:gdth_get_info: ERROR: Unchecked use of malloc'd var 'scp'
/u3/whuang/mc/linux-2.3.99/drivers/scsi/gdth_proc.c:818:gdth_get_info: ERROR: Unchecked use of malloc'd var 'scp'
/u3/whuang/mc/linux-2.3.99/drivers/scsi/gdth_proc.c:819:gdth_get_info: ERROR: Unchecked use of malloc'd var 'scp'
/u3/whuang/mc/linux-2.3.99/drivers/scsi/gdth_proc.c:913:gdth_get_info: ERROR: Unchecked use of malloc'd var 'scp'
/u3/whuang/mc/linux-2.3.99/drivers/scsi/ide-scsi.c:728:idescsi_dma_bh: ERROR: Unchecked use of malloc'd var 'bh'
/u3/whuang/mc/linux-2.3.99/drivers/scsi/scsi_debug.c:559:scsi_debug_send_self_command: ERROR: Unchecked use of malloc'd var 'scp'
/u3/whuang/mc/linux-2.3.99/drivers/scsi/scsi_debug.c:561:scsi_debug_send_self_command: ERROR: Unchecked use of malloc'd var 'scp'
/u3/whuang/mc/linux-2.3.99/drivers/scsi/scsi_debug.c:562:scsi_debug_send_self_command: ERROR: Unchecked use of malloc'd var 'scp'
/u3/whuang/mc/linux-2.3.99/drivers/scsi/scsi_debug.c:566:scsi_debug_send_self_command: ERROR: Unchecked use of malloc'd var 'scp'
/u3/whuang/mc/linux-2.3.99/drivers/scsi/scsi_debug.c:569:scsi_debug_send_self_command: ERROR: Unchecked use of malloc'd var 'scp'
--------------------------------------------------
CONFIRMED [UNCHECK]
/u3/whuang/mc/linux-2.3.99/drivers/scsi/scsi_ioctl.c:104:ioctl_internal_command: ERROR: Unchecked use of malloc'd var 'SRpnt'
/u3/whuang/mc/linux-2.3.99/drivers/scsi/scsi_ioctl.c:105:ioctl_internal_command: ERROR: Unchecked use of malloc'd var 'SRpnt'
/u3/whuang/mc/linux-2.3.99/drivers/scsi/scsi_ioctl.c:107:ioctl_internal_command: ERROR: Unchecked use of malloc'd var 'SRpnt'
/u3/whuang/mc/linux-2.3.99/drivers/scsi/scsi_ioctl.c:109:ioctl_internal_command: ERROR: Unchecked use of malloc'd var 'SRpnt'
/u3/whuang/mc/linux-2.3.99/drivers/scsi/scsi_ioctl.c:110:ioctl_internal_command: ERROR: Unchecked use of malloc'd var 'SRpnt'
/u3/whuang/mc/linux-2.3.99/drivers/scsi/scsi_ioctl.c:125:ioctl_internal_command: ERROR: Unchecked use of malloc'd var 'SRpnt'
/u3/whuang/mc/linux-2.3.99/drivers/scsi/scsi_ioctl.c:135:ioctl_internal_command: ERROR: Unchecked use of malloc'd var 'SRpnt'
/u3/whuang/mc/linux-2.3.99/drivers/scsi/scsi_ioctl.c:139:ioctl_internal_command: ERROR: Unchecked use of malloc'd var 'SRpnt'
/u3/whuang/mc/linux-2.3.99/drivers/scsi/scsi_ioctl.c:143:ioctl_internal_command: ERROR: Unchecked use of malloc'd var 'SRpnt'
/u3/whuang/mc/linux-2.3.99/drivers/scsi/scsi_ioctl.c:146:ioctl_internal_command: ERROR: Unchecked use of malloc'd var 'SRpnt'
/u3/whuang/mc/linux-2.3.99/drivers/scsi/scsi_ioctl.c:147:ioctl_internal_command: ERROR: Unchecked use of malloc'd var 'SRpnt'
/u3/whuang/mc/linux-2.3.99/drivers/scsi/scsi_ioctl.c:148:ioctl_internal_command: ERROR: Unchecked use of malloc'd var 'SRpnt'
==>SRpnt = scsi_allocate_request(dev);
	SRpnt->sr_data_direction = SCSI_DATA_NONE;
        scsi_wait_req(SRpnt, cmd, NULL, 0, timeout, retries);
--------------------------------------------------
/u3/whuang/mc/linux-2.3.99/drivers/scsi/scsi_ioctl.c:299:scsi_ioctl_send_command: ERROR: did not free buf on error path
--------------------------------------------------
CONFIRMED [UNCHECK]
/u3/whuang/mc/linux-2.3.99/drivers/scsi/sd.c:732:sd_init_onedisk: ERROR: Unchecked use of malloc'd var 'SRpnt'
/u3/whuang/mc/linux-2.3.99/drivers/scsi/sd.c:733:sd_init_onedisk: ERROR: Unchecked use of malloc'd var 'SRpnt'
/u3/whuang/mc/linux-2.3.99/drivers/scsi/sd.c:734:sd_init_onedisk: ERROR: Unchecked use of malloc'd var 'SRpnt'
/u3/whuang/mc/linux-2.3.99/drivers/scsi/sd.c:735:sd_init_onedisk: ERROR: Unchecked use of malloc'd var 'SRpnt'
/u3/whuang/mc/linux-2.3.99/drivers/scsi/sd.c:738:sd_init_onedisk: ERROR: Unchecked use of malloc'd var 'buffer'
/u3/whuang/mc/linux-2.3.99/drivers/scsi/sd.c:738:sd_init_onedisk: ERROR: Unchecked use of malloc'd var 'SRpnt'
/u3/whuang/mc/linux-2.3.99/drivers/scsi/sd.c:740:sd_init_onedisk: ERROR: Unchecked use of malloc'd var 'SRpnt'
/u3/whuang/mc/linux-2.3.99/drivers/scsi/sd.c:742:sd_init_onedisk: ERROR: Unchecked use of malloc'd var 'SRpnt'
/u3/whuang/mc/linux-2.3.99/drivers/scsi/sd.c:752:sd_init_onedisk: ERROR: Unchecked use of malloc'd var 'SRpnt'
/u3/whuang/mc/linux-2.3.99/drivers/scsi/sd.c:765:sd_init_onedisk: ERROR: Unchecked use of malloc'd var 'SRpnt'
/u3/whuang/mc/linux-2.3.99/drivers/scsi/sd.c:775:sd_init_onedisk: ERROR: Unchecked use of malloc'd var 'SRpnt'
/u3/whuang/mc/linux-2.3.99/drivers/scsi/sd.c:776:sd_init_onedisk: ERROR: Unchecked use of malloc'd var 'SRpnt'
/u3/whuang/mc/linux-2.3.99/drivers/scsi/sd.c:777:sd_init_onedisk: ERROR: Unchecked use of malloc'd var 'SRpnt'
/u3/whuang/mc/linux-2.3.99/drivers/scsi/sd.c:779:sd_init_onedisk: ERROR: Unchecked use of malloc'd var 'SRpnt'
/u3/whuang/mc/linux-2.3.99/drivers/scsi/sd.c:781:sd_init_onedisk: ERROR: Unchecked use of malloc'd var 'buffer'
/u3/whuang/mc/linux-2.3.99/drivers/scsi/sd.c:781:sd_init_onedisk: ERROR: Unchecked use of malloc'd var 'SRpnt'
/u3/whuang/mc/linux-2.3.99/drivers/scsi/sd.c:805:sd_init_onedisk: ERROR: Unchecked use of malloc'd var 'buffer'
/u3/whuang/mc/linux-2.3.99/drivers/scsi/sd.c:806:sd_init_onedisk: ERROR: Unchecked use of malloc'd var 'SRpnt'
/u3/whuang/mc/linux-2.3.99/drivers/scsi/sd.c:807:sd_init_onedisk: ERROR: Unchecked use of malloc'd var 'SRpnt'
/u3/whuang/mc/linux-2.3.99/drivers/scsi/sd.c:808:sd_init_onedisk: ERROR: Unchecked use of malloc'd var 'SRpnt'
/u3/whuang/mc/linux-2.3.99/drivers/scsi/sd.c:810:sd_init_onedisk: ERROR: Unchecked use of malloc'd var 'SRpnt'
/u3/whuang/mc/linux-2.3.99/drivers/scsi/sd.c:812:sd_init_onedisk: ERROR: Unchecked use of malloc'd var 'buffer'
/u3/whuang/mc/linux-2.3.99/drivers/scsi/sd.c:812:sd_init_onedisk: ERROR: Unchecked use of malloc'd var 'SRpnt'
/u3/whuang/mc/linux-2.3.99/drivers/scsi/sd.c:814:sd_init_onedisk: ERROR: Unchecked use of malloc'd var 'SRpnt'
/u3/whuang/mc/linux-2.3.99/drivers/scsi/sd.c:844:sd_init_onedisk: ERROR: Unchecked use of malloc'd var 'SRpnt'
/u3/whuang/mc/linux-2.3.99/drivers/scsi/sd.c:855:sd_init_onedisk: ERROR: Unchecked use of malloc'd var 'SRpnt'
/u3/whuang/mc/linux-2.3.99/drivers/scsi/sd.c:868:sd_init_onedisk: ERROR: Unchecked use of malloc'd var 'buffer'
/u3/whuang/mc/linux-2.3.99/drivers/scsi/sd.c:871:sd_init_onedisk: ERROR: Unchecked use of malloc'd var 'buffer'
/u3/whuang/mc/linux-2.3.99/drivers/scsi/sd.c:957:sd_init_onedisk: ERROR: Unchecked use of malloc'd var 'SRpnt'
/u3/whuang/mc/linux-2.3.99/drivers/scsi/sd.c:958:sd_init_onedisk: ERROR: Unchecked use of malloc'd var 'SRpnt'
/u3/whuang/mc/linux-2.3.99/drivers/scsi/sd.c:959:sd_init_onedisk: ERROR: Unchecked use of malloc'd var 'SRpnt'
/u3/whuang/mc/linux-2.3.99/drivers/scsi/sd.c:962:sd_init_onedisk: ERROR: Unchecked use of malloc'd var 'SRpnt'
/u3/whuang/mc/linux-2.3.99/drivers/scsi/sd.c:964:sd_init_onedisk: ERROR: Unchecked use of malloc'd var 'buffer'
/u3/whuang/mc/linux-2.3.99/drivers/scsi/sd.c:964:sd_init_onedisk: ERROR: Unchecked use of malloc'd var 'SRpnt'
/u3/whuang/mc/linux-2.3.99/drivers/scsi/sd.c:966:sd_init_onedisk: ERROR: Unchecked use of malloc'd var 'SRpnt'
/u3/whuang/mc/linux-2.3.99/drivers/scsi/sd.c:972:sd_init_onedisk: ERROR: Unchecked use of malloc'd var 'buffer'
/u3/whuang/mc/linux-2.3.99/drivers/scsi/sd.c:978:sd_init_onedisk: ERROR: Unchecked use of malloc'd var 'SRpnt'
/u3/whuang/mc/linux-2.3.99/drivers/scsi/sd.c:979:sd_init_onedisk: ERROR: Unchecked use of malloc'd var 'SRpnt'
/u3/whuang/mc/linux-2.3.99/drivers/scsi/sd.c:980:sd_init_onedisk: ERROR: Unchecked use of malloc'd var 'SRpnt'
/u3/whuang/mc/linux-2.3.99/drivers/scsi/sd.c:982:sd_init_onedisk: ERROR: Unchecked use of malloc'd var 'SRpnt'
/u3/whuang/mc/linux-2.3.99/drivers/scsi/sd.c:983:sd_init_onedisk: ERROR: Unchecked use of malloc'd var 'SRpnt'
/u3/whuang/mc/linux-2.3.99/drivers/scsi/sd.c:985:sd_init_onedisk: ERROR: Unchecked use of malloc'd var 'buffer'
==>SRpnt = scsi_allocate_request(rscsi_disks[i].device);
==>buffer = (unsigned char *) scsi_malloc(512);
	spintime = 0;
	/* Spin up drives, as required.  Only do this at boot time */
	/* Spinup needs to be done for module loads too. */
	do {
		retries = 0;
		while (retries < 3) {
			cmd[0] = TEST_UNIT_READY;
			cmd[1] = (rscsi_disks[i].device->lun << 5) & 0xe0;
			memset((void *) &cmd[2], 0, 8);
-->		SRpnt->sr_cmd_len = 0;
			SRpnt->sr_sense_buffer[0] = 0;
			SRpnt->sr_sense_buffer[2] = 0;
			SRpnt->sr_data_direction = SCSI_DATA_READ;
			...
lots more below
--------------------------------------------------
/u3/whuang/mc/linux-2.3.99/drivers/scsi/sg.c:1567:sg_build_indi: ERROR: did not free p on error path
--------------------------------------------------
CONFIRM [UNCHECK]
/u3/whuang/mc/linux-2.3.99/drivers/scsi/sr.c:480:get_sectorsize: ERROR: Unchecked use of malloc'd var 'SRpnt'
/u3/whuang/mc/linux-2.3.99/drivers/scsi/sr.c:481:get_sectorsize: ERROR: Unchecked use of malloc'd var 'SRpnt'
/u3/whuang/mc/linux-2.3.99/drivers/scsi/sr.c:483:get_sectorsize: ERROR: Unchecked use of malloc'd var 'buffer'
/u3/whuang/mc/linux-2.3.99/drivers/scsi/sr.c:487:get_sectorsize: ERROR: Unchecked use of malloc'd var 'SRpnt'
/u3/whuang/mc/linux-2.3.99/drivers/scsi/sr.c:489:get_sectorsize: ERROR: Unchecked use of malloc'd var 'buffer'
/u3/whuang/mc/linux-2.3.99/drivers/scsi/sr.c:489:get_sectorsize: ERROR: Unchecked use of malloc'd var 'SRpnt'
/u3/whuang/mc/linux-2.3.99/drivers/scsi/sr.c:491:get_sectorsize: ERROR: Unchecked use of malloc'd var 'SRpnt'
/u3/whuang/mc/linux-2.3.99/drivers/scsi/sr.c:497:get_sectorsize: ERROR: Unchecked use of malloc'd var 'SRpnt'
/u3/whuang/mc/linux-2.3.99/drivers/scsi/sr.c:498:get_sectorsize: ERROR: Unchecked use of malloc'd var 'SRpnt'
/u3/whuang/mc/linux-2.3.99/drivers/scsi/sr.c:512:get_sectorsize: ERROR: Unchecked use of malloc'd var 'buffer'
/u3/whuang/mc/linux-2.3.99/drivers/scsi/sr.c:514:get_sectorsize: ERROR: Unchecked use of malloc'd var 'buffer'
/u3/whuang/mc/linux-2.3.99/drivers/scsi/sr.c:548:get_sectorsize: ERROR: Unchecked use of malloc'd var 'buffer'
==>buffer = (unsigned char *) scsi_malloc(512);
==>SRpnt = scsi_allocate_request(scsi_CDs[i].device);
	retries = 3;
	do {
		cmd[0] = READ_CAPACITY;
		cmd[1] = (scsi_CDs[i].device->lun << 5) & 0xe0;
		memset((void *) &cmd[2], 0, 8);
-->	SRpnt->sr_request.rq_status = RQ
		...
--------------------------------------------------
CONFIRM [UNCHECK]
/u3/whuang/mc/linux-2.3.99/drivers/scsi/sr.c:575:get_capabilities: ERROR: Unchecked use of malloc'd var 'buffer'
/u3/whuang/mc/linux-2.3.99/drivers/scsi/sr.c:582:get_capabilities: ERROR: Unchecked use of malloc'd var 'buffer'
/u3/whuang/mc/linux-2.3.99/drivers/scsi/sr.c:585:get_capabilities: ERROR: Unchecked use of malloc'd var 'buffer'
/u3/whuang/mc/linux-2.3.99/drivers/scsi/sr.c:586:get_capabilities: ERROR: Unchecked use of malloc'd var 'buffer'
/u3/whuang/mc/linux-2.3.99/drivers/scsi/sr.c:588:get_capabilities: ERROR: Unchecked use of malloc'd var 'buffer'
/u3/whuang/mc/linux-2.3.99/drivers/scsi/sr.c:597:get_capabilities: ERROR: Unchecked use of malloc'd var 'buffer'
/u3/whuang/mc/linux-2.3.99/drivers/scsi/sr.c:598:get_capabilities: ERROR: Unchecked use of malloc'd var 'buffer'
/u3/whuang/mc/linux-2.3.99/drivers/scsi/sr.c:601:get_capabilities: ERROR: Unchecked use of malloc'd var 'buffer'
/u3/whuang/mc/linux-2.3.99/drivers/scsi/sr.c:604:get_capabilities: ERROR: Unchecked use of malloc'd var 'buffer'
/u3/whuang/mc/linux-2.3.99/drivers/scsi/sr.c:607:get_capabilities: ERROR: Unchecked use of malloc'd var 'buffer'
/u3/whuang/mc/linux-2.3.99/drivers/scsi/sr.c:610:get_capabilities: ERROR: Unchecked use of malloc'd var 'buffer'
/u3/whuang/mc/linux-2.3.99/drivers/scsi/sr.c:613:get_capabilities: ERROR: Unchecked use of malloc'd var 'buffer'
/u3/whuang/mc/linux-2.3.99/drivers/scsi/sr.c:616:get_capabilities: ERROR: Unchecked use of malloc'd var 'buffer'
/u3/whuang/mc/linux-2.3.99/drivers/scsi/sr.c:620:get_capabilities: ERROR: Unchecked use of malloc'd var 'buffer'
/u3/whuang/mc/linux-2.3.99/drivers/scsi/sr.c:631:get_capabilities: ERROR: Unchecked use of malloc'd var 'buffer'
==>buffer = (unsigned char *) scsi_malloc(512);
	cmd[0] = MODE_SENSE;
	cmd[1] = (scsi_CDs[i].device->lun << 5) & 0xe0;
	cmd[2] = 0x2a;
	cmd[4] = 128;
	cmd[3] = cmd[5] = 0;
	rc = sr_do_ioctl(i, cmd, buffer, 128, 1, SCSI_DATA_READ);
	...
--------------------------------------------------
CONFIRMED [UNCHECK]
/u3/whuang/mc/linux-2.3.99/drivers/scsi/sr_ioctl.c:116:sr_do_ioctl: ERROR: Unchecked use of malloc'd var 'SRpnt'
/u3/whuang/mc/linux-2.3.99/drivers/scsi/sr_ioctl.c:131:sr_do_ioctl: ERROR: Unchecked use of malloc'd var 'SRpnt'
/u3/whuang/mc/linux-2.3.99/drivers/scsi/sr_ioctl.c:135:sr_do_ioctl: ERROR: Unchecked use of malloc'd var 'SRpnt'
/u3/whuang/mc/linux-2.3.99/drivers/scsi/sr_ioctl.c:137:sr_do_ioctl: ERROR: Unchecked use of malloc'd var 'SRpnt'
/u3/whuang/mc/linux-2.3.99/drivers/scsi/sr_ioctl.c:138:sr_do_ioctl: ERROR: Unchecked use of malloc'd var 'SRpnt'
/u3/whuang/mc/linux-2.3.99/drivers/scsi/sr_ioctl.c:47:sr_do_ioctl: ERROR: Unchecked use of malloc'd var 'SRpnt'
/u3/whuang/mc/linux-2.3.99/drivers/scsi/sr_ioctl.c:50:sr_do_ioctl: ERROR: Unchecked use of malloc'd var 'SRpnt'
/u3/whuang/mc/linux-2.3.99/drivers/scsi/sr_ioctl.c:51:sr_do_ioctl: ERROR: Unchecked use of malloc'd var 'SRpnt'
/u3/whuang/mc/linux-2.3.99/drivers/scsi/sr_ioctl.c:63:sr_do_ioctl: ERROR: did not free bounce_buffer on error path
/u3/whuang/mc/linux-2.3.99/drivers/scsi/sr_ioctl.c:67:sr_do_ioctl: ERROR: Unchecked use of malloc'd var 'SRpnt'
/u3/whuang/mc/linux-2.3.99/drivers/scsi/sr_ioctl.c:69:sr_do_ioctl: ERROR: Unchecked use of malloc'd var 'SRpnt'
/u3/whuang/mc/linux-2.3.99/drivers/scsi/sr_ioctl.c:70:sr_do_ioctl: ERROR: Unchecked use of malloc'd var 'SRpnt'
/u3/whuang/mc/linux-2.3.99/drivers/scsi/sr_ioctl.c:71:sr_do_ioctl: ERROR: Unchecked use of malloc'd var 'SRpnt'
/u3/whuang/mc/linux-2.3.99/drivers/scsi/sr_ioctl.c:72:sr_do_ioctl: ERROR: Unchecked use of malloc'd var 'SRpnt'
/u3/whuang/mc/linux-2.3.99/drivers/scsi/sr_ioctl.c:73:sr_do_ioctl: ERROR: Unchecked use of malloc'd var 'SRpnt'
/u3/whuang/mc/linux-2.3.99/drivers/scsi/sr_ioctl.c:76:sr_do_ioctl: ERROR: Unchecked use of malloc'd var 'SRpnt'
/u3/whuang/mc/linux-2.3.99/drivers/scsi/sr_ioctl.c:80:sr_do_ioctl: ERROR: Unchecked use of malloc'd var 'SRpnt'
/u3/whuang/mc/linux-2.3.99/drivers/scsi/sr_ioctl.c:90:sr_do_ioctl: ERROR: Unchecked use of malloc'd var 'SRpnt'
==>SRpnt = scsi_allocate_request(scsi_CDs[target].device);
	SRpnt->sr_data_direction = readwrite;
	/* use ISA DMA buffer if necessary */
	SRpnt->sr_request.buffer = buffer;
--------------------------------------------------
CONFIRMED [UNCHECK]
/u3/whuang/mc/linux-2.3.99/drivers/scsi/wd7000.c:1171:wd7000_queuecommand: ERROR: Unchecked use of malloc'd var 'scb'
/u3/whuang/mc/linux-2.3.99/drivers/scsi/wd7000.c:1172:wd7000_queuecommand: ERROR: Unchecked use of malloc'd var 'scb'
/u3/whuang/mc/linux-2.3.99/drivers/scsi/wd7000.c:1173:wd7000_queuecommand: ERROR: Unchecked use of malloc'd var 'scb'
/u3/whuang/mc/linux-2.3.99/drivers/scsi/wd7000.c:1175:wd7000_queuecommand: ERROR: Unchecked use of malloc'd var 'scb'
/u3/whuang/mc/linux-2.3.99/drivers/scsi/wd7000.c:1176:wd7000_queuecommand: ERROR: Unchecked use of malloc'd var 'scb'
/u3/whuang/mc/linux-2.3.99/drivers/scsi/wd7000.c:1177:wd7000_queuecommand: ERROR: Unchecked use of malloc'd var 'scb'
/u3/whuang/mc/linux-2.3.99/drivers/scsi/wd7000.c:1190:wd7000_queuecommand: ERROR: Unchecked use of malloc'd var 'scb'
/u3/whuang/mc/linux-2.3.99/drivers/scsi/wd7000.c:1191:wd7000_queuecommand: ERROR: Unchecked use of malloc'd var 'scb'
/u3/whuang/mc/linux-2.3.99/drivers/scsi/wd7000.c:1192:wd7000_queuecommand: ERROR: Unchecked use of malloc'd var 'scb'
/u3/whuang/mc/linux-2.3.99/drivers/scsi/wd7000.c:1193:wd7000_queuecommand: ERROR: Unchecked use of malloc'd var 'scb'
/u3/whuang/mc/linux-2.3.99/drivers/scsi/wd7000.c:1201:wd7000_queuecommand: ERROR: Unchecked use of malloc'd var 'scb'
/u3/whuang/mc/linux-2.3.99/drivers/scsi/wd7000.c:1202:wd7000_queuecommand: ERROR: Unchecked use of malloc'd var 'scb'
/u3/whuang/mc/linux-2.3.99/drivers/scsi/wd7000.c:1203:wd7000_queuecommand: ERROR: Unchecked use of malloc'd var 'scb'
/u3/whuang/mc/linux-2.3.99/drivers/scsi/wd7000.c:1206:wd7000_queuecommand: ERROR: Unchecked use of malloc'd var 'scb'
==> scb = alloc_scbs (1);
    scb->idlun = idlun;
    memcpy (scb->cdb, cdb, cdblen);
    scb->direc = 0x40;		/* Disable direction check */
	...
--------------------------------------------------
/u3/whuang/mc/linux-2.3.99/drivers/sound/es1370.c:569:prog_dmabuf: ERROR: did not free db on error path
/u3/whuang/mc/linux-2.3.99/drivers/sound/es1371.c:910:prog_dmabuf: ERROR: did not free db on error path
/u3/whuang/mc/linux-2.3.99/drivers/sound/esssolo1.c:429:prog_dmabuf: ERROR: did not free db on error path
/u3/whuang/mc/linux-2.3.99/drivers/sound/i810_audio.c:586:alloc_dmabuf: ERROR: did not free rawbuf on error path
/u3/whuang/mc/linux-2.3.99/drivers/sound/sonicvibes.c:740:prog_dmabuf: ERROR: did not free db on error path
/u3/whuang/mc/linux-2.3.99/drivers/sound/trident.c:931:alloc_dmabuf: ERROR: did not free rawbuf on error path
/u3/whuang/mc/linux-2.3.99/drivers/usb/devio.c:120:my_usb_control_msg: ERROR: did not free urb on error path
/u3/whuang/mc/linux-2.3.99/drivers/usb/devio.c:755:proc_submiturb: ERROR: did not free as on error path
/u3/whuang/mc/linux-2.3.99/drivers/usb/devio.c:784:proc_submiturb: ERROR: did not free as on error path
/u3/whuang/mc/linux-2.3.99/drivers/usb/mdc800.c:917:usb_mdc800_init: ERROR: did not free mdc800 on error path
/u3/whuang/mc/linux-2.3.99/drivers/usb/plusb.c:391:plusb_alloc: ERROR: did not free s on error path
/u3/whuang/mc/linux-2.3.99/drivers/usb/usb-ohci.c:1738:hc_start: ERROR: did not free usb_dev on error path
/u3/whuang/mc/linux-2.3.99/drivers/usb/usb-ohci.c:1891:hc_found_ohci: ERROR: did not free ohci on error path
/u3/whuang/mc/linux-2.3.99/drivers/usb/usb-ohci.c:1918:hc_found_ohci: ERROR: did not free ohci on error path
/u3/whuang/mc/linux-2.3.99/drivers/usb/usb-uhci.c:2631:uhci_start_usb: ERROR: did not free usb_dev on error path
/u3/whuang/mc/linux-2.3.99/drivers/usb/usb-uhci.c:2729:alloc_uhci: ERROR: did not free bus on error path
/u3/whuang/mc/linux-2.3.99/drivers/usb/usb-uhci.c:2745:alloc_uhci: ERROR: did not free bus on error path
/u3/whuang/mc/linux-2.3.99/drivers/usb/usb-uhci.c:2752:alloc_uhci: ERROR: did not free bus on error path
--------------------------------------------------
CONFIRMED [UNCHECK]
/u3/whuang/mc/linux-2.3.99/fs/hfs/binsert.c:421:binsert: ERROR: Unchecked use of malloc'd var 'tmpkey'
/u3/whuang/mc/linux-2.3.99/fs/hfs/binsert.c:423:binsert: ERROR: Unchecked use of malloc'd var 'tmpkey'
379
==>struct hfs_bkey *tmpkey = hfs_malloc(tmpsize);
	...
		key = tmpkey;
		keysize = tree->bthKeyLen;
		memcpy(tmpkey, bnode_key(right.bn, 1), keysize+1);
--------------------------------------------------
/u3/whuang/mc/linux-2.3.99/fs/hpfs/anode.c:148:hpfs_add_sector_to_btree: ERROR: did not free anode on error path
/u3/whuang/mc/linux-2.3.99/fs/hpfs/anode.c:165:hpfs_add_sector_to_btree: ERROR: did not free anode on error path
/u3/whuang/mc/linux-2.3.99/fs/hpfs/anode.c:167:hpfs_add_sector_to_btree: ERROR: did not free anode on error path
/u3/whuang/mc/linux-2.3.99/fs/hpfs/anode.c:170:hpfs_add_sector_to_btree: ERROR: did not free anode on error path
--------------------------------------------------
/u3/whuang/mc/linux-2.3.99/fs/hpfs/anode.c:184:hpfs_add_sector_to_btree: ERROR: Using 'anode' illegally!
/u3/whuang/mc/linux-2.3.99/fs/hpfs/anode.c:191:hpfs_add_sector_to_btree: ERROR: Using 'anode' illegally!
/u3/whuang/mc/linux-2.3.99/fs/hpfs/anode.c:193:hpfs_add_sector_to_btree: ERROR: Using 'anode' illegally!
/u3/whuang/mc/linux-2.3.99/fs/hpfs/anode.c:215:hpfs_add_sector_to_btree: ERROR: Using 'anode' illegally!
/u3/whuang/mc/linux-2.3.99/fs/hpfs/anode.c:223:hpfs_add_sector_to_btree: ERROR: did not free anode on error path
/u3/whuang/mc/linux-2.3.99/fs/hpfs/anode.c:229:hpfs_add_sector_to_btree: ERROR: did not free anode on error path
/u3/whuang/mc/linux-2.3.99/fs/hpfs/namei.c:126:hpfs_create: ERROR: did not free fnode on error path
/u3/whuang/mc/linux-2.3.99/fs/hpfs/namei.c:164:hpfs_create: ERROR: did not free fnode on error path
/u3/whuang/mc/linux-2.3.99/fs/hpfs/namei.c:194:hpfs_mknod: ERROR: did not free fnode on error path
/u3/whuang/mc/linux-2.3.99/fs/hpfs/namei.c:225:hpfs_mknod: ERROR: did not free fnode on error path
/u3/whuang/mc/linux-2.3.99/fs/hpfs/namei.c:256:hpfs_symlink: ERROR: did not free fnode on error path
/u3/whuang/mc/linux-2.3.99/fs/hpfs/namei.c:293:hpfs_symlink: ERROR: did not free fnode on error path
/u3/whuang/mc/linux-2.3.99/fs/hpfs/namei.c:46:hpfs_mkdir: ERROR: did not free fnode on error path
/u3/whuang/mc/linux-2.3.99/fs/hpfs/namei.c:97:hpfs_mkdir: ERROR: did not free fnode on error path
/u3/whuang/mc/linux-2.3.99/fs/nfs/write.c:529:nfs_create_request: ERROR: Using 'req' illegally!
/u3/whuang/mc/linux-2.3.99/ipc/sem.c:132:newary: ERROR: did not free sma on error path
--------------------------------------------------
/u3/whuang/mc/linux-2.3.99/ipc/shm.c:668:shm_setattr: ERROR: Unchecked use of malloc'd var 'new_dir'
/u3/whuang/mc/linux-2.3.99/ipc/shm.c:669:shm_setattr: ERROR: Unchecked use of malloc'd var 'new_dir'
/u3/whuang/mc/linux-2.3.99/ipc/shm.c:689:shm_setattr: ERROR: Unchecked use of malloc'd var 'new_dir'
/u3/whuang/mc/linux-2.3.99/ipc/shm.c:691:shm_setattr: ERROR: Unchecked use of malloc'd var 'new_dir'
/u3/whuang/mc/linux-2.3.99/ipc/shm.c:692:shm_setattr: ERROR: Unchecked use of malloc'd var 'new_dir'
/u3/whuang/mc/linux-2.3.99/ipc/shm.c:696:shm_setattr: ERROR: Unchecked use of malloc'd var 'new_dir'
/u3/whuang/mc/linux-2.3.99/ipc/shm.c:717:seg_alloc: ERROR: Unchecked use of malloc'd var 'dir'
/u3/whuang/mc/linux-2.3.99/ipc/shm.c:719:seg_alloc: ERROR: Unchecked use of malloc'd var 'dir'
/u3/whuang/mc/linux-2.3.99/ipc/shm.c:721:seg_alloc: ERROR: Unchecked use of malloc'd var 'dir'
IS_ERR?
--------------------------------------------------
/u3/whuang/mc/linux-2.3.99/mm/mremap.c:57:alloc_one_pte: ERROR: Unchecked use of malloc'd var 'pte'
/u3/whuang/mc/linux-2.3.99/mm/page_alloc.c:554:free_area_init_core: ERROR: Unchecked use of malloc'd var 'lmem_map'
/u3/whuang/mc/linux-2.3.99/mm/page_alloc.c:555:free_area_init_core: ERROR: Unchecked use of malloc'd var 'lmem_map'
/u3/whuang/mc/linux-2.3.99/mm/page_alloc.c:558:free_area_init_core: ERROR: Unchecked use of malloc'd var 'lmem_map'
/u3/whuang/mc/linux-2.3.99/mm/page_alloc.c:565:free_area_init_core: ERROR: Unchecked use of malloc'd var 'lmem_map'
/u3/whuang/mc/linux-2.3.99/mm/page_alloc.c:572:free_area_init_core: ERROR: Unchecked use of malloc'd var 'lmem_map'
/u3/whuang/mc/linux-2.3.99/mm/vmalloc.c:125:alloc_area_pmd: ERROR: did not free pte on error path
/u3/whuang/mc/linux-2.3.99/mm/vmalloc.c:147:vmalloc_area_pages: ERROR: did not free pmd on error path
/u3/whuang/mc/linux-2.3.99/net/appletalk/ddp.c:1241:atalk_create: ERROR: did not free sk on error path
/u3/whuang/mc/linux-2.3.99/net/appletalk/ddp.c:1855:atalk_sendmsg: ERROR: did not free skb on error path
/u3/whuang/mc/linux-2.3.99/net/atm/mpc.c:775:atm_mpoa_mpoad_attach: ERROR: Unchecked use of malloc'd var 'mpc'
/u3/whuang/mc/linux-2.3.99/net/atm/mpc.c:778:atm_mpoa_mpoad_attach: ERROR: Unchecked use of malloc'd var 'mpc'
/u3/whuang/mc/linux-2.3.99/net/atm/mpc.c:783:atm_mpoa_mpoad_attach: ERROR: Unchecked use of malloc'd var 'mpc'
/u3/whuang/mc/linux-2.3.99/net/atm/mpc.c:784:atm_mpoa_mpoad_attach: ERROR: Unchecked use of malloc'd var 'mpc'
/u3/whuang/mc/linux-2.3.99/net/atm/mpc.c:786:atm_mpoa_mpoad_attach: ERROR: Unchecked use of malloc'd var 'mpc'
/u3/whuang/mc/linux-2.3.99/net/atm/mpc.c:791:atm_mpoa_mpoad_attach: ERROR: Unchecked use of malloc'd var 'mpc'
/u3/whuang/mc/linux-2.3.99/net/atm/mpc.c:796:atm_mpoa_mpoad_attach: ERROR: Unchecked use of malloc'd var 'mpc'
/u3/whuang/mc/linux-2.3.99/net/atm/mpc.c:800:atm_mpoa_mpoad_attach: ERROR: Unchecked use of malloc'd var 'mpc'
/u3/whuang/mc/linux-2.3.99/net/atm/mpc.c:804:atm_mpoa_mpoad_attach: ERROR: Unchecked use of malloc'd var 'mpc'
/u3/whuang/mc/linux-2.3.99/net/atm/mpc.c:805:atm_mpoa_mpoad_attach: ERROR: Unchecked use of malloc'd var 'mpc'
/u3/whuang/mc/linux-2.3.99/net/ax25/af_ax25.c:1477:ax25_sendmsg: ERROR: did not free skb on error path
/u3/whuang/mc/linux-2.3.99/net/ax25/af_ax25.c:892:ax25_create: ERROR: did not free sk on error path
/u3/whuang/mc/linux-2.3.99/net/core/filter.c:456:sk_attach_filter: ERROR: did not free fp on error path
/u3/whuang/mc/linux-2.3.99/net/decnet/dn_route.c:971:dn_cache_getroute: ERROR: did not free skb on error path
/u3/whuang/mc/linux-2.3.99/net/decnet/dn_route.c:976:dn_cache_getroute: ERROR: did not free skb on error path
/u3/whuang/mc/linux-2.3.99/net/ipv4/af_inet.c:403:inet_create: ERROR: did not free sk on error path
/u3/whuang/mc/linux-2.3.99/net/ipv4/af_inet.c:407:inet_create: ERROR: did not free sk on error path
/u3/whuang/mc/linux-2.3.99/net/ipv4/af_inet.c:411:inet_create: ERROR: did not free sk on error path
/u3/whuang/mc/linux-2.3.99/net/ipv4/ipmr.c:594:ipmr_cache_report: ERROR: did not free skb on error path
/u3/whuang/mc/linux-2.3.99/net/ipv4/route.c:2071:inet_rtm_getroute: ERROR: did not free skb on error path
/u3/whuang/mc/linux-2.3.99/net/ipv4/tcp_output.c:874:tcp_send_fin: ERROR: Using 'skb' illegally!
/u3/whuang/mc/linux-2.3.99/net/ipv6/af_inet6.c:201:inet6_create: ERROR: did not free sk on error path
/u3/whuang/mc/linux-2.3.99/net/ipv6/af_inet6.c:204:inet6_create: ERROR: did not free sk on error path
/u3/whuang/mc/linux-2.3.99/net/ipv6/af_inet6.c:207:inet6_create: ERROR: did not free sk on error path
/u3/whuang/mc/linux-2.3.99/net/ipv6/ip6_output.c:439:ip6_frag_xmit: ERROR: did not free last_skb on error path
/u3/whuang/mc/linux-2.3.99/net/ipv6/ip6_output.c:478:ip6_frag_xmit: ERROR: did not free last_skb on error path
/u3/whuang/mc/linux-2.3.99/net/ipv6/mcast.c:103:ipv6_sock_mc_join: ERROR: did not free mc_lst on error path
/u3/whuang/mc/linux-2.3.99/net/ipv6/route.c:1217:ip6_rt_addr_add: ERROR: did not free rt on error path
/u3/whuang/mc/linux-2.3.99/net/ipv6/route.c:1721:inet6_rtm_getroute: ERROR: did not free skb on error path
/u3/whuang/mc/linux-2.3.99/net/ipx/af_ipx.c:1401:ipxrtr_route_packet: ERROR: did not free skb on error path
/u3/whuang/mc/linux-2.3.99/net/ipx/af_spx.c:147:spx_create: ERROR: did not free sk on error path
/u3/whuang/mc/linux-2.3.99/net/ipx/af_spx.c:514:spx_transmit: ERROR: did not free skb on error path
/u3/whuang/mc/linux-2.3.99/net/ipx/af_spx.c:758:spx_sendmsg: ERROR: did not free skb on error path
/u3/whuang/mc/linux-2.3.99/net/ipx/af_spx.c:763:spx_sendmsg: ERROR: did not free skb on error path
/u3/whuang/mc/linux-2.3.99/net/irda/af_irda.c:957:irda_create: ERROR: did not free sk on error path
/u3/whuang/mc/linux-2.3.99/net/irda/af_irda.c:989:irda_create: ERROR: did not free sk on error path
/u3/whuang/mc/linux-2.3.99/net/irda/af_irda.c:993:irda_create: ERROR: did not free sk on error path
/u3/whuang/mc/linux-2.3.99/net/irda/ircomm/ircomm_param.c:157:ircomm_param_request: ERROR: did not free skb on error path
/u3/whuang/mc/linux-2.3.99/net/irda/irlmp.c:365:irlmp_connect_request: ERROR: did not free skb on error path
/u3/whuang/mc/linux-2.3.99/net/irda/irlmp.c:395:irlmp_connect_request: ERROR: did not free skb on error path
/u3/whuang/mc/linux-2.3.99/net/irda/irlmp.c:402:irlmp_connect_request: ERROR: did not free skb on error path
/u3/whuang/mc/linux-2.3.99/net/irda/irlmp.c:413:irlmp_connect_request: ERROR: did not free skb on error path
/u3/whuang/mc/linux-2.3.99/net/irda/irlmp.c:414:irlmp_connect_request: ERROR: did not free skb on error path
/u3/whuang/mc/linux-2.3.99/net/irda/irlmp.c:415:irlmp_connect_request: ERROR: did not free skb on error path
/u3/whuang/mc/linux-2.3.99/net/irda/irlmp.c:416:irlmp_connect_request: ERROR: did not free skb on error path
/u3/whuang/mc/linux-2.3.99/net/irda/irttp.c:705:irttp_connect_request: ERROR: did not free skb on error path
/u3/whuang/mc/linux-2.3.99/net/irda/irttp.c:943:irttp_connect_response: ERROR: did not free skb on error path
/u3/whuang/mc/linux-2.3.99/net/netlink/af_netlink.c:230:netlink_create: ERROR: did not free sk on error path
/u3/whuang/mc/linux-2.3.99/net/netlink/af_netlink.c:742:netlink_dump: ERROR: did not free skb on error path
/u3/whuang/mc/linux-2.3.99/net/netrom/af_netrom.c:1052:nr_sendmsg: ERROR: did not free skb on error path
/u3/whuang/mc/linux-2.3.99/net/rose/af_rose.c:1106:rose_sendmsg: ERROR: did not free skb on error path
/u3/whuang/mc/linux-2.3.99/net/sched/cls_api.c:330:tfilter_notify: ERROR: did not free skb on error path
/u3/whuang/mc/linux-2.3.99/net/sched/sch_api.c:793:qdisc_notify: ERROR: did not free skb on error path
/u3/whuang/mc/linux-2.3.99/net/sched/sch_api.c:995:tclass_notify: ERROR: did not free skb on error path
/u3/whuang/mc/linux-2.3.99/net/x25/af_x25.c:970:x25_sendmsg: ERROR: did not free skb on error path