Date: Tue, 12 Feb 2008 10:30:04 -0800 (PST)
From: Linus Torvalds <>
Subject: Re: multiple drivers, single device (was Re: Announce: Linux-next (Or Andrew's dream  :-)))
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2008/2/12/319

On Tue, 12 Feb 2008, Jeff Garzik wrote:
> Greg KH wrote:
> > The work I'm doing here is for stupid PCI firmware engineers, who have
> > created devices that are different things, all bound up under the same
> > PCI device.  I'm thinking of watchdog timers and random number
> > generator and i2c controller on the same PCI device, or even the more
> > basic, frame buffer and DRM access to the same PCI video device.
> 
> Yes, that has a known solution:  have your driver register i2c, rng, watchdog,
> etc. functions.
> 
> Works just fine inside today's infrastructure, no changes needed.
Indeed. If you have a multi-function device that shows up as a single PCI 
function, just make it have its own "private bus", and make it show up as 
a "devices within a device".
Create the fake PCI subdevices that have no "real" counterpart, except as 
parts of the stupid device that couldn't be bothered to be seen as 
multiple _real_ functions.
That not only solves the infrastructure issues, it's actually The Truth 
with capital letters. It is, after all, how the device actually works 
internally.
			Linus