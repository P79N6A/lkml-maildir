Date: Tue, 2 Feb 1999 19:54:11 -0500
From: "Tom Sightler" <>
Subject: Re: Poor PPP performance in 2.2.x
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/1999/2/2/217

I'm having similar problems with Poor PPP performance in 2.2.x, but my setup
is quite different than yours.  I have an IBM PS/2 P70 with a Cyrix
486DRx2/40 processor (about like a 486/33).  I use an USR Sportster 56K
modem and an IBM PS/2 SCSI Controller with 512K Cache.  Yes this is a MCA
bus machine and I have been using it as a proxy at home for two years now.
With 2.0.36 (with the MCA/Linux patches) ppp connections fly.  I tested
download from various sites with 300K compresses files and consistently get
4.9-5.2Kps.  However, with 2.2.1 I'm lucky to get 3.5Kps.  Also, I get lots
of frame errors, and they usually come in bunches.  Well, maybe not lots,
but enough to believe that that's where the problem lies.  Everytime I get a
frame error there is a long pause while TCP times out and retries.  With the
2.0.36 kernel I never get any errors.
My understanding of frame errors is that they are actuals error in the
serial data and with an error correcting modem and a good UART (16550A) you
should never get one of these.  I tried lowering the serial port speed to
38.4K and still get frame errors.  I know it's not a fast machine, but
everything worked fine in 2.0.36 with the serial port set to 115.2K.
I've tried playing with irqtune but no effect, changing MTU, MRU, and WINDOW
sizes seems to make little difference (I can improve it ever so slightly
with very small MTU, MRU settings).  I compiled a kernel with the absolute
minimal options required for PPP and all worked the same.  Anybody have
suggestions?  Anything I can do to help troubleshoot this?  I'm pretty sure
this problem didn't happen with 2.1.125 (the last development kernel I had
compiled for this particular machine) but I'm not sure.  I'll try to compile
a 2.1.132 and see what happens.
Later,
Tom
----- Original Message -----
From: Stephen Foskett <sfoskett@slf.gweep.net>
To: <linux-kernel@vger.rutgers.edu>
Sent: Tuesday, February 02, 1999 12:32 PM
Subject: Poor PPP performance in 2.2.x
>There was some discussion of poor PPP performance in the 2.2.x kernels here
>last week.  The suggested solution was to disable DMA on the hard disk.
>
>I have a Toshiba Portege 3015CT running Debian Slink.  I compiled the 2.2.0
>and 2.2.1 kernels and they run great...  EXCEPT that I still have the PPP
>problem.  This machine does have a UDMA hard disk, so I tried disabling DMA
>on the disk.  This did not fix the problem.  I tried the other settings
>with hdparm, too, turning everything off and leaving the readahead at just
>2.  This did not help at all.  I recompiled the kernel to not automatically
>turn on DMA as well.  The next step would be to disable DMA entirely in the
>kernel, I suppose, but it doesn't look like this DMA thing is the answer,
>at least for me.
>
>Has anyone got another idea?  I am getting the same bytes in the log from
>pppd as described previously.  I too am seeing lots of errors with "netstat
>ppp0".  This all worked find with 2.1.125 and 2.0.36.  Is it a problem with
>pppd?  With pcmcia?  With the kernel?
>
>Thanks for any suggestions,
>Stephen
>
>-
>To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
>the body of a message to majordomo@vger.rutgers.edu
>Please read the FAQ at 
http://www.tux.org/lkml/
>
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.rutgers.edu
Please read the FAQ at 
http://www.tux.org/lkml/