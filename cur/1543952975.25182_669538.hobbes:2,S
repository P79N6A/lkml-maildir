Date: Thu, 20 Mar 2008 18:41:56 +0200
From: "Ioan Ionita" <>
Subject: 2.6.25-rc5-git5 KVM memory not freed
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2008/3/20/136

Hi,
I'm using KVM and the qemu kvm modified to run a windows guest. I'm
allocating 900 MB to the guest. Seems that when I terminate a qemu
process, the memory that was allocated to qemu is not freed:
Mem:       2058140    1739156     318984          0     226944     425140
-/+ buffers/cache:    1087072     971068
Swap:            0          0          0
So I'm using 1GB of ram even though I've terminated qemu. If I attempt
to start qemu again, the machine locks up. No message in the logs.
Command to start qemu:
/usr/local/kvm/bin/qemu-system-x86_64 b.data -no-acpi -m 900 -net nic
-net user -hdb temp.raw -usbdevice tablet
uname -a
Linux ops-desktop 2.6.25-rc5-git5 #1 SMP PREEMPT Sat Mar 15 14:47:25
EET 2008 x86_64 GNU/Linux
Not sure whether this is a problem on the kernel side.  I don't
pretend to understand linux memory management. But it wasn't occurring
with older kernels. I'll attempt to bisect.