Date: Tue, 22 Jan 2008 17:52:43 +0100
From: Marc Pignat <>
Subject: Re: [PATCH 6/6] atmel_serial: Add DMA support
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2008/1/22/192

Hi!
I removed linux-arm-kernel@lists.arm.linux.org.uk from cc, it is a
subscriber-only list.
On Tuesday 22 January 2008, Haavard Skinnemoen wrote:
> From: Chip Coldwell <coldwell@redhat.com>
...
> @@ -47,6 +50,11 @@
> 
>  #include "atmel_serial.h"
> 
> +#define SUPPORT_PDC
> +#define PDC_BUFFER_SIZE		(L1_CACHE_BYTES << 3)
> +#warning "Revisit"
why add this warning?
...
> @@ -1090,7 +1434,7 @@ static int atmel_serial_suspend(struct platform_device *pdev,
>  	struct atmel_uart_port *atmel_port = (struct atmel_uart_port *)port;
> 
>  	if (device_may_wakeup(&pdev->dev)
> -	    && !at91_suspend_entering_slow_clock())
> +		&& !clk_must_disable(atmel_port->clk))
1. this has nothing to do with dma
2. clk_must_disable isn't in mainline (2.6.24-rc8) for at91 (not verified for avr32).
CONFIG_MAGIC_SYSRQ isn't working with this pach, (CONFIG_MAGIC_SYSRQ has never
worked with atmel_serial dma patches).
For me breaking CONFIG_MAGIC_SYSRQ is not a critical regression and can be
fixed later, but the "clk_must_disable" problem breaks compilation.
Regards
Marc