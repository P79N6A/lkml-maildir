Date: Thu, 11 Oct 2007 01:14:29 +0200
From: Adrian Bunk <>
Subject: Re: coding for optimizations (Re: [PATCH 1/2] i386: mce cleanup part1: functional change)
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2007/10/10/238

On Tue, Oct 09, 2007 at 08:30:11PM +0200, Joerg Roedel wrote:
>...
> But you are right with the redundant mca and mce variables. They are not
> needed and I will inline the cpu_has() checks into the condition check.
> I'll resubmit tomorrow.
Please don't let Oley bring you away from the right path.
It is your job to write readable C code, and it's the compiler's job to 
transform this C code into efficient machine code.
And non-ancient gcc versions are usually quite good in optimizing code.
And saving code in a variable before using it might even result in the 
same assembler code.
It is personal preference whether you use variables or not in this case 
(both seem to be equally readable) so you can do it any way you like, 
but don't try to guess what gcc might make out of it.
We have problems with the size of the kernel image, but we need to solve 
them with the bigger knobs that have measurable effects, not by wasting 
our time on guessing how gcc might handle a single if.
It's also a quite ill idea to think about whether gcc might produce a 
few bytes more or less code at the if when there's such a long printk() 
in the middle...
cu
Adrian
-- 
       "Is there not promise of rain?" Ling Tan asked suddenly out
        of the darkness. There had been need of rain for many days.
       "Only a promise," Lao Er said.
                                       Pearl S. Buck - Dragon Seed
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.kernel.org
More majordomo info at  
http://vger.kernel.org/majordomo-info.html
Please read the FAQ at  
http://www.tux.org/lkml/