Date: 01 Jun 2003 15:53:19 +0200
From: Philippe Amelant <>
Subject: Re: 2.4.18 /dev/random problem
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2003/6/1/147

Le dim 01/06/2003 à 00:29, Andreas Dilger a écrit :
> On May 31, 2003  17:36 +0200, Philippe Amelant wrote:
> > I have a compaq server with a little problem.
> > cat /proc/sys/kernel/random/entropy_avail is always 0
> > so /dev/random block on all read.
> > 
> > I have read some discussion about /dev/random on this list.
> > and if I understand /dev/urandom rely on /dev/random for providing good
> > randomness and /dev/random rely on server activity for it's entropy.
> > 
> > But I don't understand why my disk activity doesn't refill the entropy
> > counter. If I try to mount floppy I get some entropy but even updating
> > locate db does not provide any entropy ? Should I activate something in
> > disk driver ?
> 
> Maybe you only have disk drives attached via CCISS or other special
> RAID controller, and you do not use keyboard or mouse?  It might be
> that the RAID controller is not contributing to the entopy pool.
You are right.
Pasi Pirhonen provide me this little patch
Maybe it could be useful for someone else....
--- linux/drivers/block/cpqarray.c      Fri Apr  4 01:23:24 2003
+++ linux.TE/drivers/block/cpqarray.c   Fri Apr  4 01:21:04 2003
@@ -517,7 +517,7 @@
 
        hba[i]->access.set_intr_mask(hba[i], 0);
        if (request_irq(hba[i]->intr, do_ida_intr,
-               SA_INTERRUPT|SA_SHIRQ, hba[i]->devname, hba[i])) 
+               SA_INTERRUPT|SA_SHIRQ|SA_SAMPLE_RANDOM, hba[i]->devname, hba[i])) 
        {
 
                printk(KERN_ERR "cpqarray: Unable to get irq %d for %s\n", 
thank for help
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.kernel.org
More majordomo info at  
http://vger.kernel.org/majordomo-info.html
Please read the FAQ at  
http://www.tux.org/lkml/