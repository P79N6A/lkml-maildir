Date: Fri, 12 Dec 2003 03:00:53 -0500
From: Jean-Marc Valin <>
Subject: Re: Increasing HZ (patch for HZ > 1000)
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2003/12/12/15

Just one more thing about the patch I sent. I think it addresses
something unclean in the bogomips computation. For example, in
arch/i386/kernel/cpu/proc.c, you have:
seq_printf(m, "\nbogomips\t: %lu.%02lu\n\n",
           c->loops_per_jiffy/(500000/HZ),
           (c->loops_per_jiffy/(5000/HZ)) % 100);
It's clear that for any case where 5000/HZ is not an integer, the
bogomips decimals will be wrong and if 500000/HZ isn't an integer, the
bogomips integer part will be wrong.
For example on a 2 GHz processor with a 4000 bogomips value and HZ=1200,
the code above will produce 3996.66 instead of 4000. Of course, as soon
as HZ goes above 5000, you have a divide by zero right at compile time.
	Jean-Marc
-- 
Jean-Marc Valin, M.Sc.A., ing. jr.
LABORIUS (
http://www.gel.usherb.ca/laborius
)
Université de Sherbrooke, Québec, Canada
[unhandled content-type:application/pgp-signature]