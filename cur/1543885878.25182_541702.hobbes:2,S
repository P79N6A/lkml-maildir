Date: Tue, 08 May 2007 14:15:54 -0700 (PDT)
From: David Miller <>
Subject: Re: Please revert 5adc55da4a7758021bcc374904b0f8b076508a11 (PCI_MULTITHREAD_PROBE)
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2007/5/8/484

From: Linus Torvalds <torvalds@linux-foundation.org>
Date: Tue, 8 May 2007 08:27:34 -0700 (PDT)
> Threading at the bus level just inevitably means things like random 
> numbers for devices depending on some timing/scheduling issue. That's 
> nasty.
I hadn't considered this issue, so ignore the other reply I made to
this thread.  Although as an aside I'm starting to become of an
opinion that device numbering doesn't matter.  Every device should
have a unique ID of sorts, or a unique physical location, and that
should factor into the thing users use to refer to the object.
Whether that's an ethernet MAC address, a PCI domain:bus:devfn tuple,
or some unique ID written in the disk label or partition header, it
doesn't matter.
If that gets translated into "user_happy_sunny_day_disk0" to make
references simpler for the user, that's fine.  But probe ordering
should never break these mappings even if "user_happy_sunny_day_disk1"
is spotted by probing before "user_happy_sunny_day_disk0".  If the
system is designed properly, that should never matter, but for us
it still does.
Those mappings should exist statically somewhere, not depend upon
something as frivolous as probe ordering.
Anyways, it would be nice, however, to really deal with the case like
when the IDE layer is waiting for a probe to port X to timeout,
meanwhile we could be initializing the networking card.
Another bad case is, as you mentioned, SCSI bus resets and SAS/FC
fabric scans.  Those take several seconds if not longer and it's
really stupid to not be able to do other things during that time.
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.kernel.org
More majordomo info at  
http://vger.kernel.org/majordomo-info.html
Please read the FAQ at  
http://www.tux.org/lkml/