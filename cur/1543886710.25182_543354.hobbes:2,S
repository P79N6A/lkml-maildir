Date: Fri, 11 May 2007 19:45:41 +0200
From: Nicolas Mailhot <>
Subject: Re: [Bug 8464] New: autoreconf: page allocation failure. order:2, mode:0x84020
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2007/5/11/195

Le vendredi 11 mai 2007 à 18:38 +0100, Mel Gorman a écrit :
> On (11/05/07 13:51), Nicolas Mailhot didst pronounce:
> > Le vendredi 11 mai 2007 à 10:08 +0100, Mel Gorman a écrit :
> > 
> > > > seems to have cured the system so far (need to charge it a bit longer to
> > > > be sure)
> > > > 
> > > 
> > > The longer it runs the better, particularly under load and after
> > > updatedb has run. Thanks a lot for testing
> > 
> > After a few hours of load testing still nothing in the logs, so the
> > revert was probably the right thing to do
> 
> Excellent. I am somewhat suprised by the result 
And you're probably right, it just banged after a day working fine
19:20:00  tar: page allocation failure. order:2, mode:0x84020
19:20:00  
19:20:00  Call Trace:
19:20:00  [<ffffffff8025b5c3>] __alloc_pages+0x2aa/0x2c3
19:20:00  [<ffffffff802751f5>] __slab_alloc+0x196/0x586
19:20:00  [<ffffffff80300d79>] radix_tree_node_alloc+0x36/0x7e
19:20:00  [<ffffffff8027597a>] kmem_cache_alloc+0x32/0x4e
19:20:00  [<ffffffff80300d79>] radix_tree_node_alloc+0x36/0x7e
19:20:00  [<ffffffff8030118e>] radix_tree_insert+0x5d/0x18c
19:20:00  [<ffffffff80256ac4>] add_to_page_cache+0x3d/0x95
19:20:00  [<ffffffff80257aa4>] generic_file_buffered_write+0x222/0x7c8
19:20:00  [<ffffffff88013c74>] :jbd:do_get_write_access+0x506/0x53d
19:20:00  [<ffffffff8022c7d5>] current_fs_time+0x3b/0x40
19:20:00  [<ffffffff8025838c>] __generic_file_aio_write_nolock+0x342/0x3ac
19:20:00  [<ffffffff80416ac1>] __mutex_lock_slowpath+0x216/0x221
19:20:00  [<ffffffff80258457>] generic_file_aio_write+0x61/0xc1
19:20:00  [<ffffffff880271be>] :ext3:ext3_file_write+0x16/0x94
19:20:00  [<ffffffff8027938c>] do_sync_write+0xc9/0x10c
19:20:00  [<ffffffff80239c56>] autoremove_wake_function+0x0/0x2e
19:20:00  [<ffffffff80279ba7>] vfs_write+0xce/0x177
19:20:00  [<ffffffff8027a16a>] sys_write+0x45/0x6e
19:20:00  [<ffffffff8020955c>] tracesys+0xdc/0xe1
19:20:00  
19:20:00  Mem-info:
19:20:00  DMA per-cpu:
19:20:00  CPU    0: Hot: hi:    0, btch:   1 usd:   0   Cold: hi:    0, btch:   1 usd:   0
19:20:00  CPU    1: Hot: hi:    0, btch:   1 usd:   0   Cold: hi:    0, btch:   1 usd:   0
19:20:00  DMA32 per-cpu:
19:20:00  CPU    0: Hot: hi:  186, btch:  31 usd: 149   Cold: hi:   62, btch:  15 usd:  19
19:20:00  CPU    1: Hot: hi:  186, btch:  31 usd: 147   Cold: hi:   62, btch:  15 usd:   2
19:20:00  Active:348968 inactive:105561 dirty:23054 writeback:0 unstable:0
19:20:00  free:9776 slab:28092 mapped:23015 pagetables:10226 bounce:0
19:20:00  DMA free:7960kB min:20kB low:24kB high:28kB active:0kB inactive:0kB present:7648kB pages_scanned:0 all_unreclaimable? yes
19:20:00  lowmem_reserve[]: 0 1988 1988 1988
19:20:00  DMA32 free:31144kB min:5692kB low:7112kB high:8536kB active:1395872kB inactive:422244kB present:2036004kB pages_scanned:0 all_unreclaimable? no
19:20:00  lowmem_reserve[]: 0 0 0 0
19:20:00  DMA: 6*4kB 6*8kB 7*16kB 3*32kB 8*64kB 8*128kB 6*256kB 1*512kB 0*1024kB 0*2048kB 1*4096kB = 7960kB
19:20:00  DMA32: 7560*4kB 0*8kB 8*16kB 0*32kB 1*64kB 1*128kB 0*256kB 1*512kB 0*1024kB 0*2048kB 0*4096kB = 31072kB
19:20:00  Swap cache: add 1527, delete 1521, find 216/286, race 397+0
19:20:00  Free swap  = 4192824kB
19:20:00  Total swap = 4192944kB
19:20:00  Free swap:       4192824kB
19:20:00  524272 pages of RAM
19:20:00  14123 reserved pages
19:20:00  252562 pages shared
19:20:00  6 pages swap cached
> so I'd like to look at the
> alternative option with kswapd as well. Could you put that patch back in again
> please and try the following patch instead? 
I'll try this one now (if it applies)
Regards,
-- 
Nicolas Mailhot
[unhandled content-type:application/pgp-signature]