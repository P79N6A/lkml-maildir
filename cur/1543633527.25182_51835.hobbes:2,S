Date: Tue, 11 Jun 2002 15:15:31 -0400
From: "Philippe Veillette (LMC)" <>
Subject: sk->socket is invalid in tcp stack
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2002/6/11/221

Hi everybody
I've found what could be a problem in the tcp stack with linux-2.4.17 &
2.4.18.  When i run lmbench-2.0-patch2 and that i add the following line of
code in tcp_v4_rcv, it<s get added between the if (!ipsec_sk_policy(sk,skb))
... and if (sk->state == TCP_TIME_WAIT)
if (sk->socket) {	
	if (sk->socket->inode) {
		printk("Boum\n");
	}
}
I get a crash, i can give the dump later but for now, I am just wondering if
the sk->socket could be invalid when we are receiving a tcp packet.  Since
from the search i've done it seems to be initialized only when the sock
struct is initialized in sock_init_data that get called by inet_create.
But what is more frightening, is that it's alright for sometime and then
Boum, crash....
Bye
Philippe Veillette
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.kernel.org
More majordomo info at  
http://vger.kernel.org/majordomo-info.html
Please read the FAQ at  
http://www.tux.org/lkml/