Date: Thu, 13 Dec 2007 13:57:11 -0500 (EST)
From: Kiyoshi Ueda <>
Subject: Re: [Patch 4/8] Enhanced partition statistics: cciss fix
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2007/12/13/366

Hi,
Thank you for noticing this, Mike.
On Thu, 13 Dec 2007 16:55:06 +0000, "Miller, Mike" wrote:
> > Updates the enhanced partition statistics in cciss driver.
> >
> > Signed-off-by: Jerome Marchand <jmarchan@redhat.com>
> > ---
> >  cciss.c |    3 ++-
> >  1 file changed, 2 insertions(+), 1 deletion(-) diff -urNp -X
> > linux-2.6/Documentation/dontdiff
> > linux-2.6.orig/drivers/block/cciss.c linux-2.6/drivers/block/cciss.c
> > --- linux-2.6.orig/drivers/block/cciss.c        2007-12-04
> > 17:37:13.000000000 +0100
> > +++ linux-2.6/drivers/block/cciss.c     2007-12-05
> > 13:46:29.000000000 +0100
> > @@ -1268,7 +1268,8 @@ static void cciss_softirq_done(struct re
> >         if (blk_fs_request(rq)) {
> >                 const int rw = rq_data_dir(rq);
> >
> > -               disk_stat_add(rq->rq_disk, sectors[rw],
> > rq->nr_sectors);
> > +               all_stat_add(rq->rq_disk, sectors[rw],
> > +                            rq->nr_sectors, rq->sector);
> >         }
> 
> How does this mesh with the changes submitted by Kiyoshi Ueda? Any conflicts?
 
I think no conflict with my patch technically.
Jerome's patch changes __end_that_request_first(), too, as same as
the change above.
And my patch changes cciss/cpqarray to use blk_end_request, which
uses __end_that_request_first() internally, instead of doing
disk_stat_add() by themselves.
(
http://marc.info/?l=linux-kernel&m=119741542206258&w=2
)
So Jerome can just drop the cciss/cpqarray changes from his patch-set,
if my patch-set is merged.
> -- mikem
Thanks,
Kiyoshi Ueda