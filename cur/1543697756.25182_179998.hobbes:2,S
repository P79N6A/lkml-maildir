Date: Wed, 26 Nov 2003 01:22:33 +0100 (MET)
From:  Andries.Brouwer@cwi ...
Subject: Re: 2.6.0-test10 kernel panic with INVALID GEOMETRY
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2003/11/25/188

> disk works fine with 2.3.21.
> doesn't work but is ignored with 2.4.22.
> causes a panic with 2.6.0-test9,test10
> hdd: ,ATA DISK drive
> hdd: 0 sectors (0MB), CHS=0/0/0
> hdd: INVALID GEOMETRY: 0 PHYSICAL HEADS
> ide-default: hdd: Failed to register with ide.c
> Kernel panic: ide: default attach failed
> In the working case the model is
> hdd: ICBSL040AVVA07-0, ATA ...
> In the non-working case all identify data is zero.
OK. So this is not a geometry problem but an I/O problem:
the identify data is not read correctly. When 2.4 sees all
zeros it just ignores this disk. When 2.6 sees all zeros
it panics in ide.c:ata_attach.
You can change the "panic" in
    panic("ide: default attach failed");
(in ide.c:ata_attach) to "printk" and see how far your boot gets.
Do you know why the identify data is not read correctly?
(Or under what circumstances it is read correctly?)
Andries
Probably the panic is too strong a reaction, since it can happen.
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.kernel.org
More majordomo info at  
http://vger.kernel.org/majordomo-info.html
Please read the FAQ at  
http://www.tux.org/lkml/