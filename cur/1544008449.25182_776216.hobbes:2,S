Date: Wed, 3 Dec 2008 18:17:42 +0800
From: "Han, Weidong" <>
Subject: RE: [PATCH 0/12] Factor VT-d KVM functions into a generic API (with multiple device assignment support)
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2008/12/3/85

Joerg Roedel wrote:
> Hi,
> 
> this patch series makes the current KVM device passthrough code
> generic 
> enough so that other IOMMU implementation can also plug into this
> code. 
> It works by factoring the functions Vt-d code exports to KVM into a
> generic interface which allows different backends.
> 
> This is the second version of the patchset. The most important change
> to 
> the previous version is that this patchset was rebased to the improved
> API from Han Weidong which supports multiple devices per IOMMU domain.
> 
> For completeness, this series also includes the patches from Han with
> some cleanups. So this patchset can be applied on current avi/master
> tree.
> 
> For testing this code can also be pulled against avi/master tree from
> 
> git://git.kernel.org/pub/scm/linux/kernel/git/joro/linux-2.6-iommu.git
> iommu-api 
> 
> This a basic implementation of a generic interface. It can and should
> be improved later to support more types of hardware IOMMUs then VT-d
> and 
> AMD IOMMU.
> 
> Since I have no VT-d hardware available these patches are only compile
> tested for now.
> 
> Please review, comment and test these patches.
Tried this patchset on avi/master tree, VT-d works. Your generic API approach is ok for me. But the multiple devices assignment patches (here patch 01 and 02) needs some improvement, and they are too big to review. I have split them into a serial small patches, and sent out for review in another mail thread. After my multiple device assignment patchset is accepted, I think you can easily rebase your generic patchset on it.
Regards,
Weidong