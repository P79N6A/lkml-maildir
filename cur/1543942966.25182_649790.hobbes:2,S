Date: Thu, 7 Feb 2008 18:46:03 +0100 (CET)
From: Thomas Gleixner <>
Subject: Re: 2.6.24-git15 Keyboard Issue?
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2008/2/7/303

Chris,
On Thu, 7 Feb 2008, Chris Holvenstot wrote:
> Thomas - 
> 
> I hope that, from at least my perspective, your question is rhetorical.
Yeah. The non rhetorical one was directed to Jiri. :)
> I am fully willing to publicly admit that I don't have a clue. About
> much of anything. I will even admit that until prompted by Jiri
> yesterday I had never even heard of the nohpet directive for the boot
> line. 
No problem. At the moment I'm equally clueless :)
> I am willing to do whatever I can to help isolate and or resolve this
> issue, but to do so I need one of you experts to firmly grab hold of
> some portion of my anatomy and guide me in the right direction.
Can you please apply the following patch, boot w/o nohpet and provide
the dmesg output ?
Thanks,
	tglx
diff --git a/arch/x86/kernel/hpet.c b/arch/x86/kernel/hpet.c
index 429d084..4e98241 100644
--- a/arch/x86/kernel/hpet.c
+++ b/arch/x86/kernel/hpet.c
@@ -375,8 +375,10 @@ int __init hpet_enable(void)
 {
 	unsigned long id;
 
-	if (!is_hpet_capable())
+	if (!is_hpet_capable()) {
+		printk(KERN_INFO "HPET not available\n");
 		return 0;
+	}
 
 	hpet_set_mapping();
 
@@ -392,6 +394,7 @@ int __init hpet_enable(void)
 	 * information and the number of channels
 	 */
 	id = hpet_readl(HPET_ID);
+	printk(KERN_INFO "HPET available. ID = %lx\n", id);
 
 #ifdef CONFIG_HPET_EMULATE_RTC
 	/*
@@ -412,6 +415,7 @@ int __init hpet_enable(void)
 	return 0;
 
 out_nohpet:
+	printk(KERN_INFO "HPET disabled\n");
 	hpet_clear_mapping();
 	boot_hpet_disable = 1;
 	return 0;