Date: Thu, 27 Feb 2003 11:33:25 +0100
From: Mikael Pettersson <>
Subject: Re: [BUG] 2.5.63: ESR killed my box!
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2003/2/27/43

Martin J. Bligh writes:
 > maybe change this bit in trap_init:
 > 
 > @@ -665,7 +665,6 @@
 >  	}
 >  	set_bit(X86_FEATURE_APIC, boot_cpu_data.x86_capability);
 >  	mp_lapic_addr = APIC_DEFAULT_PHYS_BASE;
 > -	boot_cpu_physical_apicid = 0;
 >  	if (nmi_watchdog != NMI_NONE)
 >  		nmi_watchdog = NMI_LOCAL_APIC;
 > 
 > to do:
 > 
 > boot_cpu_physical_apicid = hard_smp_processor_id();
 > phys_cpu_present_map = 1 << boot_cpu_physical_apicid;
I assume you meant detect_init_APIC().
No, you can't do any apic reads (which is what hard_smp_processor_id() does)
at this point since the local APIC isn't mapped yet. That happens shortly
after this, in init_apic_mappings()' set_fixmap_nocache() call.
/Mikael
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.kernel.org
More majordomo info at  
http://vger.kernel.org/majordomo-info.html
Please read the FAQ at  
http://www.tux.org/lkml/