Date: Fri, 12 Nov 2004 17:12:57 +0100
From: Martin Josefsson <>
Subject: Re: [PATCH] Add pci_save_state() to ALSA
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2004/11/12/93

On Fri, 2004-11-12 at 14:58, Takashi Iwai wrote:
> At Fri, 12 Nov 2004 14:45:40 +0100,
> Arjan van de Ven wrote:
> > 
> > On Fri, 2004-11-12 at 14:26 +0100, Takashi Iwai wrote:
> > > But pci_save_state() is called again after the driver's suspend
> > > callback is called.  So, the final saved state must be anyway same.
> > 
> > no that changed recently in the upstream kernel.
> > pci_save_state() is now only called if there is no suspend callback in the driver!
> 
> Ah, thanks, that explains why (I referred 2.6.10-rc1).
I realized that I forgot to include som vital information, sorry about
that.
Kernel 2.6.10-rc1-bk21 which has the pci_save_state() change in
pci-driver.c
My driver(s) are intel8x0.c and intel8x0m.c
First I just thought the missing pci_save_state() was a small mistake
and wondered why nobody else had reported the problem, later I found out
that a "generic" pci_save_state() for all pci-devices was removed
recently but I didn't have time to send a mail.
> If so, the patch is almost correct, but pci_save_state() should be put
> after the call of callback.
Great, thanks for fixing the fix.
I havn't had any problems with my broken patch, I'll see if I have the
time to test this one as well this weekend.
-- 
/Martin
[unhandled content-type:application/pgp-signature]