Date: Wed, 2 Jan 2008 23:36:09 -0800
From: David Brownell <>
Subject: Re: [linux-usb-devel] [PATCH] : Allow embedded developers USB options normally reserved for OTG
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2008/1/3/39

On Wednesday 02 January 2008, Bryan Wu wrote:
> B.T.W, 2 questions about the MUSB driver:
> 1. What's the plan for mainline merge of the whole MUSB driver? maybe
> I can cleanup current Blackfin ports to you guys.
It might as well merge in 2.6.25-early.  It'll be easier to integrate
patches that way.  Including your Blackfin port.  When I asked before,
nobody hugely objected to "one big patch".
> 2. Do you remember the PING issue I reported in OMAP list? How do you
> think of that?
Yes, something needs to be done.  EHCI might benefit from the same
kind of patch, to cope with ill-behaved usb thumb drives.
> > I have an idea: the USB_NAKLIMIT0 should be set to some value, when we
> > got NAK timeout interrupt, we can disable PING. When enumerating normal
> > USB stick, there is no NAK timeout, because PING is efficient for
> > handshaking. While problem USB stick will generate NAK timeout
> > interrupt, we disable PING for this kind of USB device enumeration.
That sounds much better than your original patch, which disabled it
always.  It might even be worth allocating a flag somewhere in the
usb_device structure to record when ep0 pings seem to misbehave.
- Dave