Date: Fri, 8 Sep 2000 21:42:22 +1000
From: Harley Anderson <>
Subject: Problems with bluesmoke.c in 2.2.17
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2000/9/8/50

The other day I got the patch for 2.2.17 and after just over a day of normal
operation, while my sister was playing kpat (KDE solitaire) yesterday
afternoon, X died and dropped her out to the console.
After she told me about it later on I found this at the bottom of my dmesg:
CPU 0: Machine Check Exception: 0000000400000000<0>Bank 3: b200000000080a01general protection fault: 0000
CPU:    0
EIP:    0010:[<c010e59b>]
EFLAGS: 00010246
eax: 00080a01   ebx: 32000000   ecx: 0000040d   edx: 32000000
esi: 0000000c   edi: 00000003   ebp: 00000003   esp: c8931f98
ds: 0018   es: 0018   ss: 0018
Process kwm (pid: 998, process nr: 33, stackpage=c8931000)
Stack: bfffe458 bfffe438 00000005 c8930000 0000040d 00000000 00000004 00080a01
       c010a035 c8931fc4 00000000 40276c60 4055b548 00000028 080dd4f0 bfffe458
       bfffe438 080dd4f0 0000002b 0000002b ffffffff 40189e68 00000023 00010216
Call Trace: [<c010a035>]
Code: 0f 30 a1 04 e4 1b c0 89 44 24 10 45 3b 6c 24 10 0f 8c 3b ff
I was a bit surprised to get something like this in a stable kernel (I have
been running 2.3.99 and up with no significant problems, until today anyway).
I rebooted, mostly to change to a smaller fb mode. And then a few hours later
while in X again, pushing netscape a bit hard maybe.. and then it rebooted itself.
Found this in my syslog afterwards:
Sep  7 17:51:57 fury kernel: CPU 0: Machine Check Exception: 0000000400000000<0>Bank 0: b200
008000000800general protection fault: 0000
Sep  7 17:51:57 fury kernel: CPU 0: Machine Check Exception: 0000000400000000<0>Bank 0: b200
008000000800general protection fault: 0000
Sep  7 17:51:57 fury kernel: CPU:    0
I tracked the "Machine Check Exception:" bit down to arch/kernel/bluesmoke.c
(a forboding name for a piece of code).
A new file according to the patch and something that wasn't in Alan's list of
changes for the release.
Most of it is well over my head, but I was wondering how something like this
gets into a stable kernel when it has worked fine without it for so long and
buggers up when it's added in.
Entire dmesg from that day follows. Thought /proc/cpuinfo might be useful too..
Linux version 2.2.17 (root@fury) (gcc version egcs-2.91.66 19990314/Linux (egcs-1.1.2 release)) #3 Tue Sep 5 19:20:19 EST 2000
Detected 300686 kHz processor.
Console: colour dummy device 80x25
Calibrating delay loop... 599.65 BogoMIPS
Memory: 193204k/196608k available (748k kernel code, 412k reserved, 2188k data, 56k init)
Dentry hash table entries: 32768 (order 6, 256k)
Buffer cache hash table entries: 262144 (order 8, 1024k)
Page cache hash table entries: 65536 (order 6, 256k)
Intel machine check architecture supported.
Intel machine check reporting enabled on CPU#0.
CPU: Intel Pentium II (Klamath) stepping 04
Checking 386/387 coupling... OK, FPU using exception 16 error reporting.
Checking 'hlt' instruction... OK.
POSIX conformance testing by UNIFIX
mtrr: v1.35a (19990819) Richard Gooch (rgooch@atnf.csiro.au)
PCI: PCI BIOS revision 2.10 entry at 0xfae60
PCI: Using configuration type 1
PCI: Probing PCI hardware
Linux NET4.0 for Linux 2.2
Based upon Swansea University Computer Society NET3.039
NET4: Unix domain sockets 1.0 for Linux NET4.0.
NET4: Linux TCP/IP 1.0 for NET4.0
IP Protocols: ICMP, UDP, TCP
TCP: Hash tables configured (ehash 262144 bhash 65536)
Starting kswapd v 1.5 
vesafb: framebuffer at 0xe6000000, mapped to 0xcc800000, size 4096k
vesafb: mode is 1024x768x8, linelength=1024, pages=4
vesafb: protected mode interface info at c000:0584
vesafb: scrolling: redraw
Console: switching to colour frame buffer device 128x48
fb0: VESA VGA frame buffer device
Detected PS/2 Mouse Port.
pty: 256 Unix98 ptys configured
apm: BIOS version 1.2 Flags 0x07 (Driver version 1.13)
Real Time Clock Driver v1.09
loop: registered device at major 7
PIIX4: IDE controller on PCI bus 00 dev 39
PIIX4: not 100% native mode: will probe irqs later
    ide0: BM-DMA at 0xf000-0xf007, BIOS settings: hda:pio, hdb:pio
    ide1: BM-DMA at 0xf008-0xf00f, BIOS settings: hdc:pio, hdd:pio
hda: WDC AC36400L, ATA DISK drive
hdb: CD-ROM 36X/AKU, ATAPI CDROM drive
ide0 at 0x1f0-0x1f7,0x3f6 on irq 14
hda: WDC AC36400L, 6149MB w/256kB Cache, CHS=784/255/63, UDMA
Floppy drive(s): fd0 is 1.44M
FDC 0 is a post-1991 82077
Partition check:
 hda: hda1 hda2 hda3 hda4
VFS: Mounted root (ext2 filesystem) readonly.
Freeing unused kernel memory: 56k freed
rtl8139.c:v1.07 5/6/99 Donald Becker 
http://cesdis.gsfc.nasa.gov/linux/drivers/rtl8139.html
eth0: RealTek RTL8139 Fast Ethernet at 0xe400, IRQ 9, 00:48:54:3f:62:a3.
es1370: version v0.31 time 19:25:42 Sep  5 2000
es1370: found adapter at io 0xe800 irq 10
es1370: features: joystick off, line in, mic impedance 0
es1370: unloading
CPU 0: Machine Check Exception: 0000000400000000<0>Bank 3: b200000000080a01general protection fault: 0000
CPU:    0
EIP:    0010:[<c010e59b>]
EFLAGS: 00010246
eax: 00080a01   ebx: 32000000   ecx: 0000040d   edx: 32000000
esi: 0000000c   edi: 00000003   ebp: 00000003   esp: c8931f98
ds: 0018   es: 0018   ss: 0018
Process kwm (pid: 998, process nr: 33, stackpage=c8931000)
Stack: bfffe458 bfffe438 00000005 c8930000 0000040d 00000000 00000004 00080a01 
       c010a035 c8931fc4 00000000 40276c60 4055b548 00000028 080dd4f0 bfffe458 
       bfffe438 080dd4f0 0000002b 0000002b ffffffff 40189e68 00000023 00010216 
Call Trace: [<c010a035>] 
Code: 0f 30 a1 04 e4 1b c0 89 44 24 10 45 3b 6c 24 10 0f 8c 3b ff 
es1370: version v0.31 time 19:25:42 Sep  5 2000
es1370: found adapter at io 0xe800 irq 10
es1370: features: joystick off, line in, mic impedance 0
es1370: unloading
processor	: 0
vendor_id	: GenuineIntel
cpu family	: 6
model		: 3
model name	: Pentium II (Klamath)
stepping		: 4
cpu MHz		: 300.686192
cache size	: 512 KB
fdiv_bug		: no
hlt_bug		: no
sep_bug		: no
f00f_bug		: no
coma_bug	: no
fpu		: yes
fpu_exception	: yes
cpuid level	: 2
wp		: yes
flags		: fpu vme de pse tsc msr pae mce cx8 sep mtrr pge mca cmov mmx
bogomips	: 599.65
I'm not subscribed so please cc me or list if you reply.
Harley
-- 
"I'm pink therefore I'm spam" - Alexei Sayle
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.kernel.org
Please read the FAQ at 
http://www.tux.org/lkml/