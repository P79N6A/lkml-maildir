Date: Fri, 9 Jan 2004 21:21:08 -0800
From: Pete Zaitcev <>
Subject: Re: [patch] arch-specific cond_syscall usage issues
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2004/1/10/2

On Fri, 9 Jan 2004 19:37:53 -0800
Andrew Morton <akpm@osdl.org> wrote:
> >  Experimenting with trying to use cond_syscall for a few arch-specific
> >  syscalls, I discovered that it can't actually be used outside the file
> >  in which sys_ni_syscall is declared because the assembler doesn't feel
> >  obliged to output the symbol in that case:
> >  One arch (PPC) is apparently trying to use cond_syscall this way
> >  anyway, though it's probably never been actually tested as the above
> >  test was done on a PPC.
> 
> So why does the PPC kernel successfully link?
Perhaps it never was tested right when the change went in.
I saw the same failure when hch did it to sparc, I later did the same:
moved the syscall into kernel/sys.c. Mine wasn't arch specific.
Maybe 3 arches used it (pci_config_read_word or such).
I saw the way ppc did it at that time (2.5.75),
and thought that their toolchain must have been smarter than mine.
The patch is easy. The hard road would be to take it to binutils people
like H.J.Lu and see what they say.
-- Pete
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.kernel.org
More majordomo info at  
http://vger.kernel.org/majordomo-info.html
Please read the FAQ at  
http://www.tux.org/lkml/