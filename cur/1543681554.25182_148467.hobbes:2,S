Date: Tue, 15 Jul 2003 12:51:21 -0700
From: Andrew Morton <>
Subject: Re: [PATCH] [1/2] kernel error reporting (revised)
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2003/7/15/313

Jim Keniston <jkenisto@us.ibm.com> wrote:
>
> +int kernel_error_event_iov(const struct iovec *iov, unsigned int nseg,
> +	u32 groups)
> +{
> ...
> +
> +	return netlink_broadcast(kerror_nl, skb, 0, ~0, GFP_ATOMIC);
This appears to be deadlocky when called from interrupt handlers.
netlink_broadcast() does read_lock(&nl_table_lock).  But nl_table_lock is
not an irq-safe lock.
Possibly netlink_broadcast() can be made callable from hardirq context, but
it looks to be non trivial.  The various error and delivery handlers need
to be reviewed, the kfree_skb() calls should be thought about, etc.
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.kernel.org
More majordomo info at  
http://vger.kernel.org/majordomo-info.html
Please read the FAQ at  
http://www.tux.org/lkml/