Date: Thu, 25 Mar 1999 14:02:33 +0100
From: Olaf Titz <>
Subject: modutils (Re: cipe 1.2.0 & kernel 2.2.x)
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/1999/3/25/45

> Since SMP is enabled by default in the 2.2 kernels, you may forget to turn
> it off while doing kernel config (as I did).  This causes huge problems
> since SMP isn't included by default in CIPE.
Since this error is so common (perhaps the most frequent problem with
CIPE) it would be nice to have a way for the module to test the kernel
for SMP config, so it fails with a clear error message on mismatch.
Better yet, this check should be done in the modutils.
I don't know if this is possible. I'm CC'ing linux-kernel on this,
perhaps someone there knows how to do this? Should apply to _all_
modules.
Of course, using MODVERSIONS should avoid the problem. I have heard
that MODVERSIONS was broken somewhere in the 2.1 cycle, no idea if
this is fixed now.
> BTW, if someone is interested.. 'strace ciped' which ultimately resulted in
> opendev alloc error gave me like 1000 file descriptor errors.  I have no
> idea if that information is useful in tracing the real problem, but you
I assume this is just this code in ciped:
    for (i=getdtablesize()-1; i>2; --i)
	(void) close(i);
which makes sure all fds are closed (and deliberately ignores the
errors). Are your 1000 really 253 or do you use an -ac kernel with
higher fd limit? :-)
This "close everything but standard fds" is employed by a number of
programs, among them shells and perl, to avoid fd leakage. It is
harmless.
Olaf
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.rutgers.edu
Please read the FAQ at 
http://www.tux.org/lkml/