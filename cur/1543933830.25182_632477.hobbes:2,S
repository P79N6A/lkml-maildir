Date: Sat, 29 Dec 2007 11:09:21 -0500
From: Mathieu Desnoyers <>
Subject: [2.6.24 patch] Fix Cell OProfile support
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2007/12/29/73

This patch restores the Cell OProfile support that was killed by
commit 09cadedbdc01f1a4bea1f427d4fb4642eaa19da9.
It puts it in arch/powerpc/Kconfig. Since I don't see any good reason to leave
this as a supplementary user-selectable option, it is now automatically enabled
whenever SPU_FS and OPROFILE are enabled.
Signed-off-by: Mathieu Desnoyers <mathieu.desnoyers@polymtl.ca>
CC: Adrian Bunk <adrian.bunk@movial.fi>
CC: Randy Dunlap <randy.dunlap@oracle.com>
CC: phil.el@wanadoo.fr
CC: paulus@samba.org
CC: linuxppc-dev@ozlabs.org
CC: oprofile-list@lists.sourceforge.net
---
 arch/powerpc/Kconfig |    4 ++++
 1 file changed, 4 insertions(+)
Index: linux-2.6-lttng/arch/powerpc/Kconfig
===================================================================
--- linux-2.6-lttng.orig/arch/powerpc/Kconfig	2007-12-28 17:00:24.000000000 -0500
+++ linux-2.6-lttng/arch/powerpc/Kconfig	2007-12-28 17:00:39.000000000 -0500
@@ -163,6 +163,10 @@ config PPC_OF_PLATFORM_PCI
 	depends on PPC64 # not supported on 32 bits yet
 	default n
 
+config OPROFILE_CELL
+	def_bool y
+	depends on (SPU_FS = y && OPROFILE = m) || (SPU_FS = y && OPROFILE = y)
+
 source "init/Kconfig"
 
 source "arch/powerpc/platforms/Kconfig"
-- 
Mathieu Desnoyers
Computer Engineering Ph.D. Student, Ecole Polytechnique de Montreal
OpenPGP key fingerprint: 8CD5 52C3 8E3C 4140 715F  BA06 3F25 A8FE 3BAE 9A68