Date: Tue, 20 Aug 2002 18:10:40 +0100 (BST)
From: Matt Bernstein <mb/>
Subject: automount doesn't "follow" bind mounts
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2002/8/20/110

I tried to subscribe to the autofs list, but majordomo isn't replying to 
me! I think this is a problem in the automount daemon rather than the 
kernel autofs code itself.
I'm trying to automount our home dirs as
	/homes/$USERNAME
which should bind mount to
	:/home/$SERVER/$HOMENAME/$USERNAME
which should bind mount to
	:/home/$SERVER/$VOLUME/$PATH/$USERNAME
which (phew!) will be an NFS mount to
	$SERVER:/$VOLUME/$PATH/$USERNAME
The idea is that:
	(1) `/bin/pwd` = "/homes/$USERNAME"
	(2) when you run "quota" it'll only report for $SERVER:/$VOLUME
Now.. this all works perfectly if before looking at /homes/$USERNAME you
look at firstly /home/$SERVER/$VOLUME/$PATH/$USERNAME and then secondly
/home/$SERVER/$HOMENAME/$USERNAME, because the bind mounts have something
to bind to. Of course you shouldn't need to know the middle bits, but you
could look them up. Currently the binds mount fail and automount drops in
symlinks; this satisfies (2)  above, but unfortunately not (1).
I hope someone can make sense of this. Is it different in autofs4?
Matt
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.kernel.org
More majordomo info at  
http://vger.kernel.org/majordomo-info.html
Please read the FAQ at  
http://www.tux.org/lkml/