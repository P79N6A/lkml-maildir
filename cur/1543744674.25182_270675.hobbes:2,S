Date: Fri, 12 Nov 2004 18:44:54 -0500
From: Shane Shrybman <>
Subject: Re: [patch] Real-Time Preemption, -RT-2.6.10-rc1-mm3-V0.7.25-1
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2004/11/12/236

On Fri, 2004-11-12 at 15:13, Ingo Molnar wrote:
> * Shane Shrybman <shrybman@aei.ca> wrote:
> 
> > V0.7.25-1 has been stable here with the ivtv driver for 11 hrs. No
> > sign of the ide dma time out issue either. Out of curiosity, do we
> > know what solved that problem?
> 
> could you try the attached patch - does it trigger the DMA timeouts
> again? There were 3 changes to the IOAPIC code that could have affected
> your dma-timeout problem, this patch reverts all of them.
> 
Ok, V0.7.25-1 seems to have resolved the DMA timeout problem.
I don't know how useful it is but this patch also seems to have resolved
that problem.
--- linux-2.6.10-rc1mm3-RT3/arch/i386/kernel/io_apic.c	2004-11-11 16:41:37.000000000 -0500
+++ linux-2.6.10-rc1mm3-RT3.T5/arch/i386/kernel/io_apic.c	2004-11-12 17:54:31.000000000 -0500
@@ -156,7 +156,7 @@
  * generate lots of spurious interrupts due to the POST-ed write not
  * reaching the IOAPIC before the IRQ is ACK-ed in the local APIC.
  */
-#define IOAPIC_POSTFLUSH
+//#define IOAPIC_POSTFLUSH
 
 static void __modify_IO_APIC_irq (unsigned int irq, unsigned long enable, unsigned long disable)
 {
@@ -1940,7 +1940,7 @@
  * unacked local APIC is dangerous on SMP as it can prevent the
  * delivery of IPIs and can thus cause deadlocks.)
  */
-#if defined(CONFIG_PREEMPT_HARDIRQS) && defined(CONFIG_SMP)
+#if defined(CONFIG_PREEMPT_HARDIRQS)
 
 static void mask_and_ack_level_ioapic_irq(unsigned int irq)
 {
Regards,
Shane
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.kernel.org
More majordomo info at  
http://vger.kernel.org/majordomo-info.html
Please read the FAQ at  
http://www.tux.org/lkml/