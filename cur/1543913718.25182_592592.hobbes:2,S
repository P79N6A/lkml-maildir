Date: Mon, 10 Sep 2007 01:03:18 -0700
From: Andrew Morton <>
Subject: Re: [PATCH] PTR_ALIGN
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2007/9/10/13

On Thu, 23 Aug 2007 05:47:03 -0600 Matthew Wilcox <matthew@wil.cx> wrote:
> 
> The AdvanSys driver wants to align some pointers, and the ALIGN macro
> doesn't work for pointers.  Rather than try to make it work, add a new
> PTR_ALIGN macro which is typesafe.
> 
> Signed-off-by: Matthew Wilcox <matthew@wil.cx>
> 
> diff --git a/include/linux/kernel.h b/include/linux/kernel.h
> index f592df7..47160fe 100644
> --- a/include/linux/kernel.h
> +++ b/include/linux/kernel.h
> @@ -34,6 +34,7 @@ extern const char linux_proc_banner[];
> 
>  #define ALIGN(x,a)		__ALIGN_MASK(x,(typeof(x))(a)-1)
>  #define __ALIGN_MASK(x,mask)	(((x)+(mask))&~(mask))
> +#define PTR_ALIGN(p, a)		((typeof(p))ALIGN((unsigned long)(p), (a)))
> 
>  #define ARRAY_SIZE(arr) (sizeof(arr) / sizeof((arr)[0]) + __must_be_array(arr))
> 
I'll plan on getting this thing of beauty into mainline in the next week or
so, so you can get those advansys changes into James's tree.
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.kernel.org
More majordomo info at  
http://vger.kernel.org/majordomo-info.html
Please read the FAQ at  
http://www.tux.org/lkml/