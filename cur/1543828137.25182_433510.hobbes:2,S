Date: Fri, 16 Jun 2006 15:38:04 -0700
From: "H. Peter Anvin" <>
Subject: Re: squashfs size in statfs
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2006/6/16/167

Phillip Lougher wrote:
>> >
>> Yes, because CRAM does it that way, and maybe zisofs does it too:
> 
> Zisofs doesn't (H. Peter Anvin should know as he wrote it :-) ).
> 
> root@pierrot:/# ls -la dir.iso
> -rw-r--r--  1 root root 366592 2006-06-16 22:41 dir.iso
> root@pierrot:/# mount -t iso9660 dir.iso /mnt -o loop
> root@pierrot:/# df /mnt
> Filesystem           1K-blocks      Used Available Use% Mounted on
> /dir.iso                   358       358         0 100% /mnt
> root@pierrot:/# ls -la /mnt
> total 13
> drwxr-xr-x   2 root root     2048 2006-06-16 22:41 .
> drwxr-xr-x  32 root root     4096 2006-06-16 22:56 ..
> -rw-r--r--   1 root root 51200000 2006-06-16 22:40 zero
> 
> Statfs should return the size of the filesystem, not the amount of
> data the filesystem  represents.  In this respect the behaviour of
> Squashfs and Zisofs is correct.
> 
> This is analogous to performing stat on a gzipped file.  The stat
> returns the size of the compressed file, not the uncompressed size.
> 
A better analogy is it is like statting a sparse file on, say, an ext3 filesystem.  stat 
(ls -s) and statfs report the amount of storage consumed.
	-hpa
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.kernel.org
More majordomo info at  
http://vger.kernel.org/majordomo-info.html
Please read the FAQ at  
http://www.tux.org/lkml/