Date: Mon, 24 Apr 2006 19:16:33 +0200
From: Arjan van de Ven <>
Subject: Re: PCI ROM resource allocation issue with 2.6.17-rc2
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2006/4/24/176

On Mon, 2006-04-24 at 10:07 -0700, Linus Torvalds wrote:
> 
> On Mon, 24 Apr 2006, Dave Airlie wrote:
> > 
> > however not doing pci_enable_device causes interrupts to not work on the cards
> > in a lot of circumstances..
> 
> Well, you could use "pci_enable_device_bars(0)" instead.
> 
> That will set up interrupt routing _without_ enabling any BAR's, however, 
> that's probably crazy too, since that means that if an interrupt happens, 
> you're really really screwed and can't do anything about it. So that's 
> probably even more broken than what you do now.
> 
> How about delaying the "pci_enable_device()" until when you actually need 
> it, ie do it in drm_irq_install() instead?
> 
> Of course, I wonder how you could POST the device without having the BAR's 
> enabled, 
you haven't spent enough time reading the X pci code then ;)
(or rather, you've done the same thing but hey who's counting)
X does all that *itself* based on what X thinks is best.
Yes that's silly and X should be taken out and shot for that.
What's worse, this is the kind of thing that is really hard to work
around in a away that isn't going to make having a fixed X work as
well... you can't not enable it for old X and enable it for not-insane X
at the same time ;)
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.kernel.org
More majordomo info at  
http://vger.kernel.org/majordomo-info.html
Please read the FAQ at  
http://www.tux.org/lkml/