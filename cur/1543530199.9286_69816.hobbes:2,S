Date: Thu, 16 Mar 2000 00:58:32 +0300
From: Ivan Kokshaysky <>
Subject: 2.3.99-pre1 mincore/madvise
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2000/3/16/101

These two break anything !i386. Here is the quick fix for
alpha (if we need them at all ;)
Ivan.
--- linux-2.3.99-pre1/include/asm-alpha/mman.h	Mon Jan 26 03:31:47 1998
+++ linux/include/asm-alpha/mman.h	Wed Mar 15 17:21:05 2000
@@ -35,4 +35,10 @@
 #define MAP_ANON	MAP_ANONYMOUS
 #define MAP_FILE	0
 
+#define MADV_NORMAL	0x0		/* default page-in behavior */
+#define MADV_RANDOM	0x1		/* page-in minimum required */
+#define MADV_SEQUENTIAL	0x2		/* read-ahead aggressively */
+#define MADV_WILLNEED	0x3		/* pre-fault pages */
+#define MADV_DONTNEED	0x4		/* discard these pages */
+
 #endif /* __ALPHA_MMAN_H__ */
--- linux-2.3.99-pre1/include/asm-alpha/unistd.h	Wed Mar 15 15:21:51 2000
+++ linux/include/asm-alpha/unistd.h	Wed Mar 15 17:48:54 2000
@@ -76,7 +76,7 @@
 #define __NR_osf_old_vadvise	 72	/* not implemented */
 #define __NR_munmap		 73
 #define __NR_mprotect		 74
-#define __NR_madvise		 75
+#define __NR_osf_madvise	 75
 #define __NR_vhangup		 76
 #define __NR_osf_kmodcall	 77	/* not implemented */
 #define __NR_osf_mincore	 78	/* not implemented */
@@ -311,6 +311,8 @@
 #define __NR_setresgid			371
 #define __NR_getresgid			372
 #define __NR_dipc			373
+#define __NR_mincore			374
+#define __NR_madvise			375
 
 #if defined(__LIBRARY__) && defined(__GNUC__)
 
--- linux-2.3.99-pre1/arch/alpha/kernel/osf_sys.c	Thu Mar  9 00:55:08 2000
+++ linux/arch/alpha/kernel/osf_sys.c	Wed Mar 15 16:57:54 2000
@@ -193,7 +193,7 @@
 /*
  * Heh. As documented by DEC..
  */
-asmlinkage unsigned long sys_madvise(void)
+asmlinkage unsigned long osf_madvise(void)
 {
 	return 0;
 }
--- linux-2.3.99-pre1/arch/alpha/kernel/entry.S	Fri Feb 11 06:00:35 2000
+++ linux/arch/alpha/kernel/entry.S	Wed Mar 15 17:02:11 2000
@@ -853,7 +853,7 @@
 	.quad alpha_ni_syscall
 	.quad sys_munmap
 	.quad sys_mprotect
-	.quad sys_madvise			/* 75 */
+	.quad osf_madvise			/* 75 */
 	.quad sys_vhangup
 	.quad alpha_ni_syscall
 	.quad alpha_ni_syscall
@@ -1155,3 +1155,5 @@
 	.quad sys_getresgid
 	.quad sys_ni_syscall			/* sys_dipc */
 	.quad sys_shmget
+	.quad sys_mincore
+	.quad sys_madvise
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.rutgers.edu
Please read the FAQ at 
http://www.tux.org/lkml/