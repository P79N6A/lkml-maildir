Date: Mon, 14 Aug 2000 18:38:10 -0300
From: Arnaldo Carvalho de Melo <>
Subject: [PATCH] synclink.c: resource allocation fixes
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2000/8/14/168

Hi,
     Please take a look and consider applying.
                        - Arnaldo
--- linux-2.4.0-test7-pre3/drivers/char/synclink.c	Fri Jul 28 06:34:42 2000
+++ linux-2.4.0-test7-pre3.acme/drivers/char/synclink.c	Mon Aug 14 18:35:14 2000
@@ -40,6 +40,10 @@
  * is set for the device). The functionality is determined by which
  * device interface is opened.
  *
+ * Changes:
+ * Arnaldo Carvalho de Melo <acme@conectiva.com.br> - 08/14/2000
+ * - fix some resource allocation issues in mgsl_enumerate_devices
+ *
  * THIS SOFTWARE IS PROVIDED ``AS IS'' AND ANY EXPRESS OR IMPLIED
  * WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES
  * OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE
@@ -4528,6 +4532,13 @@
 	if (!serial_table || !serial_termios || !serial_termios_locked){
 		printk("%s(%d):Can't allocate tty/termios arrays.\n",
 			__FILE__,__LINE__);
+
+		if (serial_table)
+			kfree(serial_table);
+		if (serial_termios)
+			kfree(serial_termios);
+		if (serial_termios_locked)
+			kfree(serial_termios_locked);
 		return -ENOMEM;
 	}
 	
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.rutgers.edu
Please read the FAQ at 
http://www.tux.org/lkml/