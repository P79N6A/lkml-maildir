Date: Tue, 15 Feb 2000 21:58:28 +0300 (MSK)
From: "Khimenko Victor" <>
Subject: Re: Of removable devices
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2000/2/15/126

In <m3vh3qcr17.fsf@toy.mandrakesoft.com> Francis GALIEGUE (francis@mandrakesoft.com) wrote:
> Alexander Viro <viro@math.psu.edu> writes:
>> >
>> > A file is backlinked to the fs superblock, isn't it?
>>
>> Not. _Please_, read any introductory text on UNIX. Seriously. Files on
>> UNIX are nameless. Directories contain pairs (name, reference to file).
> [...]
> I KNOW all this. I'm no beginner with Unix! What I see is that:
> - task_struct contains files_struct
> - files_struct contains struct file **
> - struct file contains dentry *f_dentry
> - dentry contains struct super_block *d_sb...
> Therefore, with a file, you get a reference to a superblock...
Of course if you have file you can find superblock of filesystem where it
sits. And how it'll help you ? Look like you COMPLETELY misundertood my sample.
It was NOT about MC which lost file from under its foot. Not at all. MC can
crash, or you can kill it -- no matter. It was about filesystem!!! When you
ejected floppy with "not fully deleted file" you effectively ruined filesystem
on said floppy ! In case of FAT it'll be lost chains, in case of more complex
filesystem it can be ruined completely. ReiserFS/Ext3fs/JFS can cope with such
accidents but 1) they are not in kernel yet and 2) how many floppies with
other system then ext2fs you have ? That's why supermount is broken AS CONCEPT.
Yes, this all can be changed. You will need "just" rewrite half of VFS layer
to do it. Current VFS implementation does not allow sane supermount. Yes, you
can cook up something (it was even done). It'll work sometimes. But it'll ruin
floppies from time to time. MS DOS doing it, Windows doing it (there are no
easy way to check if filesystem is clean and you can eject floppy safely -- I've
ruined my floppies pretty often on old days when I've used them) but WHY
THE HELL Linux should do this is well ?
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.rutgers.edu
Please read the FAQ at 
http://www.tux.org/lkml/