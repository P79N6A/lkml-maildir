Date: Tue, 1 May 2007 14:46:23 +0100
From: Alan Cox <>
Subject: Re: BAD_SG_DMA panic in aha1542
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2007/5/1/247

> That's as close as it gets without redoing everything from scratch.
> I'll give Alan's and James' patches a go within the next 13 hours.
> 
> (Alan: what *else* would you name a variable associated with a bounce
> buffer besides Zebedee?  Thanks for the occasion to smile...)
The one I sent has a memory leak but it won't matter for basic testing.
Or you can change the final bit to
        scsi_normalize_sense((char *)sense, sizeof(*sense), &sshdr);
        if (zebedee != cgc->buffer) {
                if (cgc->data_direction == DMA_FROM_DEVICE)    
                        memcpy(cgc->buffer, zebedee, cgc->buflen);
                kfree(zebedee); /* Time for bed */        
        }
Alan
--
`I can hear you.` ,said Florence. `It s not true. Noddy and I are just
good friends.`
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.kernel.org
More majordomo info at  
http://vger.kernel.org/majordomo-info.html
Please read the FAQ at  
http://www.tux.org/lkml/