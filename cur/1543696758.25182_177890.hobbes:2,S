Date: Wed, 12 Nov 2003 16:01:58 -0500
From: Peng Li <>
Subject: Re: 512MB/1GB RAM
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2003/11/12/127

This patch works for me.  Thanks.
I used to patch the copy_e820_map() by filling some holes in the
BIOS memory region as E820_RESERVED, i.e.
add_memory_region(0x3ff7a000ULL,0x3ff80000ULL-0x3ff7a000ULL,E820_RESERVED);
Otherwise some of my PCI devices will be mapped to somewhere between
0x3ff7a000 and 0x3ff80000, which doesn't seem to work.  Is it a bug of
the BIOS?
Linux version 2.6.0-test9 (root@think) (gcc version 3.2.3 20030422 (Gentoo Linux 1.4 3.2.3-r2, propolice)) #11 Wed Nov 12 15:42:56 EST 2003
BIOS-provided physical RAM map:
 BIOS-e820: 0000000000000000 - 000000000009f000 (usable)
 BIOS-e820: 000000000009f000 - 00000000000a0000 (reserved)
 BIOS-e820: 00000000000dc000 - 0000000000100000 (reserved)
 BIOS-e820: 0000000000100000 - 000000003ff60000 (usable)
 BIOS-e820: 000000003ff60000 - 000000003ff78000 (ACPI data)
 BIOS-e820: 000000003ff78000 - 000000003ff7a000 (ACPI NVS)
 BIOS-e820: 000000003ff80000 - 0000000040000000 (reserved)
 BIOS-e820: 00000000ff800000 - 0000000100000000 (reserved)
-- Peng
On Mon, Nov 10, 2003 at 09:08:34AM -0800, Linus Torvalds wrote:
> Try this patch and tell me if it makes a difference.
> 
> --- 1.102/arch/i386/kernel/setup.c	Tue Oct 21 22:10:28 2003
> +++ edited/arch/i386/kernel/setup.c	Mon Nov 10 08:23:46 2003
> @@ -87,7 +87,7 @@
>  unsigned int mca_pentium_flag;
>  
>  /* For PCI or other memory-mapped resources */
> -unsigned long pci_mem_start = 0x10000000;
> +unsigned long pci_mem_start = 0x40000000;
>  
>  /* user-defined highmem size */
>  static unsigned int highmem_pages = -1;
> 
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.kernel.org
More majordomo info at  
http://vger.kernel.org/majordomo-info.html
Please read the FAQ at  
http://www.tux.org/lkml/