Date: Sat, 7 May 2005 09:22:26 -0400
From: Yani Ioannou <>
Subject: [PATCH 2.6.12-rc4 3/3] dynamic sysfs callbacks
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2005/5/7/62

The following are some misc manual fixes needed after the last
(autogenerated) patch is applied.
Signed-off-by: Yani Ioannou <yani.ioannou@gmail.com>
diff -uprN -X dontdiff linux-2.6.12-rc4-sysfsdyncallback-autoupdate/drivers/i2c/chips/w83627hf.c linux-2.6.12-rc4-sysfsdyncallback-full/drivers/i2c/chips/w83627hf.c
--- linux-2.6.12-rc4-sysfsdyncallback-autoupdate/drivers/i2c/chips/w83627hf.c	2005-05-07 04:38:23.000000000 -0400
+++ linux-2.6.12-rc4-sysfsdyncallback-full/drivers/i2c/chips/w83627hf.c	2005-05-07 05:03:34.000000000 -0400
@@ -734,7 +734,7 @@ store_beep_reg(struct device *dev, const
 #define sysfs_beep(REG, reg) \
 static ssize_t show_regs_beep_##reg (struct device *dev, char *buf, void *sdata) \
 { \
-	return show_beep_##reg(dev, buf); \
+	return show_beep_##reg(dev, buf, sdata); \
 } \
 static ssize_t \
 store_regs_beep_##reg (struct device *dev, const char *buf, size_t count, void *sdata) \
diff -uprN -X dontdiff linux-2.6.12-rc4-sysfsdyncallback-autoupdate/drivers/i2c/chips/w83781d.c linux-2.6.12-rc4-sysfsdyncallback-full/drivers/i2c/chips/w83781d.c
--- linux-2.6.12-rc4-sysfsdyncallback-autoupdate/drivers/i2c/chips/w83781d.c	2005-05-07 04:38:23.000000000 -0400
+++ linux-2.6.12-rc4-sysfsdyncallback-full/drivers/i2c/chips/w83781d.c	2005-05-07 05:03:34.000000000 -0400
@@ -585,7 +585,7 @@ store_beep_reg(struct device *dev, const
 #define sysfs_beep(REG, reg) \
 static ssize_t show_regs_beep_##reg (struct device *dev, char *buf, void *sdata) \
 { \
-	return show_beep_##reg(dev, buf); \
+	return show_beep_##reg(dev, buf, sdata); \
 } \
 static ssize_t store_regs_beep_##reg (struct device *dev, const char *buf, size_t count, void *sdata) \
 { \
diff -uprN -X dontdiff linux-2.6.12-rc4-sysfsdyncallback-autoupdate/drivers/usb/media/sn9c102_core.c linux-2.6.12-rc4-sysfsdyncallback-full/drivers/usb/media/sn9c102_core.c
--- linux-2.6.12-rc4-sysfsdyncallback-autoupdate/drivers/usb/media/sn9c102_core.c	2005-05-07 04:38:40.000000000 -0400
+++ linux-2.6.12-rc4-sysfsdyncallback-full/drivers/usb/media/sn9c102_core.c	2005-05-07 05:03:34.000000000 -0400
@@ -1130,14 +1130,14 @@ sn9c102_store_green(struct class_device*
 	case BRIDGE_SN9C102:
 		if (value > 0x0f)
 			return -EINVAL;
-		if ((res = sn9c102_store_reg(cd, "0x11", 4)) >= 0)
-			res = sn9c102_store_val(cd, buf, len);
+		if ((res = sn9c102_store_reg(cd, "0x11", 4, sdata)) >= 0)
+			res = sn9c102_store_val(cd, buf, len, sdata);
 		break;
 	case BRIDGE_SN9C103:
 		if (value > 0x7f)
 			return -EINVAL;
-		if ((res = sn9c102_store_reg(cd, "0x04", 4)) >= 0)
-			res = sn9c102_store_val(cd, buf, len);
+		if ((res = sn9c102_store_reg(cd, "0x04", 4, sdata)) >= 0)
+			res = sn9c102_store_val(cd, buf, len, sdata);
 		break;
 	}
 
@@ -1156,8 +1156,8 @@ sn9c102_store_blue(struct class_device* 
 	if (!count || value > 0x7f)
 		return -EINVAL;
 
-	if ((res = sn9c102_store_reg(cd, "0x06", 4)) >= 0)
-		res = sn9c102_store_val(cd, buf, len);
+	if ((res = sn9c102_store_reg(cd, "0x06", 4, sdata)) >= 0)
+		res = sn9c102_store_val(cd, buf, len, sdata);
 
 	return res;
 }
@@ -1174,8 +1174,8 @@ sn9c102_store_red(struct class_device* c
 	if (!count || value > 0x7f)
 		return -EINVAL;
 
-	if ((res = sn9c102_store_reg(cd, "0x05", 4)) >= 0)
-		res = sn9c102_store_val(cd, buf, len);
+	if ((res = sn9c102_store_reg(cd, "0x05", 4, sdata)) >= 0)
+		res = sn9c102_store_val(cd, buf, len, sdata);
 
 	return res;
 }
diff -uprN -X dontdiff linux-2.6.12-rc4-sysfsdyncallback-autoupdate/drivers/w1/w1_family.h linux-2.6.12-rc4-sysfsdyncallback-full/drivers/w1/w1_family.h
--- linux-2.6.12-rc4-sysfsdyncallback-autoupdate/drivers/w1/w1_family.h	2005-05-07 04:34:48.000000000 -0400
+++ linux-2.6.12-rc4-sysfsdyncallback-full/drivers/w1/w1_family.h	2005-05-07 05:03:34.000000000 -0400
@@ -34,10 +34,10 @@
 
 struct w1_family_ops
 {
-	ssize_t (* rname)(struct device *, char *);
+	ssize_t (* rname)(struct device *, char *, void *);
 	ssize_t (* rbin)(struct kobject *, char *, loff_t, size_t);
 	
-	ssize_t (* rval)(struct device *, char *);
+	ssize_t (* rval)(struct device *, char *, void *);
 	unsigned char rvalname[MAXNAMELEN];
 };
 