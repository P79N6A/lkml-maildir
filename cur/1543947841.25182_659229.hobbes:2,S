Date: Mon, 25 Feb 2008 10:48:10 +0300
From: "Alexander Belyakov" <>
Subject: Re: jffs2: -ENOSPC when truncating file?!
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2008/2/25/51

On Sun, Feb 24, 2008 at 2:57 AM, Pavel Machek <pavel@ucw.cz> wrote:
> Hi!
>
>  I'm trying to free space by truncating big file, and I get:
>
>  root@fic-gta01:~# ls -al gps.nmea
>  -rw-r--r--    1 root     root      2332070 Feb 19 22:13 gps.nmea
>  root@fic-gta01:~# > gps.nmea
>  -sh: cannot create gps.nmea: No space left on device
>  root@fic-gta01:~# rm gps.nmea
>  root@fic-gta01:~# > gps.nmea
>  root@fic-gta01:~#
>
>  :-(
>
>  Kernel is not-so-ancient, on openmoko:
Hi!
JFFS2 has known bug in GC leading to -ENOSPC upon file removal. Time
ago I've sent a patch with detailed explanations of what is going on.
Probably your case is the same.
Here is the patch
http://lists.infradead.org/pipermail/linux-mtd/2007-December/020091.html
(though infradead mailing list archive is missing most of messages
from this thread)
And here are some details
http://lists.infradead.org/pipermail/linux-mtd/2007-June/018756.html
Alexander