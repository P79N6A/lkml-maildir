Date: Thu, 20 Feb 2003 19:06:13 +0000
From: Christoph Hellwig <>
Subject: Re: [PATCH][ATM] cli() for net/atm/lec.c
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2003/2/20/190

>  extern void (*br_fdb_put_hook)(struct net_bridge_fdb_entry *ent);
> +static spinlock_t lec_arp_spinlock = SPIN_LOCK_UNLOCKED;
> +static unsigned long lec_arp_flags;
> 
> +#define LEC_ARP_LOCK()   spin_lock_irqsave(&lec_arp_spinlock, lec_arp_flags);
> +#define LEC_ARP_UNLOCK() spin_unlock_irqrestore(&lec_arp_spinlock, lec_arp_flags);
I don't think this is a good idea - use the spin_lock calls directly and
always use flags on the stack.
>          dev->get_stats = lec_get_stats;
>          dev->set_multicast_list = NULL;
>          dev->do_ioctl  = NULL;
> +	spin_lock_init(&lec_arp_spinlock);
not needed - you already initialized it at compiletime
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.kernel.org
More majordomo info at  
http://vger.kernel.org/majordomo-info.html
Please read the FAQ at  
http://www.tux.org/lkml/