Date: Fri, 2 Mar 2007 07:24:28 -0800
From: Venkatesh Pallipadi <>
Subject: Re: [-mm patch] cpu_idle: fix build break
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2007/3/2/176

On Fri, Mar 02, 2007 at 02:40:07PM +0000, Frederik Deweerdt wrote:
> On Fri, Mar 02, 2007 at 03:00:26AM -0800, Andrew Morton wrote:
> > +git-acpi-fix-cpuidle-borkage.patch
> This attached patch might be needed too, the build breaks if
> !CONFIG_HOTPLUG_CPU and CONFIG_CPU_IDLE
>  
>   CC      drivers/cpuidle/cpuidle.o
> drivers/cpuidle/cpuidle.c: In function 'cpuidle_init':
> drivers/cpuidle/cpuidle.c:272: erreur: 'cpuidle_cpu_notifier' undeclared (first use in this function)
> drivers/cpuidle/cpuidle.c:272: erreur: (Each undeclared identifier is reported only once
> drivers/cpuidle/cpuidle.c:272: erreur: for each function it appears in.)
> make[2]: *** [drivers/cpuidle/cpuidle.o] Erreur 1
> make[1]: *** [drivers/cpuidle] Erreur 2
> make: *** [drivers] Erreur 2
>
Thanks for catching this breakage. Patch below should be the proper fix.
Thanks,
Venki
Signed-off-by: Venkatesh Pallipadi <venkatesh.pallipadi@intel.com>
 
Index: linux-2.6.21-rc-mm/drivers/cpuidle/cpuidle.c
===================================================================
--- linux-2.6.21-rc-mm.orig/drivers/cpuidle/cpuidle.c
+++ linux-2.6.21-rc-mm/drivers/cpuidle/cpuidle.c
@@ -189,10 +189,6 @@ static struct sysdev_driver cpuidle_sysd
 	.remove		= cpuidle_remove_device,
 };
 
-#ifdef CONFIG_SMP
-
-#ifdef CONFIG_HOTPLUG_CPU
-
 static int cpuidle_cpu_callback(struct notifier_block *nfb,
 					unsigned long action, void *hcpu)
 {
@@ -224,7 +220,7 @@ static struct notifier_block __cpuinitda
     .notifier_call = cpuidle_cpu_callback,
 };
 
-#endif /* CONFIG_HOTPLUG_CPU */
+#ifdef CONFIG_SMP
 
 static void smp_callback(void *v)
 {
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.kernel.org
More majordomo info at  
http://vger.kernel.org/majordomo-info.html
Please read the FAQ at  
http://www.tux.org/lkml/