Date: Fri, 2 Mar 2001 07:27:52 -0800
From: Mitchell Blank Jr <>
Subject: Re: kernel 2.4.2 SMP + ATM hangs
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2001/3/2/67

Miguel Armas wrote:
> A couple days ago we installed a Fore 200E ATM card and after getting the
> ATM address using ilmid the machine hangs. The kernel still respond to
> pings, but the userspace is dead.
> 
> If we remove SMP support in the kernel everything works fine (but with
> only one CPU)...
You probably need the patch that Chas Williams came up with in January.
I've been meaning to forward it, but I haven't yet.  Please try it and
see if it fixes your problem.
-Mitch
--- net/atm/addr.c.000  Thu Jan 25 16:26:24 2001
+++ net/atm/addr.c      Thu Jan 25 16:26:10 2001
@@ -57,7 +57,6 @@
 {
        struct atm_dev_addr *this;
 
-       spin_lock (&atm_dev_lock);
        down(&local_lock);
        while (dev->local) {
                this = dev->local;
@@ -65,7 +64,6 @@
                kfree(this);
        }
        up(&local_lock);
-       spin_unlock (&atm_dev_lock);
        notify_sigd(dev);
 }
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.kernel.org
More majordomo info at  
http://vger.kernel.org/majordomo-info.html
Please read the FAQ at  
http://www.tux.org/lkml/