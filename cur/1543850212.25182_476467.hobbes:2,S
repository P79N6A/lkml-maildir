Date: Wed, 25 Oct 2006 14:37:57 +0200
From: "Tuncer Ayaz" <>
Subject: IO_APIC broken by 45edfd1db02f818b3dc7e4743ee8585af6b78f78
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2006/10/25/95

I've bisected the non-working'ness of HD-Audio and USB Mouse on one of
my x86_64 boxes back to the following commit.
The machine is an HP xw4400 Core 2 Duo E6600 with the Intel 975X chipset.
Please let me know if you need any debug info.
45edfd1db02f818b3dc7e4743ee8585af6b78f78 is first bad commit
commit 45edfd1db02f818b3dc7e4743ee8585af6b78f78
Author: Yinghai Lu <yinghai.lu@amd.com>
Date:   Sat Oct 21 18:37:01 2006 +0200
    [PATCH] x86-64: typo in __assign_irq_vector when updating pos for
vector and offset
    typo with cpu instead of new_cpu
    Signed-off-by: Yinghai Lu <yinghai.lu@amd.com>
    Signed-off-by: Andi Kleen <ak@suse.de>
:040000 040000 1d64801d89bfb23ef4d63d1625f47122d01ded6c
03bb862d9bfdfb05fb5382d56d52ffe1c5f8aba2 M	arch
Accordingly ther revert-diff is this
diff --git a/arch/x86_64/kernel/io_apic.c b/arch/x86_64/kernel/io_apic.c
index b000017..1fa95d5 100644
--- a/arch/x86_64/kernel/io_apic.c
+++ b/arch/x86_64/kernel/io_apic.c
@@ -651,12 +651,12 @@ next:
                if (vector == IA32_SYSCALL_VECTOR)
                        goto next;
                for_each_cpu_mask(new_cpu, domain)
-                       if (per_cpu(vector_irq, new_cpu)[vector] != -1)
+                       if (per_cpu(vector_irq, cpu)[vector] != -1)
                                goto next;
                /* Found one! */
                for_each_cpu_mask(new_cpu, domain) {
-                       pos[new_cpu].vector = vector;
-                       pos[new_cpu].offset = offset;
+                       pos[cpu].vector = vector;
+                       pos[cpu].offset = offset;
                }
                if (old_vector >= 0) {
                        int old_cpu;
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.kernel.org
More majordomo info at  
http://vger.kernel.org/majordomo-info.html
Please read the FAQ at  
http://www.tux.org/lkml/