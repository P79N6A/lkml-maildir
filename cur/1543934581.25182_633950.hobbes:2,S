Date: Thu, 03 Jan 2008 08:01:59 -0800
From: Daniel Walker <>
Subject: Re: [RFC PATCH 01/11] Add basic support for gcc profiler instrumentation
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2008/1/3/205

On Thu, 2008-01-03 at 02:16 -0500, Steven Rostedt wrote:
> Index: linux-compile.git/Makefile
> ===================================================================
> --- linux-compile.git.orig/Makefile     2008-01-03 01:02:28.000000000 -0500
> +++ linux-compile.git/Makefile  2008-01-03 01:02:39.000000000 -0500
> @@ -509,11 +509,15 @@ endif
> 
>  include $(srctree)/arch/$(SRCARCH)/Makefile
> 
> +ifdef CONFIG_MCOUNT
> +KBUILD_CFLAGS  += -pg -fno-omit-frame-pointer -fno-optimize-sibling-calls
> +else
>  ifdef CONFIG_FRAME_POINTER
>  KBUILD_CFLAGS  += -fno-omit-frame-pointer -fno-optimize-sibling-calls
>  else
>  KBUILD_CFLAGS  += -fomit-frame-pointer
>  endif
> +endif
> 
>  ifdef CONFIG_DEBUG_INFO
>  KBUILD_CFLAGS  += -g
I'd much prefer if you used -finstrument-function since it's already
architecture independent .. It was suggested not too long ago.. There is
also another tracing patchset that is similar to this one which uses it
(KFT)..
Daniel