Date: Wed, 12 Sep 2007 11:00:59 +0200
From: Peter Zijlstra <>
Subject: Re: [PATCH 00/23] per device dirty throttling -v10
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2007/9/12/55

On Tue, 2007-09-11 at 22:31 -0400, John Stoffel wrote:
I hope the snipped questions were sufficiently answered in the other
mail. If not, holler :-)
> Peter> 3 is done by also scaling the dirty limit proportional to the
> Peter> current task's recent dirty rate.
> 
> Do you mean task or device here?  I'm just wondering how well this
> works with a bunch of devices with wildly varying speeds.  
Task. What I do is modify the limit like this:
  current_limit = dirty_limit * p(bdi_writeout) * (1 - p(task_dirty)/8)
Where the p() values are [0, 1].
By including the inverse of the task dirty rate one gets that tasks that
are more agressive dirtiers get throttled more aggressively, whereas
tasks that occasionally dirty a page get a little more room.
[unhandled content-type:application/pgp-signature]