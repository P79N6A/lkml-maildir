Date: Sat, 5 Jun 2004 04:18:13 +0200
From: Andi Kleen <>
Subject: Re: [PATCH] Use numa policy API for boot time policy
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2004/6/4/315

On Sat, 05 Jun 2004 03:56:53 +0200
Manfred Spraul <manfred@colorfullife.com> wrote:
> Andi Kleen wrote:
> 
> >Suggested by Manfred Spraul.
> >
> >__get_free_pages had a hack to do node interleaving allocation at boot time.
> >This patch sets an interleave process policy using the NUMA API for init
> >and the idle threads instead. Before entering the user space init the policy
> >is reset to default again. Result is the same.
> >
> >Advantage is less code and removing of a check from a fast path.
> >
> >Removes more code than it adds.
> >
> >I verified that the memory distribution after boot is roughly the same.
> >
> > 
> >
> Does it work for order != 0 allocations? It's important that the big 
> hash tables do not end up all in node 0. AFAICS alloc_pages_current() 
> calls interleave_nodes() only for order==0 allocs.
That's correct. It will only work for order 0 allocations.
But it sounds quite bogus anyways to move the complete hash tables
to another node anyways. It would probably be better to use vmalloc() 
and a interleaving mapping for it. Then you would get the NUMA bandwidth 
benefit even for accessing single tables.
-Andi
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.kernel.org
More majordomo info at  
http://vger.kernel.org/majordomo-info.html
Please read the FAQ at  
http://www.tux.org/lkml/