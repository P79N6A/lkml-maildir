Date: Thu, 25 Feb 1999 17:42:29 +0100
From: Michael Lausch <>
Subject: Re: PROBLEM: Sending mail-attachment > 45k with Netscape via sendmail hangs
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/1999/2/25/106

>>>>> "mm" == Matthias Moeller <mattes@ice.robin.de>
>>>>> wrote the following on Thu, 25 Feb 1999 16:24:07 +0100 (CET)
mm> On Thu, 25 Feb 1999, Romano Giannetti wrote:
>> Where is  WCHAN of the stalled process? I've seen some stall too, but
>> one of these was totally network-unrelated, just a pipe, and the stall
>> was on pipe_read (or pipe_write). I can reproduce one with jed, but I
>> do not know if it's a jed bug or some other thing.
mm> My self written server and client stall in do_select. A subproc of
mm> INN ("-localhost XOVER") usually stalls in wait_for_tcp_memory.
I had an Ooops in wait_for_tcp_memory (kernel 2.2.1)
It was during a amanda backup run on the client machine. I didn't pay
much attention to it, because ksymoops reported weird opcodes and i
thougt that perhaps the CPU or the memory is flaky. If i look at the
assembler listing of wait_for_tcp_memory i see that thee opcodes c404
don't appear there only 84c404 
 608 04d6 83C404   		addl $4,%esp
            ^^^^ here starts the Code: line 
 609              	.L3035:
 610 04d9 8B466C   		movl 108(%esi),%eax
 611 04dc 394650   		cmpl %eax,80(%esi)
 612 04df 0F8C9D00 		jl .L3038
 612      0000
 613 04e5 BB00E0FF 		movl $-8192,%ebx
 613      FF
 614              	#APP
 615 04ea 21E3     		andl %esp,%ebx; 
 616              	#NO_APP
Feb 23 14:54:30 loki kernel: Unable to handle kernel paging request at virtual address 041be840
Feb 23 14:54:30 loki kernel: current->tss.cr3 = 0120e000, `r3 = 0120e000
Feb 23 14:54:30 loki kernel: *pde = 00000000
Feb 23 14:54:30 loki kernel: Oops: 0000
Feb 23 14:54:30 loki kernel: CPU:    0
Feb 23 14:54:30 loki kernel: EIP:    0010:[<c016e017>]
Feb 23 14:54:30 loki kernel: EFLAGS: 00010246
Feb 23 14:54:30 loki kernel: eax: 00000000   ebx: 00000000   ecx: c106fa10   edx: c197afa0
Feb 23 14:54:30 loki kernel: esi: c106f980   edi: c106f980   ebp: c4e3fed4   esp: c4e3fe88
Feb 23 14:54:30 loki kernel: ds: 0018   es: 0018   ss: 0018
Feb 23 14:54:30 loki kernel: Process gzip (pid: 9706, process nr: 66, stackpage=c4e3f000)
Feb 23 14:54:30 loki kernel: Stack: 000005b4 c106f980 c4e3fed4 c106f980 00000684 c016e456 c106f980 c106f980
Feb 23 14:54:30 loki kernel:        c4e3ff7c 00004000 c008da00 c512f684 00000000 08092090 00001770 00002890
Feb 23 14:54:30 loki kernel:        000005b4 c106fa8c 00000000 ffffffea c0174ea3 c106f980 00000000 c4e3ff7c
Feb 23 14:54:30 loki kernel: Call Trace: [<c016e456>] [<c0174ea3>] [<c017c1ff>] [<c017c170>] [<c015311a>] [<c017c170>] [<c0153331>]
Feb 23 14:54:30 loki kernel:        [<c0153298>] [<c012305e>] [<c0108918>]
Feb 23 14:54:30 loki kernel: Code: c4 04 8b 46 6c 39 46 50 0f 8c 9d 00 00 00 bb 00 e0 ff ff 21
>>EIP: c016e017 <wait_for_tcp_memory+1f/d8>
Trace: c016e456 <tcp_do_sendmsg+386/5a4>
Trace: c0174ea3 <tcp_v4_sendmsg+87/138>
Trace: c017c1ff <inet_sendmsg+8f/a4>
Trace: c017c170 <inet_sendmsg+0/a4>
Trace: c015311a <sock_sendmsg+8a/b0>
Trace: c017c170 <inet_sendmsg+0/a4>
Trace: c0153331 <sock_write+99/a4>
Trace: c0153298 <sock_write+0/a4>
Code:  c016e017 <wait_for_tcp_memory+1f/d8>    00000000 <_EIP>:
Code:  c016e017 <wait_for_tcp_memory+1f/d8>       0:	c4 04 8b       	lesl   (%ebx,%ecx,4),%eax
Code:  c016e01a <wait_for_tcp_memory+22/d8>       3:	46             	incl   %esi
Code:  c016e01b <wait_for_tcp_memory+23/d8>       4:	6c             	insb   (%dx),%es:(%edi)
Code:  c016e01c <wait_for_tcp_memory+24/d8>       5:	39 46 50       	cmpl   %eax,0x50(%esi)
Code:  c016e01f <wait_for_tcp_memory+27/d8>       8:	0f 8c 9d 00 00 	jl     ab <_EIP+0xab> c016e0c2 <wait_for_tcp_memory+ca/d8>
Code:  c016e024 <wait_for_tcp_memory+2c/d8>       d:	00 
Code:  c016e025 <wait_for_tcp_memory+2d/d8>       e:	bb 00 e0 ff ff 	movl   $0xffffe000,%ebx
Code:  c016e02a <wait_for_tcp_memory+32/d8>      13:	21 00          	andl   %eax,(%eax)
mm> Matthias
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.rutgers.edu
Please read the FAQ at 
http://www.tux.org/lkml/