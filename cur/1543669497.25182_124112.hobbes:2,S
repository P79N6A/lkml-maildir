Date: Thu, 10 Apr 2003 18:14:35 +0200
From: Michael Buesch <>
Subject: Re: 2.5.67 compile problem...
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2003/4/10/72

On Thursday 10 April 2003 18:06, Michael Buesch wrote:
> On Thursday 10 April 2003 16:25, Bruno Boettcher wrote:
> > On Tue, Apr 08, 2003 at 08:56:12PM +0200, Michael Buesch wrote:
> > > This may fix it. (It's not tested)
> >
> > partly :D
>
> oops. :) Give this one a try:
> (patch against 2.5.67)
sorry prevoiusly posted patch was wrong.
I hope this one is correct. :D
--- drivers/block/ps2esdi.c.orig	2003-04-10 17:44:57.000000000 +0200
+++ drivers/block/ps2esdi.c	2003-04-10 18:10:13.000000000 +0200
@@ -165,7 +165,6 @@
 	return 0;
 }				/* ps2esdi_init */
 
-module_init(ps2esdi_init);
 
 #ifdef MODULE
 
@@ -183,7 +182,7 @@
 	int drive;
 
 	for(drive = 0; drive < MAX_HD; drive++) {
-	        struct ps2_esdi_i_struct *info = &ps2esdi_info[drive];
+	        struct ps2esdi_i_struct *info = &ps2esdi_info[drive];
 
         	if (cyl[drive] != -1) {
 		  	info->cyl = info->lzone = cyl[drive];
@@ -200,6 +199,8 @@
 
 void
 cleanup_module(void) {
+	int i;
+
 	if(ps2esdi_slot) {
 		mca_mark_as_unused(ps2esdi_slot);
 		mca_set_adapter_procfn(ps2esdi_slot, NULL, NULL);
@@ -214,6 +215,8 @@
 		put_disk(ps2esdi_gendisk[i]);
 	}
 }
+#else /* MODULE */
+module_init(ps2esdi_init);
 #endif /* MODULE */
 
 /* handles boot time command line parameters */
Regards
Michael Buesch.
-- 
My homepage: 
http://www.8ung.at/tuxsoft
fighting for peace is like fu**ing for virginity
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.kernel.org
More majordomo info at  
http://vger.kernel.org/majordomo-info.html
Please read the FAQ at  
http://www.tux.org/lkml/