Date: Sun, 7 Nov 1999 16:29:33 +0100 (CET)
From: Bernhard Rosenkraenzer <>
Subject: 2.3.26 compilation fixes
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/1999/11/7/39

Some patches that make 2.3.26 compile...
Largely untested though (managed to build an RPM, but I don't have the
hardware to test if any of the drivers actually work).
Still doesn't compile on alpha.
LLaP
bero
--- linux/init/main.c~	Tue Oct 19 19:22:19 1999
+++ linux/init/main.c	Tue Nov  2 10:34:55 1999
@@ -485,14 +485,6 @@
 	kmem_cache_init();
 	sti();
 	calibrate_delay();
-#ifdef CONFIG_BLK_DEV_INITRD
-	// FIXME, use the bootmem.h interface.
-	if (initrd_start && !initrd_below_start_ok && initrd_start < memory_start) {
-		printk(KERN_CRIT "initrd overwritten (0x%08lx < 0x%08lx) - "
-		    "disabling it.\n",initrd_start,memory_start);
-		initrd_start = 0;
-	}
-#endif
 	mem_init();
 	kmem_cache_sizes_init();
 #ifdef CONFIG_PROC_FS
--- linux/fs/hpfs/file.c.broken	Tue Nov  2 14:10:38 1999
+++ linux/fs/hpfs/file.c	Tue Nov  2 14:26:15 1999
@@ -94,9 +94,9 @@
 	struct page * page_cache = NULL;
 	long status;
 
-	printk("- off: %08x\n", (int)page->offset);
+	printk("- off: %08x\n", (int)page->index);
 	pgpos = (inode->i_blocks - 1) * 512 & PAGE_CACHE_MASK;
-	while (pgpos < page->offset) {
+	while (pgpos < page->index) {
 long pgp = pgpos;
 		printk("pgpos: %08x, bl: %d\n", (int)pgpos, (int)inode->i_blocks);
 		hash = page_hash(&inode->i_data, pgpos);
--- linux/fs/romfs/inode.c.broke	Tue Nov  2 14:57:05 1999
+++ linux/fs/romfs/inode.c	Tue Nov  2 14:57:19 1999
@@ -404,7 +404,7 @@
 	get_page(page);
 	buf = page_address(page);
 
-	offset = page->offset;
+	offset = page->index;
 	if (offset < inode->i_size) {
 		avail = inode->i_size-offset;
 		readlen = min(avail, PAGE_SIZE);