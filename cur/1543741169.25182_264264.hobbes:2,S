Date: Mon, 25 Oct 2004 02:11:40 -0400
From: Jeff Garzik <>
Subject: Re: Concerns about our pci_{save,restore}_state()
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2004/10/25/18

Benjamin Herrenschmidt wrote:
>  - What about saving/restoring more registers ? I'm not sure wether it
> should be the responsibility of the driver to save and restore things
> above dword 15, but we should at least deal with the case of P2P bridges
> who have more "standard" registers
This is a key concern of mine.
The _driver_ is the only entity that knows really how much space to 
save/restore, and the generic versions are obviously _not_ sufficient to 
support:
* hardware errata such as S3 Trio, where _reading_ or writing certain 
registers in the standard range cause a system lockup
* saving/restoring the standard-defined capability lists, which 
certainly could extend way beyond what's stored now
* saving/restoring the new PCI-Express 4K config area
This is _clearly_ something that should be decided upon in the driver. 
The PCI layer should _only_ present standard helper functions, and maybe 
a standard storage space that works for most drivers; not force all 
drivers through a narrow funnel.
	Jeff
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.kernel.org
More majordomo info at  
http://vger.kernel.org/majordomo-info.html
Please read the FAQ at  
http://www.tux.org/lkml/