Date: Wed, 19 Jan 2005 0:31:37 -0700
From: "Eric W. Biederman" <>
Subject: [PATCH 8/29] vmlinux-fix-physical-addrs
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2005/1/19/72

In vmlinux.lds.h the code is carefull to define every section so vmlinux
properly reports the correct physical load address of code, as well as
it's virtual address.  
The new SECURITY_INIT definition fails to follow that convention and
and causes incorrect physical address to appear in the vmlinux if
there are any security initcalls.
This patch updates the SECURITY_INIT to follow the convention in the rest of the
file.
Signed-off-by: Eric Biederman <ebiederm@xmission.com>
---
 vmlinux.lds.h |    2 +-
 1 files changed, 1 insertion(+), 1 deletion(-)
diff -uNr linux-2.6.11-rc1-mm1-nokexec-x86_64-apic-virtwire-on-shutdown/include/asm-generic/vmlinux.lds.h linux-2.6.11-rc1-mm1-nokexec-vmlinux-fix-physical-addrs/include/asm-generic/vmlinux.lds.h
--- linux-2.6.11-rc1-mm1-nokexec-x86_64-apic-virtwire-on-shutdown/include/asm-generic/vmlinux.lds.h	Fri Jan  7 12:54:13 2005
+++ linux-2.6.11-rc1-mm1-nokexec-vmlinux-fix-physical-addrs/include/asm-generic/vmlinux.lds.h	Tue Jan 18 22:45:34 2005
@@ -73,7 +73,7 @@
 	}
 
 #define SECURITY_INIT							\
-	.security_initcall.init : {					\
+	.security_initcall.init : AT(ADDR(.security_initcall.init) - LOAD_OFFSET) { \
 		VMLINUX_SYMBOL(__security_initcall_start) = .;		\
 		*(.security_initcall.init) 				\
 		VMLINUX_SYMBOL(__security_initcall_end) = .;		\
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.kernel.org
More majordomo info at  
http://vger.kernel.org/majordomo-info.html
Please read the FAQ at  
http://www.tux.org/lkml/