Date: Wed, 06 Feb 2008 10:23:35 -0600
From: Matt Mackall <>
Subject: Re: blackfin compile error
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2008/2/6/151

On Wed, 2008-02-06 at 17:18 +0200, Adrian Bunk wrote:
> Commit 698dd4ba6b12e34e1e432c944c01478c0b2cd773 broke blackfin:
> 
> <--  snip  -->
> 
> ...
>   CC      mm/vmscan.o
> In file included from 
> /home/bunk/linux/kernel-2.6/git/linux-2.6/mm/vmscan.c:44:
> /home/bunk/linux/kernel-2.6/git/linux-2.6/include/linux/swapops.h: In function 'is_swap_pte':
> /home/bunk/linux/kernel-2.6/git/linux-2.6/include/linux/swapops.h:48: error: implicit declaration of function 'pte_none'
> /home/bunk/linux/kernel-2.6/git/linux-2.6/include/linux/swapops.h:48: error: implicit declaration of function 'pte_present'
> make[2]: *** [mm/vmscan.o] Error 1
This suggests that no one's tried to compile -mm on Blackfin since
before September, I think.
Is there somewhere more appropriate to move it? I can't find one.
Failing that, we can wrap it in CONFIG_MMU, I suppose.
Signed-off-by: Matt Mackall <mpm@selenic.com>
diff -r 50a6e531a9f2 include/linux/swapops.h
--- a/include/linux/swapops.h	Mon Feb 04 20:23:02 2008 -0600
+++ b/include/linux/swapops.h	Wed Feb 06 10:21:32 2008 -0600
@@ -42,11 +42,13 @@
 	return entry.val & SWP_OFFSET_MASK(entry);
 }
 
+#ifdef CONFIG_MMU
 /* check whether a pte points to a swap entry */
 static inline int is_swap_pte(pte_t pte)
 {
 	return !pte_none(pte) && !pte_present(pte) && !pte_file(pte);
 }
+#endif
 
 /*
  * Convert the arch-dependent pte representation of a swp_entry_t into an
-- 
Mathematics is the supreme nostalgia of our time.