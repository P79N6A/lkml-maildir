Date: Sat, 03 Jan 2009 19:43:24 +0100
From: Roel Kluin <>
Subject: [PATCH] net: fix SONIC_READ definition
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2009/1/3/106

drivers/net/jazzsonic.c:56:
#define SONIC_READ(reg) (*((volatile unsigned int *)dev->base_addr+reg))
drivers/net/sonic.h:53:
#define SONIC_CAP0             0x24
so drivers/net/jazzsonic.c:143:
val = SONIC_READ(SONIC_CAP0-i);
becomes
val = (*((volatile unsigned int *)dev->base_addr+0x24-i));
That is wrong, isn't it?
------------->8---------8<------------------
Fix SONIC_READ definition
Signed-off-by: Roel Kluin <roel.kluin@gmail.com>
---
diff --git a/drivers/net/jazzsonic.c b/drivers/net/jazzsonic.c
index 334ff9e..b872f23 100644
--- a/drivers/net/jazzsonic.c
+++ b/drivers/net/jazzsonic.c
@@ -53,7 +53,7 @@ static char jazz_sonic_string[] = "jazzsonic";
 /*
  * Macros to access SONIC registers
  */
-#define SONIC_READ(reg) (*((volatile unsigned int *)dev->base_addr+reg))
+#define SONIC_READ(reg) (*((volatile unsigned int *)dev->base_addr+(reg)))
 
 #define SONIC_WRITE(reg,val)						\
 do {									\