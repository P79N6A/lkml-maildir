Date: Wed, 9 Aug 2006 20:00:10 +0200
From: Edgar Toernig <>
Subject: Re: [RFC/PATCH] revoke/frevoke system calls V2
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2006/8/9/307

Alan Cox wrote:
>
> Ar Mer, 2006-08-09 am 10:41 +0200, ysgrifennodd Edgar Toernig:
> > 
> > But after revoke you get EBADF for any operation, even select or close.
> 
> Thats a detail of the proposed implementation that isn't hard to fix.
Fine.
> > And IMHO that's insane that a regular user may close fds in someone else's
> > processes (or munmap some of its memory).  I already see people trying
> > to exploit bugs in system services:
> 
> I can do this already today. In fact the index.html one can be used to
> crash certain products now depending on their configuration. Just do
> 
> 	while { true } do
> 		cp some.html index.html
> 		> index.html
> 	done
> 
> with a shell that truncates on > and you'll be able to bus error them if
> they mmap and are not well written.
I wasn't aware of that (and I would definitely prefer a different behaviour).
But anyway, correct me if I'm wrong, revoke (V2) not simply removes the
pages from the mmaped area as truncating does (the vma stays);  revoke
seems to completely remove the vma which is clearly a security bug.
Future mappings may silently get mapped into the area of the revoked
file without the app noticing it.  It may then hand out data of the new
file still thinking it's sending the old one.
Ciao, ET.
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.kernel.org
More majordomo info at  
http://vger.kernel.org/majordomo-info.html
Please read the FAQ at  
http://www.tux.org/lkml/