Date: Sat, 12 Oct 2002 13:42:05 +0200
From: Matthias Andree <>
Subject: Re: The reason to call it 3.0 is the desktop (was Re: [OT] 2.6 not 3.0 - (NUMA))
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2002/10/12/73

On Fri, 11 Oct 2002, Rob Landley wrote:
> I'm also looking for an "unmount --force" option that works on something 
> other than NFS.  Close all active filehandles (the programs using it can just 
> deal with EBADF or whatever), flush the buffers to disk, and unmount.  None 
> of this "oh I can't do that, you have a zombie process with an open file...", 
> I want  "guillotine this filesystem pronto, capice?" behavior.
Seconded.
The patch at the URL below used to work back with 2.4.9, I did not track
what has become of it, if it still applies, I haven't needed it recently
or if so, Alt-SysRq was fair enough for me. Maybe just updating this
badfs and forced umount patch for 2.4.20 would suffice:
http://www.moses.uklinux.net/patches/forced-umount-2.4.9.patch
It gives me one reject in fs/super.c that I don't know how to fix:
***************
*** 1145,1150 ****
  		return retval;
  	}
  
  	spin_lock(&dcache_lock);
  
  	if (atomic_read(&sb->s_active) > 1) {
--- 1172,1180 ----
  		return retval;
  	}
  
+ 	if (flags&MNT_FORCE)
+ 		quiesce_filesystem(mnt);
+ 
  	spin_lock(&dcache_lock);
  
  	if (atomic_read(&sb->s_active) > 1) {
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.kernel.org
More majordomo info at  
http://vger.kernel.org/majordomo-info.html
Please read the FAQ at  
http://www.tux.org/lkml/