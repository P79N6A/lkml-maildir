Date: Tue, 27 Nov 2007 04:19:48 -0700
From: (Eric W. Biederman)
Subject: Re: [PATCH] kexec: force x86_64 arches to boot kdump kernels on boot cpu
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2007/11/27/107

Andi Kleen <andi@firstfloor.org> writes:
> On Mon, Nov 26, 2007 at 08:47:40PM -0500, Neil Horman wrote:
>> Hey all-
>> 	I've been working on an issue lately involving multi socket x86_64
>> systems connected via hypertransport bridges.  It appears that some systems,
>> disable the hypertransport connections during a kdump operation when all but
> the
>> crashing processor gets halted in machine_crash_shutdown.  This becomes a
>
> That would be hard to believe. Linux cannot shut down CPUs
> completely (put them back to SINIT state) because there is no generic
> interface for this and it might be impossible. They just get put 
> into a HLT loop.
>
> And even if they were in SINIT they would still need the HT connections
> otherwise it would be impossible to ever wake them up.
If forget off the top of my head.  But my memory is that if you send
the proper IPI cpus go back into SINIT.  However linux doesn't do this
currently.
> The way HT setup is normally done is that the BIOS sets it all up
> and then it never changes (except for some error conditions that 
> may cause SYNC flood) 
Yep.
> It would be better to properly root cause before applying.
Agreed.
Eric
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.kernel.org
More majordomo info at  
http://vger.kernel.org/majordomo-info.html
Please read the FAQ at  
http://www.tux.org/lkml/