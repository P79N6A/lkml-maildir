Date: Tue, 11 Mar 2003 21:19:11 +0100
From: Daniel Phillips <>
Subject: Re: [RFC] Improved inode number allocation for HTree
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2003/3/11/127

On Tue 11 Mar 03 20:39, Helge Hafting wrote:
> On Tue, Mar 11, 2003 at 02:41:06PM +0100, Daniel Phillips wrote:
> > <wishful thinking>
> > Now that you mention it, just locking out create and rename during
> > directory traversal would eliminate the pain.  Delete is easy enough to
> > handle during traversal.  For a B-Tree, coalescing could simply be
> > deferred until the traversal is finished, so reading the directory in
> > physical storage order would be fine.  Way, way cleaner than what we have
> > to do now.
> > </wishful thinking>
>
> Ok, so "rm" works.  Then you have things like "mv *.c /usr/src" to worry
> about.
That's equivalent to ls, the shell expands it before doing any moving.  You 
can construct something more interesting with ls | xargs <something nasty>
into the same directory.  Since the user is trying to shoot their foot off, 
let the lock be recursive, and let them do that.
> ...someone evil still
> could cause trouble by keeping a traversal going forever, creating one
> dummy file and deleting one whenever it makes progress.  The directory
> would get big, filled up with placeholders until some ulimit kicks in.
>
> Helge Hafting
It's not clear that's any more evil than things they can do already, eg,
   seq 1 1000000 | xargs -l1 cp -a /usr
Welllll, this is all idle speculation anyway.  Nobody's going to fix the 
flaw this week, if it's even possible (I suspect it is).
Regards,
Daniel
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.kernel.org
More majordomo info at  
http://vger.kernel.org/majordomo-info.html
Please read the FAQ at  
http://www.tux.org/lkml/