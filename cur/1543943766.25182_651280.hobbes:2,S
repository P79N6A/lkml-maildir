Date: Sun, 10 Feb 2008 18:48:08 +0100
From: Maximilian Wilhelm <>
Subject: Re: Kernel Panic in MPT SAS on 2.6.24 (and 2.6.23.14, 2.6.23.9)
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2008/2/10/192

Am Sunday, den 10 February hub Krzysztof Oledzki folgendes in die Tasten:
> >I did a git bisect between v2.6.22 v2.6.23 and it seems that
> > 6cb8f91320d3e720351c21741da795fed580b21b
> >introduced some badness.
> Thanks! This was *really* useful!
> Now, how about attached patch? Should work with both 2.6.23 and 2.6.24.
I build a patched 2.6.24 and it bootet without a problem.
> [SCSI] mpt fusion: Don't oops if NumPhys==0
> Don't oops if NumPhys==0, instead return -ENODEV.
> This patch fixes 
http://bugzilla.kernel.org/show_bug.cgi?id=9909
> Signed-off-by: Krzysztof Piotr Oledzki <ole@ans.pl>
Tested-by: Maximilian Wilhelm <max@rfc2324.org>
> diff -Nur a/drivers/message/fusion/mptsas.c b/drivers/message/fusion/mptsas.c
> --- a/drivers/message/fusion/mptsas.c	2007-10-09 22:31:38.000000000 +0200
> +++ b/drivers/message/fusion/mptsas.c	2008-02-10 17:38:51.000000000 +0100
> @@ -1772,6 +1772,11 @@
>  	if (error)
>  		goto out_free_consistent;
> 
> +	if (!buffer->NumPhys) {
> +		error = -ENODEV;
> +		goto out_free_consistent;
> +	}
> +
>  	/* save config data */
>  	port_info->num_phys = buffer->NumPhys;
>  	port_info->phy_info = kcalloc(port_info->num_phys,
Many Thanks!
Ciao
Max
-- 
	Follow the white penguin.