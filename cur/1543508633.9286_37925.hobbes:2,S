Date: Wed, 8 Sep 1999 11:43:47 -0700 (PDT)
From: (Scott Lurndal)
Subject: Re: BUG: Unable to obtain scsi_result buffer
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/1999/9/8/105

In article <7qncas$8fp1e@fido.engr.sgi.com>, you write:
|> I've done some more digging, and the problem is related to the amount
|> of RAM. I have 1 GiB, which is causing kmalloc() in 2.3.16 to fail
|> with GFP_ATOMIC|GFP_DMA. Note that 2.3.3 is fine.
|> If I boot 2.3.16 with mem=828M, then it's fine. If I boot with
|> mem=829M, then kmalloc() fails.
While there may be a kmalloc boundary problem, I see that 2.3 
still has the problem in drivers/scsi/scsi.c where:
	1) The GFP_DMA flag is set for the Scsi_Cmnd allocation 
	   even for non isa_dma devices, and
	2) There is a gratuitous memset after the scsi_init_malloc
	   (which does a memset itself) which will ooops if the
	   GFP_DMA allocation fails.
The memsets at the front of scan_scsis() should be removed. 
scott
|> 
|> 				Regards,
|> 
|> 					Richard....
|> Old:     rgooch@atnf.csiro.au
|> Current: rgooch@ras.ucalgary.ca
|> 
|> -
|> To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
|> the body of a message to majordomo@vger.rutgers.edu
|> Please read the FAQ at 
http://www.tux.org/lkml/
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.rutgers.edu
Please read the FAQ at 
http://www.tux.org/lkml/