Date: Mon,  1 Dec 2008 09:50:05 +0900 (JST)
From: KOSAKI Motohiro <>
Subject: Re: [PATCH 04/09] memcg: make zone_reclaim_stat
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2008/11/30/135

> KOSAKI Motohiro wrote:
> 
> > @@ -172,6 +173,10 @@ void activate_page(struct page *page)
> > 
> >  		reclaim_stat->recent_rotated[!!file]++;
> >  		reclaim_stat->recent_scanned[!!file]++;
> > +
> > +		memcg_reclaim_stat = mem_cgroup_get_reclaim_stat_by_page(page);
> > +		memcg_reclaim_stat->recent_rotated[!!file]++;
> > +		memcg_reclaim_stat->recent_scanned[!!file]++;
> 
> Also, manipulation of the zone based reclaim_stats happens
> under the lru lock.
> 
> What protects the memcg reclaim stat?
memcg zone and memcg zone_reclaim_stat also use zone->lru_lock.