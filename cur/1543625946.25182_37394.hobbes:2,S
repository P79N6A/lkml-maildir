Date: Wed, 27 Mar 2002 07:40:43 -0800
From: Bob Miller <>
Subject: Re: 2.5.7 process accounting bombs out
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2002/3/27/10

On Wed, Mar 27, 2002 at 01:50:35AM -0500, John Covici wrote:
> Whenever I try to start the init script for process accounting I get
> the following error:
> 
> Mar 27 00:02:02 ccs kernel: kernel BUG at acct.c:169!
> Mar 27 00:02:02 ccs kernel: invalid operand: 0000
> Mar 27 00:02:02 ccs kernel: CPU:    0
> Mar 27 00:02:02 ccs kernel: EIP:    0010:[acct_file_reopen+8/208]
> Not tainted
> Mar 27 00:02:02 ccs kernel: EFLAGS: 00010246
> 
> The system doesn't go down, but is there any way to fix this?
> 
> Thanks.
> 
> -- 
>          John Covici
>          covici@ccs.covici.com
Apply the patch below.
-- 
Bob Miller					Email: rem@osdl.org
Open Source Development Lab			Phone: 503.626.2455 Ext. 17
# This is a BitKeeper generated patch for the following project:
# Project Name: Linux kernel tree
# This patch format is intended for GNU patch command version 2.5 or higher.
# This patch includes the following deltas:
#	           ChangeSet	1.537   -> 1.538  
#	       kernel/acct.c	1.8     -> 1.9    
#
# The following is the BitKeeper ChangeSet Log
# --------------------------------------------
# 02/03/21	rem@doc.pdx.osdl.net	1.538
# Fixed acct.c code by removing the BUG_ON code because it doesn't work
# on UP systems.
# --------------------------------------------
#
diff -Nru a/kernel/acct.c b/kernel/acct.c
--- a/kernel/acct.c	Thu Mar 21 11:32:05 2002
+++ b/kernel/acct.c	Thu Mar 21 11:32:05 2002
@@ -166,8 +166,6 @@
 {
 	struct file *old_acct = NULL;
 
-	BUG_ON(!spin_is_locked(&acct_globals.lock));
-
 	if (acct_globals.file) {
 		old_acct = acct_globals.file;
 		del_timer(&acct_globals.timer);
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.kernel.org
More majordomo info at  
http://vger.kernel.org/majordomo-info.html
Please read the FAQ at  
http://www.tux.org/lkml/