Date: Thu, 15 Dec 2005 09:15:44 +0000 (UTC)
From: Aric Cyr <>
Subject: Re: amd64 cdrom access locks system
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2005/12/15/82

Bartlomiej Zolnierkiewicz <bzolnier <at> gmail.com> writes:
> 
> On 6/14/05, Jeff Wiegley <jeffw <at> cyte.com> wrote:
> > using "dev=/dev/hda" yeilds the exact same behavior...
> > 
> >    Jun 14 03:21:50 localhost kernel: ide-cd: cmd 0x3 timed out
> >    Jun 14 03:21:50 localhost kernel: hda: lost interrupt
> >    Jun 14 03:22:50 localhost kernel: ide-cd: cmd 0x3 timed out
> >    Jun 14 03:22:50 localhost kernel: hda: lost interrupt
> >    Jun 14 03:23:30 localhost kernel: hda: lost interrupt
> 
> Jens, any idea?
> 
> > And I'm a little confused by Robert's suggestion... Should it
> > ever be possible for a user-space application to cause lost
> > interrupts and other kernel state problems regardless of what
> > "interface" is used?? Sure, if the application uses the wrong
> > interface it should get spanked somehow but should it be able to
> > mess up the kernel for other applications as well? (Like now
> > I can't read or eject.)
> 
> It shouldn't be possible unless it is "raw" interface
> (requires CAP_SYS_RAWIO) w/o checking all possible
> parameters (it is not always possible) or device is buggy.
> 
> Also it is quite unlikely that somebody will fix obsolete
> interface (hey, it got obsoleted for some reason .
> 
> Bartlomiej
> 
Has this problem been fixed at all or any workarounds known?  I am having the
exact same issue with similar hardware and the alim15x3 driver.  In my case it
does not matter which method I use for cdrecord (ATA:, ATAPI: or dev=/dev/hda),
I will always get the lost interrupts from the command "cdrecord -atip".  I have
tried other drives without success so I don't believe that is the problem. 
Interestingly cdrdao does not have any problems at all and burns perfectly, so I
suspect that cdrecord might be throwing some command that ide-cd or the IDE
drive doesn't like and fails to recover from.  However, disabling DMA on the
drive via hdparm makes cdrecord work perfectly, so I suspect the alim15x3 driver
more than anything else.  I can play DVDs for hours with DMA enabled just fine
though... go figure.  My current kernel is 2.6.14-gentoo-r6, but I have had this
problem since I first had got the system (around 2.6.12).
I'm really anxious to track this down so if anyone has any information, or need
something from me (logs or debugging) please don't hesitate to ask.
Regards,
  Aric
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.kernel.org
More majordomo info at  
http://vger.kernel.org/majordomo-info.html
Please read the FAQ at  
http://www.tux.org/lkml/