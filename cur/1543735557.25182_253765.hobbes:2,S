Date: Sun, 19 Sep 2004 14:17:39 -0700
From: Andy Lutomirski <>
Subject: Re: 2.6.9-rc1-bk11+ and 2.6.9-rc1-mm3,4 r8169: freeze during boot (FIX included)
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2004/9/19/107

Francois Romieu wrote:
> Jon Mason <jdmason@us.ibm.com> :
> [...]
> 
>>Before I make any sweeping comments about the performance on ppc64, I should 
>>probably do some more tests.  I'll have to get back to you regarding that.
>>
>>Would you like me to run the "Config2" patch on my amd64 system?
> 
> 
> Please do. If I read you correctly, 2.6.9-rc2-bkX works (more or less)
> on both your ppc64 and amd64 systems, right ?
No, still broken.  But I don't see any change at all in 2.6.9-rc2-bk5. 
This is on amd64, with 32-bit slots (I think).
BTW, the crash is not immediate.  It takes several seconds after trying 
to send/recieve.
I say _trying_ because I can't ping anything.  I haven't had time before 
the crash to figure out what's wrong, but the device at the other end 
does flash that a packet came through the wire.
FWIW, it looks like init_board is setting PCIDAC in tp->cp_cmd but that 
isn't updated to the card until after the rx ring is filled in 
r8169_open.  This seems suspicious, since DMA memory is being allocated 
possibly in >32-bit addresses but the card hasn't been told to support 
that.  Fixing this doesn't seem to help, though...
Turning off high DMA fixes it.  Maybe it just needs to be disabled until 
someone figures out what's going on.
--Andy
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.kernel.org
More majordomo info at  
http://vger.kernel.org/majordomo-info.html
Please read the FAQ at  
http://www.tux.org/lkml/