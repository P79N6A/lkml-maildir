Date: Wed, 3 Feb 1999 14:33:11 +0000 (GMT/BST)
From: Mike Jagdis <>
Subject: Problems with 2.2.x IP routing etc.
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/1999/2/3/77

1. The interface metric is ignored. It isn't even possible to
   set the metric on an interface never mind have it used for
   the auto-created routes. Is that intentional?
     Consider, you have two machines A and B. A has a leased
   line to site C, B has a demand dialled ISDN link on hot
   stand by (i.e. configured and ready to dial). A's interface
   should be preferred over B's so B's is configured with a
   higher metric so it only gets traffic if A dies. Is that
   reasonable?
     Diald uses a proxy interface with higher metric than the
   real interface. This simplifies changing things around
   as the link goes up and down (in theory :-) )
2. It is not possible to change the BROADCAST and POINTTOPOINT
   flags on an interface. This appears to be enforced in
   dev_change_flags in the kernel net code. It is not unreasonable
   for ordinary ethernet interfaces to be used as a fast p-t-p
   link between two systems in order to reduce traffic on the
   open network. (This implies that there must be a way to prefer
   the p-t-p link over the main net interface. Metric again?)
3. I don't know how to set a metric on a route with "ip". Nor does
   "ip" appear to display route metrics on routes created with "route"
   although "netstat" does.
4. Using an ippp interface I can manage to send out packets with
   a source address of 0.0.0.0.
     The interface is configured with an ifconfig and a default
   route added through it with "route add default dev ippp0".
   "ip route" tells me:
     10.1.254.1 dev ippp0  proto kernel  scope link  src 172.16.1.8
     default dev ippp0  scope link
   Packets routed *through* the local host are fine (as expected).
   Packets originating *from* the local host are sent on ippp0
   correctly but have a source address of 0.0.0.0 (as reported
   by the remote host).
     If I use "ip route add default dev ippp0 src 172.16.1.8" instead
   of using  "route" "ip route" tells me:
     10.1.254.1 dev ippp0  proto kernel  scope link src 172.16.1.8
     default dev ippp0  scope link  src 172.16.1.8
   Now locally originating packets go out with the correct source
   address. It looks like a problem with routing through a p-t-p
   but could be an ISDN problem (I haven't been able to reproduce
   the problem over async PPP for instance). This is the ISDN
   code from ftp.suse.com dated 990128 not the old stuff in the
   kernel.
     N.B. I need to use "ip" to set the src addr on the default
   route but I can only set a metric if I use "route" :-(.
-- 
    A train stops at a train station, a bus stops at a bus station.
    On my desk I have a work station...
.----------------------------------------------------------------------.
|  Mike Jagdis                  |  Internet:  mailto:mike@roan.co.uk   |
|  Roan Technology Ltd.         |                                      |
|  54A Peach Street, Wokingham  |  Telephone:  +44 118 989 0403        |
|  RG40 1XG, ENGLAND            |  Fax:        +44 118 989 1195        |
`----------------------------------------------------------------------'
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.rutgers.edu
Please read the FAQ at 
http://www.tux.org/lkml/