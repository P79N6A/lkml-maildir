Date: Tue, 22 Jul 2003 16:24:31 +0200
From: "Udo A. Steinberg" <>
Subject: Re: CPU Lockup with 2.4.21 and 2.4.22-pre
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2003/7/22/91

On 22 Jul 2003 14:55:05 +0200 Michael TroÃŸ (MT) wrote:
MT> As you might know, the Compu-Shack fddi products reached end-of-life
MT> last year.
Yes. Just thought I'd let you know that we aren't using the same
patch as on the website, but one that has been rediffed for 2.4.21 and
has an additional fix from you in it.
MT> As I can't locate the code sequence in my driver module, please check it
MT> with your compiled kernel:
MT>   objdump -d vmlinux | grep -A 20 "7e f5" | grep csfddi
c01f8334:       7e f5                   jle    c01f832b <.text.lock.csfddi>
c01f8336:       e9 87 d1 ff ff          jmp    c01f54c2 <csfddi_transmit+0x22>
c01f8344:       7e f5                   jle    c01f833b <.text.lock.csfddi+0x10>
c01f8346:       e9 b2 d2 ff ff          jmp    c01f55fd <csfddi_transmit_timeout+0x1d>
c01f8354:       7e f5                   jle    c01f834b <.text.lock.csfddi+0x20>
c01f8356:       e9 02 d7 ff ff          jmp    c01f5a5d <csfddi_interrupt+0xd>
c01f8364:       7e f5                   jle    c01f835b <.text.lock.csfddi+0x30>
c01f8366:       e9 e8 d9 ff ff          jmp    c01f5d53 <csfddi_timer_work+0x33>
c01f8374:       7e f5                   jle    c01f836b <.text.lock.csfddi+0x40>
c01f8376:       e9 db da ff ff          jmp    c01f5e56 <csfddi_timer+0x56>
MT> Do you get a result like the code line from your oops, which eip is
MT> referring to?
It's referring to EIP c01f8364. Here is the disassembly of the code fragment.
c01f832b <.text.lock.csfddi>:
c01f832b:       80 bb 94 00 00 00 00    cmpb   $0x0,0x94(%ebx)
c01f8332:       f3 90                   repz nop 
c01f8334:       7e f5                   jle    c01f832b <.text.lock.csfddi>
c01f8336:       e9 87 d1 ff ff          jmp    c01f54c2 <csfddi_transmit+0x22>
c01f833b:       80 be 94 00 00 00 00    cmpb   $0x0,0x94(%esi)               
c01f8342:       f3 90                   repz nop 
c01f8344:       7e f5                   jle    c01f833b <.text.lock.csfddi+0x10>
c01f8346:       e9 b2 d2 ff ff          jmp    c01f55fd <csfddi_transmit_timeout+0x1d>
c01f834b:       80 be 94 00 00 00 00    cmpb   $0x0,0x94(%esi)
c01f8352:       f3 90                   repz nop 
c01f8354:       7e f5                   jle    c01f834b <.text.lock.csfddi+0x20>
c01f8356:       e9 02 d7 ff ff          jmp    c01f5a5d <csfddi_interrupt+0xd>
c01f835b:       80 be 94 00 00 00 00    cmpb   $0x0,0x94(%esi) 
c01f8362:       f3 90                   repz nop 
c01f8364:       7e f5                   jle    c01f835b <.text.lock.csfddi+0x30>
c01f8366:       e9 e8 d9 ff ff          jmp    c01f5d53 <csfddi_timer_work+0x33>
c01f836b:       80 3d 40 be 2e c0 00    cmpb   $0x0,0xc02ebe40
c01f8372:       f3 90                   repz nop
c01f8374:       7e f5                   jle    c01f836b <.text.lock.csfddi+0x40>
c01f8376:       e9 db da ff ff          jmp    c01f5e56 <csfddi_timer+0x56>
c01f837b:       90                      nop
c01f837c:       90                      nop    
c01f837d:       90                      nop    
c01f837e:       90                      nop    
c01f837f:       90                      nop    
I've also put up the vmlinux image at the URL I've posted in my previous
post, if it's of any help.
MT> But you got two different decoding results, didn't you ?!
The first posting which was only sent to LKML and not to you had the
lockup output misdecoded, because I used a wrong System.map.
The second posting (the one I cc'd to you) and the decoded lockup output
(lockup.txt) on the website are the correct ones.
Regards,
-Udo.
[unhandled content-type:application/pgp-signature]