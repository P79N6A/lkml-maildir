Date: Tue, 27 Jul 1999 00:10:00 +0200
From: Kurt Garloff <>
Subject: Re: High-availability question
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/1999/7/26/101

On Mon, Jul 26, 1999 at 10:07:53PM +0100, Stephen C. Tweedie wrote:
> > Ii has to tell the mid-layer that all commands already sent were aborted
> > (DID_RESET) and reset it's negotiation params (Sync, Wide). That's all,
> > basically. 
> 
> In principle it's not really different fromt he retry work we already
> have to do on a host-originated bus reset.
However, Stefan Traby is right in the SCSI code not keeping track of
reservations. It's no big deal, as none of the high-level devices do use
RESERVE/RELEASE to prevent other initiators from messing with their
partitions, anyway. However this should be added to it (as an option).
> > I see another problem: The box which mounts the FS read-only will have
> > inconcsistent buffers and you'll probably see lots of fs warnings. 
> 
> Yes.  Unless you are using raw IO with some synchronisation protocol
> running between the two hosts, you need to make sure that only one host
> has the device mounted at once.
It's no problem to mount a partition ro from more than one initiator,
however. It's a nice way to have your /usr partition shared that way instead
of NFS. You just should not need to remount,rw it in order to have something
installed.
BTW: Unmounting it, flushb and remount it from the other box will work
without problems.
-- 
Kurt Garloff  <garloff@suse.de>           SuSE GmbH, NÃ¼rnberg, FRG
Linux kernel development;      SCSI drivers: tmscsim(DC390), DC395
[unhandled content-type:application/pgp-signature]