Date: Fri, 27 Aug 1999 20:36:46 -0700 (PDT)
From: Andre Hedrick <>
Subject: Re: Oops 2.3.15 in piix_config_drive_for_dma
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/1999/8/27/152

What did you have previously attached as hdb?
Go check you append line in lilo.conf.
Second, Unless you have a BIOS that disables UDMA or have a tool from
quantum....It will hang hard and tight with out the retuning of the
chipset.  If you are insist on using a UDMA drive on a chipset that can
detect and fail to backspeed the device, Linux will never boot.
Disable auto DMAing for now in your build.
Andre Hedrick
The Linux IDE guy
On Fri, 27 Aug 1999, Simon Huggins wrote:
> I imagine this is cos I enabled CONFIG_BLK_DEV_PIIX_TUNING and I
> shouldn't have but anyway just in case it isn't my fault...
> 
> This happened as I booted 2.3.15 (unsurprisingly it happened just after
> hda: QUANTUM FIREBALL EL7.6A, ATA DISK drive
> line of boot.
> 
> Attached is the output of ksymoops and cat /proc/pci
> 
> Here is (the hopefully relevant bit of) my normal boot messages in
> 2.2.12:
> 
> Aug 27 20:26:37 skinner kernel: PIIX3: IDE controller on PCI bus 00 dev 39
> Aug 27 20:26:37 skinner kernel: PIIX3: not 100% native mode: will probe irqs later
> Aug 27 20:26:37 skinner kernel:     ide0: BM-DMA at 0xffa0-0xffa7, BIOS settings: hda:pio, hdb:pio
> Aug 27 20:26:37 skinner kernel:     ide1: BM-DMA at 0xffa8-0xffaf, BIOS settings: hdc:pio, hdd:pio
> Aug 27 20:26:37 skinner kernel: hda: QUANTUM FIREBALL EL7.6A, ATA DISK drive
> Aug 27 20:26:37 skinner kernel: hdb: non-IDE drive, CHS=621/128/63
> Aug 27 20:26:37 skinner kernel: hdc: QUANTUM SIROCCO2550A, ATA DISK drive
> Aug 27 20:26:37 skinner kernel: ide0 at 0x1f0-0x1f7,0x3f6 on irq 14
> Aug 27 20:26:37 skinner kernel: ide1 at 0x170-0x177,0x376 on irq 15
> Aug 27 20:26:37 skinner kernel: hda: QUANTUM FIREBALL EL7.6A, 7339MB w/418kB Cache, CHS=935/255/63, (U)DMA
For the RECORD, the code got it correct and backspeed the drive the DMA
mode 2 from UDMA mode 2.
  Bus  0, device   0, function  0:
    Host bridge: Intel 82437VX Triton II (rev 1).
      Medium devsel.  Master Capable.  Latency=32.
  Bus  0, device   7, function  0:
    ISA bridge: Intel 82371SB PIIX3 ISA (rev 0).
      Medium devsel.  Fast back-to-back capable.  Master Capable.  No bursts.
  Bus  0, device   7, function  1:
    IDE interface: Intel 82371SB PIIX3 IDE (rev 0).
      Medium devsel.  Fast back-to-back capable.  Master Capable. Latency=32.
      I/O at 0xffa0 [0xffa1].
You are dead in the water without the retuning, IMHO.
> Aug 27 20:26:37 skinner kernel: hdb: INVALID GEOMETRY: 128 PHYSICAL HEADS?
> Aug 27 20:26:37 skinner kernel: hdc: QUANTUM SIROCCO2550A, 2445MB w/75kB Cache, CHS=4969/16/63, DMA
> Aug 27 20:26:37 skinner kernel: Partition check:
> 
> Goes off to disable tuning and try again...
> 
> -- 
> Simon                           oOoOo   "Hey, don't call my brother a   oOoOo
> huggie@earth.li                  oOoOo         dildo!" - Kyle          oOoOo
> 
http://ds.dial.pipex.com/huggie/
  oOoOo                               oOoOo
> 
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.rutgers.edu
Please read the FAQ at 
http://www.tux.org/lkml/