Date: Tue, 30 Oct 2001 04:36:02 +0000
From: Sam Vilain <>
Subject: eepro100 quirk with APM suspend on Dell laptops
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2001/10/29/213

Hi there,
With the earlier discussion about the eepro100 vs the e100, and with
hotplug PCI going into the -ac series kernel, I think it's topical I
discuss an APM related quirk.
If you buy a Dell Inspiron with the inbuilt ethernet option, you get a PCI
eepro100.  If you suspend and resume, however, the card seems to be in a
funny state that an rmmod/modprobe won't fix.
I worked around the problem, by adding to the APM config this pre-suspend
action:
  ifdown eth0
  rmmod eepro100
And to the resume action:
  setpci -s8:4 4=17 5=1 c=8 d=20 11=f0 12=ff 13=fb \
               14=c1 15=dc 1a=e0 1b=fb 33=fc 3c=b
  ifup eth0
The setpci command was derived by comparing the contents of the PCI
configuration area for that device before and after a suspend, and
updating only the areas that changed.
Is this a job for `PCI hotplug', a eepro100 driver bug, or something else?
Sam.
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.kernel.org
More majordomo info at  
http://vger.kernel.org/majordomo-info.html
Please read the FAQ at  
http://www.tux.org/lkml/