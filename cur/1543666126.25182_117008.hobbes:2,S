Date: 13 Mar 2003 19:58:21 +0100
From: Daniel Egger <>
Subject: 2.4.20 and 2.5.64 NIC missing interrupts in APIC mode
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2003/3/13/150

Hija,
I just bought a new motherboard "ECS L7VTA" sporting a VIA KT400 chipset
and found an annoying bug which took me quite some time to track down:
As soon as I enable the APIC mode in the BIOS the onboard PHY seems
to ignore any packets which are thrown at it *after* the kernel
initialised itself which is especially nasty since the system is booting
from network effectively stopping its boot when trying to get an IP
using DHCP or mounting a NFS volume in case the IP is fixed. The onboard
NIC is a VIA Rhine II (VT6102).
The startup process looks like:
- POST
- BIOS check
- PXE BIOS initialisation
- PXE boot into etherboot
- Correct detection and initialisation of the NIC in etherboot
- Boot of linux kernel
- Correct initialisation of system including NIC (via-rhine driver from
    Donald Becker as in the standard kernels)
- Endless loop like the following:
-------->
eth0: Setting full-duplex based on MII #1 link partner capability of 41e1.
Sending DCHP requests ...... timed out!
<--------
The NIC initialised itself with the correct interrupt according to the
BIOS screen. As soon as I shut down the APIC mode, everything works as
expected. 
Ideas?
-- 
Servus,
       Daniel
[unhandled content-type:application/pgp-signature]