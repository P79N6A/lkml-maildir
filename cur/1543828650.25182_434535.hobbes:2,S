Date: Tue, 20 Jun 2006 14:52:36 +0400
From: Kirill Smelkov <>
Subject: [PATCH] ide: disable dma for transcend CF
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2006/6/20/150

NB: bart/ide-2.6.git seems to be unmaintained,  so I'm sending this directly to -mm
I have a CF card which identifies itself as model=TRANSCEND rev=200508011
The card id labeled as TS512MCF80
hdparm -i /dev/hdci  reports:
...
DMA modes:  mdma0 mdma1 *mdma2
IDE controller:
IDE interface: VIA Technologies, Inc. VT82C586A/B/VT82C686/A/B/VT823x/A/C PIPC Bus Master IDE (rev 06)
but if dma is turned on i get a lot of errors::
    hdc: dma_timer_epiry: dma_status == 0x21
    hdc: DMA timeout error
    hdc: dma timeout error: status=0x58 { DriveReady SeekComplete DataRequest }
    ide: failed opcode was: unknown
    ...
So blacklist this CF model.
Signed-off-by: Kirill Smelkov <kirr@mns.spb.ru>
Index: linux-2.6.17/drivers/ide/ide-dma.c
===================================================================
--- linux-2.6.17.orig/drivers/ide/ide-dma.c	2006-06-18 05:49:35.000000000 +0400
+++ linux-2.6.17/drivers/ide/ide-dma.c	2006-06-20 11:37:30.000000000 +0400
@@ -129,6 +129,7 @@
 	{ "SanDisk SDP3B-64"	,	"ALL"		},
 	{ "ATAPI CD-ROM DRIVE 40X MAXIMUM",	"ALL"		},
 	{ "_NEC DV5800A",               "ALL"           },  
+	{ "TRANSCEND"		,	"20050811"	},
 	{ NULL			,	NULL		}
 
 };
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.kernel.org
More majordomo info at  
http://vger.kernel.org/majordomo-info.html
Please read the FAQ at  
http://www.tux.org/lkml/