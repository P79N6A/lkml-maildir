Date: Fri, 22 Sep 2000 23:38:54 +0200
From: Andries Brouwer <>
Subject: Re: Reproducable hard locks in 2.2.17. IDE related
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2000/9/22/124

On Fri, Sep 22, 2000 at 12:03:30PM -0700, Andre Hedrick wrote:
> On Fri, 22 Sep 2000, Andries Brouwer wrote:
> 
> > Here 1.4 MB is wasted on hdb because the BIOS has invented
> > this 1229/255/63 translation. The disk access methods on
> > hdb and hdc is the same.
> 
> Yes, and soon CHS will go away completely with 48-bit LBA or if you CHS
> these large drives.  I considered the making of a forced policy if you
> have drives beyond 80 or 100 GB but policies are pooh-poohed regardless if
> they are correct.  Thus I will have to wait for the 137GB limit to enforce
> the standard and make the default CHS limited to 137GB and beyond that you
> have to use LBA.
Andre - please no nonsense and no paranoid rambling.
(i) Look at our IDE driver - you are the maintainer.
The standard (for example ATA-5) says that the LBA capability bit
must be 1. So, we test it in init_idedisk_capacity() and lo! it is 1.
The standard says that a large drive must report geometry
16383/16/63 and we test it in lba_capacity_is_ok(), and lo! it is so.
So, init_idedisk_capacity() sets drive->select.b.lba to 1.
This bit is tested in ide.c:do_rw_disk() and if it is 1,
we use LBA disk access.
So, you do not have to wait at all, and 137GB does not play
any role at all, any large disk that follows ATA-5 will only
be accessed using LBA.
No pooh-pooh or policy involved.
(ii) There is a completely unrelated matter, that of disk geometry.
Disk geometry does not exist (well, yesterday I got a machine
with two 40MB MFM disks - those do have a geometry - but no
recent IDE drive has a geometry), and this translation game
played on certain numbers, called LBA by some people who like
confusion, has no relation at all to disk access.
And the limit involved is 8 GB, not 137 GB.
(iii) The 137 GB limit is the end of CHS and LBA as we know it,
and will be broken by 48-bit LBA. Our drivers do not yet support
this, my copies of the standards do not yet describe this,
as far as I know no such disks exist. Soon.
Andries
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.kernel.org
Please read the FAQ at 
http://www.tux.org/lkml/