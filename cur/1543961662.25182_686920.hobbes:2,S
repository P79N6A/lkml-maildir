Date: Tue, 29 Apr 2008 15:58:24 -0700 (PDT)
From: David Miller <>
Subject: Re: [PATCH] bitops: remove "optimizations"
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2008/4/29/693

From: Thomas Gleixner <tglx@linutronix.de>
Date: Tue, 29 Apr 2008 18:51:51 +0200 (CEST)
> The question is, whether it broke things or just unearthed some bug
> hidden elsewhere.
So I did a quick test, just #if 0'ing out the optimization inline
portions of the find_first_bit() code in linux/bitops.h, and forcing
it to always unconditionally call __find_first_bit() fixes the
regression.
Given that others who tested could not find one case where the
optimization cases actually applied, and it's breaking things for me,
my theory is that it's triggering for some obscure case on sparc64 and
thus showing a bug in these optimizations since in practice I'm the
only person to actually test this new code.