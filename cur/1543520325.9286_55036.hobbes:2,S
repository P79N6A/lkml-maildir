Date: Thu, 23 Dec 1999 17:58:33 +0100 (CET)
From: Arjan van de Ven <>
Subject: Re: Bloat? (khttpd)
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/1999/12/23/107

On Thu, 23 Dec 1999 kuznet@ms2.inr.ac.ru wrote:
[snip]
[2nd issue]
> Another, but related, thing: khttpd grabs user lock on socket
> stolen from hash table. It breaks one of basic assumptions:
> backlogging does not occur, if socket is orphan.
> The first problem was mainly unsolvable inside khttpd.
> It is impossible to get bh lock in user process context. It is already
> solved (to 2.3.15) inside TCP, and solution is not so bad.
> Actually, later it even allowed to relax some constraints for
> backlog processing, so that the result is not purely negative 8).
You mean that even if there was no kHTTPd, the current "inside TCP"
solution is a good thing?
> The second flaw is more or less easy: if khttpd kept slave socket open,
> as all normal users do, rather than stole it from hash table,
> it would remove the problem.
I am uncertain that I understand you correctly. 
Are you talking about the "tcp_v4_lookup_listener" call (ie. the socket
from the webserver) or about the fact that kHTTPd loses interest in the
connection from the other end, once it is in the accept-queue belonging to
the webserver?
Either way is fixable I think/hope.
Greetings,
  Arjan van de Ven
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.rutgers.edu
Please read the FAQ at 
http://www.tux.org/lkml/