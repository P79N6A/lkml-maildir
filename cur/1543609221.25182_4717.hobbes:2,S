Date: Fri, 9 Nov 2001 15:57:08 +0100 (MET)
From: Massimo Dal Zotto <>
Subject: Re: [PATCH] SMM BIOS on Dell i8100
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2001/11/9/93

> On Thu, Nov 08, 2001 at 07:14:03PM +0100, Massimo Dal Zotto wrote:
> > I have released version 1.4 of my package with a new kernel module and
> > some enhancements to the i8kmon utility.
> 
> hello,
> 
> [no patch today :-)]
> 
> here is what top gives me :
>   PID USER     PRI  NI  SIZE  RSS SHARE STAT %CPU %MEM   TIME COMMAND
>  8102 kwisatz   15   0  2612 2612  1804 S     1.3  0.5   0:01 tclsh
>  1663 kwisatz   10   0  3172 2436  2028 S     0.1  0.4   0:25 gkrellm
> 
> It seems that gkrellm (which monitors more than 20 things on my laptop)
> takes only 0.1% of cpu, whereas i8kmon takes 1.3%...
> I have absolutely no idea how to improve that, but I think that should
> be the first thing on the TODO :-)
> 
Hi Stephane,
first question, why is your mailer using a charset=unknown-8bit instead
of the standard iso8859-1?
> Content-Type: text/plain; charset=unknown-8bit
> Content-Disposition: inline
> Content-Transfer-Encoding: quoted-printable
This gives an error in my editor elm and forces me to use cut-and-paste:
> [Charset unknown-8bit unsupported, skipping...]
Now back to i8kutils. No patch today because I was debugging exactly this
problem. I discovered that the SMM calls GET_CPU_TEMP and GET_POWER_STATUS
take a very long time compared to the other calls and this slows down the
whole program. Here is what I discovered:
    cpu_temp    = i8k_get_cpu_temp();			/* 11100 µs */
    left_fan    = i8k_get_fan_status(I8K_FAN_LEFT);	/*   580 µs */
    right_fan   = i8k_get_fan_status(I8K_FAN_RIGHT);	/*   580 µs */
    left_speed  = i8k_get_fan_speed(I8K_FAN_LEFT);	/*   580 µs */
    right_speed = i8k_get_fan_speed(I8K_FAN_RIGHT);	/*   580 µs */
    ac_power    = i8k_get_power_status();		/* 14700 µs */
    fn_key      = i8k_get_fn_status();			/*   750 µs */
Since I can't fix the SMM BIOS I think there is very little I can do,
except avoiding the GET_POWER_STATUS call which uses half of the time.
I will try to get the same information from /proc/apm.
Did you try the latest version (1.4)? Does it work on your I8100?
-- 
Massimo Dal Zotto
+----------------------------------------------------------------------+
|  Massimo Dal Zotto               email: massimo.dalzotto@libero.it   |
|  Via Marconi, 141                phone: ++39-461534251               |
|  38057 Pergine Valsugana (TN)      www: 
http://www.cs.unitn.it/~dz/
  |
|  Italy                                  
http://www.debian.org/~dz/
   |
|  gpg:   2DB65596  3CED BDC6 4F23 BEDA F489 2445 147F 1AEA 2DB6 5596  |
+----------------------------------------------------------------------+
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.kernel.org
More majordomo info at  
http://vger.kernel.org/majordomo-info.html
Please read the FAQ at  
http://www.tux.org/lkml/