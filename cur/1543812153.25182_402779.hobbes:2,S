Date: Fri, 03 Mar 2006 01:07:54 +0900 (JST)
From: Atsushi Nemoto <>
Subject: Re: why do we have wall_jiffies?
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2006/3/2/140

Oh, I missed this thread...
>>>>> On Fri, 17 Feb 2006 10:46:53 -0800, john stultz <johnstul@us.ibm.com> said:
>> In other places there is code that uses (jiffies - wall_jiffies).
>> However I can't see any way that jiffies and wall_jiffies could
>> ever be different (except for a few nanoseconds while executing the
>> code above).  I also can't see any way that `ticks' could ever be
>> anything other than 1.
>> 
>> Is the wall_jiffies stuff just a leftover from days when we used to
>> do timekeeping from a softirq?  Or am I missing something
>> fundamental?
john> Its only use right now is that on some arches we increment
john> jiffies when we detect lost ticks. This then forces xtime to be
john> updated the appropriate number of times.
Currently, jiffies and wall_jiffies is _really_ different most of
time.  The jiffies is almost always one bigger than wall_jiffies (at
least on i386 and MIPS).  Please refer my yesterday's mail (subject:
jiffies_64 vs. jiffies) for the reason.
john> It probably could be killed and the arches can just call
john> do_timer() the appropriate number of times. That might clean
john> some things up. My TOD work would also make it unnecessary.
I just posted a patch to doing this (subject: [PATCH] simplify
update_times ...).  I thought only x86_64 is doing such thing, right?
Also, I suppose then we can get rid of wall_jiffies completely.
---
Atsushi Nemoto
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.kernel.org
More majordomo info at  
http://vger.kernel.org/majordomo-info.html
Please read the FAQ at  
http://www.tux.org/lkml/