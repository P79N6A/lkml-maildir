Date: Fri, 14 Nov 2003 14:29:18 +0100
From: Arjan van de Ven <>
Subject: Re: ptrace + ioctl( LOOP_SET_FD ) brokeness.
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2003/11/14/61

On Fri, 2003-11-14 at 14:09, Bernhard Kaindl wrote:
> The reason for the process hang seems to be the way loop_set_fd calls calls
> kernel_thread():
> 
>         kernel_thread(loop_thread, lo, CLONE_FS | CLONE_FILES | CLONE_SIGHAND);
>         down(&lo->lo_sem); <- This seems to wait for loop_thread()
> 
> Since kernel_thread can fail at the moment, all places where it is
> called would need to be checked and error handling added.
kernel_thread could fail even before, after all it allocates memory.
So this code has always been buggy just harder to trigger
[unhandled content-type:application/pgp-signature]