Date: Sat, 21 Feb 2004 16:32:13 +0000
From: Jamie Lokier <>
Subject: Re: BOOT_CS
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2004/2/21/50

Coywolf Qi Hunt wrote:
> >(the jump and indirect branch aren't guaranteed to have the
> >proper effects, although technically neither should be required due to
> >the %cr0 write):
>
> 
> IMHO, why bother to re-reload %cs again?
> 
> In setup.S, %cs is reloaded already. The enable paging code maps the
> address identically, so %cs already contains the proper selector.
It's to flush the instruction prefetch queue: that's one of the side
effects of ljmp.
I recall an Intel manual that said ljmp is required when switching
between real and protected modes, to flush the prefetch queue.
Unfortunately I don't remember what that manual said about just setting PG.
I'd guess that current generation CPUs don't care about ljmp when
changing modes, but older ones certainly do.
-- Jamie
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.kernel.org
More majordomo info at  
http://vger.kernel.org/majordomo-info.html
Please read the FAQ at  
http://www.tux.org/lkml/