Date: Thu, 25 Mar 2004 14:14:55 -0600
From:  mike.miller@hp ...
Subject: cciss update for 2.6 [1 of 2]
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2004/3/25/99

Please consider this update for 2.6.
This change is required to support the new MSA30 storage enclosure.
If you do a SCSI inquiry to a SATA disk bad things happen. This patch prevents the inquiry from going to SATA disks.
 cciss_scsi.c |    1 +
 1 files changed, 1 insertion(+)
-------------------------------------------------------------------------------
diff -burpN lx265-rc2.orig/drivers/block/cciss_scsi.c lx265-rc2-test/drivers/block/cciss_scsi.c
--- lx265-rc2.orig/drivers/block/cciss_scsi.c	2004-03-24 14:22:15.000000000 -0600
+++ lx265-rc2-test/drivers/block/cciss_scsi.c	2004-03-25 13:45:12.000000000 -0600
@@ -1058,6 +1058,7 @@ cciss_update_non_disk_devices(int cntl_n
 		int devtype;
 
 		/* for each physical lun, do an inquiry */
+		if (ld_buff->LUN[i][3] & 0xC0) continue;
 		memset(inq_buff, 0, sizeof(InquiryData_struct));
 		memcpy(&scsi3addr[0], &ld_buff->LUN[i][0], 8);
 
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.kernel.org
More majordomo info at  
http://vger.kernel.org/majordomo-info.html
Please read the FAQ at  
http://www.tux.org/lkml/