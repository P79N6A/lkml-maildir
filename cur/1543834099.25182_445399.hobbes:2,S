Date: Wed, 19 Jul 2006 11:02:04 +0200
From: Olaf Hering <>
Subject: Re: cc-version not available to change EXTRA_CFLAGS
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2006/7/19/28

 On Sat, Jan 21, Olaf Hering wrote:
> 
> I want to add a gcc version check for reiserfs, on akpms request.
This debug patch still doesnt work in 2.6.18-rc2:
make -kj 14 O=$O
scripts/gcc-version.sh: line 11: _c_flags: command not found
scripts/gcc-version.sh: line 12: _c_flags: command not found
+ '[' 0000 -lt 0500 ']'
+ echo -O1
---
 fs/reiserfs/Makefile |    1 +
 1 file changed, 1 insertion(+)
Index: linux-2.6.18-rc2/fs/reiserfs/Makefile
===================================================================
--- linux-2.6.18-rc2.orig/fs/reiserfs/Makefile
+++ linux-2.6.18-rc2/fs/reiserfs/Makefile
@@ -30,6 +30,7 @@ endif
 ifeq ($(CONFIG_PPC32),y)
 EXTRA_CFLAGS := -O1
 endif
+EXTRA_CFLAGS += $(shell set -x ; if [ $(call cc-version) -lt 0500 ] ; then echo -O1 ; fi ;)
 
 TAGS:
 	etags *.c
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.kernel.org
More majordomo info at  
http://vger.kernel.org/majordomo-info.html
Please read the FAQ at  
http://www.tux.org/lkml/