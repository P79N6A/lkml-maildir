Date: Sun, 16 Mar 2008 19:29:16 +0000
From: Richard Purdie <>
Subject: Re: [GIT PULL] LED updates
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2008/3/16/83

On Sun, 2008-03-16 at 15:18 -0300, Henrique de Moraes Holschuh wrote:
> On Thu, 07 Feb 2008, Richard Purdie wrote:
> > > This one causes trouble (at least on 2.6.23 -- I backported the patch) due
> > > to the 20-byte length limit on sysfs names.  I had to use "tp::<somecrap>"
> > > instead of "thinkpad::<somecrap>" to name LEDs, and still had to reduce
> > > ultrabase_battery to ultrabase_batt :-)
> > > 
> > > Anyway, IMHO, the LED function should come first, and we should not even
> > > need the led driver name anywhere.  In case of clashes in the class sysfs
> > > dir, just tack a .# to the end or somesuch.  The device the LED is tied to
> > > already differentiates them.  That would save a lot of chars for something
> > > much more useful (the function).
> > 
> > Ouch, I'm looking into this. I wish I'd known about it earlier. I agree
> > function is more important but didn't want to break the existing
> > convention. I guess this limitation comes from the kobjects involved...
> 
> Richard, any ideas for that?  It *is* still time to change this for 2.6.25,
> if required.  If you changed it once already, changing it again won't cause
> further damage.
> 
> I need to know if the current naming scheme will hold or not, I do NOT want
> an ABI issue on thinkpad-acpi, and I know for a fact at least Debian will
> want to use the thinkpad-acpi LED interface as soon as I deploy it.  I want
> to send the thinkpad-acpi LED interface patches to the users as soon as
> possible.
> 
> Sincerely?  I think you should make it <function>:[color][.instance] and
> drop device name compleley, ASAP.
> 
> I will write the patches for mainline and your for-mm branch, if that would
> speed up things.  But I need to know what you have decided, first.
As I understand it 2.6.26 will lose the limitation on the name size
entirely so the problem will go away soon. I don't want to change the
existing ABI so changing to what you describe above isn't possible. You
could leave the devicename empty if you wish although I'd prefer you not
to. Keeping it short might be the best option for 2.6.25.
Your other patch looks ok btw although I'm not sure why you sent it
twice. I'll queue that tomorrow.
Cheers,
Richard