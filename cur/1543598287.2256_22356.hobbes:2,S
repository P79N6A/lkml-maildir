Date: Sun, 19 Aug 2001 23:00:32 +0200
From: Daniel Phillips <>
Subject: Re: 2.4.8/2.4.9 VM problems
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2001/8/19/108

On August 17, 2001 03:10 pm, Frank Dekervel wrote:
> Hello,
> 
> since i upgraded to kernel 2.4.8/2.4.9, i noticed everything became noticably 
> slower, and the number of swapins/swapouts increased significantly. When i 
> run 'vmstat 1' i see there is a lot of swap activity constantly when i am 
> reading my mail in kmail. After a fresh bootup in the evening, i can get 
> everything I normally need swapped out by running updatedb or ht://dig. When 
> i do that, my music stops playing for several seconds, and it takes about 3 
> seconds before my applications repaint when i switch back to X after an 
> updatedb run.
> the last time that happent (and the last time i had problems with VM at all) 
> was in 2.4.0-testXX so i think something is wrong ...
> is it possible new used_once does not work for me (and drop_behind used to 
> work fine) ?
> 
> My system configuration : athlon 750, 384 meg ram, 128 meg swap, XFree4.1 and 
> kde2.2.
Could you please try this patch against 2.4.9 (patch -p0):
--- ../2.4.9.clean/mm/memory.c	Mon Aug 13 19:16:41 2001
+++ ./mm/memory.c	Sun Aug 19 21:35:26 2001
@@ -1119,6 +1119,7 @@
 			 */
 			return pte_same(*page_table, orig_pte) ? -1 : 1;
 		}
+		SetPageReferenced(page);
 	}
 
 	/*
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.kernel.org
More majordomo info at  
http://vger.kernel.org/majordomo-info.html
Please read the FAQ at  
http://www.tux.org/lkml/