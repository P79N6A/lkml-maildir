Date: Thu, 11 Nov 1999 17:28:17 +0100
From: Jan Kasprzak <>
Subject: [patch] apm.c w/o CONFIG_MAGIC_SYSRQ
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/1999/11/11/95

	Hello,
	the 2.3.26 linux/arch/i386/kernel/apm.c fails to link unless the
CONFIG_MAGIC_SYSRQ constant is defined. Please consider applying the following
patch:
--- linux/arch/i386/kernel/apm.c.orig	Thu Nov 11 17:16:46 1999
+++ linux/arch/i386/kernel/apm.c	Thu Nov 11 17:17:35 1999
@@ -150,7 +150,9 @@
 
 extern unsigned long get_cmos_time(void);
 
+#ifdef CONFIG_MAGIC_SYSRQ
 extern void (*sysrq_power_off)(void);
+#endif
 
 /*
  * The apm_bios device is one of the misc char devices.
@@ -1367,8 +1369,9 @@
 	/* Install our power off handler.. */
 	if (power_off_enabled)
 		acpi_power_off = apm_power_off;
+#ifdef CONFIG_MAGIC_SYSRQ
 	sysrq_power_off = apm_power_off;
-
+#endif
 	apm_mainloop();
 	return 0;
 }
-Yenya
-- 
\ Jan "Yenya" Kasprzak <kas at fi.muni.cz>       
http://www.fi.muni.cz/~kas/
\\ PGP: finger kas at aisa.fi.muni.cz   0D99A7FB206605D7 8B35FCDE05B18A5E //
\\\             Czech Linux Homepage:  
http://www.linux.cz/
              ///
/// I'd much prefer a sane architecture that doesn't continually try to  \\\
//  reinvent the bad idea of memory windows.   -Linus on Xeon 36-bit MM   \\
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.rutgers.edu
Please read the FAQ at 
http://www.tux.org/lkml/