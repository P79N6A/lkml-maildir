Date: Sat, 4 Sep 2004 10:07:05 +0200
From: "Axel Suppantschitsch" <>
Subject: Serious e1000 timeout problem with kernel 2.6.8-1.521
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2004/9/4/21

Hiya,
	I recently upgraded my network infrastructure to Gigabit Ethernet,
but now I run into serious network problems. At high loads the e1000 driver
times out, resets itself several times per minute. I already read about this
problem with the same and other network drivers, tried out a lot of possible
solutions (acpi=off), but nothing worked out for me. I also tried the latest
NAPI driver from Intel, no success.
At first the specs (details: dmesg.gz)
Fedora Core 2, latest patchlevel (kernel 2.6.8-1.521)
Athlon 1800+ XP (133MHz FSB)
512MB RAM (DDR 233MHz)
Diamond FireGL (Permedia2) PCI VGA Card
MSI KT6 Delta FISR Motherboard (VIA KT600 chipset) with Broadcom Gigabit
onboard
Intel Pro 1000/MT PCI Desktop Adapter (82541GI)
Realtek 8139 PCI Adapter
D-Link DGS-1008D Gigabit Switch
Cat 5 cables (checked with Fluke for compliance)
Following kernel messages are in the messages log:
Sep  3 23:52:26 matrix kernel: NETDEV WATCHDOG: eth1: transmit timed out
Sep  3 23:52:29 matrix kernel: e1000: eth1: e1000_watchdog: NIC Link is Up
1000 Mbps Full Duplex
Sep  3 23:53:04 matrix kernel: NETDEV WATCHDOG: eth1: transmit timed out
Sep  3 23:53:07 matrix kernel: e1000: eth1: e1000_watchdog: NIC Link is Up
1000 Mbps Full Duplex
Following ethtool information for the e1000 driver (eth1):
driver: e1000
version: 5.2.52-k4
firmware-version: N/A
bus-info: 0000:00:06.0
Settings for eth1:
        Supported ports: [ TP ]
        Supported link modes:   10baseT/Half 10baseT/Full
                                100baseT/Half 100baseT/Full
                                1000baseT/Full
        Supports auto-negotiation: Yes
        Advertised link modes:  10baseT/Half 10baseT/Full
                                100baseT/Half 100baseT/Full
                                1000baseT/Full
        Advertised auto-negotiation: Yes
        Speed: 1000Mb/s
        Duplex: Full
        Port: Twisted Pair
        PHYAD: 0
        Transceiver: internal
        Auto-negotiation: on
        Supports Wake-on: umbg
        Wake-on: g
        Current message level: 0x00000007 (7)
        Link detected: yes
NIC statistics:
     rx_packets: 410244
     tx_packets: 1054111
     rx_bytes: 400272468
     tx_bytes: 1442819261
     rx_errors: 0
     tx_errors: 0
     rx_dropped: 0
     tx_dropped: 0
     multicast: 0
     collisions: 0
     rx_length_errors: 0
     rx_over_errors: 0
     rx_crc_errors: 0
     rx_frame_errors: 0
     rx_fifo_errors: 0
     rx_missed_errors: 0
     tx_aborted_errors: 0
     tx_carrier_errors: 0
     tx_fifo_errors: 0
     tx_heartbeat_errors: 0
     tx_window_errors: 0
     tx_abort_late_coll: 0
     tx_deferred_ok: 0
     tx_single_coll_ok: 0
     tx_multi_coll_ok: 0
     rx_long_length_errors: 0
     rx_short_length_errors: 0
     rx_align_errors: 0
     tx_tcp_seg_good: 0
     tx_tcp_seg_failed: 0
     rx_flow_control_xon: 0
     rx_flow_control_xoff: 0
     tx_flow_control_xon: 0
     tx_flow_control_xoff: 0
     rx_csum_offload_good: 409990
     rx_csum_offload_errors: 0
     rx_long_byte_count: 400272468
Following information is from /proc/interrupts:
           CPU0
  0:   36642685          XT-PIC  timer
  1:         18          XT-PIC  i8042
  2:          0          XT-PIC  cascade
  5:    1287758          XT-PIC  ehci_hcd, eth0, VIA8233
  8:          1          XT-PIC  rtc
  9:          0          XT-PIC  acpi
 10:     297076          XT-PIC  uhci_hcd, uhci_hcd, ohci1394, eth1
 11:          0          XT-PIC  uhci_hcd, uhci_hcd
 12:        735          XT-PIC  i8042
 14:     366735          XT-PIC  ide0
 15:     385804          XT-PIC  ide1
NMI:          0
ERR:          0
Please help me out, 
Axel.
[unhandled content-type:application/octet-stream]