Date: Sat, 16 Feb 2008 03:08:50 +0100
From: "Rafael J. Wysocki" <>
Subject: Re: Linux 2.6.25-rc2
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2008/2/15/542

On Friday, 15 of February 2008, Linus Torvalds wrote:
> 
> Ok,
>  this kernel is a winner.
> 
> Just to show how _much_ of a winner it is, it's been awarded a coveted 
> "weasel" series name, which should tell you just how good it's going to 
> be. It's a name revered in Linux kernel history, and as such this brings 
> back the good old days where if you find a bug, you're almost certainly 
> simply mistaken, and you probably just did something wrong.
> 
> But hey, you can try to prove me wrong.  I dare you.
Here you go.
commit 45b503548210fe6f23e92b856421c2a3f05fd034
Author: Laszlo Attila Toth <panther@balabit.hu>
Date:   Tue Feb 12 22:42:09 2008 -0800
    [RTNETLINK]: Send a single notification on device state changes.
contains the following gem:
        if (tb[IFLA_LINKMODE]) {
-               write_lock_bh(&dev_base_lock);
-               dev->link_mode = nla_get_u8(tb[IFLA_LINKMODE]);
-               write_unlock_bh(&dev_base_lock);
+               if (dev->link_mode != nla_get_u8(tb[IFLA_LINKMODE])) {
+                       write_lock_bh(&dev_base_lock);
+                       dev->link_mode = nla_get_u8(tb[IFLA_LINKMODE]);
+                       write_lock_bh(&dev_base_lock);
+                       modified = 1;
+               }
        }
and even with that fixed it breaks NetworkManager (on my test box it apparently
can't get the IP address using DHCP).  Reverting this commit makes things
work again.
Well, it looks like this patch went to you untested and unreviewed, so may I
gently request that it be reverted from your tree, pretty please?
Thanks,
Rafael