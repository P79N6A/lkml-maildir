Date: Tue, 29 Oct 2002 20:34:03 +0100
From: Patrick Mau <>
Subject: Compile fix for 2.5 BK current
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2002/10/29/165

Hallo List,
I need the following two patches to make BK 2.5 current compile.
Hope it's OK to Cc the netfilter core team ?
Please apply,
Patrick
--- net/ipv4/netfilter/ip_conntrack_standalone.c	2002-10-29 20:27:56.000000000 +0100
+++ net/ipv4/netfilter/ip_conntrack_standalone.c.new	2002-10-29 20:23:06.000000000 +0100
@@ -201,7 +201,7 @@
 	/* Local packets are never produced too large for their
 	   interface.  We degfragment them at LOCAL_OUT, however,
 	   so we have to refragment them here. */
-	if ((*pskb)->len > rt->u.dst.pmtu) {
+	if ((*pskb)->len > dst_pmtu(&rt->u.dst)) {
 		/* No hook can be after us, so this should be OK. */
 		ip_fragment(*pskb, okfn);
 		return NF_STOLEN;
--- net/ipv4/netfilter/ipt_REJECT.c	2002-10-29 20:27:56.000000000 +0100
+++ net/ipv4/netfilter/ipt_REJECT.c.new	2002-10-29 20:26:45.000000000 +0100
@@ -148,7 +148,7 @@
 	nskb->dst = &rt->u.dst;
 
 	/* "Never happens" */
-	if (nskb->len > nskb->dst->pmtu)
+	if (nskb->len > dst_pmtu(nskb->dst))
 		goto free_nskb;
 
 	connection_attach(nskb, oldskb->nfct);
@@ -225,8 +225,8 @@
 	/* RFC says return as much as we can without exceeding 576 bytes. */
 	length = skb_in->len + sizeof(struct iphdr) + sizeof(struct icmphdr);
 
-	if (length > rt->u.dst.pmtu)
-		length = rt->u.dst.pmtu;
+	if (length > dst_pmtu(&rt->u.dst))
+		length = dst_pmtu(&rt->u.dst);
 	if (length > 576)
 		length = 576;
 
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.kernel.org
More majordomo info at  
http://vger.kernel.org/majordomo-info.html
Please read the FAQ at  
http://www.tux.org/lkml/