Date: Sun, 06 May 2001 19:16:30 -0400
From: Tom Leete <>
Subject: [PATCH] Inconsistent constraint in asm-i386/rwsem.h
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2001/5/6/61

Hi,
In include/asm-i386/rwsem.h:__up_read(), the auto variable 'tmp' is
asserted to be in edx. This patch adjusts the constraint to match
the variable.
It could be argued that tmp should be declared register instead. I
didn't because the function is inlined. The compiler will know how
much register pressure there is in each instance.
Cheers,
Tom
$ diff -u linux-2.4.5-pre1/include/asm-i386/rwsem.h~
linux-2.4.5-pre1/include/asm-i386/rwsem.h
--- linux-2.4.5-pre1/include/asm-i386/rwsem.h~	Sun May  6 05:48:08 2001
+++ linux-2.4.5-pre1/include/asm-i386/rwsem.h	Sun May  6 07:17:36 2001
@@ -164,7 +164,7 @@
 		"  jmp       1b\n"
 		".previous\n"
 		"# ending __up_read\n"
-		: "+m"(sem->count), "+d"(tmp)
+		: "+m"(sem->count), "+m"(tmp)
 		: "a"(sem)
 		: "memory", "cc");
 }
-- 
The Daemons lurk and are dumb. -- Emerson
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.kernel.org
More majordomo info at  
http://vger.kernel.org/majordomo-info.html
Please read the FAQ at  
http://www.tux.org/lkml/