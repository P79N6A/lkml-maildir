Date: Mon, 8 Sep 2003 13:08:26 +0400
From: Oleg Drokin <>
Subject: Re: First impressions of reiserfs4
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2003/9/8/34

Hello!
On Mon, Sep 08, 2003 at 10:56:41AM +0200, Rogier Wolff wrote:
> > > There  is no installation program that will fail with: "Sorry, 
> > > you only have 100 million inodes free, this program will need
> > > 132 million after installation", and it allows me a quick way 
> > > of counting the number of actual files on the disk.... 
> > You cannot. statfs(2) only exports "Total number of inodes on disk" and
> > "number of free inodes on disk" values for fs. df substracts one from another one
> > to get "number of inodes in use".
> So, you report "oids_in_use + 100M" as total and "100M" as free inodes 
> on disk. Voila!
Yes, we thought about that too. Need to be careful to not overflow "long int".
And idea of filesystem with variable amount of inodes over time sounds confusing to me, too.
> We're using a Unix operating system which has a bunch of standard 
> interfaces. The fun about using those is that lots of stuff "just works"
> even if it wasn't designed to do exactly what you are doing right
> now. So even if "df" wasn't designed to work on NFS, it still works.
Yes. There is a special value of zero, that says "this field have absolutely
no sence for this filesystem". Which is sort of our case.
> But now we're going to get a new "df" which grabs the sysfs info and
> uses that. But it won't work on reiserfs5, as the interface changes
> again. 
Well, if current interface does not allow to see all the stuff you want to,
time to change (introduce new one) interface, anyway.
Bye,
    Oleg
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.kernel.org
More majordomo info at  
http://vger.kernel.org/majordomo-info.html
Please read the FAQ at  
http://www.tux.org/lkml/