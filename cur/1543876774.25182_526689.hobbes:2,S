Date: Tue, 3 Apr 2007 10:24:40 -0700
From: "Williams, Mitch A" <>
Subject: RE: [PATCH] msi: Immediately mask and unmask msi-x irqs.
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2007/4/3/178

Acked-by: Mitch Williams <mitch.a.williams@intel.com>
>This is a simplified and actually more comprehensive form of a bug
>fix from Mitch Williams <mitch.a.williams@intel.com>.
[snip]
>Then if people do have a kernel message stating "No irq for vector" we
>will know it is yet another novel cause that needs a complete new
>investigation.
>
>So here is a one liner that will hopefully be a part of 2.6.21.
>
>Cc: Mitch Williams <mitch.a.williams@intel.com>
>Cc: Greg KH <greg@kroah.com>
>Cc: Andrew Morton <akpm@linux-foundation.org>
>Signed-off-by: "Eric W. Biederman" <ebiederm@xmission.com>
>---
> drivers/pci/msi.c |    1 +
> 1 files changed, 1 insertions(+), 0 deletions(-)
>
>diff --git a/drivers/pci/msi.c b/drivers/pci/msi.c
>index ad33e01..435c195 100644
>--- a/drivers/pci/msi.c
>+++ b/drivers/pci/msi.c
>@@ -94,6 +94,7 @@ static void msi_set_mask_bit(unsigned int 
>irq, int flag)
> 		int offset = entry->msi_attrib.entry_nr * 
>PCI_MSIX_ENTRY_SIZE +
> 			PCI_MSIX_ENTRY_VECTOR_CTRL_OFFSET;
> 		writel(flag, entry->mask_base + offset);
>+		readl(entry->mask_base + offset);
> 		break;
> 	}
> 	default:
>-- 
>1.5.0.4
>
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.kernel.org
More majordomo info at  
http://vger.kernel.org/majordomo-info.html
Please read the FAQ at  
http://www.tux.org/lkml/