Date: Mon, 13 Nov 2006 17:27:10 +0100
From: Remi <>
Subject: Re: 2.6.19-rc5-mm1 : probe of 0000:00:1f.2 failed with error -16
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2006/11/13/150

Selon Fabio Coatti <cova@ferrara.linux.it>:
> Alle 16:20, lunedÃ¬ 13 novembre 2006, Remi ha scritto:
> > Selon Fabio Coatti <cova@ferrara.linux.it>:
> > > > ata_piix: probe of 0000:00:1f.2 failed with error -16
> > > > Kernel panic - not syncing: Attempted to kill init!
> > > >
> > > > I disabled most options in my .config file just keeping ata_piix
> > > > enabled. 2.6.19-rc5 still boots fine but 2.6.19-rc-mm1 gives the same
> > > > previous message.
> > >
> > > It seems exactly the same problem that is hitting me:
> > >
> > > 
http://lkml.org/lkml/2006/11/13/37
> > >
> > > If some patch comes out, I'll be willing to try it asap ;)
> >
> > You are getting the same message
> >
> > ata_piix 0000:00:1f.2: MAP [ P0 P1 IDE IDE ]
> > ACPI: PCI Interrupt 0000:00:1f.2[A] -> GSI 18 (level, low) -> IRQ 17
> > PCI: Unable to reserve I/O region #1:8@1f0 for device 0000:00:1f.2
> > ata_piix: probe of 0000:00:1f.2 failed with error -16
> >
> > But, your drives are driven by the sata_sil driver, which seems to be ok.
> > See your partition tables displayed below.
>
> Not exactly: my fault to not including previous mails, but basically I've two
> different devices: one driven by sata_sil, the other by piix.
> cfr: 
http://lkml.org/lkml/2006/11/12/20
> In this dmesg, the kernel finds only the second device, and assigns the
> name "sda"; of course the right drive (the real "sda" on my system) is not
> detected so the kernel is searching the "/" filesystem where it cannot be
> found.
>
> here the relevant part of lspci output:
>
> 00:1f.2 IDE interface: Intel Corporation 82801EB (ICH5) SATA Controller (rev
> 02) (prog-if 8a [Master SecP PriP])
>         Subsystem: ABIT Computer Corp. Unknown device 1014
>         Flags: bus master, 66MHz, medium devsel, latency 0, IRQ 17
>         I/O ports at <unassigned>
>         I/O ports at <unassigned>
>         I/O ports at <unassigned>
>         I/O ports at <unassigned>
>         I/O ports at f000 [size=16]
ok,
Could you try the following patch which solved the problemn on my laptop?
--- linux-2.6.19-rc5-mm1/drivers/ata/libata-sff.c	2006-11-12 13:08:19.000000000
+0100
+++ w1/drivers/ata/libata-sff.c	2006-11-13 18:32:18.000000000 +0100
@@ -1021,13 +1021,13 @@
 #endif
 	}
-	rc = pci_request_regions(pdev, DRV_NAME);
-	if (rc) {
-		disable_dev_on_err = 0;
-		goto err_out;
-	}
-
-	if (legacy_mode) {
+	if (!legacy_mode) {
+		rc = pci_request_regions(pdev, DRV_NAME);
+		if (rc) {
+			disable_dev_on_err = 0;
+			goto err_out;
+		}
+	} else {
 		if (!request_region(ATA_PRIMARY_CMD, 8, "libata")) {
 			struct resource *conflict, res;
 			res.start = ATA_PRIMARY_CMD;
Remi
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.kernel.org
More majordomo info at  
http://vger.kernel.org/majordomo-info.html
Please read the FAQ at  
http://www.tux.org/lkml/