Date: Thu, 10 Aug 2000 16:57:07 -0500
From: Sam Watters <>
Subject: lock_kernel() & kmalloc - evil together?
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2000/8/10/165

I was reading through the "Linux Kernel Locking HOWTO" and came across the
following:
"9.7 Things Which Sleep
You can never call the following routines from an interrupt context, or while
holding a spinlock, as they may sleep:
	[snippet skipped]
	* kmalloc(GFP_KERNEL)
Interestingly, this may..."
Okay, I screwed up in a  patch I am doing and I put slipped in some
kmalloc(GFP_KERNEL) calls in a segment of code that lies between a
lock_kernel()/unlock_kernel() - specifically in do_fork().  I did find some
other kmalloc(GFP_KERNEL) calls that occur in this same segment (in functions
that get called from do_fork()).  So, am I truly evil for adding these new
kmalloc(GFP_KERNEL) calls?  Any suggestions on how best to allocate memory while
holding a spinlock in 2.4.0?
Thanks!
-- 
----------------------------------------
Sam Watters
SGI
watters@sgi.com
(651) 683-5647
----------------------------------------
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.rutgers.edu
Please read the FAQ at 
http://www.tux.org/lkml/