Date: Thu, 17 Feb 2000 06:15:04 -0600
From: Bill Wendling <>
Subject: Re: URL to the latest /proc/driver/microcode
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2000/2/17/83

Also sprach Tigran Aivazian:
} Hi guys,
} 
} instead of me sending every revision here, here is the URL to the latest:
} 
}    
http://www.ocston.org/~tigran/patches/microcode/mc-2.3.46-p3.patch
} 
Nit picky stuff:
+       proc_microcode->ops = &microcode_inops;
+       printk(KERN_ERR "P6 Microcode Update Driver v%s registered\n",
MICROCODE_VERSION);
+       return 0;
+}
+
+static void __exit microcode_exit(void)
+{
+       remove_proc_entry("microcode", proc_root_driver);
+       printk(KERN_ERR "P6 Microcode Update Driver v%s unregistered\n",
MICROCODE_VERSION);
+}
[skip...]
[in do_update_one()]
+                     printk(KERN_ERR "microcode: CPU%d microcode updated "
+                                     "from revision %d to %d\n", id, rev, val[1]);
Are the above really KERN_ERR messages? I'd think they were more
KERN_INFO, but I could be wrong.
+                     printk(KERN_ERR 
+                          "microcode: CPU%d not 'upgrading' to earlier revision"
+                          " %d (current=%d)\n", id, microcode[i].rev, rev);
This might be more of a KERN_WARN. What do you think? :)
[in microcode_write()]
+               printk(KERN_ERR "microcode: can only write in N*%d bytes units\n", 
+                       sizeof(struct microcode));
+               return -EINVAL;
+               return -EINVAL;
Another KERN_WARN(?). And a duplicate of the return value.
+       lock_kernel();
+       microcode_num = len/sizeof(struct microcode);
Move the "lock_kernel()" below the "microcode_num..." line (for that
extra fraction of a ns :-) ) ?
+static struct file_operations microcode_fops = {
+       write:          microcode_write,
+       open:           microcode_open,
+       release:        microcode_release,
+};
I'm guessing the above is a gcc extension to C of initializing a few
members of a structure? It's slightly confusing, but a stylistic choice.
(If it's standard C, I've never come across it before).
Cheers!
-- 
|| Bill Wendling			wendling@ganymede.isdn.uiuc.edu
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.rutgers.edu
Please read the FAQ at 
http://www.tux.org/lkml/