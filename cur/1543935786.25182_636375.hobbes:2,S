Date: Wed, 9 Jan 2008 11:31:43 -0800 (PST)
From: Christoph Lameter <>
Subject: Re: [PATCH 10/10] x86: Unify percpu.h
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2008/1/9/250

On Wed, 9 Jan 2008, Dave Hansen wrote:
> On Tue, 2008-01-08 at 13:10 -0800, travis@sgi.com wrote:
> > Form a single percpu.h from percpu_32.h and percpu_64.h. Both are now pretty
> > small so this is simply adding them together. 
> 
> I guess I just don't really see the point of moving the code around like
> this.  Before, it would have been easier to tell at a glance before
> whether you were looking at 32 or 64-bit code because of which file you
> are in.  But, now, you need to look for #ifdef context.  I'm not sure
> that's a win.
> 
> This only saves 5 net lines of code, and those are probably from:
> 
> -#ifndef __ARCH_I386_PERCPU__
> -#define __ARCH_I386_PERCPU__
> 
> right?
> 
> The rest of the set looks brilliant, though.  
Well this is only the first patchset. The next one will unify this even 
more (and make percpu functions work consistent between the two arches) 
but it requires changes to the way the %gs register is used in 
x86_64. So we only do the simplest thing here to have one file to patch 
against later.