Date: Fri, 9 Apr 2004 23:30:31 -0400
From: "Ivica Ico Bukvic" <>
Subject: RE: [linux-audio-user] snd-hdsp+cardbus+M6807 notebook=distortion -- First good news
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2004/4/9/125

Thank you very much for an exhaustive breakdown of this issue! Your
assistance has been truly helpful!
I am aware that this burst stuff should be enabled on the 2.6 kernel,
however I am still getting bad results.
The 06 to 04 may be the critical element as even when I have everything
properly running in Win32, when I alter this number the distortion returns
(it is almost like an azimuth on old analogue tape decks that one would
adjust using screwdriver in order to successfully load a program into a
Commodore64 or the legendary Sinclair ZX Spectrum :-).
If I do figure out the problem in Linux and find out that a particular
register is the issue, how can I make my linux box adjust this register at
boot-time (a simple hack-like script in a form of a service comes to mind
but I was hoping to perhaps see a more universal solution if possible)?
Best wishes,
Ivica Ico Bukvic, composer & multimedia sculptor
http://meowing.ccm.uc.edu/~ico/
> -----Original Message-----
> From: Daniel Ritz [mailto:daniel.ritz@gmx.ch]
> Sent: Friday, April 09, 2004 9:48 PM
> To: Ivica Ico Bukvic
> Cc: linux-kernel
> Subject: RE: [linux-audio-user] snd-hdsp+cardbus+M6807 notebook=distortion
> -- First good news
> 
> you can get the same output with
> 	hexdump -v /proc/bus/pci/BUS/DEVICE
> where BUS/DEVICE is the CB controller. eg. 00/09.0
> 
> about the bits:
> - at 81h, from D0 to 90: this is part of the system control register. the
> bit
>   that changed is "Memory read burst enable upstream"
> - at c9h, from 04 to 06: this is an undocumented test register. TI just
> says
>   reserved, EnE says test register, for the bit that changed it adds the
>   comment TLTEnable (default to 1). no idea what it is. it _could_ have
>   something to do with the cardbus latency timer...you can try to play a
> bit
>   with the latency setting after resume when this bit is set. try writing
> to
>   offset 1Bh, put in at least 40h
> 
> to change the bits under linux, use setpci (also good for reading)
> 
> about the memory read burst upstream: 2.6 kernels enable it for most of
> the TI chips and since 2.6.5 also for some TI clones from EnE (incl.
> EnE1410).
> 
> rgds
> -daniel
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.kernel.org
More majordomo info at  
http://vger.kernel.org/majordomo-info.html
Please read the FAQ at  
http://www.tux.org/lkml/