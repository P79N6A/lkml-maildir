Date: Tue, 31 Jul 2007 08:53:10 -0400
From: "Gregory Haskins" <>
Subject: Re: BIOS implementors disabling the LAPIC
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2007/7/31/189

On Tue, 2007-07-31 at 14:32 +0200, John Sigler wrote:
> The motherboard manufacturer (well, their level 1 support, anyway) told 
> me I could "safely enable the LAPIC". If it is safe to enable the LAPIC, 
> then why are they disabling it in the BIOS?
I would guess that because they don't have an IOAPIC, they figured they
don't need the APIC and didn't bother to write support for it.  In
reality, other features of the APIC are useful other than IOAPIC routing
(e.g. LVTT) so as you have discovered, you end up with reduced
functionality for probably no good reason. 
> Is this a "either works or doesn't" situation where hell should break 
> loose if I try to enable the LAPIC and it's not supported by the 
> motherboard, or is this a "you will silently lose data at the worst 
> possible time" situation?
You will most likely be fine.
> 
> >> (And what does it mean to "disable" the LAPIC?)
> > 
> > The LINT0 and LINT1 inputs of the APIC are routed straight to the INT and
> > NMI inputs of the CPU respectively and the rest of the APIC logic becomes
> > inactive (tri-stated, etc.).
> 
> If that were the case, then I could not enable the LAPIC and have NMIs 
> work, right?
No, again you should be fine.  All this means is that LINT0/1 go to
defaults of "EXTINT" and "NMI" when the APIC is disabled.  When they are
enabled, the programming of the LVT for LINT0/1 defines what they are.
When you enable it, linux will start programming the LVT and should
continue to use NMI in whatever way it sees fit.
The one way you will get screwed is if there is some routing information
that *should* be in the ACPI tables that is missing due to the lack of
support.  I don't think you will have an issue, but I figured it should
mention its not guaranteed you wont either.  So don't sue me... ;)
Regards,
-Greg
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.kernel.org
More majordomo info at  
http://vger.kernel.org/majordomo-info.html
Please read the FAQ at  
http://www.tux.org/lkml/