Date: Mon, 6 Mar 2000 18:25:05 -0800
From:  brian@worldcon ...
Subject: pppd vs pcmcia vs 2.2.15pre11
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2000/3/6/219

I wrote earlier that I was having lots of problems with 2.2.15preNN
on my laptop.
Basically, sound stopped working, pppd would die on certain
outbound data xfers, wireless ethernet stopped working.
I spent the weekend verifying that things did indeed still work with
2.2.13, and searching further for what was wrong.
I've narrowed the problem down to something in the pcmcia subsystem
(the add on one).
2.2.13 or 2.2.15pre11 with pcmcia 3.1.3 both work fine.
It is moving to pcmcia 3.1.11 that breaks things.
Basically, pcmcia 3.1.11 grabs irq 10 for itself (which is
hardwired in the laptop to the sound system) and starts
misusing it for itself, breaking the sound subsystem.  It
further assigns IRQ 10 to the various cards that I plug in
and they then misbehave in various ways.
The identical hardware and configuration works fine under
3.1.3 and is broken in various ways under 3.1.11.
In both cases, the PCIC is configure to use polling and 
interrupts 5, 7 and 9 for cards. (to quickly identify
the diffs below just search for '10' without the quotes)
            3.1.11                                 3.1.3
---------------------------------  ----------------------------------
 0:   120353 XT-PIC  timer           0:   7171 XT-PIC  timer
 1:      362 XT-PIC  keyboard        1:    122 XT-PIC  keyboard
 2:        0 XT-PIC  cascade         2:      0 XT-PIC  cascade
                                     5:     14 XT-PIC  eth0
 8:        1 XT-PIC  rtc             8:      1 XT-PIC  rtc
10:      731 XT-PIC  i82365, eth0   10:    104 XT-PIC  MS Sound System
11:        0 XT-PIC  usb-uhci       11:      0 XT-PIC  usb-uhci
12:     5868 XT-PIC  PS/2 Mouse     12:      0 XT-PIC  PS/2 Mouse
13:        1 XT-PIC  fpu            13:      1 XT-PIC  fpu
14:     3587 XT-PIC  ide0           14:   1846 XT-PIC  ide0
15:        3 XT-PIC  ide1           15:      4 XT-PIC  ide1
NMI:       0                       NMI:      0
00:07.0
CardBus bridge:                      00:07.0 CardBus bridge:
 Texas Instruments PCI1131 (rev 01)   Texas Instruments PCI1131 (rev 01)
Subsystem: Unknown device 104c:ac15  Subsystem: Unknown device 104c:ac15
Flags: bus master, medium devsel,    Flags: bus master, medium devsel,
 latency 168, IRQ 10                  latency 168
 Memory at <ignored>                  Memory at <ignored>
 (32-bit, non-prefetchable)           (32-bit, non-prefetchable)
Bus: primary=00, secondary=20,       Bus: primary=00, secondary=20,
 subordinate=22, sec-latency=176      subordinate=22, sec-latency=176
Memory window 0: 60080000-600c0000   Memory window 0: 60041000-60081000
 (prefetchable)                       (prefetchable)
I/O window 0: 00000400-0000047f      I/O window 0: 00000400-0000047f
 16-bit legacy interface ports at     16-bit legacy interface ports at 
 0007                                 0007                                
eth0: Interrupt:10                   eth0: Interrupt:5
 Base address:0x400                   Base address:0x400 
irq 10 is even specifically excluded in the pcmcia config!
Now I'm off the bother the linux-laptop people this problem.
Thanks for the help.
-- 
Brian Litzinger <brian@litzinger.com>
    Copyright (c) 2000 By Brian Litzinger, All Rights Reserved
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.rutgers.edu
Please read the FAQ at 
http://www.tux.org/lkml/