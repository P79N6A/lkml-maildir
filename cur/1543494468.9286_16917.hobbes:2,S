Date: Tue, 4 May 1999 03:55:12 -0400 (EDT)
From: Alexander Viro <>
Subject: Re: Oops/panic in 2.2.5 FAT (readdir?)
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/1999/5/4/35

On Mon, 3 May 1999, Jim Hunziker wrote:
> 
> 
> Jim Hunziker@WAVE_DOMAIN
> 05/03/99 05:04 PM
> This is in reference to a problem Harald Koenig posted on 4/8/99
> (referenced below).  I am achieving a similar problem with kernel 2.2.7 and
> VFAT.  Here are the logging messages.  I can reproduce this, in that it
> happens every night when I leave my Win98 filesystem mounted and
> occasionally while I am trying to read directories on it.  Is there any
> more useful information I can give?  I wasn't able to get the additional
> klogd stuff because of an "error seeking in /dev/kmem."
> 
> Apr 26 04:02:02 landtuna kernel: attempt to access beyond end of device
> Apr 26 04:02:02 landtuna kernel: 03:01: rw=0, want=1073840142,
> limit=6128766
> Apr 26 04:02:02 landtuna kernel: attempt to access beyond end of device
> Apr 26 04:02:02 landtuna kernel: 03:01: rw=0, want=1073840143,
> limit=6128766
> Apr 26 04:02:02 landtuna kernel: attempt to access beyond end of device
> Apr 26 04:02:02 landtuna kernel: 03:01: rw=0, want=1073840143,
> limit=6128766
> Apr 26 04:02:02 landtuna kernel: attempt to access beyond end of device
> Apr 26 04:02:02 landtuna kernel: 03:01: rw=0, want=1073840144,
> limit=6128766
> Apr 26 04:02:02 landtuna kernel: attempt to access beyond end of device
> Apr 26 04:02:02 landtuna kernel: 03:01: rw=0, want=1073840144,
> limit=6128766
> Apr 26 04:02:02 landtuna kernel: attempt to access beyond end of device
> Apr 26 04:02:02 landtuna kernel: 03:01: rw=0, want=1073840145,
> limit=6128766
> Apr 26 04:02:02 landtuna kernel: attempt to access beyond end of device
> Apr 26 04:02:02 landtuna kernel: 03:01: rw=0, want=1073840145,
> limit=6128766
> Apr 26 04:02:02 landtuna kernel: attempt to access beyond end of device
> Apr 26 04:02:02 landtuna kernel: 03:01: rw=0, want=1073840146,
> limit=6128766
> Apr 26 04:02:02 landtuna kernel: Filesystem panic (dev 03:01).
> Apr 26 04:02:02 landtuna kernel:   FAT error
> Apr 26 04:02:02 landtuna kernel:   File system has been set read-only
> Apr 26 04:02:02 landtuna kernel: Directory 513622: bad FAT
> Apr 26 04:02:02 landtuna kernel: 66
Looks like a damaged FAT for me. What does chkdsk say?
Did you have an oops there? If it was just a bunch of warnings followed by
remounting fs read-only - that's what it is supposed to do in case of
inconsistent filesystem. On the theory that further changes may do a lot
of additional damage.
Now, if chkdsk claims that fs is OK or if you are getting oopsen/kernel
panics/stuck processes - that's a different story. Notice that "Filesystem
panic" != kernel panic, it's just an emergency remounting that particular
fs r/o.
> BELOW IS HARALD KOENIG'S ORIGINAL POST:  (sorry, had to copy/paste it
> manually)
Now, that's a different story. He had the same corruption as you, but in
addition to that he triggered buffer overrun in fat_readdirx() that was
fixed in 2.2.7.
> ...
> Unable to handle kernel paging request at virtual address 3f3f3f53
							    "???S" in
the stack in place of return address. And I know how it happened. Plus
there were several bugs giving memory corruption outside of stack.
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.rutgers.edu
Please read the FAQ at 
http://www.tux.org/lkml/