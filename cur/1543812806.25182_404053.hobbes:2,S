Date: Tue, 7 Mar 2006 12:33:55 -0000 (WET)
From: "Rui Nuno Capela" <>
Subject: Re: [PATCH] realtime-preempt patch-2.6.15-rt19 compile error (was:      realtime-preempt patch-2.6.15-rt18 issues)
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2006/3/7/89

On Tue, March 7, 2006 09:40, Jan Altenberg wrote:
> Hi,
>
>
>> -rt19 doesn't compile here (either with CONFIG_EMBEDDED=y or not):
>>
>
> same problem here. Looks like a typo... Am I right?
>
OK. Apllited to -rt19 and tested it all in a hurry.
- The ALSA sequencer RTC timer issue, which was completely broken on
-rt18, seems to be solved. However, its way too early to tell a thing
about the mentioned system lockups.
- The SLAB related usb-storage crash on disconnect is still there:
usb 2-1: new full speed USB device using ohci_hcd and address 2
Initializing USB Mass Storage driver...
scsi0 : SCSI emulation for USB Mass Storage devices
usb-storage: device found at 2
usb-storage: waiting for device to settle before scanning
usbcore: registered new driver usb-storage
USB Mass Storage support registered.
  Vendor: USB 2.0   Model: Flash Disk        Rev: 2.00
  Type:   Direct-Access                      ANSI SCSI revision: 02
SCSI device sda: 2031616 512-byte hdwr sectors (1040 MB)
sda: Write Protect is off
sda: Mode Sense: 0b 00 00 08
sda: assuming drive cache: write through
SCSI device sda: 2031616 512-byte hdwr sectors (1040 MB)
sda: Write Protect is off
sda: Mode Sense: 0b 00 00 08
sda: assuming drive cache: write through
 sda: sda1
sd 0:0:0:0: Attached scsi removable disk sda
usb-storage: device scan complete
usb 2-1: USB disconnect, address 2
slab error in kmem_cache_destroy(): cache `scsi_cmd_cache': Can't free all
objects
 [<c0141d1e>] kmem_cache_destroy+0x66/0xdb (8)
 [<c020487c>] scsi_destroy_command_freelist+0x4e/0x5a (12)
 [<c02054eb>] scsi_host_dev_release+0x4b/0x6e (12)
 [<c01eaca7>] device_release+0x14/0x39 (12)
 [<c019d07f>] kobject_cleanup+0x3e/0x5e (4)
 [<c019d09f>] kobject_release+0x0/0x8 (8)
 [<e054178c>] usb_stor_control_thread+0x0/0x183 [usb_storage] (8)
 [<c019d7ce>] kref_put+0x3a/0x44 (4)
 [<e05418ee>] usb_stor_control_thread+0x162/0x183 [usb_storage] (12)
 [<c0272dc9>] schedule+0xd4/0xf5 (32)
 [<c01226bf>] kthread+0x63/0x8f (20)
 [<c012265c>] kthread+0x0/0x8f (12)
 [<c0100d39>] kernel_thread_helper+0x5/0xb (16)
On reconnect, thereafter:
usb 2-1: new full speed USB device using ohci_hcd and address 3
kmem_cache_create: duplicate cache scsi_cmd_cache
 [<c0141aab>] kmem_cache_create+0x439/0x469 (8)
 [<c0157600>] __d_lookup+0xee/0xf8 (32)
 [<c02047bb>] scsi_setup_command_freelist+0x60/0xd3 (36)
 [<c020572f>] scsi_host_alloc+0x221/0x2ec (28)
 [<c01ebea5>] __device_attach+0x0/0x5 (16)
 [<e0541f44>] storage_probe+0x2b/0x1d0 [usb_storage] (4)
 [<c01ebea5>] __device_attach+0x0/0x5 (24)
 [<e002e071>] usb_probe_interface+0x4b/0x77 [usbcore] (4)
 [<c01ebe56>] driver_probe_device+0x32/0x81 (12)
 [<c01eb8cb>] bus_for_each_drv+0x36/0x58 (16)
 [<c01ebee6>] device_attach+0x3c/0x4b (32)
 [<c01ebea5>] __device_attach+0x0/0x5 (4)
 [<c01eb996>] bus_add_device+0x20/0x75 (12)
 [<c01eaf66>] device_add+0xd0/0x12e (20)
 [<e0034612>] usb_set_configuration+0x31d/0x377 [usbcore] (20)
 [<e002ffd2>] usb_new_device+0xef/0x148 [usbcore] (52)
 [<e0030d7f>] hub_port_connect_change+0x260/0x302 [usbcore] (20)
 [<e002ed50>] clear_port_feature+0x2b/0x30 [usbcore] (28)
 [<e00310aa>] hub_events+0x289/0x34d [usbcore] (28)
 [<c0272dc9>] schedule+0xd4/0xf5 (24)
 [<e003116e>] hub_thread+0x0/0xcb [usbcore] (16)
 [<e0031177>] hub_thread+0x9/0xcb [usbcore] (4)
 [<c0122a57>] autoremove_wake_function+0x0/0x2d (12)
 [<c01226bf>] kthread+0x63/0x8f (16)
 [<c012265c>] kthread+0x0/0x8f (12)
 [<c0100d39>] kernel_thread_helper+0x5/0xb (16)
 [<c014ae4a>] lookup_bdev+0x1f/0x71 (20)
usb-storage: Unable to allocate the scsi host
usb-storage: probe of 2-1:1.0 failed with error -12
Complete dmesg and .config on attach, as usual.
Cheers.
-- 
rncbc aka Rui Nuno Capela
rncbc@rncbc.org[unhandled content-type:application/x-gzip-compressed][unhandled content-type:application/x-gzip-compressed]