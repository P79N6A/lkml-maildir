Date: Mon, 10 Jan 2005 01:43:13 +0100
From: Adrian Bunk <>
Subject: Re: removing bcopy... because it's half broken
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2005/1/9/126

On Sun, Jan 09, 2005 at 12:19:09PM -0800, Linus Torvalds wrote:
> 
> 
> On Sun, 9 Jan 2005, Arjan van de Ven wrote:
> >
> > Instead of fixing this inconsistency, I decided to remove it entirely,
> > explicit memcpy() and memmove() are prefered anyway (welcome to the 1990's)
> > and nothing in the kernel is using these functions, so this saves code size
> > as well for everyone.
> 
> The problem is that at least some gcc versions would historically generate
> calls to "bcopy" on alpha for structure assignments. Maybe it doesn't any
> more, and no such old gcc versions exist any more, but who knows?
>...
include/asm-alpha/string.h says:
  /*
   * GCC of any recent vintage doesn't do stupid things with bcopy.
   * EGCS 1.1 knows all about expanding memcpy inline, others don't.
   *
   * Similarly for a memset with data = 0.
   */
And Arjan's patch is pretty low-risk:
If it breaks on any architecture with any supported compiler (>= 2.95), 
it will break at compile time and there will pretty fast be reports of 
this breakage in which case it would be easy to revert his patch.
> 		Linus
cu
Adrian
-- 
       "Is there not promise of rain?" Ling Tan asked suddenly out
        of the darkness. There had been need of rain for many days.
       "Only a promise," Lao Er said.
                                       Pearl S. Buck - Dragon Seed
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.kernel.org
More majordomo info at  
http://vger.kernel.org/majordomo-info.html
Please read the FAQ at  
http://www.tux.org/lkml/