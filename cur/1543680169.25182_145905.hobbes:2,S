Date: Mon, 7 Jul 2003 14:00:10 -0700
From: Andrew Morton <>
Subject: Re: [PATCH][2.5.74] devfs lookup deadlock/stack corruption combined patch
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2003/7/7/177

Andrey Borzenkov <arvidjaar@mail.ru> wrote:
>
> I finally hit a painfully trivial way to reproduce another long standing devfs 
> problem - deadlock between devfs_lookup and devfs_d_revalidate_wait.
uh.
> The current fix is to move re-acquire of i_sem after all 
> devfs_d_revalidate_wait waiters have been waked up.
Directory modifications appear to be under write_lock(&dir->u.dir.lock); so
that obvious problem is covered.  Your patch might introduce a race around
_devfs_get_vfs_inode() - two CPUs running that against the same inode at
the same time?
> Andrew, I slightly polished original stack corruption version to look more 
> consistent with the rest of devfs;
I think it's Lindent time.
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.kernel.org
More majordomo info at  
http://vger.kernel.org/majordomo-info.html
Please read the FAQ at  
http://www.tux.org/lkml/