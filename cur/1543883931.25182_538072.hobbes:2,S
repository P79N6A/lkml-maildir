Date: Tue, 1 May 2007 03:52:53 -0400 (EDT)
From: "Robert P. J. Day" <>
Subject: [PATCH][RFC] Allow the i386 install.sh script to try the generic installkernel.
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2007/5/1/92

Allow the install script arch/i386/boot/install.sh to fall back to try
the generic "installkernel" command if a CROSS_COMPILE version isn't
available.
Signed-off-by: Robert P. J. Day <rpjday@mindspring.com>
---
the rationale here:
  after cross-compiling the kernel for x86_64, i (accidentally) left
the CROSS_COMPILE variable on the make line when i tried to install
the kernel:
  # make ARCH=x86_64 CROSS_COMPILE=x86_64- install
as you can see, if you don't have a custom version, the install script
will eventually try to run lilo.  barf.
  is it reasonable, after you check for the custom version, to drop
down and try the generic version (which would have worked just
fine)?
  or is there a cleaner solution?  or is this the correct logic after
all?
diff --git a/arch/i386/boot/install.sh b/arch/i386/boot/install.sh
index 5e44c73..2f7c970 100644
--- a/arch/i386/boot/install.sh
+++ b/arch/i386/boot/install.sh
@@ -38,6 +38,11 @@ verify "$3"
 if [ -x ~/bin/${CROSS_COMPILE}installkernel ]; then exec ~/bin/${CROSS_COMPILE}installkernel "$@"; fi
 if [ -x /sbin/${CROSS_COMPILE}installkernel ]; then exec /sbin/${CROSS_COMPILE}installkernel "$@"; fi
+# OK, then, let's try the generic installkernel scripts.
+
+if [ -x ~/bin/installkernel ]; then exec ~/bin/installkernel "$@"; fi
+if [ -x /sbin/installkernel ]; then exec /sbin/installkernel "$@"; fi
+
 # Default install - same as make zlilo
 if [ -f $4/vmlinuz ]; then
-- 
========================================================================
Robert P. J. Day
Linux Consulting, Training and Annoying Kernel Pedantry
Waterloo, Ontario, CANADA
http://fsdev.net/wiki/index.php?title=Main_Page
========================================================================
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.kernel.org
More majordomo info at  
http://vger.kernel.org/majordomo-info.html
Please read the FAQ at  
http://www.tux.org/lkml/