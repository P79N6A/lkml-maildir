Date: Thu, 6 Mar 2008 16:52:38 +0100
From: Ingo Molnar <>
Subject: Re: [PATCH] x86 - Enhance DEBUG_RODATA support - alternatives
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2008/3/6/237

* pageexec@freemail.hu <pageexec@freemail.hu> wrote:
> > +		vaddr = vmap(pages, nr_pages, VM_MAP, PAGE_KERNEL);
> > +		WARN_ON(!vaddr);
> > +		local_irq_save(flags);
> > +		memcpy(&vaddr[(unsigned long)addr & ~PAGE_MASK], opcode, len);
> > +		local_irq_restore(flags);
> 
> you probably want a BUG_ON instead (or some graceful recovery) else 
> the NULL deref will trigger with IRQs off...
agreed - i changed it to BUG_ON() for the time being.
	Ingo