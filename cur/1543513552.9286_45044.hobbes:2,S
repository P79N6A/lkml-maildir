Date: Thu, 21 Oct 1999 02:53:23 +0200 (MET DST)
From: Florian-Daniel Otel <>
Subject: pppd bugs
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/1999/10/20/145

Hi there,
I'm currently using pppd (2.3.9) on top of ssh to set up a tunnel. The 
problem is that pppd  chokes when pushed at relatively high transfer
rates (200 Kbps) (the tunnel goes through a series of Eth. links)
leading to a grinding halt. Here is some excerpts from the syslog on
the "client" side of the tunnel:
Oct 19 20:11:24 begonia kernel: ppp: frame with bad fcs, length = 55 
Oct 19 20:11:24 begonia kernel: ppp: bad frame, count = 55 
Oct 19 20:11:24 begonia kernel: FF 03 00 21 45 AC 1F 8A ...!E... 
Oct 19 20:11:24 begonia kernel: 8E 26 38 A8 63 A3 BE DF .&8.c... 
Oct 19 20:11:24 begonia kernel: 34 C4 AE D5 B7 99 EC 96 4....... 
Oct 19 20:11:24 begonia kernel: A2 69 C5 01 43 1A 4F 5B .i..C.O[ 
Oct 19 20:11:24 begonia kernel: 71 C8 EF 4F 7D E7 7D 35 q..O}.}5 
Oct 19 20:11:24 begonia kernel: A7 81 04 44 FB 72 A7 52 ...D.r.R 
Oct 19 20:11:24 begonia kernel: 3D 40 59 E8 7F 35 FE    =@Y..5. 
Oct 19 20:11:24 begonia kernel: ppp: frame with bad fcs, length = 975 
Oct 19 20:11:24 begonia kernel: ppp: bad frame, count = 975 
Oct 19 20:11:24 begonia kernel: FF 03 00 95 37 27 3E 4B ....7'>K 
Oct 19 20:11:24 begonia kernel: 74 80 1D A0 2D 0D 03 8A t...-... 
Oct 19 20:11:24 begonia kernel: 07 42 35 3F 11 FD 97 EC .B5?.... 
Oct 19 20:11:24 begonia kernel: EC 75 3F 79 EB 61 E6 F9 .u?y.a.. 
Oct 19 20:11:24 begonia kernel: C8 C7 AA B8 95 CB BC 0C ........ 
Oct 19 20:11:24 begonia kernel: 01 8C 38 3F DF 1D 31 57 ..8?..1W 
Oct 19 20:11:24 begonia kernel: AF D5 AF 78 27 E0 C5 8D ...x'... 
[...]
Oct 19 20:11:24 begonia kernel: 27 E5 59 B7 29 A8 7E E2 '.Y.).~. 
Oct 19 20:11:24 begonia kernel: 1D 2A 2C 55 C7 76 0E 36 .*,U.v.6 
Oct 19 20:11:24 begonia kernel: 6C 74 BA F0 EB FE 69    lt....i 
Oct 19 20:11:24 begonia kernel: ppp: frame with bad fcs, length = 54 
Oct 19 20:11:24 begonia kernel: ppp: bad frame, count = 54 
Oct 19 20:11:24 begonia kernel: FF 03 00 40 A9 E4 50 ED ...@..P. 
Oct 19 20:11:24 begonia kernel: 88 C9 48 56 58 78 42 78 ..HVXxBx 
Oct 19 20:11:24 begonia kernel: 07 DE D9 D8 69 4F C9 29 ....iO.) 
Oct 19 20:11:24 begonia kernel: DF 8A 16 C0 6F E6 9C 3F ....o..? 
Oct 19 20:11:24 begonia kernel: A1 19 95 30 46 52 54 BF ...0FRT. 
Oct 19 20:11:24 begonia kernel: 20 C4 F0 C7 B8 50 46 81  ....PF. 
Oct 19 20:11:24 begonia kernel: 94 84 43 11 DB C1       ..C... 
Oct 19 20:11:24 begonia kernel: ppp: frame with bad fcs, length = 977 
Oct 19 20:11:24 begonia kernel: ppp: bad frame, count = 977 
Oct 19 20:11:24 begonia kernel: FF 03 98 20 FF 5A EC C7 ... .Z.. 
Oct 19 20:11:24 begonia kernel: FF 9D 3F 86 C1 44 C1 D4 ..?..D.. 
Oct 19 20:11:24 begonia kernel: E7 45 BD BC 14 E7 EF 1D .E...... 
Oct 19 20:11:24 begonia kernel: 47 8B 4F 90 A1 45 71 2A G.O..Eq* 
Oct 19 20:11:24 begonia kernel: 9F 91 71 57 81 28 D4 DC ..qW.(.. 
[...]
Oct 19 20:11:24 begonia kernel: 02 55 F4 AC B0 7E E1 98 .U...~.. 
Oct 19 20:11:24 begonia kernel: F2 4C 9A FB 10 AE BE F7 .L...... 
Oct 19 20:11:24 begonia kernel: 8D F1 15 65 D5 C7 3F E5 ...e..?. 
Oct 19 20:11:24 begonia kernel: 6E 9E C0 18 AD 70 FE E9 n....p.. 
Oct 19 20:11:24 begonia kernel: 97 BE DE 99 3C 27 D1 76 ....<'.v 
Oct 19 20:11:24 begonia kernel: 1A                      . 
Oct 19 20:11:25 begonia kernel: ppp: frame with bad fcs, length = 62 
Oct 19 20:11:25 begonia kernel: ppp: bad frame, count = 62 
Oct 19 20:11:25 begonia kernel: FF 03 00 21 45 10 04 00 ...!E... 
Oct 19 20:11:25 begonia kernel: 7C 04 7E 3B D8 F1 07 FD |.~;.... 
Oct 19 20:11:25 begonia kernel: 72 C4 EE CA 43 08 77 CA r...C.w. 
Oct 19 20:11:25 begonia kernel: 0A 79 09 BA C8 1E D3 05 .y...... 
Oct 19 20:11:25 begonia kernel: F2 9C 8D 87 10 CA A8 82 ........ 
Oct 19 20:11:25 begonia kernel: A0 DB E4 CC B8 80 E7 FD ........ 
Oct 19 20:11:25 begonia kernel: 2F DE D4 CE 0E 62 27 DA /....b'. 
Oct 19 20:11:25 begonia kernel: 93 16 42 07 D4 42       ..B..B 
Oct 19 20:11:25 begonia kernel: ppp: frame with bad fcs, length = 968 
Oct 19 20:11:25 begonia kernel: ppp: bad frame, count = 968 
Oct 19 20:15:35 begonia kernel: A4 D2 9C A0 32 DA F6 2C ....2.., 
Oct 19 20:15:35 begonia kernel: 11 84 DF CD DD F3 E8 63 .......c 
Oct 19 20:15:35 begonia kernel: CB 82 EE 07 D7 43 59 B2 .....CY. 
Oct 19 20:15:35 begonia kernel: 7E 67                   ~g 
[..]
Oct 19 23:48:56 begonia kernel: ppp_ioctl: set flags to f010048 
Oct 19 23:48:56 begonia kernel: ppp_ioctl: set flags to f010048 
Oct 19 23:48:56 begonia kernel: ppp0: ccp closed 
Oct 19 23:48:56 begonia kernel: ppp_ioctl: set flags to f010008 
Oct 19 23:48:56 begonia kernel: ppp_ioctl: set flags to f010008 
Oct 19 23:48:56 begonia kernel: ppp_tty_ioctl: set xmit asyncmap ffffffff 
Oct 19 23:48:56 begonia kernel: ppp_tty_ioctl: set xmit asyncmap ffffffff 
Oct 19 23:48:56 begonia kernel: ppp_ioctl: set flags to f010008 
Oct 19 23:48:56 begonia kernel: ppp_ioctl: set flags to f010008 
Oct 19 23:48:56 begonia kernel: ppp_ioctl: set mru to 5dc 
Oct 19 23:48:56 begonia kernel: ppp_ioctl: set mru to 5dc 
Oct 19 23:48:56 begonia kernel: ppp_tty_ioctl: set rcv asyncmap 0 
Oct 19 23:48:56 begonia kernel: ppp_tty_ioctl: set rcv asyncmap 0 
Oct 19 23:48:56 begonia kernel: ppp: channel ppp0 closing. 
Oct 19 23:48:56 begonia kernel: ppp: channel ppp0 closing. 
Oct 19 23:48:56 begonia kernel: ppp0 released 
Oct 19 23:48:56 begonia kernel: ppp0: ccp closed 
Oct 19 23:48:56 begonia pppd[1180]: Hangup (SIGHUP)
Oct 19 23:48:56 begonia pppd[1180]: Modem hangup
Oct 19 23:48:56 begonia pppd[1180]: Connection terminated.
Oct 19 23:48:56 begonia pppd[1180]: Connect time 218.7 minutes.
Oct 19 23:48:56 begonia pppd[1180]: Sent 635533 bytes, received 17607675 bytes.
Oct 19 23:48:56 begonia pppd[1180]: Exit.
..And so on. As i suspected some compression problems at high speeds i
turned off all types of compression in pppd. Still no effect. The only thing
that seems that affects this behaviour is diddling w/ the MTU/MRU
values in pppd, hence the values of MTU/MRU of 1024 used above (1024
is making the least problems). So i guess it is a problem w/ pppd handling
different frame sizes/fragmentation & reassembly.
(Note: Looking for alternatives i just saw other people reporting
similar problems. Please take a look at: 
http://www.ecf.toronto.edu/~stras/pppoe.html
 )
Both client and server are running linux 2.2.12 and pppd 2.3.9.
Please advise on how i can nail this down,
Florian.
P.S: Are there any other flavours of pppd out there ? 
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.rutgers.edu
Please read the FAQ at 
http://www.tux.org/lkml/