Date: Mon, 8 Dec 2008 11:18:01 -0800
From: "Yinghai Lu" <>
Subject: Re: [PATCH 5/5] irq: move irq_desc according to smp_affinity v5
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2008/12/8/271

On Mon, Dec 8, 2008 at 5:42 AM, Ingo Molnar <mingo@elte.hu> wrote:
>
>>                       mask_ack_irq(desc, irq);
>> +#ifdef CONFIG_MOVE_IRQ_DESC
>> +                     /* get new one */
>> +                     desc = irq_to_desc(irq);
>> +#endif
>
> this patch adds a ton of #ifdefs to important .c files, which could all
> have been avoided by introducing a new method:
>
>        desc = irq_remap_to_desc(irq, desc);
>
> which would do something like:
>
>  static struct irq_desc *
>  irq_remap_to_desc(unsigned int irq, struct irq_desc *desc)
>  {
>  #ifdef CONFIG_MOVE_IRQ_DESC
>        return irq_to_desc(irq);
>  #else
>        return desc;
>  #endif
>  }
>
> right?
yes. will work on it.
YH