Date: Sun, 3 Jan 1999 19:57:43 +0100
From: Kurt Garloff <>
Subject: Max memory again
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/1999/1/4/45

Hi Linus,
I sent a mail, telling, that I believe, 2.2.x will remain there for quite
some time and that people will have more than 960MB before 3.0 is out, some
time ago. They will complain about Linux not supporting 1GB or 2 GB of RAM.
Well, I suggested changing the PAGE_OFFSET to 0x70000000h, but I was told,
that there are programs out there needing 2.5GB of virtual memory per
process. OK, we could still switch to 0xB0000000h to catch the case of 1GB.
But probably, this would be rejected ...
I decided to suggest another solution: In 2.1.132-ac3 (and probably in
2.2.preXX, too), there's detection for the situation, when we have more
phys. RAM than the kernel supports. 
I clarified the message and added a line telling the user to have a look at
linux/include/asm-i386/page.h, if he wants more physical RAM to be
supported. And I also added three lines to include/asm-i386/page.h
explaining that the per process virtual mem will shrink, if the PAGE_OFFSET
is decreased.
Maybe this will save some mailings to this list and some people from
believing Linux is not able to support 1GB physical memory ...
Patch appended.
Regards,
-- 
Kurt Garloff <kurt@garloff.de>                           [Dortmund, FRG]  
Plasma physics, high perf. computing              [Linux-ix86,-axp, DUX]
PGP key on 
http://www.garloff.de/kurt/
        [Linux SCSI driver: DC390]
--- linux/arch/i386/kernel/setup.c.orig	Sun Dec 27 18:52:07 1998
+++ linux/arch/i386/kernel/setup.c	Sun Jan  3 19:22:55 1999
@@ -201,9 +201,11 @@
 
 	if (memory_end > MAXMEM)
 	{
+		printk(KERN_WARNING "Warning: Only %ld (of %ld) MB physical "
+			"memory will be used.\n", MAXMEM>>20, memory_end>>20);
 		memory_end = MAXMEM;
-		printk(KERN_WARNING "Warning only %ldMB will be used.\n",
-			MAXMEM>>20);
+		printk(KERN_INFO "Have a look at linux/include/asm-i386/"
+			"page.h, if you want more ...\n");
 	}
 
 	memory_end += PAGE_OFFSET;
--- linux/include/asm-i386/page.h.orig	Sat Dec 26 08:40:32 1998
+++ linux/include/asm-i386/page.h	Sun Jan  3 19:30:42 1999
@@ -74,6 +74,10 @@
  * map all your physical memory + a bit extra for various
  * io-memory mappings)
  *
+ * However, note that the amount of virtual mem per process
+ * is at most __PAGE_OFFSET, which means that processes
+ * needing 2GB virtual memory won't be happy with 0x70000000.
+ *
  * IF YOU CHANGE THIS, PLEASE ALSO CHANGE
  *
  *	arch/i386/vmlinux.lds