Date: Fri, 13 Feb 2004 18:44:49 +0000 (GMT)
From: James Simmons <>
Subject: Re: fbdev driver and sysfs question.
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2004/2/13/158

> > +	if (!info->screen_base) {
> >  		release_mem_region(vesafb_fix.smem_start, vesafb_fix.smem_len);
> >  		printk(KERN_ERR
> >  		       "vesafb: abort, cannot ioremap video memory 0x%x @ 0x%lx\n",
> 
> 	Who will free info?
...
> 	Who will undo allocations?  BTW, that applies to the old code too -
> even if fb_alloc_cmap() doesn't require any actions on cleanup, ioremap()
> definitely does.
release_fb_info in fbsysfs.c. That happens in the struct class release 
function. Also the fb_dealloc_cmap is called. No ioremap is called tho 
since this is driver specific. So I have the ioremap and cleanup of it 
done in the dev.remove function. 
This makes sense since we could have one driver for the hardware with 
multiple framebuffers on board. One driver and two devices. 
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.kernel.org
More majordomo info at  
http://vger.kernel.org/majordomo-info.html
Please read the FAQ at  
http://www.tux.org/lkml/