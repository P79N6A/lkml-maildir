Date: Wed, 9 Feb 2000 01:09:11 +0100 (CET)
From: Andrea Arcangeli <>
Subject: Re: [RFC] 2.3.39 zone balancing
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2000/2/8/190

On Tue, 8 Feb 2000, Kanoj Sarcar wrote:
>How does the min/max help you in this? 
It takes free less memory because I now enforce a limit (the max limit).
>Okay, you are changing the formula for the optimal number of free 
>pages in a zone. Ideally, this should depend just on the zone size, 
>but really, it also needs to consider the rate of intr-context 
>non-waitable allocation requests that may be generated (this is
>probably where the "min" value comes in?)  And maybe 
>some performance considerations (is that the logic for a "max" 
>value?)
The watermarks are not infunction of the amount of memory but it's in
function of the load of the machine. The more free the better since you'll
run oom with atomic allocations less probably. Thus with plenty of memory
we can reserve more ram and we'll hardly notice that since the percentage
is the same. That's the why the limits make sense.
>In 2.3.42, freepages.* is still used in kswapd, right? I believe we 
>should try to kill that usage, and make kswapd zone aware ... I sent
>a patch to Linus about this.
Maybe I just have it somewhere but please resend also in my mailbox so
I'll be sure ;).
>Only when ZONE_BALANCED returns "zone-not-balanced", do you need to do
>classfree(). classfree() might return "zone-is-balanced" though. If 
>ZONE_BALANCED says "zone-is-balanced", classfree() will never say 
>"zone-not-balanced". That's the optimization ...
Having the zone not balanced but the classzone balanced is the fast path
too. Putting such case in the slow path and spending CPU in making the
other case faster is not correct IMHO.
Andrea
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.rutgers.edu
Please read the FAQ at 
http://www.tux.org/lkml/