Date: Mon, 26 Nov 2007 03:33:13 +0100
From: cecco <>
Subject: irq on nforce4 and realtek RTL8168B
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2007/11/25/149

Hello,
I have a ASUS A6T with nforce4 and realtek RTL8111/8168B
ethernet. I am testing kernel 2.6.24-rc3-git1 on this
notebook and I have noticed strange behaviour with irq.
I pass hpet=force and acpi_use_timer_override to enable
apic, otherwise timer cpu interrupt is in old XT-PIC mode.
Unfortunately, irq balancing on turion X2 doesn't work
very well and there are extra timers interrupt. Realtek
RTL8168B shares irq 17 with nvidia 7600 go card and it is
not very good, infact if I don't use pci=nomsi option,
Realtek RTL8168B is up but doesn't transmit any packet. I
have following situation interrupt without pci=nomsi:
             CPU0       CPU1       
  0:         57      29452   IO-APIC-edge      timer
  1:          0        331   IO-APIC-edge      i8042
  7:          1          0   IO-APIC-edge    
  8:          0          2   IO-APIC-edge      rtc
  9:        180        193   IO-APIC-fasteoi   acpi
 12:       8291        133   IO-APIC-edge      i8042
 14:          2       2810   IO-APIC-edge      libata
 15:       5186       2646   IO-APIC-edge      libata
 17:          0        683   IO-APIC-fasteoi   nvidia
 18:          0          2   IO-APIC-fasteoi   ohci1394
 19:          1         45   IO-APIC-fasteoi   ohci_hcd:usb1
 20:          0          0   IO-APIC-fasteoi   sdhci:slot0
 21:          0        292   IO-APIC-fasteoi   HDA Intel
221:          0          0   PCI-MSI-edge      eth1
NMI:          0          0   Non-maskable interrupts
LOC:      29452          8   Local timer interrupts
RES:       2799       4491   Rescheduling interrupts
CAL:        128        102   function call interrupts
TLB:        354        247   TLB shootdowns
TRM:          0          0   Thermal event interrupts
SPU:          0          0   Spurious interrupts
ERR:          1
MIS:          0
Besides, these problems on irq seem to break lapic with
no_hz. I don't get a working suspend memory for irq fault, 
the notebook doesn't reboot after the suspend memory.
Unfortunately, the  bios is very buggy and I believe ASUS
has to behave better with linux users. 
I invite ASUS,AMD,NVIDIA and  REALTEK manifacturers to 
offer a better support for linux, and to not violate
standard ACPI specifics.  I wish to be personally CC'ed the
answers/comments posted to the list in response to my
posting.
Thanks
Best Regards
Francesco
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.kernel.org
More majordomo info at  
http://vger.kernel.org/majordomo-info.html
Please read the FAQ at  
http://www.tux.org/lkml/