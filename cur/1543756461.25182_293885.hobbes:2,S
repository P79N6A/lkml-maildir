Date: Wed, 09 Feb 2005 01:45:13 +0100
From: matthieu castet <>
Subject: bttv : overlay mode and big disk io hang and could corrupt the fs
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2005/2/8/219

Hi,
if I run "xawtv" [1] and then do a "grep -r toto /usr", my system 
quickly freeze. If there isn't any xawv running nothing happen. I don't 
try to use xawtv with grab mode (port 54) because I don't want to loose 
data by crashing again my / fs.
I retry it and I arrived to get some log (see the attach file).
But after rebooting, I had a big surprise, the / ext3 fs was corrupted 
and I need to run fsck by hand ....
Matthieu
[1]
$xawtv -hwscan
This is xawtv-3.94, running on Linux/i686 (2.6.10)
looking for available devices
port 53-53                              [ -xvport 53 ]
     type : Xvideo, video overlay
     name : video4linux
port 54-54
     type : Xvideo, image scaler
     name : NV Video Overlay
port 55-86
     type : Xvideo, image scaler
     name : NV Video Blitter
/dev/video0: OK                         [ -device /dev/video0 ]
     type : v4l2
     name : BT878 video (Pinnacle PCTV Stud
     flags: overlay capture tuner
$cat /proc/interrupts
            CPU0
   0:     654027    IO-APIC-edge  timer
   1:       2679    IO-APIC-edge  i8042
   7:          0    IO-APIC-edge  parport0
   9:          0   IO-APIC-level  acpi
  12:      23644    IO-APIC-edge  i8042
  14:      88469    IO-APIC-edge  ide0
  15:          2    IO-APIC-edge  ide1
  17:          5   IO-APIC-level  eth0, bttv0, Bt87x audio
  18:         48   IO-APIC-level  ide2, ide3
  19:          0   IO-APIC-level  EMU10K1
  21:      97526   IO-APIC-level  ehci_hcd, uhci_hcd, uhci_hcd, uhci_hcd
  22:          0   IO-APIC-level  VIA8233
NMI:          0
LOC:     661965
ERR:          0
MIS:          0
Feb  9 01:20:32 localhost kernel: ehci_hcd 0000:00:10.3: fatal error
Feb  9 01:20:32 localhost kernel: ehci_hcd 0000:00:10.3: HC died; cleaning up
Feb  9 01:20:32 localhost kernel: bttv0: OCERR @ 3635001c,bits: HSYNC OFLOW RISCI* OCERR*
Feb  9 01:20:32 localhost kernel: [EAGLE-USB] eu_uni_process_in_data: non-integral number of cells in incoming data.
Feb  9 01:20:32 localhost kernel: [EAGLE-USB] eu_uni_process_in_data: incoming data length = 1.
Feb  9 01:20:32 localhost kernel: [EAGLE-USB] eu_uni_process_in_data: ATM_CELL_SIZE = 35.
Feb  9 01:20:32 localhost kernel: [EAGLE-USB] eu_uni_process_in_data: non-integral number of cells in incoming data.
Feb  9 01:20:32 localhost kernel: [EAGLE-USB] eu_uni_process_in_data: incoming data length = 1.
Feb  9 01:20:32 localhost kernel: [EAGLE-USB] eu_uni_process_in_data: ATM_CELL_SIZE = 35.
Feb  9 01:20:32 localhost kernel: [EAGLE-USB] eu_uni_process_in_data: non-integral number of cells in incoming data.
Feb  9 01:20:32 localhost kernel: [EAGLE-USB] eu_uni_process_in_data: incoming data length = 1.
Feb  9 01:20:32 localhost kernel: [EAGLE-USB] eu_uni_process_in_data: ATM_CELL_SIZE = 35.
Feb  9 01:20:32 localhost kernel: init_special_inode: bogus i_mode (0)
Feb  9 01:20:32 localhost last message repeated 11 times
Feb  9 01:20:32 localhost kernel: init_special_inode: bogus i_mode (63)
Feb  9 01:20:32 localhost kernel: init_special_inode: bogus i_mode (0)
Feb  9 01:20:32 localhost kernel: bttv0: OCERR @ 3635001c,bits: HSYNC OFLOW RISCI* OCERR*
Feb  9 01:20:32 localhost kernel: [EAGLE-USB] eu_uni_process_in_data: non-integral number of cells in incoming data.
Feb  9 01:20:32 localhost kernel: [EAGLE-USB] eu_uni_process_in_data: incoming data length = 1.
Feb  9 01:20:32 localhost kernel: [EAGLE-USB] eu_uni_process_in_data: ATM_CELL_SIZE = 35.
Feb  9 01:20:32 localhost kernel: [EAGLE-USB] eu_uni_process_in_data: non-integral number of cells in incoming data.
Feb  9 01:20:32 localhost kernel: [EAGLE-USB] eu_uni_process_in_data: incoming data length = 1.
Feb  9 01:20:32 localhost kernel: [EAGLE-USB] eu_uni_process_in_data: ATM_CELL_SIZE = 35.
Feb  9 01:20:32 localhost kernel: [EAGLE-USB] eu_uni_process_in_data: non-integral number of cells in incoming data.
Feb  9 01:20:32 localhost kernel: [EAGLE-USB] eu_uni_process_in_data: incoming data length = 1.
Feb  9 01:20:32 localhost kernel: [EAGLE-USB] eu_uni_process_in_data: ATM_CELL_SIZE = 35.
Feb  9 01:20:32 localhost kernel: [EAGLE-USB] eu_uni_process_in_data: non-integral number of cells in incoming data.
Feb  9 01:20:32 localhost kernel: [EAGLE-USB] eu_uni_process_in_data: incoming data length = 1.
Feb  9 01:20:32 localhost kernel: [EAGLE-USB] eu_uni_process_in_data: ATM_CELL_SIZE = 35.
Feb  9 01:20:32 localhost kernel: [EAGLE-USB] eu_uni_process_in_data: non-integral number of cells in incoming data.
Feb  9 01:20:32 localhost kernel: [EAGLE-USB] eu_uni_process_in_data: incoming data length = 1.
Feb  9 01:20:32 localhost kernel: [EAGLE-USB] eu_uni_process_in_data: ATM_CELL_SIZE = 35.
Feb  9 01:20:32 localhost kernel: [EAGLE-USB] eu_uni_process_in_data: non-integral number of cells in incoming data.
Feb  9 01:20:32 localhost kernel: [EAGLE-USB] eu_uni_process_in_data: incoming data length = 1.
Feb  9 01:20:32 localhost kernel: [EAGLE-USB] eu_uni_process_in_data: ATM_CELL_SIZE = 35.
Feb  9 01:20:32 localhost kernel: [EAGLE-USB] eu_uni_process_in_data: non-integral number of cells in incoming data.
Feb  9 01:20:32 localhost kernel: [EAGLE-USB] eu_uni_process_in_data: incoming data length = 1.
Feb  9 01:20:32 localhost kernel: [EAGLE-USB] eu_uni_process_in_data: ATM_CELL_SIZE = 35.
Feb  9 01:20:32 localhost kernel: [EAGLE-USB] eu_uni_process_in_data: non-integral number of cells in incoming data.
Feb  9 01:20:32 localhost kernel: [EAGLE-USB] eu_uni_process_in_data: incoming data length = 1.
Feb  9 01:20:32 localhost kernel: [EAGLE-USB] eu_uni_process_in_data: ATM_CELL_SIZE = 35.
Feb  9 01:20:32 localhost kernel: [EAGLE-USB] eu_uni_process_in_data: non-integral number of cells in incoming data.
Feb  9 01:20:32 localhost kernel: [EAGLE-USB] eu_uni_process_in_data: incoming data length = 1.
Feb  9 01:20:32 localhost kernel: [EAGLE-USB] eu_uni_process_in_data: ATM_CELL_SIZE = 35.
Feb  9 01:20:32 localhost kernel: [EAGLE-USB] eu_uni_process_in_data: non-integral number of cells in incoming data.
Feb  9 01:20:32 localhost kernel: [EAGLE-USB] eu_uni_process_in_data: incoming data length = 1.
Feb  9 01:20:32 localhost kernel: [EAGLE-USB] eu_uni_process_in_data: ATM_CELL_SIZE = 35.
Feb  9 01:20:32 localhost kernel: [EAGLE-USB] eu_uni_process_in_data: non-integral number of cells in incoming data.
Feb  9 01:20:32 localhost kernel: [EAGLE-USB] eu_uni_process_in_data: incoming data length = 1.
Feb  9 01:20:32 localhost kernel: [EAGLE-USB] eu_uni_process_in_data: ATM_CELL_SIZE = 35.
Feb  9 01:20:32 localhost kernel: [EAGLE-USB] eu_uni_process_in_data: non-integral number of cells in incoming data.
Feb  9 01:20:32 localhost kernel: [EAGLE-USB] eu_uni_process_in_data: incoming data length = 1.
Feb  9 01:20:32 localhost kernel: [EAGLE-USB] eu_uni_process_in_data: ATM_CELL_SIZE = 35.
Feb  9 01:20:32 localhost kernel: [EAGLE-USB] eu_uni_process_in_data: non-integral number of cells in incoming data.
Feb  9 01:20:32 localhost kernel: [EAGLE-USB] eu_uni_process_in_data: incoming data length = 1.
Feb  9 01:20:32 localhost kernel: [EAGLE-USB] eu_uni_process_in_data: ATM_CELL_SIZE = 35.
Feb  9 01:20:32 localhost kernel: [EAGLE-USB] eu_uni_process_in_data: non-integral number of cells in incoming data.
Feb  9 01:20:32 localhost kernel: [EAGLE-USB] eu_uni_process_in_data: incoming data length = 1.
Feb  9 01:20:32 localhost kernel: [EAGLE-USB] eu_uni_process_in_data: ATM_CELL_SIZE = 35.
Feb  9 01:20:32 localhost kernel: [EAGLE-USB] eu_uni_process_in_data: non-integral number of cells in incoming data.
Feb  9 01:20:32 localhost kernel: [EAGLE-USB] eu_uni_process_in_data: incoming data length = 1.
Feb  9 01:20:32 localhost kernel: [EAGLE-USB] eu_uni_process_in_data: ATM_CELL_SIZE = 35.
Feb  9 01:20:32 localhost kernel: [EAGLE-USB] eu_uni_process_in_data: non-integral number of cells in incoming data.
Feb  9 01:20:32 localhost kernel: [EAGLE-USB] eu_uni_process_in_data: incoming data length = 1.
Feb  9 01:20:32 localhost kernel: [EAGLE-USB] eu_uni_process_in_data: ATM_CELL_SIZE = 35.
Feb  9 01:20:32 localhost kernel: bttv0: OCERR @ 3635001c,bits: HSYNC OFLOW RISCI* OCERR*
Feb  9 01:20:32 localhost kernel: uhci_hcd 0000:00:10.0: host system error, PCI problems?
Feb  9 01:20:32 localhost kernel: uhci_hcd 0000:00:10.0: host controller halted, very bad!
Feb  9 01:20:32 localhost kernel: bttv0: OCERR @ 3635001c,bits: HSYNC OFLOW RISCI* OCERR*
Feb  9 01:20:32 localhost kernel: init_special_inode: bogus i_mode (0)
Feb  9 01:20:32 localhost last message repeated 4 times
Feb  9 01:20:32 localhost kernel: bttv0: OCERR @ 3635001c,bits: HSYNC OFLOW RISCI* OCERR*
Feb  9 01:20:32 localhost last message repeated 3 times
Feb  9 01:20:32 localhost kernel: usb 2-2: new full speed USB device using uhci_hcd and address 3
Feb  9 01:20:32 localhost kernel: bttv0: OCERR @ 3635001c,bits: HSYNC OFLOW RISCI* OCERR*
Feb  9 01:20:34 localhost last message repeated 42 times
Feb  9 01:20:34 localhost kernel: [EAGLE-USB] Ctrl Urb Watcher expired. About to remove URB f5e1bd60
Feb  9 01:20:34 localhost kernel: bttv0: OCERR @ 3635001c,bits: HSYNC OFLOW RISCI* OCERR*
Feb  9 01:20:36 localhost last message repeated 49 times
Feb  9 01:20:36 localhost kernel: [EAGLE-USB] Ctrl Urb Watcher expired. About to remove URB f5e1bae0
Feb  9 01:20:36 localhost kernel: bttv0: OCERR @ 3635001c,bits: HSYNC OFLOW RISCI* OCERR*