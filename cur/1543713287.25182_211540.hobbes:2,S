Date: Fri, 2 Apr 2004 22:27:09 -0600
From: Matt Mackall <>
Subject: [PATCH] enable suspend-on-halt for NS Geode
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2004/4/2/228

This enables deep powersaving mode on Geode boxes
From: Zwane Mwaikambo <zwane@arm.linux.org.uk>
Subject: NS Geode, enable Suspend-on-Halt
Index: linux-2.6.0-test11/arch/i386/kernel/cpu/cyrix.c
===================================================================
RCS file: /build/cvsroot/linux-2.6.0-test11/arch/i386/kernel/cpu/cyrix.c,v
retrieving revision 1.1.1.1
diff -u -p -B -r1.1.1.1 cyrix.c
 tiny-mpm/arch/i386/kernel/cpu/cyrix.c |    5 ++++-
 1 files changed, 4 insertions(+), 1 deletion(-)
diff -puN arch/i386/kernel/cpu/cyrix.c~geode arch/i386/kernel/cpu/cyrix.c
--- tiny/arch/i386/kernel/cpu/cyrix.c~geode	2004-03-20 12:14:39.000000000 -0600
+++ tiny-mpm/arch/i386/kernel/cpu/cyrix.c	2004-03-20 12:14:39.000000000 -0600
@@ -167,7 +167,10 @@ static void __init geode_configure(void)
 	unsigned long flags;
 	u8 ccr3, ccr4;
 	local_irq_save(flags);
-	
+
+	/* Suspend on halt power saving and enable #SUSP pin */
+	setCx86(CX86_CCR2, getCx86(CX86_CCR2) | 0x88);
+
 	ccr3 = getCx86(CX86_CCR3);
 	setCx86(CX86_CCR3, (ccr3 & 0x0f) | 0x10);	/* Enable */
 	
_
-- 
Matt Mackall : 
http://www.selenic.com
 : Linux development and consulting
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.kernel.org
More majordomo info at  
http://vger.kernel.org/majordomo-info.html
Please read the FAQ at  
http://www.tux.org/lkml/