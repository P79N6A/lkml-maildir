Date: Wed, 22 Mar 2000 11:42:19 -0800 (PST)
From: Andre Hedrick <>
Subject: Re: [2.3.99pre2] [CORRUPTION] Doh!  Corruption problems again...
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2000/3/22/202

On Wed, 22 Mar 2000, Mike Porter wrote:
> I missed the beginning of this thread.  I have the same board you
> have.  I upgraded the BIOS to 1012 (maybe 1011 - I forget
> exactly).  Any time I enable the full set  of options (AUTODMA,
> PIIX tuning, etc, ie: what Andre says should be used), I eventually
> get DMA timeouts.  If I'm careful, ie: booted into single user
> mode, root mounted r/o, DMA is turned off automatically when the
> failure occurs and the system recovers.  If I'm running say, X,
> when the DMA failure occurs, sometimes the system can hang.  I
> don't know exactly the result since I don't try testing DMA on a
> r/w drive any more.  If I use something like dd if=/dev/hda
> of=/dev/null, I'll get DMA timeouts within a couple of seconds.
I do not see the error :-(.........
I am using an engineering Shiner II AMD K7-2 system with 192M.
I have TWO drives burning, X windows, and SSHed in to the system..........
I need to test my i810, SiS620, 15 PCI-IDE cards under SMP, but if it was
going to crash, I would have expected........
I do not see the issue......
i810 DDing both drive and CD and the WHIRL of the CD is KILLING me...
UPDATED
 2788 tty2     R      5:33 dd if /dev/hdc of /dev/null
 2790 tty3     S      0:00 /bin/sh /usr/X11R6/bin/startx
 2791 tty3     S      0:00 tee /root/.X.err
 2800 tty3     S      0:00 xinit /root/.xinitrc --
dd if=/dev/hda of=/dev/null
25429824+0 records in
25429824+0 records out
 2788 tty2     R      9:02 dd if /dev/hdc of /dev/null
 2790 tty3     S      0:00 /bin/sh /usr/X11R6/bin/startx
 2791 tty3     S      0:00 tee /root/.X.err
 2800 tty3     S      0:00 xinit /root/.xinitrc --
 2780 tty3     S      0:00 -bash
 2788 tty2     R     11:38 dd if /dev/hdc of /dev/null
 2790 tty3     S      0:00 /bin/sh /usr/X11R6/bin/startx
 2791 tty3     S      0:00 tee /root/.X.err
 2800 tty3     S      0:00 xinit /root/.xinitrc --
Will report the final out........but I can not repeat with "Quality Drives".
ORGINAL
 2775 tty1     R      3:40 dd if /dev/hda of /dev/null
 2780 tty3     S      0:00 -bash
 2788 tty2     R      2:50 dd if /dev/hdc of /dev/null
 2790 tty3     S      0:00 /bin/sh /usr/X11R6/bin/startx
 2791 tty3     S      0:00 tee /root/.X.err
 2800 tty3     S      0:00 xinit /root/.xinitrc --
 2801 ?        S      0:03 /usr/X11R6/bin/X :0
 2803 tty3     S      0:00 fvwm
............
 2827 pts/1    S      0:00 tail -f /root/.X.err
 2846 tty3     S      0:01 /opt/netscape/netscape
 2855 tty3     S      0:00 (dns helper)
 2858 ?        S      0:00 /usr/sbin/sshd
hdparm -i /dev/hda
/dev/hda:
 Model=QUANTUM FIREBALL CX13.0A, FwRev=A3F.0F00, SerialNo=134911811509
 Config={ HardSect NotMFM HdSw>15uSec Fixed DTR>10Mbs }
 RawCHS=16383/16/63, TrkSize=32256, SectSize=21298, ECCbytes=4
 BuffType=DualPortCache, BuffSize=418kB, MaxMultSect=16, MultSect=16
 CurCHS=16383/16/63, CurSects=16514064, LBA=yes, LBAsects=25429824
 IORDY=on/off, tPIO={min:120,w/IORDY:120}, tDMA={min:120,rec:120}
 PIO modes: pio0 pio1 pio2 pio3 pio4
 DMA modes: mdma0 mdma1 mdma2 udma0 udma1 udma2 udma3 *udma4
 Drive Supports : ATA/ATAPI-4 T13 1153D revision 15 : ATA-1 ATA-2 ATA-3 ATA-4
 Kernel Drive Geometry LogicalCHS=25228/16/63
hdparm -i /dev/hdc
/dev/hdc:
 Model=IBM-DPTA-373420, FwRev=P71OA30A, SerialNo=JXYJXA05393
 Config={ HardSect NotMFM HdSw>15uSec Fixed DTR>10Mbs }
 RawCHS=16383/16/63, TrkSize=0, SectSize=0, ECCbytes=34
 BuffType=DualPortCache, BuffSize=1961kB, MaxMultSect=16, MultSect=16
 CurCHS=16383/16/63, CurSects=16514064, LBA=yes, LBAsects=66835440
 IORDY=on/off, tPIO={min:240,w/IORDY:120}, tDMA={min:120,rec:120}
 PIO modes: pio0 pio1 pio2 pio3 pio4
 DMA modes: mdma0 mdma1 mdma2 udma0 udma1 udma2 udma3 *udma4
 Drive Supports : ATA/ATAPI-4 T13 1153D revision 17 : ATA-1 ATA-2 ATA-3 ATA-4
 Kernel Drive Geometry LogicalCHS=66305/16/63
uname -a
Linux 3ware 2.3.99-pre3 #1 Tue Mar 21 14:06:26 PST 2000 i686 unknown
cat /proc/cpuinfo
processor       : 0
vendor_id       : AuthenticAMD
cpu family      : 6
model           : 1
model name      : AMD-K7(tm) Processor
stepping        : 2
cpu MHz         : 698.666763
cache size      : 512 KB
fdiv_bug        : no
hlt_bug         : no
sep_bug         : no
f00f_bug        : no
coma_bug        : no
fpu             : yes
fpu_exception   : yes
cpuid level     : 1
wp              : yes
flags           : fpu vme de pse tsc msr pae mce cx8 sep mtrr pge mca cmov 16 mmxext mmx 3dnowext 3dnow
bogomips        : 1392.64
i810
/dev/hda:
 Model=Maxtor 91366U4, FwRev=RA530JN0, SerialNo=H40MEC8C
 Config={ Fixed }
 RawCHS=16383/16/63, TrkSize=0, SectSize=0, ECCbytes=57
 BuffType=DualPortCache, BuffSize=2048kB, MaxMultSect=16, MultSect=16
 CurCHS=16383/16/63, CurSects=16514064, LBA=yes, LBAsects=26588016
 IORDY=on/off, tPIO={min:120,w/IORDY:120}, tDMA={min:120,rec:120}
 PIO modes: pio0 pio1 pio2 pio3 pio4
 DMA modes: mdma0 mdma1 mdma2 udma0 udma1 udma2 udma3 *udma4
 Drive Supports : ATA/ATAPI-4 T13 1153D revision 17 : ATA-1 ATA-2 ATA-3 ATA-4 ATA-5
 Kernel Drive Geometry LogicalCHS=26377/16/63
hdparm -i /dev/hdc
/dev/hdc:
 Model=LTN483, FwRev=BL1A, SerialNo=
 Config={ SpinMotCtl Removeable DTR<=5Mbs DTR>10Mbs nonMagnetic }
 RawCHS=0/0/0, TrkSize=0, SectSize=0, ECCbytes=0
 BuffType=unknown, BuffSize=0kB, MaxMultSect=0
 (maybe): CurCHS=0/0/0, CurSects=0, LBA=yes, LBAsects=0
 IORDY=on/off, tPIO={min:120,w/IORDY:120}, tDMA={min:120,rec:120}
 PIO modes: pio0 pio1 pio2 pio3 pio4
 DMA modes: sdma0 sdma1 sdma2 mdma0 mdma1 mdma2 udma0 udma1 *udma2
  227 tty2     S      0:00 -bash
  234 tty1     R      2:09 dd if /dev/hda of /dev/null
  262 tty3     S      0:00 login -- root
  263 tty3     S      0:00 -bash
  270 tty2     D      0:17 dd if /dev/hdc of /dev/null
  272 ?        S      0:00 /usr/sbin/sshd
  273 ttyp0    S      0:00 -bash
  282 ttyp0    R      0:00 ps ax
Linux i810 2.3.99-pre3 #1 Tue Mar 21 22:12:02 PST 2000 i686 unknown
**************
Andre Hedrick
The Linux ATA/IDE guy
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.rutgers.edu
Please read the FAQ at 
http://www.tux.org/lkml/