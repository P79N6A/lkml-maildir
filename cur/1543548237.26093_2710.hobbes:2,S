Date: Sat, 9 Sep 2000 16:49:44 -0400 (EDT)
From: Ricky Beam <>
Subject: Re: [patch-required!] Recent kernels show problems in handling VERY large HDs
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2000/9/9/29

On Fri, 8 Sep 2000, Andreas Eibach wrote:
...
>    ide0: BM-DMA at 0x4000-0x4007, BIOS settings: hda:pio, hdb:pio
>    ide1: BM-DMA at 0x4008-0x400f, BIOS settings: hdc:pio, hdd:pio
...
>hda: 120060864 sectors (61471 MB) w/2048KiB Cache, CHS=7473/255/63, UDMA(33)
> hda:hda: timeout waiting for DMA
>ide_dmaproc: chipset supported ide_dma_timeout func only: 14
>hda: irq timeout: status=0x58 { DriveReady SeekComplete DataRequest }
>hda: status timeout: status=0xd8 { Busy }
...
It would appear the system does know how big the drive is.  The big problem
is the DMA failure.  The system attempted to use DMA mode when the chipset
wasn't set for DMA mode.  Note the "hda:pio" part.  Either rebuild the kernel
to disable DMA mode, turn it off by default, or force the BIOS to enable DMA
for that drive.  Unfortunately, there's no kernel commandline for turning
DMA off -- you can turn it on, but not off.
Once you fix that, I'm betting everything will work just fine.
--Ricky
PS: I've "hot plugged" this type of drive into running systems.  It wasn't
    there during POST.  DMA has to be disabled as the kernel doesn't appear
    to know how or isn't willing to enable DMA mode for the drive.  It will,
    however, gladly turn it off. (My TiVo hackbed disables DMA to handle
    byteswaping.)
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.kernel.org
Please read the FAQ at 
http://www.tux.org/lkml/