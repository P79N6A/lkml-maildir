Date: Thu, 11 Mar 1999 15:01:33 +0200 (EET DST)
From: Sami Farin <>
Subject: odd linux 2.2.1 & 2.2.3 freezes + scsi emul. bug in 2.2.1
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/1999/3/11/56

Part I, here you are.
Linux 2.2.1 has hanged in the same way five times in
three weeks.
2.2.2 didn't compile.
2.2.3 stayed up four hours, then hanged. And hanged
again after six hours.
(I got one month uptime with 2.2.0-pre6...)
When I was in console mode (linux 2.2.1), I got this:
<screen full of some hex values, like [<c01dc96e>]>
code: 8b 4a 04 85 c9 74 22 8b 02 8b
which is ...:
c0138a4c <sem_exit>:
c0138a4c:       83 ec 0c        subl   $0xc,%esp
c0138a4f:       55              pushl  %ebp
c0138a50:       57              pushl  %edi
c0138a51:       56              pushl  %esi
c0138a52:       53              pushl  %ebx
c0138a53:       bf 00 e0 ff ff  movl   $0xffffe000,%edi
c0138a58:       21 e7           andl   %esp,%edi
c0138a5a:       89 7c 24 14     movl   %edi,0x14(%esp,1)
c0138a5e:       8b 97 e0 01 00  movl   0x1e0(%edi),%edx
c0138a63:       00
c0138a64:       85 d2           testl  %edx,%edx
c0138a66:       74 37           je     c0138a9f <sem_exit+0x53>
===>
c0138a68:       8b 4a 04        movl   0x4(%edx),%ecx
c0138a6b:       85 c9           testl  %ecx,%ecx
c0138a6d:       74 22           je     c0138a91 <sem_exit+0x45>
c0138a6f:       8b 02           movl   (%edx),%eax
c0138a71:       8b 5a 18        movl   0x18(%edx),%ebx
c0138a74:       89 01           movl   %eax,(%ecx)
c0138a76:       8b 0a           movl   (%edx),%ecx
c0138a78:       85 c9           testl  %ecx,%ecx
c0138a7a:       74 08           je     c0138a84 <sem_exit+0x38>
...
[<c01dc96e>] error_table
[<c01096ad>] error_code
[<c01109e6>] schedule
[<c01dca96>] tvecs
my screen was full of EIP(?)-values, like the four above (they are
the last four values before 'code: 8b 4a ...').
Then... I pressed sysrq+T and got this:
code: 89 02 85 c0 74 03 89
c0110728 <del_timer>:
c0110728:       55              pushl  %ebp
c0110729:       89 e5           movl   %esp,%ebp
c011072b:       53              pushl  %ebx
c011072c:       8b 4d 08        movl   0x8(%ebp),%ecx
c011072f:       9c              pushf
c0110730:       5b              popl   %ebx
c0110731:       fa              cli
c0110732:       8b 51 04        movl   0x4(%ecx),%edx
c0110735:       85 d2           testl  %edx,%edx
c0110737:       74 13           je     c011074c <del_timer+0x24>
c0110739:       8b 01           movl   (%ecx),%eax
===>
c011073b:       89 02           movl   %eax,(%edx)
c011073d:       85 c0           testl  %eax,%eax
c011073f:       74 03           je     c0110744 <del_timer+0x1c>
c0110741:       89 50 04        movl   %edx,0x4(%eax)
c0110744:       b8 01 00 00 00  movl   $0x1,%eax
c0110749:       eb 03           jmp    c011074e <del_timer+0x26>
c011074b:       90              nop
c011074c:       31 c0           xorl   %eax,%eax
c011074e:       c7 41 04 00 00  movl   $0x0,0x4(%ecx)
c0110753:       00 00
c0110755:       c7 01 00 00 00  movl   $0x0,(%ecx)
c011075a:       00
c011075b:       53              pushl  %ebx
c011075c:       9d              popf
c011075d:       8b 5d fc        movl   0xfffffffc(%ebp),%ebx
c0110760:       89 ec           movl   %ebp,%esp
c0110762:       5d              popl   %ebp
c0110763:       c3              ret
after this magic sysrq didn't work at all.
not a big deal, the system was hosed anyway :)
The hangs have happened two times in console mode and the other
times in X. All I was doing when these hangs happened was using
bladeenc. Oh, and once linux hanged three mins before CDR-burning
was due to complete :)
BTW, hang = all freezed, nothing works.
....................
Part II, here you are.
I was playing audio CD with xmcd and then it said
"Recovering from audio playback error"
21:13:55 safari kernel: sr0: CDROM (ioctl) reports ILLEGAL REQUEST. 
21:20:00 scsi0 channel 0 : resetting for second half of retries. 
21:20:00 SCSI bus is being reset for host 0 channel 0. 
21:20:00 kmem_free: Either bad obj addr or double free (objp=c03346c4,
  name=size-512) 
21:20:05 scsi0 channel 0 : resetting for second half of retries. 
21:20:05 SCSI bus is being reset for host 0 channel 0.
21:20:05 kmem_free: Either bad obj addr or double free (objp=c03346c4,
  name=size-512) 
21:20:05 kmem_free: Either bad obj addr or double free (objp=c03346c4,
  name=size-512) 
after this I could not access my HP 8100i (all the progs were hanging in
scsi_do_cmd). As you can see, I'm using SCSI emulation. If this is fixed
in 2.2.3, I'd like to know it (I was using 2.2.1).
Linux safari.ddns.org 2.2.1 #25 Sun Feb 7 01:41:41 EET 1999 i586 unknown
Kernel modules         2.1.121
Gnu C                  egcs-2.91.60
Binutils               2.9.1.0.19
Linux C Library        2.0.7
Dynamic linker         ldd (GNU libc) 2.0.7
Linux C++ Library      2.8.1
Procps                 1.2.9
Mount                  2.9i
Net-tools              (1999-01-01)
Kbd                    0.96
Sh-utils               1.16
RH5.0+loads of updates, Cyrix 6x86-P150+, Asus VX97 mobo,... 
This is not a hw problem, since gcc,bladeenc,all the progs have
worked without any seg faults and such things.
Please CC me the messages and ask me if you need to know more.
-- 
Safari - sfarin@ratol.fi - PGP key 0x443BD271 - 
http://surf.to/safari
 "One World, One Web, One Program" - Microsoft Promotional Ad
 "Ein Volk, Ein Reich, Ein Fuhrer" - Adolf Hitler
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.rutgers.edu
Please read the FAQ at 
http://www.tux.org/lkml/