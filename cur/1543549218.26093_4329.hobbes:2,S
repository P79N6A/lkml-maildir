Date: Wed, 20 Sep 2000 00:49:12 +0200
From: Torben Mathiasen <>
Subject: Re: [PATCH] Re: SCSI scanning
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2000/9/19/101

On Tue, Sep 19 2000, Eric Youngdale wrote:
>     1) SCSI core.
>     2) low-level drivers (in same order as specified in hosts.c).
>     3) upper level drivers.
> 
Okay, I've just spent a couple of hours browsing through the scsi code, 
compiling different configs, and trying to figure out what to do with
the Makefile stuff. 
I can't seem to find a clean way of getting the drivers outside "drivers/scsi"
to link _after_ the other low-level drivers. My linux Makefile abilities is
limited though, so if someone with the knowledge would do what Eric requests
above please. We will probaly have to move some thing around, and that would be a
_bad_ move at this point I guess.
Now as I see it we have a few things we also need to fix:
DMA-POOL:
Someone on lkm reported getting low on dma-pool memory when using scsi as
builtin. Now Eric, how big is the difference between the two cases (module vs.
builtin) in the old scsi code? We use the module case for allocating dma mem 
now. I guess the module case tries to alloc as little as possible in order to
not hit fragmentated mem?
INIT:
The initialization routines needs to be looked at. Because we use the module 
stuff, some information gets printed wrong, like  "scsi: 0 hosts" scrolling
down the screen for each host.
I begin to wonder if some of this _really_ is 2.5 stuff. If someone can come
up with a clean solution to the Makefile issue, we might pull it off. If 
we need to move the other scsi drivers (i2o, etc.) around I think we should
back off and do it nice and slow for 2.5. In this case we could revert to 
the point where sd/st/sr are modulized, and saving the core system for 2.5.
This is just IMHO, let me know what you think.
-- 
Torben Mathiasen <tmm@image.dk>
Linux ThunderLAN maintainer 
http://tlan.kernel.dk
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.kernel.org
Please read the FAQ at 
http://www.tux.org/lkml/