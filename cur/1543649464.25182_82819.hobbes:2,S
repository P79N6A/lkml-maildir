Date: Wed, 23 Oct 2002 11:18:52 +1000
From:  peterc@gelato ...
Subject: Ejecting an orinoco card causes hang
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2002/10/22/387

Hi Davids,
   I see the following problems with the orinoco plus cardbus plus
yenta_socket system on 2.5.44.
I'm using a Netgear MA401.
1.  cardctl reset gives a warning:
      orinoco_lock() called with hw_unavailable.
    I added a call to dump_stack() where the message was being printed
    out --- it's happening when pcmcia_release_configuration() calls
    set_socket, which calls yenta_get_socket() which calls set_cis_map
    which causes an interrupt, and then orinoco_interrupt reports the
    problem.   So it's probably benign.
2.  cardctl eject gives a warning, Bad: scheduling while atomic. I
    think this is a generic problem, not orinoco-specific ---
    pcmcia_eject_card() disables interrupts, then calls do_shutdown()
    which calls cs_sleep(), and cs_sleep() tries to sleep (but with
    interrupts disabled, bad)
3.  Manually ejecting the card (without doing a cardctl eject first)
    locks the machine solid.  Nothing in the logs, nothing on the
    screen.  I suspect it's disabling interrupts then doing something
    silly. 
4.  Transferring lots of data causes the link to collapse, and the
    logs to fill up with `eth0: Error -110 writing Tx descriptor to
    BAP' messages
--
Dr Peter Chubb				    peterc@gelato.unsw.edu.au
You are lost in a maze of BitKeeper repositories, all almost the same.
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.kernel.org
More majordomo info at  
http://vger.kernel.org/majordomo-info.html
Please read the FAQ at  
http://www.tux.org/lkml/