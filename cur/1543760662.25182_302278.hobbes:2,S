Date: Sat, 12 Mar 2005 23:28:34 +0900
From: OGAWA Hirofumi <>
Subject: Re: [CHECKER] crash + fsck cause file systems to contain loops (msdos and vfat, 2.6.11)
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2005/3/12/46

Junfeng Yang <yjf@stanford.edu> writes:
>> Linus's current tree includes support for `mount -o sync' on the msdos and
>> vfat filesystems.
>
> Thanks Andrew.  I can just do a bk clone from
> 
http://linux.bkbits.net/linux-2.6
 to get Linus's current tree, right?
>
> The warning reported here doesn't need mount -o sync to trigger though.
> A simple crash on a default mounted FS can usually cause the FS loop.
>
> (Also, I realized I made many typos in my report --- this implies I'm
> tired and should probably get some sleep :)
Interesting.
$ /devel/linux/works/fatfs/fatfstools/dosfstools-2.10/dosfsck/dosfsck -a bug10/crash.img
dosfsck 2.10, 22 Sep 2003, FAT32, LFN
/0006
  Directory does not have any cluster  ("." and "..").
  Dropping it.
Reclaimed 3 unused clusters (6144 bytes) in 3 chains.
Performing changes.
crash.img: 8 files, 3/8167 clusters
My fixed dosfsck found the above corruption in bug10/crash.img (bug7
has same corruption). And probably you can see root directory via 0006
directory, I guess your testing tree didn't have my patches yet (seems
old behavior).
BTW, what mount options did you use?
Thanks.
-- 
OGAWA Hirofumi <hirofumi@mail.parknet.co.jp>
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.kernel.org
More majordomo info at  
http://vger.kernel.org/majordomo-info.html
Please read the FAQ at  
http://www.tux.org/lkml/