Date: Thu, 16 Sep 2004 21:29:34 +1000
From: Nigel Cunningham <>
Subject: Re: [PATCH] Suspend2 Merge: Driver model patches 0/2
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2004/9/16/96

Hi.
On Thu, 2004-09-16 at 21:18, Pavel Machek wrote:
> Hi!
> 
> > Here are two patches for the driver model, which have been in use in
> > suspend2 for around a month.
> > 
> > The first provides support for keeping part of the device tree alive
> > while suspending the remainder. This is accomplished by abstracting the
> > dpm_active, dpm_off and dpm_irq lists into a new struct partial device
> 
> I believe this is wrong approach.
> 
> For atomic snapshot to work, all devices need to be stopped. If your
> video card does DMA, it needs to be stopped. So all drivers need to
> know, you can not just exclude part of tree.
Sorry. Perhaps I wasn't clear enough. I do suspend these devices. But I
do it later:
Suspend all other drivers.
Write pageset 2 (page cache).
Suspend used drivers.
Make atomic copy.
Resume used drivers.
Write pageset 1 (atomic copy)
Suspend used drivers.
Power down all.
And vice versa at resume time.
> Now, you probably do not want disks to spin down and you want your
> screen unblanked (as an optimalization/speedup). Patch for keeping
> disk up is allready in -mm. Patch for keeping radeonfb up looks like
> this, and is pending, too.
Mm. Don't forget i8xx and the gazillion other drivers there :>. I see
this is using the SYSTEM_SNAPSHOT value. Do those changes look like
being merged to Linus soon?
Regards,
Nigel
-- 
Nigel Cunningham
Pastoral Worker
Christian Reformed Church of Tuggeranong
PO Box 1004, Tuggeranong, ACT 2901
Many today claim to be tolerant. True tolerance, however, can cope with others
being intolerant.
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.kernel.org
More majordomo info at  
http://vger.kernel.org/majordomo-info.html
Please read the FAQ at  
http://www.tux.org/lkml/