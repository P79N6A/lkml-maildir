Date: Fri, 28 Dec 2001 21:11:13 -0800
From: Matthew Dharm <>
Subject: Re: Fwd: Hard Lockup on 2.4.16 with Via ieee1394 (sbp2 mode)
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2001/12/29/185

It should be using scsi_done()... it actually seems to use whatever was
given as a done function at the queuecommand point, which is, I think,
scsi_done().
Matt
On Fri, Dec 28, 2001 at 08:59:17PM -0800, Andrew Morton wrote:
> Matthew Dharm wrote:
> > 
> > Hrm...
> > 
> > Does this apply to usb-storage also?  Under what conditions do you need to
> > hold the io_request_lock when calling the done function?
> > 
> 
> That's scsi_old_done().  I don't think scsi_done() cares whether
> io_request_lock is held or not.
> 
> And io_request_lock *must* be held by the caller of scsi_old_done() - it
> assumes this.   I think we'd have heard by now if usb was getting this
> wrong.  Looks like it's using scsi_done(), yes?
> 
> -
-- 
Matthew Dharm                              Home: mdharm-usb@one-eyed-alien.net 
Maintainer, Linux USB Mass Storage Driver
Sir, for the hundreth time, we do NOT carry 600-round boxes of belt-fed 
suction darts!
					-- Salesperson to Greg
User Friendly, 12/30/1997
[unhandled content-type:application/pgp-signature]