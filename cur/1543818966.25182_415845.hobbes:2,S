Date: Fri, 14 Apr 2006 00:18:34 +0100
From: Richard Purdie <>
Subject: Re: 2.6.17-rc1: collie -- oopsen in pccardd?
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2006/4/13/293

On Thu, 2006-04-13 at 19:14 +0200, Dominik Brodowski wrote:
> Oh yes, mea culpa. However, we can simply remove setting res->flags here, as
> we never read it in this case anyways.
> 
> Thanks,
> 	Dominik
> 
> 
> From: Dominik Brodowski <linux@dominikbrodowski.net>
> Date: Thu Apr 13 19:06:49 2006 +0200
> Subject: [PATCH] pcmcia: fix oops in static mapping case
> 
> As static maps do not have IO resources, this setting oopses. However, as
> we do not ever read this value, we can safely remove it.
> 
> Signed-off-by: Dominik Brodowski <linux@dominikbrodowski.net>
>
> diff --git a/drivers/pcmcia/pcmcia_resource.c
> b/drivers/pcmcia/pcmcia_resource.c
> index 2539c0b..cc3402c 100644
> --- a/drivers/pcmcia/pcmcia_resource.c
> +++ b/drivers/pcmcia/pcmcia_resource.c
> @@ -88,7 +88,6 @@ static int alloc_io_space(struct pcmcia_
>         }
>         if ((s->features & SS_CAP_STATIC_MAP) && s->io_offset) {
>                 *base = s->io_offset | (*base & 0x0fff);
> -               s->io[0].res->flags = (s->io[0].res->flags &
> ~IORESOURCE_BITS) | (attr & IORESOURCE_BITS);
>                 return 0;
>         }
>         /* Check for an already-allocated window that must conflict 
I can confirm this fixes the problem I was seeing as well.
Thanks,
Richard
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.kernel.org
More majordomo info at  
http://vger.kernel.org/majordomo-info.html
Please read the FAQ at  
http://www.tux.org/lkml/