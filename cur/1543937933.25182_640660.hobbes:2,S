Date: Sat, 19 Jan 2008 12:28:29 +1100
From: Rusty Russell <>
Subject: Re: [PATCH 3/3] Makes lguest's irq handler typesafe
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2008/1/18/595

On Saturday 19 January 2008 10:12:33 Tejun Heo wrote:
> Type safety is good but I doubt this would be worth the complexity.  It
> has some benefits but there's much larger benefit in keeping things in
> straight C.  People know that functions take fixed types and are also
> familiar with the convention of passing void * for callback arguments.
> IMHO, staying in line with those common knowledges easily trumps having
> type checking on interrupt handler.
I sympathise with this argument, but I think just because people are familiar 
with existing hacks shouldn't prevent improvement.  I think the resulting 
code is clearer and more readable.
Even in the implementation, the tricky part is the check_either_type() macro: 
the rest is straight-forward.
> Also, how often do we see a bug where things go wrong because interrupt
> handler is given the wrong type of argument?  Even when such bug
> happens, I doubt it can escape the developer's workstation if he/she is
> paying any attention to testing.
I agree this one is unlikely.  But I am trying to spread type-safety more 
widely (see previous kthread patches).
I like changing the kernel to make life simpler for developers.  We don't do 
enough of it.
Cheers,
Rusty.