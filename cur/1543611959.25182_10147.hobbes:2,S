Date: Tue, 4 Dec 2001 18:17:46 +0000
From: Paul Cook <>
Subject: [PATCH] Small X25 IOCTL Fix
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2001/12/4/136

Hi,
without the following small patch, it is impossible, using the ioctl 
interface, to disable the throughput facility without patching /include/x25.h 
and re-compiling.
This is made against a 2.2.19, but looks equally relevant for 2.4.x
--- net/x25/old_af_x25.c	Wed Nov 28 18:37:15 2001
+++ net/x25/af_x25.c	Thu Nov 29 12:33:50 2001
@@ -1150,7 +1150,7 @@
 				return -EINVAL;
 			if (facilities.winsize_in < 1 || facilities.winsize_in > 127)
 				return -EINVAL;
-			if (facilities.throughput < 0x03 || facilities.throughput > 0x2C)
+			if (facilities.throughput && (facilities.throughput < 0x03 || facilities.throughput > 0x2C))
 				return -EINVAL;
 			if (facilities.reverse != 0 && facilities.reverse != 1)
 				return -EINVAL;