Date: Thu, 22 Jan 2009 22:21:41 -0700
From: Jonathan Corbet <>
Subject: Re: [PATCH, RFC] Remove fasync() BKL usage, take 3325
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2009/1/23/5

On Thu, 22 Jan 2009 17:09:35 +0100
Andi Kleen <andi@firstfloor.org> wrote:
> > OK, replacing a lock_kernel() with a spin_lock(&global_lock) is
> > pretty straightforwad.  But it's really really sad.  It basically
> > leaves a great big FIXME in there.  It'd be better to fix it.  
> 
> Also it might be that it's even worse than the BKL.
I don't quite see how now.  Like the BKL, it's a spinlock.
> It would still require a bitlock because some state in the low
> level fasync needs to be protected.
> 
> Oleg has a proposal to do this using a flag bit which seemed
> reasonable to me.
I didn't see a reason to add a one-off custom locking regime for such a
non-hot-path situation.  But it would certainly work; if we want to go
that way I'll not fight it.
jon