Date: Mon, 10 Nov 2008 18:47:23 -0800 (PST)
From: Linus Torvalds <>
Subject: Re: [Bug #11875] radeonfb lockup in .28-rc (bisected)
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2008/11/10/385

On Tue, 11 Nov 2008, Benjamin Herrenschmidt wrote:
> 
> In any case, I doesn't seem to be directly related to those radeonfb
> changes, though a clash with X like that is indeed more likely to
> actually happen if radeonfb relies more heavily on acceleration.
Just a silly question, without actually looking at the code - since you 
now do acceleration in radeonfb, do you wait for everything to drain 
before you switch consoles? 
There could be races that depend on timing, where perhaps X is unhappy 
about being entered with the acceleration engine busy, or conversely the 
radeonfb code is unhappy about perhaps some still-in-progress X thing that 
hasn't been synchronously waited for..
Before, radeonfb_imageblit() would always end up doing a 
"radeon_engine_idle()", so in practice, I think just about any fbcon 
access ended up idling the engine. Now, we can probably do a lot more 
without syncronizing - maybe there's insufficient synchronization at the 
switch-over from X to text-mode or vice versa?
		Linus