Date: Tue, 29 Nov 2005 14:02:58 -0500
From: Kyle Moffett <>
Subject: [PATCH][RFC][2.6.15-rc3] snd_powermac: Add ID for Spring 2005 17" Powerbook
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2005/11/29/131

The audio chip in my Spring 2005 17" PowerBook was incorrectly  
recognized as an AWACS chip.  This adds the chip ID to the  
snd_powermac driver such that it is recognized as a Toonie (I don't  
know if that's correct, but it's the only one that makes it work at  
all). and sorts the ID lists numerically.  NOTE:  This chip is only  
minimally supported at this point; it has system beep support and  
very low volume speaker output, and that's about it.
Signed-off-by: Kyle Moffett <mrmacman_g4@mac.com>
--- linux-2.6.15-rc2/sound/ppc/pmac.c	2005-10-27 20:02:08.000000000 -0400
+++ linux-2.6.15-rc2-aphrodite1/sound/ppc/pmac.c	2005-11-26 02:18:40.000000000 -0500
@@ -987,11 +987,11 @@
 		 * single frequency until proper i2s control is implemented
 		 */
 		switch(layout_id) {
-		case 0x48:
-		case 0x46:
-		case 0x33:
-		case 0x29:
 		case 0x24:
+		case 0x29:
+		case 0x33:
+		case 0x46:
+		case 0x48:
 		case 0x50:
 		case 0x5c:
 			chip->num_freqs = ARRAY_SIZE(tumbler_freqs);
@@ -1000,6 +1000,7 @@
 			chip->control_mask = MASK_IEPC | 0x11;/* disable IEE */
 			break;
 		case 0x3a:
+		case 0x40:
 			chip->num_freqs = ARRAY_SIZE(tumbler_freqs);
 			chip->model = PMAC_TOONIE;
 			chip->can_byte_swap = 0; /* FIXME: check this */