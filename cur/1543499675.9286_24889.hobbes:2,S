Date: Sat, 19 Jun 1999 11:24:46 +0200
From: Luca Montecchiani <>
Subject: Re: Same HD, same settings, different geometry
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/1999/6/19/16

"Mike A. Harris" wrote:
> 
> On Sat, 19 Jun 1999, Luca Montecchiani wrote:
> 
> >Hi all,
> >in my Pc I've two IDE, hda ( primary on 1ide ) and hdc ( primary on 2ide ) the
> >bios settings on the motherboard is auto/LBA for all 4 ide channels.
> >
> >The facts on kernel 2.x.x
> >-------------------------
> >When linux boots hda show the "bios" geometry (LBA), and hdc show the physical
> >geometry. This worry me, but everything work fine and /proc/ide/hd*/geometry
> >is my friend.  Seeing those difference, especially in my office machine where
> >hda and hdc are the same models make me unhappy :(
> >I started to look in the code ( 2.2.10 ) to understand why...
> >In short only hd's on the primary ide interface will showed with their bios/cmos
> >geometry.
> 
> To avoid this problem, I religiously partition fresh factory
> drives on a primary master or primary slave *always*.  You only
> need to make one partition.  Then the drive can be moved to the
> secondary without worry.
So it's impossible to fdisk a "fresh factory hd" on the secondary ide ??
Hmm let me see...
ide.c
 *  To do, in likely order of completion:
 *      - modify kernel to obtain BIOS geometry for drives on 2nd/3rd/4th i/f
*/   
ide-probe.c                                                                        
 * The only "perfect" way to handle this would be to modify the setup.[cS] code
 * to do BIOS calls Int13h/Fn08h and Int13h/Fn48h to get all of the drive info
 * for us during initialization.  I have the necessary docs -- any takers?  -ml
 */
-----------------------------------------------------------------------
Is there any plan to improve/cleanup the IDE-Geometry stuff in 2.3.x ??
-----------------------------------------------------------------------
> If you don't have a free primary, and cannot remove one of the
> primary drives to do this, you can either shut the machine down
> and boot off a boot floppy containing fdisk, after removing a
> primary drive, and replacing it with the one you wish to
> partition, or you can use a different computer to do the
> partitioning.
> 
> It is a good workaround.
Sure but we can "do it better" ;) It's funny to think about a 
fdisker.mydomain.com on my network :P
Anyway I need to know if my upatch will break something.
I don't think because it's essentially _cosmetics_, but with "hdX=nocmosgeom"
(*)
we use the same way to retrieve hda and hdc geometry :).
The problem I see is only in "installation like" situations
when hda is a "fresh hd" that we want to fdisk, simply don't use 
hdX=nocmosgeom (*).
thanks, luca
(*) where hdX=hda or hdb
_______________________________________________________________
Aiem...: Luca Montecchiani           W.W.W.: 
http://i.am/m.luca
E-mail.: m.luca@iname.com            Kernel: 2.2
I.R.C..: defrag (#linux-it)          I.C.Q.: 17655604
PGP5.0i: available on my home page   Lime98: io c'ero ;)
_______________________________________________________________
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.rutgers.edu
Please read the FAQ at 
http://www.tux.org/lkml/