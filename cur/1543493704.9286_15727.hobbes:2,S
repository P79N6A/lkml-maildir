Date: Fri, 23 Apr 1999 19:10:46 -0500 (CDT)
From: "Andre M. Hedrick" <>
Subject: PDC20262 UDMA(66) (Re: Promise PCI Ultra66 IDE controller)
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/1999/4/23/131

We got a winner!!!!!!!!!
There are minor geometry issues that may need addressing.
Everyone give thanks to Robert for suffering through blind code writing
for a device that I can not personally test yet.
Version three or four will be out this weekend.
On Fri, 23 Apr 1999, Robert A. Yetman wrote:
> 
> Okay, patch nr3 works fine.
> 
> Here's lspci
> --------------------------------------------------------
> 00:0f.0 Unknown mass storage controller: Promise Technology, Inc.: Unknown device 4d38 (rev 01)
> 	Subsystem: Unknown device 105a:4d33
> 	Control: I/O+ Mem+ BusMaster+ SpecCycle- MemWINV- VGASnoop- ParErr- Stepping- SERR- FastB2B-
> 	Status: 66Mhz- UDF- FastB2B- ParErr- DEVSEL=medium >TAbort- <TAbort- <MAbort- >SERR- <PERR-
> 	Latency: 64 set
> 	Interrupt: pin A routed to IRQ 10
> 	Region 0: I/O ports at 1440
> 	Region 1: I/O ports at 1434
> 	Region 2: I/O ports at 1438
> 	Region 3: I/O ports at 1430
> 	Region 4: I/O ports at 10c0
> 	Region 5: Memory at f4000000 (32-bit, non-prefetchable)
> 00: 5a 10 38 4d 07 00 00 02 01 00 80 01 00 40 00 00
> 10: 41 14 00 00 35 14 00 00 39 14 00 00 31 14 00 00
> 20: c1 10 00 00 00 00 00 f4 00 00 00 00 5a 10 33 4d
> 30: 00 00 00 00 00 00 00 00 00 00 00 00 0a 01 00 00
> 40: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
> 50: 8e 33 00 00 00 00 00 00 00 00 00 00 00 00 00 00
> 60: f1 24 41 00 c4 f3 4f 00 04 f3 4f 00 04 f3 4f 00
> 70: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
> 80: 5a 10 38 4d 07 00 00 02 01 00 80 01 00 40 00 00
> 90: 41 14 00 00 35 14 00 00 39 14 00 00 31 14 00 00
> a0: c1 10 00 00 00 00 00 f4 00 00 00 00 00 00 00 00
> b0: 00 00 00 00 00 00 00 00 00 00 00 00 0a 01 00 00
> c0: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
> d0: 8e 33 00 00 00 00 00 00 00 00 00 00 00 00 00 00
> e0: f1 24 41 00 c4 f3 4f 00 04 f3 4f 00 04 f3 4f 00
> f0: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
> 
> ----------------------------------------------------------------
> Here's dmesg
> --------------------------------------------------------------
> Linux version 2.2.6 (root@juryrig) (gcc version 2.8.1) #4 Fri Apr 23 17:16:04 EDT 1999
> Detected 448807385 Hz processor.
> Console: colour VGA+ 80x50
> Calibrating delay loop... 447.28 BogoMIPS
> Memory: 128384k/131072k available (736k kernel code, 412k reserved, 1500k data, 40k init)
> CPU: Intel 00/07 stepping 02
> Checking 386/387 coupling... OK, FPU using exception 16 error reporting.
> Checking 'hlt' instruction... OK.
> POSIX conformance testing by UNIFIX
> PCI: PCI BIOS revision 2.10 entry at 0xfd983
> PCI: Using configuration type 1
> PCI: Probing PCI hardware
> Linux NET4.0 for Linux 2.2
> Based upon Swansea University Computer Society NET3.039
> NET4: Unix domain sockets 1.0 for Linux NET4.0.
> NET4: Linux TCP/IP 1.0 for NET4.0
> IP Protocols: ICMP, UDP, TCP
> Starting kswapd v 1.5 
> parport0: PC-style at 0x378 [SPP,PS2,EPP]
> parport0: no IEEE-1284 device present.
> parport1: PC-style at 0x278 [SPP,ECP,ECPEPP,ECPPS2]
> parport1: Printer, HEWLETT-PACKARD DESKJET 600
> Detected PS/2 Mouse Port.
> Serial driver version 4.27 with no serial options enabled
> ttyS00 at 0x03f8 (irq = 4) is a 16550A
> ttyS02 at 0x03e8 (irq = 4) is a ST16650V2
> pty: 256 Unix98 ptys configured
> lp0: using parport0 (polling).
> lp1: using parport1 (polling).
> apm: BIOS version 1.2 Flags 0x03 (Driver version 1.9)
> Uniform Multi-Platform E-IDE driver Revision: 6.19
> PIIX4: IDE controller on PCI bus 00 dev 39
> PIIX4: not 100% native mode: will probe irqs later
>     ide0: BM-DMA at 0x1420-0x1427, BIOS settings: hda:DMA, hdb:pio
>     ide1: BM-DMA at 0x1428-0x142f, BIOS settings: hdc:DMA, hdd:pio
> PDC20262: IDE controller on PCI bus 00 dev 78
> PDC20262: not 100% native mode: will probe irqs later
> PDC20262: (U)DMA Burst Bit ENABLED Primary PCI Mode Secondary PCI Mode.
>     ide2: BM-DMA at 0x10c0-0x10c7, BIOS settings: hde:pio, hdf:pio
>     ide3: BM-DMA at 0x10c8-0x10cf, BIOS settings: hdg:pio, hdh:pio
> hda: WDC AC32500H, ATA DISK drive
> hdc: MATSHITADVD-ROM SR-8583, ATAPI CDROM drive
> hde: WDC AC29100D, ATA DISK drive
> ide0 at 0x1f0-0x1f7,0x3f6 on irq 14
> ide1 at 0x170-0x177,0x376 on irq 15
> ide2 at 0x1440-0x1447,0x1436 on irq 10
> hda: Disabling (U)DMA for WDC AC32500H
> hda: DMA disabled
> hda: WDC AC32500H, 2441MB w/128kB Cache, CHS=1024/255/63
> hde: lost interrupt
> hde: set_geometry_intr: status=0x00 { }
Andries and Mark,
What is your view about the two lines above?
> hde: WDC AC29100D, 8693MB w/1966kB Cache, CHS=17662/16/63, UDMA(66)
> hdc: ATAPI 32X DVD-ROM drive, 512kB Cache, DMA
> Uniform CDROM driver Revision: 2.54
> Floppy drive(s): fd0 is 1.44M
> FDC 0 is a post-1991 82077
> PPP: version 2.3.3 (demand dialling)
> TCP compression code copyright 1989 Regents of the University of California
> PPP line discipline registered.
> 3c59x.c:v0.99H 11/17/98 Donald Becker 
http://cesdis.gsfc.nasa.gov/linux/drivers/vortex.html
> eth0: 3Com 3Com Boomerang (unknown version) at 0x1000,  00:50:04:01:24:06, IRQ 9
>   8K byte-wide RAM 5:3 Rx:Tx split, autoselect/Autonegotiate interface.
>   MII transceiver found at address 24, status 1809.
>   Enabling bus-master transmits and whole-frame receives.
> Partition check:
>  hda: hda1 hda2 hda3 hda4 < hda5 hda6 >
>  hde: [PTBL] [1108/255/63] hde1 hde2 < hde5 >
> VFS: Mounted root (ext2 filesystem) readonly.
> Freeing unused kernel memory: 40k freed
> Adding Swap: 387036k swap-space (priority -1)
> bobyetman@att.net (Robert A. Yetman)
> 
Andre Hedrick
The Linux IDE guy
http://www.dyer.vanderbilt.edu/server/udma/2.2.5.uniform-ide-6.19.patch.gz
http://www.dyer.vanderbilt.edu/server/udma/2.2.6.uniform-ide-6.19.patch.gz
APC UPS Daemon Support Center.
                        
http://www.brisse.dk/site/apcupsd/
GPLed source on April 7, 1999
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.rutgers.edu
Please read the FAQ at 
http://www.tux.org/lkml/