Date: Tue, 5 Apr 2005 20:09:51 +0200
From: Ingo Molnar <>
Subject: Re: crash in entry.S restore_all, 2.6.12-rc2, x86, PAGEALLOC
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2005/4/5/252

* Mikael Pettersson <mikpe@csd.uu.se> wrote:
>  > -	jz restore_all
>  > +	jz restore_nocheck
>  >  	testl $IF_MASK,EFLAGS(%esp)     # interrupts off (exception path) ?
>  > -	jz restore_all
>  > +	jz restore_nocheck
>  >  	call preempt_schedule_irq
>  >  	jmp need_resched
>  >  #endif
> 
> Is this sufficient or do we also need the 
> s/restore_all/restore_nocheck/ at around line 553 which was in the 
> first posted patch?
all 3 restore_all->restore_nocheck changes are needed to make the bug 
not trigger. I dont think it's a real fix because whatever is being 
preempted involuntarily, it ought to have a proper kernel stack to begin 
with. I'll do some more debugging.
	Ingo
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.kernel.org
More majordomo info at  
http://vger.kernel.org/majordomo-info.html
Please read the FAQ at  
http://www.tux.org/lkml/