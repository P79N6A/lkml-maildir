Date: Sat, 27 Mar 1999 23:13:12 +0100
From: Pavel Machek <>
Subject: CODA - thank you for userfs ;-)
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/1999/3/28/11

Hi!
First, I'd like to say that coda is _great_ thing. I've venus-like
server in 270 lines of c-code, and it seems to work pretty well. At
least I see no design problems like in nfs. I can now untar archives,
ungzip files, etc... I think that coda can serve like pretty good
replacement for userfs.
And now, complains. First, you have bug out there causing module to
hang around even after being unused.
Second, reading from /dev/cfs0 returns in tight loop, still select
blocks. I think that read from cfs0 should block, too - this is
inconsistent.
							Pavel
--- clean/fs/coda/inode.c	Fri Mar 26 17:46:23 1999
+++ linux/fs/coda/inode.c	Fri Mar 26 22:51:51 1999
@@ -145,7 +145,7 @@
         sb->s_dev = 0;
 	coda_cache_clear_all(sb);
 	sb_info = coda_sbp(sb);
-	sb_info->sbi_vcomm->vc_inuse = 0;
+/*	sb_info->sbi_vcomm->vc_inuse = 0; You can not do this: psdev_release would see usagecount == 0 and would refuse to decrease MOD_USE_COUNT --pavel */ 
 	coda_super_info.sbi_sb = NULL;
 	printk("Coda: Bye bye.\n");
 	memset(sb_info, 0, sizeof(* sb_info));
-- 
I'm really pavel@atrey.karlin.mff.cuni.cz. 	   Pavel
Look at 
http://atrey.karlin.mff.cuni.cz/~pavel/
 ;-).
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.rutgers.edu
Please read the FAQ at 
http://www.tux.org/lkml/