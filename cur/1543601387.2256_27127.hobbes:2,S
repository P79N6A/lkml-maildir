Date: Mon, 17 Sep 2001 22:48:34 -0700
From: Andrew Morton <>
Subject: Re: Linux 2.4.10-pre11
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2001/9/18/2

Linus Torvalds wrote:
> 
> Ok, the big thing here is continued merging, this time with Andrea.
> 
In one test here the VM changes seem fragile, and slower.
Dual x86, 512 megs RAM, 512 megs swap.  No highmem.
The workload is:
	while true
	do
		/usr/src/ext3/tools/usemem 300
	done
	(This just mallocs 300 megs, touches it then exits)
in parallel with
	time /usr/src/ext3/tools/bash-shared-mapping -n 5 -t 3 foo 300000000
on ext2.
(bash-shared-mapping is a tool which I wrote for ext3.  It's one of the
 most aggressive VM/MM stress testers around, and has found a number of
 kernel bugs).
On 2.4.9-ac10, the b-s-m run took 294 seconds.  On 2.4.10-pre11 it
took 330 seconds DESPITE the fact that one of the b-s-m instances
was oom-killed quite early in the test.
`vmstat' took about thirty seconds to start (this is usual), but
was promptly killed, despite having (presumably) a small RSS.  Instances
of `usemem' were oom-killed quite frequently.  In 2.4.9-ac10, nothing
was oom-killed.
With a gig of VM and a 600 meg working set I don't see why it's necessary
to kill processes?   Each oom-kill was associated with a 0-order allocation
failure.
These tools are available at 
http://www.uow.edu.au/~andrewm/ext3-tools.tar.gz
OK, so this was a seriously loony workload.  But suddenly, the number of people
who understand the Linux VM has gone from maybe 10 down to just one-and-a-bit.
A large number of comments have been removed, and a year's worth of
discussion has been invalidated.
Andrea, it would be most useful if you were to spend some time (say, four hours)
commenting the code and telling us how it works.
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.kernel.org
More majordomo info at  
http://vger.kernel.org/majordomo-info.html
Please read the FAQ at  
http://www.tux.org/lkml/