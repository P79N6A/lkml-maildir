Date: Mon, 5 May 2008 07:30:57 -0400
From: Mathieu Desnoyers <>
Subject: Re: System call instrumentation
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2008/5/5/178

* Ingo Molnar (mingo@elte.hu) wrote:
> 
> * Mathieu Desnoyers <mathieu.desnoyers@polymtl.ca> wrote:
> 
> > > hm, i'm not sure about this. I've implemented system call tracing in 
> > > -rt [embedded in the latency tracer] and it only needed changes in 
> > > entry.S, not in every system call site. Now, granted, that tracer 
> > > was simpler than what LTTng tries to do, but do we _really_ need 
> > > more complexity? A trace point that simply expresses:
> > > 
> > >    sys_call_event(int sysno, long param1, long param2, long param3,
> > >                              long param4, long param5, long param6);
> > > 
> > 
> > That would work for all system calls that doesn't have parameters like 
> > "const char __user *filename".
> 
> what's the problem with them? Do you want to follow those parameters?
> 
> 	Ingo
Ideally, I'd like to have this kind of high-level information :
event name : kernel syscall
syscall name : open
arg1 (%s) : "somefile"    <-----
arg2 (%d) : flags
arg3 (%d) : mode
However, "somefile" has to be read from userspace. With the protection
involved, it would cause a performance impact to read it a second time
rather than tracing the string once it's been copied to kernel-space.
Mathieu
-- 
Mathieu Desnoyers
OpenPGP key fingerprint: 8CD5 52C3 8E3C 4140 715F  BA06 3F25 A8FE 3BAE 9A68