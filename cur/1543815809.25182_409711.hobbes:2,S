Date: Wed, 22 Mar 2006 22:57:53 +0100
From: (Ulrich Mueller)
Subject: Re: VFAT: Can't create file named 'aux.h'?
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2006/3/22/392

>>>>> H. Peter Anvin wrote:
> Sounds like they should be able to be legitimately created.  If the
> shortnames are mangled, even DOS or Win9x could access them using the
> shortname.
This looks like a mount option is needed. Actually, FAT already has an
option "check={relaxed,normal,strict}".
For example, creation of these files could be enabled in case of
"check=relaxed" (the following is untested):
--- linux-2.6.16/fs/msdos/namei.c~	2006-03-20 12:32:03.000000000 +0100
+++ linux-2.6.16/fs/msdos/namei.c	2006-03-22 22:37:46.000000000 +0100
@@ -127,7 +127,7 @@
 	}
 	while (walk - res < MSDOS_NAME)
 		*walk++ = ' ';
-	if (!opts->atari)
+	if (!opts->atari && opts->name_check != 'r')
 		/* GEMDOS is less stupid and has no reserved names */
 		for (reserved = reserved_names; *reserved; reserved++)
 			if (!strncmp(res, *reserved, 8))
Cheers
Uli
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.kernel.org
More majordomo info at  
http://vger.kernel.org/majordomo-info.html
Please read the FAQ at  
http://www.tux.org/lkml/