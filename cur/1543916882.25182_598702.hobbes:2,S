Date: Tue, 25 Sep 2007 19:00:31 +0200
From: Miloslav Semler <>
Subject: Re: Chroot bug
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2007/9/25/286

>> This  does not help.  Let's try:
>> chroot somewhere
>> mkdir foo
>> fd = open /
>> chroot foo
>> 
>
> ('fd' implicitly closed and chdir to /foo)
> 
Really? Try it. I am sure, that this works. You can create directory in 
chroot and break chroot by this. fd is not closed, because linux doesn't 
close descriptors by chroot syscall. this can be done every time if you 
have CAP_SYS_CHROOT.
> 
>> fchdir fd
>> 
>
> -EINVAL
>
> 
>> chdir ".."
>> 
>
> /../ => /
>
> 
>> ....
>> chdir ".."
>> chroot "."
>> so you are in root.
>> 
>
> so we remain in chroot.
> 
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.kernel.org
More majordomo info at  
http://vger.kernel.org/majordomo-info.html
Please read the FAQ at  
http://www.tux.org/lkml/