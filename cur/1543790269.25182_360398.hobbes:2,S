Date: Wed, 26 Oct 2005 10:28:00 +0200
From: Ingo Molnar <>
Subject: Re: 2.6.14-rc4-rt7
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2005/10/26/30

* George Anzinger <george@mvista.com> wrote:
> The TSC is such a fast and, usually, accurate answer, I think it 
> deserves a little effort to save it.  With your new clock code I think 
> we could use per cpu TSC counters, read the full 64 bits and, in real 
> corner cases, even per cpu conversion "constants" and solve this 
> problem.
the problem is, this is the same issue as 'boot-time TSC syncing', but 
in disguise: to get any 'per CPU TSC offset' you need to do exactly the 
same type of careful all-CPUs-dance to ensure that the TSCs were sampled 
at around the same moment in time!
The box where i have these small TSC inconsistencies shows that it's the 
bootup synchronization of TSCs that failed to be 100% accurate. Even a 2 
usecs error in synchronization can show up as a time-warp - regardless 
of whether we keep per-CPU TSC offsets or whether we clear these offsets 
back to 0. So it is not a solution to do another type of synchronization 
dance. The only solution is to fix the boot-time synchronization (where 
the hardware keeps TSCs synchronized all the time), or to switch TSCs 
off where this is not possible.
	Ingo
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.kernel.org
More majordomo info at  
http://vger.kernel.org/majordomo-info.html
Please read the FAQ at  
http://www.tux.org/lkml/