Date: Thu, 03 Nov 2005 08:13:54 +1100
From: Benjamin Herrenschmidt <>
Subject: Re: [PATCH] Don't touch USB controllers with MMIO disabled in quirks
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2005/11/2/272

> But an alternative strategy (which might be very sensible) is to forget 
> about the handoff entirely, and just shut down the bus master flag 
> unconditionally. Just make sure that the eventual driver will reset the 
> controller before it re-enables bus mastering.
Unfortunately, I know quite a few devices (including USB controllers)
that will react badly to the bus master flag being just cleared like
that. By badly, I mean it ranges from simply ignoring it and happily
continuing whatever bus master was being done, to completely screwing up
and crapping all over your memory/bus.
> That would seem to be the simplest possible "handoff". The only danger is 
> that I could imagine that there would be controllers out there that get 
> really confused (ie "I'm not going to play nice any more") if we shut them 
> up that way.
I suspect with the IO/MEM enable test fix we did, it shoul work fine in
practice for all cases. Let's address the "potential" issues if they
happen to show up in real life, which I doubt.
Ben.
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.kernel.org
More majordomo info at  
http://vger.kernel.org/majordomo-info.html
Please read the FAQ at  
http://www.tux.org/lkml/