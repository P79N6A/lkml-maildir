Date: Thu, 15 Apr 1999 08:32:23 -0500
From: "Dan A. Dickey" <>
Subject: Re: size of network backlog queue...
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/1999/4/15/113

Arni Raghu wrote:
> 
> Hi,
> 
> As I understand from the sources all the packets that enter the Linux
> box from all the network devices are tagged on to a single input backlog
> queue (Pls correct me if I am wrong)...Has anybody done any testing to
> see what size the queue grows in times of heavy traffic on decently fast
> machine(like the specs above)..
> 
> If I have Linux configured as a router(single processor Pentium 350, 128
> MB) and attach four 10 MB PCI Network interfaces to it..
> 
> If I now set up traffic patterns such that interfaces 1 and 2 recv heavy
> traffic from the network and interfaces 3 and 4 then throw out the
> packets back onto the network after the routing..what would be the
> status of the network backlog queue..??? How large would it grow to ..??
> 
> Is there anyway we can setup different queues for different devices..??
> I can think of a simple way way in netif_rx() we can look at skb->dev
> and based on that put the packets in a different queues..anybody see any
> potential problems..??
I did some benchmarking along this line a little more than a year
ago.  I worked with Alexey Kuznetsov and Robert Olsson.
I worked with different backlog sizes (in the 2.1 kernel at the
time it was a static size and did not dynamically grow).
I think I ran with about a 250 Mhz AMD K6.  We achieved a pretty
high percentage of wire speed for a 100Mb multiport NIC.
(64 byte UDP packets coming in one port and being routed to one of
 the other ones).  The queue size affected the percentage of wire
speed - but the most significant factor was cpu speed.
(While there was heavy traffic, the cpu was doing little else other
than routing packets).  I'll hazard a shot in the dark.
Four 10Mb NICs won't cause a P350 to even break out into a sweat.
Don't worry about changing the backlog queue size.  I'm not sure what
it is now, but one thing some people may want to try if you have
machines that are "big" routers - bump the queue size up to 3000
packets or so.  You'll be able to better weather the bursty storms.
I was using some specialized equipment to generate packets at
100Mb wire speed - and varied the inter packet gaps.  It was fun
stuff to work on for a while.  Then I changed jobs, and the work
became more interesting.  :)
	-Dan
-- 
Dan A. Dickey
ddickey@wamnet.com
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.rutgers.edu
Please read the FAQ at 
http://www.tux.org/lkml/