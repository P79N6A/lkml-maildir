Date: Thu, 27 Jul 2000 22:49:33 +0400 (MSK DST)
From:  kuznet@ms2 ...
Subject: Re: Notifiers in Linux 2.4.0-test2 and above
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2000/7/27/97

Hello!
> I think it needs backing out and reboot notifier wrappers need to do a
> counting lock.
Yes, contexts where notifier macros (functions now) were useful
vary so much, that it is better not to overload these macros
with locks.
By the way, beware, this code is wrong even when used for boot
notifier. ctrl_alt_del() runs on irq, hence write_lock() will deadlock
and must be replaced with write_lock_irq().
BTW #2: Leonard, did you not miss occasionally, that
register/unregister while running the same notifier list
is not a good idea in any case? You will dereference freed memory.
Alexey
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.rutgers.edu
Please read the FAQ at 
http://www.tux.org/lkml/