Date: Sun, 9 Mar 2003 11:16:15 +0900
From: Osamu Tomita <>
Subject: New IDE codes in 2.5.64-ac3
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2003/3/8/146

My PC98 box doesn't boot 2.5.64-ac3.
After print "ide-default: hdd: Failed to register the driver with ide.c"
forced to panic.
"hdd" is not connected my box.
IMHO We need status meaning 'supported by the driver but drive not present'.
Or this problem is PC98 specific?
I attached my quick fix. Please comment.
Regards,
Osamu Tomita
diff -Nru linux-2.5.64-ac3/drivers/ide/ide-default.c linux-2.5.64-ac3-quick-fix/drivers/ide/ide-default.c
--- linux-2.5.64-ac3/drivers/ide/ide-default.c	2003-03-08 12:51:33.000000000 +0900
+++ linux-2.5.64-ac3-quick-fix/drivers/ide/ide-default.c	2003-03-09 10:14:51.000000000 +0900
@@ -61,7 +61,8 @@
 			&idedefault_driver, IDE_SUBDRIVER_VERSION)) {
 		printk(KERN_ERR "ide-default: %s: Failed to register the "
 			"driver with ide.c\n", drive->name);
-		return 1;
+		//return 1;
+		drive->present = 0;
 	}
 	return 0;
 }
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.kernel.org
More majordomo info at  
http://vger.kernel.org/majordomo-info.html
Please read the FAQ at  
http://www.tux.org/lkml/