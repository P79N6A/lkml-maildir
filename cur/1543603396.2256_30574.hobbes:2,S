Date: Wed, 03 Oct 2001 10:51:01 -0700
From: Andrew Morton <>
Subject: Re: [POT] Which journalised filesystem ?
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2001/10/3/150

Ragnar KjÃ¸rstad wrote:
> 
> On Wed, Oct 03, 2001 at 02:54:17PM +0200, Dave Jones wrote:
> > Alan mentioned this was something to do with the IBM hard disk
> > having strange write-cache properties that confuse ext3.
> > I'm not sure if this has been fixed or not yet, but its enough
> > to make me think twice about trying it on the vaio for a while.
> 
> If a disk is doing write-back caching, it's likely to break all
> journaling filesystem and anything else that relies on write ordering.
In theory, disk write caching can defeat ext3's ordering requirements.
However I have never observed this in practice, nor have I seen
any report of it happening.
Think about it: ext3 writes a chunk of blocks, waits on them,
then writes a single commit block and waits on that.  The "chunk"
of blocks are very probably contiguous on disk.  The commit block
will most probably be at the very next LBA afer the "chunk".
The only way in which the drive can cause corruption is for it to write the
commit block before the "chunk", and for you to lose power [*] within
that time window.  Unless some serious block remapping has occurred
at the physical level, I really can't see any reason why the disk
should choose to flush those blocks in the wrong order.  Nor do I see why
the disk should leave a large time window between flushing the commit
block and then flushing the "chunk".
So....  I wouldn't be too fussed about it, personally.  
[*] I think it has to be a power outage - a kernel crash won't be
enough - the disk should still flush its write cache.  I'm not sure
if hitting the front-panel reset button would prevent a disk from
flushing its cache?
-
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.kernel.org
More majordomo info at  
http://vger.kernel.org/majordomo-info.html
Please read the FAQ at  
http://www.tux.org/lkml/