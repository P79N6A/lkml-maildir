Date: Tue, 20 Jan 2009 23:54:47 -0500
From: Mathieu Desnoyers <>
Subject: Re: [ltt-dev] [RFC PATCH] block: Fix bio merge induced high I/O latency
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2009/1/20/433

* Ben Gamari (bgamari@gmail.com) wrote:
> On Tue, Jan 20, 2009 at 7:25 PM, Mathieu Desnoyers
> <mathieu.desnoyers@polymtl.ca> wrote:
> > * Mathieu Desnoyers (mathieu.desnoyers@polymtl.ca) wrote:
> >
> > As a side-note : I'd like to have my results confirmed by others.
> 
> Well, I think the (fixed) patch did help to some degree (I haven't
> done fio benchmarks to compare against yet). Unfortunately, the I/O
> wait time problem still remains. I have been waiting 3 minutes now for
> evolution to start with 88% I/O wait time yet no visible signs of
> progress. I've confirmed I'm using the CFQ scheduler, so that's not
> the problem.
> 
Did you also 
echo 1 > /sys/block/sd{a,b}/device/queue_depth
echo 1 > /sys/block/sd{a,b}/queue/iosched/slice_async_rq
echo 1 > /sys/block/sd{a,b}/queue/iosched/quantum
(replacing sd{a,b} with your actual drives) ?
It seems to have been part of the factors that helped (along with the
patch).
And hopefully you don't have a recent Seagate hard drive like me ? :-)
So you test case is :
- start a large dd with 1M block size
- time evolution
?
Mathieu
> Also, Jens, I'd just like to point out that the problem is
> reproducible across all schedulers. Does your patch seek to tackle a
> problem specific to the CFQ scheduler, leaving the I/O wait issue for
> later? Just wondering.
> 
> I'll post some benchmarks numbers once I have them. Thanks,
> 
> - Ben
> 
> _______________________________________________
> ltt-dev mailing list
> ltt-dev@lists.casi.polymtl.ca
> 
http://lists.casi.polymtl.ca/cgi-bin/mailman/listinfo/ltt-dev
> 
-- 
Mathieu Desnoyers
OpenPGP key fingerprint: 8CD5 52C3 8E3C 4140 715F  BA06 3F25 A8FE 3BAE 9A68