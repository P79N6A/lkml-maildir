Date: Tue, 27 Nov 2001 16:35:40 -0800 (PST)
From: James Simmons <>
Subject: [PATCH] small VT cleanup
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2001/11/27/331

Small cleanups for the VT system. Doesn't make sense to have any VT code
in genhd.c. So I moved it to tty_io.c where it belongs. Patch has been
tested.
--- linux-2.5.0/drivers/block/genhd.c	Tue Nov 27 12:05:59 2001
+++ linux/drivers/block/genhd.c	Tue Nov 27 17:24:26 2001
@@ -183,7 +183,6 @@
 extern int fusion_init(void);
 #endif
 extern int net_dev_init(void);
-extern void console_map_init(void);
 extern int soc_probe(void);
 extern int atmdev_init(void);
 extern int i2o_init(void);
@@ -212,9 +211,6 @@
 #endif
 #ifdef CONFIG_ATM
 	(void) atmdev_init();
-#endif
-#ifdef CONFIG_VT
-	console_map_init();
 #endif
 	return 0;
 }
--- linux-2.5.0/drivers/char/tty_io.c	Tue Nov 27 11:56:43 2001
+++ linux/drivers/char/tty_io.c	Tue Nov 27 17:24:05 2001
@@ -2317,7 +2317,9 @@
 	if (tty_register_driver(&dev_console_driver))
 		panic("Couldn't register /dev/tty0 driver\n");
 
+	vcs_init();
 	kbd_init();
+	console_map_init();
 #endif
 
 #ifdef CONFIG_ESPSERIAL  /* init ESP before rs, so rs doesn't see the port */
@@ -2363,9 +2365,6 @@
 #ifdef CONFIG_MOXA_INTELLIO
 	moxa_init();
 #endif	
-#ifdef CONFIG_VT
-	vcs_init();
-#endif
 #ifdef CONFIG_TN3270
 	tub3270_init();
 #endif
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.kernel.org
More majordomo info at  
http://vger.kernel.org/majordomo-info.html
Please read the FAQ at  
http://www.tux.org/lkml/