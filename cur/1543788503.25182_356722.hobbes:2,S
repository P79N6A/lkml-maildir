Date: Fri, 07 Oct 2005 16:04:53 +0200
From: Miklos Szeredi <>
Subject: Re: [PATCH] nfs: don't drop dentry in d_revalidate
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2005/10/7/98

> > NFS d_revalidate() is doing things that are supposed to be done by
> > d_invalidate().
> > 
> > Dropping the dentry is especially bad, since it will make
> > d_invalidate() bypass all checks.
> 
> NAK!
> 
> Bypassing the stupid d_invalidate checks is precisely the point here.
> 
> Unlike local filesystems, we have to deal with the case where someone
> deletes a file on the server and then creates a new one with the same
> name. The d_invalidate checks will keep the wrong dentry hashed for as
> long as some borken process has the file open.
> 
d_invalidate() only makes sense for network filesystems like NFS.  If
it's broken, fix it.  But bypassing it is definitely the wrong thing
to do.
Miklos
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.kernel.org
More majordomo info at  
http://vger.kernel.org/majordomo-info.html
Please read the FAQ at  
http://www.tux.org/lkml/