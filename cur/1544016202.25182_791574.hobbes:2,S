Date: Tue, 13 Jan 2009 23:33:00 +0100
From: Pavel Machek <>
Subject: Re: hp_accel: do not call ACPI from invalid context
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2009/1/13/442

On Tue 2009-01-13 14:11:16, Andrew Morton wrote:
> On Mon, 12 Jan 2009 11:31:55 +0100
> Pavel Machek <pavel@suse.cz> wrote:
> 
> > 
> > LED on HP notebooks is connected through ACPI. That unfortunately
> > means that it needs to be delayed by using schedule_work() to avoid
> > calling ACPI interpretter in invalid context. This patch fixes that.
> > 
> > Signed-off-by: Pavel Machek <pavel@suse.cz>
> > -static void hpled_set(struct led_classdev *led_cdev,
> > -			       enum led_brightness value)
> > -{
> > -	hpled_acpi_write(adev.device->handle, !!value);
> > -}
> > -
> > -static struct led_classdev hpled_led = {
> > -	.name			= "hp:red:hddprotection",
> > -	.default_trigger	= "heartbeat",
> 
> Current mainline+lis3lv02d-merge-with-leds-hp-disk.patch has "none"
> here, so the patch didn't apply.
Oops, sorry about that. I was hand-editing patches a bit too much :-(.
> > -	.brightness_set		= hpled_set,
> > +static struct delayed_led_classdev hpled_led = {
> > +	.led_classdev = {
> > +		.name			= "hp::hddprotect",
> > +		.default_trigger	= "none",
> 
> But I assume we wanted "none" here anyway, so that's what I'll do.
Thanks!
									Pavel
-- 
(english) 
http://www.livejournal.com/~pavelmachek
(cesky, pictures) 
http://atrey.karlin.mff.cuni.cz/~pavel/picture/horses/blog.html