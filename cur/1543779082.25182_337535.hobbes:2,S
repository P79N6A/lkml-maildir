Date: Fri, 29 Jul 2005 17:32:13 -0700 (PDT)
From: Christoph Lameter <>
Subject: Re: long delays (possibly infinite) in time_interpolator_get_counter
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2005/7/29/358

> diff --git a/include/linux/timex.h b/include/linux/timex.h
Oh. Before I forget: You need to make the same changes to the asm code in 
arch/ia64/kernel/fsys.S in order for this to work properly. The asm code 
has been optimized to the hilt to save every cycle possible. Please dont 
add any. The C code is typically bypassed for all user space gettimeofday 
/ clock_gettime calls.
Hmm.. However, if you did not see the problem in the asm code (which does 
not have the nesting issue of C and wastes some time doing other things) 
then we may solve the issue by either also calling asm from kernel space 
or making sure that some time is wasted on something else then the 
cmpxchg in the inner loop.
Or we can make "nojitter" the default? Then do a
if (nojitter)
	printk(KERN_ERR "Beware: SMP system using ITC as a time source!"
		"Time may fluctuate.\n");
at bootup and hope for the best?
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.kernel.org
More majordomo info at  
http://vger.kernel.org/majordomo-info.html
Please read the FAQ at  
http://www.tux.org/lkml/