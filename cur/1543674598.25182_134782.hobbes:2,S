Date: 22 May 2003 17:04:29 -0700
From: Bryan O'Sullivan <>
Subject: [CFT] Move ipconfig and nfsroot support from kernel to userspace
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2003/5/22/229

I've put together a new klibc snapshot, along with a set of kernel
patches, to move ipconfig and nfsroot support into userspace.  These can
all be found at 
http://www.speakeasy.org/~bos
The klibc snapshot includes kinit, a statically linked binary that
replaces the 2.5 kernel's support for IP autoconfiguration
(CONFIG_IP_PNP, aka "ipconfig") and use of NFS as the root filesystem
(CONFIG_ROOT_NFS, aka "nfsroot"). 
The patches remove support for ipconfig and nfsroot, and get the kernel
into an intermediate state where it can at least boot into a kinit built
in a klibc tree. 
      * ipconfig-2.5.69 removes support for ipconfig, and disables the
        building of nfsroot. 
      * nfsroot-2.5.69 removes support for nfsroot. 
      * initramfs-2.5.69 stops the kernel from doing the usual mount
        procedure if it sees "root=initramfs" or "root=/dev/nfs" on the
        kernel command line. Instead, it hands control over to whatever
        it finds in initramfs. 
To test, you'll need to build klibc, copy kinit into the kernel's usr
directory, blow away the .cpio file in there, and rebuild your kernel.
You can then reboot with a kernel command line such as "ip=eth0
root=/dev/nfs", and your kernel should use DHCP to configure eth0 and
mount its root filesystem from whatever NFS server the DHCP server told
it. 
If you're feeling impatient and don't want to build klibc, there's a
kinit binary precompiled that you can use for testing. 
Note: the kinit binary currently only supports nfsroot and ipconfig used
together. It doesn't make any sense to use them separately right now,
anyway. 
	<b
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.kernel.org
More majordomo info at  
http://vger.kernel.org/majordomo-info.html
Please read the FAQ at  
http://www.tux.org/lkml/