Date: Fri, 2 May 2003 14:09:41 -0400
From: Ben Collins <>
Subject: Re: [PATCH] alternative compat_ioctl table implementation
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2003/5/2/132

On Fri, May 02, 2003 at 07:59:02PM +0200, Arnd Bergmann wrote:
> I had some trouble making the 2.5.68bk implementation
> for compat_ioctl work on s390x because of a cross-compiling
> bug in gcc-2.95.
> 
> This patch changes the way that the translation table
> is generated and solves the problem by replacing
> the assembler magic with linker magic.
> 
> As a side effect, it adds type-checking for the handler
> functions and makes it possible to put COMPATIBLE_IOCTL()
> in places other than arch/*/kernel/ioctl32.c, e.g. next
> to the normal ioctl handler.
> 
> This needs the compat-ioctl-fix.patch from 2.5.68mm4.
>
You macros don't work for things like this:
COMPATIBLE_IOCTL(_IOW('v',  BASE_VIDIOCPRIVATE+0, char [256]))
COMPATIBLE_IOCTL(_IOR('v',  BASE_VIDIOCPRIVATE+1, char [256]))
...which are in compat_ioctl.h.
--
Debian     - 
http://www.debian.org/
Linux 1394 - 
http://www.linux1394.org/
Subversion - 
http://subversion.tigris.org/
Deqo       - 
http://www.deqo.com/
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.kernel.org
More majordomo info at  
http://vger.kernel.org/majordomo-info.html
Please read the FAQ at  
http://www.tux.org/lkml/