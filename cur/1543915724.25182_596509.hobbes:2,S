Date: Wed, 19 Sep 2007 17:06:04 -0700
From: Andrew Morton <>
Subject: Re: 2.6.23-rc6-mm1
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2007/9/19/470

On Wed, 19 Sep 2007 16:44:48 -0700
David Brownell <david-b@pacbell.net> wrote:
> > > <4>[   21.211942] Duplicate file names "rtc" detected
> >
> > Nah, that's an rtc-specific problem.
> 
> RTC-related ... but it's a procfs bug, since it's procfs which doesn't
> even bother to check for duplicate names before it registers files.
So you keep on claiming, but I don't think I've yet seen a description of
the *reason* why two copies of this file are being created, and a
description of why that is an OK thing for the kernel to be doing.
> > From: Chuck Ebbert <cebbert@redhat.com>
> >
> > AFAICT the rtc problem is caused by misconfiguration: both the new
> > and old rtc driver have been built and they are both trying to load.
> 
> That _shouldn't_ be a problem at all; only one of them should be
> able to bind to that hardware.
> 
> The only problem I see in these messages is that procfs bug.
> 
It's not obvious that this is only a procfs bug.  If some part of the
kernel tries to add a procfs file which is already there, that's often a
bug in the caller.
Yes, procfs should have been checking for this.  But it is too late now for
us to just fail out of the procfs registration code.  Because this can
cause previously buggy-but-works-ok code to now fail completely.
So I think the best we can do now is to retain the runtime warning and to
continue to "succeed" and to identify all the problematic codesites and to
either fix them or to convince ourselves that they really are working as
intended. 
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.kernel.org
More majordomo info at  
http://vger.kernel.org/majordomo-info.html
Please read the FAQ at  
http://www.tux.org/lkml/