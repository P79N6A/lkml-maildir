Date: Thu, 2 Mar 2006 20:33:04 +0100
From: Andi Kleen <>
Subject: Re: 2.6.16rc5 'found' an extra CPU.
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2006/3/2/224

On Thursday 02 March 2006 20:26, Brown, Len wrote:
> Dave,
> Your DSDT looks fine.
> I was wrong assuming there were 3 Processor entries there.
> 
> > > Did you really build a 256-CPU SMP kernel or is ACPI 
> > > ignoring CONFIG_NR_CPUS or something?
> >
> >Yes, it's =256.
> 
> I expect this is the root problem.
It's useless anyways because the x86 apics cannot handle more than
255. Best fix is probably just the appended one. Does that fix the
issue?
i386 already had it correct BTW.
-Andi
Limit max number of CPUs to 255 
Because 256 causes overflows in some code that stores them in 8 bit
fields and the x86 APIC architecture cannot handle more than 255
anyways.
Signed-off-by: Andi Kleen <ak@suse.de>
Index: linux/arch/x86_64/Kconfig
===================================================================
--- linux.orig/arch/x86_64/Kconfig
+++ linux/arch/x86_64/Kconfig
@@ -323,7 +323,7 @@ config HAVE_ARCH_EARLY_PFN_TO_NID
 
 config NR_CPUS
 	int "Maximum number of CPUs (2-256)"
-	range 2 256
+	range 2 255
 	depends on SMP
 	default "8"
 	help
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.kernel.org
More majordomo info at  
http://vger.kernel.org/majordomo-info.html
Please read the FAQ at  
http://www.tux.org/lkml/