Date: Sat, 10 Nov 2007 12:18:50 +0000
From: David Howells <>
Subject: Re: [PATCH 5/6] MN10300: Add the MN10300/AM33 architecture to the kernel [try #5]
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2007/11/10/42

Andrew Morton <akpm@linux-foundation.org> wrote:
> ho hum, I've seen worse-looking code ;).  There's quite a bit of the usual
> stuff in there: use of SPIN_LOCK_UNLOCKED, a forest of fishy-looking
> volatiles
The vast majority of which are either memory-mapped hardware registers or
interrupt-routine-filled ring buffers.
> but I don't need to sit here and emulate checkpatch.pl.
No, it should be deleted:
	shred -fu scripts/checkpatch.pl
will do the trick quite nicely.
| WARNING: do not add new typedefs
| #27265: FILE: include/asm-mn10300/types.h:30:
| +typedef unsigned int __u32;
Pah!
| #29191: FILE: include/asm-mn10300/user.h:50:
| +#define HOST_TEXT_START_ADDR +(u.start_code)
|                               ^
|
| ERROR: need consistent spacing around '+' (ctx:WxV)
Doesn't checkpatch know a unary plus when it sees one?
In this particular case this is so this macro can be used in assembly without
causing problems there.  Without the plus, the assembler thinks it has to
treat the (xxx) as a memory access, with the plus it thinks +(xxx) is an
immediate operand.  Unfortunately, whoever set up MN10300 assembly didn't
include an immediate-operand marker.
Furthermore, the program also puts out the line references for its error
messages in a non-standard format, thus preventing things like emacs's
compilation mode from being able to step through them.
	#1269: FILE: arch/mn10300/boot/compressed/head.S:38:
Should be:
	arch/mn10300/boot/compressed/head.S:38:
Yes, I know there's a --emacs flag, but that only affects references into the
patch, not references into the files the patch refers to.
> I googled a bit but most of the mn10300 info pertains to linux kernel and
> gcc.  Who is using this CPU and in what applications?
This CPU is MEI/Matsushita/Panasonic's own CPU.  If you've bought a Panasonic
telly, say, in the last few years, the odds are rather good that it's got one
of these CPUs in it running Linux.
	
http://www.am-linux.jp/
has a couple of examples on it's front page.  If you work through the menus of
modern Panasonic tellies, you might find a URL pointing somewhere on this
website that isn't reachable by linking from the index page of the website.
I don't know who else uses this CPU, but it's possible MEI sell them to other
companies.
David
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.kernel.org
More majordomo info at  
http://vger.kernel.org/majordomo-info.html
Please read the FAQ at  
http://www.tux.org/lkml/