Date: Wed, 2 Mar 2005 17:30:03 -0600
From: Linas Vepstas <>
Subject: Re: [PATCH/RFC] I/O-check interface for driver's error handling
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2005/3/2/291

On Thu, Mar 03, 2005 at 09:41:43AM +1100, Benjamin Herrenschmidt was heard to remark:
> On Wed, 2005-03-02 at 12:22 -0600, Linas Vepstas wrote:
> > On Tue, Mar 01, 2005 at 08:49:45AM -0800, Linus Torvalds was heard to remark:
> > > 
> > > The new API is what _allows_ a driver to care. It doesn't handle DMA, but
> > > I think that's because nobody knows how to handle it (ie it's probably
> > > hw-dependent and all existign implementations would thus be
> > > driver-specific anyway).
> > 
> > ?  
> > We could add a call 
> > 
> > int pci_was_there_an_error_during_dma (struct pci_dev);
> > 
> > right?  And it could return true/false, right?  I can certainly 
> > do that today with ppc64.  I just can't tell you which dma triggered
> > the problem.
> 
> That's ugly. I prefer asynchronous notification by far.
Well, we've got that, I think the goal was to figure out what the
PCI-Express folks think they need, and what the dev driver folks want.
Put it another way: a device driver author should have the opportunity
to poll the pci bus status if they so desire.  Polling for bus status
on ppc64 is real easy.  Given what Jesse Barnes was saying, it sounded
like a simple (optional, the dev driver doesn't have to use it) poll 
is not enough, because some errors might be transactional.
--linas
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.kernel.org
More majordomo info at  
http://vger.kernel.org/majordomo-info.html
Please read the FAQ at  
http://www.tux.org/lkml/