Date: Tue, 26 Oct 2004 13:41:32 -0700
From: Tom Rini <>
Subject: Re: [PATCH 2.6.9] kbuild warning fixes on Solaris 9
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2004/10/26/247

On Wed, Oct 27, 2004 at 12:14:08AM +0200, Sam Ravnborg wrote:
> On Mon, Oct 25, 2004 at 03:49:07PM -0700, Tom Rini wrote:
> > The following set of patches is based loosely on the patches that
> > Jean-Christophe Dubois came up with for 2.6.7.  Where as the original
> > patches added a number of casts to unsigned char, I went the route of
> > making the chars be explicitly signed.  I honestly don't know which
> > route is better to go down.  Doing this is the bulk of the patch.  Out
> > of the rest of the odds 'n ends is that on Solaris, Elf32_Word is a
> > ulong, which means all of the printf's are unhappy (uint format, ulong
> > arg) for most of the typedefs.
> > 
> > Signed-off-by: Tom Rini <trini@kernel.crashing.org>
> > 
> > Comments?  Beatings?  Thanks.
> 
> Looks much better. Applied.
Great.  A coworker of mine give them a look-over and spotted a few
places where I missed changing some casts.
Signed-off-by: Tom Rini <trini@kernel.crashing.org>
--- linux-2.6.9/scripts/basic/fixdep.c
+++ linux-2.6.9/scripts/basic/fixdep.c
@@ -225,10 +225,10 @@
 	signed char *p, *q;
 
 	for (; m < end; m++) {
-		if (*m == INT_CONF) { p = (char *) m  ; goto conf; }
-		if (*m == INT_ONFI) { p = (char *) m-1; goto conf; }
-		if (*m == INT_NFIG) { p = (char *) m-2; goto conf; }
-		if (*m == INT_FIG_) { p = (char *) m-3; goto conf; }
+		if (*m == INT_CONF) { p = (signed char *) m  ; goto conf; }
+		if (*m == INT_ONFI) { p = (signed char *) m-1; goto conf; }
+		if (*m == INT_NFIG) { p = (signed char *) m-2; goto conf; }
+		if (*m == INT_FIG_) { p = (signed char *) m-3; goto conf; }
 		continue;
 	conf:
 		if (p > map + len - 7)
--- linux-2.6.9/scripts/mod/modpost.c
+++ linux-2.6.9/scripts/mod/modpost.c
@@ -215,7 +215,7 @@
 	static char line[4096];
 	int skip = 1;
 	size_t len = 0;
-	signed char *p = (char *)file + *pos;
+	signed char *p = (signed char *)file + *pos;
 	char *s = line;
 
 	for (; *pos < size ; (*pos)++)
-- 
Tom Rini
http://gate.crashing.org/~trini/
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.kernel.org
More majordomo info at  
http://vger.kernel.org/majordomo-info.html
Please read the FAQ at  
http://www.tux.org/lkml/