Date: Thu, 14 Sep 2000 01:36:39 +0200 (CEST)
From: Bartlomiej Zolnierkiewicz <>
Subject: [PATCH][minor] Re: [patch] VIA IDE driver v2.3
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2000/9/13/201

On Tue, 12 Sep 2000, Vojtech Pavlik wrote:
> Anyone interested, please test this out, if it is as problemless as
> version 2.1, I'll send this to Linus for inclusion in the kernel.
Seems to be ok. Works ok. Please consider appling *crappy* patch
which corrects one entry in /proc/ide/via and beautifies code :-)
--
Bartlomiej Zolnierkiewicz
<bkz@linux-ide.org>
--- via82cxxx.c	Wed Sep 13 19:21:29 2000
+++ via82cxxx.c	Wed Sep 13 19:27:16 2000
@@ -226,9 +226,9 @@
 	via_print("Post Write Buffer:     %10s%20s", (t & 0x40) ? "on" : "off", (t & 0x10) ? "on" : "off" );
 
 	pci_read_config_byte(dev, VIA_FIFO_CONFIG, &t);
-	via_print("FIFO size:             %10d%20d", 16 - (((t >> 5) & 1) + ((t >> 6) & 1)) * 8,
+	via_print("FIFO Size:             %10d%20d", 16 - (((t >> 5) & 1) + ((t >> 6) & 1)) * 8,
 							  (((t >> 5) & 1) + ((t >> 6) & 1)) * 8);
-	via_print("Threshold Prim.:       %10s%20s", via_fifo[(t >> 2) & 3], via_fifo[t & 3]);
+	via_print("FIFO Threshold:        %10s%20s", via_fifo[(t >> 2) & 3], via_fifo[t & 3]);
 
 	pci_read_config_word(dev, VIA_PRI_SECTOR_SIZE, &size0);
 	pci_read_config_word(dev, VIA_SEC_SECTOR_SIZE, &size1);
@@ -412,9 +412,9 @@
 		config_chipset_for_pio(drive);
 		return;
 	}
-	
+
 	if (pio > 5) pio = 5;
-	
+
 	via_set_speed(drive, XFER_PIO_0 + pio);
 }
 
@@ -437,7 +437,7 @@
 		(id->dma_1word & 0x0004) ? XFER_SW_DMA_2 :
 		(id->dma_1word & 0x0002) ? XFER_SW_DMA_1 :
 		(id->dma_1word & 0x0001) ? XFER_SW_DMA_0 : 0;
-		
+
 	if (!speed) return (int) ide_dma_off_quietly;
 
 	via_set_speed(drive, speed);
@@ -579,7 +579,7 @@
  * Register /proc/ide/via entry
  */
 
-#if defined(CONFIG_PROC_FS)
+#ifdef CONFIG_PROC_FS
 	if (!via_proc) {
 		via_proc = 1;
 		bmide_dev = dev;