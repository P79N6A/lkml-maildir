Date: Thu, 11 Jan 2007 09:32:41 +1100
From: Nick Piggin <>
Subject: Re: [PATCH 0/4] Improve swap page error handling
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2007/1/10/175

Richard Purdie wrote:
>>No, not this way, I'm afraid.  Sorry, I don't remember the prior
>>discussion on LKML, must have flooded past when my attention was
>>elsewhere.
> 
> 
> I think you were cc'd on some of it but you never commented. Anyhow,
> I've reworked this patch series based on your comments. The hints were
> appreciated, thanks. This was the way I'd originally hoped to be able to
> work things, I just couldn't find the right way to do it.
IMO it seems a bit complex for so small a benefit. Last time I was
working on this, I thought it would be almost as good to do something
simple like stop trying to write out the page if PG_error is set (and
clear that bit in delete_from_swap_cache or try_to_unusesomewhere).
This way the admin could swapoff and scan the swap device at some
point.
>>Is it worth doing this at all?  Probably, but I've no experience
>>whatsoever of swap write errors, so it's hard for me to judge: my
>>guess is that many cases would turn out to be software errors (e.g.
>>lower level needing more memory to perform the write).  But you'd
>>be right to counter: let's assume they're hardware errors, and
>>then fix up any software errors when reported.
> 
> 
> I have a swap block driver where hardware write errors are more likely
> and hence have a need to handle them more gracefully than IO loops. It
> seems like a good idea to avoid the IO loops anyway.
> 
> 
>>If it is worth doing this, then you'll need to add code to write
>>back the swap header, to note the bad pages permanently: you may
>>well have been waiting to see what reception the patches so far
>>get, before embarking on that.
> 
> 
> You can't proceed to do that until you're able to identify the bad pages
> so this would be a necessary first step towards that, yes.
Agreed here, FWIW. I think that might be just as well done in
userspace?
Nick
-- 
SUSE Labs, Novell Inc.
Send instant messages to your online friends 
http://au.messenger.yahoo.com
 
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.kernel.org
More majordomo info at  
http://vger.kernel.org/majordomo-info.html
Please read the FAQ at  
http://www.tux.org/lkml/