Date: Wed, 1 Mar 2000 23:04:43 -0500 (EST)
From: David Waite <>
Subject: RE: [PATCH] trivial little Makefile patch (2.3.49-2)
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2000/3/2/9

Yes, the removal would work, the main reason for it was just duplicated
effort-  sorting once with ls and once with sort. ls -U actually does
give different output than ls on my system.
However this is all mute - ls sans the  -U probably gives no quicker of a
response, gives the same response after piping through sort, and should be
removed if non-GNU versions of 'ls' don't support the option.
In my humble, not-subscribed-to-linux-kernel-list opinion, of course :)
-David Waite
On Wed, 1 Mar 2000, Dunlap, Randy wrote:
> This was added 1/6/2k with the following comments:
> 
> <quote from David Waite (mass@ufl.edu)>:
> I do not know if this is usb-related as much as l-k related, but this is a
> patch to fix 'make modules_install'. The order that 'sort' spits out files
> is not the same as the order of the files when you do a normal 'ls'
> (sorting by name). 
> 
> As result, the lists get desynced, and you get duplicate modules in misc
> and other groups (in this example, usb.. usbcore.o has been in $MODLIB/usb
> and $MODLIB/misc forever, because of the usb-* entries before it in the
> list.)
> </quote>
> 
> Is there another solution?  (Rhetorical; sure there is.)
> 
> ~Randy     [Mastodons are history.]
> ___________________________________________________
> |Randy Dunlap     Intel Corp., DAL    Sr. SW Engr.|
> |randy.dunlap.at.intel.com            503-696-2055|
> |NOTE:  Any views presented here are mine alone   |
> |and may not represent the views of my employer.  |
> |_________________________________________________|
> 
> > -----Original Message-----
> > From: orc@pell.portland.or.us [mailto:orc@pell.portland.or.us]
> > Sent: Wednesday, March 01, 2000 9:46 AM
> > To: linux-kernel@vger.rutgers.edu
> > Subject: [PATCH] trivial little Makefile patch (2.3.49-2)
> > 
> > 
> > 
> > make modules_install does ls -U;  This doesn't work too well 
> > on systems
> > that have Berkeley ls installed.  Since -U just means ``do not sort'',
> > this little patch takes it away and lets me continue to build 
> > 2.3 kernels
> > on my Mastodon machines.
> > 
> >                   ____
> >     david parsons \bi/ Keeping the GNUisms to gcc and bash is better.
> >                    \/
> > 
> > 
> > --- linux-2.3.49-2/Makefile.orig	Wed Mar  1 09:33:31 2000
> > +++ linux-2.3.49-2/Makefile	Wed Mar  1 09:34:19 2000
> > @@ -413,7 +413,7 @@
> >  	if [ -f PCMCIA_CHAR_MODULES ]; then inst_mod 
> > PCMCIA_CHAR_MODULES pcmcia; fi; \
> >  	if [ -f PCMCIA_SCSI_MODULES ]; then inst_mod 
> > PCMCIA_SCSI_MODULES pcmcia; fi; \
> >  	\
> > -	ls -1 -U *.o | sort > $$MODLIB/.allmods; \
> > +	ls -1 *.o | sort > $$MODLIB/.allmods; \
> >  	echo $$MODULES | tr ' ' '\n' | sort | comm -23 
> > $$MODLIB/.allmods - > $$MODLIB/.misc; \
> >  	if [ -s $$MODLIB/.misc ]; then inst_mod $$MODLIB/.misc 
> > misc; fi; \
> >  	rm -f $$MODLIB/.misc $$MODLIB/.allmods; \
> 
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.rutgers.edu
Please read the FAQ at 
http://www.tux.org/lkml/