Date: Tue, 27 May 2003 15:04:21 +0200
From: Florian Lohoff <>
Subject: [2.5.69/i386] rmmod ohci_hcd - deadlock
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2003/5/27/116

Hi,
i am seeing a deadlock on removal of the ohci_hcd module. You get to see
some usb disconnect messages after which the machine is dead and needs
to be powercycled. This is a Sony Vaio C1MHP. I am unable to test 2.5.70
because it hangs on boot with unhandled IRQs.
This also happens when unloading the usb-storage module beforehand.
00:14.0 USB Controller: Acer Laboratories Inc. [ALi] M5237 USB (rev 03) (prog-if 10 [OHCI])
	Subsystem: Sony Corporation: Unknown device 80ec
	Control: I/O+ Mem+ BusMaster+ SpecCycle- MemWINV+ VGASnoop- ParErr- Stepping- SERR- FastB2B-
	Status: Cap+ 66Mhz- UDF- FastB2B+ ParErr- DEVSEL=medium >TAbort- <TAbort- <MAbort- >SERR- <PERR-
	Latency: 64 (20000ns max), cache line size 08
	Interrupt: pin A routed to IRQ 9
	Region 0: Memory at 000e0000 (32-bit, non-prefetchable) [size=4K]
	Capabilities: [60] Power Management version 2
		Flags: PMEClk- DSI- D1- D2- AuxCurrent=0mA PME(D0-,D1-,D2-,D3hot-,D3cold-)
		Status: D0 PME-Enable- DSel=0 DScale=0 PME-
lsusb:
Module                  Size  Used by
8139too                14336  1 
mii                     2528  1 8139too
crc32                   2944  1 8139too
snd_ali5451            12004  0 
snd_ac97_codec         32900  1 snd_ali5451
snd_pcm                53568  1 snd_ali5451
snd_page_alloc          3876  1 snd_pcm
snd_timer              13152  1 snd_pcm
snd                    27904  4 snd_ali5451,snd_ac97_codec,snd_pcm,snd_timer
soundcore               3680  1 snd
usb_storage            19232  0 
scsi_mod               73132  1 usb_storage
ohci_hcd               11680  0 
usbcore                65332  4 usb_storage,ohci_hcd
ohci1394               22720  0 
ieee1394               42376  1 ohci1394
lsusb:
Bus 002 Device 001: ID 0000:0000  
Bus 001 Device 002: ID 054c:0069 Sony Corp. Memorystick MSC-U03 Reader
Bus 001 Device 001: ID 0000:0000  
Flo
-- 
Florian Lohoff                  flo@rfc822.org             +49-5201-669912
                        Heisenberg may have been here.
[unhandled content-type:application/pgp-signature]