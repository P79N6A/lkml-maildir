Date: Mon, 03 Mar 2003 04:58:19 -0500 (EST)
From: Pavel Roskin <>
Subject: Re: [PATCH] mkdep patch in 2.4.21-pre4-ac7 breaks pci/drivers
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2003/3/3/24

Hello!
> This patch has been tested and works for me.  How to test:
I'm terribly sorry, my testing was incorrect (I was looking at a wrong
window).  One more change needs to be done.  Since name.o becomes the
first rule, it becomes the default rule instead of driver.o, which is not
created.
The trick (already used in drivers/net/hamradio/soundmodem/Makefile) is to
define the first rule as
all: all_targets
Fixed patch:
===================================
--- linux.orig/drivers/pci/Makefile
+++ linux/drivers/pci/Makefile
@@ -35,10 +35,11 @@
 obj-y += syscall.o
 endif
-include $(TOPDIR)/Rules.make
-
+all: all_targets
 names.o: names.c devlist.h classlist.h
+include $(TOPDIR)/Rules.make
+
 devlist.h classlist.h: pci.ids gen-devlist
 	./gen-devlist <pci.ids
===================================
This patch was tested all the way to "make install" and reboot.
-- 
Regards,
Pavel Roskin
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.kernel.org
More majordomo info at  
http://vger.kernel.org/majordomo-info.html
Please read the FAQ at  
http://www.tux.org/lkml/