Date: 20 Mar 1999 16:21:58 -0000
From: Robert Woodcock <>
Subject: Re: Got it! SG select() bug evidence for 2.2.2
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/1999/3/20/49

Monty wrote:
>I'll say this first because I know most won't read much of this...:
>
>If you've seen the following output from cdparanoia, MAIL ME!!:
>
>"SCSI transport: writeable when reading packet"
>
>The above message indicates you've probably tripped a kernel bug that
>shows up only very rarely, and I need to know more about that bug!
I haven't seen that in particular but I get another problem with 2.2.[03] and
cdparanoia (doesn't seem to affect 2.2.[03] and cdda2wav or 2.0.x and
cdparanoia) - cdparanoia hangs when it tries to read the track:
frantica:/tmp/test$ cdparanoia -B
cdparanoia III alpha prerelease 9.4 (December 16, 1998)
(C) 1998 Monty <xiphmont@mit.edu>
This is PRERELEASE software!  Report bugs to xiphmont@mit.edu
http://www.mit.edu/afs/sipb/user/xiphmont/cdparanoia/index.html
Detected scsi CD-ROM sr0 at scsi0, channel 0, id 2, lun 0
Detected scsi CD-ROM sr1 at scsi0, channel 0, id 4, lun 0
sr0: scsi3-mmc drive: 6x/6x writer cd/rw xa/form2 cdda tray
Ripping from sector       0 (track  0 [0:00.00])
          to sector  228876 (track 13 [2:20.44])
outputting to track00.cdda.wav
[nothing after this]
Hardware is an Asus SC-875 (ncr53c8xx) SCSI card with a Yamaha CRW2260 CDRW
drive. SCSI disk support is compiled in, SCSI cdrom and generic support is
modularized.
Here's an strace:
select(5, [4], [4], [4], {15, 0})       = 1 (in [4], left {15, 0})
read(4, "T\t\0\0T\t\0\0\0\0\0\0\0\0\0\0\1"..., 2388) = 2388
rt_sigprocmask(SIG_UNBLOCK, [INT PIPE TERM PROF], NULL, 3221221048) = 0
select(5, [4], NULL, NULL, {0, 0})      = 0 (Timeout)
select(5, NULL, [4], NULL, {5, 0})      = 1 (out [4], left {5, 0})
rt_sigprocmask(SIG_BLOCK, [INT PIPE TERM PROF], NULL, 3221222020) = 0
write(4, "T\t\0\0004\370\0\0\0\0\0\0\0\0\0"..., 63552) = -1 ENOMEM (Cannot allocate memory)
[it loops with the ENOMEM error until I kill it]
Is this a memory fragmentation issue or something? Running a memory
grabber (like memsize from lmbench) doesn't seem to help - I have
128MB.
Also, this only seems to happen after about 3-5 days of uptime.
-- 
Robert Woodcock - rcw@debian.org
"I never knew manipulating the masses was so easy." -jt
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.rutgers.edu
Please read the FAQ at 
http://www.tux.org/lkml/