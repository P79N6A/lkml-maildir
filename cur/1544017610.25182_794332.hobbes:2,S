Date: Mon, 19 Jan 2009 13:53:16 +0200
From: Avi Kivity <>
Subject: Re: [GIT PULL -tip v3] fix 39 'make headers_check' warnings
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2009/1/19/97

Sam Ravnborg wrote:
>> They are.  This bits advertise to userspace what features kvm supports, 
>> both compile- and run-time.
>> 
>
> This is wrong...
> The headers does not change with the kernel configuration and advertising the
> kvm features via a .h file like this is simply plain broken.
> 
Ok.  Don't know why I thought unifdef was supplied with the full 
configuration.
> You cannot assume that the header files are generated with the exact same config
> as used by the running kernel.
> 
This is just for arch specific defines.  I'll move these to asm/kvm.h.
> And userspace has in no way access to the CONFIG_ namespace which is purely kernel-internal.
>
> I cannot see how you have ever seen kcm advertise that for example KVM_CAP_USER_NMI
> equals to 22 because CONFIG_X86 is never (supposed to be) defined in userspace -
> except if you did so yourself by some means.
> 
We did, we ship a hacked-up kvm.h (generated by unifdef) with our userspace.
Thanks for the clarifications, helpful as always.
-- 
error compiling committee.c: too many arguments to function