Date: Wed, 01 Dec 2004 21:26:19 +0100
From: matthieu castet <>
Subject: [ACPI] Re: Fw: ACPI bug causes cd-rom lock-ups (2.6.10-rc2)
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2004/12/1/200

 >+/*
 >+ * We'd like PNP to call this routine for the
 >+ * single ISA_USED value for each legacy device.
 >+ * But instead it calls us with each POSSIBLE setting.
 >+ * There is no ISA_POSSIBLE weight, so we simply use
 >+ * the (small) PCI_USING penalty.
 >+ */
Couldn't be better to change the pnp core behaviour ?
In drivers/pnp/resource.c, pnp_register_irq_resource, instead of calling 
pcibios_penalize_isa_irq couldn't we call something like 
pcibios_penalize_possible_isa_irq ?
The pnp implemations already use pcibios_penalize_isa_irq [1] for the 
irq that are used.
So it seem it is call 2 times for the allocated resources...
Also don't we need to depenalize the irq, if we change the irq or 
disable the device ?
Matthieu CASTET
[1]
$grep -r penalize */*
pnpacpi/rsparser.c: 
pcibios_penalize_isa_irq(res->data.irq.interrupts[0]);
pnpacpi/rsparser.c: 
pcibios_penalize_isa_irq(res->data.extended_irq.interrupts[0]);
pnpbios/rsparser.c:             pcibios_penalize_isa_irq(irq);
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.kernel.org
More majordomo info at  
http://vger.kernel.org/majordomo-info.html
Please read the FAQ at  
http://www.tux.org/lkml/