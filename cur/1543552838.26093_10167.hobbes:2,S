Date: Sat, 28 Oct 2000 20:02:44 +0000
From: (Heinz J. Mauelshagen)
Subject: Re: LVM snapshotting broken?
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2000/10/28/45

On Fri, Oct 27, 2000 at 11:55:03AM -0200, Rik van Riel wrote:
> On Fri, 27 Oct 2000, Andrea Arcangeli wrote:
> > On Fri, Oct 27, 2000 at 11:32:06AM -0200, Rik van Riel wrote:
> > > Have you checked if the CONTENT of the snapshot is indeed
> > > the right LV and not the other one?
> > 
> > laser:~ # mke2fs /dev/vg1/lv1 &>/dev/null
> > laser:~ # mount /dev/vg1/lv1 /mnt
> > laser:~ # >/mnt/ciao
> > laser:~ # ls /mnt
> > .  ..  ciao  lost+found
> > laser:~ # umount /mnt
> > laser:~ # lvcreate -s -n lv1-snap /dev/vg1/lv1 -L 400M
> > lvcreate -- INFO: using default snapshot chunk size of 64 KB
> > lvcreate -- doing automatic backup of "vg1"
> > lvcreate -- logical volume "/dev/vg1/lv1-snap" successfully created
> > 
> > laser:~ # mount /dev/vg1/lv1 /mnt
> > laser:~ # rm /mnt/ciao
> > laser:~ # umount /mnt
> > laser:~ # mount /dev/vg1/lv1-snap /mnt
> > mount: block device /dev/vg1/lv1-snap is write-protected, mounting read-only
> > laser:~ # ls /mnt/
> > .  ..  ciao  lost+found
> > laser:~ # 
> 
> OK, good. I guess that means that the lvmutils (even the
> patched version in the RPM) are heavily broken ...
As i mentioned before: i wasn't able to reproduce your problem on any of
my systems. It work just fine with 0.8final and in 0.9 as weel.
Did anybody else beside Rik face a problem with snapshots _not_ referring
to the original logical volume they where created for?
> 
> Andrea, could you send me the patches you use to make your
> LVM utilities work? Then we'll be able to put together at
> least one working LVM utilities version ;)
> 
> Heinz, how about releasing a 0.8.1 version of the utilities
> so that there is something WORKING out there? Not having
> working LVM utilities available is an utter disgrace when
> all the code to make it work is just available...
I don't have any complaints so far about similar snapshot malfunctions
you mentioned, Rik.
That said it is overemphasis to say, that the LVM utilities
are not working.
IMHO Andreas Dilger's LVM 0.8 backport to kernel 2.2 should be o.k. for
most of the cases.
I'ld like to have 0.9 to do the integtration of the available patches
which will be released in november.
> 
> regards,
> 
> Rik
> --
> "What you're running that piece of shit Gnome?!?!"
>        -- Miguel de Icaza, UKUUG 2000
> 
> 
http://www.conectiva.com/
		
http://www.surriel.com/
-- 
Regards,
Heinz      -- The LVM guy --
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
Heinz Mauelshagen                                 Sistina Software Inc.
Senior Consultant/Developer                       Bartningstr. 12
                                                  64289 Darmstadt
                                                  Germany
Mauelshagen@Sistina.com                           +49 6151 7103 86
                                                       FAX 7103 96
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.kernel.org
Please read the FAQ at 
http://www.tux.org/lkml/