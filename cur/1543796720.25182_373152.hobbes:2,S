Date: Mon, 05 Dec 2005 19:48:19 -0500
From: Trond Myklebust <>
Subject: Re: nfs unhappiness with memory pressure
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2005/12/5/336

On Tue, 2005-12-06 at 10:40 +1100, Nick Piggin wrote:
> > ...and most important of all: 'unstable' does _not_ mean that I/O is
> > active on those pages (unlike the apparent assumption in
> > vm_throttle_write.
> > That is why the choice is either to kick pdflush there, or to remove
> > nr_unstable from the accounting in that loop.
> > 
> 
> Doesn't matter if IO is actually active or not, if you've allocated
> memory for these unstable pages, then page reclaim can scan itself
> to death, which is what seems to have happened here. And which is
> what vm_throttle_write is supposed to help.
Unless someone somehow triggers an NFS commit, then nr_unstable is not
ever going to decrease, and your process will end up looping forever. In
fact, those nr_writeback that refer to NFS pages, will end up being
added to nr_unstable (because they have been written to the server, but
not committed to disk).
Cheers,
  Trond
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.kernel.org
More majordomo info at  
http://vger.kernel.org/majordomo-info.html
Please read the FAQ at  
http://www.tux.org/lkml/