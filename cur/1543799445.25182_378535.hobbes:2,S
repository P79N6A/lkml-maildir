Date: Thu, 22 Dec 2005 12:33:00 -0200
From: Luiz Fernando Capitulino <>
Subject: Latest -git and -rc6 may not compile for i386.
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2005/12/22/124

 Hi Nick,
 This patch:
http://www.kernel.org/git/?p=linux/kernel/git/torvalds/linux-2.6.git;a=commitdiff_plain;h=53e86b91b7ae66d4c2757195cbd42e00d9199cf2;hp=dbdf65b1b7f8ec48bda1604cfea7ac09ce583d6b
 _Seems_ to break kernel compilation on i386 with the attached .config.
 I'm getting the following error in latest Linus tree and -rc6:
  CC      kernel/irq/handle.o
In file included from include/asm/fixmap.h:28,
                 from include/asm/smp.h:17,
                 from include/linux/irq.h:14,
                 from kernel/irq/handle.c:10:
include/asm/acpi.h: In function '__acpi_acquire_global_lock':
include/asm/acpi.h:67: error: 'boot_cpu_data' undeclared (first use in this function)
include/asm/acpi.h:67: error: (Each undeclared identifier is reported only once
include/asm/acpi.h:67: error: for each function it appears in.)
include/asm/acpi.h: In function '__acpi_release_global_lock':
include/asm/acpi.h:79: error: 'boot_cpu_data' undeclared (first use in this function)
make[2]: ** [kernel/irq/handle.o] Erro 1
make[1]: ** [kernel/irq] Erro 2
make: ** [kernel] Erro 2
 Didn't tryied to revert the patch, but compiled ok with 2.6.14 and
with latest Linus tree with this patch:
diff --git a/include/asm-i386/acpi.h b/include/asm-i386/acpi.h
index df4ed32..106c1ac 100644
--- a/include/asm-i386/acpi.h
+++ b/include/asm-i386/acpi.h
@@ -31,6 +31,7 @@
 #include <acpi/pdc_intel.h>
 
 #include <asm/system.h>		/* defines cmpxchg */
+#include <asm/processor.h>
 
 #define COMPILER_DEPENDENT_INT64   long long
 #define COMPILER_DEPENDENT_UINT64  unsigned long long
 But it's not right, of course, because any cmpxchg() usage will get the same
error.
(note: I'm 'playing' with the attached .config for a long time, I'll not
get surprised if it 'corrupted' something, due to my brain-damaged hacks..)
-- 
Luiz Fernando N. Capitulino
[unhandled content-type:application/octet-stream]