Date: Tue, 21 Sep 1999 16:25:41 -0700 (PDT)
From: Dean Gaudet <>
Subject: Re: Apache problem with 2.2.12 (network related)
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/1999/9/21/206

On Wed, 22 Sep 1999, Yann Doussot wrote:
> Thanks for you explanations. I have searched the Apache bug database and
> found a report very similar to my problem:
> 
> 
http://bugs.apache.org/index/full/4848
> 
> The interesting part of the report is that this user has the problem on
> several servers, but *not* on Sparc. 
FWIW, there are many more similar reports in the bugdb... it's been
reported on and off for a long time, but nobody has been able to give us
enough information to figure it out.
straces of the parent and children, with timestamps would be really
helpful (start the server with "strace -ff -o outprefix -t ./httpd",
or attach to a running server and send it a USR1 signal so it recycles
its children and then they'll all be running under strace...).
also, below is a message i sent to alan about this some time ago -- the
problem may or may not be the same between 2.0.x and 2.2.x.  maybe this
will ring some bells with other people... 
Dean
----
Are you familiar with any wait4() bug in 2.0.32 that would cause this?
this is a strace of apache's parent process:
time(NULL)                              = 909702870
wait4(-1, 0xbffffe64, WNOHANG, NULL)    = 0
select(0, NULL, NULL, NULL, {1, 0})     = 0 (Timeout)
time(NULL)                              = 909702871
fork()                                  = 26032
wait4(-1, [WIFEXITED(s) && WEXITSTATUS(s) == 0], WNOHANG, NULL) = 26032
--- SIGCHLD (Child exited) ---
wait4(-1, 0xbffffe64, WNOHANG, NULL)    = -1 ECHILD (No child processes)
select(0, NULL, NULL, NULL, {1, 0})     = 0 (Timeout)
time(NULL)                              = 909703113
Somehow 242 seconds passed between the two time() calls... the parent does
nothing cpu intensive, so I doubt it's that.  It's possible the guy's box
is swapping to hell... but we've got about a dozen similar reports.  The
reports are against 2.0.30, 2.0.32, and 2.0.33.
Oh then there's the odd SIGCHLD followed by ECHILD... there's a few other
instances of that -- SIGCHLDs happenning and wait4() not reporting
anything.
Ring any bells?
Dean
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.rutgers.edu
Please read the FAQ at 
http://www.tux.org/lkml/