Date: Thu, 15 Feb 2007 09:49:15 -0600
From: Corey Minyard <>
Subject: Re: [patch 4/4] ipmi: add new IPMI nmi watchdog handling
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2007/2/15/172

Andrew Morton wrote:
> On Thu, 15 Feb 2007 15:05:56 +1100 Paul Mackerras <paulus@samba.org> wrote:
>
> 
>> Andrew Morton writes:
>>
>> 
>>> This is all fairly unpleasant.
>>>
>>> What architecture is preventing us from using DIE_NMI_POST on all
>>> architectures which support ipmi?  ia64?
>>>
>>> It would be better to simply require that all ipmi-using architectures
>>> implement notify_die(DIE_NMI_POST, ...).
>>> 
>> We're starting to see IPMI creeping on powerpc as well, and we don't
>> have an NMI.
>> 
PowerPC could have an NMI, at least on many of the processors, if 
manufacturers would wire in the MCP line and use it as an NMI.
>> 
>
> Sure, but you could implement the registration function.  I mean, you
> _would_ call the NMI callback if you could, right ;)
>
> As it stands, this change is pretty gruesome...
> 
Yes, it's certainly not ideal.  Most architectures do not have 
asm/kdebug.h, which was the reason for CONFIG_HAVE_STANDARD_NOTIFY_DIE.  
I know there are IPMI implementations on x86, ia64, ARM, MIPS, and PowerPC.
So I see the following options besides what's already there:
1) add asm/kdebug.h and DIE_NMI_POST to everything that might have an 
IPMI implementation.
2) use CONFIG_X86 to tell if NMI will work, since that's the only thing 
it will work on at the present.
I don't have any way to know how different systems have implemented that 
feature, so I can't actually implement it for the various architectures 
(plus I don't have any of those boards).  So maybe #2 is the best?
-Corey
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.kernel.org
More majordomo info at  
http://vger.kernel.org/majordomo-info.html
Please read the FAQ at  
http://www.tux.org/lkml/