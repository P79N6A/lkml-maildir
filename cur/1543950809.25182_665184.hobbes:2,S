Date: Sat, 8 Mar 2008 09:24:38 +0800
From: Herbert Xu <>
Subject: Re: 2.6.25-rc[1,2]: failed to setup dm-crypt key mapping
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2008/3/7/383

On Fri, Mar 07, 2008 at 11:14:07AM -0700, Dan Williams wrote:
> 
> I believe this is in mainline as 76fc60a2 "[CRYPTO] skcipher: Move
> chainiv/seqiv into crypto_blkcipher module".  With a iop13xx_defconfig
>  I get:
> 
> `chainiv_module_exit' referenced in section `.init.text' of
> crypto/built-in.o: defined in discarded section `.exit.text' of
> crypto/built-in.o
> `chainiv_module_exit' referenced in section `__ksymtab_gpl' of
> crypto/built-in.o: defined in discarded section `.exit.text' of
> crypto/built-in.o
> `eseqiv_module_exit' referenced in section `__ksymtab_gpl' of
> crypto/built-in.o: defined in discarded section `.exit.text' of
> crypto/built-in.o
> make: *** [.tmp_vmlinux1] Error 1
Does this help?
Thanks,
-- 
Visit Openswan at 
http://www.openswan.org/
Email: Herbert Xu 许志壬 <herbert@gondor.apana.org.au>
Home Page: 
http://gondor.apana.org.au/herbert/
PGP Key: 
http://gondor.apana.org.au/herbert/pubkey.txt
--
diff --git a/crypto/chainiv.c b/crypto/chainiv.c
index 0a7cac6..a23e1ce 100644
--- a/crypto/chainiv.c
+++ b/crypto/chainiv.c
@@ -320,7 +320,7 @@ int __init chainiv_module_init(void)
 }
 EXPORT_SYMBOL_GPL(chainiv_module_init);
 
-void __exit chainiv_module_exit(void)
+void chainiv_module_exit(void)
 {
 	crypto_unregister_template(&chainiv_tmpl);
 }
diff --git a/include/crypto/internal/skcipher.h b/include/crypto/internal/skcipher.h
index a8f1264..ccc32ba 100644
--- a/include/crypto/internal/skcipher.h
+++ b/include/crypto/internal/skcipher.h
@@ -68,7 +68,7 @@ void skcipher_geniv_exit(struct crypto_tfm *tfm);
 int __init eseqiv_module_init(void);
 void __exit eseqiv_module_exit(void);
 int __init chainiv_module_init(void);
-void __exit chainiv_module_exit(void);
+void chainiv_module_exit(void);
 
 static inline struct crypto_ablkcipher *skcipher_geniv_cipher(
 	struct crypto_ablkcipher *geniv)