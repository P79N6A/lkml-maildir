Date: Wed,  8 Dec 1999 00:16:21 +0300 (MSK)
From: "Khimenko Victor" <>
Subject: Re: over 5Gb missing from a 13.5Gb disk
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/1999/12/7/134

In <384D749F.ABD3A01E@mcn.net> TimO (hairballmt@mcn.net) wrote:
 T> Guest section DW wrote:
>>
>> On Tue, Dec 07, 1999 at 09:07:49PM +0300, Khimenko Victor wrote:
>> >
>> > Huh ?
>> >
>> > -- cut --
>> > [root@localhost /root]# hdparm -i /dev/ide/hd/c0b0t0u0
>> >
>> > -- cut --
>> >
>> > As you can see RawCHS here is 26310/16/63 and all is working like a charm.
>> > As I have EXACTLY same model as Wichert (including FwRev and such) I'm pretty
>> > sure it's something in BIOS and/or recent kernel changes (I'm still using
>> > 2.2.10ac10)...
>>
>> You cheat yourself by using a hdparm/kernel combination that lies
>> to you. Try hdparm -I to see the truth.
>>
>> (Yes, in the good old days "hdparm -i" was useful. These days it gives
>> corrupted info, and one needs "hdparm -I".)
 T> Interesting...  I take it then that -i just reads the information from the
 T> drive firmware itself and -I gives what the kernel is actually using!?
No. -I reads the information from the drive and -i gives what the kernel is
using (it's written in `hdparm --help' BTW).
 T> I note that -i returns exactly the manufacturer's specs as written on the
 T> drive, even the suggested LBA c/h/s.  Why is it that -I returns the vendor
 T> information in BE byte pairs?
It's just how information is stored on disk actually :-) If -i gives you the
same information as in the manufacturesr's specs you are in luck. In fact
there are written RawCHS 16383/16/63 for ALL HDD's > 8GiB and then both
BIOS and Linux kernel should try to calculate "correct" CHS from LBAsects ...
If you are lucky both BIOS and Linux kernel will be able to do this and
they will agree => you have working HDD. If something goes wrong you are in
trouble and should tweak BIOS settings/Linux IDE settings till it'll work :-((
 T> spazz:~# hdparm -I /dev/hda
 T> /dev/hda:
 T>  Model=aMtxro9 51636U                          , FwRev=AV15R00F,
 T> SerialNo=6W90SNA8
 T>  Config={ Fixed }
 T>  RawCHS=16383/16/63, TrkSize=0, SectSize=0, ECCbytes=57
 T>  BuffType=3(DualPortCache), BuffSize=2048kB, MaxMultSect=16, MultSect=off
 T>  DblWordIO=no, maxPIO=2(fast), DMA=yes, maxDMA=0(slow)
 T>  CurCHS=65535/1/63, CurSects=4128705, LBA=yes
 T>  LBA CHS=1023/64/63 Remapping, LBA=yes, LBAsects=30000096
 T>  tDMA={min:120,rec:120}, DMA modes: mword0 mword1 *mword2
 T>  IORDY=on/off, tPIO={min:120,w/IORDY:120}, PIO modes: mode3 mode4
 T>  UDMA modes: mode0 mode1 mode2
 T> spazz:~# hdparm -i /dev/hda
 T> /dev/hda:
 T>  Model=Maxtor 91536U6, FwRev=VA510RF0, SerialNo=W609NS8A
 T>  Config={ Fixed }
 T>  RawCHS=29762/16/63, TrkSize=0, SectSize=0, ECCbytes=57
 T>  BuffType=3(DualPortCache), BuffSize=2048kB, MaxMultSect=16, MultSect=off
 T>  DblWordIO=no, maxPIO=2(fast), DMA=yes, maxDMA=0(slow)
 T>  CurCHS=29762/16/63, CurSects=30000096, LBA=yes
 T>  LBA CHS=930/512/63 Remapping, LBA=yes, LBAsects=30000096
 T>  tDMA={min:120,rec:120}, DMA modes: mword0 mword1 *mword2
 T>  IORDY=on/off, tPIO={min:120,w/IORDY:120}, PIO modes: mode3 mode4
 T>  UDMA modes: mode0 mode1 mode2
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.rutgers.edu
Please read the FAQ at 
http://www.tux.org/lkml/