Date: Tue, 11 Nov 2008 14:19:49 -0800
From: Andrew Morton <>
Subject: Re: [PATCH] hp-wmi: Fix warnings
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2008/11/11/385

On Sun, 02 Nov 2008 08:36:06 -0800
Larry Finger <Larry.Finger@lwfinger.net> wrote:
> Subject: [PATCH] hp-wmi: Fix warnings
A nit: the point of such a patch is _not_ to "fix warnings".  It is to
fix the issues which those warnings are warning us about!
I renamed the patch to "hp-wmi: handle rfkill_register() failure",
thanks.
> Compilation of the HP WMI hotkeys code results in the following:
> 
>   CC [M]  drivers/misc/hp-wmi.o
> drivers/misc/hp-wmi.c: In function hp_wmi_bios_setup:
> drivers/misc/hp-wmi.c:431: warning: ignoring return value of rfkill_register,
> 	 declared with attribute warn_unused_result
> drivers/misc/hp-wmi.c:441: warning: ignoring return value of rfkill_register,
> 	 declared with attribute warn_unused_result
> drivers/misc/hp-wmi.c:450: warning: ignoring return value of rfkill_register,
> 	 declared with attribute warn_unused_result
> 
> Signed-off-by: Larry Finger <Larry.Finger@lwfinger.net>
> ---
> 
> 
> Index: linux-2.6/drivers/misc/hp-wmi.c
> ===================================================================
> --- linux-2.6.orig/drivers/misc/hp-wmi.c
> +++ linux-2.6/drivers/misc/hp-wmi.c
> @@ -428,7 +428,9 @@ static int __init hp_wmi_bios_setup(stru
>  		wifi_rfkill->state = hp_wmi_wifi_state();
>  		wifi_rfkill->toggle_radio = hp_wmi_wifi_set;
>  		wifi_rfkill->user_claim_unsupported = 1;
> -		rfkill_register(wifi_rfkill);
> +		err = rfkill_register(wifi_rfkill);
> +		if (err)
> +			goto add_sysfs_error;