Date: Tue, 19 Feb 2002 06:08:04 -0800 (GMT-08:00)
From: "ALESSANDRO.SUARDI" <>
Subject: Re: gnome-terminal acts funny in recent 2.5 series
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2002/2/19/113

OGAWA Hirofumi wrote:
> 
> Alessandro Suardi <alessandro.suardi@oracle.com> writes:
> 
>> Running Ximian-latest for rh72/i386, latest 2.5 kernels (including
>>   2.5.4-pre2, 2.5.4, 2.5.5-pre1).
>> 
>> Symptom:
>>    - clicking on the panel icon for gnome-terminal shows a flicker
>>       of the terminal window coming up then the window disappears.
>>      No leftover processes.
[snip]
> Probably, this problem had occurred in libzvt which gnome-terminal 
> is using.
> 
> libzvt was using file descriptor passing via UNIX domain socket for
> pseudo terminal. Then because ->passcred was not initialized in
> sock_alloc(), unexpected credential data was passing to libzvt.
> 
> The following patch fixed this problem, but I'm not sure.
> Could you review the patch? (attached file are test program)
> 
> --- socket.c.orig     Mon Feb 11 18:21:59 2002
> +++ socket.c     Tue Feb 19 16:20:18 2002
> @@ -501,6 +501,8 @@ struct socket *sock_alloc(void)
>      sock->ops = NULL;
>      sock->sk = NULL;
>      sock->file = NULL;
> +//     init_waitqueue_head(&sock->wait);     this is needed?
> +     sock->passcred = 0;
> 
>      sockets_in_use[smp_processor_id()].counter++;
>      return sock;
Success on first attempt - thanks. Of course since this wasn't
 fully reproducable I'll assume the patch fixes the bug, unless
 proven wrong.
Thanks again,
--alessandro
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.kernel.org
More majordomo info at  
http://vger.kernel.org/majordomo-info.html
Please read the FAQ at  
http://www.tux.org/lkml/