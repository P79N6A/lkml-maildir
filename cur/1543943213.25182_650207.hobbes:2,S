Date: Fri, 08 Feb 2008 08:30:45 +0200
From: Pekka Enberg <>
Subject: Re: [PATCH 1/2] kmemcheck v3
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2008/2/8/23

Hi Christoph,
Christoph Lameter wrote:
> SLABs can be excepted from tracking?
Yes. __GFP_NOTRACK can be used to suppress tracking of objects (but we 
still take the page fault for each access). That is required for things 
like DMA filled pages that are never initialized by the CPU. 
SLAB_NOTRACK is for not tracking a whole *cache* so that we _don't_ take 
the page fault. This is needed for kmemcheck implementation (to avoid 
recursive page faults for memory accessed by the page fault handler).
> So it breaks recursion. But this adds a new cache that is rarely 
> used. There will be only about 50-100 kmem_cache objects in the system. I 
> thought you could control the tracking on an per object level? Would not a 
> kmalloc with __GFP_NOTRACK work?
No. We need to not track the whole page to avoid recursive faults. So 
for kmemcheck we absolutely do need cache_cache but we can, of course, 
hide that under a alloc_cache() function that only uses the extra cache 
when CONFIG_KMEMCHECK is enabled?