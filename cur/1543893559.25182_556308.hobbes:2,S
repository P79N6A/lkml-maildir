Date: Tue, 12 Jun 2007 09:29:41 +0200
From: "Jan Beulich" <>
Subject: [PATCH] modpost white list pattern adjustment
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2007/6/12/68

gcc puts data into .data.rel or .data.rel.* on some architectures (e.g.
ia64) or under certain conditions, so whatever is legal relative to
.data should also be legal for those other sections. Fixes a few
modpost warnings on ia64.
Signed-off-by: Jan Beulich <jbeulich@novell.com>
 scripts/mod/modpost.c |    6 ++++--
 1 files changed, 4 insertions(+), 2 deletions(-)
--- linux-2.6.22-rc4/scripts/mod/modpost.c	2007-06-11 18:10:54.000000000 +0200
+++ 2.6.22-rc4-modpost-data-rel/scripts/mod/modpost.c	2007-06-11 11:35:34.000000000 +0200
@@ -605,7 +605,7 @@ static int strrcmp(const char *s, const 
  *   warn here.
  *   the pattern is identified by:
  *   tosec   = .init.text | .exit.text | .init.data
- *   fromsec = .data
+ *   fromsec = .data | .data.rel | .data.rel.*
  *   atsym = *driver, *_template, *_sht, *_ops, *_probe, *probe_one, *_console
  *
  * Pattern 3:
@@ -692,7 +692,9 @@ static int secref_whitelist(const char *
 	    (strcmp(tosec, ".exit.text") != 0) &&
 	    (strcmp(tosec, ".init.data") != 0))
 		f2 = 0;
-	if (strcmp(fromsec, ".data") != 0)
+	if (strcmp(fromsec, ".data") != 0 &&
+	    strcmp(fromsec, ".data.rel") != 0 &&
+	    strncmp(fromsec, ".data.rel.", strlen(".data.rel.")) != 0)
 		f2 = 0;
 
 	for (s = pat2sym; *s; s++)
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.kernel.org
More majordomo info at  
http://vger.kernel.org/majordomo-info.html
Please read the FAQ at  
http://www.tux.org/lkml/