Date: Mon, 2 Aug 2004 12:18:21 +0300
From: Denis Vlasenko <>
Subject: Re: Bug in ethernet module b44.c (2.6.7)
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2004/8/2/42

On Monday 02 August 2004 12:02, Miroslav Zubcic wrote:
> I had problems with b44 module on 2.6.6 kernel, but this was resolved
> with patch from Pekka Pietikainen on this list, and later merged in
> 2.6.7 kernel. Thanks Pekka and Jeff.
>
> Meanwhile, I have discovered new bug in this module. When opening raw
> socket, network card will stop sending and receiveing packets.
>
> For example, if I start `nmap -v -sS 192.168.1.70'. nmap(1) freezes
> and waits forever. While nmap(1) is active (and trying to do it's
> job), I cannot do anything on the net. Existing ssh connections are
> freezed and unresponsive. If I interrupt nmap, everything comes back
> to normal after 1-2 seconds.
Provide strace of hung nmap.
> Only working mode for nmap(1) is: "nmap -v -sT -P0". This mode will
> not freeze broadcom ethernet card.
>
> However, I have found one workaround. If I start tcpdump(8) in one
> xterm on eth interface to wait for traffic, and "nmap -v -sS" in other
> window, nmap (and all other active or new connections, like ssh, http)
> are working without problem. So, if PROMISC is set on interface
> (tcpdump will set this flag when started, and remove on interrupt),
> everything works as expected. Of course, if I stop tcpdump(8), and
> start nmap(1) again, it will not work, and network will be unusable
> until I kill nmap(1). In normal mode without nmap(1), that is -
> tcp,udp ssh/http/imap/smtp ... there is no visible problems.  dmesg(8)
> does not report anything unusual, neither logfiles do.
Does just setting promisc with ifconfig or ip tool helps?
> I hope this is enough info.
--
vda
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.kernel.org
More majordomo info at  
http://vger.kernel.org/majordomo-info.html
Please read the FAQ at  
http://www.tux.org/lkml/