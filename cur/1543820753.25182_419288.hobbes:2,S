Date: Wed, 26 Apr 2006 23:10:50 -0700 (PDT)
From: Hua Zhong <>
Subject: Re: [PATCH] Profile likely/unlikely macros -v2
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2006/4/27/22

Actually, this seems a better fix. Clearly the unlikely and that particular kmalloc don't play well together. However, the same setup a couple of lines later have no issue.
Signed-off-by: Hua Zhong <hzhong@gmail.com>
diff --git a/arch/i386/kernel/cpu/intel_cacheinfo.c b/arch/i386/kernel/cpu/intel_cacheinfo.c
index c8547a6..9dfcf0e 100644
--- a/arch/i386/kernel/cpu/intel_cacheinfo.c
+++ b/arch/i386/kernel/cpu/intel_cacheinfo.c
@@ -572,7 +572,7 @@ static int __cpuinit cpuid4_cache_sysfs_
 
 	/* Allocate all required memory */
 	cache_kobject[cpu] = kmalloc(sizeof(struct kobject), GFP_KERNEL);
-	if (unlikely(cache_kobject[cpu] == NULL))
+	if (cache_kobject[cpu] == NULL)
 		goto err_out;
 	memset(cache_kobject[cpu], 0, sizeof(struct kobject));
 
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.kernel.org
More majordomo info at  
http://vger.kernel.org/majordomo-info.html
Please read the FAQ at  
http://www.tux.org/lkml/