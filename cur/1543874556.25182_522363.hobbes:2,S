Date: Tue, 20 Mar 2007 22:15:56 -0400
From: Wakko Warner <>
Subject: Re: scsi: Devices offlined
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2007/3/20/408

Philippe Troin wrote:
> Wakko Warner <wakko@animx.eu.org> writes:
> 
> > [84797.683873] sr 1:0:13:0: scsi: Device offlined - not ready after error recovery
> > 
> > Is there anyway to make the kernel "online" a device that has done this? 
> > I've had this happen on various devices (mostly on usb where I can
> > unplug/replug), but this time, it's on a scsi controller and the driver is
> > not a module.
> > 
> > If it's possible to do this w/o rebooting, I'd like to know for when I have
> > this happen in the future.
> 
> Have you tried:
> 
>   echo remove-single-device BUS ID LUN > /proc/scsi
>   echo add-single-device BUS ID LUN > /proc/scsi
I tried:
echo "scsi remove-scingle-device 1 0 13 0" > /proc/scsi/scsi
<device removed from /proc/scsi/scsi list>
echo "scsi add-scingle-device 1 0 13 0" > /proc/scsi/scsi
<device does not show up in /proc/scsi/scsi list>
I also tried your method, which just gives invalid argument (using
/proc/scsi/scsi, since /proc/scsi is a directory)
According to scsi_proc.c:
        /*
         * Usage: echo "scsi add-single-device 0 1 2 3" >/proc/scsi/scsi
         * with  "0 1 2 3" replaced by your "Host Channel Id Lun".
         */
        /*
         * Usage: echo "scsi remove-single-device 0 1 2 3" >/proc/scsi/scsi
         * with  "0 1 2 3" replaced by your "Host Channel Id Lun".
         */
Either way, nothing.
Er, on second though, I actually unplugged the power from the scsi device
and replugged it and it shows up now.  Oh well..  Thanks anyway =)
-- 
 Lab tests show that use of micro$oft causes cancer in lab animals
 Got Gas???
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.kernel.org
More majordomo info at  
http://vger.kernel.org/majordomo-info.html
Please read the FAQ at  
http://www.tux.org/lkml/