Date: Thu, 29 Jan 2004 11:22:31 -0800
From: john stultz <>
Subject: Re: [TRIVIAL PATCH] 2.4.25pre7 warning fix
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2004/1/29/102

On Thu, 2004-01-29 at 08:38, Krzysztof Halasa wrote:
> Marcelo Tosatti <marcelo.tosatti@cyclades.com> writes:
> 
> > Btw, why do we need cyclone_setup() for !CONFIG_X86_SUMMIT ?
> >
> > /* No-cyclone stubs */
> > #ifndef CONFIG_X86_SUMMIT
> > int __init cyclone_setup(char *str)
> > {
> >         printk(KERN_ERR "cyclone: Kernel not compiled with
> > CONFIG_X86_SUMMIT, cannot use the cyclone-timer.\n");
> >         return 1;
> > }
This is needed because cyclone_setup() is called by
detect_clustered_apic(), which may or may not be done on a kernel w/
CONFIG_X86_SUMMIT enabled. 
> 
> After having a closer look at it I think we should:
> 
> 1. if CONFIG_X86_TSC is set:
>    - make calibrate_tsc() failure a fatal error
>    - assume use_tsc = 1 and x86_udelay_tsc = 1 and optimize them out
>      with preprocessor
Sounds fair. 
> 
> 2. if CONFIG_X86_SUMMIT is _not_ set:
>    - assume use_cyclone = 0 and optimize it out as well.
We already do this. 
>    - cyclone_setup() etc should go out.
cyclone_setup() is still needed. 
> 3. I would rename CONFIG_X86_TSC to something like CONFIG_X86_TSC_FORCE
>    - the current name is misleading. It wouldn't affect .config.
Agreed. 
thanks
-john
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.kernel.org
More majordomo info at  
http://vger.kernel.org/majordomo-info.html
Please read the FAQ at  
http://www.tux.org/lkml/