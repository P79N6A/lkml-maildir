Date: Mon, 26 Sep 2005 14:30:44 -0500
From: Corey Minyard <>
Subject: Add IPMI poweroff control to sysfs
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2005/9/26/193

Is it possible to get this into 2.6.14?  It's a fairly simple change.
Put the IPMI poweroff_powercycle parameter into sysfs.  This
field is dynamically settable and is valuable to have in sysfs.
Signed-off-by: Corey Minyard <minyard@acm.org>
Index: linux-2.6.14-rc2/drivers/char/ipmi/ipmi_poweroff.c
===================================================================
--- linux-2.6.14-rc2.orig/drivers/char/ipmi/ipmi_poweroff.c
+++ linux-2.6.14-rc2/drivers/char/ipmi/ipmi_poweroff.c
@@ -55,7 +55,7 @@ extern void (*pm_power_off)(void);
 static int poweroff_powercycle;
 
 /* parameter definition to allow user to flag power cycle */
-module_param(poweroff_powercycle, int, 0);
+module_param(poweroff_powercycle, int, 0644);
 MODULE_PARM_DESC(poweroff_powercycles, " Set to non-zero to enable power cycle instead of power down. Power cycle is contingent on hardware support, otherwise it defaults back to power down.");
 
 /* Stuff from the get device id command. */