Date: Tue, 21 Dec 1999 19:38:59 -0500
From: "Terry Katz" <>
Subject: 2.3.33 + halt .. tcp problem ??
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/1999/12/21/167

Hello ..
In an attempt to consolidate all of our web logs into a single log, we set
up a machine to act as an apache reverse-proxy server (accept connections on
multiple ip addresses, and then proxy them off to the real web servers).. We
had run tests in the past under 2.2.x and was able to simulate over a
million hits an hour on a small test system (UP pent 2-450, 512mb).
We made the real system (dual xeon 550/2mb 1gig) with the kernel 2.3.33 (for
the large file size support, and memory support for when we upgrade) live
this evening.. it was up approximately 3 minutes, received ~5000 hits
 about 100000 hits/hr well below what we tested on a smaller system ), and
then halted.  The screen saver on the console was active, so I didn't see
any console messages, and I couldn't find an oops file.  However, upon
rebooting and looking at the kernel log I noticed the following messages
generated just before the crash:
Dec 21 18:19:59 reverse kernel: TCPv4 bad checksum from xxx.xxx.xxx.xxx:085b
to xxx.xx.x.x:0050, len=20/40
(from an outside ip, to one of our vhosts web servers... message was
repeated 11 times, one of which was from a different source, the other 10
all from the same source.. The message immediately following the last one,
was the klogd startup message upon reboot)
I searched the web logs and they showed that both source ip's were infact
'surfing' our web servers 'normally' ..
Any ideas?  Could the bad checksum have caused this?  (I can't find any
kernel messages similar to the above, on any of our other webservers,
running kernel 2.2.12)
Again server configuration:
  Dell PowerEdge 6300
  2xXeon 550/2mb
  1gig memory
  AMI MegaRaid controller
  2xIntel EtherExpress Pro load balancing 10/100 cards (only one port on one
card enabled)
  Debian Linux Distro (kernel used was not Debian stock.. was custom
compiled, grabbed from kernel.org)
  Linux 2.3.33 (stock, can furnish the config file if needed)
  Netfilter option enabled (NAT modules 0.1.12 installed), port forwarding
enabled for realmedia ports (I know there's a bug in the nat_ftp module, and
it was not installed...)
  Any other info I didn't think of .. just ask...
Thanks in advance!
Terry Katz
Systems Programmer
Advanced Network & Services, Inc.
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.rutgers.edu
Please read the FAQ at 
http://www.tux.org/lkml/