Date: Thu, 23 Sep 2004 22:30:54 -0500
From: "K.R. Foley" <>
Subject: Re: [patch] voluntary-preempt-2.6.9-rc2-mm3-S5
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2004/9/23/406

K.R. Foley wrote:
> Ingo Molnar wrote:
> 
>> i've released the -S5 VP patch:
>> 
>> 
>> 
http://redhat.com/~mingo/voluntary-preempt/voluntary-preempt-2.6.9-rc2-mm3-S5
>>
> 
> 
> This one seems to bring back some issues with the network interface. The 
> only noticeable symptom is dropping ~30 percent of new telnet 
> connections under heavy load. When not loaded it still drops ~5 percent. 
> I had no dropped connections with S4 even when loaded. This just happens 
> to be one of things that I have been testing manually since I noticed 
> some problems with previous patches.
> 
> Currently using an SMC card with a DEC 21140 chip and the tulip driver 
> on my SMP system.
> 
> kr
The following, on top of Ingo's patch above, fixes the problem with 
dropping new connections and doesn't have any adverse affects that I've 
seen:
--- linux-2.6.9-rc2-pre-mm3/net/ipv4/tcp_output.c.orig  2004-09-23 
22:16:42.249435870 -0500
+++ linux-2.6.9-rc2-pre-mm3/net/ipv4/tcp_output.c       2004-09-23 
22:12:03.911811945 -0500
@@ -699,11 +699,6 @@
                         tcp_minshall_update(tp, mss_now, skb);
                         sent_pkts = 1;
-                       /*
-                        * Break out early - we'll continue later:
-                        */
-                       if (softirq_need_resched())
-                               break;
                 }
                 if (sent_pkts) {
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.kernel.org
More majordomo info at  
http://vger.kernel.org/majordomo-info.html
Please read the FAQ at  
http://www.tux.org/lkml/