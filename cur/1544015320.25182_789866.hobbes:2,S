Date: Sat, 10 Jan 2009 20:35:19 +0000
From: Alistair John Strachan <>
Subject: Re: Oops with Gigabyte motherboard "GA-X48-DQ6" and r8168 Realtek driver
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2009/1/10/189

Hi Roman,
On Saturday 10 January 2009 18:47:47 Roman Medina-Heigl Hernandez wrote:
> Alistair John Strachan escribiÃ³:
> > My advice to you is to install the very latest Debian kernel (2.6.27) in
> > which this bug has been fixed. That said, I think if you do this, you
> > won't have any further problems. Using the vendor driver instead of the
> > one in mainline probably isn't a good idea.
[snip]
> The working machine is an AMD dual core with 2 MB RAM and 1 rtl8111B NIC
> (being the non-working an Intel Quad core with 4 MB RAM and 2 rtl8111B
> NICs). So yes, as you said, the problems could be due to Quad / 4GB RAM.
Francois Romieu would be the best person to confirm, but I suspect you are 
correct and it does not surprise me that the vendor driver has the same bug.
It would manifest exactly like this -- the NIC would be basically non-
functional with 4GB RAM, but the minute it stops using the swiotlb or AMD GART 
IOMMU there was no problem.
> There's no Debian-official 2.6.27 deb packages (latest is 2.6.26),
> according to:
> 
http://packages.qa.debian.org/l/linux-2.6.html
> Best for etch I've found is a 2.6.26 deb package (backport).
>
> I suppose you're refering to the ultra-experimental "trunk" branch at:
> deb 
http://kernel-archive.buildserver.net/debian-kernel
 trunk main
> Right?
>
> I'll give it a try, it seems a good choice (given the circunstances).
> Another option: Do you think it worth the pain to compile a custom 2.6.28
> kernel? (in other words, do you think it contains fixes that could solve
> the strange issues I've been affected with? I don't follow kernel
> development so I cannot answer this question but perhaps you could...).
Yes, vanilla 2.6.27 and of course 2.6.28 have the fixes. There's no 
requirement to use Debian's mildly patched kernels if you don't want to. The 
reason I recommended the Debian package (though unfortunately as you point out 
it doesn't yet exist) is that it's less faff and is presumably more likely to 
work in your production environment.
Another (good) option would be to grab the Debian kernel sources (apt-get 
source linux-image-<whatever>) and then patch it with the fix, available from 
this bugzilla thread:
http://bugzilla.kernel.org/show_bug.cgi?id=9468
Then debuild it as normal (hopefully you're familiar with this process).
> Thank you very much for your comments. They are greatly appreciated.
No problem. I ran into similar problems with this hardware many months ago and 
nobody knew anything about it. It's just unfortunate that Debian are behind 
the curve in terms of kernel version.
-- 
Cheers,
Alistair.
--
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.kernel.org
More majordomo info at  
http://vger.kernel.org/majordomo-info.html
Please read the FAQ at  
http://www.tux.org/lkml/