Date: Mon, 18 Sep 2006 19:18:19 -0700 (PDT)
From: Linus Torvalds <>
Subject: Re: Math-emu kills the kernel on Athlon64 X2
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2006/9/18/294

On Tue, 19 Sep 2006, Jesper Juhl wrote:
> 
> Booting with: vga=normal no387 nofxsr
> gets me no forther.   These are all the messages I get:
> 
> boot: 2.6.18rc7git2 vga=normal no387 nofxsr
> Loading 2.6.18rc7git2...................................
> BIOS data check successful
> Uncompressing Linux... Ok, booting the kernel.
> 
> And then the system hangs and requires a power cycle.
> 
> So unfortunately that does't help much :-(
Ok. The next phase is to try to figure out where it hangs, and since it 
happens very early, that's most often most easily done the hard way: add 
some code that reboots the machine, and if the machine hangs, you didn't 
reach it.
These days there's a slightly easier approach: if you enable PM_TRACE 
support (you need to enable PM and PM_DEBUG and EXPERIMENTAL to get it), 
you can do
	#include <resume-trace.h>
at the top of a file, and add a sprinkling of "TRACE_RESUME(x)" calls 
(where "x" is some integer in the range 0-15 that you can use to save off 
the iteration count in a loop, for example - leave at 0 if you're not 
interested).
And then, when it hangs, once you reboot into the same kernel (without the 
"no387", so that it works ;), it should tell you where the last 
trace-point was fairly early in the bootup dmesg's.
(It _will_ screw up your time-of-day clock in the process, though, which 
is why tracing is so hard to enable on purpose ;)
		Linus
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.kernel.org
More majordomo info at  
http://vger.kernel.org/majordomo-info.html
Please read the FAQ at  
http://www.tux.org/lkml/