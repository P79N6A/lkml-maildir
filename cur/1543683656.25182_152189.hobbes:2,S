Date: Mon, 28 Jul 2003 15:27:39 +0200
From: Adrian Bunk <>
Subject: Re: Linux v2.6.0-test2
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2003/7/28/124

On Sun, Jul 27, 2003 at 10:08:40AM -0700, Linus Torvalds wrote:
>...
> Summary of changes from v2.6.0-test1 to v2.6.0-test2
> ============================================
>...
> Krzysztof Halasa:
>   o HDLC update
>...
This patch caused the following compile error:
<--  snip  -->
...
  CC      drivers/net/wan/pc300_drv.o
drivers/net/wan/pc300_drv.c: In function `cpc_ioctl':
drivers/net/wan/pc300_drv.c:2557: error: incompatible types in 
assignment
drivers/net/wan/pc300_drv.c:2593: error: incompatible types in 
assignment
drivers/net/wan/pc300_drv.c: In function `cpc_open':
drivers/net/wan/pc300_drv.c:3156: error: invalid operands to binary ==
drivers/net/wan/pc300_drv.c:3161: error: invalid operands to binary ==
drivers/net/wan/pc300_drv.c: In function `cpc_close':
drivers/net/wan/pc300_drv.c:3194: error: invalid operands to binary ==
make[3]: *** [drivers/net/wan/pc300_drv.o] Error 1
<--  snip  -->
Please check whether the fix below is correct.
TIA
Adrian
--- linux-2.6.0-test2-full-no-smp/drivers/net/wan/pc300_drv.c.tmp	2003-07-28 15:13:06.000000000 +0200
+++ linux-2.6.0-test2-full-no-smp/drivers/net/wan/pc300_drv.c	2003-07-28 15:19:35.000000000 +0200
@@ -2554,10 +2554,10 @@
 		case SIOCGPC300CONF:
 #ifdef CONFIG_PC300_MLPPP
 			if (conf->proto != PC300_PROTO_MLPPP) {
-				conf->proto = hdlc->proto;
+				conf->proto = hdlc->proto.id;
 			}
 #else
-			conf->proto = hdlc->proto;
+			conf->proto = hdlc->proto.id;
 #endif
 			memcpy(&conf_aux.conf, conf, sizeof(pc300chconf_t));
 			memcpy(&conf_aux.hw, &card->hw, sizeof(pc300hw_t));
@@ -2590,12 +2590,12 @@
 					}
 				} else {
 					memcpy(conf, &conf_aux.conf, sizeof(pc300chconf_t));
-					hdlc->proto = conf->proto;
+					hdlc->proto.id = conf->proto;
 				}
 			}
 #else
 			memcpy(conf, &conf_aux.conf, sizeof(pc300chconf_t));
-			hdlc->proto = conf->proto;
+			hdlc->proto.id = conf->proto;
 #endif
 			return 0;
 		case SIOCGPC300STATUS:
@@ -3153,12 +3153,12 @@
 	printk("pc300: cpc_open");
 #endif
 
-	if (hdlc->proto == IF_PROTO_PPP) {
+	if (hdlc->proto.id == IF_PROTO_PPP) {
 		d->if_ptr = &hdlc->state.ppp.pppdev;
 	}
 
 	result = hdlc_open(hdlc);
-	if (hdlc->proto == IF_PROTO_PPP) {
+	if (hdlc->proto.id == IF_PROTO_PPP) {
 		dev->priv = d;
 	}
 	if (result) {
@@ -3191,7 +3191,7 @@
 	CPC_UNLOCK(card, flags);
 
 	hdlc_close(hdlc);
-	if (hdlc->proto == IF_PROTO_PPP) {
+	if (hdlc->proto.id == IF_PROTO_PPP) {
 		d->if_ptr = NULL;
 	}
 #ifdef CONFIG_PC300_MLPPP
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.kernel.org
More majordomo info at  
http://vger.kernel.org/majordomo-info.html
Please read the FAQ at  
http://www.tux.org/lkml/