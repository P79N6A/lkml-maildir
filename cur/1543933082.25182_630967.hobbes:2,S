Date: Fri, 21 Dec 2007 13:26:19 +0100
From: Jens Axboe <>
Subject: Re: [PATCH - SH/Dreamcast] Add support for GD-Rom device
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2007/12/21/89

On Fri, Dec 21 2007, Jens Axboe wrote:
> static void gdrom_readdisk_dma(struct work_struct *work)
> {
>         ...
> 
>         read_command = kzalloc(sizeof(struct packet_command), GFP_KERNEL);
>         if (!read_command)
>                 probably just defer the work to some time later
> 
>         spin_lock(&gdrom_lock);
>         while (!list_empty(&gdrom_deferred)) {
>                 req = list_entry(gdrom_deferred.next, struct request, queuelist);
>                 list_del_init(&req->queuelist);
>                 spin_unlock(&gdrom_lock);
> 
>                 ...
> 
>                 spin_lock(&gdrom_lock);
>         };
> 
+         spin_unlock(&gdrom_lock);
>         kfree(read_command);
> }
is missing, of course.
-- 
Jens Axboe