Date: Wed, 24 Aug 2005 11:29:59 -0500
From: Linas Vepstas <>
Subject: Re: [patch 8/8] PCI Error Recovery: PPC64 core recovery routines
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2005/8/24/135

On Wed, Aug 24, 2005 at 10:45:31AM -0500, John Rose was heard to remark:
> > +++ linux-2.6.13-rc6-git9/arch/ppc64/kernel/eeh_driver.c	2005-08-23 14:34:44.000000000 -0500
> > +/*
> > + * PCI Hot Plug Controller Driver for RPA-compliant PPC64 platform.
> 
> This probably isn't the right header description for this file :)
Yes, this file is a little ball of ugliness that resulted from moving
things out of the rpaphp directory; and, yes, it's rather
un-reconstructed. I released it under the "release early" program.
The meta-issue that I'd like to reach consensus on first is whether
there should be any hot-plug recovery attempted at all.  Removing
hot-plug-recovery support will make many of the issues you raise 
to be moot.
> > +++ linux-2.6.13-rc6-git9/include/asm-ppc64/prom.h	2005-08-23 13:31:52.000000000 -0500
> >  	int	busno;			/* for pci devices */
> >  	int	bussubno;		/* for pci devices */
> >  	int	devfn;			/* for pci devices */
> 
> How about a pointer to a struct of EEH fields?  Folks are touchy about
> adding anything PCI-specific to device nodes, especially since most DNs
> aren't PCI at all.
I attempted to remove all of the pci-related stuff from this struct,
and got a crash in very very early boot (before the transition from
real to virtual addressing). Not sure why, I was surprised.  It seems 
related to the flattening of the device ndode tree. I'll try again 
soon.
--linas
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.kernel.org
More majordomo info at  
http://vger.kernel.org/majordomo-info.html
Please read the FAQ at  
http://www.tux.org/lkml/