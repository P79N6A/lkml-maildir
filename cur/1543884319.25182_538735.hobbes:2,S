Date: Wed, 02 May 2007 09:36:47 +0200
From: Mike Galbraith <>
Subject: Re: [ext3][kernels >= 2.6.20.7 at least] KDE going comatose when FS is under heavy write load (massive starvation)
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2007/5/2/107

On Wed, 2007-05-02 at 08:53 +0200, Jens Axboe wrote:
> On Fri, Apr 27 2007, Linus Torvalds wrote:
> > So I do believe that we could probably do something about the IO 
> > scheduling _too_:
> > 
> >  - break up large write requests (yeah, it will make for worse IO 
> >    throughput, but if make it configurable, and especially with 
> >    controllers that don't have insane overheads per command, the 
> >    difference between 128kB requests and 16MB requests is probably not 
> >    really even noticeable - SCSI things with large per-command overheads 
> >    are just stupid)
> > 
> >    Generating huge requests will automatically mean that they are 
> >    "unbreakable" from an IO scheduler perspective, so it's bad for latency 
> >    for other reqeusts once they've started.
> 
> Overlooked this one initially... We actually don't generate huge
> requests, exactly because of that. Even if the device can do large
> requests (most SATA disks today can do 32meg), we default to 512kB as
> the largest one that we will build due to file system requests. It's
> trivial to reduce that limit, see /sys/block/<dev>/queue/max_sectors_kb.
> That controls the maximum per-request size.
For the record, I haven't been able to stall KDE for ages with
data=writeback.
	-Mike
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.kernel.org
More majordomo info at  
http://vger.kernel.org/majordomo-info.html
Please read the FAQ at  
http://www.tux.org/lkml/