Date: Wed, 16 Jan 2008 13:39:42 -0800
From: "Yinghai Lu" <>
Subject: Re: hpet_late_init hang
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2008/1/16/295

On Jan 16, 2008 12:34 AM, Balaji Rao <balajirrao@gmail.com> wrote:
> On Wednesday 16 January 2008 12:21:33 pm Ingo Molnar wrote:
> Hi Ingo,
> > * Yinghai Lu <yhlu.kernel@gmail.com> wrote:
> > > "
> > > commit e5ed385fa0d6f35406e3e3ed75e5eb9adeb811df
> > > Author: Balaji Rao <balajirrao@gmail.com>
> > > Date:   Tue Jan 15 16:53:29 2008 +0100
> > >
> > >     Assign IRQs to HPET Timers
> > > "
> > > in x86.git
> > >
> > > cause my servers hang
> > > after
> > > Calling initcall 0xffffffff80b9a465: hpet_late_init+0x0/0x100()
..
> Looks like IRQ 31 is assigned to timer 3, even without the patch! I wonder who wrote the number 31. But the manual says
> that it is zero by default.
>
> I think we should check whether the timer has been allocated an IRQ before proceeding to assign one to it.
> Here is a patch that does this.
>
> Yinghai, could you please apply this on top of my patch and check ?
>
> ---
> Index: linux-2.6/arch/x86/kernel/hpet.c
> ===================================================================
> --- linux-2.6.orig/arch/x86/kernel/hpet.c
...
>
it works
YH