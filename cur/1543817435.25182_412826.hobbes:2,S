Date: Fri, 31 Mar 2006 09:43:00 -0800 (PST)
From: Christoph Lameter <>
Subject: Re: Synchronizing Bit operations V2
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2006/3/31/187

On Fri, 31 Mar 2006, Nick Piggin wrote:
> > 
> > Right. From the earlier conversation I had the impression that this is what
> > you wanted.
> Perhaps it is the best way to go, but you need to fix ia64's
> current problems first. Again -- you don't plan to audit and
> convert _all_ current users in one go do you?
No. If you look at the patch you will see that this fixes the ia64 
problems for the existing scheme and then allows the use of new _mode 
bitops if you include bitops_mode.h from core code. This is designed for a 
gradual change.
> You acknowledge that you have to fix ia64 to match current semantics
> first, right?
Right. I believe I have done so by making both smb_mb_* full barriers.
> Now people seem to be worried about the performance impact that will
> have, so I simply suggest that adding two or three new macros for the
> important cases to give you a 90% solution.
We could transition some key locations of core code to use _mode bitops
if there are performance problems.
> I think Documentation/atomic_ops.txt isn't bad. smp_mb__* really
> is a smp_mb, which can be optimised sometimes.
Ok. Then we are on the same page and the solution I presented may be 
acceptable. I have a new rev here that changes the naming a bit but I 
think we are okay right?
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.kernel.org
More majordomo info at  
http://vger.kernel.org/majordomo-info.html
Please read the FAQ at  
http://www.tux.org/lkml/