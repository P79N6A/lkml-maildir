Date: Tue, 6 Aug 2002 15:54:32 -0500 (CDT)
From: Oliver Xymoron <>
Subject: Re: backups/dumps/caches
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2002/8/6/211

On Mon, 5 Aug 2002, Richard Bonomo wrote:
> Hello!
>
> I have been trying to come up to speed on
> the issue of dumping file systems from
> 2.4.x kernels using dumps.  I located
> Linus' unequivocal words about the dangers
> of using dump.   I have a couple of questions:
>
> 1. Do the same warnings apply to XFS and xfsdump?
>    (Is the caching system used with the newer
>     kernel used only with certain file system types?)
The essential problem with dump is that the current state of a filesystem
is a combination of what's in memory and what's on disk. With a journalled
filesystem, what's on disk at any given moment is self-consistent
(ignoring various levels of journalling). But dump can't see the whole
of the disk at any given moment, so it has no way of telling whether piece
A it read one second is consistent with piece B it read on the next.
There's no way to make this work cleanly short of snapshots (which 2.4 LVM
has), and the hacks to make dump mostly work (which is the best it can
ever possibly hope for on a live filesystem) were getting in the way of
doing other things right, so the dump approach of going under the
filesystem to the block device was officially declared stupid.
> 2. Perhaps, naively, is it possible to shut off
>   caching temporarily (and without rebooting),
>   accepting the performance hit, while a dump
>   is done, and then restart caching afterwards?
Yep. Switch to single user mode, sync all filesystems, unmount them for
good measure, dump, then switch back to multiuser mode.
-- 
 "Love the dolphins," she advised him. "Write by W.A.S.T.E.."
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.kernel.org
More majordomo info at  
http://vger.kernel.org/majordomo-info.html
Please read the FAQ at  
http://www.tux.org/lkml/