Date: 31 Mar 2003 14:14:05 +0200
From: Peter Waechtler <>
Subject: Re: [2.5 patch] typo fix for compilation
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2003/3/31/27

On Mon, 2003-03-31 at 12:05, Adrian Bunk wrote:
> On Mon, Mar 31, 2003 at 02:04:04AM +0200, Peter Waechtler wrote:
> > 
> > There's a problem when compiling the GUS driver into the kernel
> > instead of as a module. I renamed the global "lock" to "gus_lock"
> > and made sure that it's used (shared by gus_midi, gus_wave, ics2101)
> > 
> > [snippet of sound/oss/Makefile]
> > obj-$(CONFIG_SOUND_GUS)         += gus.o ad1848.o
> > gus-objs        := gus_card.o gus_midi.o gus_vol.o gus_wave.o ics2101.o
> > 
> > 
> > Adrian: Do you have a GUS and can test this?
> 
> Unfortunately not, I noticed this problem while doing compile-only tests 
> with a .config that has as much as possible enabled.
> 
> BTW:
> The sound/oss/mad16.c part of your patch doesn't belong to this problem?
> 
No. But there are more compile errors I've fixed while at it:
diff -Nur -X dontdiff vanilla-2.5.66/drivers/char/ipmi/ipmi_devintf.c linux-2.5.66/drivers/char/ipmi/ipmi_devintf.c
--- vanilla-2.5.66/drivers/char/ipmi/ipmi_devintf.c	2003-03-26 19:53:59.000000000 +0100
+++ linux-2.5.66/drivers/char/ipmi/ipmi_devintf.c	2003-03-30 22:26:10.000000000 +0200
@@ -449,7 +449,7 @@
 	if (if_num > MAX_DEVICES)
 		return;
 
-	snprinf(name, sizeof(name), "ipmidev/%d", if_num);
+	snprintf(name, sizeof(name), "ipmidev/%d", if_num);
 
 	handles[if_num] = devfs_register(NULL, name, DEVFS_FL_NONE,
 					 ipmi_major, if_num,
diff -Nur -X dontdiff vanilla-2.5.66/drivers/net/tokenring/tms380tr.c linux-2.5.66/drivers/net/tokenring/tms380tr.c
--- vanilla-2.5.66/drivers/net/tokenring/tms380tr.c	2003-02-16 19:49:55.000000000 +0100
+++ linux-2.5.66/drivers/net/tokenring/tms380tr.c	2003-03-30 20:58:37.000000000 +0200
@@ -257,7 +257,7 @@
 	int err;
 	
 	/* init the spinlock */
-	spin_lock_init(tp->lock);
+	spin_lock_init(&tp->lock);
 
 	/* Reset the hardware here. Don't forget to set the station address. */
 
diff -Nur -X dontdiff vanilla-2.5.66/fs/cramfs/inode.c linux-2.5.66/fs/cramfs/inode.c
--- vanilla-2.5.66/fs/cramfs/inode.c	2003-03-26 19:54:05.000000000 +0100
+++ linux-2.5.66/fs/cramfs/inode.c	2003-03-30 18:31:42.000000000 +0200
@@ -51,7 +51,7 @@
 		inode->i_blocks = (cramfs_inode->size - 1) / 512 + 1;
 		inode->i_blksize = PAGE_CACHE_SIZE;
 		inode->i_gid = cramfs_inode->gid;
-		inode->i_mtime = inode->i_atime = inode->i_ctime = 0;
+		inode->i_mtime = inode->i_atime = inode->i_ctime = CURRENT_TIME;
 		inode->i_ino = CRAMINO(cramfs_inode);
 		/* inode->i_nlink is left 1 - arguably wrong for directories,
 		   but it's the best we can do without reading the directory