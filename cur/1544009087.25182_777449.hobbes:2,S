Date: Fri, 5 Dec 2008 16:15:19 +0000 (GMT)
From: Hugh Dickins <>
Subject: Re: [PATCH] EXPORTFS: Don't return NULL from fh_to_dentry()/fh_to_parent() [ver #2]
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2008/12/5/214

On Fri, 5 Dec 2008, David Howells wrote:
> Hugh Dickins <hugh@veritas.com> wrote:
> 
> > I think it's still wrong in shmem_fh_to_dentry(): you've fixed
> > the early return, but there'd be another return NULL if !inode?
> 
> Now that I've fixed that as well, what are the chances of d_find_alias()
> returning NULL, do you think?  I suppose all that's required is for a file to
> be deleted locally while a remote client has a filehandle to it.
To be honest, I've no idea - you and hch know what goes on there
much better than I do.  Unless there's an obvious reason why an
incore filesystem like tmpfs or ramfs can't get a NULL there,
I think you have to add that protection too.  Sorry, it should
have crossed my mind too before I misled you by saying "!inode".
Hugh