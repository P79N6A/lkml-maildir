Date: Tue, 30 Oct 2001 00:00:42 -0500
From: Skip Gaede <>
Subject: [PATCH]  driver: ide-floppy.c  kernel >=2.4.7
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2001/10/29/235

This patch fixes a lost interrupt problem with the Iomega ATAPI Zip 100 drive 
on an Asus A7V133 board (uses South Bridge VIA VT82C686 chip). The problem 
occurs when trying to format the drive using mke2fs /dev/hdx1. The patch 
introduces an adjustable delay between the time the drive asserts DRQ and 
deasserts BSY after issuing the packet command and before transferring the 12 
byte packet.. With delays of 3-5 ticks, the filesystem creation occurs 
without retries/resets. The delay can be adjusted through the proc interface 
by adjusting the value assigned to the parameter ticks. (Without the patch, I 
experienced 111 lost interrupts, resulting in an elapsed time of over 2 hours 
to format the drive. With the patch, mke2fs completed in <15 seconds.)
I am looking for testing, by others who have the internal Zip drive and may 
have experienced the same problem, as well as comments.
Thanks,
--Skip[unhandled content-type:application/x-bzip2]Lost interrupt patch for ide-floppy.c by Skip Gaede <sgaede@mediaone.net>