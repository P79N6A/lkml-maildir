Date: Fri, 4 Nov 2005 16:58:25 -0800
From: Brian Pomerantz <>
Subject: Re: [PATCH] [IPV4] Fix secondary IP addresses after promotion
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2005/11/4/330

On Sat, Nov 05, 2005 at 01:34:16AM +0100, Patrick McHardy wrote:
> 
> You assume all addresses following the primary addresses are secondary
> addresses of the primary, which is not true with multiple primaries.
> This patch (untested) makes sure only to send notification for real
> secondaries of the deleted address. It also removes a racy double-
> check for IN_DEV_PROMOTE_SECONDARIES - once we've decided to promote
> an address checking again opens a window in which address promotion
> could be disabled and we end up with only secondaries without a
> primary address.
> 
Yeah, I was wondering if there could be primaries after the
secondaries.  I'm pretty unfamiliar with this code (first looked at it
last week) and still don't have a handle on how the primaries
interact with the secondaries in the route lookup.  Which means it's
not clear to me why this was failing to begin with. :)
Your patch works for all of the cases I've been testing with so it
looks good to go from here.
BAPper
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.kernel.org
More majordomo info at  
http://vger.kernel.org/majordomo-info.html
Please read the FAQ at  
http://www.tux.org/lkml/