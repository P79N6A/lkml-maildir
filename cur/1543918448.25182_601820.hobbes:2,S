Date: Thu, 4 Oct 2007 14:23:03 +0530
From: "yogeshwar sonawane" <>
Subject: Accessing 64-bit BARs
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2007/10/4/86

Hello all,
For accessing memory-mapped 64bit-BAR regions of a PCI card, the
respective BAR regions has to be made accessible to the kernel using
ioremap() function. Then readl()/writel() can be used on the address
returned by ioremap().
I am doing the similar steps to access the BARs of a card.
I observed some change in the behaviour in two different kernels.
Start physical addr of BAR is allocated by BIOS.
In linux-2.6.9, whether BAR start phys addr is below OR above 4GB,
i.e. whether 32-bit BAR phys addr(all higher bits 0) OR 64-bit phys
addr(some higher bits non-zero), I am able to access the BAR region
using ioremap() & then readl()/writel().
For linux-2.6.22-8, if BAR start phys addr is below 4GB, things are
working fine here also.
But, for linux-2.6.22-8, when BAR start phys addr is above 4GB, I am
not able to read/write on the BAR region. ioremap() is not failing.
But read data is all 1's instead of actual data.
Any ideas on where to look for?
Is there any change in the way of accessing 64-bit BAR?
OR
i am missing any step ?
For info - I am using 64-bit OS on x86_64 arch.
-Yogeshwar
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.kernel.org
More majordomo info at  
http://vger.kernel.org/majordomo-info.html
Please read the FAQ at  
http://www.tux.org/lkml/