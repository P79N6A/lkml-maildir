Date: Thu, 13 Oct 2005 09:30:29 +0200
From: Ingo Molnar <>
Subject: Re: 2.6.14-rc4-rt1 - enable IRQ-off tracing causes kernel to fault at boot
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2005/10/13/8

* Mark Knecht <markknecht@gmail.com> wrote:
> Config file attached. The only change was to enable IRQ-off latency 
> tracing using make menuconfig. Rebuild and reboot. I got a message 
> about the kernel not syncing, lots of stuff above that message about 
> do_futex, etc.
i cannot reproduce your problems - your .config works fine on my x64 
box. A log of the crash would be needed - do you have a null-modem cable 
to connect this box to some other nearby box to do serial logging? If 
yes then there is a mini-howto below. (for x86, but it works the same 
for x64)
	Ingo
to set up serial logging:
-------------------------
install a null modem cable (== serial cable) to one of the serial ports
of the server, connect the cable to another box, run a terminal program
on that other box (e.g. "minicom -m" - do Alt-L to switch on logging
after starting it up) and set up the server's kernel to do serial
logging: enable CONFIG_SERIAL_8250_CONSOLE and
CONFIG_SERIAL_CORE_CONSOLE, recompile & reinstall the kernel, add
"console=ttyS0,38400 console=tty0" to your /etc/grub.conf or
/etc/lilo.conf kernel boot line, reboot the server with the new kernel
command line - and configure minicom to run with that speed (Alt-S).
e.g. my /etc/grub.conf has:
title test-2.6 (test-2.6)
        root (hd0,0)
        kernel /boot/bzImage root=/dev/sda1 console=ttyS0,38400 console=tty0 nmi_watchdog=1 kernel_preempt=1
if everything is set up correctly then you should see kernel messages
showing up in the minicom session when you boot up.
When the messages do not show up then typical errors are mismatch
between the serial port (or speed) and the device names used - if it's
COM2 then use ttyS1, and dont forget to set up the serial speed option
of minicom, etc. You can test the serial connection by doing:
	echo x > /dev/ttyS0
and that should show up in the minicom session on the other box.
to set up early-printk:
-----------------------
occasionally lockups/crashes happen so early in the bootup that nothing
makes it even to the serial log. In that case the 'earlyprintk' feature
is most useful. It is default-enabled on all 2.6 kernels, you only need
to add one more boot parameter to activate it over the serial console:
   earlyprintk=serial,ttyS0,38400
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.kernel.org
More majordomo info at  
http://vger.kernel.org/majordomo-info.html
Please read the FAQ at  
http://www.tux.org/lkml/