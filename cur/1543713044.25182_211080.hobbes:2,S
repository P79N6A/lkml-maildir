Date: Thu, 1 Apr 2004 19:22:46 +0400
From: Sergey Vlasov <>
Subject: Re: 2.6 kernels misdetect harddisk geometry, 2.4 kernels are fine
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2004/4/1/118

On Thu, 01 Apr 2004 16:45:15 +0200 Carl-Daniel Hailfinger wrote:
> the harddisk geometry recognized by 2.6 kernels differs from the geometry
> recognized by 2.4 kernels. The 2.4 kernel version agrees with the BIOS and
> fdisk/parted. The 2.6 kernel version seems senseless to me. Here is a diff
> between bootup messages: (more info available if you need it)
[skip]
In fact, this did not work correctly even in 2.4, except in some very
limited circumstances: either hda only, or hda+hdb.  Even hda+hdc
configuration was broken (hda was getting parameters from BIOS, but
hdc was not).
> You can see that both share the same sector count, but differing Megabytes
> and differing CHS. This breaks nearly every partitioning program I know
> and it makes supporting old ATARAID configurations a nightmare. (Some of
> the RAID superblock locations depend on the BIOS idea of CHS.)
Again, this was broken in 2.4.x too, except for the first IDE drive.
Difference in Megabytes is probably due to rounding and should not
matter (this is output only).
[unhandled content-type:application/pgp-signature]