Date: Mon, 19 Jul 2004 13:20:47 +0200
From: bert hubert <>
Subject: dentry cache leak? Re: rsync out of memory 2.6.8-rc2
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2004/7/19/36

On Mon, Jul 19, 2004 at 11:19:43AM +0200, Klaus Dittrich wrote:
> I found out I could trigger the memory outage using du -s /disc1 too.
Including crashing and/or running out of swap? That would indicate that the
dentry cache is not cleaning itself up, or that something is wrong with
reference counting.
Can you run 'cat fs/dentry-state' before and after the du -s? (assuming
there is an 'after'. Also, which fs is /disc1 on? any messages in dmesg?
dentry-state
------------
Status of  the  directory  cache.  Since  directory  entries  are
dynamically allocated and deallocated, this file indicates the current
status. It holds six values, in which the last two are not used and are
always zero. The others are listed in table 2-1.
Table 2-1: Status files of the directory cache 
..............................................................................
 File       Content                                                            
 nr_dentry  Almost always zero                                                 
 nr_unused  Number of unused cache entries                                     
 age_limit  
            in seconds after the entry may be reclaimed, when memory is
short 
 want_pages internally                                                         
-- 
http://www.PowerDNS.com
      Open source, database driven DNS Software 
http://lartc.org
           Linux Advanced Routing & Traffic Control HOWTO
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.kernel.org
More majordomo info at  
http://vger.kernel.org/majordomo-info.html
Please read the FAQ at  
http://www.tux.org/lkml/