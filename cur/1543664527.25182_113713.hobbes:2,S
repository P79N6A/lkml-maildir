Date: Sat, 1 Mar 2003 13:38:53 -0800
From: Greg KH <>
Subject: Re: [BK PATCH] PCI hotplug changes for 2.5.63
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2003/3/1/125

On Sat, Mar 01, 2003 at 10:55:50AM -0800, Linus Torvalds wrote:
> 
> On Fri, 28 Feb 2003, Greg KH wrote:
> > 
> > I've merged with your latest tree again, and it's available at the above
> > place.  Could you please pull these changes?
> 
> This causes
> 
> 	drivers/built-in.o(.text+0xedc7e): In function `cb_free':
> 	: undefined reference to `pci_remove_device'
> 	make: *** [.tmp_vmlinux1] Error 1
> 
> Ehh?
Oops, looks like Russell and I didn't test on a cardbus machine :)
I've made the following change to the repository, so you can just pull
it if you want to (from bk://kernel.bkbits.net/gregkh/linux/pci-2.5 ) or
you can just apply this patch.
It looks right to me, but I don't have a working cardbus machine at the
moment, so I can't test it, sorry.
Again, sorry about this.
greg k-h
# Cardbus: change cb_free to use pci_remove_device_safe()
diff -Nru a/drivers/pcmcia/cardbus.c b/drivers/pcmcia/cardbus.c
--- a/drivers/pcmcia/cardbus.c	Sat Mar  1 13:49:27 2003
+++ b/drivers/pcmcia/cardbus.c	Sat Mar  1 13:49:27 2003
@@ -313,7 +313,7 @@
 
 		s->cb_config = NULL;
 		for (i = 0 ; i < s->functions ; i++)
-			pci_remove_device(&c[i].dev);
+			pci_remove_device_safe(&c[i].dev);
 
 		kfree(c);
 		printk(KERN_INFO "cs: cb_free(bus %d)\n", s->cap.cb_dev->subordinate->number);
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.kernel.org
More majordomo info at  
http://vger.kernel.org/majordomo-info.html
Please read the FAQ at  
http://www.tux.org/lkml/