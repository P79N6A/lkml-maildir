Date: Tue, 17 Apr 2007 08:18:49 +0200
From: Ingo Molnar <>
Subject: Re: [patch] CFS (Completely Fair Scheduler), v2
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2007/4/17/30

* Gene Heskett <gene.heskett@gmail.com> wrote:
> This one (v2-rc2) is not a keeper I'm sorry to say, Ingo.  v2-rc0 was 
> much better.  Watching amanda run with htop, kmails composer is being 
> subjected to 5 to 10 second pauses, and htop says that gzip -best 
> isn't getting more that 15% of the cpu, and the /amandatapes drive is 
> being written to in a regular pattern that seems to be the cause of 
> the pauses according to gkrellm, which also seems to track the size of 
> the writes, and can show anything from 4.3k to 54 megs as being 
> written in one cycle of its screen update.
ok - fortunately the delta between -v2-rc0 and -v2-final is pretty 
small. One difference is the child-runs-first fix. To restore the 
parent-runs-first logic, do this: 
	echo 0 > /proc/sys/kernel/sched_child_runs_first
does this make any difference?
If not then pretty much the only other change was the nice level tweak i 
did. Could you try to grab a few snapshots of scheduling state via 
something like:
   while sleep 1; do cat /proc/sched_debug >> to-ingo.txt; done
(and tell me the PID of the kmail composer, to make sure i'm checking 
the right task's behavior.)
also, as a separate experiment, could you perhaps run this script as 
root:
   cd /proc; for N in [1-9]*; do renice -n 0 $N; done
this will move all tasks in the system to nice level 0 and should make 
any nice level handling logic in the scheduler irrelevant. Do you have X 
reniced perhaps?
Lots of system threads have negative or positive nice levels, so once 
you have executed this script, only a reboot will be a practical way to 
restore it to the previous settings.
	Ingo
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.kernel.org
More majordomo info at  
http://vger.kernel.org/majordomo-info.html
Please read the FAQ at  
http://www.tux.org/lkml/