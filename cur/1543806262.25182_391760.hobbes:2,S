Date: Mon, 30 Jan 2006 21:49:28 -0500
From: Kevin O'Connor <>
Subject: Size-128 slab leak
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2006/1/30/387

Hi,
I have an annoying slab leak on my kernel.  Every day, I lose about
50Megs of memory to the leak.  It seems to be related to disk
accesses, because the count only goes up noticeable around 4:00am when
the system locate utility runs.
I can tell there is a leak because /proc/slabinfo shows "size-128"
growing continuously.  For example, it currently reads:
size-128          4086041 4106550    128   30    1 : tunables  120   60    8 : slabdata 136885 136885      0
The machine is a vanilla lkml kernel:
Linux double 2.6.15 #1 SMP Wed Jan 4 23:13:51 EST 2006 x86_64 x86_64 x86_64 GNU/Linux
I've noticed this bug on a 2.6.14 kernel also.  This machine is using
libata (sata_uli) along with reiserfs, ext3, and lvm.  I'm interested
in finding ways of diagnosing this problem.  I can provide more
information on demand.  Please CC me on any replies.
Thanks,
-Kevin
00:00.0 Host bridge: ALi Corporation M1695 K8 Northbridge [PCI Express and HyperTransport]
00:01.0 PCI bridge: ALi Corporation: Unknown device 524b
00:02.0 PCI bridge: ALi Corporation: Unknown device 524c
00:04.0 Host bridge: ALi Corporation M1689 K8 Northbridge [Super K8 Single Chip]
00:05.0 PCI bridge: ALi Corporation AGP8X Controller
00:06.0 PCI bridge: ALi Corporation M5249 HTT to PCI Bridge
00:07.0 ISA bridge: ALi Corporation M1563 HyperTransport South Bridge (rev 70)
00:07.1 Bridge: ALi Corporation M7101 Power Management Controller [PMU]
00:08.0 Multimedia audio controller: ALi Corporation M5455 PCI AC-Link Controller Audio Device (rev 20)
00:11.0 Ethernet controller: ALi Corporation M5263 Ethernet Controller (rev 40)
00:12.0 IDE interface: ALi Corporation M5229 IDE (rev c7)
00:12.1 IDE interface: ALi Corporation ULi 5289 SATA (rev 10)
00:13.0 USB Controller: ALi Corporation USB 1.1 Controller (rev 03)
00:13.1 USB Controller: ALi Corporation USB 1.1 Controller (rev 03)
00:13.2 USB Controller: ALi Corporation USB 1.1 Controller (rev 03)
00:13.3 USB Controller: ALi Corporation USB 2.0 Controller (rev 01)
00:18.0 Host bridge: Advanced Micro Devices [AMD] K8 [Athlon64/Opteron] HyperTransport Technology Configuration
00:18.1 Host bridge: Advanced Micro Devices [AMD] K8 [Athlon64/Opteron] Address Map
00:18.2 Host bridge: Advanced Micro Devices [AMD] K8 [Athlon64/Opteron] DRAM Controller
00:18.3 Host bridge: Advanced Micro Devices [AMD] K8 [Athlon64/Opteron] Miscellaneous Control
03:00.0 VGA compatible controller: ATI Technologies Inc RV280 [Radeon 9200 PRO] (rev 01)
03:00.1 Display controller: ATI Technologies Inc: Unknown device 5940 (rev 01)
processor	: 0
vendor_id	: AuthenticAMD
cpu family	: 15
model		: 43
model name	: AMD Athlon(tm) 64 X2 Dual Core Processor 3800+
stepping	: 1
cpu MHz		: 1000.051
cache size	: 512 KB
physical id	: 0
siblings	: 2
core id		: 0
cpu cores	: 2
fpu		: yes
fpu_exception	: yes
cpuid level	: 1
wp		: yes
flags		: fpu vme de pse tsc msr pae mce cx8 apic sep mtrr pge mca cmov pat pse36 clflush mmx fxsr sse sse2 ht syscall nx mmxext fxsr_opt lm 3dnowext 3dnow pni lahf_lm cmp_legacy
bogomips	: 2002.42
TLB size	: 1024 4K pages
clflush size	: 64
cache_alignment	: 64
address sizes	: 40 bits physical, 48 bits virtual
power management: ts fid vid ttp
processor	: 1
vendor_id	: AuthenticAMD
cpu family	: 15
model		: 43
model name	: AMD Athlon(tm) 64 X2 Dual Core Processor 3800+
stepping	: 1
cpu MHz		: 1000.051
cache size	: 512 KB
physical id	: 0
siblings	: 2
core id		: 1
cpu cores	: 2
fpu		: yes
fpu_exception	: yes
cpuid level	: 1
wp		: yes
flags		: fpu vme de pse tsc msr pae mce cx8 apic sep mtrr pge mca cmov pat pse36 clflush mmx fxsr sse sse2 ht syscall nx mmxext fxsr_opt lm 3dnowext 3dnow pni lahf_lm cmp_legacy
bogomips	: 2002.42
TLB size	: 1024 4K pages
clflush size	: 64
cache_alignment	: 64
address sizes	: 40 bits physical, 48 bits virtual
power management: ts fid vid ttp
Module                  Size  Used by
cramfs                 46144  1 
loop                   19472  2 
ppp_deflate             8192  0 
zlib_deflate           26016  1 ppp_deflate
ppp_async              15488  0 
crc_ccitt               3200  1 ppp_async
ppp_generic            36384  2 ppp_deflate,ppp_async
slhc                    8960  1 ppp_generic
vfat                   17152  0 
fat                    60976  1 vfat
usb_storage            86592  0 
snd_rtctimer            4888  0 
udf                    92064  1 
nls_utf8                3328  0 
ipaq                   40880  0 
usbserial              38612  1 ipaq
radeon                119584  1 
drm                   100776  2 radeon
ipv6                  311680  14 
parport_pc             33900  0 
lp                     16960  0 
parport                46604  2 parport_pc,lp
autofs4                25608  1 
w83627hf               35344  0 
hwmon_vid               3712  1 w83627hf
hwmon                   4616  1 w83627hf
eeprom                  9744  0 
i2c_isa                 7552  1 w83627hf
i2c_dev                14208  0 
i2c_core               27904  4 w83627hf,eeprom,i2c_isa,i2c_dev
sunrpc                184504  1 
pcmcia                 48816  0 
yenta_socket           31628  0 
rsrc_nonstatic         15872  1 yenta_socket
pcmcia_core            50228  3 pcmcia,yenta_socket,rsrc_nonstatic
reiserfs              285688  2 
video                  20488  0 
button                  8992  0 
battery                12168  0 
ac                      6792  0 
ohci_hcd               24708  0 
ehci_hcd               38920  0 
shpchp                 53888  0 
snd_intel8x0           39592  0 
snd_ac97_codec        117180  1 snd_intel8x0
snd_ac97_bus            3840  1 snd_ac97_codec
snd_seq_dummy           5380  0 
snd_seq_oss            41700  0 
snd_seq_midi_event     10368  1 snd_seq_oss
snd_seq                70616  5 snd_seq_dummy,snd_seq_oss,snd_seq_midi_event
snd_seq_device         12048  3 snd_seq_dummy,snd_seq_oss,snd_seq
snd_pcm_oss            63264  0 
snd_mixer_oss          21632  1 snd_pcm_oss
snd_pcm               111624  3 snd_intel8x0,snd_ac97_codec,snd_pcm_oss
snd_timer              30600  3 snd_rtctimer,snd_seq,snd_pcm
snd                    73696  9 snd_intel8x0,snd_ac97_codec,snd_seq_oss,snd_seq,snd_seq_device,snd_pcm_oss,snd_mixer_oss,snd_pcm,snd_timer
soundcore              13088  1 snd
snd_page_alloc         13840  2 snd_intel8x0,snd_pcm
uli526x                21268  0 
dm_snapshot            18768  0 
dm_zero                 2816  0 
dm_mirror              25320  0 
ext3                  152848  2 
jbd                    68904  1 ext3
dm_mod                 69064  8 dm_snapshot,dm_zero,dm_mirror
sata_uli                8964  1 
libata                 67224  1 sata_uli
sd_mod                 21632  1 
scsi_mod              166712  3 usb_storage,libata,sd_mod
[unhandled content-type:application/x-gzip]