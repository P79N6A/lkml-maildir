Date: Mon, 23 Apr 2001 18:03:30 +0200
From: Lukasz Trabinski <>
Subject: Re: Problem with "su -" and kernels 2.4.3-ac11 and higher
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2001/4/23/114

In article <20010422102234.A1093@ulthar.internal.mclure.org> you wrote:
> I'm having a problem with "su -" on ac11/ac12. ac5 doesn't show the
> problem.
> The problem is easy to reproduce - go to a console, log in as root, do an
> "su -" (this will succeed) and then another "su -". The second "su -"
> should hang - ps shows it started bash and that the bash process is
> sleeping. You need to "kill -9" the bash to get your prompt back.
> Distribution is Red Hat 7.1, running on an Athlon Thunderbird 900MHz on a
> MSI K7T Turbo R motherboard.
I have tested it on 2.4.4pre6, here is result:
[root@lt /root]# su - test
[root@lt /root]# ps xaf
 1372 tty1     S      0:00 login -- root
 1373 tty1     S      0:00  \_ -bash
 1819 tty1     S      0:00      \_ su - test
 1820 tty1     S      0:00          \_ -bash
 1846 tty1     T      0:00              \_ stty erase ?
Last 10 lines from gdb su
Loaded symbols for /lib/security/pam_env.so
Reading symbols from /lib/security/pam_unix.so...done.
Loaded symbols for /lib/security/pam_unix.so
Reading symbols from /lib/security/pam_cracklib.so...done.
Loaded symbols for /lib/security/pam_cracklib.so
Reading symbols from /usr/lib/libcrack.so.2...done.
Loaded symbols for /usr/lib/libcrack.so.2
Reading symbols from /lib/security/pam_limits.so...done.
Loaded symbols for /lib/security/pam_limits.so
0x401156c9 in __wait4 () from /lib/libc.so.6
(gdb)
but:
[lukasz@lt lukasz]$ su -
Password:
[root@lt /root]#
It's looks OK :)
[lukasz@lt lukasz]$ su --version
su (GNU sh-utils) 2.0
[lukasz@lt lukasz]$ bash --version
GNU bash, version 2.04.21(1)-release (i386-redhat-linux-gnu)
Copyright 1999 Free Software Foundation, Inc.
[lukasz@lt lukasz]$ stty --version
stty (GNU sh-utils) 2.0
Kernel 2.4.4-pre6, 2.2.2-10, 0.74-22  - RedHat 7.1
AMD-K6 300 Mhz,
-- 
*[ Łukasz Trąbiński ]*
SysAdmin @wsisiz.edu.pl
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.kernel.org
More majordomo info at  
http://vger.kernel.org/majordomo-info.html
Please read the FAQ at  
http://www.tux.org/lkml/