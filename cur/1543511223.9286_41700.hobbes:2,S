Date: Fri, 01 Oct 1999 11:05:29 +1000
From: Scott Thomson <>
Subject: HPT366 DMA disabled against will
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/1999/9/30/121

<bigger>Please help. 
I have gone through the last three months of this mailing list and have
read every message to do with ATA66, DMA, HPT366 etc etc, but I cant get
DMA working still.
I have set the kernel options ide2-ata66 and ide2-dma but according to
the syslog, they aren't recognised.
I am running 2.2.12 with the ide patch and CONFIG_IDEDMA_AUTO is
enabled.
The board is an ABIT BE6 and the BIOS settings for IDE are all AUTO.
As the system stands ide2 is the raid5 bottleneck, and it takes __ages__
to ckraid the big md. 
Thanks in advance.
Scott Thomson
ps. The syslog is as follows-
Oct  1 18:25:02 gulag kernel: klogd 1.3-3#31, log source = /proc/kmsg
started.
Oct  1 18:25:02 gulag kernel: Inspecting /boot/System.map-2.2.12
Oct  1 18:25:03 gulag kernel: Loaded 4868 symbols from
/boot/System.map-2.2.12.
Oct  1 18:25:03 gulag kernel: Symbols match kernel version 2.2.12.
Oct  1 18:25:03 gulag kernel: No module symbols loaded - kernel modules
not enabled. 
Oct  1 18:25:03 gulag kernel: Linux version 2.2.12 (root@gulag) (gcc
version 2.7.2.3) #1 Tue Sep 28 00:47:36 EST 1999 
Oct  1 18:25:03 gulag kernel: Detected 451027283 Hz processor. 
Oct  1 18:25:03 gulag kernel: ide_setup: ide2-ata66 -- BAD OPTION 
Oct  1 18:25:03 gulag kernel: ide_setup: ide2-dma -- BAD OPTION 
Oct  1 18:25:03 gulag kernel: Console: colour VGA+ 80x25 
Oct  1 18:25:03 gulag kernel: Calibrating delay loop... 448.92 BogoMIPS 
Oct  1 18:25:03 gulag kernel: Memory: 59292k/65536k available (832k
kernel code, 412k reserved, 860k data, 44k init) 
Oct  1 18:25:03 gulag kernel: CPU: Intel Pentium III (Katmai) stepping 03 
Oct  1 18:25:03 gulag kernel: Checking 386/387 coupling... OK, FPU using
exception 16 error reporting. 
Ocy  1 18:25:03 gulag kernel: Checking 'hlt' instruction... OK. 
Oct  1 18:25:03 gulag kernel: POSIX conformance testing by UNIFIX 
Oct  1 18:25:03 gulag kernel: mtrr: v1.35a (19990819) Richard Gooch
(rgooch@atnf.csiro.au) 
Oct  1 18:25:03 gulag kernel: PCI: PCI BIOS revision 2.10 entry at
0xfb420 
Oct  1 18:25:03 gulag kernel: PCI: Using configuration type 1 
Oct  1 18:25:03 gulag kernel: PCI: Probing PCI hardware 
Oct  1 18:25:03 gulag kernel: Linux NET4.0 for Linux 2.2 
Oct  1 18:25:03 gulag kernel: Based upon Swansea University Computer
Society NET3.039 
Oct  1 18:25:03 gulag kernel: NET4: Unix domain sockets 1.0 for Linux
NET4.0. 
Oct  1 18:25:03 gulag kernel: NET4: Linux TCP/IP 1.0 for NET4.0 
Oct  1 18:25:03 gulag kernel: IP Protocols: ICMP, UDP, TCP 
Oct  1 18:25:03 gulag kernel: Starting kswapd v 1.5  
Oct  1 18:25:03 gulag kernel: Serial driver version 4.27 with no serial
options enabled 
Oct  1 18:25:03 gulag kernel: ttyS00 at 0x03f8 (irq = 4) is a 16550A 
Oct  1 18:25:03 gulag kernel: ttyS01 at 0x02f8 (irq = 3) is a 16550A 
Oct  1 18:25:03 gulag kernel: RAM disk driver initialized:  16 RAM disks
of 4096K size 
Oct  1 18:25:03 gulag kernel: loop: registered device at major 7 
Oct  1 18:25:03 gulag kernel: Uniform Multi-Platform E-IDE driver
Revision: 6.20 
Oct  1 18:25:03 gulag kernel: PIIX4: IDE controller on PCI bus 00 dev 39 
Oct  1 18:25:03 gulag kernel: PIIX4: not 100% native mode: will probe
irqs later 
Oct  1 18:25:03 gulag kernel:     ide0: BM-DMA at 0xf000-0xf007, BIOS
settings: hda:DMA, hdb:pio 
Oct  1 18:25:03 gulag kernel:     ide1: BM-DMA at 0xf008-0xf00f, BIOS
settings: hdc:DMA, hdd:pio 
Oct  1 18:25:03 gulag kernel: HPT366: onboard version of chipset, pin1=1
pin2=2 
Oct  1 18:25:03 gulag kernel: PCI: HPT366: Fixing interrupt 11 pin 2 to
ZERO  
Oct  1 18:25:03 gulag kernel: HPT366: IDE controller on PCI bus 00 dev 98 
Oct  1 18:25:03 gulag kernel: HPT366: not 100% native mode: will probe
irqs later 
Oct  1 18:25:03 gulag kernel:     ide2: BM-DMA at 0xe000-0xe007, BIOS
settings: hde:DMA, hdf:pio 
Oct  1 18:25:03 gulag kernel: hda: QUANTUM FIREBALL CX13.0A, ATA DISK
drive 
Oct  1 18:25:03 gulag kernel: hdc: QUANTUM FIREBALL CX13.0A, ATA DISK
drive 
Oct  1 18:25:03 gulag kernel: hde: QUANTUM FIREBALL CX13.0A, ATA DISK
drive 
Oct  1 18:25:03 gulag kernel: ide0 at 0x1f0-0x1f7,0x3f6 on irq 14 
Oct  1 18:25:03 gulag kernel: ide1 at 0x170-0x177,0x376 on irq 15 
Oct  1 18:25:03 gulag kernel: ide2 at 0xd800-0xd807,0xdc02 on irq 11 
Oct  1 18:25:03 gulag kernel: hda: QUANTUM FIREBALL CX13.0A, 12416MB
w/418kB Cache, CHS=12614/32/63, UDMA(33) 
Oct  1 18:25:03 gulag kernel: hdc: QUANTUM FIREBALL CX13.0A, 12416MB
w/418kB Cache, CHS=25228/16/63, UDMA(33) 
Oct  1 18:25:03 gulag kernel: hde: QUANTUM FIREBALL CX13.0A, 12416MB
w/418kB Cache, CHS=25228/16/63, UDMA(66) 
Oct  1 18:25:03 gulag kernel: Floppy drive(s): fd0 is 1.44M 
Oct  1 18:25:03 gulag kernel: FDC 0 is a post-1991 82077 
Oct  1 18:25:03 gulag kernel: md driver 0.36.6 MAX_MD_DEV=4, MAX_REAL=8 
Oct  1 18:25:03 gulag kernel: raid5 personality registered 
Oct  1 18:25:03 gulag kernel: rtl8139.c:v1.07 5/6/99 Donald Becker
http://cesdis.gsfc.nasa.gov/linux/drivers/rtl8139.html
 
Oct  1 18:25:03 gulag kernel: eth0: RealTek RTL8139 Fast Ethernet at
0xd400, IRQ 12, 00:48:54:3f:78:42. 
Oct  1 18:25:03 gulag kernel: Partition check: 
Oct  1 18:25:03 gulag kernel:  hda: [PTBL] [1582/255/63] hda1 hda2 hda3
hda4 
Oct  1 18:25:03 gulag kernel:  hdc: hdc1 hdc2 hdc3 hdc4 
Oct  1 18:25:03 gulag kernel:  hde:hde: timeout waiting for DMA 
Oct  1 18:25:03 gulag kernel: hde: irq timeout: status=0x58 { DriveReady
SeekComplete DataRequest } 
Oct  1 18:25:03 gulag kernel: hde: DMA disabled 
Oct  1 18:25:03 gulag kernel: ide2: reset: success 
Oct  1 18:25:03 gulag kernel:  hde1 hde2 hde3 hde4 </bigger>
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.rutgers.edu
Please read the FAQ at 
http://www.tux.org/lkml/