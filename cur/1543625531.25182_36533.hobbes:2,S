Date: Thu, 21 Mar 2002 09:59:49 -0500
From: Mark Gross <>
Subject: Re: [PATCH] multithreaded coredumps for elf exeecutables
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2002/3/21/152

On Thursday 21 March 2002 12:34 pm, Alan Cox wrote:
> > This why I grabbed all those locks, and did the two sets of IPI's in the
> > tcore patch.  Once the runqueue lock is grabbed, even if that process on
> > the
>
> If you IPI holding a lock whats going to happen if while the IPI is going
> across the cpus the other processor tries to grab the runqueue lock and
> is spinning on it with interrupts off ?
Then the at least 2 CPU's would quickly become dead locked on the 
synchronization IPI this patch sends at the end of the suspend_other_threads 
function call.
Interrupts shouldn't be turned off when grabbing the runqueue lock.  Its also 
a bad thing if they would happen to be off while calling into to schedule.  
I think schedule was designed to be called only while interrupts are turned 
on.  It BUG's if "in_interrupt" to enforce this.
--mgross
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.kernel.org
More majordomo info at  
http://vger.kernel.org/majordomo-info.html
Please read the FAQ at  
http://www.tux.org/lkml/