Date: Sat, 10 Mar 2007 02:31:43 -0200
From: Mauro Carvalho Chehab <>
Subject: [RFC PATCH 2/3] Update mtd use of symbol_(get|put)
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2007/3/9/520

From: Trent Piepho <xyzzy@speakeasy.org>
Make the mtd sub-system work with changes to __symbol_get().  mtd calls
__symbol_get() directly, rather than through the symbol_get() macro
because it uses a string it created with sprintf to specify the symbol
to
attach to.  It needs to be updated to supply THIS_MODULE as the user
parameter added to __symbol_get().
Signed-off-by: Trent Piepho <xyzzy@speakeasy.org>
diff --git a/drivers/mtd/chips/gen_probe.c
b/drivers/mtd/chips/gen_probe.c
--- a/drivers/mtd/chips/gen_probe.c
+++ b/drivers/mtd/chips/gen_probe.c
@@ -211,10 +211,10 @@ static inline struct mtd_info *cfi_cmdse
 
 	sprintf(probename, MODULE_SYMBOL_PREFIX "cfi_cmdset_%4.4X", type);
 
-	probe_function = __symbol_get(probename);
+	probe_function = __symbol_get(probename, THIS_MODULE);
 	if (!probe_function) {
 		request_module(probename + sizeof(MODULE_SYMBOL_PREFIX) - 1);
-		probe_function = __symbol_get(probename);
+		probe_function = __symbol_get(probename, THIS_MODULE);
 	}
 
 	if (probe_function) {
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.kernel.org
More majordomo info at  
http://vger.kernel.org/majordomo-info.html
Please read the FAQ at  
http://www.tux.org/lkml/