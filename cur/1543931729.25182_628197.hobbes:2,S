Date: Fri, 14 Dec 2007 09:50:23 -0800
From: Andrew Morton <>
Subject: Re: 2.6.22-stable causes oomkiller to be invoked
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2007/12/14/230

On Fri, 14 Dec 2007 21:46:37 +0530 Dhaval Giani <dhaval@linux.vnet.ibm.com> wrote:
> On Sat, Dec 15, 2007 at 12:54:09AM +0900, Tejun Heo wrote:
> > Dhaval Giani wrote:
> > > XXX sysfs_page_cnt=1
> > 
> > Hmm.. so, sysfs r/w buffer wasn't the culprit.  I'm curious what eats up
> > all your low memory.  Please do the following.
> > 
> > 1. Right after boot, record /proc/meminfo and slabinfo.
> > 
> > 2. After or near OOM, record /proc/meminfo and slabinfo.  This can be
> > tricky but if your machine reliably OOMs after 10mins, run it for 9mins
> > and capturing the result should show enough.
> > 
> 
> Attached. The results are after oom, but i think about a min or so after
> that. I missed the oom point.
Looking back at your original oom-killer output: something has consumed all
your ZONE_NORMAL memory and we cannot tell what it is.
Please run 2.6.24-rc5-mm1 again (with CONFIG_PAGE_OWNER=y) and take a peek
at the changelog in
ftp://ftp.kernel.org/pub/linux/kernel/people/akpm/patches/2.6/2.6.24-rc5/2.6.24-rc5-mm1/broken-out/page-owner-tracking-leak-detector.patch.
Build up Documentation/page_owner.c then cause the leak to happen then
execute page_owner.
Thanks.