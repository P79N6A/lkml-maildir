Date: Thu, 27 Sep 2007 13:13:48 +0200
From: Jens Axboe <>
Subject: Re: [PATCH 000 of 4] Change prototype for bi_end_io
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2007/9/27/66

On Thu, Sep 27 2007, NeilBrown wrote:
> Hi Jens,
>  here are a few more patches from my set that makes various changes to bio
>  submission and handling.
> 
>  These change the ->bi_end_io prototype so that
>    1/ no 'size' is passed
>    2/ there is no return value.
> 
>  The 'size' is not really of interest to any bi_end_io handler in existance. 
>  It is really only an internal detail to the "request" handling in ll_rw_blk
>  and lower levels.
>  The return value is completely unused.
> 
>  After these patches, ->bi_end_io is only ever called once per bio.
> 
>  Note that the last patch makes lots and lots of simple changes.  I
>  think I have found all the right places, but any recently added
>  device drivers might still be using the old bi_end_io prototype.
>  I'll grep again after these patches are in your tree.
Thanks Neil, this looks good! We get rid of the ability to do partial
completions. It's a nice concept in theory, but as you noted nobody uses
it. And most drivers only do real full completions anyway, so there's
little interest in supporting it.
>  That patches are against linux-block as of an hour ago.
I had to shoe horn the patches a bit, they really should be on the
block-2.6.24 branch. But that's ok, even if you had done them against
that branch, I had to redo the barrier branch and the sglist stuff
anyway.
-- 
Jens Axboe
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.kernel.org
More majordomo info at  
http://vger.kernel.org/majordomo-info.html
Please read the FAQ at  
http://www.tux.org/lkml/