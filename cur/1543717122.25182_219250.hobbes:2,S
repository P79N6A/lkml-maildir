Date: Sun, 09 May 2004 22:48:09 -0400
From: Jon Oberheide <>
Subject: [PATCH] [RFC] adding support for .patches and /proc/patches.gz
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2004/5/9/94

Greetings,
This feature has been brought up several times before, as can be seen
here:
http://www.ussg.iu.edu/hypermail/linux/kernel/0404.3/0798.html
http://www.uwsg.iu.edu/hypermail/linux/kernel/0203.1/0598.html
http://www.uwsg.iu.edu/hypermail/linux/kernel/9803.0/0223.html
For those unfamiliar, a file linux/.patches would be adding to the
source tree.  When applying patches to the source tree, descriptive
information would be written to .patches.  After compilation and running
of this kernel, the .patches information would be accessible through
/proc/patches.gz; similar to the /proc/config.gz feature.
When a user requests help troubleshooting, they can send a developer the
output of `zcat /proc/patches.gz` along with their /proc/config.gz,
traces, dmesg, etc.  A list of applied patches to the user's source tree
can make it much easier and quicker to track down a bug.  In addition,
users of stock distribution kernels will be able to identify all the
patches applied by "Your Favorite Distro".
Getting .patches adopted into common use is the main problem.  Here are
several solutions towards making effective use of .patches...in order
from terrible to ideal:
Solution 1:
Free-for-all .patches file.  Vendors and developers could write whatever
data they see fit to the file.
Pros: NULL
Cons: TOO much flexibility; no structure; confusion; flash floods; would
render .patches practically useless
Solution 2:
Use a format similar to the MAINTAINERS to keep information about
applied patches.
Pros: uniform structure; descriptive data
Cons: additional code would be necessary to modify the .patches file
which is not very desirable when passing around small diffs.
Solution 3:
Incorporate a command line flag (or possibly a wrapper) in patch (such
as -k) to indicate that the user will be performing a kernel patch and
therefore patch should write information (such as the patch filename,
date, etc) to .patches in a uniform format.  Patch information could be
inserted into .patches when a patch is applied and removed when it is
reserved (-R).
Pros: Automatic insertion/removal into .patches via normal diff's;
requires no extra code besides the -k flag
Cons: All vendors would have to modify their utilities and remember to
pass this flag to patch; users/developers manually patching would have
to remember it as well.
Solution 4:
Incorporate insertion and removal globally into patch without the need
for a flag (perhaps have a flag to NOT use it if desired).  Patch
information could be inserted into .patches when a patch is applied and
removed when it is reserved (-R).
Pros: Automatic insertion/removal into .patches via normal diff's; no
vendor, developer, user intervention required to implement; the .patches
file could be easily used by other software as it would be default in
patch;
Cons: politics: an arguably radical change to patch
I'm CC'ing this to the GNU patch maintainers.  Hopefully they will have
some input.  Attached is four patch files which apply to
2.6.6-rc3-bk11.  It would likely be best for these to sit in mm until
one of the above solutions is reached:
dotpatches-Kconfig: Kconfig update and .patches creation
dotpatches-defconfigs: set defconfigs identical to /proc/config feature
dotpatches-kernel: modifications in linux/kernel
dotpatches-scripts: modifications in linux/scripts
Regards,
Jon Oberheide
jon@focalhost.com
diff -urN linux-2.6.5.old/init/Kconfig linux-2.6.5/init/Kconfig
--- linux-2.6.5.old/init/Kconfig	2004-05-09 13:06:33.000000000 -0500
+++ linux-2.6.5/init/Kconfig	2004-05-09 14:43:04.929060072 -0500
@@ -218,6 +218,25 @@
 	  This option enables access to kernel configuration file and build
 	  information through /proc/config.gz.
 
+config IKPATCHES
+	bool "Kernel .patches support"
+	---help---
+	  This option enables the kernel's ".patches" file to be saved in
+	  the kernel.  The .patches file is used to store important
+	  information about patches that have been applied to the running
+	  kernel's original source.  The .patches data can be valuable
+	  while troubleshooting and tracking down bugs.  This information
+	  can be extracted from the kernel image file with the script 
+	  scripts/extract-ikpatches.  It can also be extracted from a 
+	  running kernel by reading /proc/patches.gz, if enabled (below).
+
+config IKPATCHES_PROC
+	bool "Enable access to .patches through /proc/patches.gz"
+	depends on IKPATCHES && PROC_FS
+	---help---
+	  This option enables access to information about kernel patches
+	  through /proc/patches.gz.
+
 
 menuconfig EMBEDDED
 	bool "Configure standard kernel features (for small systems)"
diff -uN linux-2.6.5.old/.patches linux-2.6.5/.patches
--- linux-2.6.5.old/.patches	1969-12-31 19:00:00.000000000 -0500
+++ linux-2.6.5/.patches	2004-05-09 15:20:24.304623240 -0500
@@ -0,0 +1,1 @@
+diff -ur linux-2.6.5.old/arch/alpha/defconfig linux-2.6.5/arch/alpha/defconfig
--- linux-2.6.5.old/arch/alpha/defconfig	2004-05-09 10:35:57.000000000 -0500
+++ linux-2.6.5/arch/alpha/defconfig	2004-05-09 11:58:52.670444760 -0500
@@ -25,6 +25,7 @@
 CONFIG_LOG_BUF_SHIFT=14
 # CONFIG_HOTPLUG is not set
 # CONFIG_IKCONFIG is not set
+# CONFIG_IKPATCHES is not set
 # CONFIG_EMBEDDED is not set
 CONFIG_KALLSYMS=y
 CONFIG_FUTEX=y
diff -ur linux-2.6.5.old/arch/arm/configs/assabet_defconfig linux-2.6.5/arch/arm/configs/assabet_defconfig
--- linux-2.6.5.old/arch/arm/configs/assabet_defconfig	2004-05-09 10:35:54.000000000 -0500
+++ linux-2.6.5/arch/arm/configs/assabet_defconfig	2004-05-09 11:58:52.927405696 -0500
@@ -26,6 +26,7 @@
 CONFIG_LOG_BUF_SHIFT=14
 CONFIG_HOTPLUG=y
 # CONFIG_IKCONFIG is not set
+# CONFIG_IKPATCHES is not set
 # CONFIG_EMBEDDED is not set
 CONFIG_KALLSYMS=y
 CONFIG_FUTEX=y
diff -ur linux-2.6.5.old/arch/arm/configs/bast_defconfig linux-2.6.5/arch/arm/configs/bast_defconfig
--- linux-2.6.5.old/arch/arm/configs/bast_defconfig	2004-05-09 10:35:54.000000000 -0500
+++ linux-2.6.5/arch/arm/configs/bast_defconfig	2004-05-09 11:58:52.851417248 -0500
@@ -24,6 +24,7 @@
 CONFIG_SYSCTL=y
 CONFIG_LOG_BUF_SHIFT=16
 # CONFIG_IKCONFIG is not set
+# CONFIG_IKPATCHES is not set
 # CONFIG_EMBEDDED is not set
 CONFIG_KALLSYMS=y
 CONFIG_FUTEX=y
diff -ur linux-2.6.5.old/arch/arm/configs/cerfcube_defconfig linux-2.6.5/arch/arm/configs/cerfcube_defconfig
--- linux-2.6.5.old/arch/arm/configs/cerfcube_defconfig	2004-05-09 10:35:54.000000000 -0500
+++ linux-2.6.5/arch/arm/configs/cerfcube_defconfig	2004-05-09 11:58:52.867414816 -0500
@@ -23,6 +23,7 @@
 CONFIG_SYSCTL=y
 CONFIG_LOG_BUF_SHIFT=14
 # CONFIG_IKCONFIG is not set
+# CONFIG_IKPATCHES is not set
 # CONFIG_EMBEDDED is not set
 CONFIG_KALLSYMS=y
 CONFIG_FUTEX=y
diff -ur linux-2.6.5.old/arch/arm/configs/epxa10db_defconfig linux-2.6.5/arch/arm/configs/epxa10db_defconfig
--- linux-2.6.5.old/arch/arm/configs/epxa10db_defconfig	2004-05-09 10:35:54.000000000 -0500
+++ linux-2.6.5/arch/arm/configs/epxa10db_defconfig	2004-05-09 11:58:52.837419376 -0500
@@ -24,6 +24,7 @@
 CONFIG_LOG_BUF_SHIFT=14
 # CONFIG_HOTPLUG is not set
 # CONFIG_IKCONFIG is not set
+# CONFIG_IKPATCHES is not set
 # CONFIG_EMBEDDED is not set
 CONFIG_KALLSYMS=y
 CONFIG_FUTEX=y
diff -ur linux-2.6.5.old/arch/arm/configs/lart_defconfig linux-2.6.5/arch/arm/configs/lart_defconfig
--- linux-2.6.5.old/arch/arm/configs/lart_defconfig	2004-05-09 10:35:54.000000000 -0500
+++ linux-2.6.5/arch/arm/configs/lart_defconfig	2004-05-09 11:58:52.878413144 -0500
@@ -23,6 +23,7 @@
 CONFIG_SYSCTL=y
 CONFIG_LOG_BUF_SHIFT=14
 # CONFIG_IKCONFIG is not set
+# CONFIG_IKPATCHES is not set
 # CONFIG_EMBEDDED is not set
 CONFIG_KALLSYMS=y
 CONFIG_FUTEX=y
diff -ur linux-2.6.5.old/arch/arm/configs/lubbock_defconfig linux-2.6.5/arch/arm/configs/lubbock_defconfig
--- linux-2.6.5.old/arch/arm/configs/lubbock_defconfig	2004-05-09 10:35:54.000000000 -0500
+++ linux-2.6.5/arch/arm/configs/lubbock_defconfig	2004-05-09 11:58:52.853416944 -0500
@@ -26,6 +26,7 @@
 CONFIG_LOG_BUF_SHIFT=14
 CONFIG_HOTPLUG=y
 # CONFIG_IKCONFIG is not set
+# CONFIG_IKPATCHES is not set
 # CONFIG_EMBEDDED is not set
 CONFIG_KALLSYMS=y
 CONFIG_FUTEX=y
diff -ur linux-2.6.5.old/arch/arm/configs/netwinder_defconfig linux-2.6.5/arch/arm/configs/netwinder_defconfig
--- linux-2.6.5.old/arch/arm/configs/netwinder_defconfig	2004-05-09 10:35:54.000000000 -0500
+++ linux-2.6.5/arch/arm/configs/netwinder_defconfig	2004-05-09 11:58:52.824421352 -0500
@@ -23,6 +23,7 @@
 CONFIG_SYSCTL=y
 CONFIG_LOG_BUF_SHIFT=14
 # CONFIG_IKCONFIG is not set
+# CONFIG_IKPATCHES is not set
 # CONFIG_EMBEDDED is not set
 CONFIG_KALLSYMS=y
 CONFIG_FUTEX=y
diff -ur linux-2.6.5.old/arch/arm/configs/s3c2410_defconfig linux-2.6.5/arch/arm/configs/s3c2410_defconfig
--- linux-2.6.5.old/arch/arm/configs/s3c2410_defconfig	2004-05-09 10:35:54.000000000 -0500
+++ linux-2.6.5/arch/arm/configs/s3c2410_defconfig	2004-05-09 11:58:52.955401440 -0500
@@ -24,6 +24,7 @@
 CONFIG_SYSCTL=y
 CONFIG_LOG_BUF_SHIFT=16
 # CONFIG_IKCONFIG is not set
+# CONFIG_IKPATCHES is not set
 # CONFIG_EMBEDDED is not set
 CONFIG_KALLSYMS=y
 CONFIG_FUTEX=y
diff -ur linux-2.6.5.old/arch/arm/configs/shark_defconfig linux-2.6.5/arch/arm/configs/shark_defconfig
--- linux-2.6.5.old/arch/arm/configs/shark_defconfig	2004-05-09 10:35:54.000000000 -0500
+++ linux-2.6.5/arch/arm/configs/shark_defconfig	2004-05-09 11:58:52.953401744 -0500
@@ -24,6 +24,7 @@
 CONFIG_SYSCTL=y
 CONFIG_LOG_BUF_SHIFT=14
 # CONFIG_IKCONFIG is not set
+# CONFIG_IKPATCHES is not set
 # CONFIG_EMBEDDED is not set
 CONFIG_KALLSYMS=y
 CONFIG_FUTEX=y
diff -ur linux-2.6.5.old/arch/arm/configs/versatile_defconfig linux-2.6.5/arch/arm/configs/versatile_defconfig
--- linux-2.6.5.old/arch/arm/configs/versatile_defconfig	2004-05-09 10:35:54.000000000 -0500
+++ linux-2.6.5/arch/arm/configs/versatile_defconfig	2004-05-09 11:58:52.862415576 -0500
@@ -26,6 +26,7 @@
 CONFIG_LOG_BUF_SHIFT=14
 CONFIG_HOTPLUG=y
 # CONFIG_IKCONFIG is not set
+# CONFIG_IKPATCHES is not set
 # CONFIG_EMBEDDED is not set
 CONFIG_KALLSYMS=y
 CONFIG_FUTEX=y
diff -ur linux-2.6.5.old/arch/h8300/defconfig linux-2.6.5/arch/h8300/defconfig
--- linux-2.6.5.old/arch/h8300/defconfig	2004-05-09 10:35:58.000000000 -0500
+++ linux-2.6.5/arch/h8300/defconfig	2004-05-09 11:58:53.582306136 -0500
@@ -26,6 +26,7 @@
 # CONFIG_SYSCTL is not set
 CONFIG_LOG_BUF_SHIFT=14
 # CONFIG_IKCONFIG is not set
+# CONFIG_IKPATCHES is not set
 CONFIG_EMBEDDED=y
 CONFIG_KALLSYMS=y
 CONFIG_FUTEX=y
diff -ur linux-2.6.5.old/arch/i386/defconfig linux-2.6.5/arch/i386/defconfig
--- linux-2.6.5.old/arch/i386/defconfig	2004-05-09 10:35:55.000000000 -0500
+++ linux-2.6.5/arch/i386/defconfig	2004-05-09 11:58:55.535009280 -0500
@@ -23,6 +23,7 @@
 CONFIG_LOG_BUF_SHIFT=15
 CONFIG_HOTPLUG=y
 # CONFIG_IKCONFIG is not set
+# CONFIG_IKPATCHES is not set
 # CONFIG_EMBEDDED is not set
 CONFIG_KALLSYMS=y
 CONFIG_FUTEX=y
diff -ur linux-2.6.5.old/arch/ia64/configs/generic_defconfig linux-2.6.5/arch/ia64/configs/generic_defconfig
--- linux-2.6.5.old/arch/ia64/configs/generic_defconfig	2004-05-09 10:35:55.000000000 -0500
+++ linux-2.6.5/arch/ia64/configs/generic_defconfig	2004-05-09 12:31:53.263348872 -0500
@@ -19,6 +19,8 @@
 CONFIG_LOG_BUF_SHIFT=20
 CONFIG_IKCONFIG=y
 CONFIG_IKCONFIG_PROC=y
+CONFIG_IKPATCHES=y
+CONFIG_IKPATCHES_PROC=y
 # CONFIG_EMBEDDED is not set
 CONFIG_KALLSYMS=y
 CONFIG_FUTEX=y
diff -ur linux-2.6.5.old/arch/ia64/configs/sn2_defconfig linux-2.6.5/arch/ia64/configs/sn2_defconfig
--- linux-2.6.5.old/arch/ia64/configs/sn2_defconfig	2004-05-09 10:35:55.000000000 -0500
+++ linux-2.6.5/arch/ia64/configs/sn2_defconfig	2004-05-09 11:58:55.796969456 -0500
@@ -19,6 +19,7 @@
 CONFIG_LOG_BUF_SHIFT=20
 CONFIG_HOTPLUG=y
 # CONFIG_IKCONFIG is not set
+# CONFIG_IKPATCHES is not set
 # CONFIG_EMBEDDED is not set
 CONFIG_KALLSYMS=y
 CONFIG_FUTEX=y
diff -ur linux-2.6.5.old/arch/ia64/configs/zx1_defconfig linux-2.6.5/arch/ia64/configs/zx1_defconfig
--- linux-2.6.5.old/arch/ia64/configs/zx1_defconfig	2004-05-09 10:35:55.000000000 -0500
+++ linux-2.6.5/arch/ia64/configs/zx1_defconfig	2004-05-09 11:58:55.799969000 -0500
@@ -21,6 +21,7 @@
 CONFIG_LOG_BUF_SHIFT=17
 CONFIG_HOTPLUG=y
 # CONFIG_IKCONFIG is not set
+# CONFIG_IKPATCHES is not set
 # CONFIG_EMBEDDED is not set
 CONFIG_KALLSYMS=y
 CONFIG_FUTEX=y
diff -ur linux-2.6.5.old/arch/ia64/defconfig linux-2.6.5/arch/ia64/defconfig
--- linux-2.6.5.old/arch/ia64/defconfig	2004-05-09 10:35:55.000000000 -0500
+++ linux-2.6.5/arch/ia64/defconfig	2004-05-09 12:31:53.388329872 -0500
@@ -22,6 +22,8 @@
 CONFIG_HOTPLUG=y
 CONFIG_IKCONFIG=y
 CONFIG_IKCONFIG_PROC=y
+CONFIG_IKPATCHES=y
+CONFIG_IKPATCHES_PROC=y
 # CONFIG_EMBEDDED is not set
 CONFIG_KALLSYMS=y
 CONFIG_FUTEX=y
diff -ur linux-2.6.5.old/arch/mips/configs/atlas_defconfig linux-2.6.5/arch/mips/configs/atlas_defconfig
--- linux-2.6.5.old/arch/mips/configs/atlas_defconfig	2004-05-09 10:35:55.000000000 -0500
+++ linux-2.6.5/arch/mips/configs/atlas_defconfig	2004-05-09 11:58:56.814814720 -0500
@@ -24,6 +24,7 @@
 CONFIG_LOG_BUF_SHIFT=14
 # CONFIG_HOTPLUG is not set
 # CONFIG_IKCONFIG is not set
+# CONFIG_IKPATCHES is not set
 CONFIG_EMBEDDED=y
 CONFIG_KALLSYMS=y
 CONFIG_FUTEX=y
diff -ur linux-2.6.5.old/arch/mips/configs/bosporus_defconfig linux-2.6.5/arch/mips/configs/bosporus_defconfig
--- linux-2.6.5.old/arch/mips/configs/bosporus_defconfig	2004-05-09 10:35:55.000000000 -0500
+++ linux-2.6.5/arch/mips/configs/bosporus_defconfig	2004-05-09 11:58:56.868806512 -0500
@@ -24,6 +24,7 @@
 CONFIG_LOG_BUF_SHIFT=14
 CONFIG_HOTPLUG=y
 # CONFIG_IKCONFIG is not set
+# CONFIG_IKPATCHES is not set
 CONFIG_EMBEDDED=y
 CONFIG_KALLSYMS=y
 CONFIG_FUTEX=y
diff -ur linux-2.6.5.old/arch/mips/configs/capcella_defconfig linux-2.6.5/arch/mips/configs/capcella_defconfig
--- linux-2.6.5.old/arch/mips/configs/capcella_defconfig	2004-05-09 10:35:55.000000000 -0500
+++ linux-2.6.5/arch/mips/configs/capcella_defconfig	2004-05-09 11:58:56.914799520 -0500
@@ -24,6 +24,7 @@
 CONFIG_LOG_BUF_SHIFT=14
 # CONFIG_HOTPLUG is not set
 # CONFIG_IKCONFIG is not set
+# CONFIG_IKPATCHES is not set
 CONFIG_EMBEDDED=y
 CONFIG_KALLSYMS=y
 CONFIG_FUTEX=y
diff -ur linux-2.6.5.old/arch/mips/configs/cobalt_defconfig linux-2.6.5/arch/mips/configs/cobalt_defconfig
--- linux-2.6.5.old/arch/mips/configs/cobalt_defconfig	2004-05-09 10:35:55.000000000 -0500
+++ linux-2.6.5/arch/mips/configs/cobalt_defconfig	2004-05-09 11:58:56.876805296 -0500
@@ -24,6 +24,7 @@
 CONFIG_LOG_BUF_SHIFT=14
 # CONFIG_HOTPLUG is not set
 # CONFIG_IKCONFIG is not set
+# CONFIG_IKPATCHES is not set
 CONFIG_EMBEDDED=y
 CONFIG_KALLSYMS=y
 CONFIG_FUTEX=y
diff -ur linux-2.6.5.old/arch/mips/configs/db1000_defconfig linux-2.6.5/arch/mips/configs/db1000_defconfig
--- linux-2.6.5.old/arch/mips/configs/db1000_defconfig	2004-05-09 10:35:55.000000000 -0500
+++ linux-2.6.5/arch/mips/configs/db1000_defconfig	2004-05-09 11:58:56.896802256 -0500
@@ -24,6 +24,7 @@
 CONFIG_LOG_BUF_SHIFT=14
 CONFIG_HOTPLUG=y
 # CONFIG_IKCONFIG is not set
+# CONFIG_IKPATCHES is not set
 CONFIG_EMBEDDED=y
 CONFIG_KALLSYMS=y
 CONFIG_FUTEX=y
diff -ur linux-2.6.5.old/arch/mips/configs/db1100_defconfig linux-2.6.5/arch/mips/configs/db1100_defconfig
--- linux-2.6.5.old/arch/mips/configs/db1100_defconfig	2004-05-09 10:35:55.000000000 -0500
+++ linux-2.6.5/arch/mips/configs/db1100_defconfig	2004-05-09 11:58:56.925797848 -0500
@@ -24,6 +24,7 @@
 CONFIG_LOG_BUF_SHIFT=14
 CONFIG_HOTPLUG=y
 # CONFIG_IKCONFIG is not set
+# CONFIG_IKPATCHES is not set
 CONFIG_EMBEDDED=y
 CONFIG_KALLSYMS=y
 CONFIG_FUTEX=y
diff -ur linux-2.6.5.old/arch/mips/configs/db1500_defconfig linux-2.6.5/arch/mips/configs/db1500_defconfig
--- linux-2.6.5.old/arch/mips/configs/db1500_defconfig	2004-05-09 10:35:55.000000000 -0500
+++ linux-2.6.5/arch/mips/configs/db1500_defconfig	2004-05-09 11:58:56.923798152 -0500
@@ -24,6 +24,7 @@
 CONFIG_LOG_BUF_SHIFT=14
 CONFIG_HOTPLUG=y
 # CONFIG_IKCONFIG is not set
+# CONFIG_IKPATCHES is not set
 CONFIG_EMBEDDED=y
 CONFIG_KALLSYMS=y
 CONFIG_FUTEX=y
diff -ur linux-2.6.5.old/arch/mips/configs/ddb5476_defconfig linux-2.6.5/arch/mips/configs/ddb5476_defconfig
--- linux-2.6.5.old/arch/mips/configs/ddb5476_defconfig	2004-05-09 10:35:55.000000000 -0500
+++ linux-2.6.5/arch/mips/configs/ddb5476_defconfig	2004-05-09 11:58:56.884804080 -0500
@@ -24,6 +24,7 @@
 CONFIG_LOG_BUF_SHIFT=14
 # CONFIG_HOTPLUG is not set
 # CONFIG_IKCONFIG is not set
+# CONFIG_IKPATCHES is not set
 CONFIG_EMBEDDED=y
 CONFIG_KALLSYMS=y
 CONFIG_FUTEX=y
diff -ur linux-2.6.5.old/arch/mips/configs/ddb5477_defconfig linux-2.6.5/arch/mips/configs/ddb5477_defconfig
--- linux-2.6.5.old/arch/mips/configs/ddb5477_defconfig	2004-05-09 10:35:55.000000000 -0500
+++ linux-2.6.5/arch/mips/configs/ddb5477_defconfig	2004-05-09 11:58:56.870806208 -0500
@@ -24,6 +24,7 @@
 CONFIG_LOG_BUF_SHIFT=14
 # CONFIG_HOTPLUG is not set
 # CONFIG_IKCONFIG is not set
+# CONFIG_IKPATCHES is not set
 CONFIG_EMBEDDED=y
 CONFIG_KALLSYMS=y
 CONFIG_FUTEX=y
diff -ur linux-2.6.5.old/arch/mips/configs/decstation_defconfig linux-2.6.5/arch/mips/configs/decstation_defconfig
--- linux-2.6.5.old/arch/mips/configs/decstation_defconfig	2004-05-09 10:35:55.000000000 -0500
+++ linux-2.6.5/arch/mips/configs/decstation_defconfig	2004-05-09 11:58:56.928797392 -0500
@@ -24,6 +24,7 @@
 CONFIG_LOG_BUF_SHIFT=14
 # CONFIG_HOTPLUG is not set
 # CONFIG_IKCONFIG is not set
+# CONFIG_IKPATCHES is not set
 CONFIG_EMBEDDED=y
 CONFIG_KALLSYMS=y
 CONFIG_FUTEX=y
diff -ur linux-2.6.5.old/arch/mips/configs/e55_defconfig linux-2.6.5/arch/mips/configs/e55_defconfig
--- linux-2.6.5.old/arch/mips/configs/e55_defconfig	2004-05-09 10:35:55.000000000 -0500
+++ linux-2.6.5/arch/mips/configs/e55_defconfig	2004-05-09 11:58:56.865806968 -0500
@@ -24,6 +24,7 @@
 CONFIG_LOG_BUF_SHIFT=14
 # CONFIG_HOTPLUG is not set
 # CONFIG_IKCONFIG is not set
+# CONFIG_IKPATCHES is not set
 CONFIG_EMBEDDED=y
 CONFIG_KALLSYMS=y
 CONFIG_FUTEX=y
diff -ur linux-2.6.5.old/arch/mips/configs/eagle_defconfig linux-2.6.5/arch/mips/configs/eagle_defconfig
--- linux-2.6.5.old/arch/mips/configs/eagle_defconfig	2004-05-09 10:35:55.000000000 -0500
+++ linux-2.6.5/arch/mips/configs/eagle_defconfig	2004-05-09 11:58:56.894802560 -0500
@@ -24,6 +24,7 @@
 CONFIG_LOG_BUF_SHIFT=14
 CONFIG_HOTPLUG=y
 # CONFIG_IKCONFIG is not set
+# CONFIG_IKPATCHES is not set
 CONFIG_EMBEDDED=y
 CONFIG_KALLSYMS=y
 CONFIG_FUTEX=y
diff -ur linux-2.6.5.old/arch/mips/configs/ev64120_defconfig linux-2.6.5/arch/mips/configs/ev64120_defconfig
--- linux-2.6.5.old/arch/mips/configs/ev64120_defconfig	2004-05-09 10:35:55.000000000 -0500
+++ linux-2.6.5/arch/mips/configs/ev64120_defconfig	2004-05-09 11:58:56.812815024 -0500
@@ -24,6 +24,7 @@
 CONFIG_LOG_BUF_SHIFT=14
 # CONFIG_HOTPLUG is not set
 # CONFIG_IKCONFIG is not set
+# CONFIG_IKPATCHES is not set
 CONFIG_EMBEDDED=y
 CONFIG_KALLSYMS=y
 CONFIG_FUTEX=y
diff -ur linux-2.6.5.old/arch/mips/configs/ev96100_defconfig linux-2.6.5/arch/mips/configs/ev96100_defconfig
--- linux-2.6.5.old/arch/mips/configs/ev96100_defconfig	2004-05-09 10:35:55.000000000 -0500
+++ linux-2.6.5/arch/mips/configs/ev96100_defconfig	2004-05-09 11:58:56.909800280 -0500
@@ -24,6 +24,7 @@
 CONFIG_LOG_BUF_SHIFT=14
 # CONFIG_HOTPLUG is not set
 # CONFIG_IKCONFIG is not set
+# CONFIG_IKPATCHES is not set
 CONFIG_EMBEDDED=y
 CONFIG_KALLSYMS=y
 CONFIG_FUTEX=y
diff -ur linux-2.6.5.old/arch/mips/configs/ip22_defconfig linux-2.6.5/arch/mips/configs/ip22_defconfig
--- linux-2.6.5.old/arch/mips/configs/ip22_defconfig	2004-05-09 10:35:55.000000000 -0500
+++ linux-2.6.5/arch/mips/configs/ip22_defconfig	2004-05-09 12:31:54.561151576 -0500
@@ -25,6 +25,8 @@
 # CONFIG_HOTPLUG is not set
 CONFIG_IKCONFIG=y
 CONFIG_IKCONFIG_PROC=y
+CONFIG_IKPATCHES=y
+CONFIG_IKPATCHES_PROC=y
 CONFIG_EMBEDDED=y
 CONFIG_KALLSYMS=y
 CONFIG_FUTEX=y
diff -ur linux-2.6.5.old/arch/mips/configs/ip27_defconfig linux-2.6.5/arch/mips/configs/ip27_defconfig
--- linux-2.6.5.old/arch/mips/configs/ip27_defconfig	2004-05-09 10:35:55.000000000 -0500
+++ linux-2.6.5/arch/mips/configs/ip27_defconfig	2004-05-09 12:31:54.531156136 -0500
@@ -23,6 +23,8 @@
 # CONFIG_HOTPLUG is not set
 CONFIG_IKCONFIG=y
 CONFIG_IKCONFIG_PROC=y
+CONFIG_IKPATCHES=y
+CONFIG_IKPATCHES_PROC=y
 CONFIG_EMBEDDED=y
 CONFIG_KALLSYMS=y
 CONFIG_FUTEX=y
diff -ur linux-2.6.5.old/arch/mips/configs/ip32_defconfig linux-2.6.5/arch/mips/configs/ip32_defconfig
--- linux-2.6.5.old/arch/mips/configs/ip32_defconfig	2004-05-09 10:35:55.000000000 -0500
+++ linux-2.6.5/arch/mips/configs/ip32_defconfig	2004-05-09 11:58:56.811815176 -0500
@@ -23,6 +23,7 @@
 CONFIG_LOG_BUF_SHIFT=14
 # CONFIG_HOTPLUG is not set
 # CONFIG_IKCONFIG is not set
+# CONFIG_IKPATCHES is not set
 CONFIG_EMBEDDED=y
 CONFIG_KALLSYMS=y
 CONFIG_FUTEX=y
diff -ur linux-2.6.5.old/arch/mips/configs/it8172_defconfig linux-2.6.5/arch/mips/configs/it8172_defconfig
--- linux-2.6.5.old/arch/mips/configs/it8172_defconfig	2004-05-09 10:35:55.000000000 -0500
+++ linux-2.6.5/arch/mips/configs/it8172_defconfig	2004-05-09 11:58:56.910800128 -0500
@@ -24,6 +24,7 @@
 CONFIG_LOG_BUF_SHIFT=14
 # CONFIG_HOTPLUG is not set
 # CONFIG_IKCONFIG is not set
+# CONFIG_IKPATCHES is not set
 CONFIG_EMBEDDED=y
 CONFIG_KALLSYMS=y
 CONFIG_FUTEX=y
diff -ur linux-2.6.5.old/arch/mips/configs/ivr_defconfig linux-2.6.5/arch/mips/configs/ivr_defconfig
--- linux-2.6.5.old/arch/mips/configs/ivr_defconfig	2004-05-09 10:35:55.000000000 -0500
+++ linux-2.6.5/arch/mips/configs/ivr_defconfig	2004-05-09 11:58:56.907800584 -0500
@@ -24,6 +24,7 @@
 CONFIG_LOG_BUF_SHIFT=14
 # CONFIG_HOTPLUG is not set
 # CONFIG_IKCONFIG is not set
+# CONFIG_IKPATCHES is not set
 CONFIG_EMBEDDED=y
 CONFIG_KALLSYMS=y
 CONFIG_FUTEX=y
diff -ur linux-2.6.5.old/arch/mips/configs/jaguar-atx_defconfig linux-2.6.5/arch/mips/configs/jaguar-atx_defconfig
--- linux-2.6.5.old/arch/mips/configs/jaguar-atx_defconfig	2004-05-09 10:35:55.000000000 -0500
+++ linux-2.6.5/arch/mips/configs/jaguar-atx_defconfig	2004-05-09 12:31:54.522157504 -0500
@@ -25,6 +25,8 @@
 # CONFIG_HOTPLUG is not set
 CONFIG_IKCONFIG=y
 CONFIG_IKCONFIG_PROC=y
+CONFIG_IKPATCHES=y
+CONFIG_IKPATCHES_PROC=y
 CONFIG_EMBEDDED=y
 CONFIG_KALLSYMS=y
 CONFIG_FUTEX=y
diff -ur linux-2.6.5.old/arch/mips/configs/jmr3927_defconfig linux-2.6.5/arch/mips/configs/jmr3927_defconfig
--- linux-2.6.5.old/arch/mips/configs/jmr3927_defconfig	2004-05-09 10:35:55.000000000 -0500
+++ linux-2.6.5/arch/mips/configs/jmr3927_defconfig	2004-05-09 11:58:56.879804840 -0500
@@ -24,6 +24,7 @@
 CONFIG_LOG_BUF_SHIFT=14
 # CONFIG_HOTPLUG is not set
 # CONFIG_IKCONFIG is not set
+# CONFIG_IKPATCHES is not set
 CONFIG_EMBEDDED=y
 CONFIG_KALLSYMS=y
 CONFIG_FUTEX=y
diff -ur linux-2.6.5.old/arch/mips/configs/lasat200_defconfig linux-2.6.5/arch/mips/configs/lasat200_defconfig
--- linux-2.6.5.old/arch/mips/configs/lasat200_defconfig	2004-05-09 10:35:55.000000000 -0500
+++ linux-2.6.5/arch/mips/configs/lasat200_defconfig	2004-05-09 11:58:56.877805144 -0500
@@ -24,6 +24,7 @@
 CONFIG_LOG_BUF_SHIFT=14
 # CONFIG_HOTPLUG is not set
 # CONFIG_IKCONFIG is not set
+# CONFIG_IKPATCHES is not set
 CONFIG_EMBEDDED=y
 CONFIG_KALLSYMS=y
 CONFIG_FUTEX=y
diff -ur linux-2.6.5.old/arch/mips/configs/malta_defconfig linux-2.6.5/arch/mips/configs/malta_defconfig
--- linux-2.6.5.old/arch/mips/configs/malta_defconfig	2004-05-09 10:35:55.000000000 -0500
+++ linux-2.6.5/arch/mips/configs/malta_defconfig	2004-05-09 11:58:56.885803928 -0500
@@ -24,6 +24,7 @@
 CONFIG_LOG_BUF_SHIFT=14
 # CONFIG_HOTPLUG is not set
 # CONFIG_IKCONFIG is not set
+# CONFIG_IKPATCHES is not set
 CONFIG_EMBEDDED=y
 CONFIG_KALLSYMS=y
 CONFIG_FUTEX=y
diff -ur linux-2.6.5.old/arch/mips/configs/mirage_defconfig linux-2.6.5/arch/mips/configs/mirage_defconfig
--- linux-2.6.5.old/arch/mips/configs/mirage_defconfig	2004-05-09 10:35:55.000000000 -0500
+++ linux-2.6.5/arch/mips/configs/mirage_defconfig	2004-05-09 11:58:56.863807272 -0500
@@ -24,6 +24,7 @@
 CONFIG_LOG_BUF_SHIFT=14
 CONFIG_HOTPLUG=y
 # CONFIG_IKCONFIG is not set
+# CONFIG_IKPATCHES is not set
 CONFIG_EMBEDDED=y
 CONFIG_KALLSYMS=y
 CONFIG_FUTEX=y
diff -ur linux-2.6.5.old/arch/mips/configs/mpc30x_defconfig linux-2.6.5/arch/mips/configs/mpc30x_defconfig
--- linux-2.6.5.old/arch/mips/configs/mpc30x_defconfig	2004-05-09 10:35:55.000000000 -0500
+++ linux-2.6.5/arch/mips/configs/mpc30x_defconfig	2004-05-09 11:58:56.866806816 -0500
@@ -24,6 +24,7 @@
 CONFIG_LOG_BUF_SHIFT=14
 # CONFIG_HOTPLUG is not set
 # CONFIG_IKCONFIG is not set
+# CONFIG_IKPATCHES is not set
 CONFIG_EMBEDDED=y
 CONFIG_KALLSYMS=y
 CONFIG_FUTEX=y
diff -ur linux-2.6.5.old/arch/mips/configs/mtx1_defconfig linux-2.6.5/arch/mips/configs/mtx1_defconfig
--- linux-2.6.5.old/arch/mips/configs/mtx1_defconfig	2004-05-09 10:35:55.000000000 -0500
+++ linux-2.6.5/arch/mips/configs/mtx1_defconfig	2004-05-09 11:58:56.915799368 -0500
@@ -24,6 +24,7 @@
 CONFIG_LOG_BUF_SHIFT=14
 CONFIG_HOTPLUG=y
 # CONFIG_IKCONFIG is not set
+# CONFIG_IKPATCHES is not set
 CONFIG_EMBEDDED=y
 CONFIG_KALLSYMS=y
 CONFIG_FUTEX=y
diff -ur linux-2.6.5.old/arch/mips/configs/ocelot_c_defconfig linux-2.6.5/arch/mips/configs/ocelot_c_defconfig
--- linux-2.6.5.old/arch/mips/configs/ocelot_c_defconfig	2004-05-09 10:35:55.000000000 -0500
+++ linux-2.6.5/arch/mips/configs/ocelot_c_defconfig	2004-05-09 11:58:56.926797696 -0500
@@ -23,6 +23,7 @@
 CONFIG_LOG_BUF_SHIFT=14
 # CONFIG_HOTPLUG is not set
 # CONFIG_IKCONFIG is not set
+# CONFIG_IKPATCHES is not set
 CONFIG_EMBEDDED=y
 CONFIG_KALLSYMS=y
 CONFIG_FUTEX=y
diff -ur linux-2.6.5.old/arch/mips/configs/ocelot_defconfig linux-2.6.5/arch/mips/configs/ocelot_defconfig
--- linux-2.6.5.old/arch/mips/configs/ocelot_defconfig	2004-05-09 10:35:55.000000000 -0500
+++ linux-2.6.5/arch/mips/configs/ocelot_defconfig	2004-05-09 11:58:56.912799824 -0500
@@ -24,6 +24,7 @@
 CONFIG_LOG_BUF_SHIFT=14
 # CONFIG_HOTPLUG is not set
 # CONFIG_IKCONFIG is not set
+# CONFIG_IKPATCHES is not set
 CONFIG_EMBEDDED=y
 CONFIG_KALLSYMS=y
 CONFIG_FUTEX=y
diff -ur linux-2.6.5.old/arch/mips/configs/osprey_defconfig linux-2.6.5/arch/mips/configs/osprey_defconfig
--- linux-2.6.5.old/arch/mips/configs/osprey_defconfig	2004-05-09 10:35:55.000000000 -0500
+++ linux-2.6.5/arch/mips/configs/osprey_defconfig	2004-05-09 11:58:56.809815480 -0500
@@ -24,6 +24,7 @@
 CONFIG_LOG_BUF_SHIFT=14
 # CONFIG_HOTPLUG is not set
 # CONFIG_IKCONFIG is not set
+# CONFIG_IKPATCHES is not set
 CONFIG_EMBEDDED=y
 CONFIG_KALLSYMS=y
 CONFIG_FUTEX=y
diff -ur linux-2.6.5.old/arch/mips/configs/pb1000_defconfig linux-2.6.5/arch/mips/configs/pb1000_defconfig
--- linux-2.6.5.old/arch/mips/configs/pb1000_defconfig	2004-05-09 10:35:55.000000000 -0500
+++ linux-2.6.5/arch/mips/configs/pb1000_defconfig	2004-05-09 11:58:56.816814416 -0500
@@ -24,6 +24,7 @@
 CONFIG_LOG_BUF_SHIFT=14
 CONFIG_HOTPLUG=y
 # CONFIG_IKCONFIG is not set
+# CONFIG_IKPATCHES is not set
 CONFIG_EMBEDDED=y
 CONFIG_KALLSYMS=y
 CONFIG_FUTEX=y
diff -ur linux-2.6.5.old/arch/mips/configs/pb1100_defconfig linux-2.6.5/arch/mips/configs/pb1100_defconfig
--- linux-2.6.5.old/arch/mips/configs/pb1100_defconfig	2004-05-09 10:35:55.000000000 -0500
+++ linux-2.6.5/arch/mips/configs/pb1100_defconfig	2004-05-09 11:58:56.874805600 -0500
@@ -24,6 +24,7 @@
 CONFIG_LOG_BUF_SHIFT=14
 CONFIG_HOTPLUG=y
 # CONFIG_IKCONFIG is not set
+# CONFIG_IKPATCHES is not set
 CONFIG_EMBEDDED=y
 CONFIG_KALLSYMS=y
 CONFIG_FUTEX=y
diff -ur linux-2.6.5.old/arch/mips/configs/pb1500_defconfig linux-2.6.5/arch/mips/configs/pb1500_defconfig
--- linux-2.6.5.old/arch/mips/configs/pb1500_defconfig	2004-05-09 10:35:55.000000000 -0500
+++ linux-2.6.5/arch/mips/configs/pb1500_defconfig	2004-05-09 11:58:56.872805904 -0500
@@ -24,6 +24,7 @@
 CONFIG_LOG_BUF_SHIFT=14
 CONFIG_HOTPLUG=y
 # CONFIG_IKCONFIG is not set
+# CONFIG_IKPATCHES is not set
 CONFIG_EMBEDDED=y
 CONFIG_KALLSYMS=y
 CONFIG_FUTEX=y
diff -ur linux-2.6.5.old/arch/mips/configs/pb1550_defconfig linux-2.6.5/arch/mips/configs/pb1550_defconfig
--- linux-2.6.5.old/arch/mips/configs/pb1550_defconfig	2004-05-09 10:35:55.000000000 -0500
+++ linux-2.6.5/arch/mips/configs/pb1550_defconfig	2004-05-09 11:58:56.918798912 -0500
@@ -24,6 +24,7 @@
 CONFIG_LOG_BUF_SHIFT=14
 CONFIG_HOTPLUG=y
 # CONFIG_IKCONFIG is not set
+# CONFIG_IKPATCHES is not set
 CONFIG_EMBEDDED=y
 CONFIG_KALLSYMS=y
 CONFIG_FUTEX=y
diff -ur linux-2.6.5.old/arch/mips/configs/rm200_defconfig linux-2.6.5/arch/mips/configs/rm200_defconfig
--- linux-2.6.5.old/arch/mips/configs/rm200_defconfig	2004-05-09 10:35:55.000000000 -0500
+++ linux-2.6.5/arch/mips/configs/rm200_defconfig	2004-05-09 12:31:54.540154768 -0500
@@ -25,6 +25,8 @@
 # CONFIG_HOTPLUG is not set
 CONFIG_IKCONFIG=y
 CONFIG_IKCONFIG_PROC=y
+CONFIG_IKPATCHES=y
+CONFIG_IKPATCHES_PROC=y
 CONFIG_EMBEDDED=y
 CONFIG_KALLSYMS=y
 CONFIG_FUTEX=y
diff -ur linux-2.6.5.old/arch/mips/configs/sb1250-swarm_defconfig linux-2.6.5/arch/mips/configs/sb1250-swarm_defconfig
--- linux-2.6.5.old/arch/mips/configs/sb1250-swarm_defconfig	2004-05-09 10:35:55.000000000 -0500
+++ linux-2.6.5/arch/mips/configs/sb1250-swarm_defconfig	2004-05-09 11:58:56.901801496 -0500
@@ -23,6 +23,7 @@
 CONFIG_LOG_BUF_SHIFT=15
 # CONFIG_HOTPLUG is not set
 # CONFIG_IKCONFIG is not set
+# CONFIG_IKPATCHES is not set
 CONFIG_EMBEDDED=y
 CONFIG_KALLSYMS=y
 CONFIG_FUTEX=y
diff -ur linux-2.6.5.old/arch/mips/configs/sead_defconfig linux-2.6.5/arch/mips/configs/sead_defconfig
--- linux-2.6.5.old/arch/mips/configs/sead_defconfig	2004-05-09 10:35:55.000000000 -0500
+++ linux-2.6.5/arch/mips/configs/sead_defconfig	2004-05-09 11:58:56.892802864 -0500
@@ -24,6 +24,7 @@
 CONFIG_LOG_BUF_SHIFT=14
 # CONFIG_HOTPLUG is not set
 # CONFIG_IKCONFIG is not set
+# CONFIG_IKPATCHES is not set
 CONFIG_EMBEDDED=y
 CONFIG_KALLSYMS=y
 CONFIG_FUTEX=y
diff -ur linux-2.6.5.old/arch/mips/configs/tb0226_defconfig linux-2.6.5/arch/mips/configs/tb0226_defconfig
--- linux-2.6.5.old/arch/mips/configs/tb0226_defconfig	2004-05-09 10:35:55.000000000 -0500
+++ linux-2.6.5/arch/mips/configs/tb0226_defconfig	2004-05-09 11:58:56.882804384 -0500
@@ -24,6 +24,7 @@
 CONFIG_LOG_BUF_SHIFT=14
 # CONFIG_HOTPLUG is not set
 # CONFIG_IKCONFIG is not set
+# CONFIG_IKPATCHES is not set
 CONFIG_EMBEDDED=y
 CONFIG_KALLSYMS=y
 CONFIG_FUTEX=y
diff -ur linux-2.6.5.old/arch/mips/configs/tb0229_defconfig linux-2.6.5/arch/mips/configs/tb0229_defconfig
--- linux-2.6.5.old/arch/mips/configs/tb0229_defconfig	2004-05-09 10:35:55.000000000 -0500
+++ linux-2.6.5/arch/mips/configs/tb0229_defconfig	2004-05-09 11:58:56.906800736 -0500
@@ -24,6 +24,7 @@
 CONFIG_LOG_BUF_SHIFT=14
 # CONFIG_HOTPLUG is not set
 # CONFIG_IKCONFIG is not set
+# CONFIG_IKPATCHES is not set
 CONFIG_EMBEDDED=y
 CONFIG_KALLSYMS=y
 CONFIG_FUTEX=y
diff -ur linux-2.6.5.old/arch/mips/configs/workpad_defconfig linux-2.6.5/arch/mips/configs/workpad_defconfig
--- linux-2.6.5.old/arch/mips/configs/workpad_defconfig	2004-05-09 10:35:55.000000000 -0500
+++ linux-2.6.5/arch/mips/configs/workpad_defconfig	2004-05-09 11:58:56.887803624 -0500
@@ -24,6 +24,7 @@
 CONFIG_LOG_BUF_SHIFT=14
 # CONFIG_HOTPLUG is not set
 # CONFIG_IKCONFIG is not set
+# CONFIG_IKPATCHES is not set
 CONFIG_EMBEDDED=y
 CONFIG_KALLSYMS=y
 CONFIG_FUTEX=y
diff -ur linux-2.6.5.old/arch/mips/configs/xxs1500_defconfig linux-2.6.5/arch/mips/configs/xxs1500_defconfig
--- linux-2.6.5.old/arch/mips/configs/xxs1500_defconfig	2004-05-09 10:35:55.000000000 -0500
+++ linux-2.6.5/arch/mips/configs/xxs1500_defconfig	2004-05-09 11:58:56.904801040 -0500
@@ -24,6 +24,7 @@
 CONFIG_LOG_BUF_SHIFT=14
 CONFIG_HOTPLUG=y
 # CONFIG_IKCONFIG is not set
+# CONFIG_IKPATCHES is not set
 CONFIG_EMBEDDED=y
 CONFIG_KALLSYMS=y
 CONFIG_FUTEX=y
diff -ur linux-2.6.5.old/arch/mips/configs/yosemite_defconfig linux-2.6.5/arch/mips/configs/yosemite_defconfig
--- linux-2.6.5.old/arch/mips/configs/yosemite_defconfig	2004-05-09 10:35:55.000000000 -0500
+++ linux-2.6.5/arch/mips/configs/yosemite_defconfig	2004-05-09 12:31:54.544154160 -0500
@@ -24,6 +24,8 @@
 # CONFIG_HOTPLUG is not set
 CONFIG_IKCONFIG=y
 CONFIG_IKCONFIG_PROC=y
+CONFIG_IKPATCHES=y
+CONFIG_IKPATCHES_PROC=y
 CONFIG_EMBEDDED=y
 CONFIG_KALLSYMS=y
 CONFIG_FUTEX=y
diff -ur linux-2.6.5.old/arch/mips/defconfig linux-2.6.5/arch/mips/defconfig
--- linux-2.6.5.old/arch/mips/defconfig	2004-05-09 10:35:57.000000000 -0500
+++ linux-2.6.5/arch/mips/defconfig	2004-05-09 12:31:54.932095184 -0500
@@ -25,6 +25,8 @@
 # CONFIG_HOTPLUG is not set
 CONFIG_IKCONFIG=y
 CONFIG_IKCONFIG_PROC=y
+CONFIG_IKPATCHES=y
+CONFIG_IKPATCHES_PROC=y
 CONFIG_EMBEDDED=y
 CONFIG_KALLSYMS=y
 CONFIG_FUTEX=y
diff -ur linux-2.6.5.old/arch/parisc/configs/712_defconfig linux-2.6.5/arch/parisc/configs/712_defconfig
--- linux-2.6.5.old/arch/parisc/configs/712_defconfig	2004-05-09 10:35:59.000000000 -0500
+++ linux-2.6.5/arch/parisc/configs/712_defconfig	2004-05-09 11:58:57.816662416 -0500
@@ -24,6 +24,7 @@
 CONFIG_LOG_BUF_SHIFT=15
 # CONFIG_HOTPLUG is not set
 # CONFIG_IKCONFIG is not set
+# CONFIG_IKPATCHES is not set
 # CONFIG_EMBEDDED is not set
 CONFIG_KALLSYMS=y
 CONFIG_FUTEX=y
diff -ur linux-2.6.5.old/arch/parisc/configs/a500_defconfig linux-2.6.5/arch/parisc/configs/a500_defconfig
--- linux-2.6.5.old/arch/parisc/configs/a500_defconfig	2004-05-09 10:35:59.000000000 -0500
+++ linux-2.6.5/arch/parisc/configs/a500_defconfig	2004-05-09 12:31:55.112067824 -0500
@@ -26,6 +26,8 @@
 CONFIG_HOTPLUG=y
 CONFIG_IKCONFIG=y
 CONFIG_IKCONFIG_PROC=y
+CONFIG_IKPATCHES=y
+CONFIG_IKPATCHES_PROC=y
 CONFIG_EMBEDDED=y
 # CONFIG_KALLSYMS is not set
 CONFIG_FUTEX=y
diff -ur linux-2.6.5.old/arch/parisc/configs/b180_defconfig linux-2.6.5/arch/parisc/configs/b180_defconfig
--- linux-2.6.5.old/arch/parisc/configs/b180_defconfig	2004-05-09 10:35:59.000000000 -0500
+++ linux-2.6.5/arch/parisc/configs/b180_defconfig	2004-05-09 11:58:57.820661808 -0500
@@ -24,6 +24,7 @@
 CONFIG_LOG_BUF_SHIFT=15
 # CONFIG_HOTPLUG is not set
 # CONFIG_IKCONFIG is not set
+# CONFIG_IKPATCHES is not set
 # CONFIG_EMBEDDED is not set
 CONFIG_KALLSYMS=y
 CONFIG_FUTEX=y
diff -ur linux-2.6.5.old/arch/parisc/configs/c3000_defconfig linux-2.6.5/arch/parisc/configs/c3000_defconfig
--- linux-2.6.5.old/arch/parisc/configs/c3000_defconfig	2004-05-09 10:35:59.000000000 -0500
+++ linux-2.6.5/arch/parisc/configs/c3000_defconfig	2004-05-09 12:31:55.117067064 -0500
@@ -26,6 +26,8 @@
 CONFIG_HOTPLUG=y
 CONFIG_IKCONFIG=y
 CONFIG_IKCONFIG_PROC=y
+CONFIG_IKPATCHES=y
+CONFIG_IKPATCHES_PROC=y
 CONFIG_EMBEDDED=y
 CONFIG_KALLSYMS=y
 CONFIG_FUTEX=y
diff -ur linux-2.6.5.old/arch/parisc/defconfig linux-2.6.5/arch/parisc/defconfig
--- linux-2.6.5.old/arch/parisc/defconfig	2004-05-09 10:35:59.000000000 -0500
+++ linux-2.6.5/arch/parisc/defconfig	2004-05-09 12:31:55.283041832 -0500
@@ -25,6 +25,8 @@
 # CONFIG_HOTPLUG is not set
 CONFIG_IKCONFIG=y
 CONFIG_IKCONFIG_PROC=y
+CONFIG_IKPATCHES=y
+CONFIG_IKPATCHES_PROC=y
 # CONFIG_EMBEDDED is not set
 CONFIG_KALLSYMS=y
 CONFIG_FUTEX=y
diff -ur linux-2.6.5.old/arch/ppc/configs/beech_defconfig linux-2.6.5/arch/ppc/configs/beech_defconfig
--- linux-2.6.5.old/arch/ppc/configs/beech_defconfig	2004-05-09 10:35:54.000000000 -0500
+++ linux-2.6.5/arch/ppc/configs/beech_defconfig	2004-05-09 11:58:58.220601008 -0500
@@ -24,6 +24,7 @@
 CONFIG_SYSCTL=y
 CONFIG_LOG_BUF_SHIFT=14
 # CONFIG_IKCONFIG is not set
+# CONFIG_IKPATCHES is not set
 CONFIG_EMBEDDED=y
 # CONFIG_KALLSYMS is not set
 CONFIG_FUTEX=y
diff -ur linux-2.6.5.old/arch/ppc/configs/common_defconfig linux-2.6.5/arch/ppc/configs/common_defconfig
--- linux-2.6.5.old/arch/ppc/configs/common_defconfig	2004-05-09 10:35:54.000000000 -0500
+++ linux-2.6.5/arch/ppc/configs/common_defconfig	2004-05-09 12:31:55.500008848 -0500
@@ -25,6 +25,8 @@
 CONFIG_LOG_BUF_SHIFT=14
 CONFIG_IKCONFIG=y
 CONFIG_IKCONFIG_PROC=y
+CONFIG_IKPATCHES=y
+CONFIG_IKPATCHES_PROC=y
 # CONFIG_EMBEDDED is not set
 CONFIG_KALLSYMS=y
 CONFIG_FUTEX=y
diff -ur linux-2.6.5.old/arch/ppc/configs/cpci405_defconfig linux-2.6.5/arch/ppc/configs/cpci405_defconfig
--- linux-2.6.5.old/arch/ppc/configs/cpci405_defconfig	2004-05-09 10:35:54.000000000 -0500
+++ linux-2.6.5/arch/ppc/configs/cpci405_defconfig	2004-05-09 11:58:58.172608304 -0500
@@ -24,6 +24,7 @@
 CONFIG_SYSCTL=y
 CONFIG_LOG_BUF_SHIFT=14
 # CONFIG_IKCONFIG is not set
+# CONFIG_IKPATCHES is not set
 CONFIG_EMBEDDED=y
 # CONFIG_KALLSYMS is not set
 CONFIG_FUTEX=y
diff -ur linux-2.6.5.old/arch/ppc/configs/ebony_defconfig linux-2.6.5/arch/ppc/configs/ebony_defconfig
--- linux-2.6.5.old/arch/ppc/configs/ebony_defconfig	2004-05-09 10:35:54.000000000 -0500
+++ linux-2.6.5/arch/ppc/configs/ebony_defconfig	2004-05-09 11:58:58.169608760 -0500
@@ -26,6 +26,7 @@
 CONFIG_LOG_BUF_SHIFT=14
 # CONFIG_HOTPLUG is not set
 # CONFIG_IKCONFIG is not set
+# CONFIG_IKPATCHES is not set
 CONFIG_EMBEDDED=y
 CONFIG_KALLSYMS=y
 CONFIG_FUTEX=y
diff -ur linux-2.6.5.old/arch/ppc/configs/ep405_defconfig linux-2.6.5/arch/ppc/configs/ep405_defconfig
--- linux-2.6.5.old/arch/ppc/configs/ep405_defconfig	2004-05-09 10:35:54.000000000 -0500
+++ linux-2.6.5/arch/ppc/configs/ep405_defconfig	2004-05-09 11:58:58.156610736 -0500
@@ -24,6 +24,7 @@
 CONFIG_SYSCTL=y
 CONFIG_LOG_BUF_SHIFT=14
 # CONFIG_IKCONFIG is not set
+# CONFIG_IKPATCHES is not set
 # CONFIG_EMBEDDED is not set
 CONFIG_KALLSYMS=y
 CONFIG_FUTEX=y
diff -ur linux-2.6.5.old/arch/ppc/configs/ibmchrp_defconfig linux-2.6.5/arch/ppc/configs/ibmchrp_defconfig
--- linux-2.6.5.old/arch/ppc/configs/ibmchrp_defconfig	2004-05-09 10:35:54.000000000 -0500
+++ linux-2.6.5/arch/ppc/configs/ibmchrp_defconfig	2004-05-09 12:31:55.469013560 -0500
@@ -25,6 +25,8 @@
 CONFIG_LOG_BUF_SHIFT=14
 CONFIG_IKCONFIG=y
 CONFIG_IKCONFIG_PROC=y
+CONFIG_IKPATCHES=y
+CONFIG_IKPATCHES_PROC=y
 # CONFIG_EMBEDDED is not set
 CONFIG_KALLSYMS=y
 CONFIG_FUTEX=y
diff -ur linux-2.6.5.old/arch/ppc/configs/k2_defconfig linux-2.6.5/arch/ppc/configs/k2_defconfig
--- linux-2.6.5.old/arch/ppc/configs/k2_defconfig	2004-05-09 10:35:54.000000000 -0500
+++ linux-2.6.5/arch/ppc/configs/k2_defconfig	2004-05-09 11:58:58.225600248 -0500
@@ -28,6 +28,7 @@
 CONFIG_LOG_BUF_SHIFT=14
 # CONFIG_HOTPLUG is not set
 # CONFIG_IKCONFIG is not set
+# CONFIG_IKPATCHES is not set
 CONFIG_EMBEDDED=y
 CONFIG_KALLSYMS=y
 CONFIG_FUTEX=y
diff -ur linux-2.6.5.old/arch/ppc/configs/mcpn765_defconfig linux-2.6.5/arch/ppc/configs/mcpn765_defconfig
--- linux-2.6.5.old/arch/ppc/configs/mcpn765_defconfig	2004-05-09 10:35:54.000000000 -0500
+++ linux-2.6.5/arch/ppc/configs/mcpn765_defconfig	2004-05-09 11:58:58.160610128 -0500
@@ -26,6 +26,7 @@
 CONFIG_LOG_BUF_SHIFT=14
 # CONFIG_HOTPLUG is not set
 # CONFIG_IKCONFIG is not set
+# CONFIG_IKPATCHES is not set
 CONFIG_EMBEDDED=y
 CONFIG_KALLSYMS=y
 CONFIG_FUTEX=y
diff -ur linux-2.6.5.old/arch/ppc/configs/ocotea_defconfig linux-2.6.5/arch/ppc/configs/ocotea_defconfig
--- linux-2.6.5.old/arch/ppc/configs/ocotea_defconfig	2004-05-09 10:35:54.000000000 -0500
+++ linux-2.6.5/arch/ppc/configs/ocotea_defconfig	2004-05-09 11:58:58.158610432 -0500
@@ -24,6 +24,7 @@
 CONFIG_SYSCTL=y
 CONFIG_LOG_BUF_SHIFT=14
 # CONFIG_IKCONFIG is not set
+# CONFIG_IKPATCHES is not set
 # CONFIG_EMBEDDED is not set
 CONFIG_KALLSYMS=y
 CONFIG_FUTEX=y
diff -ur linux-2.6.5.old/arch/ppc/configs/pcore_defconfig linux-2.6.5/arch/ppc/configs/pcore_defconfig
--- linux-2.6.5.old/arch/ppc/configs/pcore_defconfig	2004-05-09 10:35:54.000000000 -0500
+++ linux-2.6.5/arch/ppc/configs/pcore_defconfig	2004-05-09 11:58:58.215601768 -0500
@@ -26,6 +26,7 @@
 CONFIG_LOG_BUF_SHIFT=14
 # CONFIG_HOTPLUG is not set
 # CONFIG_IKCONFIG is not set
+# CONFIG_IKPATCHES is not set
 CONFIG_EMBEDDED=y
 CONFIG_KALLSYMS=y
 CONFIG_FUTEX=y
diff -ur linux-2.6.5.old/arch/ppc/configs/pmac_defconfig linux-2.6.5/arch/ppc/configs/pmac_defconfig
--- linux-2.6.5.old/arch/ppc/configs/pmac_defconfig	2004-05-09 10:35:54.000000000 -0500
+++ linux-2.6.5/arch/ppc/configs/pmac_defconfig	2004-05-09 12:31:55.509007480 -0500
@@ -25,6 +25,8 @@
 CONFIG_LOG_BUF_SHIFT=14
 CONFIG_IKCONFIG=y
 CONFIG_IKCONFIG_PROC=y
+CONFIG_IKPATCHES=y
+CONFIG_IKPATCHES_PROC=y
 # CONFIG_EMBEDDED is not set
 CONFIG_KALLSYMS=y
 CONFIG_FUTEX=y
diff -ur linux-2.6.5.old/arch/ppc/configs/power3_defconfig linux-2.6.5/arch/ppc/configs/power3_defconfig
--- linux-2.6.5.old/arch/ppc/configs/power3_defconfig	2004-05-09 10:35:54.000000000 -0500
+++ linux-2.6.5/arch/ppc/configs/power3_defconfig	2004-05-09 12:31:55.505008088 -0500
@@ -24,6 +24,8 @@
 CONFIG_LOG_BUF_SHIFT=15
 CONFIG_IKCONFIG=y
 CONFIG_IKCONFIG_PROC=y
+CONFIG_IKPATCHES=y
+CONFIG_IKPATCHES_PROC=y
 # CONFIG_EMBEDDED is not set
 CONFIG_KALLSYMS=y
 CONFIG_FUTEX=y
diff -ur linux-2.6.5.old/arch/ppc/configs/pplus_defconfig linux-2.6.5/arch/ppc/configs/pplus_defconfig
--- linux-2.6.5.old/arch/ppc/configs/pplus_defconfig	2004-05-09 10:35:54.000000000 -0500
+++ linux-2.6.5/arch/ppc/configs/pplus_defconfig	2004-05-09 11:58:58.149611800 -0500
@@ -26,6 +26,7 @@
 CONFIG_LOG_BUF_SHIFT=14
 # CONFIG_HOTPLUG is not set
 # CONFIG_IKCONFIG is not set
+# CONFIG_IKPATCHES is not set
 CONFIG_EMBEDDED=y
 CONFIG_KALLSYMS=y
 CONFIG_FUTEX=y
diff -ur linux-2.6.5.old/arch/ppc/configs/prpmc750_defconfig linux-2.6.5/arch/ppc/configs/prpmc750_defconfig
--- linux-2.6.5.old/arch/ppc/configs/prpmc750_defconfig	2004-05-09 10:35:54.000000000 -0500
+++ linux-2.6.5/arch/ppc/configs/prpmc750_defconfig	2004-05-09 11:58:58.217601464 -0500
@@ -28,6 +28,7 @@
 CONFIG_LOG_BUF_SHIFT=14
 # CONFIG_HOTPLUG is not set
 # CONFIG_IKCONFIG is not set
+# CONFIG_IKPATCHES is not set
 CONFIG_EMBEDDED=y
 # CONFIG_KALLSYMS is not set
 CONFIG_FUTEX=y
diff -ur linux-2.6.5.old/arch/ppc/configs/prpmc800_defconfig linux-2.6.5/arch/ppc/configs/prpmc800_defconfig
--- linux-2.6.5.old/arch/ppc/configs/prpmc800_defconfig	2004-05-09 10:35:54.000000000 -0500
+++ linux-2.6.5/arch/ppc/configs/prpmc800_defconfig	2004-05-09 11:58:58.189605720 -0500
@@ -28,6 +28,7 @@
 CONFIG_LOG_BUF_SHIFT=14
 # CONFIG_HOTPLUG is not set
 # CONFIG_IKCONFIG is not set
+# CONFIG_IKPATCHES is not set
 CONFIG_EMBEDDED=y
 # CONFIG_KALLSYMS is not set
 CONFIG_FUTEX=y
diff -ur linux-2.6.5.old/arch/ppc/configs/redwood5_defconfig linux-2.6.5/arch/ppc/configs/redwood5_defconfig
--- linux-2.6.5.old/arch/ppc/configs/redwood5_defconfig	2004-05-09 10:35:54.000000000 -0500
+++ linux-2.6.5/arch/ppc/configs/redwood5_defconfig	2004-05-09 11:58:58.186606176 -0500
@@ -24,6 +24,7 @@
 CONFIG_SYSCTL=y
 CONFIG_LOG_BUF_SHIFT=14
 # CONFIG_IKCONFIG is not set
+# CONFIG_IKPATCHES is not set
 CONFIG_EMBEDDED=y
 # CONFIG_KALLSYMS is not set
 CONFIG_FUTEX=y
diff -ur linux-2.6.5.old/arch/ppc/configs/redwood6_defconfig linux-2.6.5/arch/ppc/configs/redwood6_defconfig
--- linux-2.6.5.old/arch/ppc/configs/redwood6_defconfig	2004-05-09 10:35:54.000000000 -0500
+++ linux-2.6.5/arch/ppc/configs/redwood6_defconfig	2004-05-09 11:58:58.164609520 -0500
@@ -24,6 +24,7 @@
 CONFIG_SYSCTL=y
 CONFIG_LOG_BUF_SHIFT=14
 # CONFIG_IKCONFIG is not set
+# CONFIG_IKPATCHES is not set
 CONFIG_EMBEDDED=y
 # CONFIG_KALLSYMS is not set
 CONFIG_FUTEX=y
diff -ur linux-2.6.5.old/arch/ppc/configs/redwood_defconfig linux-2.6.5/arch/ppc/configs/redwood_defconfig
--- linux-2.6.5.old/arch/ppc/configs/redwood_defconfig	2004-05-09 10:35:54.000000000 -0500
+++ linux-2.6.5/arch/ppc/configs/redwood_defconfig	2004-05-09 11:58:58.200604048 -0500
@@ -24,6 +24,7 @@
 CONFIG_SYSCTL=y
 CONFIG_LOG_BUF_SHIFT=14
 # CONFIG_IKCONFIG is not set
+# CONFIG_IKPATCHES is not set
 CONFIG_EMBEDDED=y
 # CONFIG_KALLSYMS is not set
 CONFIG_FUTEX=y
diff -ur linux-2.6.5.old/arch/ppc/configs/spruce_defconfig linux-2.6.5/arch/ppc/configs/spruce_defconfig
--- linux-2.6.5.old/arch/ppc/configs/spruce_defconfig	2004-05-09 10:35:54.000000000 -0500
+++ linux-2.6.5/arch/ppc/configs/spruce_defconfig	2004-05-09 11:58:58.174608000 -0500
@@ -25,6 +25,7 @@
 CONFIG_SYSCTL=y
 CONFIG_LOG_BUF_SHIFT=14
 # CONFIG_IKCONFIG is not set
+# CONFIG_IKPATCHES is not set
 CONFIG_EMBEDDED=y
 CONFIG_KALLSYMS=y
 CONFIG_FUTEX=y
diff -ur linux-2.6.5.old/arch/ppc/configs/walnut_defconfig linux-2.6.5/arch/ppc/configs/walnut_defconfig
--- linux-2.6.5.old/arch/ppc/configs/walnut_defconfig	2004-05-09 10:35:54.000000000 -0500
+++ linux-2.6.5/arch/ppc/configs/walnut_defconfig	2004-05-09 11:58:58.209602680 -0500
@@ -26,6 +26,7 @@
 CONFIG_LOG_BUF_SHIFT=14
 # CONFIG_HOTPLUG is not set
 # CONFIG_IKCONFIG is not set
+# CONFIG_IKPATCHES is not set
 CONFIG_EMBEDDED=y
 # CONFIG_KALLSYMS is not set
 CONFIG_FUTEX=y
diff -ur linux-2.6.5.old/arch/ppc/defconfig linux-2.6.5/arch/ppc/defconfig
--- linux-2.6.5.old/arch/ppc/defconfig	2004-05-09 10:35:55.000000000 -0500
+++ linux-2.6.5/arch/ppc/defconfig	2004-05-09 12:31:55.868952760 -0500
@@ -25,6 +25,8 @@
 CONFIG_LOG_BUF_SHIFT=14
 CONFIG_IKCONFIG=y
 CONFIG_IKCONFIG_PROC=y
+CONFIG_IKPATCHES=y
+CONFIG_IKPATCHES_PROC=y
 # CONFIG_EMBEDDED is not set
 CONFIG_KALLSYMS=y
 CONFIG_FUTEX=y
diff -ur linux-2.6.5.old/arch/ppc64/configs/g5_defconfig linux-2.6.5/arch/ppc64/configs/g5_defconfig
--- linux-2.6.5.old/arch/ppc64/configs/g5_defconfig	2004-05-09 10:35:58.000000000 -0500
+++ linux-2.6.5/arch/ppc64/configs/g5_defconfig	2004-05-09 11:58:58.732523184 -0500
@@ -30,6 +30,7 @@
 CONFIG_LOG_BUF_SHIFT=17
 CONFIG_HOTPLUG=y
 # CONFIG_IKCONFIG is not set
+# CONFIG_IKPATCHES is not set
 # CONFIG_EMBEDDED is not set
 CONFIG_KALLSYMS=y
 CONFIG_FUTEX=y
diff -ur linux-2.6.5.old/arch/ppc64/configs/iSeries_defconfig linux-2.6.5/arch/ppc64/configs/iSeries_defconfig
--- linux-2.6.5.old/arch/ppc64/configs/iSeries_defconfig	2004-05-09 10:35:58.000000000 -0500
+++ linux-2.6.5/arch/ppc64/configs/iSeries_defconfig	2004-05-09 12:31:56.047925552 -0500
@@ -29,6 +29,8 @@
 CONFIG_HOTPLUG=y
 CONFIG_IKCONFIG=y
 CONFIG_IKCONFIG_PROC=y
+CONFIG_IKPATCHES=y
+CONFIG_IKPATCHES_PROC=y
 CONFIG_EMBEDDED=y
 CONFIG_KALLSYMS=y
 CONFIG_FUTEX=y
diff -ur linux-2.6.5.old/arch/ppc64/configs/pSeries_defconfig linux-2.6.5/arch/ppc64/configs/pSeries_defconfig
--- linux-2.6.5.old/arch/ppc64/configs/pSeries_defconfig	2004-05-09 10:35:58.000000000 -0500
+++ linux-2.6.5/arch/ppc64/configs/pSeries_defconfig	2004-05-09 12:31:56.050925096 -0500
@@ -29,6 +29,8 @@
 CONFIG_HOTPLUG=y
 CONFIG_IKCONFIG=y
 CONFIG_IKCONFIG_PROC=y
+CONFIG_IKPATCHES=y
+CONFIG_IKPATCHES_PROC=y
 # CONFIG_EMBEDDED is not set
 CONFIG_KALLSYMS=y
 CONFIG_FUTEX=y
diff -ur linux-2.6.5.old/arch/ppc64/defconfig linux-2.6.5/arch/ppc64/defconfig
--- linux-2.6.5.old/arch/ppc64/defconfig	2004-05-09 10:35:58.000000000 -0500
+++ linux-2.6.5/arch/ppc64/defconfig	2004-05-09 12:31:56.263892720 -0500
@@ -29,6 +29,8 @@
 CONFIG_HOTPLUG=y
 CONFIG_IKCONFIG=y
 CONFIG_IKCONFIG_PROC=y
+CONFIG_IKPATCHES=y
+CONFIG_IKPATCHES_PROC=y
 # CONFIG_EMBEDDED is not set
 CONFIG_KALLSYMS=y
 CONFIG_FUTEX=y
diff -ur linux-2.6.5.old/arch/s390/defconfig linux-2.6.5/arch/s390/defconfig
--- linux-2.6.5.old/arch/s390/defconfig	2004-05-09 10:35:57.000000000 -0500
+++ linux-2.6.5/arch/s390/defconfig	2004-05-09 12:31:56.413869920 -0500
@@ -26,6 +26,8 @@
 CONFIG_HOTPLUG=y
 CONFIG_IKCONFIG=y
 CONFIG_IKCONFIG_PROC=y
+CONFIG_IKPATCHES=y
+CONFIG_IKPATCHES_PROC=y
 # CONFIG_EMBEDDED is not set
 CONFIG_KALLSYMS=y
 CONFIG_FUTEX=y
diff -ur linux-2.6.5.old/arch/sh/configs/dreamcast_defconfig linux-2.6.5/arch/sh/configs/dreamcast_defconfig
--- linux-2.6.5.old/arch/sh/configs/dreamcast_defconfig	2004-05-09 10:35:54.000000000 -0500
+++ linux-2.6.5/arch/sh/configs/dreamcast_defconfig	2004-05-09 11:58:59.129462840 -0500
@@ -23,6 +23,7 @@
 CONFIG_LOG_BUF_SHIFT=14
 CONFIG_HOTPLUG=y
 # CONFIG_IKCONFIG is not set
+# CONFIG_IKPATCHES is not set
 CONFIG_EMBEDDED=y
 CONFIG_KALLSYMS=y
 CONFIG_FUTEX=y
diff -ur linux-2.6.5.old/arch/sh/configs/hp680_defconfig linux-2.6.5/arch/sh/configs/hp680_defconfig
--- linux-2.6.5.old/arch/sh/configs/hp680_defconfig	2004-05-09 10:35:54.000000000 -0500
+++ linux-2.6.5/arch/sh/configs/hp680_defconfig	2004-05-09 11:58:59.121464056 -0500
@@ -23,6 +23,7 @@
 # CONFIG_SYSCTL is not set
 CONFIG_LOG_BUF_SHIFT=14
 # CONFIG_IKCONFIG is not set
+# CONFIG_IKPATCHES is not set
 # CONFIG_EMBEDDED is not set
 CONFIG_KALLSYMS=y
 CONFIG_FUTEX=y
diff -ur linux-2.6.5.old/arch/sh/configs/se7751_defconfig linux-2.6.5/arch/sh/configs/se7751_defconfig
--- linux-2.6.5.old/arch/sh/configs/se7751_defconfig	2004-05-09 10:35:54.000000000 -0500
+++ linux-2.6.5/arch/sh/configs/se7751_defconfig	2004-05-09 11:58:59.123463752 -0500
@@ -22,6 +22,7 @@
 CONFIG_SYSCTL=y
 CONFIG_LOG_BUF_SHIFT=14
 # CONFIG_IKCONFIG is not set
+# CONFIG_IKPATCHES is not set
 CONFIG_EMBEDDED=y
 CONFIG_KALLSYMS=y
 CONFIG_FUTEX=y
diff -ur linux-2.6.5.old/arch/sh/configs/snapgear_defconfig linux-2.6.5/arch/sh/configs/snapgear_defconfig
--- linux-2.6.5.old/arch/sh/configs/snapgear_defconfig	2004-05-09 10:35:54.000000000 -0500
+++ linux-2.6.5/arch/sh/configs/snapgear_defconfig	2004-05-09 11:58:59.130462688 -0500
@@ -22,6 +22,7 @@
 # CONFIG_SYSCTL is not set
 CONFIG_LOG_BUF_SHIFT=14
 # CONFIG_IKCONFIG is not set
+# CONFIG_IKPATCHES is not set
 # CONFIG_EMBEDDED is not set
 CONFIG_KALLSYMS=y
 CONFIG_FUTEX=y
diff -ur linux-2.6.5.old/arch/sh/configs/systemh_defconfig linux-2.6.5/arch/sh/configs/systemh_defconfig
--- linux-2.6.5.old/arch/sh/configs/systemh_defconfig	2004-05-09 10:35:54.000000000 -0500
+++ linux-2.6.5/arch/sh/configs/systemh_defconfig	2004-05-09 11:58:59.124463600 -0500
@@ -23,6 +23,7 @@
 # CONFIG_SYSCTL is not set
 CONFIG_LOG_BUF_SHIFT=14
 # CONFIG_IKCONFIG is not set
+# CONFIG_IKPATCHES is not set
 CONFIG_EMBEDDED=y
 CONFIG_KALLSYMS=y
 CONFIG_FUTEX=y
diff -ur linux-2.6.5.old/arch/sh/defconfig linux-2.6.5/arch/sh/defconfig
--- linux-2.6.5.old/arch/sh/defconfig	2004-05-09 10:35:54.000000000 -0500
+++ linux-2.6.5/arch/sh/defconfig	2004-05-09 11:58:59.301436696 -0500
@@ -22,6 +22,7 @@
 # CONFIG_SYSCTL is not set
 CONFIG_LOG_BUF_SHIFT=14
 # CONFIG_IKCONFIG is not set
+# CONFIG_IKPATCHES is not set
 CONFIG_EMBEDDED=y
 CONFIG_KALLSYMS=y
 CONFIG_FUTEX=y
diff -ur linux-2.6.5.old/arch/sparc/defconfig linux-2.6.5/arch/sparc/defconfig
--- linux-2.6.5.old/arch/sparc/defconfig	2004-05-09 10:35:58.000000000 -0500
+++ linux-2.6.5/arch/sparc/defconfig	2004-05-09 11:58:59.501406296 -0500
@@ -24,6 +24,7 @@
 CONFIG_LOG_BUF_SHIFT=14
 # CONFIG_HOTPLUG is not set
 # CONFIG_IKCONFIG is not set
+# CONFIG_IKPATCHES is not set
 # CONFIG_EMBEDDED is not set
 CONFIG_KALLSYMS=y
 CONFIG_FUTEX=y
diff -ur linux-2.6.5.old/arch/sparc64/defconfig linux-2.6.5/arch/sparc64/defconfig
--- linux-2.6.5.old/arch/sparc64/defconfig	2004-05-09 10:35:59.000000000 -0500
+++ linux-2.6.5/arch/sparc64/defconfig	2004-05-09 11:58:59.761366776 -0500
@@ -23,6 +23,7 @@
 CONFIG_LOG_BUF_SHIFT=15
 CONFIG_HOTPLUG=y
 # CONFIG_IKCONFIG is not set
+# CONFIG_IKPATCHES is not set
 # CONFIG_EMBEDDED is not set
 CONFIG_KALLSYMS=y
 CONFIG_FUTEX=y
diff -ur linux-2.6.5.old/arch/x86_64/defconfig linux-2.6.5/arch/x86_64/defconfig
--- linux-2.6.5.old/arch/x86_64/defconfig	2004-05-09 10:35:59.000000000 -0500
+++ linux-2.6.5/arch/x86_64/defconfig	2004-05-09 12:31:57.552696792 -0500
@@ -32,6 +32,8 @@
 # CONFIG_HOTPLUG is not set
 CONFIG_IKCONFIG=y
 CONFIG_IKCONFIG_PROC=y
+CONFIG_IKPATCHES=y
+CONFIG_IKPATCHES_PROC=y
 # CONFIG_EMBEDDED is not set
 CONFIG_KALLSYMS=y
 CONFIG_FUTEX=ydiff -urN linux-2.6.5.old/kernel/Makefile linux-2.6.5/kernel/Makefile
--- linux-2.6.5.old/kernel/Makefile	2004-05-09 13:07:08.000000000 -0500
+++ linux-2.6.5/kernel/Makefile	2004-05-09 14:10:12.000000000 -0500
@@ -20,6 +20,8 @@
 obj-$(CONFIG_COMPAT) += compat.o
 obj-$(CONFIG_IKCONFIG) += configs.o
 obj-$(CONFIG_IKCONFIG_PROC) += configs.o
+obj-$(CONFIG_IKPATCHES) += patches.o
+obj-$(CONFIG_IKPATCHES_PROC) += patches.o
 obj-$(CONFIG_STOP_MACHINE) += stop_machine.o
 obj-$(CONFIG_AUDIT) += audit.o
 obj-$(CONFIG_AUDITSYSCALL) += auditsc.o
@@ -62,3 +64,35 @@
 targets += config_data.h
 $(obj)/config_data.h: $(obj)/config_data.gz FORCE
 	$(call if_changed,ikconfiggz)
+
+
+
+# patches.o uses generated files - dependecies must be listed explicitly
+$(obj)/patches.o: $(obj)/ikpatches.h
+
+ifdef CONFIG_IKCONFIG_PROC
+$(obj)/patches.o: $(obj)/patches_data.h
+endif
+
+# ikpatches.h contains all the kernel's patches data - generated
+# from .patches. Info from ikpatches.h can be extracted from the 
+# kernel binary.
+
+quiet_cmd_ikpatches = IKCFG   $@
+      cmd_ikpatches = $(CONFIG_SHELL) $< .patches > $@
+
+targets += ikpatches.h
+$(obj)/ikpatches.h: scripts/mkpatches .patches FORCE
+	$(call if_changed,ikpatches)
+
+# patches_data.h contains the same information as ikpatches.h but gzipped.
+# Info from patches_data can be extracted from /proc/patches*
+targets += patches_data.gz
+$(obj)/patches_data.gz: .patches FORCE
+	$(call if_changed,gzip)
+
+quiet_cmd_ikpatchesgz = IKCFG   $@
+      cmd_ikpatchesgz = cat $< | scripts/bin2c kernel_patches_data > $@
+targets += patches_data.h
+$(obj)/patches_data.h: $(obj)/patches_data.gz FORCE
+	$(call if_changed,ikpatchesgz)
diff -urN linux-2.6.5.old/kernel/patches.c linux-2.6.5/kernel/patches.c
--- linux-2.6.5.old/kernel/patches.c	1969-12-31 19:00:00.000000000 -0500
+++ linux-2.6.5/kernel/patches.c	2004-05-09 13:49:07.000000000 -0500
@@ -0,0 +1,108 @@
+/*
+ * kernel/patches.c
+ * Echo the kernel's .patches file present when building the kernel
+ *
+ * Copyright (C) 2004 Jon Oberheide <jon@focalhost.com>
+ * Copyright (C) 2002 Khalid Aziz <khalid_aziz@hp.com>
+ * Copyright (C) 2002 Randy Dunlap <rddunlap@osdl.org>
+ * Copyright (C) 2002 Al Stone <ahs3@fc.hp.com>
+ * Copyright (C) 2002 Hewlett-Packard Company
+ *
+ * This program is free software; you can redistribute it and/or modify
+ * it under the terms of the GNU General Public License as published by
+ * the Free Software Foundation; either version 2 of the License, or (at
+ * your option) any later version.
+ *
+ * This program is distributed in the hope that it will be useful, but
+ * WITHOUT ANY WARRANTY; without even the implied warranty of
+ * MERCHANTABILITY OR FITNESS FOR A PARTICULAR PURPOSE, GOOD TITLE or
+ * NON INFRINGEMENT.  See the GNU General Public License for more
+ * details.
+ *
+ * You should have received a copy of the GNU General Public License
+ * along with this program; if not, write to the Free Software
+ * Foundation, Inc., 675 Mass Ave, Cambridge, MA 02139, USA.
+ */
+
+#include <linux/config.h>
+#include <linux/kernel.h>
+#include <linux/module.h>
+#include <linux/proc_fs.h>
+#include <linux/seq_file.h>
+#include <linux/init.h>
+#include <asm/uaccess.h>
+
+/**************************************************/
+/* the actual current .patches file                 */
+
+/* This one is for extraction from the kernel binary file image. */
+#include "ikpatches.h"
+
+#ifdef CONFIG_IKPATCHES_PROC
+
+/* This is the data that can be read from /proc/patches.gz. */
+#include "patches_data.h"
+
+/**************************************************/
+/* globals and useful constants                   */
+
+static const char IKPATCHES_VERSION[] __initdata = "0.7";
+
+static ssize_t
+ikpatches_read_current(struct file *file, char __user *buf,
+		      size_t len, loff_t * offset)
+{
+	loff_t pos = *offset;
+	ssize_t count;
+
+	if (pos >= kernel_patches_data_size)
+		return 0;
+
+	count = min(len, (size_t)(kernel_patches_data_size - pos));
+	if(copy_to_user(buf, kernel_patches_data + pos, count))
+		return -EFAULT;
+
+	*offset += count;
+	return count;
+}
+
+static struct file_operations ikpatches_file_ops = {
+	.owner = THIS_MODULE,
+	.read = ikpatches_read_current,
+};
+
+/***************************************************/
+/* ikpatches_init: start up everything we need to */
+
+static int __init ikpatches_init(void)
+{
+	struct proc_dir_entry *entry;
+
+	/* create the current patches file */
+	entry = create_proc_entry("patches.gz", S_IFREG | S_IRUGO,
+				  &proc_root);
+	if (!entry)
+		return -ENOMEM;
+
+	entry->proc_fops = &ikpatches_file_ops;
+	entry->size = kernel_patches_data_size;
+
+	return 0;
+}
+
+/***************************************************/
+/* ikpatches_cleanup: clean up our mess           */
+
+static void __exit ikpatches_cleanup(void)
+{
+	remove_proc_entry("patches.gz", &proc_root);
+}
+
+module_init(ikpatches_init);
+module_exit(ikpatches_cleanup);
+
+MODULE_LICENSE("GPL");
+MODULE_AUTHOR("Jon Oberheide");
+MODULE_DESCRIPTION("Echo the kernel's .patches file present while building the kernel");
+
+#endif /* CONFIG_IKPATCHES_PROC */diff -urN linux-2.6.5.old/scripts/extract-ikpatches linux-2.6.5/scripts/extract-ikpatches
--- linux-2.6.5.old/scripts/extract-ikpatches	1969-12-31 19:00:00.000000000 -0500
+++ linux-2.6.5/scripts/extract-ikpatches	2004-05-09 13:59:00.000000000 -0500
@@ -0,0 +1,66 @@
+#! /bin/bash 
+# extracts .packages from a [b]zImage file
+# uses: binoffset (new), dd, zcat, strings, grep
+# $arg1 is [b]zImage filename
+
+TMPFILE=""
+
+usage()
+{
+	echo "  usage: extract-ikpatches [b]zImage_filename"
+}
+
+clean_up()
+{
+	if [ -z $ISCOMP ]
+	then
+		rm -f $TMPFILE
+	fi
+}
+
+if [ $# -lt 1 ]
+then
+	usage
+	exit
+fi
+
+image=$1
+
+# There are two gzip headers, as well as arches which don't compress their
+# kernel.
+GZHDR="0x1f 0x8b 0x08 0x00"
+if [ `binoffset $image $GZHDR >/dev/null 2>&1 ; echo $?` -ne 0 ]
+then
+	GZHDR="0x1f 0x8b 0x08 0x08"
+	if [ `binoffset $image $GZHDR >/dev/null 2>&1 ; echo $?` -ne 0 ]
+	then
+		ISCOMP=0
+	fi
+fi
+
+PID=$$
+
+# Extract and uncompress the kernel image if necessary
+if [ -z $ISCOMP ]
+then
+	TMPFILE="/tmp/`basename $image`.vmlin.$PID"
+	dd if=$image bs=1 skip=`binoffset $image $GZHDR` 2> /dev/null | zcat > $TMPFILE
+else
+	TMPFILE=$image
+fi
+
+# Look for strings.
+strings $TMPFILE | grep "PATCHES_BEGIN" > /dev/null
+if [ $? -eq 0 ]
+then
+	strings $TMPFILE | awk "/PATCHES_BEGIN/,/PATCHES_END/" > $image.oldpatches.$PID
+else
+	echo "ERROR: Unable to extract kernel's .patches file."
+	echo "       This kernel image may not have the .patches info."
+	clean_up
+	exit 1
+fi
+
+echo "Kernel's .patches file written to $image.oldpatches.$PID"
+clean_up
+exit 0
diff -urN linux-2.6.5.old/scripts/mkpatches linux-2.6.5/scripts/mkpatches
--- linux-2.6.5.old/scripts/mkpatches	1969-12-31 19:00:00.000000000 -0500
+++ linux-2.6.5/scripts/mkpatches	2004-05-09 14:49:58.232228440 -0500
@@ -0,0 +1,63 @@
+#!/bin/sh
+#
+# Copyright (C) 2004 Jon Oberheide <jon@focalhost.com>
+# Copyright (C) 2002 Khalid Aziz <khalid_aziz@hp.com>
+# Copyright (C) 2002 Randy Dunlap <rddunlap@osdl.org>
+# Copyright (C) 2002 Al Stone <ahs3@fc.hp.com>
+# Copyright (C) 2002 Hewlett-Packard Company
+#
+#   This program is free software; you can redistribute it and/or modify
+#   it under the terms of the GNU General Public License as published by
+#   the Free Software Foundation; either version 2 of the License, or
+#   (at your option) any later version.
+#
+#   This program is distributed in the hope that it will be useful,
+#   but WITHOUT ANY WARRANTY; without even the implied warranty of
+#   MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+#   GNU General Public License for more details.
+#
+#   You should have received a copy of the GNU General Public License
+#   along with this program; if not, write to the Free Software
+#   Foundation, Inc., 675 Mass Ave, Cambridge, MA 02139, USA.
+#
+# Used to generate ikpatches.h from linux/.patches:
+
+if [ $# -lt 1 ]
+then
+	echo "Usage: `basename $0` <patches_file>"
+	exit 1
+fi
+
+patches=$1
+
+echo "#ifndef _IKPATCHES_H"
+echo "#define _IKPATCHES_H"
+echo \
+"/*
+ * 
+ * This program is free software; you can redistribute it and/or modify
+ * it under the terms of the GNU General Public License as published by
+ * the Free Software Foundation; either version 2 of the License, or (at
+ * your option) any later version.
+ *
+ * This program is distributed in the hope that it will be useful, but
+ * WITHOUT ANY WARRANTY; without even the implied warranty of
+ * MERCHANTABILITY OR FITNESS FOR A PARTICULAR PURPOSE, GOOD TITLE or
+ * NON INFRINGEMENT.  See the GNU General Public License for more
+ * details.
+ *
+ * You should have received a copy of the GNU General Public License
+ * along with this program; if not, write to the Free Software
+ * Foundation, Inc., 675 Mass Ave, Cambridge, MA 02139, USA.
+ *
+ *
+ * 
+ * This file is generated automatically by scripts/mkpatches. Do not edit.
+ *
+ */"
+
+echo "static char const ikpatches_patches[] __attribute__((unused)) = "
+echo "\"PATCHES_BEGIN\\n\\"
+echo "`cat $patches | sed 's/\"/\\\\\"/g' | awk '{ print $0 "\\\\n\\\\" }' `"
+echo "PATCHES_END\\n\";"
+echo "#endif /* _IKPATCHES_H */"[unhandled content-type:application/pgp-signature]