Date: 07 Oct 2002 15:04:17 +0200
From: Arjan van de Ven <>
Subject: Re: wake_up from interrupt handler
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2002/10/7/108

On Mon, 2002-10-07 at 14:41, Amol Lad wrote:
> Hi,
>  I have a kernel thread which did add_to_wait_queue()
> to wait for an event. 
> The event for which above thread is waiting occurs in
> an interrupt handler that calls wake_up() to wake the
> above thread. 
> Now I am faced with a 'lost wakeup' problem, in which
> the    
> kernel thread checks whether event occured, he finds
> it to be 'not-occured' but before calling
> add_to_wait_queue(), interrupt handler detects that
> the event has occured and calls wake_up().
> My thread sleeps forever.
set_current_state(TASK_INTERRUPTIBLE);
add_to_wait_queue(...);
if (even_occured) { ...} 
  else
     schedule();
 
remove_from_wait_queue(..);
set_current_state(TASK_RUNNABLE);
> 
[unhandled content-type:application/pgp-signature]