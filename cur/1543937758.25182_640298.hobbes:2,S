Date: Fri, 18 Jan 2008 15:18:39 +0100
From: Andi Kleen <>
Subject: Re: [PATCH] x86: make clflush a required feature on x86_64
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2008/1/18/232

On Fri, Jan 18, 2008 at 08:56:43AM -0500, H. Peter Anvin wrote:
> Andi Kleen wrote:
> >>Simulators can be fixed, 
> >
> >They could, but why? I don't know of a good reason to require CLFLUSH.
> 
> Well, simulators are generally expected to follow the architecture, not 
> vice versa.  I would tend to agree with the coupling that recent 
> versions of Bochs appeared to have made here -- I think we're unlikely 
> to see any processors with sse2 sans clflush, so keeping code branches 
> in which will never be executed seems like a bad idea in the long term. 
Here's another argument: Ingo just asked me to add a noclflush option
to the code. Guess what check that option will need? 
Besides compared to the cost of a flushing clflush the branches are absolutely 
in the noise.
-Andi