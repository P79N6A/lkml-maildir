Date: Tue, 4 Dec 2007 22:00:06 +0100
From: Ingo Molnar <>
Subject: Re: Need lockdep help
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2007/12/4/333

* Alan Stern <stern@rowland.harvard.edu> wrote:
> > I'm not sure I can understand your plan, but I doubt there should be 
> > such problems with taking rwsem for sleeping, so maybe it would be 
> > better to figure out what really scares lockdep, to fix the right 
> > place?
> 
> The real problem is that lockdep has to make some generalizations.  It 
> can't be aware of the details of every possible situation, and it 
> doesn't have a global view of the entire kernel, so it doesn't know 
> when special circumstances make deadlock impossible.
> 
> Furthermore, in this case deadlock isn't really impossible -- it could 
> occur if there were a bug somewhere else in the kernel.  So lockdep 
> was correct to warn that deadlock might occur.
ok. Thanks for resolving this by working it around - i _think_ in the 
long run we'd like to make all locking "simpler" - not just for the sake 
of lockdep, but also for the sake of human reviewability. So in that 
sense, even though in this particular case you are fully right that 
lockdep was wrong, we benefit long-term.
	Ingo