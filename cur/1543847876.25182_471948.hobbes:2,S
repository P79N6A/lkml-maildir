Date: Wed, 11 Oct 2006 00:13:03 -0700
From: Amit Choudhary <>
Subject: [PATCH 2.6.19-rc1] drivers/media/video/se401.c: stop streaming if no memory available.
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2006/10/11/55

Description: Stop streaming if no memory available. function: se401_start_stream(), file: drivers/media/video/se401.c.
Signed-off-by: Amit Choudhary <amit2030@gmail.com>
diff --git a/drivers/media/video/se401.c b/drivers/media/video/se401.c
index 7d598e0..779bb99 100644
--- a/drivers/media/video/se401.c
+++ b/drivers/media/video/se401.c
@@ -474,8 +474,11 @@ static int se401_start_stream(struct usb
 
 	for (i=0; i<SE401_NUMSBUF; i++) {
 		urb=usb_alloc_urb(0, GFP_KERNEL);
-		if(!urb)
+		/* No memory, stop streaming */
+		if(!urb) {
+			se401_stop_stream(se401);
 			return -ENOMEM;
+		}
 
 		usb_fill_bulk_urb(urb, se401->dev,
 			usb_rcvbulkpipe(se401->dev, SE401_VIDEO_ENDPOINT),
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.kernel.org
More majordomo info at  
http://vger.kernel.org/majordomo-info.html
Please read the FAQ at  
http://www.tux.org/lkml/