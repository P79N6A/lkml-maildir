Date: Thu, 1 Apr 1999 09:03:59 GMT
From: Niall O Broin <>
Subject: PROBLEM: keyboard dies under 2.2.[35]
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/1999/4/1/22

[1.] When the boot process finishes, the keyboard is not responsive
[2.]  This problem has been identified as being related to gpm, so it may or
may not be a kernel bug. However, on this machine (an AMD K6II-333 with an
ASUS P5-A motherboard) the problem does NOT occur with kernel 2.0.36. The problem
is a tad obscure, but I know we all want Linux to be problem-free . . . . .
If gpm is run as   gpm -t ms  and we have /dev/mouse -> /dev/psaux and there is
no mouse attached, the console driver doesn't receive keystrokes. If gpm is then
killed with gpm -k the console driver receives the keystrokes which were typed
while gpm was running, which obviously have been buffered somewhere (doesn't the
keyboard have a hardware/BIOS buffer ? I seem to remember stuffing keystrokes in
there many years ago). This is on a machine running gpm-1.13.8 but I got the latest
gpm (1-17.5) and it had the same results. Now obviously this is anomalous behaviour
from a wrongly configured system (because it should have used gpm -t ps2) but as
the box is a server, we never noticed this misconfiguration as we have no mouse on
it and it took a long time before we even noticed the problem as we rarely use the
keyboard on the machine. In fact, what brought it to light was that fact that on a
few occassions the machine started to scream i.e. emit a continuous beep from its
speaker, which I guessed to be keyboard related, and investigations went on from
there.
[3.] Keywords : gpm mouse keyboard kernel
[4.] Kernel version (from /proc/version):
Linux version 2.2.5 (root@linux1.sced.esoc.esa.de) (gcc version 2.7.2.3) #1 Wed Mar 31 15:28:38 EST 1999
Also observed on 2.2.3 - does not occur with 2.0.36
[5.] N/A 
[6.] N/A
[7.] Environment
[7.1.]  
-- Versions installed: (if some fields are empty or looks
-- unusual then possibly you have very old versions)
Linux linux1.sced.esoc.esa.de 2.2.5 #1 Wed Mar 31 15:28:38 EST 1999 i586 unknown
Kernel modules         2.1.85
Gnu C                  2.7.2.3
Binutils               2.9.1.0.15
Linux C Library        2.0.7
Dynamic linker         ldd (GNU libc) 2.0.7
Linux C++ Library      2.8.0
Procps                 1.2.9
Mount                  2.8a
Net-tools              (1998-06-29)
Kbd                    0.96
Sh-utils               1.16
[7.2.] Processor information (from /proc/cpuinfo):
processor       : 0
vendor_id       : AuthenticAMD
cpu family      : 5
model           : 8
model name      : AMD-K6(tm) 3D processor
stepping        : 12
cpu MHz         : 332.765442
fdiv_bug        : no
hlt_bug         : no
sep_bug         : no
f00f_bug        : no
fpu             : yes
fpu_exception   : yes
cpuid level     : 1
wp              : yes
flags           : fpu vme de pse tsc msr mce cx8 sep pge mmx 3dnow
bogomips        : 663.55
[7.3.] No modules loaded
[7.4.] SCSI information
Attached devices: none  (aha1542 driver compiled in, no SCSI disks)
[X.] Other notes, patches, fixes, workarounds:
The fix/workaround is to run gpm with the correct mouse type definition.
BTW I don't subscribe to linux-kernel so if anyone needs clarification,
email me directly.
Kindest regards,
Niall  O Broin		
UNIX Network Administrator 		 	nobroin@esoc.esa.de
Ground Systems Engineering Department		Ph./Fax  +49 6151 90 3619/2179
European Space Operations Centre, Darmstadt, Germany
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.rutgers.edu
Please read the FAQ at 
http://www.tux.org/lkml/