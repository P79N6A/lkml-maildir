Date: Sun, 26 Sep 1999 23:56:07 CEST
From: "Jonathan Crenner" <>
Subject: SMP + NCR 53c810 problem
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/1999/9/26/92

Hi all,
This is my first posting in this mailing-list, so please be tolerant
and don't explode me !
As I'm not subscribing to the list, would you mind CC me the
answers/comments posted to the list in response to this posting.
I have a Abit BP6 Dual-Celeron MB, and a NCR 53c810 based SCSI card.
This card works perfectly, without SMP support : (kernel 2.0.36)
ncr53c8xx: at PCI bus 0, device 15, function 0
ncr53c8xx: 53c810a detected
ncr53c810a-0: rev=0x12, base=0xeb000000, io_port=0xa400, irq=9
ncr53c810a-0: ID 7, Fast-10, Parity Checking
ncr53c810a-0: restart (scsi reset).
Failed initialization of WD-7000 SCSI card!
scsi0 : ncr53c8xx - revision 2.5f.1
scsi : 1 host.
  Vendor: YAMAHA    Model: CDR200t           Rev: 1.0g
  Type:   CD-ROM                             ANSI SCSI revision: 02
Detected scsi CD-ROM sr0 at scsi0, channel 0, id 3, lun 0
  Vendor: PIONEER   Model: CD-ROM DR-U12X    Rev: 1.06
  Type:   CD-ROM                             ANSI SCSI revision: 02
Detected scsi CD-ROM sr1 at scsi0, channel 0, id 4, lun 0
scsi : detected 2 SCSI cdroms total.
But, as soon as I activate SMP in a kernel, I get this : (2.3.15 SMP)
scsi-ncr53c7,8xx : at PCI bus 0, device 15,  function 0
scsi-ncr53c7,8xx : disabling I/O mapping since base address 0 (0xa400)
        bits 0..1 indicate a non-IO mapping
scsi-ncr53c7,8xx : warning : revision of 18 is greater than 2.
scsi-ncr53c7,8xx : NCR53c810 at memory 0xeb000000, io 0x0, irq 9
First of all, I checked, as I read in a README, that my card is
jumpered to use INT A. That's OK.
Then, I found this on the Symbios website :
*** BEGIN OF  QUOTATION
Many Windows NT installation problems are due to IRQs not being enabled
properly, or the system have Dual Processors.  The subsequent sections
will guide the reader through common setup steps to enable IRQs and
general Windows NT 3.51 and NT 4.0 driver questions.
System CMOS setup hints:
The following section describes setup steps to take with 3 common
System CMOS's.
These are general procedures, since each Mother Board Vendor modifies
the BIOS to configure their Mother Board. To get the best results it is
best to set Network cards to IRQ 9.  This can be done via the software
that comes with the card.  Also set Sound cards to use IRQ 5.  For
detailed instruction for CMOS setups contact the Mother Board
Manufacturer.
Award BIOS
1)	While in the CMOS setup pick the "PCI Configuration Setup" or
        "PNP and PCI Configuration" menu. Change the settings for the
        slot number in which the Symbios Host Bus Adapter (HAB) is
        located if this option is available from "Auto Detect" to "INT
        A" or to an IRQ such as 10, 11, 12 or 15, leaving all other
        slots set to Auto. If there are no Slot options available then
        use the "MANUAL" setting.  This will show all of the IRQs and
        will list them as either "Legacy ISA" or "NO/ICU" or "PNP/PCI"
        or "Yes/ICU".  What you will do is set all IRQs below 9 to
        either Legacy ISA or NO/ICU.  IRQ's 10, 11, 12 and 15 will be
        set to PNP/PCI or Yes/ICU.
2)	The "Available IRQ" settings should be modified to 1st = 10,
        2nd = 11, 3rd = 12, and 4th = 15. Ensure that any other device
        in the system (i.e., sound card or LAN card) are not set to the
        same IRQs as the Symbios Logic HAB. For example, if the LAN
        card is using IRQ 11, remove IRQ 11 as the 1st available IRQ in
        the CMOS setting and shift all of the available IRQs up one
        level.
3)      Some versions have a statement that will say "PCI IRQ Activated
        by" set this to Level.  Some versions have a statment that will
        say "PCI IDE MAP to" set this to ISA or Absent.
*** END OF QUOTATION
I tried to do what they say, that does not solve the problem : the
SCSI controller card IRQ is changed, but is it not more accepted
by the kernel.
I have the same problem with Windows : 98 (not SMP) finds the card
and NT (SMP) does not. So I am sure the problem is not a consequence
of incorrectly configured kernels.
So my question is does anyone has managed to use such a card, on
an Abit BP6 in SMP ? If someone does, may he send me the BIOS
settings ?
Thanks in advance,
Jonathan Crenner
Eleve en troisieme annee ingenieur a l'EFREI
(Ecole Francaise d'Electronique et d'Informatique)
Email : crenner@efrei.fr ou jonathan_crenner@hotmail.com
______________________________________________________
Get Your Private, Free Email at 
http://www.hotmail.com
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.rutgers.edu
Please read the FAQ at 
http://www.tux.org/lkml/