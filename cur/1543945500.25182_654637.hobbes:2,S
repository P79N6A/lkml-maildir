Date: Sat, 16 Feb 2008 18:09:36 +0900
From: FUJITA Tomonori <>
Subject: [PATCH] iommu-helper: segment boundary limit should be a power of 2
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2008/2/16/41

The segment boundary limit should be a power of 2 so let's make it
clear.
Signed-off-by: FUJITA Tomonori <fujita.tomonori@lab.ntt.co.jp>
---
 lib/iommu-helper.c |    2 ++
 1 files changed, 2 insertions(+), 0 deletions(-)
diff --git a/lib/iommu-helper.c b/lib/iommu-helper.c
index 495575a..de0eced 100644
--- a/lib/iommu-helper.c
+++ b/lib/iommu-helper.c
@@ -54,6 +54,8 @@ unsigned long iommu_area_alloc(unsigned long *map, unsigned long size,
 			       unsigned long align_mask)
 {
 	unsigned long index;
+
+	BUG_ON(!is_power_of_2(boundary_size));
 again:
 	index = find_next_zero_area(map, size, start, nr, align_mask);
 	if (index != -1) {
-- 
1.5.3.7