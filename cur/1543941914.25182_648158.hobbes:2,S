Date: Mon, 4 Feb 2008 13:38:10 -0500
From: Vivek Goyal <>
Subject: Re: [mm] Crashkernel memory reservation fails with 2.6.24-rc8-mm1
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2008/2/4/256

On Mon, Feb 04, 2008 at 09:41:11PM +0530, Sachin P. Sant wrote:
> While trying to configure kdump with 2.6.24-rc8-mm1 [ on a x86-64 box ]
> i ran into this problem. Here is the snippet from dmesg during the
> failure. [ dmesg log attached ]
>
> early_ioremap(000000000000040e, 00000002) => -000002103442418
> early_iounmap(ffffffff82a0040e, 00000002)
> early_ioremap(000000000009dc00, 00001000) => -000002102797312
> early_iounmap(ffffffff82a9dc00, 00001000)
> crashkernel reservation failed - memory is in use
> [ffffe20000000000-ffffe200001fffff] PMD ->ffff810001200000 on node 0
> [ffffe20000200000-ffffe200003fffff] PMD ->ffff810001600000 on node 0
> [ffffe20000400000-ffffe200005fffff] PMD ->ffff810001a00000 on node 0
> [ffffe20000600000-ffffe200007fffff] PMD ->ffff810001e00000 on node 0
>
> I am using 128M@32M value for crashkernel parameter.
>
Hmm..., So somebody has already reserved the memory we are trying to
reserve. Bernhard's BOOTMEM_EXCLUSIVE flag is atleast giving the warning
otherwise it would have silently created an overlapping reserved memory
area.
Sachin, can you please put some debugging statements before the calls
to reserve_bootmem() in arch/x86 to find out who all are reserving what
memory area and then we can nail down the guy who is reserving some
memory between 32M and 160M
Wished we had some debugging printk statements for reserve_bootmem too
(the way we have for early_ioremap and early_iounmap).
Bernahard, any idea who is the competitor here?
Thanks
Vivek