Date: Wed, 27 Feb 2008 14:55:52 -0500
From: Chris Snook <>
Subject: Re: Performance problems with 3ware 9500S-4LP and 2.6.25-rc3
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2008/2/27/260

Andre Noll wrote:
> On 13:33, Chris Snook wrote:
> 
>>> During the daily cron job that uses rsync to sync a 500G file system
>> >from another machine to the raid on the 3ware controller the load
>>> jumps up, and the machine becomes sluggish as hell. For example, an
>>> ssh login to that machine takes minutes to complete and ldap becomes
>>> unreliable while the rsync job is running. Even Nagios complains
>>> about the machine being down while rsync is running.
>> You're putting your box under astronomical load.  This is generally 
>> regarded as a bad idea, regardless of how well your storage controller 
>> is performing.
> 
> The machine becomes sluggish also when I write directly to the raid
> array. A simple
> 
> 	dd if=/dev/zero of=tmpfile
> 
> shouldn't push the load up to 4, right?
Actually, it's normal for pdflush to spawn up to 8 threads when you're 
dirtying memory faster than it can be written to disk.  Load going to 4 
is not abnormal.  ssh logins taking minutes is very abnormal.
>> Can you measure the single-threaded throughput (say, 
>> coping one huge file, and then syncing) to give us a baseline 
>> performance figure?
> 
> Single threaded throughput seems to be ok (140M/s). The problem is
> that the machine becomes unresponsive.
Does the machine become unresponsive during the single-threaded test, or 
only when doing the rsync?
	-- Chris