Date: Mon, 13 May 2002 18:39:18 +0200 (SAST)
From: Zwane Mwaikambo <>
Subject: Re: OOPS 2.4.19-pre7-ac4 (Was: strange things in kernel 2.4.19-pre7-ac4 + preempt patch)
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2002/5/13/144

Could you try this patch, Bill came across it in rmap testing.
Regards,
	Zwane
--- linux-2.4.19-pre-ac/drivers/char/drm/i810_dma.c.orig	Mon May 13 18:27:40 2002
+++ linux-2.4.19-pre-ac/drivers/char/drm/i810_dma.c	Mon May 13 18:28:37 2002
@@ -293,8 +293,8 @@
 {
 	if (page) {
 		struct page *p = virt_to_page(page);
-		put_page(p);
 		UnlockPage(p);
+		put_page(p);
 		free_page(page);
 	}
 }
--- linux-2.4.19-pre-ac/drivers/char/drm-4.0/i810_dma.c.orig	Mon May 13 18:37:37 2002
+++ linux-2.4.19-pre-ac/drivers/char/drm-4.0/i810_dma.c	Mon May 13 18:38:03 2002
@@ -291,9 +291,9 @@
 	struct page * p = virt_to_page(page);
 	if(page == 0UL) 
 		return;
-	
+
+	UnlockPage(p);	
 	put_page(p);
-	UnlockPage(p);
 	free_page(page);
 	return;
 }
-- 
http://function.linuxpower.ca
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.kernel.org
More majordomo info at  
http://vger.kernel.org/majordomo-info.html
Please read the FAQ at  
http://www.tux.org/lkml/