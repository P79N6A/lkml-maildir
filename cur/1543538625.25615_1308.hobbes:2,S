Date: Tue, 11 Jul 2000 02:08:51 -0700
From: "Adam J. Richter" <>
Subject: Re: [PATCH] Re: Compile Errors on 2.4.0-test3 final
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2000/7/11/31

[Sorry if this is a duplicate.  vger.rutgers.edu sent me a "policy
analysis error" that did not indicate what the error actually was. --Adam.]
t.n.vanderleeuw@chello.nl writes:
>Here's a patch:
>--- kernel/timer.c.orig	Tue Jul 11 09:00:31 2000
>+++ kernel/timer.c	Tue Jul 11 09:02:44 2000
>@@ -577,7 +577,7 @@
> 			p->counter = 0;
> 			p->need_resched = 1;
> 		}
>-		if (p->priority < DEF_PRIORITY)
>+		if (p->nice < DEF_NICE)
		           ^^^
> 			kstat.cpu_nice += user_tick;
> 		else
> 			kstat.cpu_user += user_tick;
	That area that I underlined should be ">".  Higher numbers
in p->priority meant "faster".  Lower numbers in p->nice mean "faster".
(In other words, if a process has a higher nice value, it is being nicer.
>Note to Adam J. Richter:
>I looked at the patch you posted, and I believe you left out this
>instance of p->priority. :-)
	Yes, thank you for catching this.  You are quite right that I
did not notice uniprocessor or, for that matter, non-x86 code or a lot
of non-module code.  The build that I did was with CONFIG_SMP with every
single possible module modularized, and every boolean set to "y", with
the exception that CRAMFS and the initial ramdisk were compiled in, and
a few booleans that it would basically be insane to have on in such a
configuration are set to "n".
	Executive summary to Linus and other kernel maintainers: I recommend
that you still apply my patch, and you should also apply this hand edit of
T. N. Vanderleeuw's patch (just changing "<" to ">"):
Adam J. Richter     __     ______________   4880 Stevens Creek Blvd, Suite 104
adam@yggdrasil.com     \ /                  San Jose, California 95129-1034
+1 408 261-6630         | g g d r a s i l   United States of America
fax +1 408 261-6631      "Free Software For The Rest Of Us."
--- kernel/timer.c.orig	Tue Jul 11 09:00:31 2000
+++ kernel/timer.c	Tue Jul 11 09:02:44 2000
@@ -577,7 +577,7 @@
 			p->counter = 0;
 			p->need_resched = 1;
 		}
-		if (p->priority < DEF_PRIORITY)
+		if (p->nice > DEF_NICE)
 			kstat.cpu_nice += user_tick;
 		else
 			kstat.cpu_user += user_tick;
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.rutgers.edu
Please read the FAQ at 
http://www.tux.org/lkml/