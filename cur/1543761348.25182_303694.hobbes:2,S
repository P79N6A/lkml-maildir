Date: Thu, 17 Mar 2005 17:18:39 +0800
From: Li Shaohua <>
Subject: [PATCH]fix oops when inserting ipmi_si module
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2005/3/17/27

Hi,
In one of machines in our lab, spmi->addr.register_bit_width is 0 (so
the returned address is invalid). Ignoring the check will cause
inserting the module oops.
Thanks,
Shaohua
Signed-off-by: Li Shaohua<shaohua.li@intel.com>
--- a/drivers/char/ipmi/ipmi_si_intf.c	2005-03-03 10:56:51.000000000 +0800
+++ b/drivers/char/ipmi/ipmi_si_intf.c	2005-03-17 16:34:32.478606080 +0800
@@ -1466,6 +1466,11 @@ static int try_init_acpi(int intf_num, s
 	if (!is_new_interface(-1, addr_space, spmi->addr.address))
 		return -ENODEV;
 
+	if (!spmi->addr.register_bit_width) {
+		acpi_failure = 1;
+		return -ENODEV;
+	}
+
 	/* Figure out the interface type. */
 	switch (spmi->InterfaceType)
 	{
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.kernel.org
More majordomo info at  
http://vger.kernel.org/majordomo-info.html
Please read the FAQ at  
http://www.tux.org/lkml/