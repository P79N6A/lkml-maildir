Date: Fri, 10 Nov 2006 17:35:29 +0100
From: Andi Kleen <>
Subject: Re: [discuss] Re: 2.6.19-rc5: Bad page state in process 'swapper'
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2006/11/10/198

On Friday 10 November 2006 17:10, Andre Noll wrote:
> On 14:36, Andre Noll wrote:
> 
> > > Does it help when you apply 
> > > 
> > > 
ftp://ftp.firstfloor.org/pub/ak/x86_64/quilt/patches/e820-small-entries
 ? 
> > 
> > OK I will try this. Can't promise if I will be able to do so today, as I
> > have to wait until the currently running jobs are finished.
> 
> I could check it already today: Your patch doesn't help unfortunately,
> i.e. I get the same "Bad page state in process 'swapper'" messages also
> with this patch. Again, nothing containing "e820" in the log.
If you apply the following debug patch you should get a shorter log.
Can you post it please?
-Andi
Index: linux/mm/page_alloc.c
===================================================================
--- linux.orig/mm/page_alloc.c
+++ linux/mm/page_alloc.c
@@ -188,6 +188,11 @@ static inline int bad_range(struct zone 
 
 static void bad_page(struct page *page)
 {
+	static int flag;
+	if (flag)
+		return;
+	flag = 1;
+
 	printk(KERN_EMERG "Bad page state in process '%s'\n"
 		KERN_EMERG "page:%p flags:0x%0*lx mapping:%p mapcount:%d count:%d\n"
 		KERN_EMERG "Trying to fix it up, but a reboot is needed\n"
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.kernel.org
More majordomo info at  
http://vger.kernel.org/majordomo-info.html
Please read the FAQ at  
http://www.tux.org/lkml/