Date: Tue, 2 Feb 1999 00:38:07 -0500 (EST)
From: Marc Heckmann <>
Subject: Re: adding an already added raid
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/1999/2/2/3

Don't know if this is fixed in latest raid patch... I included a trace at
the bottom.
	Marc
[root@fsck /root]# uname -a
Linux fsck.ikr.org 2.2.1 #43 Fri Jan 29 00:43:48 EST 1999 i586 unknown
[root@fsck /root]# cat /proc/mdstat
Personalities : [3 raid1]
read_ahead 128 sectors
md0 : active raid1 sdb5 hda2 sdb5 1028032 blocks [3/2] [UU_]
md1 : inactive
md2 : inactive
md3 : inactive
[root@fsck /root]# mount |grep md0
/dev/md0 on /home type ext2 (rw,nosuid,nodev,usrquota)
[root@fsck /root]# raidadd /dev/md0
Unable to handle kernel NULL pointer dereference at virtual address
00000080
current->tss.cr3 = 019c8000, %cr3 = 019c8000
*pde = 00000000
Oops: 0002
CPU:    0
EIP:    0010:[<c016e546>]
EFLAGS: 00010282
eax: 36b68a69   ebx: 00000003   ecx: c2e70815   edx: 00000000
esi: c0fa5a00   edi: c3c60000   ebp: c0208810   esp: c19cbf18
ds: 0018   es: 0018   ss: 0018
Process raidadd (pid: 17048, process nr: 57, stackpage=c19cb000)
Stack: c3c60000 c0208810 c012422f c2e7f3c0 c02099d4 00000000 c4c5483e
00000015
       c0208810 00000000 00000815 c02087c8 00000246 c3e70815 c016ec16
c02087c8
       00000815 00000000 00000815 00000815 c332a6a8 00000001 c016edbb
00000000
Call Trace: [<c012422f>] [<c4c5483e>] [<c016ec16>] [<c016edbb>]
[<c012b038>] [<c0107b0c>]
Code: 89 82 80 00 00 00 c7 44 24 10 00 00 00 00 e9 4b 01 00 00 8d
Segmentation fault
trace:
>>EIP: c016e546 <md_update_sb+2a/1a8>
Trace: c012422f <__brelse+13/34>
Trace: c4c5483e <raid1_hot_add_disk+da/fc>
Trace: c016ec16 <do_md_add+14a/18c>
Trace: c016edbb <md_ioctl+163/348>
Trace: c012b038 <sys_ioctl+138/150>
Trace: c0107b0c <system_call+34/38>
Code:  c016e546 <md_update_sb+2a/1a8>          00000000 <_EIP>:
Code:  c016e546 <md_update_sb+2a/1a8>             0:    89 82 80 00 00  movl   %eax,0x80(%edx)
Code:  c016e54b <md_update_sb+2f/1a8>             5:    00
Code:  c016e54c <md_update_sb+30/1a8>             6:    c7 44 24 10 00  movl   $0x0,0x10(%esp,1)
Code:  c016e551 <md_update_sb+35/1a8>             b:    00 00 00
Code:  c016e554 <md_update_sb+38/1a8>             e:    e9 4b 01 00 00 jmp 15e <_EIP+0x15e> c016e6a4 <md_update_sb+188/1a8>
Code:  c016e559 <md_update_sb+3d/1a8>            13:    8d 00 	       leal (%eax),%eax
>Warning:
>        I dunno if this is still true.  But in 2.2.0-pre9
>        I did a raidadd /dev/md0 when /dev/md0 was already
>        mounted and .. well .. this is what followed.
>        Maybe my tools are out of date?  Anyway. Here's the
>        ugly stuff.
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.rutgers.edu
Please read the FAQ at 
http://www.tux.org/lkml/