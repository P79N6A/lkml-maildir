Date: Thu, 28 Oct 2004 02:17:54 +0200
From: Andi Kleen <>
Subject: Re: [PATCH] Add p4-clockmod driver in x86-64
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2004/10/27/452

On Wed, Oct 27, 2004 at 10:50:38PM +0100, Alan Cox wrote:
> On Mer, 2004-10-27 at 22:38, Rutger Nijlunsing wrote:
> > So you've got the _disadvantages_ of a slow clock (programs run
> > slower), and not the _advantages_ (power consumption is same as idle
> > CPU and not lower, temperature is same as idle CPU and not lower).
> > 
> > But why does the P4 have such a mode? It uses this mode during thermal
> > throttling to get to the 'idle' temperature.
> 
> It isn't obvious how you software idle a PIV - "hlt" at least does not
> seem to do that.
It depends on the BIOS. hlt can do it with the right SMM code.
Other than that you need ACPI.
The main reason that BIOS don't use the more advanced power saving
modi is that they tend to have much longer latencies, and hlt cannot
know what interrupt latency the OS wants. A lot of BIOS seem 
to go for short latency for compatibility.
That is why using the ACPI processor driver is a much better
choice, because it actually tries to figure this out and use the
correct sleep mode for the load.  It doesn't do it very well on Linux yet
though because of lacking infrastructure in the main kernel
(e.g. it needs better accounting for interrupts) , but I hope 
that can be eventually improved.
<insert standard rant about the the 1ms timer tick that also
doesn't help at all for this>
-Andi
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.kernel.org
More majordomo info at  
http://vger.kernel.org/majordomo-info.html
Please read the FAQ at  
http://www.tux.org/lkml/