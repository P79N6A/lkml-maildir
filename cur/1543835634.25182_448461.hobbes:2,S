Date: Mon, 31 Jul 2006 17:30:55 +0900
From: Yasunori Goto <>
Subject: Re: [Lhms-devel] [Patch] 3/5 in support of hot-add memory x86_64 arch_find_node	x86_64
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2006/7/31/81

> diff -urN orig/arch/x86_64/mm/srat.c work/arch/x86_64/mm/srat.c
> --- orig/arch/x86_64/mm/srat.c	2006-07-28 13:57:35.000000000 -0400
> +++ work/arch/x86_64/mm/srat.c	2006-07-28 21:19:01.000000000 -0400
> @@ -450,3 +450,15 @@
>  }
> 
>  EXPORT_SYMBOL(__node_distance);
> +
> +int arch_find_node(unsigned long start, unsigned long size) 
> +{
> +	int i, ret = 0;
> +	unsigned long end = start+size;
> +	
> +	for_each_node(i) {
> +		if (nodes_add[i].start <= start && nodes_add[i].end >= end)
> +			ret = i;
> +	}
> +	return ret;
> +}
BTW, does anyone know why nodes_add[] becomes arch dependent code?
I know it is defined in x86-64. But I mean that SRAT is not
arch dependent. It is defined by just ACPI.
However, each arch which uses ACPI has a own code to parse SRAT table.
Is it hard to merge all of them? Are there any special case?
If they can be merged, this code can be written in driver/acpi/numa.c.
Bye.
-- 
Yasunori Goto 
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.kernel.org
More majordomo info at  
http://vger.kernel.org/majordomo-info.html
Please read the FAQ at  
http://www.tux.org/lkml/