Date: Thu, 12 Jul 2001 11:14:24 +1000 (EST)
From: Neil Brown <>
Subject: Re: Re[2]: Is  Swapping on software RAID1 possible  in linux 2.4 ?
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2001/7/11/130

On Thursday July 5, pz@spylog.ru wrote:
> Hello Neil,
> 
> Thursday, July 05, 2001, 4:13:00 PM, you wrote:
> 
> NB> On Thursday July 5, pz@spylog.ru wrote:
> >> Hello linux-kernel,
> >> 
> >>   Does anyone have information on this subject ?  I have the constant
> >>   failures with system swapping on RAID1, I just wanted to be shure
> >>   this may be the problem or not.   It works without any problems with
> >>   2.2 kernel.
> 
> NB> It certainly should work in 2.4.  What sort of "constant failures" are
> NB> you experiencing?
> 
> NB> Though it does appear to work in 2.2, there is a possibility of data
> NB> corruption if you swap onto a raid1 array that is resyncing.  This
> NB> possibility does not exist in 2.4.
> 
> 
> 
> The problem is I'm constantly getting these  X-order-allocation errors
> in kernel log and after which system becomes unstable and often hangs
> or leaves process which cannot be killed even by "-9" signal.
> Installed debuggin patches produce the following allocation paths:
These "X-order-allocation" failures are just an indication that you
are running out or memory.  raid1 is explicitly written to cope.
If memory allocation fails it waits for some to be free, and it has
made sure in advance that there is some memory that it will get
first-dibs on when it becomes free, so there is no risk of deadlock.
However this does not explain why you are getting unkillable
processes.
Can you try to put swap on just one of the partitions that your raid1
together instead of on the raid1 array and see if you can get
processes to become unkillable.
Also, can you find out what that process is doing when it is
unkillable.
If you compile with alt-sysrq support, then alt-sysrq-t should print
the process table.  If you can get this out of dmesg and run if though
ksymoops it might be most interesting.
NeilBrown
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.kernel.org
More majordomo info at  
http://vger.kernel.org/majordomo-info.html
Please read the FAQ at  
http://www.tux.org/lkml/