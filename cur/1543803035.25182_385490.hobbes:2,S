Date: Fri, 13 Jan 2006 11:20:48 +1000
From: Adam Nielsen <>
Subject: "umount: device is busy" when device is not in use?
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2006/1/12/416

Hi all,
Is it possible to ask the kernel what processes are using a particular
filesystem?
The reason being I have a stubborn NFS mount that refuses to unmount
saying it's in use, but I can't find what's using it:
$ umount /mnt/data
umount: /mnt/data: device is busy
umount: /mnt/data: device is busy
$ umount -f /mnt/data
umount2: Device or resource busy
umount: /mnt/data: device is busy
umount2: Device or resource busy
umount: /mnt/data: device is busy
$ lsof | grep data
<nothing>
So the kernel obviously thinks the filesystem is in use, but I'm
not sure how to find out what's using it.  No processes have their
current working directory on this filesystem, and I'm sure there
aren't any open files on it.
Even forcefully unmounting the filesystem (-f) doesn't work, although
I've never gotten that to work before.  Is it even possible to force an
unmount of a filesystem that's in use?
This is under kernel 2.6.14.
Thanks,
Adam.
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.kernel.org
More majordomo info at  
http://vger.kernel.org/majordomo-info.html
Please read the FAQ at  
http://www.tux.org/lkml/