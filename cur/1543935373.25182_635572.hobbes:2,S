Date: Tue, 8 Jan 2008 22:02:27 +1100
From: Rusty Russell <>
Subject: Re: [PATCH 04/16] per-cpu run guest
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2008/1/8/113

On Tuesday 08 January 2008 00:05:25 Glauber de Oliveira Costa wrote:
> +	/* Watch out for arbitrary vcpu indexes! */
> +	if (vcpu_id > lg->nr_vcpus)
> +		return -EINVAL;
> +
> +	vcpu = &lg->vcpus[vcpu_id];
> +
Out-by-one error here... Fixed it for you, plus a couple of others.
I've applied the patches, but made one minor-but-invasive change: I didn't 
want to ask you to spin the patches again!
I changed "vcpu" to "cpu" everywhere (the v is pretty redundant in this 
context), which cut about a dozen lines of code out (things now fitted 
again!).
I also changed "vcpu_id" to simply "id" and made it unsigned.  Do you plan for 
this to always be equal to the index in the vcpu array BTW?  If so, we can 
neaten vcpu_start (now lg_cpu_start)...
You can grab the latest now...
Thanks!
Rusty.