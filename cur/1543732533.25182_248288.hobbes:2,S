Date: Thu, 2 Sep 2004 12:03:52 -0700
From: "Aleksey Gorelov" <>
Subject: RE: [PATCH] Early USB handoff
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2004/9/2/204

>> I'm also not clear what kind of BIOS quirk it's trying to
>> resolve.  Is the issue just that PCI setup from Linux, long
>> before the HCD initializes, ends up confusing the BIOS
>> on those "summit" machines?  What symptoms would
>> suggest that I should try this option, on non-summit boxes?
>
>
https://bugzilla.redhat.com/bugzilla/show_bug.cgi?id=126984
>
>Here's the interesting part:
>
>> The hardware team here narrowed down the boot time hang to a 
>BIOS bug 
>> where the USB Legacy support feature causes register 
>corruption. This 
>> is unfortunately due to architecture timing constraints and 
>cannot be 
>> fixed with a BIOS update. Disabling Legacy USB support works around 
>> the issue, but leaves the user w/o keyboard support in grub.  
[snip]
>I suspect Aleks hits a similar issue with some other hardware.
>
>-- Pete
>
Pete, thanks for an explanation & reference. Though, I also got
"not authorized" while trying to access it.
Patch is supposed to resolve at least 2 issues (I ran into 
both of them on different laptops):
1. USB Legacy support problem Pete mentioned above
2. Boot lockup problem due to an interrupt shared with HC 
   on a platform with legacy free BIOS.
Symptoms for second one are described here:
http://www.mail-archive.com/linux-usb-devel@lists.sourceforge.net/msg267
77.html
  Basically, in a case of legacy free BIOS, HC is not in 
SMM mode, and USB IRQ is routed to PCI IRQ line and generates
interrupts. When this IRQ is enabled in PIC (by driver that 
starts before HC driver), system is flooded with interrupts.
  One solution is to reset HC, but it takes some time (at 
least 50ms). I agree that it might duplicate SOME code in HC 
driver, but HC init executes too late. Well, if handoff has 
been done early, it might not be necessary to do the same in 
HC driver.
Aleks.
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.kernel.org
More majordomo info at  
http://vger.kernel.org/majordomo-info.html
Please read the FAQ at  
http://www.tux.org/lkml/