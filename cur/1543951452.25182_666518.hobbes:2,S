Date: Tue, 11 Mar 2008 19:53:09 -0700
From: Max Krasnyansky <>
Subject: Re: boot cgroup questions
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2008/3/11/466

Paul Menage wrote:
> On Tue, Mar 11, 2008 at 7:34 PM, Max Krasnyansky <maxk@qualcomm.com> wrote:
>>  Suppose we were to do it from kernel. What's the right way to create a cgroup
>>  without mounting a cgroupfs ?
> 
> There isn't really a way, but you could always kern_mount() a
> filesystem inside the kernel.
Aha, that's what I was missing. kern_mount(). Cool :).
>>  I just want to play with it. There are a couple of advantages that I see for
>>  doing it from kernel. We can move 'kthreadd' and idle threads into the 'boot'
>>  cgroup early on and therefor later on won't even have to iterate through the
>>  tasks and stuff.
> 
> Would this be done based on some boot commandline option? I don't
> think you'd want to do it unconditionally.
Hmm, I believe the original discussion was about doing it unconditionally.
Why not I guess ? It probably won't even affect your existing scripts since
they will be able to move tasks into another set just like they do now. The
only thing I can think of is that if your scripts use sched_load_balance then
they will now have to unset it in the 'boot' set as well. Otherwise since the
'boot' set will be non-exclusive (cpus and mems) it should not really affect
anything.
So what's your concern with unconditional 'boot' cgroup/cpuset ?
Max