Date: Thu, 02 Aug 2007 21:35:15 +0200
From: Miklos Szeredi <>
Subject: Re: kupdate weirdness
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2007/8/2/322

> There were heaps of problems in there and it is surprising how few people
> were hitting them.  Ordered-mode journalling filesystems will fix it all up
> behind the scenes, of course.
> 
> I just have a bad feeling about that code - list_heads are the wrong data
> structure and it all needs to be ripped and redone using some indexable
> data structure.  There has been desultory discussion, but nothing's
> happening and nothing will happen in the medium term, so we need to keep
> on whapping bandainds on it.
The reason why I'm looking at that code is because of those
balance_dirty_pages() deadlocks.  I'm not perfectly happy with the
per-pdi-per-cpu counters Peter's patch is introducing.
I was wondering if we can count the number of writeback pages through
the radix tree, just like we do for dirty pages?
All that would be needed is to keep the under-writeback inodes on some
list as well.
But I realize, that this introduces it's own problems as well...
Miklos
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.kernel.org
More majordomo info at  
http://vger.kernel.org/majordomo-info.html
Please read the FAQ at  
http://www.tux.org/lkml/