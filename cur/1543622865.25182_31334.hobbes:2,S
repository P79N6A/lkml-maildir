Date: Thu, 28 Feb 2002 15:57:31 -0600
From: Sandino Araico Sánchez <>
Subject: 2.4.17,2.4.18 ide-scsi+usb-storage+devfs Oops
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2002/2/28/77

The Oops happens after I use the ide-scsi module with my CDRW and then I
plug the Zip USB in.
To reproduce the oops:
1. Boot the machine (usbmgr should be started at boot)
2. rmod ide-cd ; rmmod ide-scsi ; rmmod sr_mod ; rmmod cdrom
3. modprobe ide-scsi
    /dev/scsi/host2/bus0/target0/lun0/generic is created
4. modprobe sr_mod
    /dev/scsi/host2/bus0/target0/lun0/cd is created
    /dev/cdroms/cdrom0 -> /dev/scsi/host2/bus0/target0/lun0/cd
5. Plug the Zip in the USB
    usb-storage is loaded
    /dev/scsi/host2/bus0/target0/lun0/disc is created
    /dev/scsi/host2/bus0/target0/lun0/part4 is created
    /dev/scsi/host2/bus0/target0/lun0/cd disappears
    /dev/cdroms/cdrom0 becomes broken link
    /dev/scsi/host2/bus0/target0/lun0/generic changes from the CDRW
generic device to the Zip generic device
6. Unplug the Zip
    /dev/scsi/host2/bus0/target0/lun0 disappears, I can only reach to
/dev/scsi/host2/bus0/target0
    usb-storage is unloaded
7. different ways of provoking the Oops
    7.1 umount /mnt/cdrom
    7.2 rmmod sr_mod
    7.3 rmmod ide-scsi
    7.4 Any kind of trying to read or write the CD
The Oops does not happen if I unload ide-scsi, sr_mod, cdrom before
pluging the Zip in and if I unplug the Zip before modprobe ide-scsi and
modprobe sr_mod.
--
Sandino Araico Sánchez
>drop table internet;
OK, 135454265363565609860398636678346496 rows affected.
"oh fuck" --fluxrad
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.kernel.org
More majordomo info at  
http://vger.kernel.org/majordomo-info.html
Please read the FAQ at  
http://www.tux.org/lkml/