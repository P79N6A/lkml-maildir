Date: Tue, 04 Dec 2007 05:48:45 -0700
From: (Eric W. Biederman)
Subject: Re: [PATCH 1/7][QUOTA] Move sysctl management code under ifdef CONFIG_SYSCTL
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2007/12/4/99

Pavel Emelyanov <xemul@openvz.org> writes:
> [snip]
>
>>> We do have some current code in the network stack that fails miserably
>>> when  register_sysctl_table returns NULL, and there are explicit
>>> checks for that.
>> 
>> So that code would be failing today with CONFIG_SYSCTL=n?  Unless the
>> failing code is itself under #ifdef CONFIG_SYSCTL, in which case we don't
>> need to change anything?
>
> Exactly! If the code checks for the return value it won't work
> with CONFIG_SYSCTL=n, if it dies not - it may happily use the
> sysctl stub and avoid extra ifdefs.
>
> But this difference looks clumsy :(
So we remove the check as we clean up the code.
Unless we happen to find something that can do something useful and
reasonable is register_sysctl_xxxx fails.
Eric