Date: Wed, 17 Sep 2003 13:54:25 -0700
From: "Chen, Kenneth W" <>
Subject: Hugetlb FS quota problem
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2003/9/17/149

We found a problem in hugetlbfs file system quota when using huge page
via mmap.  The mmap method in hugetlbfs_file_operation always takes
quota for every mmap even for pages that are already allocated on that
inode.  This results in taxing the same hugepage multiple times and
causing mmap to fail on existing file when quota mistakenly runs out.
The following patch against 2.6.0-test5 fix the problem.
 <<htlbfs_quota.patch>> 
[unhandled content-type:application/octet-stream]