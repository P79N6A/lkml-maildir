Date: Wed, 11 Jun 2003 20:02:48 +0200
From: Thomas Schlichter <>
Subject: Re: problem when compile 2.5.70-mm8
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2003/6/11/147

jds wrote:
> Hi:
>
>    I try the compile kernel 2.5.70-mm8 and recive this messages:
  ~~ snip ~~
>   CC      arch/i386/kernel/setup.o
> arch/i386/kernel/setup.c: In function `setup_early_printk':
> arch/i386/kernel/setup.c:919: invalid lvalue in unary `&'
> make[1]: *** [arch/i386/kernel/setup.o] Error 1
> make: *** [arch/i386/kernel] Error 2
>
>   Help me please;
>
>   Regards.
As posted before the attached patch helps.
If you do not want to use the EARLY_PRINTK feature at all but are too lazy to 
turn it off in the Kernel debug menu explicitly (as I am, too ;-) you may 
also use the second attached patch wich corrects dependencies in Kconf.
Best regards
   Thomas Schlichter
--- linux-2.5.70-mm8/arch/i386/kernel/setup.c.orig	Wed Jun 11 11:10:35 2003
+++ linux-2.5.70-mm8/arch/i386/kernel/setup.c	Wed Jun 11 11:11:36 2003
@@ -910,6 +910,7 @@
 extern int __init serial8250_console_init(void);
 void setup_early_printk(void)
 {
+#ifdef CONFIG_SMP
 	/* 
 	 * printk currently checks cpu_online_map to make sure that
 	 * we don't try to printk from a CPU which hasn't had resources
@@ -917,6 +918,7 @@
 	 * enable here don't require per-cpu resources.
 	 */
 	set_bit(smp_processor_id(), &cpu_online_map);
+#endif
 #ifdef CONFIG_DEBUG_EP_SERIAL
 	console_setup(CONFIG_DEBUG_SERIAL_OPTIONS);
 	serial8250_console_init();--- linux-2.5.70-mm8/arch/i386/Kconfig.orig	Wed Jun 11 11:23:17 2003
+++ linux-2.5.70-mm8/arch/i386/Kconfig	Wed Jun 11 11:25:25 2003
@@ -1795,7 +1795,7 @@
 
 config DEBUG_EARLY_PRINTK
 	bool
-	depends on !DEBUG_EARLY_PRINTK_OFF
+	depends on DEBUG_EP_SERIAL || DEBUG_EP_VGA
 	default y
 
 config DEBUG_SERIAL_OPTIONS[unhandled content-type:application/pgp-signature]