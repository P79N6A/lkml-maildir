Date: Wed, 6 Oct 2004 10:42:51 +0200
From: Colin Leroy <>
Subject: Re: Netconsole & sungem: hang when link down
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2004/10/6/46

On 06 Oct 2004 at 18h10, Benjamin Herrenschmidt wrote:
Hi, 
> On Wed, 2004-10-06 at 16:39, Colin Leroy wrote:
> > Hi,
> > 
> > I noticed that, if you have netconsole set up and using a sungem
> > card, and if the network cable is not plugged in, that the whole
> > kernel hangs shortly after the "device not up yet, forcing it"
> > netconsole message. I suspect this is due to the autoneg in sungem,
> > but didn't have time to look further. 
> > 
> > Would you have any hints on the cause of this problem?
> 
> Not sure, I suppose the driver is doing printk's with spinlocks held
> from the autoneg stuff and there is a spinlock deadlock happening ...
Thanks. I'll look into this. If I'm not mistaken, I've got no way of
catching it easily, do I ? CONFIG_DEBUG_SPINLOCK's help seems to say
that I need NMI watchdog in order to catch deadlocks, which is only
available on x86(_64).
-- 
Colin
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.kernel.org
More majordomo info at  
http://vger.kernel.org/majordomo-info.html
Please read the FAQ at  
http://www.tux.org/lkml/