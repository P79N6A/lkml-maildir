Date: Tue, 18 Mar 2008 19:52:06 -0600
From: Alex Chiang <>
Subject: Re: [PATCH 0/3, v10] PCI, ACPI: Physical PCI slot objects
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2008/3/19/271

Hi Willy,
* Matthew Wilcox <matthew@wil.cx>:
> On Tue, Mar 18, 2008 at 03:05:39PM -0600, Alex Chiang wrote:
> > Also, v10 should fix the "pci_slot module changes the sysfs
> > name" issue that Kenji-san was seeing.
> 
> I thought we agreed that the current names are wrong, and we
> shouldn't consider this 'different name' an issue.
I did see some discussion around this, but wasn't actually sure
what we decided on. For v10, the little adjustment I made keeps
the existing userspace names for pciehp, but doesn't affect
shpchp.
[The example that Kenji-san sent out earlier showed that his
pciehp slot names changed depending on the order of module
loading between pciehp and pci_slot; his shpchp slot names did
not change.]
Injecting my thoughts into the exchange between Kenji-san and
Kristen earlier on this subject...
> > * Kenji Kaneshige <kaneshige.kenji@jp.fujitsu.com>:
> * Kristen Carlson Accardi <kristen.c.accardi@intel.com>:
* Kenji Kaneshige <kaneshige.kenji@jp.fujitsu.com>:
> > >     Though I don't have any specific idea about this,
> > >     folliwings might be candidates.                                                           
> > > 
> > >     - Override slot names with hotplug driver's slot names                   
> > I think this should be done - if the pci slot driver detects
> > that a hotplug driver is controlling a slot, it should allow
> > that driver to set the name of the slot.                                                     
> 
> Yes, it is what I thought.  But maybe we should try unifying
> slots names first, I think.
This is the tweak I added in v10.
> > >     - Unify slot names among all hotplug drivers                             
> > I'm not sure if we can do this, since slot name might depend
> > on what spec people are implementing.                                                 
> 
> I'm not sure too. But I think we can unify the slot names using
> the combination of chassis number and slot number among the
> controllers which is based on PCI Hot-Plug spec.
I could take this approach instead, but it will definitely change
what userspace sees. I'd like to get an ACK from Kristen before
starting down this path.
Actually, my real preference would be to save it for a future
patch set, while I work on getting this one into the tree. ;)
> > >     - Stop automatic loading of ACPI PCI slot driver                         
> > I think we should definitely implement this one ^^^. 
I don't think that should be happening anyway. On my Fedora Core
8 userspace, pci_slot doesn't get loaded until I modprobe it.
Maybe Kenji-san is building it into his kernel?
/ac