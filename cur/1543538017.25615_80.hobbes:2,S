Date: Sun, 2 Jul 2000 00:37:15 +0000
From: Shane Nay <>
Subject: Re: xfree and devel kernels > 2.3.99-pre6
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2000/7/3/80

Pete & Keith,
To sort of confirm and maybe help eliminate some possibilities from the
problem..., I also had this exact problem with XFree4, and the 2.3 series
kernels.  (Don't know how far back, but before pre6 I'm pretty sure)  I was
running a AMD k7, obviously single CPU, so it's probably not SMP related.  But
there is another _really_ odd thing about Xfree4 and the matrox g400, if you
enable the framebuffer, X shoots garbage all throughout the memory for the card
so when you jump down to the console and change page up/down in Vi it spews
nonsense everywhere.  I thought this was a function of the kernel, but it
turned out to be X because I downgraded to Xfree3 series and it works like a
charm.  (actually if you drive X and your console at the same colordepth and
resolution when you page up/down in vi you'll actually see pieces of your X
session)
So I think it might be a memory issue with Xfree4's matrox driver..., BTW: If
you leave your station with X running but leave it on the console X will die,
but it won't mess up the kernel's ability to use your machine.   (It also gives
you a fairly usefull message, but I can't remember what, it's been a little
while) In my case the kernel and all the apps other than X apps where doing
just fine, but X apps were blown, and if it went down while in X the computer
became useless..., except to ssh into to shut the machine down.  Maybe the
Xfree4 driver for g400 is messed up, or maybe you just need to set some options
to set memory holes or something like that for it not to touch, not sure. 
(BTW: I've only tested Xfree4 on the g400, I assumed that it was just really
unstable, is this not the case?)
(oh yea, the keyboard get's wickedly messed up, but if you can telnet in or
something you can do a chvt, and then a kbd_mode (hmm.., that's not quite
right, but maybe you know what I mean) to set the keyboard mode to ascii. 
After that you'll see weird overlays of pieces of your console and other
gibberish, but the system is unusable still, it's kind of neat though :-)
Thanks,
Shane.
(Oh, if you're using fb mode you might try to push a console to the second head
or something if you have that card..., that would likely work just fine)
On Sun, 02 Jul 2000, you wrote:
> 
> thanks, keith,
> 
> i did get a console set up and what i found surprised me.
> 
> as a recap, i'm running a dual p3 600 machine (test2 smp kernel), with
> 512M ram, asus p2b-d mobo, and matrox g400 max video card.
> 
> when x locked up this time, i checked to make sure it was just as dead
> as before... no keyboard response whatsoever (no capslock, no numlock,
> no alt-sysreq) and no mouse movement.  from another virtual console on
> my console box, i tried pinging my locked up box.  all pings died.  i
> couldn't ssh to it, _but_ i was able to log in from console and that
> seemed to work just fine.  killing all x-related processes didn't
> release my keyboard and monitor though.  i eventually had to reboot from
> console.
> 
> this leads me to believe that:
> a. sometime after 2.3.99-pre6 was released, my video card had a minor
> stroke.
> -or-
> b. something in pre7 and above is triggering some bug in either x or the
> g400 that causes the g400 to completely wedge.  
> 
> could there be another possibility?  does anyone have any ideas about
> how i might be able to figure out which is true?
> 
> is there a software utility for resetting a g400?
> 
> thanks,
> pete
> 
> On Sat, 01 Jul 2000, Keith Owens wrote:
> 
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.rutgers.edu
Please read the FAQ at 
http://www.tux.org/lkml/