Date: Wed, 2 Jul 2003 11:59:10 +0100
From: Joe Thornber <>
Subject: Re: [dm-devel] Re: [RFC 3/3] dm: v4 ioctl interface
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2003/7/2/66

Clear the read-only flag if the table is not read only.
--- diff/drivers/md/dm-ioctl-v4.c	2003-07-01 15:36:42.000000000 +0100
+++ source/drivers/md/dm-ioctl-v4.c	2003-07-02 11:27:50.000000000 +0100
@@ -650,7 +650,9 @@
 			return r;
 		}
 
-		if (!(dm_table_get_mode(new_map) & FMODE_WRITE))
+		if (dm_table_get_mode(new_map) & FMODE_WRITE)
+			set_disk_ro(dm_disk(md), 0);
+		else
 			set_disk_ro(dm_disk(md), 1);
 
 		dm_table_put(new_map);
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.kernel.org
More majordomo info at  
http://vger.kernel.org/majordomo-info.html
Please read the FAQ at  
http://www.tux.org/lkml/