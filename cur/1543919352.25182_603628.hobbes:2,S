Date: Thu, 11 Oct 2007 11:06:08 +0930
From: David Newall <>
Subject: Re: [OT] Argument with an OS professor over profile=3
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2007/10/10/256

Russ Dill wrote:
> I've been having a back and forth going for a while with my TA and OS
> professor on the meaning of profile=3 and have been unable to convince
> either of them. The basic question is if profile=3 is passed to kernel
> with an 8MB text section, how big is the allocated profile buffer. His
> answer is 1MB....
>
>         if (prof_shift) {
>                 unsigned int size;
>                 /* only text is profiled */
>                 prof_len = (unsigned *) &_etext - (unsigned *) &_stext;
> 
You stipulated 8MB text, but this calculates in unsigned ints, so 
prof_len = 2M.
>                 prof_len >>= prof_shift;
> 
This gives 250K (divide by 8).
>                 size = prof_len * sizeof(unsigned int) + PAGE_SIZE-1;
> 
Finally, size is 1MB (250K x 4).
>                 prof_buffer = (unsigned int *) alloc_bootmem(size);
>         }
> 
I'm with your Prof.  Perhaps you missed that prof_len counts integers, 
not bytes.
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.kernel.org
More majordomo info at  
http://vger.kernel.org/majordomo-info.html
Please read the FAQ at  
http://www.tux.org/lkml/