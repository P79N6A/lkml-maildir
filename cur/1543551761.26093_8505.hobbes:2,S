Date: Mon, 16 Oct 2000 21:29:06 +0200
From: Andries Brouwer <>
Subject: Re: BLKSSZGET change will break fdisk
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2000/10/16/141

On Mon, Oct 16, 2000 at 08:04:27PM +0200, Roman Zippel wrote:
> I noticed that behaviour of BLKSSZGET changed between 2.2 and 2.4. One of
> the users will be fdisk, as soon as it is compiled with 2.4 kernel
> headers, but then fdisk will be no longer usable under 2.2!
> My question now is, wouldn't it be better to use a new ioctl (like
> BLKHSSZGET) and keep the old behaviour of BLKSSZGET?
No, BLKSSZGET has only a single purpose, and it is right in 2.4
and wrong in 2.2. Maybe I should send Alan a BLKSSZGET patch.
We already agreed in email that it was wrong, but then
did not do anything about it.
Concerning fdisk, luckily you are mistaken - its source says
#if defined(BLKSSZGET) && defined(HAVE_blkpg_h)
so that it will not use the broken BLKSSZGET of 2.2.
[now that you make me look at this, there is a flaw in fdisk there;
fixed in 2.10p]
Andries
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.kernel.org
Please read the FAQ at 
http://www.tux.org/lkml/