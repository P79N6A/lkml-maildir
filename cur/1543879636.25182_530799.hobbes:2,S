Date: Sat, 14 Apr 2007 18:33:19 +0200
From: Matthias Andree <>
Subject: Re: [linux-usb-devel] 2.6.21-rc6 USB Keyboard hangs (EHCI/UHCI/HID)
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2007/4/14/85

On Mon, 09 Apr 2007, Alan Stern wrote:
> On Mon, 9 Apr 2007, Matthias Andree wrote:
> 
> > Please Cc: me on replies, as I read linux-kernel sporadically and am not
> > subscribed to linux-usb-devel at all.
> > 
> > Greetings,
> > 
> > I have seen my USB keyboard drivers lock up several times now with my M$
> > Natural Ergonomic Keyboard, both on SUSE 10.2's current kernel as well
> > as 2.6.21-rc6 today. I don't ever recall this happen with older SUSE
> > 10.0 kernels. The keyboard is connected to a USB2.0 hub with single
> > transaction translator (at least that's what FreeBSD 6.2 says), which is
> > connected to a via root hub.
> > 
> > Symptoms are that the keyboard LEDs go off and no further input is
> > impossible (I'm typing this into a PS/2 keyboard). Replugging does not
> > help. Trying to unload ehci-hcd hangs modprobe, and additionally I've
> > got a stuck khubd (not sure if that's related), else no logging.
> > 
> > I'm rebuilding the kernel with HID/USB debugging cranked up to see if I
> > can get some detail out of the situation. Any specific kernel debugging
> > options that might help me debug this further?
> 
> It would help to see a trace from usbmon showing what happens during a 
> lockup.  You can find the instructions in the kernel source file 
> Documentation/usb/usbmon.txt.
> 
> To help keep the trace simple, try to avoid plugging any other USB devices
> into that hub or any other high-speed USB devices into the computer.
> 
> Also, it might help to see a stack trace of khubd (Alt-SysRq-T) when it 
> gets stuck.
I arrived at the computer today, to find khubd in D state again, but
unfortunately, it does not show up in Alt-SysRq-T output. Do kernel
threads show up there at all? 2.6.18.8-0.1 with SUSE patches on openSUSE
10.2.
I had stopped usbmon before however, so I don't know what the events
have been leading to this lockup. Sorry. I'll leave usbmon running now.
-- 
Matthias Andree
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.kernel.org
More majordomo info at  
http://vger.kernel.org/majordomo-info.html
Please read the FAQ at  
http://www.tux.org/lkml/