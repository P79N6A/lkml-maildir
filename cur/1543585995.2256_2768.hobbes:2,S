Date: Tue, 27 Mar 2001 18:42:15 -0600
From: Jonathan McKinney <>
Subject: 2GB file limit ftp/scp Linux kernel 2.4.2 problem
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2001/3/27/150

[1.] One line summary of the problem:
ftp FROM 2.4.2 ix86 machine to system with true 64-bit or otherwise no 2GB limit
system complains that the file size is too large.
[2.] Full description of the problem/report:
On the 2.4.2 ix86 machine doing put:
-------------------------------------
UNIX Archive FTP server (UCFM Version (2.3)) active. Checking UniTree.conf
220 UNIX Archive FTP server ready.
334 Using authentication type GSSAPI; ADAT must follow
GSSAPI accepted as authentication type
GSSAPI authentication succeeded
Name (mss.ncsa.uiuc.edu:jon): jmckinne
232 Kerberos user jmckinne@NCSA.EDU is authorized as jmckinne
230 User jmckinne logged in.
Remote system type is UNIX.
Using binary mode to transfer files.
ftp> put tro240longpostproc.tgz
local: tro240longpostproc.tgz remote: tro240longpostproc.tgz
local: tro240longpostproc.tgz: File too large
ftp> quit
221 Goodbye.
On 64-bit machine doing a get:
---------------------
ftp> get  tro240longpostproc.tgz
local: tro240longpostproc.tgz remote: tro240longpostproc.tgz
200 PORT command successful.
550 tro240longpostproc.tgz: File too large.
Same message with scp or normal ftp program(i.e. non-Kerberos version).  Any GET
onto the ix86 2.4.2 kernel system is perfectly fine.  Any shell operation on the
>2GB file(upto 22GB at least) works fine.  Some programs(like midnight commander) don't like >2GB files, but that's normal.
NCSA uses 2.2.16 with a patch to break the 2GB limit and it works fine according
to NCSA.  I can PUT the large file using an Alpha 21264 system using an older
kernel just fine to the same system I tried uploading to using the ix86 2.4.2
system.
[3.] Keywords (i.e., modules, networking, kernel):
networking, file system.
[4.] Kernel version (from /proc/version):
Linux version 2.4.2 (root@metric.physics.uiuc.edu) (gcc version 2.96 20000731
(Red Hat Linux 7.0)) #1 Thu Mar 15 23:20:28 CST 2001 
[5.] Output of Oops.. message (if applicable) with symbolic information
     resolved (see Documentation/oops-tracing.txt)
N/A
[6.] A small shell script or example program which triggers the
     problem (if possible)
(just ftp to a normal 64-bit system(or known working sysytem) and PUT from an
ix86 system using 2.4.2)
[7.] Environment
RH7.0
[7.1.] Software (add the output of the ver_linux script here)
Looks like the script doesn't work or Redhat7.0 is broken, but nothing else
doesn't work.
Linux metric.physics.uiuc.edu 2.4.2 #1 Thu Mar 15 23:20:28 CST 2001 i686
unknownKernel modules         found
Gnu C                  2.96
Binutils               2.10.0.18
Linux C Library        ..
ldd: missing file arguments
Try `ldd --help' for more information.
ls: /usr/lib/libg++.so: No such file or directory
Procps                 2.0.7
Mount                  2.10m
Net-tools              (2000-05-21)
Kbd                    [option...]
Sh-utils               2.0
Sh-utils               Parker.
Sh-utils
Sh-utils               Inc.
Sh-utils               NO
Sh-utils               PURPOSE.  
  
[7.2.] Processor information (from /proc/cpuinfo):
[jon@metric jon]$ cat /proc/cpuinfo
processor       : 0
vendor_id       : GenuineIntel
cpu family      : 15
model           : 0
model name      : Intel(R) Pentium(R) 4 CPU 1400MHz
stepping        : 7
cpu MHz         : 1395.796
cache size      : 256 KB
fdiv_bug        : no
hlt_bug         : no
f00f_bug        : no
coma_bug        : no
fpu             : yes
fpu_exception   : yes
cpuid level     : 2
wp              : yes
flags           : fpu vme de pse tsc msr pae mce cx8 apic sep mtrr pge mca cmov
pat pse36 clflush dts acpi mmx fxsr sse sse2 ss tm
bogomips        : 2785.28 
[7.3.] Module information (from /proc/modules):
3c59x                  23488   1 (autoclean)
ide-scsi                8224   0       
[7.4.] Loaded driver and hardware information (/proc/ioports, /proc/iomem)
0000-001f : dma1
0020-003f : pic1
0040-005f : timer
0060-006f : keyboard
0070-007f : rtc
0080-008f : dma page reg
00a0-00bf : pic2
00c0-00df : dma2
00f0-00ff : fpu
0170-0177 : ide1
01f0-01f7 : ide0
0376-0376 : ide1
03c0-03df : vga+
03f6-03f6 : ide0
03f8-03ff : serial(auto)
0cf8-0cff : PCI conf1
d000-dfff : PCI Bus #02
  dc00-dc7f : 3Com Corporation 3c905C-TX [Fast Etherlink]
    dc00-dc7f : eth0
ef40-ef5f : Intel Corporation 82820 820 (Camino 2) Chipset USB (Hub A)
ef80-ef9f : Intel Corporation 82820 820 (Camino 2) Chipset USB (Hub B)
efa0-efaf : Intel Corporation 82820 820 (Camino 2) Chipset SMBus
ffa0-ffaf : Intel Corporation 82820 820 (Camino 2) Chipset IDE U100
  ffa0-ffa7 : ide0
  ffa8-ffaf : ide1     
00000000-0009fbff : System RAM
0009fc00-0009ffff : reserved
000a0000-000bffff : Video RAM area
000c0000-000c7fff : Video ROM
000cb000-000cb7ff : Extension ROM
000f0000-000fffff : System ROM
00100000-1ffbffff : System RAM
  00100000-00212233 : Kernel code
  00212234-00283777 : Kernel data
1ffc0000-1ffdffff : ACPI Tables
1ffe0000-1fff7fff : ACPI Tables
1fff8000-1fffffff : ACPI Non-volatile Storage
e4600000-f46fffff : PCI Bus #01
  e8000000-efffffff : nVidia Corporation GeForce 256 DDR
f4700000-f47fffff : PCI Bus #02
f8000000-fbffffff : Intel Corporation 82850 850 (Tehama) Chipset Host Bridge
(MCH)
fc900000-fe9fffff : PCI Bus #01
  fd000000-fdffffff : nVidia Corporation GeForce 256 DDR
fea00000-feafffff : PCI Bus #02
  feaffc00-feaffc7f : 3Com Corporation 3c905C-TX [Fast Etherlink]
fec00000-fec00fff : reserved
fee00000-fee00fff : reserved
ffb80000-ffbfffff : reserved
fff00000-ffffffff : reserved   
[7.5.] PCI information ('lspci -vvv' as root)
00:00.0 Host bridge: Intel Corporation: Unknown device 2530 (rev 02)
        Control: I/O- Mem+ BusMaster+ SpecCycle- MemWINV- VGASnoop- ParErr- Step
ping- SERR+ FastB2B-
        Status: Cap+ 66Mhz- UDF- FastB2B+ ParErr- DEVSEL=fast >TAbort-
<TAbort-<MAbort+ >SERR- <PERR-
        Latency: 0
        Region 0: Memory at f8000000 (32-bit, prefetchable) [size=64M]
        Capabilities: [a0] AGP version 2.0
                Status: RQ=31 SBA+ 64bit- FW+ Rate=x1,x2
                Command: RQ=0 SBA- AGP- 64bit- FW- Rate=<none>
00:01.0 PCI bridge: Intel Corporation: Unknown device 2532 (rev 02) (prog-if
00[Normal decode])
        Control: I/O+ Mem+ BusMaster+ SpecCycle- MemWINV- VGASnoop- ParErr- Step
ping- SERR+ FastB2B-
        Status: Cap- 66Mhz+ UDF- FastB2B+ ParErr- DEVSEL=fast >TAbort-
<TAbort-<MAbort- >SERR- <PERR-
        Latency: 32
        Bus: primary=00, secondary=01, subordinate=01, sec-latency=32
        I/O behind bridge: 0000f000-00000fff
        Memory behind bridge: fc900000-fe9fffff
        Prefetchable memory behind bridge: e4600000-f46fffff
        BridgeCtl: Parity- SERR+ NoISA- VGA+ MAbort- >Reset- FastB2B-
00:1e.0 PCI bridge: Intel Corporation: Unknown device 244e (rev 02) (prog-if
00[Normal decode])
        Control: I/O+ Mem+ BusMaster+ SpecCycle- MemWINV- VGASnoop- ParErr- Step
ping- SERR+ FastB2B-
        Status: Cap- 66Mhz- UDF- FastB2B+ ParErr- DEVSEL=fast >TAbort-
<TAbort-<MAbort- >SERR- <PERR-
        Latency: 0
        Bus: primary=00, secondary=02, subordinate=02, sec-latency=32
        I/O behind bridge: 0000d000-0000dfff
        Memory behind bridge: fea00000-feafffff
        Prefetchable memory behind bridge: f4700000-f47fffff
        BridgeCtl: Parity- SERR+ NoISA- VGA- MAbort- >Reset- FastB2B-
00:1f.0 ISA bridge: Intel Corporation: Unknown device 2440 (rev 02)
        Control: I/O+ Mem+ BusMaster+ SpecCycle+ MemWINV- VGASnoop- ParErr- Step
ping- SERR- FastB2B-
        Status: Cap- 66Mhz- UDF- FastB2B+ ParErr- DEVSEL=medium >TAbort- <TAbort
- <MAbort- >SERR- <PERR-
        Latency: 0
00:1f.1 IDE interface: Intel Corporation: Unknown device 244b (rev 02)
(prog-if80 [Master])
        Subsystem: Intel Corporation: Unknown device 4742
        Control: I/O+ Mem- BusMaster+ SpecCycle- MemWINV- VGASnoop- ParErr- Step
ping- SERR- FastB2B-
        Status: Cap- 66Mhz- UDF- FastB2B+ ParErr- DEVSEL=medium >TAbort- <TAbort
- <MAbort- >SERR- <PERR-
        Latency: 0
        Region 4: I/O ports at ffa0 [size=16]
00:1f.2 USB Controller: Intel Corporation: Unknown device 2442 (rev 02) (prog-if
 00 [UHCI])
        Subsystem: Intel Corporation: Unknown device 4742
        Control: I/O+ Mem- BusMaster+ SpecCycle- MemWINV- VGASnoop- ParErr- Step
ping- SERR- FastB2B-
        Status: Cap- 66Mhz- UDF- FastB2B+ ParErr- DEVSEL=medium >TAbort- <TAbort
- <MAbort- >SERR- <PERR-
        Latency: 0
        Interrupt: pin D routed to IRQ 5
        Region 4: I/O ports at ef40 [size=32]
00:1f.3 SMBus: Intel Corporation: Unknown device 2443 (rev 02)
        Subsystem: Intel Corporation: Unknown device 4742
        Control: I/O+ Mem- BusMaster- SpecCycle- MemWINV- VGASnoop- ParErr- Step
ping- SERR- FastB2B-
        Status: Cap- 66Mhz- UDF- FastB2B+ ParErr- DEVSEL=medium >TAbort- <TAbort
- <MAbort- >SERR- <PERR-
        Interrupt: pin B routed to IRQ 10
        Region 4: I/O ports at efa0 [size=16]
00:1f.4 USB Controller: Intel Corporation: Unknown device 2444 (rev 02) (prog-if
 00 [UHCI])
        Subsystem: Intel Corporation: Unknown device 4742
        Control: I/O+ Mem- BusMaster+ SpecCycle- MemWINV- VGASnoop- ParErr- Step
ping- SERR- FastB2B-
        Status: Cap- 66Mhz- UDF- FastB2B+ ParErr- DEVSEL=medium >TAbort- <TAbort
- <MAbort- >SERR- <PERR-
        Latency: 0
        Interrupt: pin C routed to IRQ 9
        Region 4: I/O ports at ef80 [size=32]
01:00.0 VGA compatible controller: nVidia Corporation GeForce 256 DDR (rev 10) (
                Status: RQ=31 SBA- 64bit- FW+ Rate=x1,x2
                Command: RQ=0 SBA- AGP- 64bit- FW- Rate=<none>
 
02:0a.0 Ethernet controller: 3Com Corporation 3c905C-TX [Fast Etherlink] (rev
74)
        Subsystem: 3Com Corporation 3C905C-TX Fast Etherlink for PC Management
NIC
        Control: I/O+ Mem+ BusMaster+ SpecCycle- MemWINV+ VGASnoop- ParErr-
Stepping- SERR+ FastB2B-
        Status: Cap+ 66Mhz- UDF- FastB2B- ParErr- DEVSEL=medium >TAbort-
<TAbort- <MAbort- >SERR- <PERR-
        Latency: 32 (2500ns min, 2500ns max), cache line size 04
        Interrupt: pin A routed to IRQ 3
        Region 0: I/O ports at dc00 [size=128]
        Region 1: Memory at feaffc00 (32-bit, non-prefetchable) [size=128]
        Expansion ROM at feac0000 [disabled] [size=128K]
        Capabilities: [dc] Power Management version 2
                Flags: PMEClk- DSI- D1+ D2+ AuxCurrent=0mA
PME(D0+,D1+,D2+,D3hot+,D3cold+)
                Status: D0 PME-Enable- DSel=0 DScale=2 PME-     
[7.6.] SCSI information (from /proc/scsi/scsi)
Attached devices: none 
[7.7.] Other information that might be relevant to the problem
       (please look in /proc and include all information that you
       think to be relevant):
NA
[X.] Other notes, patches, fixes, workarounds:     
I am using my alpha21264 system to upload OFF the same disk with that large file
via NFS on the ix86 2.4.2 kernel system.
Thanks,
Jonathan McKinney
University of Illinois
Dept. of Physics
Center for Theoretical Astrophysics
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.kernel.org
More majordomo info at  
http://vger.kernel.org/majordomo-info.html
Please read the FAQ at  
http://www.tux.org/lkml/