Date: Mon, 24 Apr 2006 17:20:38 -0400
From: Alan Cox <>
Subject: Re: better leve triggered IRQ management needed
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2006/4/24/281

On Mon, Apr 24, 2006 at 02:07:01PM -0700, Linus Torvalds wrote:
> debugging standpoint. So even if it's just that every registered SA_SHIRQ 
> would get a heartbeat at least once every five seconds (and we'd limit it 
> to SA_SHIRQ exactly because a driver that doesn't have that set may get 
> confused if it gets extra interrupts), that might sound totally useless, 
> but it might actually help somebody who otherwise might just make a pretty
> useless "the machine hung" bug-report.
Have to watch enable/disable_irq and the other races here.
> The fake interrupt could even print out a warning if somebody returns 
> SA_HANDLED (since normally there _shouldn't_ have been any work to handle 
> for it), and if that means that for somebody, things go from "the machine 
> hung" to "the machine got very slow, and printed out 'fake interrupt for 
> ide0 returned SA_HANDLED!'", that would potentially be a big debug aid.
There are high rate IRQ sources that would trigger that erratically due to
races but it could be useful in some kind of "linux irqdebug" mode
> We've had our ass saved quite a few times now by the irq storm detector 
> ("irq X: nobody cared" and friends), which has helped debug irqs that 
> haven't been set up properly, that I'm convinced things like this might 
> well make a huge deal.
Yep
Alan
--
  "... and for $64000 question, could you get yourself vaguely familiar with
		the notion of on-topic posting?"
				-- Al Viro
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.kernel.org
More majordomo info at  
http://vger.kernel.org/majordomo-info.html
Please read the FAQ at  
http://www.tux.org/lkml/