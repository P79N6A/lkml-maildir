Date: Thu, 13 May 2004 12:14:57 -0700
From: "Martin J. Bligh" <>
Subject: 2.6.6-mm2
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2004/5/13/181

2.6.6-mm2 won't compile without CONFIG_MODULE_UNLOAD ... looks very much
like the first definition of add_attribute needs moving inside the ifdef.
kernel/module.c:730: redefinition of `add_attribute'
kernel/module.c:382: `add_attribute' previously defined here
{standard input}: Assembler messages:
{standard input}:1121: Error: symbol `add_attribute' is already defined
# grep MODULE .config
CONFIG_MODULES=y
# CONFIG_MODULE_UNLOAD is not set
--- 2.6.6-mm2/kernel/module.c.old	2004-05-13 11:08:39.000000000 -0700
+++ 2.6.6-mm2/kernel/module.c	2004-05-13 11:13:50.000000000 -0700
@@ -378,6 +378,7 @@
 }
 #endif /* CONFIG_SMP */
 
+#ifdef CONFIG_MODULE_UNLOAD
 static int add_attribute(struct module *mod, struct kernel_param *kp)
 {
 	struct module_attribute *a;
@@ -394,7 +395,6 @@
 	return retval;
 }
 
-#ifdef CONFIG_MODULE_UNLOAD
 /* Init the unload section of the module. */
 static void module_unload_init(struct module *mod)
 {
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.kernel.org
More majordomo info at  
http://vger.kernel.org/majordomo-info.html
Please read the FAQ at  
http://www.tux.org/lkml/