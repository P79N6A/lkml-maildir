Date: Thu, 21 Feb 2002 20:50:08 -0600
From: Tom Gall <>
Subject: bug(?): SET_PERSONALITY 2.4.18-rc3
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2002/2/21/262

Greetings,
While getting 2.4.18-rc[1|2] up and running on ppc64 the following bug
surfaced. Least I think it's a bug. You be the judge. If it's not, we'd
kinda like to know why not.
in fs/binfmt_elf.c I believe the following patch appears to be needed
------8<----------8<--------------------
diff -urN linuxppc64_2_4.bld-rc.borked/fs/binfmt_elf.c
linuxppc64_2_4.bld-rc/fs/binfmt_elf.c
--- linuxppc64_2_4.bld-rc.borked/fs/binfmt_elf.c        Wed Feb 20
13:32:56 2002
+++ linuxppc64_2_4.bld-rc/fs/binfmt_elf.c       Thu Feb 21 17:27:04 2002
@@ -568,6 +565,9 @@
			// printk(KERN_WARNING "ELF: Ambiguous type, using ELF\n");
			interpreter_type = INTERPRETER_ELF;
		}
+	} else {
+		/* Executables without an interpreter also need a personality  */
+		SET_PERSONALITY(elf_ex, ibcs2_interpreter);
	}
	/* OK, we are done with that, now set up the arg stuff,
----8<-------------8<------------------
otherwise a static application would be run without SET_PERSONALITY
being called, which On ppc64, very quickly leads to a bad day.
Regards,
Tom
-- 
Tom Gall - [embedded] [PPC64 | PPC32] Code Monkey
Peace, Love &                  "Where's the ka-boom? There was
Linux Technology Center         supposed to be an earth
http://www.ibm.com/linux/ltc/
   shattering ka-boom!"
(w) tom_gall@vnet.ibm.com       -- Marvin Martian
(w) 507-253-4558
(h) tgall@rochcivictheatre.org
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.kernel.org
More majordomo info at  
http://vger.kernel.org/majordomo-info.html
Please read the FAQ at  
http://www.tux.org/lkml/