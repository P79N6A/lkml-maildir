Date: Mon, 10 Jul 2006 01:59:44 +0200
From: Andi Kleen <>
Subject: Re: [patch] i386: use thread_info flags for debug regs and IO  bitmaps
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2006/7/9/247

On Saturday 08 July 2006 23:26, Linus Torvalds wrote:
> 
> On Fri, 7 Jul 2006, Chuck Ebbert wrote:
> >
> > From: Stephane Eranian <eranian@hpl.hp.com>
> > 
> > Use thread info flags to track use of debug registers and IO bitmaps.
> > 
> > 	- add TIF_DEBUG to track when debug registers are active
> >  	- add TIF_IO_BITMAP to track when I/O bitmap is used
> >  	- modify __switch_to() to use the new TIF flags
> 
> Can you explain what the advantages of this are?
> 
> I don't see it. It's just creating new state to describe state that we 
> already had, and as far as I can tell, it's just a way to potentially have 
> more new bugs thanks to the new state getting out of sync with the old 
> one?
It turns two checks in context switch into a single one. With some luck
it will even touch one cache line less.
I requested this for x86-64 because Stephane wants to add more state to check
(performance counters) in there for his perfmon2 patches, and with that 
infrastructure in place it can be added without adding more cost for the 
common case.
Chuck ported the x86-64 version to i386.
-Andi
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.kernel.org
More majordomo info at  
http://vger.kernel.org/majordomo-info.html
Please read the FAQ at  
http://www.tux.org/lkml/