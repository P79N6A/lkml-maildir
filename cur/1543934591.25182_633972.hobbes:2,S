Date: Thu, 3 Jan 2008 18:02:18 +0100
From: Jesper Nilsson <>
Subject: Re: [PATCH] arch/cris/arch-v10/vmlinux.lds.S fix boot problem
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2008/1/3/227

On Sat, Dec 22, 2007 at 09:37:17AM +0100, Sam Ravnborg wrote:
> Hi Jesper.
> 
> >  		__initramfs_end = .;
> > -		/* We fill to the next page, so we can discard all init
> > -		   pages without needing to consider what payload might be
> > -		   appended to the kernel image.  */
> > -		FILL (0); 
> > -		. = ALIGN (8192);
> >  	}
> >  #endif
> > -	
> >  	__vmlinux_end = .;            /* last address of the physical file */
> > -  	__init_end = .;
> > +
> > +	/*
> > +	 * We fill to the next page, so we can discard all init
> > +	 * pages without needing to consider what payload might be
> > +	 * appended to the kernel image.
> > +	 */
> > +	.init.fill : {
> > +		FILL (0);
> > +		. = ALIGN (8192);
> > +	}
> > +
> > +	__init_end = .;
> 
> Can we please have the hardcoded 8192 replaced with a proper constant.
> I assume this is PAGESIZE?
Yes, quite so.
> See hwat other archs does to make PAGESIZE available for assembly
> files and ldscripts. The macro AC is the key point here.
Ok, will do.
> And then please explain why it make a diffrence to put the
> alignment in a section like you do.
> I do not see it used in the other archs.
I'm not an expert on ld-scripts, so I only know that the linker didn't
respect the other way of doing the alignment, but did when added in a
section.
Perhaps Mikael has a better explanation when he's back from vacation.
> 	Sam
Best regards,
/^JN - Jesper Nilsson
--
               Jesper Nilsson -- jesper.nilsson@axis.com