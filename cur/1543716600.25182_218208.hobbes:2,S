Date: Tue, 4 May 2004 13:45:02 +0100 (BST)
From: Hugh Dickins <>
Subject: Re: Slab cache seems to grow forever - 2.6.6-rc3-mm1
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2004/5/4/65

On Tue, 4 May 2004, Brent Cook wrote:
> 
> This might be related to the change in fs-writeback.c that fixed
> redirtying inodes on NFS, but I'm not sure. It seems that the Slab cache
> never shrinks. Could this be a memory leak? It definitely affects system
> performance. Here are the numbers after running for about 12 hours with
> heavy NFS traffic (this is the client).
Please apply the patch akpm posted on Saturday:
2.6.6-rc3-mm1 is totally broken in the slab-shrinking area (sorry).
--- 25/mm/vmscan.c~shrink_slab-handle-GFP_NOFS-fix	2004-05-01 14:34:25.446391008 -0700
+++ 25-akpm/mm/vmscan.c	2004-05-01 14:34:37.424570048 -0700
@@ -156,7 +156,7 @@ static int shrink_slab(unsigned long sca
 			shrinker->nr = LONG_MAX;	/* It wrapped! */
 
 		if (shrinker->nr <= SHRINK_BATCH)
-			break;
+			continue;
 		while (shrinker->nr) {
 			long this_scan = shrinker->nr;
 			int shrink_ret;
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.kernel.org
More majordomo info at  
http://vger.kernel.org/majordomo-info.html
Please read the FAQ at  
http://www.tux.org/lkml/