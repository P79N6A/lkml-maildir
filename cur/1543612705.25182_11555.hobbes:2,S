Date: Sat, 08 Dec 2001 13:47:19 -0600
From: Ishan Oshadi Jayawardena <>
Subject: Re: IDE-DMA woes
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2001/12/8/40

Mark Hahn wrote:
> > _sometimes_ I get the following message from the kernel
> > after resuming from APM standby mode:
> 
> right, no big surprise there - the bios fails to properly
> restore the ide controller's state.
	Hmmm... I had had some trouble with the BIOS previously;
Specifically, the machine would hang whenever I wanted it to
power-off _or_ reboot (kernel 2.2.16 - 2.2.14 probably had a workaround
which later got dropped). But a BIOS upgrade from IBM fixed that and
some other irrelevent problems; The documentation with the flash didn't
mention anything about DMA (specifically - it may have been hidden in
some fixes said to be necessary for WinNT 5 beta).
> > ide_dmaproc: chipset supported ide_dma_timeout func only: 14
> 
> are you sure this happens near in time to the following?
Yes. and this too:
hda: timeout waiting for DMA
	Just before the message from ide_dmaproc()
> > hda: drive not ready for command
> 
> that's not good.
What does this mean?
> > IBM machine detected. Enabling interrupts during APM calls.
> 
> have you tried without this feature?
Not exactly; Some docs I found at the IBM site recommended the user
to configure the kernel to:
(1) Enable APM
(2) Enable PM at boot-time
(3) Enable interrupts during APM BIOS calls.
	It seems that 2.4 kernels detects this and enables interrupts
automatically... I've yet to see what would break if I enable
apm_idled...
Thanks.
		-ioj
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.kernel.org
More majordomo info at  
http://vger.kernel.org/majordomo-info.html
Please read the FAQ at  
http://www.tux.org/lkml/