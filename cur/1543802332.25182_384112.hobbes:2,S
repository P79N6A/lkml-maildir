Date: Tue, 10 Jan 2006 09:06:37 +0100
From: Patrizio Bassi <>
Subject: [BUG 2.6.15-git5] new alsa power management completly broken
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2006/1/10/33

With 2.6.15: suspend works but on resume mixer volumes are not restored
(registers not saved), so you need to restart your alsa script.
boring but working.
with 2.6.15-git5 i saw a new power management part. lt's test it:
suspending...
Jan 10 08:44:51 blight kernel: Stopping tasks: ===================|
Jan 10 08:44:51 blight kernel: Shrinking memory...  ^H-^Hdone (0 pages
freed)
Jan 10 08:44:51 blight kernel: pnp: Device 00:0b disabled.
Jan 10 08:44:51 blight kernel: pnp: Device 00:07 disabled.
Jan 10 08:44:51 blight kernel: ACPI: PCI interrupt for device
0000:00:0b.0 disabled
Jan 10 08:44:51 blight kernel: ACPI: PCI interrupt for device
0000:00:0a.2 disabled
Jan 10 08:44:51 blight kernel: ACPI: PCI interrupt for device
0000:00:0a.1 disabled
Jan 10 08:44:51 blight kernel: ACPI: PCI interrupt for device
0000:00:0a.0 disabled
Jan 10 08:44:51 blight kernel: ACPI: PCI interrupt for device
0000:00:09.0 disabled
Jan 10 08:44:51 blight kernel: ACPI: PCI interrupt for device
0000:00:04.2 disabled
Jan 10 08:44:51 blight kernel: swsusp: Need to copy 15888 pages
Jan 10 08:44:51 blight kernel: ACPI: PCI Interrupt 0000:00:04.2[D] ->
Link [LNKD] -> GSI 9 (level, low) -> IRQ 9
Jan 10 08:44:51 blight kernel: ACPI: PCI Interrupt 0000:00:09.0[A] ->
Link [LNKD] -> GSI 9 (level, low) -> IRQ 9
Jan 10 08:44:51 blight kernel: ACPI: PCI Interrupt 0000:00:09.0[A] ->
Link [LNKD] -> GSI 9 (level, low) -> IRQ 9
Jan 10 08:44:51 blight kernel: ACPI: PCI Interrupt 0000:00:0a.0[A] ->
Link [LNKC] -> GSI 5 (level, low) -> IRQ 5
Jan 10 08:44:51 blight kernel: ACPI: PCI Interrupt 0000:00:0a.1[B] ->
Link [LNKD] -> GSI 9 (level, low) -> IRQ 9
Jan 10 08:44:51 blight kernel: ACPI: PCI Interrupt 0000:00:0a.2[C] ->
Link [LNKA] -> GSI 11 (level, low) -> IRQ 11
Jan 10 08:44:51 blight kernel: usb usb1: root hub lost power or was reset
Jan 10 08:44:51 blight kernel: ehci_hcd 0000:00:0a.2: USB 2.0 started,
EHCI 0.95, driver 10 Dec 2004
Jan 10 08:44:51 blight kernel: ACPI: PCI Interrupt 0000:00:0b.0[A] ->
Link [LNKB] -> GSI 10 (level, low) -> IRQ 10
Jan 10 08:44:51 blight kernel: codec write timeout, status = 0x660
Jan 10 08:44:51 blight last message repeated 25 times
25 times....about half on suspending and about half on restarting.
now restarting..
Jan 10 08:44:51 blight kernel: pnp: Device 00:07 activated.
Jan 10 08:44:51 blight kernel: pnp: Failed to activate device 00:0a.
Jan 10 08:44:51 blight kernel: pnp: Device 00:0b activated.
Jan 10 08:44:51 blight kernel: Restarting tasks... done
device can't play any sound, as before. so i tried the usual solution
(restart the alsasound script in gentoo)
Jan 10 08:45:45 blight rc-scripts: WARNING:  you are stopping a boot
service.
Jan 10 08:45:47 blight kernel: codec write timeout, status = 0x660
Jan 10 08:46:33 blight last message repeated 64 times
Jan 10 08:46:57 blight last message repeated 199 times
as you can see it flood the syslog with 0x660 errors.
infact if i try to adjust the volume via alsamixer the volume level
moves soooo slow (it's flooding syslog)
so actually power resume is completly broken. the only way is restarting
the kernel via a reboot (built-in alsa).
Audio card: Creative Sound Blaster PCI 128
00:0b.0 Multimedia audio controller: Ensoniq ES1370 [AudioPCI] (rev 01)
Ready to test patches.
Thanks.
--
Patrizio Bassi
www.patriziobassi.it
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.kernel.org
More majordomo info at  
http://vger.kernel.org/majordomo-info.html
Please read the FAQ at  
http://www.tux.org/lkml/