Date: Thu, 14 Aug 2003 16:23:28 +0200 (CEST)
From: Oliver Tennert <>
Subject: [PATCH] 2.6 kbuild config logic and initrd
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2003/8/14/77

This is a patch remedying the problem stated below.
On Thu, 14 Aug 2003, Oliver Tennert wrote:
>
> Hello,
>
> While trying to use initrds with the 2.6.0-test3 kernel,
> I found out that ramdisk support (CONFIG_BLK_DEV_RAM) is allowed to be
> modular, while at the same time initrd support (CONFIG_BLK_DEV_INITRD) can be
> compiled into the kernel:
>
> CONFIG_BLK_DEV_RAM=m
> CONFIG_BLK_DEV_INITRD=y
>
> This does not make sense, however, as no initial ramdisk can be loaded
> while the generic ramdisk driver is outside the static kernel part!
>
> Consequently, I promptly fell for it, though I agree that it should have
> come to my mind before actually compiling the kernel!
>
> In 2.4 kernels, the configuration logic does not allow that.
>
>
> Regards
>
> Oliver
>
>
> --
> ________________________________________creating IT solutions
>
> Dr. Oliver Tennert			science + computing ag
> phone   +49(0)7071 9457-598		Hagellocher Weg 71-75
> fax     +49(0)7071 9457-411		D-72070 Tuebingen, Germany
> O.Tennert@science-computing.de		www.science-computing.de
>
>
>
>
--
________________________________________creating IT solutions
Dr. Oliver Tennert			science + computing ag
phone   +49(0)7071 9457-598		Hagellocher Weg 71-75
fax     +49(0)7071 9457-411		D-72070 Tuebingen, Germany
O.Tennert@science-computing.de		www.science-computing.de
--- drivers/block/Kconfig.old	Sat Aug  9 06:33:53 2003
+++ drivers/block/Kconfig	Thu Aug 14 16:20:46 2003
@@ -331,6 +331,7 @@
 
 config BLK_DEV_INITRD
 	bool "Initial RAM disk (initrd) support"
+	depends on BLK_DEV_RAM=y
 	help
 	  The initial RAM disk is a RAM disk that is loaded by the boot loader
 	  (loadlin or lilo) and that is mounted as root before the normal boot