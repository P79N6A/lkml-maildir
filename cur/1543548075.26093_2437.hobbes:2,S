Date: Thu, 7 Sep 2000 14:03:46 -0400 (EDT)
From: Ricky Beam <>
Subject: Re: modules_install?
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2000/9/7/166

On Thu, 7 Sep 2000, Michael Elizabeth Chastain wrote:
>(1) Rules.make had a load of ugly code to translate from the source tree
>    to the symlink farm.  This code had plenty of bugs and race conditions
>    (e.g. if two subdirectories have the same MOD_LIST_NAME and make
>    runs in parallel).
>
>(2) The top Makefile had a butt-load of even uglier code to translate
>    from the symlink farm to the install tree.  This code needed to
>    be coordinated with modutils releases.  It also suffered from bugs,
>    such as configuration changes leaving stale files around.
Well, there's butt-loads of ugly Makefile shit all over the place.  It
isn't going away.  I'll agree the symlink farm was a bad idea.  However,
the mass of one file per directory crap is no better an idea.
>(3) Module names had to be unique across the entire kernel tree,
>    which is a silly limitation.
Yes and no.  You can only insmod _one_ serial.o so the name does have
to be unique at the time it's loaded.  This is the "serial.o" vs.
"usb serial.o" problem.  If you need both modules loaded at the same
time then they still have to be unique.
>So now, the module installation code is simple and correct and doesn't
>need to be updated in tandem with modutils every two weeks.
WRONG.  The current system will be slinging directories left and right.
If someone doesn't tell modutils about them, then it doesn't work.  There's
already been heated arguements about the modutils scaling the directory
tree in search of modules.  It was generally conceeded to be a bad idea.
(BTW, the current modutils (2.3.15) won't see all the modules from a
 modules_install.)
From an efficiency standpoint, one file per directory is a hideous waste
of both filesystem space (one inode and one block) and system resources
(file access times, dcache, et. al.)
--Ricky
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.kernel.org
Please read the FAQ at 
http://www.tux.org/lkml/