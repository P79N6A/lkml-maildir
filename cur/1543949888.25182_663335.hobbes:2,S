Date: Tue, 04 Mar 2008 09:05:37 -0800
From: "H. Peter Anvin" <>
Subject: Re: [PATCH] reserve end-of-conventional-memory to 1MB on 32-bit v2
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2008/3/4/295

Alexander van Heukelum wrote:
> 
> If this is indeed not executed, is there a way to detect whether
> we can expect the environment to behave like a normal pc in terms
> of magic addresses, bios areas, isa reserved address space and so
> on?
> 
The subarch stuff (boot_params.hdr.hardware_subarch) is indeed executed, 
at least with newer PV guests.
However, as far as this kind of stuff, one really have to wonder to what 
extent the PV users really care about how much they perturb the guests. 
  The canonical view of virtualization is that you should perturb your 
guests as little as possible, but that doesn't really seem to be 
considered in the observable bits of the PV universe as far as I can tell.
A *massive* issue with hooks -- including paravirt_ops -- is that they 
are largely undocumented both in code and in specification, and usually 
hard-code the underlying implemenentation at a specific point in time: I 
have yet to see any sort of specification document for paravirt_ops, and 
most of the hooks are simply empty on hardware.  This means that the 
burden has shifted onto the kernel maintainers to test every possible 
paravirt_ops client, because it is quite literally the only way to know 
when it's broken.
I'm starting to feel that the PV clients need to document their 
environments and their constraints better for the benefit of the core 
maintainers.
	-hpa