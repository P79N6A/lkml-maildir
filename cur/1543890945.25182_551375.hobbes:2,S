Date: Thu, 31 May 2007 08:53:07 +0200
From: Cornelia Huck <>
Subject: Re: [patch] Introduce CONFIG_HAS_DMA.
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2007/5/31/45

On Wed, 30 May 2007 14:40:02 -0700,
"Williams, Dan J" <dan.j.williams@intel.com> wrote:
> With the patch non-dma-architectures that try to build code with true
> dependencies on the DMA api will fail to link i.e.:
> 
> CONFIG_DMA_ENGINE=y CONFIG_HAS_DMA=n ASYNC_MEMCPY=y
>   CC      init/version.o
>   LD      init/built-in.o
>   LD      .tmp_vmlinux1
> async_tx/built-in.o: In function `async_memcpy':
> xor.c:(.text+0x770): undefined reference to `dma_map_page'
> xor.c:(.text+0x798): undefined reference to `dma_map_page'
> xor.c:(.text+0x968): undefined reference to `dma_map_page'
> 
> Now changing CONFIG_DMA_ENGINE to depend on HAS_DMA (which is more
> correct than saying !S390). 
Makes sense.
> Results in:
> CONFIG_DMA_ENGINE=n CONFIG_HAS_DMA=n ASYNC_MEMCPY=y
>   CC      init/version.o
>   LD      init/built-in.o
>   LD      .tmp_vmlinux1
>   KSYM    .tmp_kallsyms1.S
>   AS      .tmp_kallsyms1.o
>   LD      .tmp_vmlinux2
>   KSYM    .tmp_kallsyms2.S
>   AS      .tmp_kallsyms2.o
>   LD      vmlinux
> 
> This also allows include/asm-s390/dma-mapping.h to be dropped.
Cool. Thanks for looking into that.
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.kernel.org
More majordomo info at  
http://vger.kernel.org/majordomo-info.html
Please read the FAQ at  
http://www.tux.org/lkml/