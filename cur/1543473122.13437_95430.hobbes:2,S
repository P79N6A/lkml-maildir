Date: Sun, 27 Dec 1998 16:47:47 +0000 (GMT)
From: (Alan Cox)
Subject: Re: scary ext2 filesystem question
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/1998/12/27/32

> Request 1: <write new data block>, depends on <>
> Request 2: <write new indirect block> or <add a pointer to existing one>,
> 	depends on <1>
> Request 3: <update inode block>, depends on <2>.
> 	In the worst case it will give us lost block, not attached to
> anything. BFD.
> 	With the current ext2 + bdflush we can get _any_ order at all,
> AFAI can see.
Thats the optimal case for ordering and its not materially any better than
no ordering except it avoids the 'garbage datablock' case. ext2 almost always
in the order given anyway. To actually improve on that situatio you must
be able to atomically commit an entire change, or a record of such a change
(hence Journalling).
The update ordering case is more complicated than it seems too. The harder
cases kick in when higher order metadata is also involved - eg if you need
to commit the directory entry you update before the file  because your fsck
is to primitive to recover any other way (eg V7/Minix/...). 
Alan
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.rutgers.edu
Please read the FAQ at 
http://www.tux.org/lkml/