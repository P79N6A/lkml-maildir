Date: Mon, 18 Feb 2008 11:18:48 -0800
From: Roland Dreier <>
Subject: Re: Unable to continue testing of 2.6.25
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2008/2/18/390

 > > AFAIK mapping PCI memory WB is not allowed, so WC is really our only
 > > choice.
 > afaik that depends on the BAR being prefetchable or not.
In my case the BAR is prefetchable.
 > (and by your argument, ioremap_cached() would not be useful, and since that was, until
 > 2.6.25-rc1, the default behavior for ioremap(), would have caused massive problems)
I'm not sure what ioremap_cached() would really do in my case, since
the MTRRs for PCI memory are set to UC, so without monkeying with MTRR
contents (which can't really be done safely) the only choices we have
are leaving the mapping as UC or using PAT to get WC.
Also in my case I'm more concerned about latency of finishing a small
write rather than througput.  So I'm not sure that I would really want
to do a write to a WB mapping followed by CLFLUSH anyway.
 - R.