Date: Tue, 11 May 2004 17:58:27 +0200
From: Jörn Engel <>
Subject: Re: [ANNOUNCEMENT PATCH COW] proof of concept impementation of cowlinks
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2004/5/11/140

On Tue, 11 May 2004 10:40:49 -0500, Steve French wrote:
> 
> It would not be helpful to take a userspace request to perform a file
> (or directory) copy operation and break it into open/sendfile/close by
> passing file handles to the network filesystem and have this work for
> SMB/CIFS - there is no equivalent network protocol operation.  It also
> makes the operation much, much harder to make atomic (since two systems
> are involved) and makes error handling and recovery for network
> filesystems much harder since inconsistent client and server state have
> to be considered if the copy operation is broken into pieces on the
> clien (it is also slower - a single copy operation on the network is the
> absolute optimal case - minimizes the expensive network latency - the
> roundtrip delay - open/sendfile/close sends at a minimum three times as
> many but likely four with an extra lookup or two)
> 
> Currently copy file (or copy directory for that matter) as both speced
> (and is implemented in various servers) in the SMB/CIFS network
> filesystem protocol takes in effect four parameters (there is no handle
> based file copy):
> 
> a source pathname,  and source export (actually SMB tree identifier for
> a share, but in effect the same thing) 
> a target pathname, and target export (actually SMB tree identifier for a
> share, but in effect the same thing) 
> And the shares (exports) referenced have to be on the same server
Or in short, copyfile makes sense for smbfs/cifs.  The question
whether my hack can be cleaned up enough to get past Al Viro is still
open, though. :)
Jörn
-- 
Homo Sapiens is a goal, not a description.
-- unknown
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.kernel.org
More majordomo info at  
http://vger.kernel.org/majordomo-info.html
Please read the FAQ at  
http://www.tux.org/lkml/