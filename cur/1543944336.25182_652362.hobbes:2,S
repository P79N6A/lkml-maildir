Date: Tue, 12 Feb 2008 21:01:41 +0100
From: Sam Ravnborg <>
Subject: Re: [PATCH] kbuild: fix make V=1
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2008/2/12/375

On Tue, Feb 12, 2008 at 10:25:04AM +0100, Oleg Verych wrote:
> On Tue, Feb 12, 2008 at 09:56:05AM +0100, Sam Ravnborg wrote:
> > On Tue, Feb 12, 2008 at 12:38:24AM +0100, Oleg Verych wrote:
> > > * Date: Mon, 11 Feb 2008 17:47:09 +0100
> > > []
> > > > Mike spotted another missing thing from his initial
> > > > patch so I folded it into the fix and pushed out
> > > > a new kbuild.git tree.
> > > >
> > > > See updated patch below.
> > > >
> > > > 	Sam
> > > 
> > > Sam, do you agree my fix was more reliable (yea, not only efficient:)?
> > You more or less just reverted the original patch - so it was obviously
> > more reliable than introducing new stuff as the fix did.
> > But we are at -r1 so I prefer to get the inteded behaviour
> > and not the minmal fix.
> 
> Processing below changes arguments, not semantics of generated shell
> code. And IMHO this is more reliable way of doing things. If one really
> wants silence without commonly accepted ">/dev/null 2>&1" practice, then
> choose portable "-n" argument for `echo`.
> 
> - quiet_chk_filechk = echo '  CHK     $@'
> -silent_chk_filechk = :
> - quiet_upd_filechk = echo '  UPD     $@'
> -silent_upd_filechk = :
> +quiet_chk_filechk = '  CHK     $@'
> +quiet_upd_filechk = '  UPD     $@'
> +
>  define filechk
>  	$(Q)set -e;				\
> -	$($(quiet)chk_filechk);			\
> +	echo $($(quiet)chk_filechk);		\
The way we do this in other places in kbuild is a simple:
$(if $($(quiet)chk_filechk),echo '  $($(quiet)chk_filechk)'
And I think we should have done so originally here.
	Sam