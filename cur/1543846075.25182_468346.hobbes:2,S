Date: Sun, 1 Oct 2006 13:36:56 +0200 (CEST)
From: Esben Nielsen <>
Subject: [patch 2/5] Fix timeout bug in rtmutex in 2.6.18-rt
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2006/10/1/52

A minor update to the rt-mutex tester framework.
  scripts/rt-tester/reset-tester.py            |   18 ++++++++++++++++++
  scripts/rt-tester/t2-l1-signal.tst           |    3 +++
  scripts/rt-tester/t3-l1-pi-signal.tst        |    3 ++-
  scripts/rt-tester/t4-l2-pi-deboost.tst       |    2 ++
  scripts/rt-tester/t5-l4-pi-boost-deboost.tst |    2 ++
  5 files changed, 27 insertions(+), 1 deletion(-)
Index: linux-2.6.18-rt/scripts/rt-tester/reset-tester.py
===================================================================
--- /dev/null
+++ linux-2.6.18-rt/scripts/rt-tester/reset-tester.py
@@ -0,0 +1,18 @@
+#!/usr/bin/env python
+
+sysfsprefix = "/sys/devices/system/rttest/rttest"
+statusfile = "/status"
+commandfile = "/command"
+
+for i in range(0,8):
+    cmdstr = "%s:%s" %("99", "0")
+    fname = "%s%d%s" %(sysfsprefix, i, commandfile)
+
+    try:
+        fcmd = open(fname, 'w')
+        fcmd.write(cmdstr)
+        fcmd.close()
+    except Exception,ex:
+        print i
+        print ex
+
Index: linux-2.6.18-rt/scripts/rt-tester/t2-l1-signal.tst
===================================================================
--- linux-2.6.18-rt.orig/scripts/rt-tester/t2-l1-signal.tst
+++ linux-2.6.18-rt/scripts/rt-tester/t2-l1-signal.tst
@@ -75,3 +75,6 @@ T: opcodeeq:		1:	-4
  # Unlock and exit
  C: unlock:		0: 	0
  W: unlocked:		0: 	0
+
+# Reset the -4 opcode from the signal
+C: reset:               1:      0
\ No newline at end of file
Index: linux-2.6.18-rt/scripts/rt-tester/t3-l1-pi-signal.tst
===================================================================
--- linux-2.6.18-rt.orig/scripts/rt-tester/t3-l1-pi-signal.tst
+++ linux-2.6.18-rt/scripts/rt-tester/t3-l1-pi-signal.tst
@@ -95,4 +95,5 @@ C: unlock:		1: 	0
  W: unlocked:		1: 	0
-
+# Reset the -4 opcode from the signal
+C: reset:               2:      0
\ No newline at end of file
Index: linux-2.6.18-rt/scripts/rt-tester/t4-l2-pi-deboost.tst
===================================================================
--- linux-2.6.18-rt.orig/scripts/rt-tester/t4-l2-pi-deboost.tst
+++ linux-2.6.18-rt/scripts/rt-tester/t4-l2-pi-deboost.tst
@@ -121,3 +121,5 @@ W: unlocked:		2:	1
  C: unlock:		0:	0
  W: unlocked:		0:	0
+# Reset the -4 opcode from the signal
+C: reset:               3:      0
\ No newline at end of file
Index: linux-2.6.18-rt/scripts/rt-tester/t5-l4-pi-boost-deboost.tst
===================================================================
--- linux-2.6.18-rt.orig/scripts/rt-tester/t5-l4-pi-boost-deboost.tst
+++ linux-2.6.18-rt/scripts/rt-tester/t5-l4-pi-boost-deboost.tst
@@ -141,3 +141,5 @@ W: unlocked:		2:	2
  W: unlocked:		1:	1
  W: unlocked:		0:	0
+# Reset the -4 opcode from the signal
+C: reset:               4:      0
\ No newline at end of file
--
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.kernel.org
More majordomo info at  
http://vger.kernel.org/majordomo-info.html
Please read the FAQ at  
http://www.tux.org/lkml/