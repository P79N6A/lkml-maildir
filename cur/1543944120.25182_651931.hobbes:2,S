Date: Mon, 11 Feb 2008 19:36:38 -0500 (EST)
From: Steven Rostedt <>
Subject: Re: [10/19] ftrace: add basic support for gcc profiler instrumentation
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2008/2/11/499

On Sun, 10 Feb 2008, Jan Engelhardt wrote:
>
> On Feb 10 2008 08:20, Ingo Molnar wrote:
> >--- linux.orig/Makefile
> >+++ linux/Makefile
> >@@ -509,6 +509,9 @@ endif
> >
> > include $(srctree)/arch/$(SRCARCH)/Makefile
> >
> >+ifdef CONFIG_FTRACE
> >+KBUILD_CFLAGS	+= -pg
> >+endif
> > ifdef CONFIG_FRAME_POINTER
> > KBUILD_CFLAGS	+= -fno-omit-frame-pointer -fno-optimize-sibling-calls
> > else
>
> You should use -fno-omit-frame-pointer when building with -pg; As far
> as I can remember from using gprof in the past (in userspace, I might
> add), the output does not make much sense without frame boundaries.
>
It is, but is hidden in the Kconfig. I moved it to Kconfig as it was
recommended to me because it is cleaner to do it there.
Two patches later:
+config FTRACE
+       bool "Kernel Function Tracer"
+       depends on DEBUG_KERNEL && HAVE_FTRACE
+       select FRAME_POINTER
-- Steve