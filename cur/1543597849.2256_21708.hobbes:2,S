Date: Wed, 15 Aug 2001 14:47:17 +0300
From: VDA <>
Subject: Re: SAK killing daemons
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2001/8/15/54

Hello Petr,
Wednesday, August 15, 2001, 11:44:13 AM, you wrote:
>> I noticed that when I press SAK on virtual console #1
>> on my Linux box, some daemons die horribly (SIGKILLed)
>> and some are unaffected. This does not happen on other consoles.
>> I suppose dying daemons did not detach fully from controlling tty. And
>> since they were launched from virtual console #1 upon system startup,
>> SAK killed them.
>> Daemons dying upon SAK: syslogd mysqld top* logger*
>> Daemons surviving SAK: klogd gpm dhcpcd inetd automount
>
> Try running the dying daemons by setsid utility (man 1 setsid, man 2 setsid),
> it can help maybe. And try to modify that su -c command to:
>
> su user0 -c "top s" </dev/tty/10 >/dev/tty10 2>/dev/tty10 &
>
> that could help also.
Okay, tried that with top and it works. However, syslogd still
misbehaves. I tried these:
/usr/sbin/syslogd
setsid /usr/sbin/syslogd </dev/null >/dev/null 2>&1
setsid /usr/sbin/syslogd -n </dev/null >/dev/null 2>&1 &
with no success.
Does ANYBODY have syslogd which does NOT die after SAK on VT #1 ?
If so, please tell me how exactly do you launch it,
syslogd and kernel version. Mine:
syslogd: 1.4.1
kernel: 2.4.5
Note: klogd does not die. Looking at the sources, I don't see why.
They use similar method (however not identical code) of auto-backgrounding
but... maybe someone more experienced can take a look?
Please CC me, I'm not on the list.
-- 
Best regards,
VDA                            mailto:VDA@port.imtp.ilyichevsk.odessa.ua
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.kernel.org
More majordomo info at  
http://vger.kernel.org/majordomo-info.html
Please read the FAQ at  
http://www.tux.org/lkml/