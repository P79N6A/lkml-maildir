Date: Mon, 26 Feb 2001 12:07:04 +0100
From: Erik Mouw <>
Subject: Re: [PATCH] Re: reiserfs: still problems with tail conversion
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2001/2/26/160

On Sun, Feb 25, 2001 at 09:40:44PM -0500, Chris Mason wrote:
> This patch should take care of the other cause for null bytes
> in small files.  It has been through a few hours of testing,
> with some of the usual load programs + Erik's code concurrently.
> 
> I'll let things run overnight to try and find more bugs.  The
> patch is against 2.4.2, and does a few things:
> 
> don't dirty the direct->indirect target until all direct items
> have been copied in.  Before it was dirtied for each direct item.
> 
> make the target up to date before dirtying (it was done after).
> 
> don't try to zero the unused part of the target until all bytes
> have been copied.  This was the big bug, it was zeroing previously
> copied bytes.
> 
> Any testing on non-production machines would be appreciated,
> I'll forward to Linus/Alan once I've gotten more feedback.
Yes, this did the trick, I can't repeat it anymore after a first run.
I'll let my code run for a couple of times to stress the system, but at
first glance the bug seems to be fixed.
Thanks for your efforts,
Erik
-- 
J.A.K. (Erik) Mouw, Information and Communication Theory Group, Department
of Electrical Engineering, Faculty of Information Technology and Systems,
Delft University of Technology, PO BOX 5031,  2600 GA Delft, The Netherlands
Phone: +31-15-2783635  Fax: +31-15-2781843  Email: J.A.K.Mouw@its.tudelft.nl
WWW: 
http://www-ict.its.tudelft.nl/~erik/
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.kernel.org
More majordomo info at  
http://vger.kernel.org/majordomo-info.html
Please read the FAQ at  
http://www.tux.org/lkml/