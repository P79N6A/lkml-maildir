Date: Thu, 21 Oct 1999 05:47:59 -0400
From: Jeff Garzik <>
Subject: Re: PATCH 2.3.23.5: ACPI iomap fix
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/1999/10/21/33

Jeff Garzik wrote:
> 
> Attached is a patch against 2.3.23 pre5 which fixes ACPI with regards to
> iomapping.  The warning messages added in pre5 brought to light this
> bug.  This patch works on my K6 w/ ACPI.
Further note -- ACPI works, but is not correct WRT readl() usage.
The driver has a lot of code like this:
	table = ioremap (table_addr, table_size);
	foo = table->field1;
	bar = table->field2;
	iounmap (table);
The second and third lines of code perform a direct deref of the ACPI
data.  That is fine (for now) on x86, but is not correct.  I don't have
time to fix it right now, but the entire driver needs to be sanitized
like:
	data = ioremap (table_addr, table_size);
	memcpy_fromio (&table, data, table_size);
	iounmap (data);
	foo = table.field1; /* etc. */
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.rutgers.edu
Please read the FAQ at 
http://www.tux.org/lkml/