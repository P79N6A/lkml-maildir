Date: Tue, 12 Feb 2002 21:35:16 -0800
From: Andrew Morton <>
Subject: Re: [patch] sys_sync livelock fix
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2002/2/13/31

Bill Davidsen wrote:
> 
> > But we want sync to be useful.
> 
>   No one has proposed otherwise. Unless you think that a possible hang is
> useful, the questions becomes adding all dirty buffers to the elevator,
> then (a) waiting or (b) returning. Either satisfies SuSv2.
errr.  Bill.  I wrote the patch.   Please take this as a sign
that I'm not happy with the current implementation :)
> >
> > >
> > >   If this were only a performance issue I wouldn't push for prompt
> > > implementation, but anything which can hang the system, particularly in
> > > shutdown, is bad.
> > >
> >
> > If shutdown hangs, it's probably due to something else.
> 
>   If you discount the evidence you can prove anything... or disbelieve
> anything.
Thing is, at shutdown all the tasks which are generating write
traffic should have been killed off, and the filesystems unmounted
or set readonly.    There's no obvious way in which this shutdown
sequence can be indefinitely stalled by the problem we're discussing here.
If the shutdown scripts are calling sys_sync() *before* killing
everything then yes, the scripts could hang indefinitely.  Is
this the case?
If "yes" then the scripts are dumb.  Just remove the `sync' call.
If "no" then something else is causing the hang.
-
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.kernel.org
More majordomo info at  
http://vger.kernel.org/majordomo-info.html
Please read the FAQ at  
http://www.tux.org/lkml/