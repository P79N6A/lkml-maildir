Date: Wed, 7 Mar 2001 22:54:35 +0100
From: Petr Vandrovec <>
Subject: [PATCH] ncpfs and CONFIG_DEBUG_SLAB
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2001/3/7/194

Hi Alan,
   if you are going to apply patch I saw today morning on linux-kernel
to disable redzoning on SLAB_HWCACHE aligned areas, drop this one into
wastebasket.
   If not, please apply this. When CONFIG_DEBUG_SLAB is enbled,
dentries do not live on 16bytes boundary, but on x*8 + 4 :-( So I
can validate only two low bits.
   This patch is for 2.4.2-ac13 with applied patch I sent just few
minutes ago.
   Urban's smbfs has same problem, as it uses almost same validate
code...
					    Thanks,
						Petr Vandrovec
						vandrove@vc.cvut.cz
--- linux/fs/ncpfs/dir.c	Wed Mar  7 22:40:12 2001
+++ linux/fs/ncpfs/dir.c	Wed Mar  7 21:09:36 2001
@@ -332,7 +332,11 @@
 {
 	unsigned long dent_addr = (unsigned long) dentry;
 	const unsigned long min_addr = PAGE_OFFSET;
+#ifdef CONFIG_DEBUG_SLAB
+	const unsigned long align_mask = 0x03;
+#else
 	const unsigned long align_mask = 0x0F;
+#endif
 	unsigned int len;
 
 	if (dent_addr < min_addr)
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.kernel.org
More majordomo info at  
http://vger.kernel.org/majordomo-info.html
Please read the FAQ at  
http://www.tux.org/lkml/