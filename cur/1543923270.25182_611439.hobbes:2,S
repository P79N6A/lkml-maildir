Date: Mon, 29 Oct 2007 12:34:43 +0100
From: Jens Axboe <>
Subject: Re: [PATCH-RESEND] Re: S390 change in sg_set_page() cause build failure
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2007/10/29/118

On Mon, Oct 29 2007, Kamalesh Babulal wrote:
> Jens Axboe wrote:
> > On Mon, Oct 29 2007, Kamalesh Babulal wrote:
> >> On Fri, Oct 26, 2007 at 01:54:30PM +0200, Jens Axboe wrote:
> >>> On Fri, Oct 26 2007, Kamalesh Babulal wrote:
> >>>> Hi Jens,
> >>>>
> >>>>  	sg_set_buf(list, address, 0);
> >> <snip>
> >>>>  }
> >>> That's not quite right, it should be:
> >>>
> >>> diff --git a/drivers/s390/scsi/zfcp_def.h b/drivers/s390/scsi/zfcp_def.h
> >>> index 0754542..e268f79 100644
> >>> --- a/drivers/s390/scsi/zfcp_def.h
> >>> +++ b/drivers/s390/scsi/zfcp_def.h
> >>> @@ -70,11 +70,12 @@ zfcp_sg_to_address(struct scatterlist *list)
> >>>   * zfcp_address_to_sg - set up struct scatterlist from kernel address
> >>>   * @address: kernel address
> >>>   * @list: struct scatterlist
> >>> + * @size: buffer size
> >>>   */
> >>>  static inline void
> >>> -zfcp_address_to_sg(void *address, struct scatterlist *list)
> >>> +zfcp_address_to_sg(void *address, struct scatterlist *list, unsigned int size)
> >>>  {
> >>> -	sg_set_buf(list, address, 0);
> >>> +	sg_set_buf(list, address, size);
> >>>  }
> >>>
> >>>  #define REQUEST_LIST_SIZE 128
> >>>
> >>> -- 
> >>> Jens Axboe
> >> Hi Jens,
> >>
> >> Resending the patch with the changes pointed by you in the patch.
> >>
> >> [jens.axboe@oracle.com: size parameter fix]
> >> Signed-off-by: Kamalesh Babulal <kamalesh@linux.vnet.ibm.com>
> >> --
> >> diff --git a/drivers/s390/scsi/zfcp_def.h b/drivers/s390/scsi/zfcp_def.h
> >> index 0754542..f747e86 100644
> >> --- a/drivers/s390/scsi/zfcp_def.h
> >> +++ b/drivers/s390/scsi/zfcp_def.h
> >> @@ -70,11 +70,12 @@ zfcp_sg_to_address(struct scatterlist *list)
> >>   * zfcp_address_to_sg - set up struct scatterlist from kernel address
> >>   * @address: kernel address
> >>   * @list: struct scatterlist
> >> + * @size: buffer size 
> >>   */
> >>  static inline void
> >> -zfcp_address_to_sg(void *address, struct scatterlist *list)
> >> +zfcp_address_to_sg(void *address, struct scatterlist *list, unsigned int size)
> >>  {
> >> -	sg_set_buf(list, address, 0);
> >> +	sg_set_buf(list, address, size);
> >>  }
> >> 
> >>  #define REQUEST_LIST_SIZE 128
> > 
> > Thanks Kamalesh, but I already merged a fixed up version on friday:
> > 
> > 
http://git.kernel.dk/?p=linux-2.6-block.git;a=commit;h=9335432959111c982c74177521305e6a3fb600a3
> > 
> Hi Jens,
> 
> Thanks !! I resend because, this was seen till todays 2.6.24-rc1-git5.
I've sent the pull request to Linus this morning, so hopefully it should
be fixed in tomrrows snapshot.
-- 
Jens Axboe
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.kernel.org
More majordomo info at  
http://vger.kernel.org/majordomo-info.html
Please read the FAQ at  
http://www.tux.org/lkml/