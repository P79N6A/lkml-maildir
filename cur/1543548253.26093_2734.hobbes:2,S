Date: Sat, 9 Sep 2000 15:29:18 -0700
From: Paul Laufer <>
Subject: Re: non-PnP SB AWE32 misbehaving in test7 or newer
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2000/9/9/57

> Here's your report. :)
Gerard,
        Thanks for the report. I had the patch you mentioned go in
specifically so I could test this feature on all kinds of hardware. The
attached patch fixes two problems. The first was I didn't test for
invalid combinations of module parameters, i.e. using multiple=1 and
isapnp=0 at the same time.  The second was if multiple=1 and the driver
finds no ISAPnP cards it would still loop and crash. The second problem
seems to be the one you experienced. The attached patch should fix both
problems.
        Please let me know if the attached patch fixes your problem.
Patch made against 2.4.0-test8.
> I've noted one or two other posts to the list with the same / similar
> trouble.
I must have missed them :(
> Gerard Sharp
> Two Penguins on 2.4.0-test6
Paul Laufer
--- linux-virgin/drivers/sound/sb_card.c	Sat Sep  9 15:06:13 2000
+++ linux/drivers/sound/sb_card.c	Sat Sep  9 15:07:16 2000
@@ -647,7 +647,7 @@
 
 static int __init init_sb(void)
 {
-	int card, max = multiple ? SB_CARDS_MAX : 1;
+	int card, max = (multiple && isapnp) ? SB_CARDS_MAX : 1;
 
 	printk(KERN_INFO "Soundblaster audio driver Copyright (C) by Hannu Savolainen 1993-1996\n");
 	
@@ -660,6 +660,7 @@
 			if(!sb_cards_num) {
 				printk(KERN_NOTICE "sb: No ISAPnP cards found, trying standard ones...\n");
 				isapnp = 0;
+				max = 1;
 			} else
 				break;
 		}