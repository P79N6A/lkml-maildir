Date: Tue, 13 Mar 2007 10:15:19 -0700
From: Jeremy Fitzhardinge <>
Subject: Re: [PATCH 8/8] Convert PDA into the percpu section
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2007/3/13/255

Rusty Russell wrote:
> +	pack_descriptor((u32 *)&gdt[GDT_ENTRY_PERCPU].a,
> +			(u32 *)&gdt[GDT_ENTRY_PERCPU].b,
> +			__per_cpu_offset[cpu], 0xFFFFF,
>  			0x80 | DESCTYPE_S | 0x2, 0); /* present read-write data segment */
> 
Why testing with qemu is not enough.
diff -r 8dcd1dc9b298 arch/i386/kernel/cpu/common.c
--- a/arch/i386/kernel/cpu/common.c	Tue Mar 13 00:33:37 2007 -0700
+++ b/arch/i386/kernel/cpu/common.c	Tue Mar 13 08:33:42 2007 -0700
@@ -627,7 +627,7 @@ __cpuinit void init_gdt(int cpu, struct 
 	pack_descriptor((u32 *)&gdt[GDT_ENTRY_PERCPU].a,
 			(u32 *)&gdt[GDT_ENTRY_PERCPU].b,
 			__per_cpu_offset[cpu], 0xFFFFF,
-			0x80 | DESCTYPE_S | 0x2, 0); /* present read-write data segment */
+			0x80 | DESCTYPE_S | 0x2, 0x8); /* present read-write data segment, G */
 	per_cpu(this_cpu_off, cpu) = __per_cpu_offset[cpu];
 	per_cpu(cpu_number, cpu) = cpu;
 #endif /* SMP*/
    J
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.kernel.org
More majordomo info at  
http://vger.kernel.org/majordomo-info.html
Please read the FAQ at  
http://www.tux.org/lkml/