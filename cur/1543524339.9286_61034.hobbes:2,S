Date: Tue, 1 Feb 2000 08:11:36 -0500 (EST)
From:  dave@afr-olt ...
Subject: problems with PCMCIA in 2.3.27+
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2000/2/1/86

Hi,
The kernel PCMCIA modules for my laptop fail to load because of unresolved
symbols. 
[root] #depmod -aeF System.map 2.3.42
depmod: *** Unresolved symbols in /lib/modules/2.3.42/pcmcia/ds.o
depmod:         pcmcia_lookup_bus
depmod: *** Unresolved symbols in /lib/modules/2.3.42/pcmcia/yenta.o
depmod:         dead_socket
depmod: *** Unresolved symbols in /lib/modules/2.3.42/pcmcia/i82365.o
depmod:         dead_socket
Adding the following to linux/drivers/pcmcia/cs.c fixes (covers up?) the
problem.
EXPORT_SYMBOL(dead_socket);
EXPORT_SYMBOL(pcmcia_lookup_bus);
I then get additional unresolved symbols (probe_irq_mask and
pci_find_parent_resource) in yenta.o, but I don't seem to need the yenta
code; so that's not a problem for me.
During compilation of the modules, there are a number of warnings about
functions which are defined but not used.  Here's the error log from the
command 
"make dep clean && make bzImage modules >compile.log 2>compile-error.log"
compile-error.log:
apm.c:532: warning: `apm_cpu_idle' defined but not used
Root device is (3, 4)
Boot sector 512 bytes.
Setup is 4557 bytes.
System is 582 kB
serial_cs.c:644: warning: `init_serial_cs' defined but not used
serial_cs.c:658: warning: `exit_serial_cs' defined but not used
serial_cb.c:138: warning: `init_serial_cb' defined but not used
serial_cb.c:145: warning: `exit_serial_cb' defined but not used
3c589_cs.c:1141: warning: `init_3c589_cs' defined but not used
3c589_cs.c:1155: warning: `exit_3c589_cs' defined but not used
cb_enabler.c:381: warning: `init_cb_enabler' defined but not used
cb_enabler.c:394: warning: `exit_cb_enabler' defined but not used
pci_socket.c:176: warning: `pci_socket_init' defined but not used
pci_socket.c:193: warning: `pci_socket_exit' defined but not used
cs.c:2349: warning: `init_pcmcia_cs' defined but not used
cs.c:2367: warning: `exit_pcmcia_cs' defined but not used
i82365.c:1522: warning: `init_i82365' defined but not used
i82365.c:1566: warning: `exit_i82365' defined but not used
scsi.c: In function `init_module':
scsi.c:2240: warning: unused variable `has_space'
scsi.c:2239: warning: unused variable `size'
aha152x.c: In function `aha152x_host_reset':
aha152x.c:1719: warning: unused variable `shpnt'
With the hacks to patch the globals in ds and i82365, one PCMCIA card
seems to work fine, but a card inserted to the second slot gets assigned
IRQ 0, which is in use by the XT-PIC timer. FWIW, the pcmcia irq's show in
dmesg but not /proc/interrupts.
Finally when I shut down, I get the following message in sylog:
Jan 31 14:02:54 puppy kernel: Trying to free nonexistent resource
<03e0-03e1>
During startup I got:
Jan 31 13:43:57 puppy kernel: Intel PCIC probe:
Jan 31 13:43:57 puppy kernel:   Intel i82365sl DF ISA-to-PCMCIA at port
0x3e0 ofs 0x00, 2 sockets
Jan 31 13:43:57 puppy kernel:     host opts [0]: none
Jan 31 13:43:57 puppy kernel:     host opts [1]: none
Jan 31 13:43:57 puppy kernel:     ISA irqs (scanned) = 3,4,7,11 polling
interval = 1000 ms
I've got more stuff (.config, dmesgs, logs, etc), but this is already too
long for an initial posting.
Dave Hamblen
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.rutgers.edu
Please read the FAQ at 
http://www.tux.org/lkml/