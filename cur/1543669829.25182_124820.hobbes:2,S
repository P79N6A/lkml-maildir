Date: Mon, 14 Apr 2003 09:43:23 +1000 (EST)
From: Paul Mackerras <>
Subject: Re: [PATCH] M68k IDE updates
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2003/4/13/111

Alan Cox writes:
> This looks the wrong place to fix this problem Geert. The PPC 
> folks have the same issues with byte order on busses but you
> won't see ifdefs in the core IDE code for it.
> 
> Fix your __ide_mm_insw/ide_mm_outsw macros and the rest happens
> automatically.
As I understand it, on some platforms (including some PPC platforms,
but not powermacs) one needs to byteswap drive ID data but not the
normal sector data.  Or vice versa.  Whether drive ID data needs
byte-swapping comes down to how the drive is attached to the bus.  The
conventions used by other systems that we need to interoperate with
(e.g. other OSes, or just older kernels) determine whether normal
sector data needs byte-swapping or not.
Since __ide_mm_insw doesn't get told whether it is transferring normal
sector data or drive ID data, it can't necessarily do the right thing
in both situations.
It's very possible that there are some PPC platforms for which IDE is
borken right now - I strongly suspect this would be the case for the
Tivo at least, and probably several other embedded PPC platforms.
Paul.
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.kernel.org
More majordomo info at  
http://vger.kernel.org/majordomo-info.html
Please read the FAQ at  
http://www.tux.org/lkml/