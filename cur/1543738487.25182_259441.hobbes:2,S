Date: Sun, 10 Oct 2004 22:24:22 +0200
From: Michael Schierl <>
Subject: [PANIC] Kernel panic after rmmod softdog (2.6.8.1)
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2004/10/10/82

Hi,
today, when testing the software watchdog, I accidentally removed the 
software watchdog kernel module and got a kernel panic.
to reproduce:
- build a kernel (2.6.8.1) with softdog built as module
  (and without the NOWAYOUT option)
- load the softdog module
- write something (not ending with a "V") to /dev/watchdog, e. g.
  echo x >/dev/watchdog
- A message will appear that device was closed, but the watchdog is 
  still active (if you wait a minute now, your box will reboot...)
- remove the softdog module
- wait a minute. you will see a kernel panic.
If there is a need for the actual panic message, I'll take a piece of 
paper and transcribe it (no serial console here...), but i doubt it,
since 
it is quite easy to reproduce...
when you disable the watchdog by
  echo "V" >/dev/watchdog
before removing the module, it will not panic.
Hmm, another thing: according to the documentation in watchdog.txt,
softdog does not honor the special "V" for closing the watchdog,
but actually it does.
Please CC me since I am not on the list,
Michael
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.kernel.org
More majordomo info at  
http://vger.kernel.org/majordomo-info.html
Please read the FAQ at  
http://www.tux.org/lkml/