Date: Mon, 11 Jul 2005 14:36:28 -0400 (EDT)
From: Alan Stern <>
Subject: Re: Kernel 2.6.12 + IO-APIC + uhci_hcd = Trouble
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2005/7/11/200

On Mon, 11 Jul 2005, Michel Bouissou wrote:
> Hi Nathalie,
> 
> Thanks for your answer and pointer. Unfortunately it doesn't help.
> 
> The patch you mention won't apply on my kernel alone, I need first to apply 
> the patch from 
> 
http://www.kernel.org/git/?p=linux/kernel/git/torvalds/linux-2.6.git;a=commit;h=c434b7a6aedfe428ad17cd61b21b125a7b7a29ce
 , 
> then your patch applies OK.
> 
> Unfortunately, it doesn't solve my issue. Booting this kernel still results in 
> an interrupt issue with uhci_hcd.
> 
> After boot, "cat /proc/interrupts" shows:
>            CPU0
>   0:     188066    IO-APIC-edge  timer
>   1:        308    IO-APIC-edge  i8042
>   2:          0          XT-PIC  cascade
>   4:        413    IO-APIC-edge  serial
>   7:          3    IO-APIC-edge  parport0
>  14:       1177    IO-APIC-edge  ide4
>  15:       1186    IO-APIC-edge  ide5
>  18:       1028   IO-APIC-level  eth0, eth1
>  19:       8513   IO-APIC-level  ide0, ide1, ide2, ide3, ehci_hcd:usb4
>  21:     100000   IO-APIC-level  uhci_hcd:usb1, uhci_hcd:usb2, uhci_hcd:usb3
>  22:          0   IO-APIC-level  VIA8233
> NMI:          0
> LOC:     187967
> ERR:          0
> MIS:          0
> 
> (The problem is with IRQ 21 for uhci_hcd)
> 
> (It is to note that without those patches, I didn't see any IRQ managed by 
> "XT-PIC", all were managed by the IO-APIC...)
It's possible that the errors you're getting are caused by some other
device erroneously generating interrupt requests on IRQ 21.  Then when
uhci-hcd enables that IRQ, there's no driver available to handle the 
interrupts...
It's also possible that the UHCI controllers are generating the unwanted 
interrupt requests.  You should make sure that Legacy USB Support is 
turned off in your BIOS settings.  You can also try adding the 
"usb-handoff" kernel parameter to your boot command line.
Alan Stern
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.kernel.org
More majordomo info at  
http://vger.kernel.org/majordomo-info.html
Please read the FAQ at  
http://www.tux.org/lkml/