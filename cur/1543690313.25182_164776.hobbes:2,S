Date: 10 Sep 2003 13:52:38 +0100
From: Justin Cormack <>
Subject: Re: [2.4] siimage locks hard on high load
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2003/9/10/139

On Fri, 2003-09-12 at 12:44, Witold Krecicki wrote:
> I've got Asus a7n8x deluxe with on-board Silicon Image SATA and 2xBarracuda 
> 120GB connected to it in software RAID array.
> On high disk load (e.g. cp -Rf /usr/src/linux somewhere_else) kernel locks 
> hard after about 10 seconds (magic sysrq is not working).
> It happens only when DMA is enabled. 
> /dev/hda:
>  multcount    = 16 (on)
>  IO_support   =  1 (32-bit)
>  unmaskirq    =  1 (on)
>  using_dma    =  1 (on)
>  keepsettings =  0 (off)
>  readonly     =  0 (off)
>  readahead    = 16 (on)
>  geometry     = 14593/255/63, sectors = 234441648, start = 0
> 
> Also, I'm not really satisfied with speed of this array:
> /dev/md1:
>  Timing buffered disk reads:  64 MB in  1.77 seconds = 36.16 MB/sec
> Any solutions/fixes?
Cant help you on the lockups (I havent seen this myself), but the
performance is due to the workaround that sets max_kb_per_request to 15
for siimage. On some drives (Western digital, maxtor) this only cuts the
performance by 10-15MB/s or so but on the Seagates it completely trashes
performance (you can easily test this but you may get data
corruption...).
A proper bug fix rather than a workaround would be nice (unless this
isnt possible). Are the docs for this chipset actually available and is
a bug fix possible? (Alan/Andre should know).
Justin
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.kernel.org
More majordomo info at  
http://vger.kernel.org/majordomo-info.html
Please read the FAQ at  
http://www.tux.org/lkml/