Date: 25 Nov 2004 12:07:32 +0100
From: Andi Kleen <>
Subject: Re: oops with dual xeon 2.8ghz  4gb ram +smp, software raid, lvm,  and xfs
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2004/11/26/331

Andrew Morton <akpm@osdl.org> writes:
> > I can't say I love the idea of adding a bio list structure to the
> > tasklist, it feels pretty hacky. generic_make_request() doesn't really
> > use that much stack, if you just kill the BDEVNAME_SIZE struct.
> 
> Looks like a sensible thing to do, although it would be tidier to move the
> whole thing into a separate function, no?
> 
> 
> --- 25/drivers/block/ll_rw_blk.c~generic_make_request-stack-savings	2004-11-24 23:03:06.347778648 -0800
> +++ 25-akpm/drivers/block/ll_rw_blk.c	2004-11-24 23:07:39.798207864 -0800
> @@ -2584,6 +2584,20 @@ static inline void block_wait_queue_runn
>  	}
>  }
> 
> +static void handle_bad_sector(struct bio *bio)
You need to mark it noinline, otherwise a unit-at-a-time gcc (3.4+) 
will happily inline it anyways.
-Andi
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.kernel.org
More majordomo info at  
http://vger.kernel.org/majordomo-info.html
Please read the FAQ at  
http://www.tux.org/lkml/