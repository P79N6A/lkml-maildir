Date: Tue, 4 Mar 2008 01:44:09 -0800
From: David Brownell <>
Subject: Re: Bugs in MMC [was: [Bug 10030] Suspend doesn't work when SD card is inserted]
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2008/3/4/116

On Monday 03 March 2008, Pierre Ossman wrote:
> On Mon, 3 Mar 2008 13:59:37 -0800
> David Brownell <david-b@pacbell.net> wrote:
> 
> > 
> > Card insert/remove events can be system wake events though.  Which
> > makes that restriction impractical.
This part seems to be ignored by your comment ... wake events.
> > I think hosts need to be able to call mmc_detect_change() as soon as
> > they see a stable signal.  The MMC core can hold off handling that
> > for a while, if it needs to wait until the code walking the device
> > tree gets around to resuming that host.  It's a lot more natural to
> > hold off such stuff one time there than in N host drivers; especially
> > since the MMC core already has such hold-off code.
> > 
> 
> That actually sorts itself out as the MMC core reprobes on wakeup, but
> I see your point. Right now things will work peachy if the controllers
> just make sure to disable their card detection logic before telling the
> core to suspend.   
That is, the MMC core doesn't understand wakeup events.
Or, as pointed out elsewhere, well-behaved MMC hosts ... which don't
need either such reprobing or the associated remove-on-suspend.
- Dave