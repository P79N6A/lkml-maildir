Date: Fri, 28 Sep 2001 12:58:12 -0500
From: Steve Lord <>
Subject: Re: [BENCH] Problems with IO throughput and fairness with 2.4.10 and 2.4.9-ac15
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2001/9/28/121

> Thanks, nice to hear.
> 
> So it needs to be something stupid on my side or xfs with the new VM.
> 
> By the way. It is an Atlon 1.1 (kernel compiled with Atlon optimisation)
> IDE controller ATA66, disk IBM 15 GB ATA33
> The machine is solid with and without VIA pci bit 7 byte 55 zero/one
> swapspace 256MB
> 
> preempable patch does not help with my D state problem
> i have not tried 2.4.10.aa1
> but i will try with ext2 instead of xfs next time
> 
> Gerold
> 
Hi,
Can you try XFS with this change, just to confirm you are seeing the same
problem I am seeing. I am not proposing this as a permanent fix yet,
just confirming what the deadlock is.
Thanks
   Steve
===========================================================================
Index: linux/fs/inode.c
===========================================================================
--- /usr/tmp/TmpDir.21835-0/linux/fs/inode.c_1.53	Fri Sep 28 12:57:27 2001
+++ linux/fs/inode.c	Fri Sep 28 10:17:49 2001
@@ -76,7 +76,7 @@
 static kmem_cache_t * inode_cachep;
 
 #define alloc_inode() \
-	 ((struct inode *) kmem_cache_alloc(inode_cachep, SLAB_KERNEL))
+	 ((struct inode *) kmem_cache_alloc(inode_cachep, SLAB_NOFS))
 static void destroy_inode(struct inode *inode) 
 {
 	if (inode_has_buffers(inode))
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.kernel.org
More majordomo info at  
http://vger.kernel.org/majordomo-info.html
Please read the FAQ at  
http://www.tux.org/lkml/