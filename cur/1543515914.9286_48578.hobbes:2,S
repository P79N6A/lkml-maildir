Date: Fri, 12 Nov 1999 15:05:40 +0100 (MET)
From: Mikael Pettersson <>
Subject: [PATCH] make memory detection code detect "type 4" areas
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/1999/11/12/60

The following trivial patch extends the E820 memory detection code
to detect and report "type 4" memory, which is "ACPI NVS memory".
(Non-Volatile Store. An ACPI OS is supposed to save/restore this
area to non-volatile media at transitions to/from ACPI S4 states.)
Linux currently treats "type 3" memory as reserved. Actually, it
is ordinary RAM which can be reclaimed by the OS once it has read
the ACPI tables.
(This is all detailed in the ACPI specification, chapter 14 I think.)
/Mikael
--- linux-2.3.27/arch/i386/kernel/setup.c.orig	Fri Nov 12 10:47:11 1999
+++ linux-2.3.27/arch/i386/kernel/setup.c	Fri Nov 12 11:21:04 1999
@@ -449,6 +449,9 @@
 			case E820_ACPI:
 					printk("(ACPI data)\n");
 					break;
+			case E820_NVS:
+					printk("(ACPI NVS)\n");
+					break;
 			default:	printk("type %lu\n", e820.map[i].type);
 					break;
 			}
--- linux-2.3.27/include/asm-i386/e820.h.orig	Tue Oct  5 19:21:30 1999
+++ linux-2.3.27/include/asm-i386/e820.h	Fri Nov 12 11:21:04 1999
@@ -18,7 +18,8 @@
 
 #define E820_RAM	1
 #define E820_RESERVED	2
-#define E820_ACPI	3
+#define E820_ACPI	3 /* usable as RAM once ACPI tables have been read */
+#define E820_NVS	4
 
 #define HIGH_MEMORY	(1024*1024)
 
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.rutgers.edu
Please read the FAQ at 
http://www.tux.org/lkml/