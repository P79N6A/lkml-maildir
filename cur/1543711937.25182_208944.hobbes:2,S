Date: Wed, 24 Mar 2004 14:44:55 +0100
From: Martin Schwidefsky <>
Subject: Re: [RFC 2/6] sysfs backing store v0.3a
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2004/3/24/64

Maneesh Soni wrote:
> Please find the following patch (2/6) for sysfs backing store. This fixes
> a leak observed in case of sysfs_readdir() for _big_ sysfs directories. The
> dentries were not getting released in case of error return from filldir()
> in sysfs_readdir().
>
> Thanks again to Christian Borntraeger (S390 Linux) for spotting this and testing
> the fix.
yes, Christian tested this again and it works great now. For his setup (which we
do not consider to be unusual) this patches saved about 50 MB of main memory. The
particular machine has about 1600 disk devices attached to it. This happens if the
i/o configuration doesn't restrict an lpar to the devices it should use but allows
the lpar to "see" all the device there are. Even a middle sized storage subsystem
can have a lot of disks, the ESS Christian used had 1600 disks. Now you might
argue a system that big should have enough memory for the syfs inodes. Its just
lousy 50 MB but given that there can be LOTS of system images I'd rather have the
50 MB then to waste then on the sysfs entries for unused disks.
I'm definitly much in favor of this patch.
blue skies,
   Martin
Linux/390 Design & Development, IBM Deutschland Entwicklung GmbH
Schönaicherstr. 220, D-71032 Böblingen, Telefon: 49 - (0)7031 - 16-2247
E-Mail: schwidefsky@de.ibm.com
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.kernel.org
More majordomo info at  
http://vger.kernel.org/majordomo-info.html
Please read the FAQ at  
http://www.tux.org/lkml/