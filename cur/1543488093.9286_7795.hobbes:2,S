Date: Tue, 02 Mar 1999 11:26:51 -0500
From: Josip Loncaric <>
Subject: Re: [patch] acks delayed and then merged in data-segment sent a bitafter
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/1999/3/2/60

I did not try Andrea's latest patch yet, but her earlier patch helped. 
This does seem to be a delayed ACK problem with small message sizes
(<100 bytes or so).  A carefully thought out fix would really help in
this situation.
FYI, a GIF file (9KB) comparing small message performance statistics of
Linux and our Suns is enclosed.  The vertical scale measures interpacket
delays in seconds as seen by the receiver OR by the sender, sorted from
largest to smallest.  Horizontal scale is merely an index after sorting,
not directly comparable because speedier machines send more messages
during the test.  The important feature of these curves is the time
wasted waiting for significantly delayed messages (i.e. delays of about
0.001 seconds or more).
RED:    Linux 2.2.2, PII/400, via full duplex fast ethernet switch
GREEN:  Linux 2.2.2 + Andrea's old patch (faster ACKs)
BLUE:   Linux 2.2.2 + Andrea's old patch + tulip.c {RX,TX}_RING_SIZE=256
PURPLE: SunUltra2 + SunOS 5.6 (Solaris), half-duplex fast ethernet hub
The tested Suns are our main servers so their timings were affected by
other tasks (the loads were about 0.1-0.3 during the test).  Linux boxes
were dedicated to the test with no competing network traffic.  Even so,
the plain Linux 2.2.2 has serious problems when streaming small packets
(<100 bytes or so).  By comparison, even loaded Suns on a less fancy
network can do better (about 100 times better, based on the number of
delays of 0.01 seconds or more). 
This was measured by adding timestamping between messages to netpipe-2.3
in streaming mode, for 43 different small message sizes (1 to 771
bytes).
Sincerely,
Josip
-- 
Dr. Josip Loncaric, Senior Staff Scientist        mailto:josip@icase.edu
ICASE, Mail Stop 403                        
http://www.icase.edu/~josip/
NASA Langley Research Center             mailto:j.loncaric@larc.nasa.gov
Hampton, VA 23681-2199, USA    Tel. +1 757 864-2192  Fax +1 757 864-6134[image]