Date: Tue, 30 May 2006 13:22:27 +0200
From: Martin Peschke <>
Subject: Re: [Patch] statistics infrastructure - update 1
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2006/5/30/108

Heiko Carstens wrote:
>>  	case CPU_UP_PREPARE:
>>  		stat->pdata->ptrs[cpu] = statistic_alloc_ptr(stat, GFP_ATOMIC,
> 
> Why not GFP_KERNEL?
I see. Schedule() is permitted in this context. Will change it.
>> +		if (!stat->pdata->ptrs[cpu])
>> +			return -ENOMEM;
> 
> NOTIFY_BAD instead of -ENOMEM, I guess.
Not a bug, but slightly confusing. I think I will clean it up in my
next update patch.
>>  		break;
>>  	case CPU_UP_CANCELED:
>>  	case CPU_DEAD:
> 
> I think your merge code (which gets called if CPU_UP_PREPARE fails) expects
> stat->pdata->ptrs[cpu] to be non-zero, right?
That's a bug and needs fixing (just bail out if pointer if zero).
Thanks, Martin
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.kernel.org
More majordomo info at  
http://vger.kernel.org/majordomo-info.html
Please read the FAQ at  
http://www.tux.org/lkml/