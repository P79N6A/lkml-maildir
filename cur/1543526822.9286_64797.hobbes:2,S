Date: Mon, 21 Feb 2000 18:28:32 +0100 (CET)
From: Zbigniew Ignasiak <>
Subject: strange error in kernel with samba
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2000/2/21/146

I found  a strange error (i think) i linux kernel 2.2.12 and 2.2.13 and
2.2.14 and this error is repeatable 
this is redhat 6.1 with samba client (i have small local network
linux+win).
samba is 2.0.5.something.rpm
i post some output from ksymoops 
when some of you have any others question please mail me email
#####################################################################
ksymoops 0.7c on i586 2.2.14.  Options used
     -V (default)
     -k /proc/ksyms (default)
     -l /proc/modules (default)
     -o /lib/modules/2.2.14/ (default)
     -m /usr/src/linux/System.map (default)
Warning: You did not tell me where to find symbol information.  I will
assume that the log matches the kernel and modules that are running
right now and I'll use the default options above for symbol resolution.
If the current kernel and/or modules do not match the log, you can get
more accurate output by telling me the kernel version and where to find
map, modules, ksyms etc.  ksymoops -h explains the options.
Warning (compare_ksyms_lsmod): module awe_wave is in lsmod but not in ksyms, probably no symbols exported
Unable to handle kernel NULL pointer dereference at virtual address 0000001c
current->tss.cr3 = 0190e000, %cr3 = 0190e000
*pde = 00000000
Oops: 0000
CPU:    0
EIP:    0010:[<c0126045>]
Using defaults from ksymoops -t elf32-i386 -a i386
EFLAGS: 00010286
eax: 00000000   ebx: 00000000   ecx: 00000021   edx: 0000001a
esi: c25b4e00   edi: 00000003   ebp: 00000003   esp: c190df50
ds: 0018   es: 0018   ss: 0018
Process umount (pid: 660, process nr: 39, stackpage=c190d000)
Stack: 00000000 c25b4e44 c25b4e44 c25b4e00 00000000 c0128cd9 c25b4e00 00000003 
       fffffffa c1f36110 00000003 c0128d77 00000003 00000000 00000000 00000000 
       40000003 c1f38420 bffffc6c c0128e73 00000003 00000000 c190c000 4000a610 
Call Trace: [<c0128cd9>] [<c0128d77>] [<c0128e73>] [<c0128e8c>] [<c0109e08>] 
Code: 8b 43 1c 48 75 35 53 e8 0b 96 00 00 53 e8 11 ef ff ff c7 43 
>>EIP; c0126045 <fput+5/48>   <=====
Trace; c0128cd9 <do_umount+dd/124>
Trace; c0128d77 <umount_dev+57/a0>
Trace; c0128e73 <sys_umount+b3/c0>
Trace; c0128e8c <sys_oldumount+c/10>
Trace; c0109e08 <system_call+34/38>
Code;  c0126045 <fput+5/48>
00000000 <_EIP>:
Code;  c0126045 <fput+5/48>   <=====
   0:   8b 43 1c                  movl   0x1c(%ebx),%eax   <=====
Code;  c0126048 <fput+8/48>
   3:   48                        decl   %eax
Code;  c0126049 <fput+9/48>
   4:   75 35                     jne    3b <_EIP+0x3b> c0126080 <fput+40/48>
Code;  c012604b <fput+b/48>
   6:   53                        pushl  %ebx
Code;  c012604c <fput+c/48>
   7:   e8 0b 96 00 00            call   9617 <_EIP+0x9617> c012f65c <locks_remove_flock+0/94>
Code;  c0126051 <fput+11/48>
   c:   53                        pushl  %ebx
Code;  c0126052 <fput+12/48>
   d:   e8 11 ef ff ff            call   ffffef23 <_EIP+0xffffef23> c0124f68 <__fput+0/48>
Code;  c0126057 <fput+17/48>
  12:   c7 43 00 00 00 00 00      movl   $0x0,0x0(%ebx)
#########################################################
2 warnings issued.  Results may not be reliable.
########################################################
a strange sambe message
###################################################
smb_get_length: recv error = 512
smb_request: result -512, setting invalid
smb_dont_catch_keepalive: did not get valid server!
#######################################################
file /etc/fstab
...
//qbut/muza	/siec/qbut/muza		smbfs	defaults,noexec,ro,noauto	0 0
...
################################################################
I run this script (it should kill kill every users proces which uses samba
files and then umount this directory)
i have do (when reboot server in me home) this before network is going
down
#!/bin/bash
#/etc/rc.d/rc6.d/K00umount_samba
ram=`mount |grep /siec | cut -f3 -d\ `
for i in $ram ; do
echo $i
fuser -k -m $i
umount $i
done
###########################################################
================================================================
Zbigniew Ignasiak
e-mail   :  ignasiak@druid.if.uj.edu.pl
WWW-Page    
http://druid.if.uj.edu.pl/~ignasiak
==>    Hiroszima'45   Czernobyl'86   Windows'95    <==
-=* IQ panow z Microsoftu * ilosc zarobionych przez nich pieniedzy = const *=-
PS. Don't marry, be happy !
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.rutgers.edu
Please read the FAQ at 
http://www.tux.org/lkml/