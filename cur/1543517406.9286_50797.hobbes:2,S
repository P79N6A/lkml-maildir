Date: Tue, 30 Nov 1999 15:41:18 +0200 (EET)
From: Sergey Kubushin <>
Subject: Some patches to compile 2.3.30pre3
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/1999/11/30/74

Hi everybody!
This is a patch to make some parts of 2.3.30pre3 compile. The sonicvibes
patch is definitely wrong but it allows to compile the thing and exposes the
problem with allocate_resource() ...
=== Cut ===
diff -urN linux-2.3.30pre3.orig/drivers/block/ide-features.c linux-2.3.30pre3/drivers/block/ide-features.c
--- linux-2.3.30pre3.orig/drivers/block/ide-features.c	Fri Nov 19 05:30:51 1999
+++ linux-2.3.30pre3/drivers/block/ide-features.c	Tue Nov 30 13:29:24 1999
@@ -13,6 +13,7 @@
  *  Gadi Oxman    <gadio@netvision.net.il>
  */
 
+#define __NO_VERSION__
 #include <linux/module.h>
 #include <linux/types.h>
 #include <linux/string.h>
diff -urN linux-2.3.30pre3.orig/drivers/char/pc110pad.c linux-2.3.30pre3/drivers/char/pc110pad.c
--- linux-2.3.30pre3.orig/drivers/char/pc110pad.c	Mon Oct 11 20:10:19 1999
+++ linux-2.3.30pre3/drivers/char/pc110pad.c	Tue Nov 30 13:31:02 1999
@@ -53,7 +53,6 @@
 static wait_queue_head_t queue;
 static struct fasync_struct *asyncptr;
 static int active=0;	/* number of concurrent open()s */
-static struct semaphore read_lock;
 
 /*
  * Utility to reset a timer to go off some time in the future.
diff -urN linux-2.3.30pre3.orig/drivers/sound/sonicvibes.c linux-2.3.30pre3/drivers/sound/sonicvibes.c
--- linux-2.3.30pre3.orig/drivers/sound/sonicvibes.c	Sat Oct 30 19:45:36 1999
+++ linux-2.3.30pre3/drivers/sound/sonicvibes.c	Tue Nov 30 13:30:06 1999
@@ -2457,7 +2457,7 @@
 			memcpy(ddmaname, sv_ddma_name, ddmanamelen);
 			pcidev->resource[RESOURCE_DDMA].name = ddmaname;
 			if (allocate_resource(&ioport_resource, pcidev->resource+RESOURCE_DDMA, 
-					      2*SV_EXTENT_DMA, 0x1000, 0x10000-2*SV_EXTENT_DMA, 1024)) {
+					      2*SV_EXTENT_DMA, 0x1000, 0x10000-2*SV_EXTENT_DMA, 1024, NULL, NULL)) {
 				pcidev->resource[RESOURCE_DDMA].name = NULL;
 				kfree(ddmaname);
 				printk(KERN_ERR "sv: cannot allocate DDMA controller io ports\n");
=== Cut ===
===========================================================================
Sergey Kubushin aka the Tamer         < > The impossible we do immediately.
e-mail: ksi@ksi-linux.com  SK320-RIPE < > Miracles require 24-hour notice.
===========================================================================
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.rutgers.edu
Please read the FAQ at 
http://www.tux.org/lkml/