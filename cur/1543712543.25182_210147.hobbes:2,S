Date: Mon, 29 Mar 2004 17:18:12 +0100 (BST)
From: Hugh Dickins <>
Subject: Re: 2.6.5-rc2-mm1 - swapoff dies with OOM, why?
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2004/3/29/145

On Mon, 29 Mar 2004, John Stoffel wrote:
> 
> I'm still wondering why swapoff dies though.  Shouldn't it complete,
> or at least have some way *to* complete if needed?  I realize, with a
> memory leak in the filesystem, it's a hard thing to deal with.  
If there's not enough freeable memory for what's out on swap, swapoff
cannot very well complete.  Either it can hang while other processes
get killed by the OOM killer once swapoff has filled memory (as 2.4),
until there's enough memory free to take in what's still needed from
swap; or the OOM killer can kill it off (as 2.6).  I much prefer the
2.6 behaviour - unlike many processes, swapoff can safely be restarted.
So the admin can then choose what else to kill, or add replacement
swap, then try the original swapoff again.
Hugh
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.kernel.org
More majordomo info at  
http://vger.kernel.org/majordomo-info.html
Please read the FAQ at  
http://www.tux.org/lkml/