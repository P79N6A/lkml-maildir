Date: Thu, 10 Jan 2008 12:08:16 -0800
From: "Pallipadi, Venkatesh" <>
Subject: RE: [patch 07/11] PAT x86: pat-conflict resolution using linear list
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2008/1/10/360

>-----Original Message-----
>From: Andi Kleen [mailto:andi@firstfloor.org] 
>Sent: Thursday, January 10, 2008 11:13 AM
>To: Pallipadi, Venkatesh
>Cc: ebiederm@xmission.com; rdreier@cisco.com; 
>torvalds@linux-foundation.org; gregkh@suse.de; 
>airlied@skynet.ie; davej@redhat.com; mingo@elte.hu; 
>tglx@linutronix.de; hpa@zytor.co; 
>linux-kernel@vger.kernel.org; Siddha, Suresh B
>Subject: Re: [patch 07/11] PAT x86: pat-conflict resolution 
>using linear list
>
>venkatesh.pallipadi@intel.com writes:
>> 
>>  	/* Reset the direct mapping. Can block */
>> -	if (p->flags >> 20)
>> -		ioremap_change_attr(p->phys_addr, p->size, 0);
>> +	if (p->flags >> 20) {
>> +		free_mattr(p->phys_addr, p->phys_addr + 
>get_vm_area_size(p),
>> +		           p->flags>>20);
>> +		ioremap_change_attr(p->phys_addr, 
>get_vm_area_size(p), 0);
>
>If you really unmap all holes and forbid (or let it just return the
>__va address) ioremap on anything mapped (which is probably ok) then
>you can eliminate that completely.
>
We heard X can allocate a page and then map it UC using it through gart.
So, I don't we can forbid all ioremaps for RAM.
Thanks,
Venki