Date: Tue, 5 Mar 2002 03:02:04 +0100
From: Andrea Arcangeli <>
Subject: Re: [PATCH] breaking up the pagemap_lru_lock in rmap
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2002/3/4/260

On Mon, Mar 04, 2002 at 10:04:51AM -0800, Martin J. Bligh wrote:
> High contention on the pagemap_lru lock seems to be a major
> scalability problem for rmap at the moment. Based on wli's and
> Rik's suggestions, I've made a first cut at a patch to split up the
> lock into a per-page lock for each pte_chain.
some year ago when I put a spinlock in the page structure I was flamed :)
That was fair enough. Sometime the theorical maximum degree of
scalability doesn't worth the additional ram usage.
but anyways, can you show where do you see this high contenction on the
pagemap_lru lock? Maybe that's more a sympthom that the rmap is doing
something silly with the lock acquired, can you measure high contention
also on my tree on similar workloads? I think we should worry about the
pagecache_lock, before the pagemap_lru lock. During heavy paging
activity, the system should become I/O bound, and the spinlock there
shouldn't matter. while when the system time goes up, it usually doesn't
run inside the vm, but it usually runs cached and there the
pagecache_lock matters.
Andrea
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.kernel.org
More majordomo info at  
http://vger.kernel.org/majordomo-info.html
Please read the FAQ at  
http://www.tux.org/lkml/