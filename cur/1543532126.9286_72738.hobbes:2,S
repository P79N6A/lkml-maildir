Date: Tue, 28 Mar 2000 14:06:49 -0500
From: "Michael H. Warfield" <>
Subject: Re: Location of shmfs; devfs automagics
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2000/3/28/115

On Tue, Mar 28, 2000 at 07:55:34PM +0200, Manfred Spraul wrote:
> Jeff Garzik wrote:
> > "H. Peter Anvin" wrote:
> > > The second is that devfs seems to think it is above the normal way of
> > > doing things (unlike ALL OTHER filesystems, including procfs and
> > > shmfs) and not only will mount itself on /dev automatically, but will
> > > do so *by default*.  This is incredibly antisocial behaviour, and has
> > > no justification.
> > Agreed.  This is why I don't build devfs when I build the MandrakeSoft
> > "hackkernel" package, containing the latest 2.3.x kernel and all its
> > features.
> Perhaps devfs should mount as "/devfs", and then the user can replace
> the /dev folder with a symlink to devfs _after_ he has installed devfsd.
	That's what I'm currently doing here.  I've got the devfs=nomount
option specified and then list it in fstab for mounting.  Simple symlinks
from the /dev directory to the appropriate subdirectories under /devfs
let me get at all of it.  The few things that are not burried in
subdirectories in /devfs are usually names that match in both name spaces
and then it doesn't really matter.
> I guess the current configuration will be a major problem for upgrades.
	Yeah...  Anyone using USB or a whole bunch of other "loose ends"
are in for a rude awakening.  "Loose ends" was someone else's term for
it after I rolled devfs support into the Computone drivers and mentioned
a lot of broken support even for things listed in devices.txt.  Those
updates were submitted but haven't even made it into the main kernel
sources yet, so I'm pretty confident that devfs support is going to be
really broken, when 2.4 is released, with a lot of drivers which just
don't support it.  There are a lot of things missing devfs support now
and, if that isn't sufficient to get changes incorporated, it's going to
be missing in the 2.4 rollout.
	Even after support for devfs is rolled into the drivers, the user
space devsfd daemon is missing a lot of links from the traditional names
to the devfs names.  That means that a lot of existing apps and
configurations are going to break, even if you are running devfsd.  It
creates a real uncomfortable critical dependency between enabling devfs
and switching all of your configurations.  Upgrades are going to be hell
with lots of little devils in lots of little details.
	The option of leaving /dev as is, then mounting devfs on /devfs and
providing appropriate symlinks from one to the other answers a lot of those
problems, but not all of them.  It's a compromise that keeps the pain level
of the transition to a minimum.  It's also the way Sun handled this
situation on Solaris, except there it's /dev and /devices where /devices
has the magical entry points as defined by the device drivers.
> --
> 	Manfred
	Mike
-- 
 Michael H. Warfield    |  (770) 985-6132   |  mhw@WittsEnd.com
  (The Mad Wizard)      |  (770) 331-2437   |  
http://www.wittsend.com/mhw/
  NIC whois:  MHW9      |  An optimist believes we live in the best of all
 PGP Key: 0xDF1DD471    |  possible worlds.  A pessimist is sure of it!
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.rutgers.edu
Please read the FAQ at 
http://www.tux.org/lkml/