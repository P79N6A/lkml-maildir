Date: Tue, 28 Sep 1999 19:22:09 -0700
From: Robert Redelmeier <>
Subject: Re: Clock Watching the Scheduler 2.2.10unip
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/1999/9/28/204

Alan Cox wrote:
> 
> > 1)  500 interrupts take 5 seconds.  No surprise there.  Except
> >       on SMP (& FreeBSD2.2.8) systems, where they only take
> >       ~2.7 seconds.  Are these spurrious interrupts?  Or SMP?
> 
> Sounds like your FreeBSD box is simply taking more interrupts
Egads ... you are right! :)
vmstat is very educational.  The FreeBSD box has 128 rtc int/sec
in addition to the 100 timer tics.  Why? ... xntpd?
But this adds up to quite some load.  As Richard Johnson pointed
out to me, boxen can start dropping ints around 150,000/s.  Now
this high a number isn't easy to reach but just imagine a server
with two 100baseTX plus some fast disks:  10k ints/s from each
of the ethercards, plus 20 MB/s from the disks in 1000 byte bites
for another 20k, and you've got 40 kints/sec.  
Even if the transfers don't shrink to 500 bytes, you're in trouble.
All these are running async, and for at least half the ISR interrupts
are disabled. You predict the lost ints.
Maybe this is why Linux failed the Mindcruft tests against NT, and
more credibly, the C't ones above a certain load.
Polling anyone?  Juggle HZ and poll heavy hw int callers?
Oh -- the horrors.  But either that or reduce IN / OUT busywaits.
-- Robert
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.rutgers.edu
Please read the FAQ at 
http://www.tux.org/lkml/