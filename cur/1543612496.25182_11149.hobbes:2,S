Date: Thu, 06 Dec 2001 12:05:48 +0100
From: Erland Lewin <>
Subject: /proc/<pid>/stat read hang with Mozilla in 2.4.14
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2001/12/6/366

On Mon, September 3, Christian Reis wrote to linux-kernel:
> Just wondering if anybody has had moz hanging on them and hanging 'ps -ax' 
> (which means /proc/kmem reading is hung, IIRC)? This _never_ happened 
> before 2.4.9, and I do mozilla QA so I'd have seen it; i've seen all sorts 
> of crash with it :) 
On Sun, September 30, Manfred Spraul replied:
> Probably you ran into the bug Ulrich Weigand found:
> access_process_vm can deadlock, especially with multithreaded apps.
> Access_process_vm is used by /proc/*/cmdline.
> 
> It's fixed in 2.4.10.
I am seeing this problem (Mozilla hangs, then ps hangs (even a normal ps
without args)) in kernel 2.4.14 on an SMP machine (Abit BP6 mobo).
  I did an strace of ps (procps 2.0.4) which ends with:
...
stat64("/proc/8770", {st_mode=S_IFDIR|0555, st_size=0, ...}) = 0
open("/proc/8770/stat", O_RDONLY)       = 7
read(7, > 
I can't kill the 8770 process with kill -9 8770 (the /proc/8770
directory still exists).
  I had recompiled Mozilla while a copy was running, could this have
caused the problem?
  I also get hangs reading the cmdline, environ, exe, maps, stat, statm
and status files.
  I can read the fd directory, the cpu file, the root and cwd links.
  If I try to read the mem file, I get: "cat: /proc/8770/mem: No such
process".
  There are no unusual messages in the system logs.
I guess I'll have to reboot now to make the dead Mozilla go away.
  Please CC: any replies to me, as I don't subscribe to the linux-kernel
list.
  Happy Hacking,
    Erland
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.kernel.org
More majordomo info at  
http://vger.kernel.org/majordomo-info.html
Please read the FAQ at  
http://www.tux.org/lkml/