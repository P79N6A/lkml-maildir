Date: Fri, 29 Jul 2005 08:12:23 +0400
From: Andrey Borzenkov <>
Subject: Re: Syncing single filesystem (slow USB writing)
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2005/7/29/2

On Friday 29 July 2005 07:50, Andrew Morton wrote:
> Andrey Borzenkov <arvidjaar@mail.ru> wrote:
> > Mandrake always mounted USB sticks with sync option; it was effectively
> > noop except for a patch that implemented limited dsync semantic.
> >
> > Now, when full sync support for FATis in kernel, moutning with sync
> > became real pain. Writing speed dropped from 3MB/s to 30KB/s in my case
> > (and I am not alone).
>
> Unfortunately I think we're just going to have to live with that.  It is
> right that fatfs behaves as it does, and unfortunate that some distros will
> operate slowly.
>
Well, I was not going to suggest killing sync support in FAT :)
> For reference: how does mandrake implement this?  Just in /etc/fstab?  How
> should we tell other people to fix this?
>
Yes, just fstab option. It has been "fixed" a couple of days ago by removing 
sync but I am going to test effect of dsync; it should behave more or less as 
before and provide at least some level of fs consistency.
> > One idea how to improve situation - continue to mount with dsync (having
> > basically old case) and do frequent sync of filesystem (this culd be
> > started as HAL callout or whatever). Unfortunately, I could not find a
> > way to request a sync (flush) of single mount point or block device. Have
> > I missed something?
>
> It's trivial to do in-kernel but no, I'm afraid there isn't a userspace
> interface for this.
Oh well, let's do it in kernel to check if it is worth hassle.
Thanks
[unhandled content-type:application/pgp-signature]