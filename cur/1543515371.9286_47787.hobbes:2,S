Date: Mon, 8 Nov 1999 21:46:05 +0100 (CET)
From: Robert de Vries <>
Subject: Re: [PATCH] POSIX timers for 2.3.25
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/1999/11/8/121

On Mon, 8 Nov 1999, Matthew Wilcox wrote:
> On Sun, Nov 07, 1999 at 06:33:43PM +0100, Robert de Vries wrote:
> > On Sun, 7 Nov 1999, Matthew Wilcox wrote:
> > 
> > > On Sun, Nov 07, 1999 at 05:59:12PM +0100, Robert de Vries wrote:
> > > > The siginfo structure is slightly changed. It moves si_value out of the
> > > > _rt part of the union. si_value is used both by _rt and _timer and must
> > > > map to the same field.
> > > 
> > > You can't do this.  You've just broken binary compatibility with any
> > > application that uses POSIX RT signals.  I can't see a nice way of doing
> > > this though.  Can anyone else?
> > 
> > IMHO, NOT doing this now gives more problems that doing it "right" at this
> > point. I must admit I am not very comfortable with this change either,
> > but I don't see any other way, which is not kludgy.
> > I'm open to suggestions. I would really not have two _sigval's in two
> > structs in the same union. But then again, is it worth breaking a few
> > apps at this point?
> 
> If this _really_ needs doing then we need a PER_NEWLINUX, change the
> kernel internal structures to the way you want, then translate the
> structures to the appropriate form for old Linux binaries whenever
> delivering a signal.  It'll be unpleasant.
This _really_ needs doing, because not only RT signals issued by sigqueue
and the timers need this sigev_value, but also signals sent by completion
of asynchronous I/O and by the arrival of a message on an empty POSIX
message queue. 
The first two are the subject of this discussion now. 
The asynchronous I/O at kernel level is curently under development at SGI
(see 
http://oss.sgi.com/projects/kaio
) and the POSIX mq_* family will need
it next.
The SGI kaio patch currently does not copy the sigev_value into the signal
structure, but that's another matter.
I don't know if there are already loads of apps using RT signals out
there. A simple recompilation would fix them anyway.
Any RT signal users out there? :-)
	Robert
-- 
Robert de Vries
rhdv@rhdv.cistron.nl
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.rutgers.edu
Please read the FAQ at 
http://www.tux.org/lkml/