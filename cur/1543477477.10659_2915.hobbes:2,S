Date: Wed, 13 Jan 1999 19:29:49 +0100
From: Jan Blunck <>
Subject: 2.2.0-pre6: matrox framebuffer broken ?
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/1999/1/13/151

I have tried to use the matroxfb (Matrox G200 Millenium 8MB SDRAM) with
my FixedFrequence Monitor HP98751A(1024x768@60Hz). I use the
sync_on_green option and translated the Modeline from X11 like explained
in the Docu.
XF86Config:
# Modeline f√ºr HP 98751A
    ModeLine "1024x768" 64.1088 1024 1088 1216 1344 768 771 775 795
+hsync -vsync
lilo.conf:
  image = /boot/vmlinuz-2.2.0-pre6
  label = linux
  append = 
 "video=matrox:noinit,nohwcursor,nopan,mem:8192k,sdram,vesa:0x105,righ
t:64,hslen:128,left:128,pixclock:15598,lower:3,vslen:4,upper:20,sync:0x21"
  root = /dev/hda3
With X11 the is no problem and everything works fine. With matroxfb the
screen scroll through vertikal. I've tried to fix it inverting the
v/hsync. It doesn't work. Now I've played around with the fbset-2 tool.
The Screen doesn't run through anymore but it's still looking terrible.
fbset output is:
mode "name"
    # D: 64.111 MHz, H: 47.701 kHz, V: 50.531 Hz
    geometry 1024 768 1024 768 8
    timings 15598 128 64 170 3 128 3
    hsync high
    gsync true
endmode
The HSYNC-Rate is ok, but the VSYNC-Rate is much too low(Should be
60Hz).The Monitor should not able to output this settings. If tested
this settings with my X11 and they don't work. 
So I think this is a bug in matroxfb. I talked to an other guy on
de.comp.os.linux.hardware and he told me that his Millenium I just
working fine, but he don't use the sync_on_green.
I've just no idea how to fix this problem. 
Jan
-- 
-------------------------------------------------------------------
Jan Blunck                            mailto:J.Blunck@tu-harburg.de
Technical       University     Hamburg-Harburg      --      Germany
PGP  Public-Key   at  
http://www.tu-harburg.de/~sejb3103/pubkey.asc
CONFIG_EXPERIMENTAL=y
CONFIG_M686=y
CONFIG_X86_WP_WORKS_OK=y
CONFIG_X86_INVLPG=y
CONFIG_X86_BSWAP=y
CONFIG_X86_POPAD_OK=y
CONFIG_X86_TSC=y
CONFIG_X86_GOOD_APIC=y
CONFIG_MTRR=y
CONFIG_MODULES=y
CONFIG_MODVERSIONS=y
CONFIG_KMOD=y
CONFIG_NET=y
CONFIG_PCI=y
CONFIG_PCI_GOANY=y
CONFIG_PCI_BIOS=y
CONFIG_PCI_DIRECT=y
CONFIG_PCI_QUIRKS=y
CONFIG_PCI_OLD_PROC=y
CONFIG_SYSVIPC=y
CONFIG_BSD_PROCESS_ACCT=y
CONFIG_SYSCTL=y
CONFIG_BINFMT_AOUT=y
CONFIG_BINFMT_ELF=y
CONFIG_BINFMT_MISC=y
CONFIG_APM=y
CONFIG_APM_POWER_OFF=y
CONFIG_PNP=y
CONFIG_BLK_DEV_FD=y
CONFIG_BLK_DEV_IDE=y
CONFIG_BLK_DEV_IDEDISK=y
CONFIG_BLK_DEV_IDEPCI=y
CONFIG_BLK_DEV_IDEDMA=y
CONFIG_IDEDMA_AUTO=y
CONFIG_BLK_DEV_LOOP=y
CONFIG_PACKET=y
CONFIG_FIREWALL=y
CONFIG_FILTER=y
CONFIG_UNIX=y
CONFIG_INET=y
CONFIG_IP_FIREWALL=y
CONFIG_IP_NOSR=y
CONFIG_SKB_LARGE=y
CONFIG_SCSI=y
CONFIG_BLK_DEV_SD=y
CONFIG_CHR_DEV_ST=y
CONFIG_BLK_DEV_SR=y
CONFIG_CHR_DEV_SG=y
CONFIG_SCSI_MULTI_LUN=y
CONFIG_SCSI_CONSTANTS=y
CONFIG_SCSI_AIC7XXX=y
CONFIG_NETDEVICES=y
CONFIG_NET_ETHERNET=y
CONFIG_NET_EISA=y
CONFIG_NE2K_PCI=y
CONFIG_VT=y
CONFIG_VT_CONSOLE=y
CONFIG_SERIAL=y
CONFIG_UNIX98_PTYS=y
CONFIG_MOUSE=y
CONFIG_PSMOUSE=y
CONFIG_RTC=y
CONFIG_QUOTA=y
CONFIG_AUTOFS_FS=y
CONFIG_FAT_FS=y
CONFIG_MSDOS_FS=y
CONFIG_VFAT_FS=y
CONFIG_ISO9660_FS=y
CONFIG_JOLIET=y
CONFIG_MINIX_FS=y
CONFIG_NTFS_FS=y
CONFIG_PROC_FS=y
CONFIG_DEVPTS_FS=y
CONFIG_EXT2_FS=y
CONFIG_NFS_FS=y
CONFIG_SUNRPC=y
CONFIG_LOCKD=y
CONFIG_SMB_FS=y
CONFIG_SMB_WIN95=y
CONFIG_SOLARIS_X86_PARTITION=y
CONFIG_NLS=y
CONFIG_NLS_CODEPAGE_437=y
CONFIG_NLS_CODEPAGE_850=y
CONFIG_NLS_CODEPAGE_852=y
CONFIG_NLS_CODEPAGE_863=y
CONFIG_NLS_CODEPAGE_865=y
CONFIG_NLS_ISO8859_1=y
CONFIG_NLS_ISO8859_15=y
CONFIG_VGA_CONSOLE=y
CONFIG_VIDEO_SELECT=y
CONFIG_FB=y
CONFIG_DUMMY_CONSOLE=y
CONFIG_VIDEO_SELECT=y
CONFIG_FB_MATROX=y
CONFIG_FB_MATROX_G100=y
CONFIG_FBCON_CFB8=y
CONFIG_FBCON_CFB16=y
CONFIG_FBCON_CFB24=y
CONFIG_FBCON_CFB32=y
CONFIG_FONT_8x8=y
CONFIG_FONT_8x16=y
CONFIG_SOUND=y
CONFIG_SOUND_OSS=y
CONFIG_SOUND_SB=y
-- Versions installed: (if some fields are empty or looks
-- unusual then possibly you have very old versions)
Linux magic.whm.tu-harburg.de 2.2.0-pre6 #5 Mon Jan 11 15:46:50 CET 1999 i686 unknown
Kernel modules         found
Gnu C                  2.7.2.3
Binutils               2.9.1.0.15
Linux C Library        2.0.7
Dynamic linker         ldd (GNU libc) 2.0.7
Linux C++ Library      2.8.0
Procps                 1.2.9
Mount                  2.8a
Net-tools              (1998-06-29)
Kbd                    0.96
Sh-utils               1.16