Date: Sun, 18 Jun 2006 17:20:54 +0100
From: Al Viro <>
Subject: Re: [PATCH 1/5]: ufs: missed brelse and wrong baseblk
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2006/6/18/132

Comment more on the entire series than on this patch: scenario that causes
trouble
	* foo is a sparse file on ufs with 8Kb block/1Kb fragment
	* process opens it writable and mmaps it shared
	* it proceeds to dirty the pages
	* fork
	* parent and child do msync() on pages next to each other
I.e. we try to write adjacent pages that sit in the same block.  At the
same time.  Each will trigger an allocation and we'd better be very
careful, or we'll end up allocating the same block twice.
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.kernel.org
More majordomo info at  
http://vger.kernel.org/majordomo-info.html
Please read the FAQ at  
http://www.tux.org/lkml/