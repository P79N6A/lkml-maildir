Date: Mon, 6 Feb 2006 21:00:33 +0100
From: Ingo Molnar <>
Subject: [patch] x86: print out early faults via early_printk()
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2006/2/6/312

lost a few hours debugging an early-bootup fault within printk itself, 
which manifested itself as a hard to debug early hang.
This patch makes it much easier by printing out early faults via 
early_printk(), which function is alot simpler than a full printk, and 
hence more likely to succeed in emergencies. (We do not recover from 
early faults anyway, so there's no loss from not having these messages 
in the normal printk buffer.)
Signed-off-by: Ingo Molnar <mingo@elte.hu>
----
 arch/i386/kernel/head.S |    4 ++++
 1 files changed, 4 insertions(+)
Index: linux/arch/i386/kernel/head.S
===================================================================
--- linux.orig/arch/i386/kernel/head.S
+++ linux/arch/i386/kernel/head.S
@@ -398,7 +398,11 @@ ignore_int:
 	pushl 32(%esp)
 	pushl 40(%esp)
 	pushl $int_msg
+#ifdef CONFIG_EARLY_PRINTK
+	call early_printk
+#else
 	call printk
+#endif
 	addl $(5*4),%esp
 	popl %ds
 	popl %es
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.kernel.org
More majordomo info at  
http://vger.kernel.org/majordomo-info.html
Please read the FAQ at  
http://www.tux.org/lkml/