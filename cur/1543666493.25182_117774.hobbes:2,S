Date: 16 Mar 2003 16:26:37 -0600
From: James Bottomley <>
Subject: Re: Complete support PC-9800 for 2.5.64-ac4 (11/11) SCSI
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2003/3/16/101

On Sun, 2003-03-16 at 14:00, Geert Uytterhoeven wrote:
> On 16 Mar 2003, James Bottomley wrote:
> > On Sun, 2003-03-16 at 12:36, Geert Uytterhoeven wrote:
> > > Actually, it was my suggestion to remove the dereference for PIO accesses. In
> > > that case SASR contains the I/O port register.
> > 
> > There's still something wrong with the implementation in this patch. 
> > For non PIO SASR is defined as volatile unsigned char *SASR.  Its access
> > has gone from being outb(n, *regs.SASR) to outb(n, regs.SASR).  What
> > expansion can outb have on m68k and MIPS that makes this change
> > idempotent?
> 
> outb() and friends are only used if CONFIG_WD33C93_PIO is set. In all other
> cases, it uses the old implementation, e.g. `*regs.SASR = reg_num'.
Ah, OK, I see what it's doing.  Instead of having a single redefine of
wd33c93_outb to be either outb or readb etc, it has a whole chunk of
code in wd33c93.c that #ifdef's for this.
Perhaps, while you're cleaning this up, you'd like to move this into the
header?  Shouldn't it also be using readb/writeb instead of just direct
memory accesses?
James
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.kernel.org
More majordomo info at  
http://vger.kernel.org/majordomo-info.html
Please read the FAQ at  
http://www.tux.org/lkml/