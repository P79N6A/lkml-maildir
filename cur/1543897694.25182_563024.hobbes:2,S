Date: Wed, 27 Jun 2007 11:52:27 -0700
From: "Ulrich Drepper" <>
Subject: Re: [patch 2/3] MAP_NOZERO - implement sys_brk2()
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2007/6/27/261

On 6/27/07, Hugh Dickins <hugh@veritas.com> wrote:
> The absolute virtual addresses are randomized, yes; but do a sequence
> of mmaps and they come back adjacent to each other, and so mergable.
> Or does your distro include a kernel patch to randomize them relative
> to each other?
Each individual mmap is supposed to be randomized, yes.  If this
doesn't happen in one of our kernels right now something broken.  You
wouldn't have effective ASLR if all relative address remain the same.
> It _might_ turn out to be more attractive, not to rely on that
> peculiar sys_remap_file_pages, but make all our vmas independent
> of protections, and hang differently protected ranges off them.
> Maybe.
That's what I think is done or at least should be done.
If you want to be shocked, look at some really big Java apps.
Hundreds or thousands of threads, lots of mmap allocation.  We might
have 10,000 VMAs.  Searching becomes a problem and if the protection
information be stored somewhere else and you safe the VMA data
structures there is even some memory saving possible.
I definitely thing that this is an area which warrants looking at.  We
haven't yet seen the worst of VMA usage.  The move to 64-bit is only
just beginning and wait what people think they can do with 48+ bits of
address space.
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.kernel.org
More majordomo info at  
http://vger.kernel.org/majordomo-info.html
Please read the FAQ at  
http://www.tux.org/lkml/