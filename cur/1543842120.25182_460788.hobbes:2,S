Date: Wed, 6 Sep 2006 09:36:19 +0200
From: Andi Kleen <>
Subject: Re: [Feature] x86_64 page tracking for Stratus servers
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2006/9/6/34

> Silly question, why can't you do all this from stop_machine_run context (or
> your SMI) that doesn't have to worry about other CPUs dirtying memory?
Because that would be too slow for continuous mirroring.
You can't go through 10+GB of virtual memory (or more with shared 
memory because the scan has to be virtual) in an interrupt.
The only sane way is to do it continuously.
> [*] Though if it gets included, it would not stop me lamenting the
> proliferation of complexities to support *tiny* obscure userbases. Can
> we wait until your hardware is smart enough to snoop the cc? :)
My guess is that if we had a generic memory mirror subsystem other people would
find uses for it too. e.g. a lot of systems support spare DIMMs these days and mirroring
some memory to it seems like a smart idea. That means normally the hardware
does it, but perhaps some stuff can be done better by doing it in software.
Or it is also a bit similar to the algorithms Xen uses for live migration.
If that was implemented on the kernel level something like this might 
be useful too. I think OpenVZ has some kind of migration support, but it's
currently not live.
-andi
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.kernel.org
More majordomo info at  
http://vger.kernel.org/majordomo-info.html
Please read the FAQ at  
http://www.tux.org/lkml/