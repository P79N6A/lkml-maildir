Date: Sat, 5 Jun 2004 12:22:39 +0200
From: Andi Kleen <>
Subject: Re: [PATCH] Use numa policy API for boot time policy
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2004/6/5/36

On Sat, 5 Jun 2004 12:32:12 +1000
Anton Blanchard <anton@samba.org> wrote:
> 
> Hi,
> 
> > That's correct. It will only work for order 0 allocations.
> > 
> > But it sounds quite bogus anyways to move the complete hash tables
> > to another node anyways. It would probably be better to use vmalloc() 
> > and a interleaving mapping for it. Then you would get the NUMA bandwidth 
> > benefit even for accessing single tables.
> 
> I posted some before and after numbers when we merged Manfreds patch,
> it would be interesting to see the same thing with your patch applied.
> 
> Im not only worried about NUMA bandwidth but keeping the amount of
> memory left in all the nodes reasonably even. Allocating all the big
> hashes on node 0 will decrease that balance.
It would be a one liner change to allow process policy interleaving 
for orders > 0 in mempolicy. But I'm not sure how useful it is, since
the granuality would be really bad.
Have you ever tried to switch to implement a vmalloc_interleave() for these
tables instead? My bet is that it will perform better.
-Andi
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.kernel.org
More majordomo info at  
http://vger.kernel.org/majordomo-info.html
Please read the FAQ at  
http://www.tux.org/lkml/