Date: Sat, 10 Jan 2009 04:56:13 +0100
From: Andi Kleen <>
Subject: [PATCH] KBUILD: Create the source symlink earlier in the objdir
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2009/1/9/535

KBUILD: Create the source symlink earlier in the objdir
It's useful to already have the source symlink in a 
objdir when one just runs make *config. Then one
can do 
mkdir obj-allyes
cd obj-allyes
make -C ../sourcedir O=$(pwd) allyesconfig
./source/scripts/config --disable debug_info
make CC=icecc -j18
without having to interrupt the make first just to
get the source symlink.
Signed-off-by: Andi Kleen <ak@linux.intel.com>
---
 Makefile |    1 +
 1 file changed, 1 insertion(+)
Index: linux-2.6.28-kbuild/Makefile
===================================================================
--- linux-2.6.28-kbuild.orig/Makefile	2009-01-07 22:16:49.000000000 +0100
+++ linux-2.6.28-kbuild/Makefile	2009-01-10 04:50:53.000000000 +0100
@@ -383,6 +383,7 @@
 # output directory.
 outputmakefile:
 ifneq ($(KBUILD_SRC),)
+	@ln -fsn $(srctree) $(objtree)/source
 	$(Q)$(CONFIG_SHELL) $(srctree)/scripts/mkmakefile \
 	    $(srctree) $(objtree) $(VERSION) $(PATCHLEVEL)
 endif