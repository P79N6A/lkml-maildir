Date: Sat, 31 Aug 2002 10:54:09 -0700
From: Andrew Morton <>
Subject: Re: [RFC] [PATCH] Include LRU in page count
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2002/8/31/58

Christian Ehrhardt wrote:
> 
> ...
> Solution: Change the PageLRU bit inside the lock. Looks like
> lru_cache_add is the only place that doesn't hold the lru lock to
> change the LRU flag and it's probably not a good idea even without
> the patch.
> 
2.4.20-pre already does that:
void lru_cache_add(struct page * page)
{
        if (!PageLRU(page)) {
                spin_lock(&pagemap_lru_lock);
                if (!TestSetPageLRU(page))
                        add_page_to_inactive_list(page);
                spin_unlock(&pagemap_lru_lock);
        }
}
there was an oopsing race with activate_page()...
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.kernel.org
More majordomo info at  
http://vger.kernel.org/majordomo-info.html
Please read the FAQ at  
http://www.tux.org/lkml/