Date: Thu, 7 Feb 2008 16:01:22 +0100
From: Ingo Molnar <>
Subject: Re: [PATCH] Document randomize_va_space and CONFIG_COMPAT_BRK (was Re: [PATCH 2/2] ASLR: add possibility for more fine-grained tweaking)
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2008/2/7/228

* Jiri Kosina <jkosina@suse.cz> wrote:
> On Thu, 7 Feb 2008, Ingo Molnar wrote:
> 
> > i'm wondering about the following detail: i guess on 64-bit x86 
> > kernels we could default to !CONFIG_COMPAT_BRK? In 1997 there was no 
> > 64-bit x86. Maybe for compat 32-bit binaries we could keep it off, 
> > but always do it for 64-bit binaries.
> 
> So what do you think is proper behavior in situation when 
> CONFIG_COMPAT_BRK=N on 64bit kernel, and 32bit-binary is loaded in 
> 32bit emulation?
> 
> We can either leave the brk as-is, but that is in contradiction to 
> user explictly specifying CONFIG_COMPAT_BRK=N. Is this what you 
> propose?
> 
> Or we can randomize brk start in such situation, but that is the 
> behavior we currently automatically have due to CONFIG_COMPAT_BRK=N, 
> so no change is needed.
thinking about it ... i think we should just keep this simple, and when 
COMPAT_BRK=y then we disable brk randomization globally. If !COMPAT_BRK 
then we do brk randomization globally as well. (and that is probably 
what users want the sysctl to do anyway - users wont necessarily know 
whether the app breakage they want to solve is due to 32-bit or 64-bit.)
	Ingo