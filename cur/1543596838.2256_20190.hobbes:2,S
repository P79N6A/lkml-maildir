Date: Mon, 9 Jul 2001 23:37:33 -0700 (PDT)
From: Andre Hedrick <>
Subject: Re: Does kernel require IDE enabled in BIOS to access HD, FS errors?
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2001/7/10/7

There appears to be a max-pio sync error.
Specifically PIO is used to setup all transfers regardless of
DMA/Multi/PIO and if that is wrong the the rest is toast.
CMD has the strangest interlace of PIO ever.
PIO can only as hast as the slowest device.
I need to think about this some more, kick me to keep me on task.
Cheers,
On Mon, 9 Jul 2001, M.H.VanLeeuwen wrote:
> Andre,
> 
> I had a chance to play a little more today, here is what I've come up with:
> 
> a. w/ hdc disable in BIOS, changing the PIO mode to 0 or 1 seems to allow the
>    system to run error free.  PIO mode 3 still has silent FS corruption issues.
> 
> b. w/ hdc enabled in BIOS, the PIO mode doesn't seem to matter. (except for speed;)
> 
> c. CONFIG_IDEDMA_PCI_AUTO affects the number of interrupts needed to complete
>    each block xfer.  With it enabled the number of IRQ's per second ~600.
>    With it disabled ~2/block or 5000-6000 per second.  I thought from the dmesg
>    output that DMA was disabled and this option should have no affect.
> 
>    > CMD646: IDE controller on PCI bus 00 dev 10
>    > CMD646: chipset revision 1
>    > CMD646: not 100% native mode: will probe irqs later
>    > CMD646: chipset revision 0x01, MultiWord DMA Limited, IRQ workaround enabled
>    > CMD646: simplex device:  DMA disabled
>    > ide0: CMD646 Bus-Master DMA disabled (BIOS)
>    > CMD646: simplex device:  DMA disabled
>    > ide1: CMD646 Bus-Master DMA disabled (BIOS)
> 
> d. CONFIG_IDEDMA_PCI_AUTO does not seem to affect the outcome of "a" or "b" above.
> 
> Martin
> 
> andre@linux-ide.org wrote:
> > 
> > Martin, you have an old beast that there are problems in how the chipset
> > was deployed.
> > How are you confirming the corruption against the various layers in the
> > kernel?
> > If you would like patches & tests to verify I will send them to you.
> > 
> > Cheers
> > 
> > --
> > Andre Hedrick
> > Linux ATA Development
> > ASL Kernel Development
> > -----------------------------------------------------------------------------
> > ASL, Inc.                                     Toll free: 1-877-ASL-3535
> > 1757 Houret Court                             Fax: 1-408-941-2071
> > Milpitas, CA 95035                            Web: www.aslab.com
> 
Andre Hedrick
Linux ATA Development
ASL Kernel Development
-----------------------------------------------------------------------------
ASL, Inc.                                     Toll free: 1-877-ASL-3535
1757 Houret Court                             Fax: 1-408-941-2071
Milpitas, CA 95035                            Web: www.aslab.com
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.kernel.org
More majordomo info at  
http://vger.kernel.org/majordomo-info.html
Please read the FAQ at  
http://www.tux.org/lkml/