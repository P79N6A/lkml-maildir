Date: Fri, 5 Feb 1999 11:40:31 +0100 (CET)
From: "Marcin 'Qrczak' Kowalczyk" <>
Subject: Re: A module bug in 2.2.1?
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/1999/2/5/47

On Thu, 4 Feb 1999, H.J. Lu wrote:
> >  If you run glibc 2.1 by any chance, the reason is /bin/sh querying some
> > of NSS databases on startup.  The NSS subsystem of glibc 2.1 tries to
> > contact nscd via a Unix socket.  As a result modprobe is being called
> > again.  This creates an infinite loop which is terminated upon memory
> > exhaustion which makes the last socket() fail and the shell continues.  As
> > the purpose of the shell is to invoke insmod on unix.o (modprobe uses
> > system() to facilitate shell expansion of entries from modules.conf), the
> > module is finally inserted and processing continues.
> > 
> >  A temporary workaround is to place an entry like
> > "un::sysinit:/sbin/insmod unix" as the first of "sysinit" type in inittab. 
> 
> That is exactly what happened. We need to find a real fix for it.
modprobe could check for shell metacharacters and handle the entry itself
if there were none, calling shell only when needed. Docs would advise not
to use metacharacters in unix's entries.
That is what make does, there for speed reasons.
--
 __("<    Marcin Kowalczyk * qrczak@knm.org.pl 
http://kki.net.pl/qrczak/
 \__/       GCS/M d- s+:-- a22 C+++>+++$ UL++>++++$ P+++ L++>++++$ E->++
  ^^                W++ N+++ o? K? w(---) O? M- V? PS-- PE++ Y? PGP->+ t
QRCZAK                  5? X- R tv-- b+>++ DI D- G+ e>++++ h! r--%>++ y-
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.rutgers.edu
Please read the FAQ at 
http://www.tux.org/lkml/