Date: Tue, 25 Jul 2006 16:37:18 -0600
From: Bjorn Helgaas <>
Subject: [PATCH] sonypi: Don't print driver version until we actually find a device
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2006/7/25/327

If we don't find any devices, we shouldn't print anything.
Signed-off-by: Bjorn Helgaas <bjorn.helgaas@hp.com>
Index: work-mm2/drivers/char/sonypi.c
===================================================================
--- work-mm2.orig/drivers/char/sonypi.c	2006-07-17 16:50:45.000000000 -0600
+++ work-mm2/drivers/char/sonypi.c	2006-07-19 16:40:34.000000000 -0600
@@ -1528,13 +1528,13 @@
 {
 	int error;
 
+	if (!dmi_check_system(sonypi_dmi_table))
+		return -ENODEV;
+
 	printk(KERN_INFO
 		"sonypi: Sony Programmable I/O Controller Driver v%s.\n",
 		SONYPI_DRIVER_VERSION);
 
-	if (!dmi_check_system(sonypi_dmi_table))
-		return -ENODEV;
-
 	error = platform_driver_register(&sonypi_driver);
 	if (error)
 		return error;
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.kernel.org
More majordomo info at  
http://vger.kernel.org/majordomo-info.html
Please read the FAQ at  
http://www.tux.org/lkml/