Date: Fri, 18 Jul 2003 06:56:29 -0700
From: Walt H <>
Subject: Re: [PATCH] pdcraid and weird IDE geometry
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2003/7/18/122

Andries Brouwer wrote:
 >
> I don't understand. Did you introduce some float? Remove it immediately.
> 
> You just replace
> 
>         lba = (ideinfo->capacity / (ideinfo->head*ideinfo->sect));
>         lba = lba * (ideinfo->head*ideinfo->sect);
>         lba = lba - ideinfo->sect;
> 
> by
> 
> 	lba = ideinfo->capacity - 63;
> 
> Then everything works for you, I suppose.
> Subsequently we wait for other people with the same hardware
> and see how the 63 varies as a function of their setup.
> (Or maybe you can go into the BIOS and specify different
> translations yourself?)
> 
> (By the way, didnt your boot parameters lead to ideinfo->head = 16
> and ideinfo->sect = 63?)
> 
> Andries
> 
> 
No, you're right. I was just trying to clarify the changes that I had
originally made. It seemed as there may have been some confusion that I
was doing more than the original. In my case, the simplified
ideinfo->capacity - ideinfo->sect should work just fine.
The boot parameters did take. The geometry was reported (correctly?) as
I had passed, but when trying to load the pdcraid module, access to the
disk failed with I/O errors. Seemed as if it was trying to read beyond
the end of the device. I used the identical geometry as reported by the
working drive.
Unfortunately, since this is the embedded FastTrak stuff, the BIOS
doesn't allow me to setup geometry for the drives.
I've just tried the simplified method and it works fine. I'll stick with
that on my end. Thanks for the help,
-Walt
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.kernel.org
More majordomo info at  
http://vger.kernel.org/majordomo-info.html
Please read the FAQ at  
http://www.tux.org/lkml/