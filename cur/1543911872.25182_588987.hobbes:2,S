Date: Mon, 27 Aug 2007 14:40:59 -0400
From: "J. Bruce Fields" <>
Subject: Re: nfs4 filesystem mounted via the "bind" option reports wrong fstype
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2007/8/27/248

On Mon, Aug 27, 2007 at 08:32:51PM +0200, Gabriel Barazer wrote:
> Hi,
> 
> A nfs4 filesystem, mounted elsewhere via the "bind" option (the usual 
> way to do with nfsv4 and its pseudofs), reports wrong fstype "nfs" 
> instead of "nfs4" filesystem.
> An example is much easier to understand :
> Server-side :
> - /exports is the pseudo root filesystem (fsid=0 option in /etc/exports)
> - /exports/data is a mountpoint for another filesystem (not the same 
> device-id as /exports). This condition seems to be what triggers the bug
> - /exports/data must be exported with the "nohide" option (again, the 
> usual way to do se with nfsv4)
> 
> Client-side :
> - mount server:/  on /imports
> - mount "bind" /imports/data on /home/data
There's no reason not to just mount server:/exports/data directly at
/home/data; the bind mounts are just a workaround for the somewhat
primitive exports facility on the server side.
> (this magically shows a second nfs mount in /proc/mounts)
> And here is the bug : this second mount is of fstype "nfs" instead of 
> "nfs4" although the options field contains "vers=4".
But, yes, that sounds like a bug, thanks.
--b.
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.kernel.org
More majordomo info at  
http://vger.kernel.org/majordomo-info.html
Please read the FAQ at  
http://www.tux.org/lkml/