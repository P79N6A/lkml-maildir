Date: Fri, 27 May 2005 17:10:19 -0500 (CDT)
From: Kumar Gala <>
Subject: [PATCH] ppc32: i8259 PIC should not be initialized if PCI is not configured
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2005/5/27/249

Trying to initialize the i8259 PIC will not work if CONFIG_PCI is
not enabled.  The kernel hangs if the initialization is tried.
Signed-off-by: Kumar Gala <kumar.gala@freescale.com>
---
commit 947c0e2c89c4e5cda2093bcfca7c13e097641e3b
tree 12a3e07d44c69f110708c359da5132439c2527c5
parent 219d058f65dbd666964b1e951b8d491e4b19dc0c
author Kumar K. Gala <kumar.gala@freescale.com> Fri, 27 May 2005 16:57:41 -0500
committer Kumar K. Gala <kumar.gala@freescale.com> Fri, 27 May 2005 16:57:41 -0500
 ppc/platforms/85xx/mpc85xx_cds_common.c |    2 ++
 1 files changed, 2 insertions(+)
Index: arch/ppc/platforms/85xx/mpc85xx_cds_common.c
===================================================================
--- 109a4648d2cc627d17c129bc1ca102a736c817aa/arch/ppc/platforms/85xx/mpc85xx_cds_common.c  (mode:100644)
+++ 12a3e07d44c69f110708c359da5132439c2527c5/arch/ppc/platforms/85xx/mpc85xx_cds_common.c  (mode:100644)
@@ -200,12 +200,14 @@
 	 */
 	openpic_init(MPC85xx_OPENPIC_IRQ_OFFSET);
 
+#ifdef CONFIG_PCI
 	openpic_hookup_cascade(PIRQ0A, "82c59 cascade", i8259_irq);
 
 	for (i = 0; i < NUM_8259_INTERRUPTS; i++)
 		irq_desc[i].handler = &i8259_pic;
 
 	i8259_init(0);
+#endif
 
 #ifdef CONFIG_CPM2
 	/* Setup CPM2 PIC */
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.kernel.org
More majordomo info at  
http://vger.kernel.org/majordomo-info.html
Please read the FAQ at  
http://www.tux.org/lkml/