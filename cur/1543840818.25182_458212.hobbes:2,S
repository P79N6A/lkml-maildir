Date: Mon, 28 Aug 2006 11:00:22 +0200
From: Martin Schwidefsky <>
Subject: Re: [PATCH 1/3] kthread: update s390 cmm driver to use kthread
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2006/8/28/68

On Fri, 2006-08-25 at 15:03 -0500, Serge E. Hallyn wrote:
> Ok, the patch in -mm does kthread_stop() on module_exit, but still uses
> the timer and cmm_thread_wait.  
Yes, the timer and cmm_thread_wait are there to implement the timed page
pool.
> I'm not clear what the timer is actually trying to do, or why there is a
> separate cmm_pages_target and cmm_timed_pages_target.  So I'm sure the
> below patch on top of -mm2 is wrong (it compiles, but I just noticed
> 2.6.18-rc4-mm2 doesn't boot without this patch either) but hopefully
> Heiko or Martin can tell me what would be the right way, or implement
> it?
Yes, it is wrong. Trying to "fix" code without understanding it is waste
of time. The while loop in the cmm_thread is supposed to continue until
the target numbers for the standard page pool and the timed page pool
have been reached. Your patch adds a schedule_timeout between every call
to cmm_alloc_pages.
-- 
blue skies,
  Martin.
Martin Schwidefsky
Linux for zSeries Development & Services
IBM Deutschland Entwicklung GmbH
"Reality continues to ruin my life." - Calvin.
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.kernel.org
More majordomo info at  
http://vger.kernel.org/majordomo-info.html
Please read the FAQ at  
http://www.tux.org/lkml/