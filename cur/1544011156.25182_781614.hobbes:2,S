Date: Wed, 17 Dec 2008 13:09:05 +0000
From: Catalin Marinas <>
Subject: Re: [PATCH 13/15] kmemleak: Keep the __init functions after initialization
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2008/12/17/189

Sam,
On Wed, 2008-12-10 at 19:44 +0100, Sam Ravnborg wrote:
> On Wed, Dec 10, 2008 at 06:28:06PM +0000, Catalin Marinas wrote:
> > This patch adds the CONFIG_DEBUG_KEEP_INIT option which preserves the
> > .init.* sections after initialization. Memory leaks happening during
> > this phase can be more easily tracked.
> 
> This patch manipulate the section names of these functions.
> The better way would be to keep the section names as they are
> and then in init.h decide where to add these sections.
> 
> This will require a new set of CONFIG_ symbols but then
> it is obvious what happens.
Thanks for your comments. I had a look at the vmlinux.lds.h file and
there are indeed better options like DEV_KEEP etc.
Anyway, I think I'll drop this patch completely. All that kmemleak needs
is actually the kernel symbols to be able to print the stack trace.
These don't seem to be removed together with the .init sections cleanup.
-- 
Catalin