Date: Wed, 9 Jan 2008 20:14:56 +0100
From: Sam Ravnborg <>
Subject: Re: Build Fails on 2.6.24-rc6-mm1[drivers/net/iseries_veth.ko] linking error
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2008/1/9/245

On Wed, Jan 09, 2008 at 03:44:04PM +0530, Sudhir Kumar wrote:
> Hi Andrew,
> Build fails on my Power Machine with following error message.
> 
> 
>  HOSTLD  arch/powerpc/boot/dtc
>  WRAP    arch/powerpc/boot/zImage.pseries
>  WRAP    arch/powerpc/boot/zImage.pmac
> strip -s -R .comment vmlinux -o arch/powerpc/boot/zImage.iseries
>  Building modules, stage 2.
>  MODPOST 264 modules
> ERROR: ".driver_add_kobj" [drivers/net/iseries_veth.ko] undefined!
> make[1]: *** [__modpost] Error 1
> make: *** [modules] Error 2
driver_add_kobj has a single user - iseries_veth. It is even documented
in the comment in the file.
And you build iseries_veth as a module but driver_add_kobj is not exported
which is why you get this modpost error.
Workaround: make the driver built-in
Fix: export driver_add_kobj or replace usage in iseries_veth.
	Sam