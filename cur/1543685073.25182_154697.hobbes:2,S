Date: 05 Aug 2003 21:23:11 +0200
From: Martin Schlemmer <>
Subject: Re: [2.6] Perl weirdness with ext3 and HTREE
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2003/8/5/228

On Tue, 2003-08-05 at 20:28, Christopher Li wrote:
> I can take a look at it.
> 
> Is there any way to reproduce this bug without installing the
> whole gentoo? It would be nice if I can just download some
> package to make it happen.
> 
I cannot really see that it is a Gentoo specific problem, but who knows.
I will try to get a CD of another distro somewhere, and get that on a
box to test - currently work/whatnot just keeps me pretty tied up :(
Another reason why I posted, is now that 2.6 is more widely used/tested,
its not only me that gets this, but other users as well - thus I hoped
that somebody with more time wanted to have a crack at it.
Back to the problem - on the same system, a 2.4 kernel works fine, but
a 2.5/6 kernel activates a race that creates an invalid entry.  I guess
the primary reason why not many people see this, is because most
non-Gentoo folk do not compile perl-5.8.0 from source.
Just grab the perl source, if you want, I can mail you the ebuild that
should give some direction in how to compile it, or grab your local
.spec, configure it (maybe with install location not in /), and then
just compile and finally install to a ext3 FS with HTREE enabled. 
Usually over here, it keeps on leaving an invalid entry to
..usr/share/man/man3/Hash::Util.tmp.
If it works fine (with a 2.6 kernel), I will go and bang my head against
a wall, and shutup until I can make time to try and track this - if not,
any ideas as to creating it outside the perl install (or rather the man
page part of the install process) would be great.
Thanks,
> Thanks,
> 
> Chris
> 
> 
> On Sat, Aug 02, 2003 at 10:37:05PM +0200, Martin Schlemmer wrote:
> > Hi
> > 
> > I have mailed about this previously, but back then it was not
> > really confirmed, so I have let it be at that.
> > 
> > Anyhow, problem is that for some reason 2.5/2.6 ext3 with HTREE
> > support do not like what perl-5.8.0 does during installation.
> > It *seems* like one of the temporary files created during manpage
> > installation do not get unlinked properly, or gets into the
> > hash (this possible?) and cause issues.
> > 
> > It seems to work flawless on 2.4 still.
> > 
> > Also, to be honest, I do not have that much free time these days,
> > so if an interest in helping me/us debug this, it will be appreciated
> > if some direction in what is needed/suggestions can be given as to what
> > is required.  There are a few users that experience this issue, and
> > I am sure that we can get whatever info needed.
> > 
> > A bug on our tracker is here with more (hopefully) complete info:
> > 
> > 
http://bugs.gentoo.org/show_bug.cgi?id=24991
> > 
> > 
> > Thanks,
> > 
> > -- 
> > 
> > Martin Schlemmer
> > 
> > 
> > 
> 
> 
-- 
Martin Schlemmer
[unhandled content-type:application/pgp-signature]