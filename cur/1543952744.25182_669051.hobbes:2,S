Date: Tue, 18 Mar 2008 11:02:39 -0700
From: "Yinghai Lu" <>
Subject: [PATCH] x86: change pci_direct_conf1 back not static
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2008/3/19/281

[PATCH] x86: change pci_direct_conf1 back not static
Glauber Costa <glommer@gmail.com> pointed out
    commit 513f484dfe5cbb53e73ef1729703e7030e799487
    x86 pci: remove checking type for mmconfig probe v2
broke the VISW.
remove the static in declaration.
Signed-off-by: Yinghai Lu <yhlu.kernel@gmail.com>
diff --git a/arch/x86/pci/direct.c b/arch/x86/pci/direct.c
index 739ce26..21d1e0e 100644
--- a/arch/x86/pci/direct.c
+++ b/arch/x86/pci/direct.c
@@ -76,7 +76,7 @@ static int pci_conf1_write(unsigned int seg, unsigned int bus,
 
 #undef PCI_CONF1_ADDRESS
 
-static struct pci_raw_ops pci_direct_conf1 = {
+struct pci_raw_ops pci_direct_conf1 = {
 	.read =		pci_conf1_read,
 	.write =	pci_conf1_write,
 };
diff --git a/arch/x86/pci/pci.h b/arch/x86/pci/pci.h
index d345661..c9fb637 100644
--- a/arch/x86/pci/pci.h
+++ b/arch/x86/pci/pci.h
@@ -95,6 +95,8 @@ struct pci_raw_ops {
 extern struct pci_raw_ops *raw_pci_ops;
 extern struct pci_raw_ops *raw_pci_ext_ops;
 
+extern struct pci_raw_ops pci_direct_conf1;
+
 extern int pci_direct_probe(void);
 extern void pci_direct_init(int type);
 extern void pci_pcbios_init(void);