Date: Sun, 9 Mar 2008 19:57:52 +0100
From: Ingo Molnar <>
Subject: Re: bisected boot regression post 2.6.25-rc3.. please revert
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2008/3/9/144

* Linus Torvalds <torvalds@linux-foundation.org> wrote:
> So I would *very* strongly instead argue:
> 
>  - "unsigned long" is the native kernel type for all address manipulation, 
>    and thus "PAGE_SIZE" and "PAGE_MASK" should continue to have that type.
> 
>  - anything that uses any other type without explicitly making sure it's 
>    safe is mis-using those macros. IOW, PAGE_MASk was *never* a type that 
>    had anything what-so-ever to do with page table entry bits, and this is 
>    purely a page table entry issue!
> 
> So my suggested patch would:
> 
>  - make the page table code use a specific mask that it builds up itself, 
>    and makes sure it's of the right type and has the rigth value in 
>    whatever type "struct pte_entry" is. The fact that "pte_val()" is 
>    larger than "unsigned long" on x86-32 is very clearly a PTE issue, 
>    *not* an issue for PAGE_SIZE or PAGE_MASK.
yeah, indeed my patch was sloppy, i didnt think it through - i fell for 
the lure of the easy-looking 'PAGE_SIZE is small, sign-extend it' hack. 
Will do it cleanly and will also clean up all the pte/address/pgprot 
type mixing that currently goes on in this maze of macros.
	Ingo