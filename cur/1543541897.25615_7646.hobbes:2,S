Date: Sun, 20 Aug 2000 03:23:02 -0300
From: Arnaldo Carvalho de Melo <>
Subject: [PATCH] drivers/char/tea6420.c: resource alloc fix
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2000/8/20/57

Linus,
	  The e-mail address of the maintainer (justdave@ynn.com) for this driver
is not working, please consider applying.
                        - Arnaldo
--- linux-2.4.0-test7-pre3/drivers/char/tea6420.c	Mon May 15 16:06:25 2000
+++ linux-2.4.0-test7-pre3.acme/drivers/char/tea6420.c	Tue Aug 15 10:47:09 2000
@@ -9,6 +9,9 @@
  * This code is placed under the terms of the GNU General Public License
  * Code liberally copied from msp3400.c, which is by Gerd Knorr
  *
+ * Changes:
+ * Arnaldo Carvalho de Melo <acme@conectiva.com.br> - 08/14/2000
+ * - resource allocation fixes in tea6300_attach
  */
 
 #include <linux/module.h>
@@ -141,8 +144,10 @@
         client->addr = addr;
 
 	client->data = tea = kmalloc(sizeof *tea,GFP_KERNEL);
-	if (!tea)
+	if (!tea) {
+		kfree(client);
 		return -ENOMEM;
+	}
 	memset(tea,0,sizeof *tea);
 	do_tea6420_init(client);
 
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.kernel.org
Please read the FAQ at 
http://www.tux.org/lkml/