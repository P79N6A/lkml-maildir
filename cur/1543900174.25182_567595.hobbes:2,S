Date: Wed, 11 Jul 2007 01:41:46 -0700 (PDT)
From: dean gaudet <>
Subject: Re: [RFT][PATCH v6] sata_mv: convert to new EH
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2007/7/11/86

On Wed, 11 Jul 2007, Jeff Garzik wrote:
> This patch is diff'd against virgin 2.6.22 kernel, and does not require
> any other patches (and indeed no other sata_mv patches should be applied
> alongside this one).
> 
> Thanks to dean's feedback (and similar feedback from Dave), I think I
> killed two key sata_mv bugs, either of which could cause the WARNING
> spew being reported.  In sum, sata_mv was not doing a good job of
> managing the software-managed request and response queue pointers.
> 
> Testing feedback with 2.6.22 + this patch would be appreciated.  It
> works on my 6041 (Gen-II) and 5081 (Gen-I).  Haven't yet tried a Gen-IIE
> chip (6042/7042-compatible).
oh interesting... with this one i still get lots of errors during boot...  
but i can conditionally hit 70MB/s+ i/o rates on one drive at a time.
see attached log for boot errors.
i went through a series like this:
1. dd if=/dev/sda of=/dev/null &
2. dd if=/dev/sdb of=/dev/null &
3. then i noticed errors in the log and i killed both those tasks
4. dd if=/dev/sdc of=/dev/null &
5. "iostat -kx /dev/sd? 5" observe 70MB/s read rate on sdc
5. kill dd from step 4
6. dd if=/dev/sdd of=/dev/null &
7. "iostat -kx /dev/sd? 5" observe 70MB/s read rate on sdd
8. kill dd from step 6
9. dd if=/dev/sdb of=/dev/null &
10. "iostat -kx /dev/sd? 5" observe 70MB/s read rate on sdb
11. kill dd from step 6
12. dd if=/dev/sdc of=/dev/null &
13. dd if=/dev/sdd of=/dev/null &
14. massive errors in the logs
it looks like doing reads on two of the drives on the 6081 causes mass
errors in the logs...
also if i use "iflag=direct" on the dd i see only ~12MB/s i/o, but that
could be entirely unrelated.
-dean[unhandled content-type:application/octet-stream]