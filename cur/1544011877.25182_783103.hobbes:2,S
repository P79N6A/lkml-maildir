Date: Sun, 21 Dec 2008 20:11:59 +0100
From: Reinhard Nissl <>
Subject: Re: PATCH: mvsas: increase port type detection delay to suit	Seagate's 15k6 drive ST3450856SS 0003
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2008/12/21/104

Hi,
Greg KH schrieb:
> On Sun, Dec 14, 2008 at 11:50:04PM +0100, Reinhard Nissl wrote:
>
>> Hi Greg,
>>
>> I hope you don't mind following your suggestion:
>>
>>> Also, please cc: the stable developers if you want them to pay attention
>>> to messages like this.
> 
> It's easier to email stable@kernel.org to make sure that I don't miss it
> :)
> 
> Is the patch below in Linus's tree?  If so, do you have a git commit id?
This time, the attached patch is against Linus' tree
(linux/kernel/git/torvalds/linux-2.6.git). I'd be glad if Andrew
would commit it so that you can pull it over to stable.
Thanks in advance.
Bye.
-- 
Dipl.-Inform. (FH) Reinhard Nissl
mailto:rnissl@gmx.de
> If not, we need to wait until it is there before we can accept it into
> the stable tree.
> 
> thanks,
> 
> greg k-h
> 
>> -------- Original-Nachricht --------
>> Betreff: Re: PATCH: mvsas: increase port type detection delay to
>> suit Seagate's 15k6 drive ST3450856SS 0003
>> Datum: Fri, 12 Dec 2008 21:23:45 +0100
>> Von: Reinhard Nissl <rnissl@gmx.de>
>> An: linux-scsi@vger.kernel.org
>> CC: Ke Wei <kewei@marvell.com>, Jeff Garzik
>> <jgarzik@redhat.com>,	James Bottomley
>> <James.Bottomley@hansenpartnership.com>
>> Referenzen: <493BC76F.3060105@gmx.de> <49405137.9000902@gmx.de>
>>
>> Hi,
>>
>> I wonder why no one has dropped me a line so far. I hope you
>> don't mind CCing you directly. I found your email addresses on
>> mailing list entries regarding mvsas. I attach the little patch
>> again for ease of use.
>>
>> Reinhard Nissl schrieb:
>>
>>> I increased the delay step by step until loading of mvsas
>>> reliably detected the drive 200 times in sequence. A much better
>>> approach would be to monitor the hardware for some flag which
>>> indicates that port detection has finished, but I do not have any
>>> hardware documentation.
>>>
>>> BTW: patch is against
>>> git://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-2.6.27.y.git
>>>
>>> Signed-off-by: Reinhard Nissl <rnissl@gmx.de>
 drivers/scsi/mvsas.c |    2 +-
 1 files changed, 1 insertions(+), 1 deletions(-)
diff --git a/drivers/scsi/mvsas.c b/drivers/scsi/mvsas.c
index 1dd70d7..23e5a87 100644
--- a/drivers/scsi/mvsas.c
+++ b/drivers/scsi/mvsas.c
@@ -2959,7 +2959,7 @@ static int __devinit mvs_hw_init(struct mvs_info *mvi)
 
 	/* enable auto port detection */
 	mw32(GBL_PORT_TYPE, MODE_AUTO_DET_EN);
-	msleep(100);
+	msleep(1100);
 	/* init and reset phys */
 	for (i = 0; i < mvi->chip->n_phy; i++) {
 		u32 lo = be32_to_cpu(*(u32 *)&mvi->sas_addr[4]);