Date: Tue, 5 Feb 2008 00:12:32 +0300
From: "Cyrill Gorcunov" <>
Subject: Re: [PATCH] x86: vmlinux_64.lds.S - use THREAD_SIZE instead of numeric constant
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2008/2/4/323

Sam, Ingo, Peter, i didn't commented it 'cause there was no comment in
32bit version. And Sam, you are so right - i spent some time on trying
to remember that 8192 bytes trick, and it seems it's not actual
anymore for 64bits cpu. As punishment for myself i'm going to shut up
for a week. Sorry for spent yours time.
On 2/4/08, H. Peter Anvin <hpa@zytor.com> wrote:
> Ingo Molnar wrote:
> > * Sam Ravnborg <sam@ravnborg.org> wrote:
> >
> >> Hi Cyrill.
> >> On Mon, Feb 04, 2008 at 08:10:37PM +0300, Cyrill Gorcunov wrote:
> >>> Signed-off-by: Cyrill Gorcunov <gorcunov@gmail.com>
> >> The patch looks simple but please explain why you do what you do. It
> >> took me some digging before I could convince mysleft this was indeed a
> >> correct change. And I am pretty sure you did the same investigation
> >> yourself.
> >>
> >> A comment like:
> >>
> >> arch/x866/kernel/inittask.c require all variables allocated in
> >> the section .data.init_task to be aligned with THREAD_SIZE.
> >>
> >> would have made me happy.
> >
> > Btw., given that on x86 we've moved away from the %esp based task stack
> > trick and use an %fs based Percpu-Data-Area (PDA) to access the current
> > task pointer, this alignment might not be necessary anymore. It's a
> > historic relic of the mask-%esp trick.
> >
>
> Was that *ever* used on x86-64?  I thought x86-64 always used %gs for this.
>
> 	-hpa
>