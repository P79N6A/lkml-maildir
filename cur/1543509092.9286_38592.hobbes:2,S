Date: Mon, 13 Sep 1999 02:14:07 GMT
From: (Edmund Bacon)
Subject: Re: version mismatch in modules
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/1999/9/12/111

On Sun, 12 Sep 1999 07:57:46 +0200, you wrote:
>Hi
>
>Just a question in between (while I am making my own first steps with
>RedHat):
>
>What about the symlinks in /boot to vmlinuz-2.2.5-15 and
>System.map-2.2.5-15?
>Did you remove them? If not, I think they won't be overwritten by "make
>bzlilo". And I had to edit /usr/src/linux/Makefile to make installpath
>/boot work (I got the sources from www.kernel.org).
>Have also a closer look to /etc/lilo.conf - kernel which will be loaded
>is vmlinuz-2.2.5-15 and not vmlinuz (which is normally done).
>
Normally, I don't use "make bzlilo" This is, in general, my
kernel upgrade process:
  - retrieve and unpack new kernel sources 
  - rename linux to linux-x.y.z and create sybolic link
  - copy old .config to new linux source directory
  - make oldconfig  and maybe make [menu|x]config if I want to make
    any other changes
  - make dep; make clean     n.b. make clean in this instance isn't
                                  really needed - but it can't hurt.
  - make bzImage
  - make modules
        If I am re-compiling a kernel version (e.g. applied a patch or
        got new hardware, at this point I 
        mv /lib/modules/x.y.z /lib/modules/x.y.z.old
  - make modules_install
  - cd /boot
  - rm vmlinuz vmlinuz.old System.map
        These are links, in my case - so be careful before you do
        this, and make sure - otherwise rename these files, or be
        be sure that you really want to delete them.
  - cp /usr/src/arch/i386/boot/bzImage vmlinuz-x.y.z
  - ln -s vmlinuz-x.y.z vmlinuz ; ln -s vmlinuz.old vmlinuz-a.b.c 
	vmlinuz-a.b.c is my current kernel
  - cp /usr/src/linux/System.map System.map-x.y.z;
  - ln -s System.map-x.y.z System.map
  - lilo
    My /etc/lilo.conf file has two entries, one for vmlinuz with the
    label 'linux', which is my default boot kernel, and one for 
    vmlinuz.old with the label 'old' that boots the current kernel. 
    That way I can get back to my current setup if I need to. So far 
    I've only needed it a couple of times when I did something really
    stupid in my config (like selecting support for ELF and a.out as
    loadable modules).
  - reboot.
It can't hurt, before rebooting to make a bootable floppy - the
simplest case is just dd if=/boot/vmlinuz of=/dev/fd0 - see the HOWTO
for more advanced boot floppys.
I tend to stay away from make install or make bzlilo.  This is because
I don't have complete confidence that its going to do what I want it
to. 
Edmund
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.rutgers.edu
Please read the FAQ at 
http://www.tux.org/lkml/