Date: Fri, 8 Dec 2006 16:34:02 +0000 (UTC)
From: "Luke Kenneth Casson Leighton" <>
Subject: parallel boot device initialisation (kernel-space not userspace)
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2006/12/8/176

hello darlings,
well i actually followed the FAQ 
http://www.tux.org/lkml/#s3-17
on this one, and got to try 'do a search' bit, and when searches
for 'parallel boot initialisation' came up with discussions about
parallel ports, and articles on ibm developerworks about sysvinit,
i made the decision to post this anyway.
I Have A Great Idea(tm) and would like to describe it concisely
to see if anyone likes it and hopefully hasn't thought of it before
so i'm not consuming people's time.
The idea is: parallel device initialisation of built-in modules, to
reduce kernel boot time.
parallel initialisation is taken care of in user-space by modifying
udev coldplug scripts to watch subsets of the /sys/class/*/event
files disappearing, and by using things like depinit, startpar for
suse, gentoo's parallel startup system (inspired by depinit)
.. but is there _anything_ like this actually in the linux kernel
itself?
i don't believe so, and the reasoning i base that on is that when
i boot my devices (be it a pc or be it an HTC smartphone device
i'm helping to reverse-engineer) the kernel startup log is always
the same, and that multiple messages coming from the same device
(printks) are always grouped together.
i realise that that's slightly faulty reasoning: it could
be that device initialisation is so regular like clockwork that
the output is always the same...
anyway.
now i have to try some things, as an experiment.  and i would
like to start with asic3 platform_device, because it contains
dynamically-created lists of child devices and so is a model
example of the kind of dependency-hierarchy that's needed.
so, i seek people's advice on this rather naive approach: simply
set up a workqueue and call schedule_work() on each of the asic3
child platform_devices.
does that sound reasonable, or is it just too simplistic?
l.
p.s. see last few lines of asic3_probe, here, where 
platform_add_devices() is called:
http://handhelds.org/cgi-bin/cvsweb.cgi/linux/kernel26/drivers/soc/asic3_base.c?rev=1.28&content-type=text/x-cvsweb-markup
p.p.s. whilst my 1.2ghz fujitsu laptop (debian/unstable) with depinit
takes only 20 seconds to get from 1st process being run (/sbin/depinit)
to xorg running, it takes ANOTHER 20 seconds to get from kernel boot
up to 1st process (/sbin/depinit) !  that's with a standard debian
kernel - hence my interest in cutting that time to ... well...
under 5 seconds would be nice.
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.kernel.org
More majordomo info at  
http://vger.kernel.org/majordomo-info.html
Please read the FAQ at  
http://www.tux.org/lkml/