Date: Sun, 6 May 2007 00:05:37 +0200
From: Andi Kleen <>
Subject: Re: [PATCH] Blacklist Dell Optiplex 320 from using the HPET
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2007/5/5/216

On Saturday 05 May 2007 21:15:01 Thomas Gleixner wrote:
> On Sat, 2007-05-05 at 19:24 +0200, Andi Kleen wrote:
> > >  	if (!is_hpet_capable())
> > > @@ -278,6 +279,14 @@ int __init hpet_enable(void)
> > >  	/* Start the counter */
> > >  	hpet_start_counter();
> > > 
> > > +	/* Verify whether hpet counter works */
> > > +	t1 = hpet_read();
> > > +	udelay(50);
> > 
> > Are you sure udelay is calibrated at this point? I didn't think so.
> > In fact it needs the external clocks and it's a chicken and egg problem.
> 
> Oops. You are right. OTOH it does not matter whether it is accurate or
> not.
It might be very short if you're very unlucky and the CPU is fast
and then trigger the check incorrectly.
-Andi
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.kernel.org
More majordomo info at  
http://vger.kernel.org/majordomo-info.html
Please read the FAQ at  
http://www.tux.org/lkml/