Date: Wed, 8 Mar 2006 14:39:52 +0300
From: Ivan Kokshaysky <>
Subject: Re: proper way to assign fixed PCI resources to a "hotplug" device
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2006/3/8/85

On Tue, Mar 07, 2006 at 09:27:23PM -0800, Greg KH wrote:
> On Wed, Mar 08, 2006 at 11:31:31AM +0900, Tejun Heo wrote:
> > So, the problem is that the chip actually disables the PCI BAR if 
> > certain switches aren't turned on and thus BIOSes are likely not to 
> > reserve mmio address for the BAR. We can turn on proper switches during 
> > driver initialization but we don't know how to wiggle the BAR into mmio 
> > address space.
> 
> Thanks for the explaination, that makes more sense.  Unfortunatly I do
> not know how to do this right now :(
> 
> Anyone with any ideas?
We have 'pci_fixup_early' stuff exactly for that sort of hardware.
IOW, just add a quirk routine that turns on desired mode of the
device and use DECLARE_PCI_FIXUP_EARLY() for it.
The new BAR will be discovered an assigned automatically then.
Ivan.
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.kernel.org
More majordomo info at  
http://vger.kernel.org/majordomo-info.html
Please read the FAQ at  
http://www.tux.org/lkml/