Date: Sun, 6 Feb 2005 22:41:45 +1100
From: Herbert Xu <>
Subject: Re: PROBLEM: 2.6.11-rc2 hangs on bridge shutdown (br0)
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2005/2/6/66

On Sat, Feb 05, 2005 at 09:45:59PM +1100, herbert wrote:
> 
> Although I still think this is a bug, I'm now starting to suspect
> that there is another bug around as well.
> 
> There is probably an ifp leak which in turn leads to a split dst
> leak that allows the first bug to make its mark.
Found it.  This is what happens:
lo goes down =>
	rt6_ifdown =>
		eth0's local address route gets deleted
eth0 goes down =>
	__ipv6_ifa_notify =>
		ip6_del_rt fails so we fall through to the
		dst_free path.  At this point the refcount
		taken by __ipv6_ifa_notify is leaked.
Cheers,
-- 
Visit Openswan at 
http://www.openswan.org/
Email: Herbert Xu 许志壬 <herbert@gondor.apana.org.au>
Home Page: 
http://gondor.apana.org.au/herbert/
PGP Key: 
http://gondor.apana.org.au/herbert/pubkey.txt
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.kernel.org
More majordomo info at  
http://vger.kernel.org/majordomo-info.html
Please read the FAQ at  
http://www.tux.org/lkml/