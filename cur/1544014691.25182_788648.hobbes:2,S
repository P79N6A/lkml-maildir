Date: Thu, 8 Jan 2009 13:28:55 +0900
From: KAMEZAWA Hiroyuki <>
Subject: Re: [RFC][PATCH 3/4] Memory controller soft limit organize cgroups
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2009/1/7/649

On Thu, 8 Jan 2009 09:55:58 +0530
Balbir Singh <balbir@linux.vnet.ibm.com> wrote:
> * KAMEZAWA Hiroyuki <kamezawa.hiroyu@jp.fujitsu.com> [2009-01-08 10:11:48]:
> > Hmm,  Could you clarify following ?
> > 
> >   - Usage of memory at insertsion and usage of memory at reclaim is different.
> >     So, this *sorted* order by RB-tree isn't the best order in general.
> 
> True, but we frequently update the tree at an interval of HZ/4.
> Updating at every page fault sounded like an overkill and building the
> entire tree at reclaim is an overkill too.
> 
"sort" is not necessary.
If this feature is implemented as background daemon,
just select the worst one at each iteration is enough.
> >     Why don't you sort this at memory-reclaim dynamically ?
> >   - Considering above, the look of RB tree can be
> > 
> >                 +30M (an amount over soft limit is 30M)
> >                 /  \
> >              -15M   +60M
> 
> We don't have elements below their soft limit in the tree
> 
> >      ?
> > 
> >     At least, pleease remove the node at uncharge() when the usage goes down.
> >
> 
> We do remove the tree if it goes under its soft limit at commit_charge,
> I thought I had the same code in uncharge(), but clearly that is
> missing. Thanks, I'll add it there.
> 
Ah, ok. I missed it. Thank you for clalification.
Regards,
-Kame