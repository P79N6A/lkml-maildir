Date: Tue, 7 Dec 1999 10:13:01 -0500 (EST)
From: Alexander Viro <>
Subject: Re: [2.3.29] Easy way to get "/ is busy" on shutdown
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/1999/12/7/56

On Tue, 7 Dec 1999, Aaron Tiensivu wrote:
> Scenario:
> 
> Root fs is on /dev/hdc1 (ext2)
> /home/win is on /dev/hda1/linuxfs (standard file on vfat partition)
> /mnt/win (/dev/hda1) is automounted by automount (just a simple 'cd /mnt/win')
> 
> Do:
> losetup /dev/loop0 /mnt/win/linuxfs
> e2fsck /dev/loop0 (just to be safe)
> mount /dev/loop0 /home/win
> 
> Then initiate shutdown and you will be greeted to "/ is busy" and a full e2fsck
> will result on next boot. :(
Most likely the userland problem, namely the order of umount(2) calls in
umount -a. Look: if you will try to umount /home before /mnt/win (if I
understood your setup right) you'll get busy on that and thus busy on /
afterwards. Try to drop into single-user and strace umount -a from there.
Watch the order of umount(2) and losetup-related ioctls.
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.rutgers.edu
Please read the FAQ at 
http://www.tux.org/lkml/