Date: Wed, 2 Nov 2005 13:46:17 +0300
From: Roman Kagan <>
Subject: Re: [PATCH]  Eagle and ADI 930 usb adsl modem driver
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2005/11/2/99

On Tue, Nov 01, 2005 at 01:04:02PM +0000, David Woodhouse wrote:
> On Tue, 2005-11-01 at 13:40 +0100, Duncan Sands wrote:
> > this code looks like a 'orrible hack to work around a common problem
> > with USB modem's of this type: if the modem is plugged in while the
> > system boots, the driver may look for firmware before the filesystem
> > holding the firmware is mounted; I guess the delay usually gives
> > the filesystem enough time to be mounted.  I'm told that the correct
> > solution is to stick the firmware in an initramfs as well. 
> 
> Why can't we request the firmware again when the device is first used,
> if it wasn't present when the driver was first loaded?
Because the firmware loading can take long, and apps may legitimately
give up opening the device after a timeout.
Besides, it doesn't look logical.  An uninitialized device is not
particularly useful for anything but initialization.  You don't create,
say, a network device for your ethernet card until you're finished with
its PCI setup, do you?
I think the async firmware loading can do the job nicely, in a generic
manner.  BTW the usbatm drivers do it already (wasn't it you who
implemented it? :), long before request_firmware_nowait() was available.
So it's only a matter of tools adjusting, which seems to be going on.
Roman.
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.kernel.org
More majordomo info at  
http://vger.kernel.org/majordomo-info.html
Please read the FAQ at  
http://www.tux.org/lkml/