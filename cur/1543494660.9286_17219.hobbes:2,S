Date: Wed, 5 May 1999 12:26:37 +0200
From: Rainer Clasen <>
Subject: Re: sym/ncr53c8xx phase error still present in 2.2.7
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/1999/5/5/83

Hi!
Shaw Carruthers (shaw@shawc.demon.co.uk),
"Re: sym/ncr53c8xx phase error still present in 2.2.7":
> I have same type of drive:
>   Vendor: IBM       Model: DDRS-34560        Rev: S92A
>   Type:   Direct-Access                      ANSI SCSI revision: 02
ok, for completeness my syslog (sorry for those reading linux-scsi, too):
kernel: sym53c8xx: setup=disc:y,specf:0,ultra:2,tags:8,sync:12,burst:7,wide:y,diff:0,rev prob:n,buschk:0x2 
kernel: sym53c8xx: setup=mpar:y,spar:y,fsn=n,verb:2,debug:0x0,led:n,settle:2,irqm:0x0,nv ram:0x1,pcifix:0x7 
kernel: sym53c8xx: at PCI bus 0, device 9, function 0 
kernel: sym53c8xx: setting PCI_COMMAND_PARITY...(fix-up) 
kernel: sym53c8xx: 53c810a detected  
kernel: sym53c810a-0: rev=0x23, base=0xe7000000, io_port=0xe400, irq=9 
kernel: sym53c810a-0: ID 7, Fast-10, Parity Checking 
kernel: sym53c810a-0: initial SCNTL3/DMODE/DCNTL/CTEST3/4/5 = (hex) 03/8e/a0/01/00/00 
kernel: sym53c810a-0: final   SCNTL3/DMODE/DCNTL/CTEST3/4/5 = (hex) 03/c0/00/00/08/00 
kernel: sym53c810a-0: resetting, command processing suspended for 2 seconds 
kernel: sym53c810a-0: restart (scsi reset). 
kernel: scsi0 : sym53c8xx - version 1.3c 
kernel: scsi : 1 host. 
kernel: sym53c810a-0: command processing resumed 
kernel:   Vendor: IBM       Model: DDRS-34560        Rev: S97B 
kernel:   Type:   Direct-Access                      ANSI SCSI revision: 02 
kernel:   Vendor: YAMAHA    Model: CDR102            Rev: 1.01 
kernel:   Type:   WORM                               ANSI SCSI revision: 02 
kernel: sym53c810a-0-<1,0>: tagged command queue depth set to 8 
kernel: Detected scsi disk sda at scsi0, channel 0, id 1, lun 0 
kernel: sym53c810a-0-<1,*>: FAST-10 SCSI 10.0 MB/s (100 ns, offset 8) 
kernel: SCSI device sda: hdwr sector= 512 bytes. Sectors= 8925000 [4357 MB] [4.4 GB] 
kernel:  sda: sda1 < sda5 > 
> I have no scsi problems or errors at all, apart from about 2hrs into my
> monthly four hour backup of all the machines on my network I get errors
> like:
> 
> Apr  3 15:42:57 shawc kernel: ncr53c860-0-<4,0>: phase change 2-3
> 6@0037ec45 resid=2. 
> Apr  3 15:42:57 shawc kernel: ncr53c860-0-<4,0>: phase change 2-7
> 10@0037ee45 resid=4. 
> Apr  3 15:42:57 shawc kernel: ncr53c860-0-<4,0>: phase change 2-7
> 10@0037e845 resid=4. 
> Apr  3 15:42:57 shawc kernel: ncr53c860-0-<4,0>: phase change 2-7
> 10@0037f045 resid=4. 
ok, so far well known. When using VFAT (with or without fat-patch-13), I
get:
kernel: Filesystem panic (dev 08:25). 
kernel:   File without EOF 
kernel:   File system has been set read-only 
kernel: FAT: fat_truncate called though fs is read-only, uhh... 
kernel: Filesystem panic (dev 08:25). 
kernel:   File without EOF 
kernel: FAT: fat_truncate called though fs is read-only, uhh... 
... and a nuked parition table.
Using ext2, I get those "phase change", too, but somehow ext2 apears to
suffer from no courruption. Note that I haven't thoroughly verified this.
I guess ext2 isn't as vulnerable as FAT and therefore is more happy with
tiny defects.
Using ext2 it usually takes longer to get the "phase change" message. FAT
seems to stress the hardware more intensively.
My testscript:
--- snip
#!/bin/sh
base=/dos/d
i=3
pids=""
trap 'kill $pids' 0
while [ "$i" -gt 0 ]; do
	while : ; do
		dd if=/dev/zero	of=$base/dd.$i
	done &
	
	pids="$pids $!"
	i=$(( $i -1 ))
	sleep 90
done
wait
--- snap
> So maybe a strange interaction between the 2.2,x scsi driver and the IBM
> disk? Or the ide tape driver fouling up the bus?
I think the later isn't the case. The former is my suspicion, too.
Rainer
-- 
KeyID=58341901 fingerprint=A5 57 04 B3 69 88 A1 FB  78 1D B5 64 E0 BF 72 EB
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.rutgers.edu
Please read the FAQ at 
http://www.tux.org/lkml/