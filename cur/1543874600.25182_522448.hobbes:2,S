Date: Wed, 21 Mar 2007 11:25:39 +0100
From: Arnd Bergmann <>
Subject: Re: [PATCH -mm 1/4] Blackfin: architecture update patch
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2007/3/21/72

On Wednesday 21 March 2007, Wu, Bryan wrote:
> @@ -97,6 +97,11 @@ static inline void leds_switch(int flag)
>  /*
>   * The idle loop on BFIN
>   */
> +#ifdef CONFIG_IDLE_L1
> +static inline void default_idle(void)__attribute__((l1_text));
> +void cpu_idle(void)__attribute__((l1_text));
> +#endif
> +
A forward declaration for an inline function seems rather pointless.
Moreover, marking default_idle both l1_text and inline seems
contradicting, right?
> diff -purN linux-2.6-orig/include/asm-blackfin/asm-offsets.h linux-2.6/include/asm-blackfin/asm-offsets.h
> --- linux-2.6-orig/include/asm-blackfin/asm-offsets.h	1970-01-01 08:00:00.000000000 +0800
> +++ linux-2.6/include/asm-blackfin/asm-offsets.h	2007-03-21 15:21:10.000000000 +0800
> @@ -0,0 +1,89 @@
> +#ifndef __ASM_OFFSETS_H__
> +#define __ASM_OFFSETS_H__
> +/*
> + * DO NOT MODIFY.
> + *
> + * This file was generated by Kbuild
This file should be in the exclude list for your diff, it is generally not
shipped with the kernel sources.
> +#ifndef __ASSEMBLY__
> +
> +static inline unsigned char readb(volatile unsigned char *addr)
> +{
The prototype for this should normally contain an __iomem.
This kind of error is normally caught by running 'make C=1'
to use the 'sparse' tool. If you have not run that yet,
you should start to, as it finds a number of common bugs.
> +/*
> + * Map some physical address range into the kernel address space.
> + */
> +static inline void *__ioremap(unsigned long physaddr, unsigned long size,
> +				int cacheflag)
> +{
> +	return (void *)physaddr;
> +}
Likewise, this should return an __iomem pointer.
The rest of the patch looks good to me.
	Arnd <><
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.kernel.org
More majordomo info at  
http://vger.kernel.org/majordomo-info.html
Please read the FAQ at  
http://www.tux.org/lkml/