Date: Wed, 21 Feb 2007 11:44:04 +0300
From: "Ananiev, Leonid I" <>
Subject: RE: [PATCH 2/2] aio: propogate post-EIOCBQUEUED errors to completion event
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2007/2/21/36

> where it returns zero 
I've wrote in the mail 
http://lkml.org/lkml/2007/2/8/337
invalidate_inode_pages2_range() reports BUG:
warning at mm/truncate.c:398  occurs becouse of
invalidate_complete_page2()    returns 0; it returns 0 because of
try_to_release_page()          returns 0; it returns 0 because of
ext3_releasepage()             returns 0; it returns 0 because of
journal_try_to_free_buffers()  returns 0; it returns 0 because of
try_to_free_buffers()          returns 0; it returns 0 because of
drop_buffers()                 returns 0; it returns 0 because of
buffer_busy(bh)                returns 1; it returns 0 because of
buffer_head count is 1 (bh->b_count==1) as additional printk reports.
Leonid
-----Original Message-----
From: Ken Chen [mailto:kenchen@google.com] 
Sent: Wednesday, February 21, 2007 11:36 AM
To: Ananiev, Leonid I
Cc: Chris Mason; Zach Brown; linux-aio@kvack.org;
linux-kernel@vger.kernel.org; Benjamin LaHaise; Suparna bhattacharya;
Andrew Morton
Subject: Re: [PATCH 2/2] aio: propogate post-EIOCBQUEUED errors to
completion event
On 2/20/07, Ananiev, Leonid <leonid.i.ananiev@intel.com> wrote:
> 1) mem=1G in kernel boot param if you have more
> 2) unmount; mk2fs; mount
> 3) dd if=/dev/zero of=<test_file> bs=1M count=1200
> 4) aiostress -s 1200m -O -o 2 -i 1 -r 16k <test_file>
> 5) if i++<50 goto 2).
Would you please instrument the call chain of
invalidate_complete_page2() and tell us exactly where it returns zero
value in your failure case?
   invalidate_complete_page2
      try_to_release_page
         ext3_releasepage
            journal_try_to_free_buffers
               ???
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.kernel.org
More majordomo info at  
http://vger.kernel.org/majordomo-info.html
Please read the FAQ at  
http://www.tux.org/lkml/