Date: Wed, 2 May 2001 23:03:57 +0200
From: Pavel Machek <>
Subject: Re: Linux Cluster using shared scsi
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2001/5/3/151

Hi!
> > > ...
> > >
> > > If told to hold a reservation, then resend your reservation request once every
> > > 2 seconds (this actually has very minimal CPU/BUS usage and isn't as big a
> > > deal as requesting a reservation every 2 seconds might sound).  The first time
> > > the reservation is refused, consider the reservation stolen by another machine
> > > and exit (or optionally, reboot).
> > 
> > Umm. Reboot? What do you think this is? Windoze?
> 
> It's the *only* way to guarantee that the drive is never touched by more than
> one machine at a time (notice, I've not been talking about a shared use drive,
> only one machine in the cluster "owns" the drive at a time, and it isn't for
> single transactions that it owns the drive, it owns the drive for as long as
> it is alive, this is a limitation of the filesystes currently available in
> mainstream kernels).  The reservation conflict and subsequent reboot also
> *only* happens when a reservation has been forcefully stolen from a
>machine. 
I do not believe reboot from kernel is right approach. Tell init with
special signal, maybe; but do not reboot forcefully. This is policy;
doing reboot might be right answer in 90% cases; that does not mean
you should do it always.
How is "reservation error" different from any other error? What if
drive generates reservation error by mistake?
I believe drive should be considered dead until reboot after
"reservation error". That way you do not damage data by default, and
provide user option with doing whatever is appropriate.
								Pavel
-- 
I'm pavel@ucw.cz. "In my country we have almost anarchy and I don't care."
Panos Katsaloulis describing me w.r.t. patents at discuss@linmodems.org
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.kernel.org
More majordomo info at  
http://vger.kernel.org/majordomo-info.html
Please read the FAQ at  
http://www.tux.org/lkml/