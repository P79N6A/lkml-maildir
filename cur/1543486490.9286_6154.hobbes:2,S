Date: Fri, 19 Feb 1999 09:07:12 +0000
From: Ilya Tsindlekht <>
Subject: Missing CDROMRESET ioctl, MAD16 configuration problem
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/1999/2/19/18

Here is message I tried to sent to this list some time ago, but it seems
that 
messages I send from Mutt to this and some other mailing list get lost.
I feel completely clueless. I'm sending it now via Netscape, which seems
to work (at least with other mailing lists).
Here is message that I some time ago, but it didn't appear on tux.org
archive,
I assume it got lost. I seem to have typed 'vgers' instead of 'vger' in
address. Aint' I a loser. cdrom.c seems not to be changed in pre-7, so
the 
patch should work.
(I don't subscribe to list right now) (Wow, how lame I must be!)
For some reason, 2.2.0 doesn't have CROMRESET ioctl. Is it intentional?
Anyway, patch against 2.2.0-pre6 included.
Some general notes:
Many thanks to those who removed busy wait from ATAPI CDROM resetting
code.
Since opening cdrom device now fails if it contains no cd (or failed to 
recognize it), eject and probably many other  CDROM programs must be
upgraded.
Change.log probably should mention it.
Applying patches from 2.2.0-pre2 to 2.2.0-pre6 was pain because of new
directory scripts/ksymoops. Probably www.linuxhq.com should instruct to
create
this directory manually (as I did) or tell which version of patch to use
if 
there exists one that handles it correctly
-----------------CUT HERE------------------------------------------
diff -u --recursive linux-2.2.0-pre6/drivers/cdrom/cdrom.c
linux/drivers/cdrom/cdrom.c
--- linux-2.2.0-pre6/drivers/cdrom/cdrom.c	Sat Jan  9 15:47:29 1999
+++ linux/drivers/cdrom/cdrom.c	Sat Jan  9 16:27:33 1999
@@ -723,6 +723,12 @@
 			return -ENOSYS;
 		return cdo->tray_move(cdi, 0);
 
+	case CDROMRESET:
+		cdinfo(CD_DO_IOCTL, "entering CDROMRESET\n"); 
+		if (!(cdo->capability & ~cdi->mask & CDC_RESET))
+			return -ENOSYS;
+		return cdo->reset(cdi);
+
 	case CDROMEJECT_SW:
 		cdinfo(CD_DO_IOCTL, "entering CDROMEJECT_SW\n"); 
 		if (!(cdo->capability & ~cdi->mask & CDC_OPEN_TRAY))
-----------------CUT HERE------------------------------------------
And here is another message that I sent to linux-sound list (does it
exist?)
With kernel 2.2.0 I was finaly able to use MIDI on my sound card (junk
called
SoundBooster)
To do so, I enabled CONFIG_MAD16_OLDCARD setting. Thanks to those who
made it
possible.
Some notes:
With this setting, driver supports MIDI interrupts 5,7,11 (see
linux/drivers/sound/mad16.c line arount line 786), but config suggests 
values 5,7,9 or 10 with default 9
I had to patch linux/drivers/sound/sb_common.c near line 862 not to MIDI
perform
interrupt check.
Apparently I must enable CONFIG_SOUND_YM3812 as well. Could config do it 
authomatically?
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.rutgers.edu
Please read the FAQ at 
http://www.tux.org/lkml/