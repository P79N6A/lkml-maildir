Date: Sun, 17 Sep 2000 15:20:17 +0200
From: Torben Mathiasen <>
Subject: Re: test9-pre1 hang when loading scsi-ide cdrom
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2000/9/17/51

On Sun, Sep 17 2000, Frank van de Pol wrote:
> On Sat, Sep 16, 2000 at 07:27:01PM +0200, Frank van de Pol wrote:
> > 
> > Just experienced a (reproducable) hang of the system when loading the
> > drivers for my cdrom drives. (ide-cd and ide-scsi). System freezes
> > completely; interupts / alt-sysreq is still working.
> > 
> > Just before the lockup I get next message on my console:
> > 
> > "
> > scsi1 : SCSI host adapter emulation for IDE ATAPI devices 
> > scsi : 2 hosts. 
> >    Vendor: E-IDE     Model: CD-ROM 36X/AKU Rev: U21I 
> >    Type:   CD-ROM
> > ANSI SCSI revision: 02 
> > Detected scsi CD-ROM sr0 at scsi1, channel 0, id 0, lun 0 
> > "
> > <lockup....>
> 
> I tried to compile the sr_mod without the __init & __exit but this did (as
> expected) to cure the problem.
> 
> The problem seems to reside in the ide-scsi driver; if the cdrom (sr_mod) is
> not loaded, I get during initialisation of the ide-scsi module a lockup
> after printing the information about the 1st host (dies after the 'Type:
> CDROM' line). Probing the 2nd host seems to fail.
>
When did this start to happen? I sustect this is something similar to what has
been happening with sd because of the module_init/exit stuff. 
Some people are seeing lockups because of the sd changes, going back to init_module
cures it. The problems is within the scsi subsystem itself.
Could you try reverting the init_sr/exit_sr to init_module/cleanup_module and
removing module_init/exit please?
-- 
Torben Mathiasen <tmm@image.dk>
Linux ThunderLAN maintainer 
http://tlan.kernel.dk
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.kernel.org
Please read the FAQ at 
http://www.tux.org/lkml/