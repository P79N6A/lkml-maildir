Date: Tue, 4 Dec 2007 01:23:01 -0800
From: Andrew Morton <>
Subject: Re: [PATCH 1/7][QUOTA] Move sysctl management code under ifdef CONFIG_SYSCTL
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2007/12/4/45

On Tue, 04 Dec 2007 11:58:30 +0300 Pavel Emelyanov <xemul@openvz.org> wrote:
> >> +#ifdef CONFIG_SYSCTL
> >>  	register_sysctl_table(sys_table);
> >> +#endif
> >> 
> >>  	dquot_cachep = kmem_cache_create("dquot",
> >>  			sizeof(struct dquot), sizeof(unsigned long) * 4,
> > 
> > We should avoid the ifdefs around the register_sysctl_table() call.
> > 
> > At present the !CONFIG_SYSCTL implementation of register_sysctl_table() is
> > a non-inlined NULL-returning stub.  All we have to do is to inline that stub
> > then these ifdefs can go away.
> 
> What if some code checks for the return value to be not-NULL? In case
> CONFIG_SYSCTL=n this code will always think, that the registration failed.
The stub function should return success?