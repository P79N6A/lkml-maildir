Date: Thu, 28 Feb 2008 09:14:12 +0100
From: Ingo Molnar <>
Subject: Re: Linux 2.6.25-rc2
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2008/2/28/64

* Andrew Morton <akpm@linux-foundation.org> wrote:
> > > incrementing the variable with a "++" when interrupts are not 
> > > disabled. It's not an atomic add and it's racy. The code within 
> > > stat() does exactly this.
> > 
> > Yes but that is only for used for statistics which can be racy. Note 
> > that the VM event statistics also can be racy.
> 
> Doing ++ on a u32 _is_ atomic wrt interrupts on x86 and probably lots 
> of other architectures, so we're OK using unsigned there. [...]
hm, why should it be atomic wrt. irqs? There's nothing that keeps gcc 
from not doing an "incl memory_address" but do something like: "load 
memory address into regx, incl regx, ... store address into memory 
address" - and that's not atomic at that point.
	Ingo