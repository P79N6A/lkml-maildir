Date: Sun, 18 Mar 2007 19:28:57 +0900
From: Tejun Heo <>
Subject: Re: [git patches] libata fixes
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2007/3/18/53

Paul Rolland wrote:
> Hello,
> 
>> Can you put the harddisk under high load and see what happens?  How
>> often do those errors occur?  Care to post full dmesg?
> 
> I started again a stock 2.6.21-rc4, and ran that :
> while (/bin/true); do tar jxf linux-2.6.19.1.tar.bz2; rm -rf linux-2.6.19.1;
> echo -n "."; done      
> 
> After several minutes (I waited more than 300 loops to be completed), and
> a lot of errors, I finally managed to see :
> Mar 18 10:32:47 riri kernel: ata1.00: NCQ disabled due to excessive errors
> 
> Mar 18 10:23:26 riri kernel:          res 40/00:58:53:6e:31/00:00:0d:00:00/40
> Emask 0x2 (HSM violation)
> Mar 18 10:25:07 riri kernel:          res 40/00:d8:db:b0:2e/00:00:0d:00:00/40
> Emask 0x2 (HSM violation)
> Mar 18 10:32:42 riri kernel:          res 40/00:c0:7b:6a:2a/00:00:0d:00:00/40
> Em
> ask 0x2 (HSM violation)
> Mar 18 10:32:47 riri kernel: ata1.00: NCQ disabled due to excessive errors
> Mar 18 10:32:47 riri kernel:          res 40/00:b8:63:0d:2d/00:00:0d:00:00/40
> Em
> ask 0x2 (HSM violation)
> 
> Is this what you were expecting ?
Yeap, more than three HSM violations in ten minutes.  That's the
criteria for turning off NCQ.  Good to see it working.  It look like a
lot because libata reports all active commands (can't help as on HSM
failure, there's no way to determine which caused it) and the SCSI
prints revalidation messages, but it's still only three errors.
Thanks for verifying that.  I wanted to verify it works in the field as
expected.
-- 
tejun
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.kernel.org
More majordomo info at  
http://vger.kernel.org/majordomo-info.html
Please read the FAQ at  
http://www.tux.org/lkml/