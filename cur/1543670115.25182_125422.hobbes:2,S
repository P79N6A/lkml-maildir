Date: Wed, 16 Apr 2003 01:17:28 +0200
From: Philippe Gramoullé <>
Subject: Re: 2.5.67-mm3: Bad: scheduling while atomic with IEEE1394 then hard freeze ( lockup on CPU0)
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2003/4/15/254

Hello,
On Tue, 15 Apr 2003 16:05:30 -0700
Andrew Morton <akpm@digeo.com> wrote:
  | Philippe Gramoullé  <philippe.gramoulle@mmania.com> wrote:
  | >
  | > 
  | > 
http://www.philou.org/2.5.67-mm3/2.5.67-mm3.log
  | 
  | This is a great bug report.  Thanks.
Well, i finally managed to get some output when i learned about the
nmi_watchdog boot option ( reading another thread about debugging hard hangs)
so i'm pleased if this report helped :)
  | 
  | The 1394 warnings are known about and I think Ben is working on it.
Ok, great. I think this is one of the latest thing that prevents me to
use 2.5.x almost full time.
  | 
  | The NMI watchdog hit is nasty:
  | 
[snip]
  | 
  | What has happened here is that you were in the middle of a kobject_get(),
  | holding spin_lock(&kobj_lock) when an interrupt came in.  The USB interrupt
  | handler comes in and ends up calling kobject_get() again.  This CPU already
  | holds the lock and blamyouredead.
  | 
  | Turning kobj_lock into an IRQ-safe lock would appear to be a sufficient fix.
I'll wait for the fix and will happily try it once it's available.
Thanks,
Philippe
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.kernel.org
More majordomo info at  
http://vger.kernel.org/majordomo-info.html
Please read the FAQ at  
http://www.tux.org/lkml/