Date: Fri, 22 Feb 2008 11:19:48 -0800
From: "Bill Huey (hui)" <>
Subject: Re: [PATCH [RT] 08/14] add a loop counter based timeout mechanism
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2008/2/22/326

On Fri, Feb 22, 2008 at 11:08 AM, Paul E. McKenney
<paulmck@linux.vnet.ibm.com> wrote:
>  One approach would be to set the RTLOCK_DELAY parameter to something like
>  -1 for default, and to set it to the number of cycles required for about
>  10 cache misses at boot time.  This would automatically scale with CPU
>  frequency and memory latency.
Yeah, I'm not very keen on having a constant there without some
contention instrumentation to see how long the spins are. It would be
better to just let it run until either task->on_cpu is off or checking
if the "current" in no longer matches the mutex owner for the runqueue
in question. At that point, you know the thread isn't running.
Spinning on something like that is just a waste of time. It's for that
reason that doing in the spin outside of a preempt critical section
isn't really needed
bill