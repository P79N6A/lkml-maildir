Date: Wed, 25 Jul 2007 15:17:43 +0300 (EEST)
From: Meelis Roos <>
Subject: [PATCH] fix ppc kernels after build-id addition
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2007/7/25/155

This patch fixes arch/ppc kernels, at least for prep subarch, after 
build-id addition. Without the patch, kernels were 3 times the size and 
bootloader refused to load them. Now they are back to normal again.
The patch is very similar to David Millers sparc patch, just applied to 
ppc architecture.
Tested only with Roland McGrath's "Use LDFLAGS_MODULE only for .ko 
links" patch applied - boots and works fine.
Signed-off-by: Meelis Roos <mroos@linux.ee>
diff --git a/arch/ppc/kernel/vmlinux.lds.S b/arch/ppc/kernel/vmlinux.lds.S
index c0aac3f..98c1212 100644
--- a/arch/ppc/kernel/vmlinux.lds.S
+++ b/arch/ppc/kernel/vmlinux.lds.S
@@ -91,6 +91,8 @@ SECTIONS
   . = ALIGN(8192);
   .data.init_task : { *(.data.init_task) }
 
+  NOTES
+
   . = ALIGN(4096);
   __init_begin = .;
   .init.text : {
-- 
Meelis Roos (mroos@linux.ee)
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.kernel.org
More majordomo info at  
http://vger.kernel.org/majordomo-info.html
Please read the FAQ at  
http://www.tux.org/lkml/