Date: Wed, 24 Jan 2007 12:37:06 +0100
From: Thomas Gleixner <>
Subject: Re: [PATCH query] arm: i.MX/MX1 clock event source
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2007/1/24/71

On Wed, 2007-01-24 at 03:00 +0100, Pavel Pisa wrote:
> stays NULL after clock event registration. Interrupts
> runs, but my code doesnot call any function. The notification
> chain and clock events list seems to be filled correctly.
> I have added 
> 
>         clockevent_imx.cpumask = cpumask_of_cpu(0);
Correct. I probably should disable the check for UP.
> to ensure that clock are not used for affinity
> mask reasons. I have tried even exchange clock 
> event forcibly at the end of clockevent_imx initialization.
> But it only resulted in asking timer to switch off
> into unused mode.
> 
> I have added next hack into IRQ
>                                 write_seqlock(&xtime_lock);
>                                 timer_tick();
>                                 write_sequnlock(&xtime_lock);
> which stays enabled until imx_set_mode() is called first time,
> The system boots after this modification, but imx_set_mode()
> is never called and there is no switch to high resolution mode.
You should not set up the timer at all. The setup of the timer happens
from the registration. 
We need to know, why the timer is not picked from the tick code in the
first place and why set_mode() is not called.
	tglx
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.kernel.org
More majordomo info at  
http://vger.kernel.org/majordomo-info.html
Please read the FAQ at  
http://www.tux.org/lkml/