Date: Sun, 07 Dec 2003 09:16:59 -0800
From: "Martin J. Bligh" <>
Subject: Re: [patch] sched-HT-2.6.0-test11-A5
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2003/12/7/65

>> i've seen a similar crash once on a 2-way (4-way) HT box, so there some
>> startup race going on most likely.
> 
> Im seeing bootup crashes every now and then on a ppc64 box too. A few
> other things Ive noticed:
ALT+sysrq+t does nothing, but NMI watchdog gives me:
-----------------------------------------
Starting migration thread for cpu 0
NMI Watchdog detected LOCKUP on CPU0, eip c011c11b, registers:
CPU:    0
EIP:    0060:[<c011c11b>]    Not tainted
EFLAGS: 00000086
EIP is at .text.lock.sched+0xee/0x243
eax: 0000000c   ebx: 00000286   ecx: f018a000   edx: c3932bc0
esi: 0000000c   edi: c3932bc0   ebp: f018bfb4   esp: f018bfac
ds: 007b   es: 007b   ss: 0068
Process migration/0 (pid: 2, threadinfo=f018a000 task=f018f330)
Stack: 00000000 00000000 f018bfec c011befe 02000000 00000020 c011bd54 00000000 
       00000000 f018f330 c0309c60 c0309c60 f018a000 f018a000 00000000 00000063 
       00000000 c0107001 f01a3fac 00000000 00000000 
Call Trace:
 [<c011befe>] migration_task+0x1aa/0x1b4
 [<c011bd54>] migration_task+0x0/0x1b4
 [<c0107001>] kernel_thread_helper+0x5/0xc
Code: 7e f8 e9 44 e6 ff ff f3 90 80 7e 04 00 7e f8 e9 6b e6 ff ff 
console shuts up ...
---------------------------------------------
 [<c011befe>] migration_task+0x1aa/0x1b4
is just after the return from complete, so I'd say we're deadlocked
on "spin_lock_irqsave(&x->wait.lock, flags);" in complete. Afraid I 
don't understand what the completion / migration stuff is attempting 
to do, so can't be more help ... I can reproduce this 100% of the 
time if you want something tried though.
M.
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.kernel.org
More majordomo info at  
http://vger.kernel.org/majordomo-info.html
Please read the FAQ at  
http://www.tux.org/lkml/