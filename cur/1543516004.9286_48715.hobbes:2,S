Date: Sat, 13 Nov 1999 11:40:01 +0100 (MET)
From: German Jose Gomez Garcia <>
Subject: SCSI timeouts when accessing a scanner
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/1999/11/13/22

	Hello,
	I have just bought an AGFA SnapScan 1236 SCSI scanner and when 
trying to run it under Linux I get the following problem.
	Everything is working fine until I try to access the scanner through 
the generic device, when I try it the system hangs up, and I get lots of 
timeouts from the scsi host0 bus0 id0 (the scanner is actually id5). The 
scanner is OK (and the SCSI setup seems to be also OK) as it works 
perfectly under windows.
	I have attached my /proc/scsi/scsi and /proc/scsi/aic7xxx/0, I have
tested it under 2.2.14pre4 and 2.3.26 (2.3.28 and 2.3.27 don't boot 
here).
	Thanks
	- german
<>-------------------------------------+-----------------------------------<>
   One O.S. to rule them all,          |  German Gomez Garcia
      One O.S. to find them.           |  german@pinon.ccu.uniovi.es
   One O.S. to bring them all          |
      and in the darkness bind them.   |  "Wur Qanar Wur Stilor Wur Kas"
<>-------------------------------------+-----------------------------------<>
Attached devices: 
Host: scsi0 Channel: 00 Id: 00 Lun: 00
  Vendor: IBM      Model: DDRS-39130D      Rev: DC1B
  Type:   Direct-Access                    ANSI SCSI revision: 02
Host: scsi0 Channel: 00 Id: 01 Lun: 00
  Vendor: IBM      Model: DDRS-34560W      Rev: S97B
  Type:   Direct-Access                    ANSI SCSI revision: 02
Host: scsi0 Channel: 00 Id: 02 Lun: 00
  Vendor: IOMEGA   Model: ZIP 100          Rev: J.03
  Type:   Direct-Access                    ANSI SCSI revision: 02
Host: scsi0 Channel: 00 Id: 03 Lun: 00
  Vendor: PIONEER  Model: CD-ROM DR-U16S   Rev: 1.01
  Type:   CD-ROM                           ANSI SCSI revision: 02
Host: scsi0 Channel: 00 Id: 04 Lun: 00
  Vendor: TEAC     Model: CD-R55S          Rev: 1.0Q
  Type:   CD-ROM                           ANSI SCSI revision: 02
Host: scsi0 Channel: 00 Id: 05 Lun: 00
  Vendor: AGFA     Model: SNAPSCAN 1236    Rev: 1.50
  Type:   Scanner                          ANSI SCSI revision: 02
>=============================================================================
Adaptec AIC7xxx driver version: 5.1.20/3.2.4
Compile Options:
  TCQ Enabled By Default : Enabled
  AIC7XXX_PROC_STATS     : Disabled
  AIC7XXX_RESET_DELAY    : 5
Adapter Configuration:
           SCSI Adapter: Adaptec AIC-7890/1 Ultra2 SCSI host adapter
                           Ultra-2 LVD/SE Wide Controller
    PCI MMAPed I/O Base: 0xfebff000
 Adapter SEEPROM Config: SEEPROM found and used.
      Adaptec SCSI BIOS: Enabled
                    IRQ: 10
                   SCBs: Active 0, Max Active 16,
                         Allocated 45, HW 32, Page 255
             Interrupts: 8445
      BIOS Control Word: 0x1886
   Adapter Control Word: 0x1c5a
   Extended Translation: Enabled
Disconnect Enable Flags: 0xffff
     Ultra Enable Flags: 0x0000
 Tag Queue Enable Flags: 0x0003
Ordered Queue Tag Flags: 0x0003
Default Tag Queue Depth: 16
    Tagged Queue By Device array for aic7xxx host instance 0:
      {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0}
    Actual queue depth per device for aic7xxx host instance 0:
      {16,16,1,1,1,1,1,1,1,1,1,1,1,1,1,1}
Statistics:
(scsi0:0:0:0)
  Device using Wide/Sync transfers at 40.0 MByte/sec, offset 15
  Transinfo settings: current(12/15/1/0), goal(10/127/1/0), user(10/127/1/0)
  Total transfers 8277 (6925 reads and 1352 writes)
(scsi0:0:1:0)
  Device using Wide/Sync transfers at 40.0 MByte/sec, offset 15
  Transinfo settings: current(12/15/1/0), goal(10/127/1/0), user(10/127/1/0)
  Total transfers 3 (3 reads and 0 writes)
(scsi0:0:2:0)
  Device using Narrow/Async transfers.
  Transinfo settings: current(0/0/0/0), goal(0/0/0/0), user(10/127/1/0)
  Total transfers 3 (3 reads and 0 writes)
(scsi0:0:3:0)
  Device using Narrow/Sync transfers at 20.0 MByte/sec, offset 16
  Transinfo settings: current(12/16/0/0), goal(10/127/0/0), user(10/127/1/0)
  Total transfers 0 (0 reads and 0 writes)
(scsi0:0:4:0)
  Device using Narrow/Sync transfers at 10.0 MByte/sec, offset 15
  Transinfo settings: current(25/15/0/0), goal(10/127/0/0), user(10/127/1/0)
  Total transfers 0 (0 reads and 0 writes)
(scsi0:0:5:0)
  Device using Narrow/Async transfers.
  Transinfo settings: current(0/0/0/0), goal(0/0/0/0), user(0/0/0/0)
  Total transfers 0 (0 reads and 0 writes)