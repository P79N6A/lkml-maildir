Date: Tue, 30 Mar 2004 16:33:27 -0800
From: Greg KH <>
Subject: Re: Unregistering interfaces
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2004/3/30/358

On Tue, Mar 30, 2004 at 06:56:27PM -0500, Alan Stern wrote:
> On Tue, 30 Mar 2004, Andrew Morton wrote:
> 
> > Greg KH <greg@kroah.com> wrote:
> > >
> > > I think we need to do this now, as it is not a correct fix, and causes
> > > more problems than good at this time.
> > 
> > But the patch was correct.  sysfs retains a pointer to the kobject, it
> > should take a ref on it?
> > 
> > >  I suggest you try to fix the oops
> > > you were seeing in either another way, or in a way that does not break
> > > other things :)
> > 
> > Didn't we demonstrate that the code which broke was already broken?  And
> > that it has other problems regardless of the kobject pinning fix, such as the
> > userpace-holding-a-file-open-wedges-khubd problem?
> > 
> > Worried that this is all heading in the wrong direction...
> 
> There are two problems to consider:
> 
>     (1) sysfs retains pointers to kobjects long after they have been
> 	unregistered because of the negative dentrys.
That is now taken care of with the patch I just sent to Linus by taking
out this patch.
>     (2) khubd blocks when removing configurations.
That was fixed by the patch from you, undoing your previous patch which
blocked.
So everyone is happy now, right?  :)
thanks,
greg k-h
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.kernel.org
More majordomo info at  
http://vger.kernel.org/majordomo-info.html
Please read the FAQ at  
http://www.tux.org/lkml/