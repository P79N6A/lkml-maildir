Date: Fri, 15 Jan 1999 22:07:27 +0000
From: Jamie Lokier <>
Subject: Scheduling/nfs? problem with 2.2.0-pre7
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/1999/1/15/206

x11amp turns on a real-time scheduling mode when run as root, so that
the music doesn't skip no matter what the computer load.  Of course, it
can do nothing about I/O load, but it reads ahead a little to make up
for that.
I was using x11amp with 2.2.0-pre4 and it worked well.
With 2.2.0-pre7, it is skipping quite regularly.
In both cases, the .mp3 files being played are on another system running
2.0.36, over a local ethernet (100base-T crossover cable).
Examining the network traffic, the skips happen when x11amp is reading
some more data from a file.  An NFS read request goes out; a reply comes
back; another request goes out; a reply comes back.  Normally, another
request goes out, but when there's a skip, the third request is delayed
by about 0.6 seconds.  Note: the response from the server is always
received very quickly, that is not the problem.
The timestamps on those packets show the NFS transactions are each
taking one or two milliseconds normally.
strace output of the primary x11amp process, which reads from the .mp3
file, shows `read' being called during a skip and approx 0.6 seconds
delay before the call returns.
The 0.6 second delay only happens with 2.2.0-pre7, not 2.2.0-pre4.
The delays seem to be triggered more often when I am typing.  I.e., I
press a key, and there is often a delay at the same time.  I may be
mistaken though -- it may be just coincidence.  Of course, key presses
often trigger other processing such as stuff being drawn on the screen
by the X server etc.  Still, it shouldn't be stalling NFS I/O.
Any ideas?
-- Jamie
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.rutgers.edu
Please read the FAQ at 
http://www.tux.org/lkml/