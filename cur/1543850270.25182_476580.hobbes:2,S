Date: Wed, 25 Oct 2006 15:48:36 -0700
From: "Brett G. Durrett" <>
Subject: Re: megaraid_sas waiting for command and then offline
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2006/10/25/214

David,
We switched to 2.6.18 (SMP) and applied the latest patches from LSI (got 
them directly from Sumant Patro).  Also, he told me to make sure "read 
ahead" was set to "off".  This seems to have reduced the frequency of 
the failures to about once per week (across 10+ machines), down from 
several times per week.
After I reported an additional failure, Sumant said they were able to 
reproduce the problems with XFS but they have not seen it with EXT3.  I 
prefer XFS but I prefer to have reliable databases even more...
I now have a couple of systems running in the new configuration and I am 
slowly migrating others to it as well.  I have not seen a failure with 
EXT3 but I statistically it would have been unlikely... I won't declare 
victory until I have more systems converted with a few weeks of reliable 
use.
Hope this helps... if anybody solves the root cause I will happily offer 
them a small gift to show my gratitude.
B-
David N. Welton wrote:
>Hi,
>
>I found someone corresponding to your name writing about a problem with
>the megaraid sas driver/hardware on the LKML:
>
>
http://lkml.org/lkml/2006/9/6/12
>
>We have a Dell (2950, running 2.6.18 #1 SMP) as well, and the way I
>managed to kill the thing dead in its tracks (symptoms basically what
>you you describe) is with smartctl:
>
>root@salgari:~# smartctl --all /dev/sda
>smartctl version 5.34 [i686-pc-linux-gnu] Copyright (C) 2002-5 Bruce Allen
>Home page is 
http://smartmontools.sourceforge.net/
>
>Device: DELL     PERC 5/i         Version: 1.00
>Device type: disk
>Local Time is: Wed Oct 25 10:14:40 2006 CEST
>Device does not support SMART
>
>Error Counter logging not supported
>
>
>Device does not support Self Test logging
>
>----
>
>[61101.681857] sd 0:2:0:0: rejecting I/O to offline device
>[61101.681944] EXT3-fs error (device sda1): ext3_readdir: directory
>#7553069 contains a hole at offset 0
>[61103.944794] sd 0:2:0:0: rejecting I/O to offline device
>[61103.944879] EXT3-fs error (device sda1): ext3_readdir: directory
>#7553069 contains a hole at offset 0
>[61104.672212] sd 0:2:0:0: rejecting I/O to offline device
>[61104.672295] EXT3-fs error (device sda1): ext3_readdir: directory
>#7553069 contains a hole at offset 0
>[61105.255981] sd 0:2:0:0: rejecting I/O to offline device
>[61105.256066] EXT3-fs error (device sda1): ext3_readdir: directory
>#7553069 contains a hole at offset 0
>
>----
>
>Dead in the water.  We suspect that in any case there are some disk
>problems, which is why we were trying to use smartctl in the first place.
>
>I was just curious if you managed to figure anything out...
>
>Thanks,
>Dave Welton
> 
>
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.kernel.org
More majordomo info at  
http://vger.kernel.org/majordomo-info.html
Please read the FAQ at  
http://www.tux.org/lkml/