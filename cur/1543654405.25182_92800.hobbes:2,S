Date: Thu, 28 Nov 2002 14:17:05 +0100 (MET)
From: Geert Uytterhoeven <>
Subject: Re: Linux v2.5.50
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2002/11/28/50

On Wed, 27 Nov 2002, Linus Torvalds wrote:
> Alan Cox <alan@lxorguk.ukuu.org.uk>:
>   o remove io related stuff from ide.c
ide_intr_lock() is used in ide-io.c (new file in 2.5.50), but it's static in
ide.c.
--- linux-2.5.50/drivers/ide/ide.c	Thu Nov 28 10:19:40 2002
+++ linux-m68k-2.5.50/drivers/ide/ide.c	Thu Nov 28 12:02:23 2002
@@ -186,7 +186,7 @@
  * ide_lock is used by the Atari code to obtain access to the IDE interrupt,
  * which is shared between several drivers.
  */
-static int	ide_intr_lock;
+int ide_intr_lock;
 #endif /* IDE_ARCH_LOCK */
 
 #ifdef CONFIG_IDEDMA_AUTO
diff -u --recursive --exclude-from=/home/geert/diff-excludes-linux --new-file ./linux-m68k-2.5.50/include/linux/ide.h testing/linux-m68k-2.5.50/include/linux/ide.h
--- linux-2.5.50/include/linux/ide.h	Thu Nov 28 10:20:12 2002
+++ linux-m68k-2.5.50/include/linux/ide.h	Thu Nov 28 12:02:01 2002
@@ -358,8 +358,10 @@
 # define ide_ack_intr(hwif) (1)
 #endif
 
+#ifdef IDE_ARCH_LOCK
 /* Currently only Atari needs it */
-#ifndef IDE_ARCH_LOCK
+extern int ide_intr_lock;
+#else
 # define ide_release_lock(lock)			do {} while (0)
 # define ide_get_lock(lock, hdlr, data)		do {} while (0)
 #endif /* IDE_ARCH_LOCK */
Gr{oetje,eeting}s,
						Geert
--
Geert Uytterhoeven -- There's lots of Linux beyond ia32 -- geert@linux-m68k.org
In personal conversations with technical people, I call myself a hacker. But
when I'm talking to journalists I just say "programmer" or something like that.
							    -- Linus Torvalds
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.kernel.org
More majordomo info at  
http://vger.kernel.org/majordomo-info.html
Please read the FAQ at  
http://www.tux.org/lkml/