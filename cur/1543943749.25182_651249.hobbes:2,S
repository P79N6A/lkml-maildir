Date: Sun, 10 Feb 2008 15:26:26 +0000
From: Pavel Machek <>
Subject: Re: [PATCH][7/8] kgdb: exclusive use kgdb8250 uart I/O driver
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2008/2/10/161

Hi!
> This patch some small hooks into the normal serial core so that a uart
> can be unregistered to be exclusively used for KGDB.  These changes
> allow for registering and unregistering a port with a struct
> uart_port. From that point on KGDB does raw accesses to the serial
> IO ports it has taken over.
> 
> CC: linux-serial@vger.kernel.org
> Signed-off-by: Jason Wessel <jason.wessel@windriver.com>
> Signed-off-by: Jan Kiszka <jan.kiszka@web.de>
> Signed-off-by: Ingo Molnar <mingo@elte.hu>
> Signed-off-by: Thomas Gleixner <tglx@linutronix.de>
> ---
>  Documentation/DocBook/kgdb.tmpl |   44 ++++
>  drivers/serial/8250.c           |   30 +++
>  drivers/serial/8250_kgdb.c      |  489 +++++++++++++++++++++++++++++++++++++++
>  drivers/serial/Kconfig          |    2 +-
>  drivers/serial/Makefile         |    1 +
>  drivers/serial/serial_core.c    |   18 ++-
>  include/linux/serial_8250.h     |    2 +
>  lib/Kconfig.kgdb                |   21 ++
>  8 files changed, 603 insertions(+), 4 deletions(-)
>  create mode 100644 drivers/serial/8250_kgdb.c
> 
> diff --git a/Documentation/DocBook/kgdb.tmpl b/Documentation/DocBook/kgdb.tmpl
> index c423411..111a2a0 100644
> --- a/Documentation/DocBook/kgdb.tmpl
> +++ b/Documentation/DocBook/kgdb.tmpl
> @@ -92,6 +92,50 @@
>    <chapter id="BootingTheKernel">
>      <title>Booting the kernel</title>
>      <para>
> +    The Kernel command line option <constant>kgdbwait</constant> makes kgdb
> +    wait for gdb connection during booting of a kernel.  If the
> +    <symbol>CONFIG_KGDB_8250</symbol> driver is used (or if applicable,
> +    another serial driver) this breakpoint will happen very early on, before
> +    console output.
> +    </para>
I believe we already have command line options listed in different
file... and in readable format, too.
> --- /dev/null
> +++ b/drivers/serial/8250_kgdb.c
> @@ -0,0 +1,489 @@
> +/*
> + * 8250 serial I/O driver for KGDB.
> + *
> + * This is a merging of many different drivers, and all of the people have
> + * had an impact in some form or another:
> + *
> + * 2004-2005 (c) MontaVista Software, Inc.
> + * 2005-2006 (c) Wind River Systems, Inc.
Hmm, is it WindRiver or
           WinDriver? :-)
-- 
(english) 
http://www.livejournal.com/~pavelmachek
(cesky, pictures) 
http://atrey.karlin.mff.cuni.cz/~pavel/picture/horses/blog.html