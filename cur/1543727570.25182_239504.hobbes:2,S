Date: Fri, 6 Aug 2004 09:58:35 -0700 (PDT)
From: Linus Torvalds <>
Subject: Re: Possible dcache BUG
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2004/8/6/177

On Fri, 6 Aug 2004, Gene Heskett wrote:
> 
> Linus, Andrew, should I apply this patch too at the next remake?
Might be worth it, but it's more important to see any oops at all, or lack 
of oopses..
> FWIW, I'm still up (20:38) this morning, and showing plenty (127+ 
> megs) of free memory.  No crash, no odd log (other than samba 
> squawking about some option thats been changed & I haven't fixed the 
> smb.conf) so far.
> 
> I'm beginning to like this test patch, Linus, thanks :)
If the only thing you have done is add the list_del_init() debugging 
patch, then the only thing that has changed is really the access patterns 
to uncached memory.
The original list_del_init() tries to only do a few single _writes_ to the 
dentries around it. The added debugging will do _reads_ (and thus bring it 
into the cache) of the dentry pointers of the dentries around it.
If that change makes a real difference, I really only see two 
possibilities:
 - there really is a prefetch bug (or possibly, there's a bug in our 
   prefetch fixup code, and the known prefetch bug just triggers the 
   problem indirectly)
 - it just changes the timing enough that whatever bug you hit went away.
Now, Chris Shoemaker reported dentry problems on a intel CPU and said that 
wli had seen something too, but I'm wondering whether Chris and wli might 
have been seeing the knfsd/xfs-related dentry bug that I found yesterday.  
So I think the prefetch theory is still alive, but we should check with 
Chris. Chris?
		Linus
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.kernel.org
More majordomo info at  
http://vger.kernel.org/majordomo-info.html
Please read the FAQ at  
http://www.tux.org/lkml/