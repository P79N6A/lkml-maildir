Date: Wed, 7 Jan 2004 17:15:09 +0100 (CET)
From: Andrzej Krzysztofowicz <>
Subject: Re: Linux 2.4.25-pre4
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2004/1/7/142

Sorry for previous bogus messge.
> --- linux-2.4/drivers/scsi/Config.in.orig	Tue Jan  6 18:11:10 2004
> +++ linux-2.4/drivers/scsi/Config.in	Tue Jan  6 18:23:29 2004
> @@ -66,8 +66,13 @@
>  dep_tristate 'AdvanSys SCSI support' CONFIG_SCSI_ADVANSYS $CONFIG_SCSI
>  dep_tristate 'Always IN2000 SCSI support' CONFIG_SCSI_IN2000 $CONFIG_SCSI
>  dep_tristate 'AM53/79C974 PCI SCSI support' CONFIG_SCSI_AM53C974 $CONFIG_SCSI $CONFIG_PCI
> -dep_tristate 'AMI MegaRAID support' CONFIG_SCSI_MEGARAID $CONFIG_SCSI
> -dep_tristate 'AMI MegaRAID2 support' CONFIG_SCSI_MEGARAID2 $CONFIG_SCSI
> +
> +if [ "$CONFIG_SCSI_MEGARAID2" == "n" -o "$CONFIG_SCSI_MEGARAID2" == "" ]; then
> +  dep_tristate 'AMI MegaRAID support' CONFIG_SCSI_MEGARAID $CONFIG_SCSI
> +fi
> +if [ "$CONFIG_SCSI_MEGARAID" == "n" -o "$CONFIG_SCSI_MEGARAID" == "" ]; then
> +  dep_tristate 'AMI MegaRAID2 support' CONFIG_SCSI_MEGARAID2 $CONFIG_SCSI
> +fi
> 
>  dep_tristate 'BusLogic SCSI support' CONFIG_SCSI_BUSLOGIC $CONFIG_SCSI
>  if [ "$CONFIG_SCSI_BUSLOGIC" != "n" ]; then
This way you disallow using both as modules.
2.4 config language generally does not support back references, so it is
safer to do sth like this:
dep_tristate 'AMI MegaRAID support' CONFIG_SCSI_MEGARAID $CONFIG_SCSI
if [ "$CONFIG_SCSI_MEGARAID" = "m" ]  
   define_tristate CONFIG_SCSI_MEGARAID2_DEP m
else
   define_tristate CONFIG_SCSI_MEGARAID2_DEP y
fi
if [ "$CONFIG_SCSI_MEGARAID" != "y" ]
   dep_tristate 'AMI MegaRAID2 support' CONFIG_SCSI_MEGARAID2 $CONFIG_SCSI_MEGARAID2_DEP $CONFIG_SCSI
fi
Using the same variable name in many interactive definitions breaks xconfig.
-- 
=======================================================================
  Andrzej M. Krzysztofowicz               ankry@mif.pg.gda.pl
  phone (48)(58) 347 14 61
Faculty of Applied Phys. & Math.,   Gdansk University of Technology
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.kernel.org
More majordomo info at  
http://vger.kernel.org/majordomo-info.html
Please read the FAQ at  
http://www.tux.org/lkml/