Date: Mon, 22 Oct 2007 18:14:47 -0600
From: Latchesar Ionkov <>
Subject: [PATCH] 9p: v9fs_vfs_rename incorrect clunk order
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2007/10/22/363

In v9fs_vfs_rename function labels don't match the fids that are clunked.
The correct clunk order is clunking newdirfid first and then olddirfid next.
Signed-off-by: Latchesar Ionkov <lucho@ionkov.net>
---
commit 0c9269a1384273b7a409a2163fdf91cd39092889
tree 8a4984196ccb7ed027c086a53866e5582835e61f
parent 55b70a0300b873c0ec7ea6e33752af56f41250ce
author Latchesar Ionkov <lucho@ionkov.net> Mon, 22 Oct 2007 18:11:19 -0600
committer Latchesar Ionkov <lucho@ionkov.net> Mon, 22 Oct 2007 18:11:19 -0600
 fs/9p/vfs_inode.c |    4 ++--
 1 files changed, 2 insertions(+), 2 deletions(-)
diff --git a/fs/9p/vfs_inode.c b/fs/9p/vfs_inode.c
index 175b4d9..23581bc 100644
--- a/fs/9p/vfs_inode.c
+++ b/fs/9p/vfs_inode.c
@@ -687,10 +687,10 @@ v9fs_vfs_rename(struct inode *old_dir, struct dentry *old_dentry,
 	retval = p9_client_wstat(oldfid, &wstat);
 
 clunk_newdir:
-	p9_client_clunk(olddirfid);
+	p9_client_clunk(newdirfid);
 
 clunk_olddir:
-	p9_client_clunk(newdirfid);
+	p9_client_clunk(olddirfid);
 
 done:
 	return retval;
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.kernel.org
More majordomo info at  
http://vger.kernel.org/majordomo-info.html
Please read the FAQ at  
http://www.tux.org/lkml/