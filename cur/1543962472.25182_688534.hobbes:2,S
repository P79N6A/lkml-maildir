Date: Fri, 2 May 2008 19:09:22 +0100
From: Al Viro <>
Subject: [git pull] more vfs patches
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2008/5/2/344

	Sanitizing files_struct handling (all internals taken from file.h
to fdtable.h, which is pulled by few files that need it, a bunch of places
in arch/* switched to saner ways of doing things that do not need to know
about low-level stuff, perfmon abuses of files_struct fixed along with
a huge pile of races).  Sanitized anon_inode_getfd() - the API had been
inherently racy.  Dealt with the fallout of making OPEN_NR a sysctl.
	Please, pull from
git://git.kernel.org/pub/scm/linux/kernel/git/viro/vfs-2.6.git/ for-linus
Shortlog:
Al Viro (6):
      fix file and descriptor handling in perfmon
      remove horrors with irix tty ioctls handling
      make osf_select() use core_sys_select()
      split linux/file.h
      sanitize anon_inode_getfd()
      fix sysctl_nr_open bugs
Diffstat:
 arch/alpha/kernel/osf_sys.c                  |   69 +---------
 arch/ia64/kernel/perfmon.c                   |  199 +++++++++++---------------
 arch/mips/kernel/irixioctl.c                 |   55 ++------
 arch/mips/kernel/kspd.c                      |    1 +
 arch/powerpc/platforms/cell/spufs/coredump.c |    1 +
 drivers/char/tty_audit.c                     |    1 +
 drivers/char/tty_io.c                        |    1 +
 fs/anon_inodes.c                             |   13 +--
 fs/compat.c                                  |    1 +
 fs/dnotify.c                                 |    2 +-
 fs/eventfd.c                                 |   15 +--
 fs/eventpoll.c                               |   23 +--
 fs/exec.c                                    |    1 +
 fs/fcntl.c                                   |    1 +
 fs/file.c                                    |   23 +++-
 fs/file_table.c                              |    1 +
 fs/locks.c                                   |    1 +
 fs/open.c                                    |    1 +
 fs/proc/array.c                              |    1 +
 fs/proc/base.c                               |    1 +
 fs/select.c                                  |    3 +-
 fs/signalfd.c                                |   17 +--
 fs/timerfd.c                                 |   11 +-
 include/linux/anon_inodes.h                  |    3 +-
 include/linux/fdtable.h                      |   99 +++++++++++++
 include/linux/file.h                         |   86 +-----------
 include/linux/init_task.h                    |    2 +-
 include/linux/poll.h                         |    2 +
 kernel/exit.c                                |    1 +
 kernel/fork.c                                |    1 +
 kernel/kmod.c                                |    1 +
 security/selinux/hooks.c                     |    1 +
 virt/kvm/kvm_main.c                          |   21 +--
 33 files changed, 273 insertions(+), 386 deletions(-)
 create mode 100644 include/linux/fdtable.h