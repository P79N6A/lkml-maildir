Date: Mon, 06 Dec 1999 21:51:30 +0100
From: Manfred Spraul <>
Subject: Re: [patch] Re: setitimer lowlatency-2.2.13-A1 questions
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/1999/12/6/135

Andrea Arcangeli wrote:
> 
> >
> >Is there a special reason why do_bottom_half() calls __sti() and __cli()
> >directly? This seems wrong, what about using the normal
> >__save_flags()/__sti()/__restore_flags()?
> 
> The irq handler case by design doesn't need it. You must enter there with
> irq disabled and you must exit with irq disabled (so you must enabled
> and disable by hand before and after running the bhs).
> 
> For the ret to userspace case it could decrease a bit the bh latency but
> it seems not a big issue, as right now a ret from syscall will act like
> while returning from an irq after the bottom half path.
> 
I know that it's safe:
* "real interrupts" need it.
* schedule() calls "spin_lock_irq()" immediately after returning from
do_bottom_half().
* interrupts are cleared during IRET.
But nevertheless I think that it's ugly that a function sometimes (even
worse: rarely) disables interrupts: What if a cpu doesn't reenable
interrupts during return to user space? do_bottom_half() is not
architecture specific.
--
	Manfred
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.rutgers.edu
Please read the FAQ at 
http://www.tux.org/lkml/