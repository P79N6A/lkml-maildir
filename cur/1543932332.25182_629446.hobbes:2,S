Date: Tue, 18 Dec 2007 02:58:55 -0800
From: Harvey Harrison <>
Subject: [PATCH] x86: Use helper in fault_64.c
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2007/12/18/70

Use the fixup_exception() helper in fault_64.c
Signed-off-by: Harvey Harrison <harvey.harrison@gmail.com>
---
This is only appropriate if CONFIG_PNP_BIOS cannot be set on
X86_64, which looks to be the case, but needs confirmation.
 arch/x86/mm/fault_64.c |    5 +----
 1 files changed, 1 insertions(+), 4 deletions(-)
diff --git a/arch/x86/mm/fault_64.c b/arch/x86/mm/fault_64.c
index 121c7bd..3a94941 100644
--- a/arch/x86/mm/fault_64.c
+++ b/arch/x86/mm/fault_64.c
@@ -298,7 +298,6 @@ asmlinkage void __kprobes do_page_fault(struct pt_regs *regs,
 	struct mm_struct *mm;
 	struct vm_area_struct * vma;
 	unsigned long address;
-	const struct exception_table_entry *fixup;
 	int write, fault;
 	unsigned long flags;
 	siginfo_t info;
@@ -508,9 +507,7 @@ bad_area_nosemaphore:
 no_context:
 	
 	/* Are we prepared to handle this kernel fault?  */
-	fixup = search_exception_tables(regs->ip);
-	if (fixup) {
-		regs->ip = fixup->fixup;
+	if (fixup_exception(regs)) {
 		return;
 	}
 
-- 
1.5.4.rc0.1143.g1a8a