Date: Fri, 4 Jun 1999 14:31:58 +0200 (CEST)
From: Rik van Riel <>
Subject: Re: TCP/PPP bug 2.3.5?
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/1999/6/4/45

On Fri, 4 Jun 1999, John Hayward-Warburton wrote:
> What happens is that, after a few hours or days of uptime,
> outgoing connections with large amounts of data stall, though
> other connections continue OK.
I've made a tcpdump of the event...
I was running an rsync-over-ssh to copy a relatively
large file over my 33.6 PPP line to a remote site.
After the last tcpdump line, just _nothing_ happens,
I can start other connections and use those just fine,
but this one seems to never revive.
A noteworthy fact is that there's about 48kb in the
outgoing queue for this connection while the window
size is just 31kb. It shouldn't have anything to do
with it, but it just might be one of those obscure
bugs only those knowledgable of the TCP stack will be
able to find...
------>
14:22:53.198054 212.238.108.69.1021 > 131.211.28.48.ssh: P 3475899824:3475901284(1460) ack 2964794846 win 32120 (DF) [tos 0x8]
14:22:54.073368 212.238.108.69.1020 > 131.211.28.48.ssh: S 3605554267:3605554267(0) win 32120 <mss 1460,sackOK,timestamp 6530583 0,nop,wscale 0> (DF)
14:22:54.227775 131.211.28.48.ssh > 212.238.108.69.1020: S 3836831987:3836831987(0) ack 3605554268 win 32736 <mss 1460>
14:22:54.231002 212.238.108.69.1020 > 131.211.28.48.ssh: . ack 1 win 32120 (DF)
14:22:54.447775 131.211.28.48.ssh > 212.238.108.69.1020: P 1:16(15) ack 1 win 32736 (DF) [tos 0x10]
14:22:54.448465 212.238.108.69.1020 > 131.211.28.48.ssh: . ack 16 win 32105 (DF) [tos 0x10]
14:22:54.451888 212.238.108.69.1020 > 131.211.28.48.ssh: P 1:16(15) ack 16 win 32120 (DF) [tos 0x10]
14:22:54.587775 131.211.28.48.ssh > 212.238.108.69.1020: . ack 16 win 32736 (DF) [tos 0x10]
14:22:54.667775 131.211.28.48.ssh > 212.238.108.69.1020: P 16:292(276) ack 16 win 32736 (DF) [tos 0x10]
14:22:54.698032 212.238.108.69.1020 > 131.211.28.48.ssh: . ack 292 win 32120 (DF) [tos 0x10]
14:22:54.759845 212.238.108.69.1020 > 131.211.28.48.ssh: P 16:172(156) ack 292 win 32120 (DF) [tos 0x10]
14:22:54.957775 131.211.28.48.ssh > 212.238.108.69.1020: . ack 172 win 32736 (DF) [tos 0x10]
14:22:56.837775 131.211.28.48.ssh > 212.238.108.69.1020: P 292:304(12) ack 172 win 32736 (DF) [tos 0x10]
14:22:56.841966 212.238.108.69.1020 > 131.211.28.48.ssh: P 172:192(20) ack 304 win 32120 (DF) [tos 0x10]
14:22:56.977775 131.211.28.48.ssh > 212.238.108.69.1020: . ack 192 win 32736 (DF) [tos 0x10]
14:22:57.097775 131.211.28.48.ssh > 212.238.108.69.1020: P 304:316(12) ack 192 win 32736 (DF) [tos 0x10]
14:22:57.117177 212.238.108.69.1020 > 131.211.28.48.ssh: P 192:348(156) ack 316 win 32120 (DF) [tos 0x10]
14:22:57.307775 131.211.28.48.ssh > 212.238.108.69.1020: . ack 348 win 32736 (DF) [tos 0x10]
14:22:57.397775 131.211.28.48.ssh > 212.238.108.69.1020: P 316:448(132) ack 348 win 32736 (DF) [tos 0x10]
14:22:57.397775 131.211.28.48.ssh > 212.238.108.69.1020: P 448:460(12) ack 348 win 32736 (DF) [tos 0x10]
14:22:57.418057 212.238.108.69.1020 > 131.211.28.48.ssh: . ack 460 win 32120 (DF) [tos 0x10]
14:22:57.432653 212.238.108.69.1020 > 131.211.28.48.ssh: P 348:488(140) ack 460 win 32120 (DF) [tos 0x10]
14:22:57.607775 131.211.28.48.ssh > 212.238.108.69.1020: . ack 488 win 32736 (DF) [tos 0x10]
14:22:57.697775 131.211.28.48.ssh > 212.238.108.69.1020: P 460:600(140) ack 488 win 32736 (DF) [tos 0x10]
14:22:57.718055 212.238.108.69.1020 > 131.211.28.48.ssh: . ack 600 win 32120 (DF) [tos 0x10]
14:22:58.055537 212.238.108.69.1020 > 131.211.28.48.ssh: P 488:516(28) ack 600 win 32120 (DF) [tos 0x10]
14:22:58.207775 131.211.28.48.ssh > 212.238.108.69.1020: P 600:644(44) ack 516 win 32736 (DF) [tos 0x10]
14:22:58.217775 131.211.28.48.ssh > 212.238.108.69.1020: P 644:656(12) ack 516 win 32736 (DF) [tos 0x10]
14:22:58.228101 212.238.108.69.1020 > 131.211.28.48.ssh: . ack 656 win 32120 (DF) [tos 0x8]
14:22:58.231532 212.238.108.69.1020 > 131.211.28.48.ssh: P 516:552(36) ack 656 win 32120 (DF) [tos 0x8]
14:22:58.407775 131.211.28.48.ssh > 212.238.108.69.1020: . ack 552 win 32736 (DF) [tos 0x8]
14:22:58.408614 212.238.108.69.1020 > 131.211.28.48.ssh: P 552:592(40) ack 656 win 32120 (DF) [tos 0x8]
14:22:58.557775 131.211.28.48.ssh > 212.238.108.69.1020: . ack 592 win 32736 (DF) [tos 0x8]
14:22:58.597775 131.211.28.48.ssh > 212.238.108.69.1020: P 656:684(28) ack 592 win 32736 (DF) [tos 0x8]
14:22:58.606899 212.238.108.69.1020 > 131.211.28.48.ssh: P 592:652(60) ack 684 win 32120 (DF) [tos 0x8]
14:22:58.757775 131.211.28.48.ssh > 212.238.108.69.1020: . ack 652 win 32736 (DF) [tos 0x8]
14:22:58.787775 131.211.28.48.ssh > 212.238.108.69.1020: P 684:720(36) ack 652 win 32736 (DF) [tos 0x8]
14:22:58.792965 212.238.108.69.1020 > 131.211.28.48.ssh: P 652:672(20) ack 720 win 32120 (DF) [tos 0x8]
14:22:58.814091 212.238.108.69.1020 > 131.211.28.48.ssh: P 672:2132(1460) ack 720 win 32120 (DF) [tos 0x8]
14:22:58.816429 212.238.108.69.1020 > 131.211.28.48.ssh: P 2132:3592(1460) ack 720 win 32120 (DF) [tos 0x8]
14:22:58.818714 212.238.108.69.1020 > 131.211.28.48.ssh: P 3592:4868(1276) ack 720 win 32120 (DF) [tos 0x8]
14:22:58.835126 212.238.108.69.1020 > 131.211.28.48.ssh: P 4868:6328(1460) ack 720 win 32120 (DF) [tos 0x8]
14:22:58.927775 131.211.28.48.ssh > 212.238.108.69.1020: . ack 672 win 32736 (DF) [tos 0x8]
14:22:59.162259 212.238.108.69.1020 > 131.211.28.48.ssh: P 4868:6328(1460) ack 720 win 32120 (DF) [tos 0x8]
14:22:59.164083 212.238.108.69.1020 > 131.211.28.48.ssh: P 6328:7788(1460) ack 720 win 32120 (DF) [tos 0x8]
14:22:59.165803 212.238.108.69.1020 > 131.211.28.48.ssh: P 7788:8984(1196) ack 720 win 32120 (DF) [tos 0x8]
14:22:59.167020 212.238.108.69.1020 > 131.211.28.48.ssh: P 8984:10444(1460) ack 720 win 32120 (DF) [tos 0x8]
14:22:59.507907 212.238.108.69.1020 > 131.211.28.48.ssh: P 8984:10444(1460) ack 720 win 32120 (DF) [tos 0x8]
14:22:59.509829 212.238.108.69.1020 > 131.211.28.48.ssh: P 10444:11904(1460) ack 720 win 32120 (DF) [tos 0x8]
14:22:59.511488 212.238.108.69.1020 > 131.211.28.48.ssh: P 11904:13100(1196) ack 720 win 32120 (DF) [tos 0x8]
14:22:59.512457 212.238.108.69.1020 > 131.211.28.48.ssh: P 13100:14560(1460) ack 720 win 32120 (DF) [tos 0x8]
14:22:59.854396 212.238.108.69.1020 > 131.211.28.48.ssh: P 13100:14560(1460) ack 720 win 32120 (DF) [tos 0x8]
14:22:59.856731 212.238.108.69.1020 > 131.211.28.48.ssh: P 14560:16020(1460) ack 720 win 32120 (DF) [tos 0x8]
14:22:59.858572 212.238.108.69.1020 > 131.211.28.48.ssh: P 16020:17480(1460) ack 720 win 32120 (DF) [tos 0x8]
14:22:59.859285 212.238.108.69.1020 > 131.211.28.48.ssh: P 672:2132(1460) ack 720 win 32120 (DF) [tos 0x8]
14:23:00.201588 212.238.108.69.1020 > 131.211.28.48.ssh: P 672:2132(1460) ack 720 win 32120 (DF) [tos 0x8]
14:23:00.203947 212.238.108.69.1020 > 131.211.28.48.ssh: P 672:2132(1460) ack 720 win 32120 (DF) [tos 0x8]
14:23:01.048120 212.238.108.69.1020 > 131.211.28.48.ssh: P 672:2132(1460) ack 720 win 32120 (DF) [tos 0x8]
14:23:03.608110 212.238.108.69.1020 > 131.211.28.48.ssh: P 672:2132(1460) ack 720 win 32120 (DF) [tos 0x8]
14:23:08.728083 212.238.108.69.1020 > 131.211.28.48.ssh: P 672:2132(1460) ack 720 win 32120 (DF) [tos 0x8]
14:23:18.968055 212.238.108.69.1020 > 131.211.28.48.ssh: P 672:2132(1460) ack 720 win 32120 (DF) [tos 0x8]
14:23:19.417775 131.211.28.48.ssh > 212.238.108.69.1020: . ack 2132 win 32736 (DF) [tos 0x8]
14:23:19.418799 212.238.108.69.1020 > 131.211.28.48.ssh: P 2132:3592(1460) ack 720 win 32120 (DF) [tos 0x8]
14:23:19.421514 212.238.108.69.1020 > 131.211.28.48.ssh: P 3592:4868(1276) ack 720 win 32120 (DF) [tos 0x8]
14:23:36.958135 212.238.108.69.1023 > 131.211.28.48.ssh: P 3347918817:3347920277(1460) ack 3822570676 win 32120 (DF) [tos 0x8]
14:23:39.898224 212.238.108.69.1020 > 131.211.28.48.ssh: P 2132:3592(1460) ack 720 win 32120 (DF) [tos 0x8]
14:24:20.858073 212.238.108.69.1020 > 131.211.28.48.ssh: P 2132:3592(1460) ack 720 win 32120 (DF) [tos 0x8]
14:24:23.478110 212.238.108.69.1022 > 131.211.28.48.ssh: P 3444612959:3444614419(1460) ack 2360318254 win 32120 (DF) [tos 0x8]
<-----
Since this bug _really_ kills my internet connectivity,
as far as uploading or sending large messages goes, I
really hope somebody will find the bug soon...
Rik -- Open Source: you deserve to be in control of your data.
+-------------------------------------------------------------------+
| Le Reseau netwerksystemen BV:               
http://www.reseau.nl/
 |
| Linux Memory Management site:   
http://www.linux.eu.org/Linux-MM/
 |
| Nederlandse Linux documentatie:          
http://www.nl.linux.org/
 |
+-------------------------------------------------------------------+
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.rutgers.edu
Please read the FAQ at 
http://www.tux.org/lkml/