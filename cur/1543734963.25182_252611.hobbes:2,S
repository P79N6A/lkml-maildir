Date: Wed, 15 Sep 2004 16:51:34 +0100
From: Ian Campbell <>
Subject: Re: [2.6.8.1/x86] The kernel is _always_ compiled with -msoft-float
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2004/9/15/155

On Wed, 2004-09-15 at 16:35, Tonnerre wrote:
> On Wed, Sep 15, 2004 at 02:14:18AM +0600, Denis Zaitsev wrote:
> > Why this kernel is always compiled with the FP emulation for x86?
> > This is the line from the beginning of arch/i386/Makefile:
> > 
> > CFLAGS += -pipe -msoft-float
> > 
> > And it's hardcoded, it does not depend on CONFIG_MATH_EMULATION.  So,
> > is this just a typo or not?
[snip]
> Thus  we force gcc  to use  the library  functions for  floating point
> arith, and  since we  don't link  against gcc's lib,  FPU users  get a
> fancy linker error.
It's a shame that gcc doesn't have -mno-float which could disable
floating point completely and produce a more useful error message than a
missing symbol at link time
I searched for ages just yesterday for the "float" in some kernel code I
acquired recently... To be fair I was grepping for float and it was a
double that was being used so if I'd had my brain turned on I would have
found it quite quickly, but you get the point.
Has anyone ever suggested such a flag to the gcc folks?
Ian.
-- 
Ian Campbell
Current Noise: Megadeth - Pyschotron
Mind your own business, Spock.  I'm sick of your halfbreed interference.
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.kernel.org
More majordomo info at  
http://vger.kernel.org/majordomo-info.html
Please read the FAQ at  
http://www.tux.org/lkml/