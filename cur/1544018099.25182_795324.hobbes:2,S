Date: Wed, 21 Jan 2009 10:29:01 +0100
From: Kövesdi György <>
Subject: 2.6.28(.1) and netlink: scheduling while atomic
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2009/1/21/81

Hi,
The new netlink interface allows to add NAT directly to a conntrack entry.
If it is used when the moudule nf-nat-ipv4 is not loaded in, it results in 
crash:
BUG: scheduling while atomic
It is in the kernels 2.6.28 and 2.6.28.1 in the function 
ctnetlink_parse_nat_setup(): it calls request_module() which causes the 
problem. If the module is already loaded, then there is no problem.
Regards:
K. Gy.