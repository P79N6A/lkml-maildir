Date: Sat, 18 Mar 2000 02:13:16 -0700 (MST)
From: Craig Kulesa <>
Subject: Unfreed kernel buffers (fsck and 2.3.99-pre*)
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2000/3/18/222

Summary:
       After running fsck, a large block of kernel "buffer"
       memory (seen in /proc/meminfo or 'free') is allocated in 2.3.99.
       This large block of RAM is _not_ freed under memory stress, and
       induces very heavy paging. A reboot seems necessary to recover.
System has 32 MB, i586, SCSI disk on VLB. Kernel config is available here:
http://loke.as.arizona.edu/~ckulesa/syrinx-config
This system performed an fsck (version 1.15) on the root filesystem at
boot time. Afterwards, a large block of RAM was allocated as kernel
buffers:
             total       used       free     shared    buffers     cached
Mem:         30364      29564        800          0      12416       8084
-/+ buffers/cache:       9064      21300
Swap:        32764        328      32436
After loading Netscape, gimp, and emacs --  putting the system under
substantial memory load, this block of buffer memory _was never
deallocated_, causing intensive swapping and a very high system load:
             total       used       free     shared    buffers     cached
Mem:         30364      29480        884          0      12176       8188
-/+ buffers/cache:       9116      21248
Swap:        32764      17400      15364
This behavior after fsck is reliably reproducible on several machines
that were tested, running 2.3.99-pre1 or pre2-3.  System performance was
only recovered by rebooting. 
Any ideas?  Patches? :)
Many thanks,
Craig Kulesa
ckulesa@as.arizona.edu
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.rutgers.edu
Please read the FAQ at 
http://www.tux.org/lkml/