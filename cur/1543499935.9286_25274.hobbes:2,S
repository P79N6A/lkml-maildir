Date: Mon, 21 Jun 1999 14:24:58 -0400 (EDT)
From: Jeremy Katz <>
Subject: Re: ext2fs corruption on 2.3.7
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/1999/6/21/134

On Mon, 21 Jun 1999, Ingo Molnar wrote:
> On Mon, 21 Jun 1999, Jeremy Katz wrote:
> 
> > I think that some file system corruption still exists in 2.3.7.  I copied
> > over the quake2 pak0.pak from my p200 running 2.3.6 to my dual pIII 450
> > running 2.3.7 and am getting different md5sums between the file on the two
> > machines.  I have tested the copy via both ftp and nfs with the same end
> > result (though the md5sum on the 2.3.7 system was different each time).  
> > 
> > Unfortunately, I haven't the _slightest_ idea of where to start looking
> > for the problem, but I'm willing to test patches or even take a look at it
> > myself if someone can point me in the right direction.
> 
> I've attached my latest pagecache fixes, it fixedsa (rare) data corruption
> bug, and also contains fixes for the swap oopses reported earlier today.
> Does this fix your problem?
Well, swap wasn't oops'ing on me before, but it does now. So, I disabled
my swap to test the actual copying stuff. On the positive side, it appears
that the file corruption isn't occuring anymore... I was able to get it
consistently transferring this file before, but I've copied it
successfully over ftp now.  A copy across NFS still appears to corrupt the
file.
Now trying to reproduce the oops so I can run it through ksymsoops causes
no problems, both swaps are added fine.  It appears that the oops only
occurs when swap is activated on boot.  ksymsoops follows:
EFLAGS: 00010006
eax: c02897c0   ebx: 000007e1   ecx: ffffffff   edx: 00000001
esi: 0000fc30   edi: c02897f0   ebp: 00000202   esp: cfe2ff70
ds: 0018        es: 0018        ss: 0018
Process initlog (pid: 6, process nr: 7, stackpage=cfe2f000)
Stack: 00000000 c008fce0 fffffff0 c013715b 00000001 0804edb0 cfc3e000 c00837c8
       00000287 c0137dc4 cfc3e000 cfc2e000 000001f4 0804eda8 bffffa4c c06f2198
       cfe2e000 cfc3e000 c00837c0 00000001 c0109fb8 0804eda8 00000001 000001f4
Call Trace: [<c013715b>] [<c0137dc4>] [<c0109fb8>]
Code: f0 0f bb 1a 19 c0 85 c0 74 3b 8b 54 24 10 f7 da 31 f2 89 d0
Trace: c013715b <free_wait+cb/dc>
Trace: c0137dc4 <sys_poll+15c/1a8>
Trace: c0109fb8 <system_call+34/38>
Code:  00000000 Before first symbol            00000000 <_IP>: <===
Code:  00000000 Before first symbol               0:    f0 0f bb 1a             lock btcl %ebx,(%edx) <===
Code:  00000004 Before first symbol               4:    19 c0                   sbbl   %eax,%eax
Code:  00000006 Before first symbol               6:    85 c0                   testl  %eax,%eax
Code:  00000008 Before first symbol               8:    74 3b                   je      00000045 Before first symbol
Code:  0000000a Before first symbol               a:    8b 54 24 10             movl   0x10(%esp,1),%edx
Code:  0000000e Before first symbol               e:    f7 da                   negl   %edx
Code:  00000010 Before first symbol              10:    31 f2                   xorl   %esi,%edx
Code:  00000012 Before first symbol              12:    89 d0                   movl   %edx,%eax
Jeremy
-- 
Jeremy Katz
http://linuxpower.org
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.rutgers.edu
Please read the FAQ at 
http://www.tux.org/lkml/