Date: Mon, 18 Nov 2002 09:05:34 -0600
From: "J.E.J. Bottomley" <>
Subject: Re: scsi in 2.5.48
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2002/11/18/129

akpm@digeo.com said:
> > Andrew Morton wrote:
> 
> > Appears to be DOA.  Just a simple mke2fs hangs in get_request_wait().
> This makes it work again. 
That can't be entirely right, because we can't exit the request function with 
pending requests and something like an unplugged queue to start them.  It will 
work for the adaptec because the prep defer is caused by the huge queue depth 
running us out of command blocks, so the queues would get re-run by a 
returning command.  If the failure were caused by zero outstanding commands, 
this would hang the system forever.
axboe@suse.de said:
> Right fix would be something ala: 
That looks about right.  On returning I/O we need to unplug and restart.
However, with regard to Andrew's problem, how can the queue plug indefinitely? 
 I thought it was guaranteed to be unplugged and run eventually?
James
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.kernel.org
More majordomo info at  
http://vger.kernel.org/majordomo-info.html
Please read the FAQ at  
http://www.tux.org/lkml/