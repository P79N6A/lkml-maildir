Date: 25 Apr 2001 18:09:07 GMT
From: Jason McMullan <>
Subject: Re: SCSI-Multipath driver for 2.4?
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2001/4/25/32

Doug Ledford <dledford@redhat.com> wrote:
> When we reviewed the code, we didn't like it all that much.  It served it's
> purpose on the t3 stuff from Sun, but it wasn't generic enough to suit our
> tastes.
	True, but the MD layer in 2.2.x (at least as of last June, 
when I wrote the T3 SCSI-Alias-Chain failover code) was poorly documented, 
race-prone, and nasty. :^)  My _first_ attempt at multipath was with
the MD layer, but the 2.2.x code was just way too hairy for it to
work by the deadlines Sun had on us.
	So I went into the SCSI block handling layer. Only one
major race I had to avoid, and got the final implementation written 
in a week.
> (for instance, there
> are horribly stupid devices out there that support what is called
> "Active-Passive" multipath, where if you write to the passive path, it makes
> the active path error out, which makes the device 100% useless for
> multi-initiator, shared SCSI/FC environments, and makes the device total junk
> in my opinion, but if we are going to support them in a Multipath setup, then
> the multipath driver has to be modified so it doesn't attempt to touch passive
> paths until the active path has already failed, which it doesn't currently
> attempt to do when writing superblocks or reading partition tables).
	Interestingly enough, that is exactly the type of hardware that
the SCSI Alias Chains patch is designed to support - the Sun T3, IBM Shark,
etc. Nasty, evil critters, but supported. I do wish you the best of luck
with the MD layer version, since that's where it should have gone in
the first place.... If the MD layer had been up to snuff. ];^)
-- 
Jason McMullan, Senior Linux Consultant
Linuxcare, Inc. 412.432.6457 tel, 412.656.3519 cell
jmcmullan@linuxcare.com, 
http://www.linuxcare.com/
Linuxcare. Putting open source to work.
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.kernel.org
More majordomo info at  
http://vger.kernel.org/majordomo-info.html
Please read the FAQ at  
http://www.tux.org/lkml/