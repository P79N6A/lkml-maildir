Date: Fri, 10 Sep 2004 13:53:57 -0700
From: "David S. Miller" <>
Subject: Re: TG3 doesn't work in kernel 2.4.27 (David S. Miller)
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2004/9/10/263

On Fri, 10 Sep 2004 13:35:14 +0100
Brian Somers <brian.somers@sun.com> wrote:
> The problem seems to be that autoneg is disabled on the IBM switches.
> After disabling autoneg on the Sun shelf switches, I see the problem.
> This patch fixes things by reverting to sw autoneg which defaults to
> a 1000Mbps/full-duplex link but with no flow control when it fails
> (IBM should really have autoneg enabled!) - I'd appreciate it if
> someone could test this against an IBM blade.
Did you see the fix I posted the other day and have
already merged upstream?
The real problem was the MAC_STATUS register checking in
tg3_timer() that we use to determine if we should call
the PHY code.  Specifically, we were failing to test
MAC_STATUS_SIGNAL_DET being set, which when trying to
bring the link up means we should call tg3_setup_phy().
There are still some nagging problems with certain blades even
with my current code.  Brian, if you want to help I'd really
appreciate it if you worked with current tg3 sources as I rewrote
the 5704 hw autoneg support from scratch since it was missing
a hw bug workaround and had other issues as well.
Thanks.
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.kernel.org
More majordomo info at  
http://vger.kernel.org/majordomo-info.html
Please read the FAQ at  
http://www.tux.org/lkml/