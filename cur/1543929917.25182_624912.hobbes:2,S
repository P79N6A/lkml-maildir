Date: Thu, 6 Dec 2007 11:11:12 +0100
From: Ingo Molnar <>
Subject: Re: [patch-early-RFC 00/10] LTTng architecture dependent instrumentation
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2007/12/6/61

hi Mathieu,
* Mathieu Desnoyers <mathieu.desnoyers@polymtl.ca> wrote:
> Hi,
> 
> Here is the architecture dependent instrumentation for LTTng. [...]
A fundamental observation about markers, and i raised this point many 
many months ago already, so it might sound repetitive, but i'm unsure 
wether it's addressed. Documentation/markers.txt still says:
| * Purpose of markers
|
| A marker placed in code provides a hook to call a function (probe) 
| that you can provide at runtime. A marker can be "on" (a probe is 
| connected to it) or "off" (no probe is attached). When a marker is 
| "off" it has no effect, except for adding a tiny time penalty 
| (checking a condition for a branch) and space penalty (adding a few 
| bytes for the function call at the end of the instrumented function 
| and adds a data structure in a separate section).
could you please eliminate the checking of the flag, and insert a pure 
NOP sequence by default (no extra branches), which is then patched in 
with a function call instruction sequence, when the trace point is 
turned on? (on architectures that have code patching infrastructure - 
such as x86)
	Ingo