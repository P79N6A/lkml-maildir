Date: Thu, 23 Oct 2003 18:22:36 +0200
From: Daniel Phillips <>
Subject: Re: [PATCH] ide write barrier support
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2003/10/23/87

On Tuesday 21 October 2003 07:40, Jens Axboe wrote:
> On Tue, Oct 21 2003, Daniel Phillips wrote:
> > Maybe what you're saying is, there are only two ways to deal with IDE
> > drives with non-disablable writeback cache:
> >
> >   1) flush the cache on every write
> >   2) Implement write barriers, add them to all the journalling
> > filesystems, and flush only on the write barrier
> >
> > and (1) is just too slow.  Correct?
>
> Yes, that is exactly what I'm saying. It's not just that, though.
> Completely disabling write back caching on IDE drives totally kills
> performance typically, they are just not meant to be driven this way.
OK, this is still experimental development in the middle of the stability 
freeze in order to fix a performance bug, but that's a tradition anyway so 
let me join in.
I'm specifically interested in working out the issues related to stacked 
virtual devices, and there are many.  Let me start with an easy one.
Consider a multipath virtual device that is doing load balancing and wants to 
handle write barriers efficiently, not just allow the downstream queues to 
drain before allowing new writes.  This device wants to send a write barrier 
to each of the downstream devices, however, we have only one write request to 
carry the barrier bit.  How do you recommend handling this situation?
Regards,
Daniel
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.kernel.org
More majordomo info at  
http://vger.kernel.org/majordomo-info.html
Please read the FAQ at  
http://www.tux.org/lkml/