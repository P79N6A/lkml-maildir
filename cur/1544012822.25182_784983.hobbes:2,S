Date: Tue, 30 Dec 2008 06:42:57 +0100
From: Ingo Molnar <>
Subject: Re: [PATCH] futex: add WARN_ON to catch certain assymetric (get|put)_futex_key calls
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2008/12/30/3

* Darren Hart <dvhltc@us.ibm.com> wrote:
> Following up on my previous key reference accounting patches, this patch
> will catch puts on keys that haven't been "got".  This won't catch nested
> get/put mismatches though.
> 
> Build and boot tested, with minimal desktop activity and a run of the
> open_posix_testsuite in LTP for testing.  No warnings logged.
> 
> Signed-off-by: Darren Hart <dvhltc@us.ibm.com>
> Cc: "Peter Zijlstra" <peterz@infradead.org>
> Cc: "Thomas Gleixner" <tglx@linutronix.de>
> Cc: "Rusty Russell" <rusty@au1.ibm.com>
> ---
> 
>  kernel/futex.c |    5 ++++-
>  1 files changed, 4 insertions(+), 1 deletions(-)
applied to tip/core/futexes, thanks!
I changed this:
> +		WARN_ON(1);
>  		return;
to WARN_ON_ONCE() - warning once per bootup is good enough for 
kerneloops.org to pick it up, while a ton of warnings add no extra (other 
than to inconvenience the user, or even make the system unworkable).
	Ingo