Date: Thu, 17 Jul 2003 17:36:25 +0200 (MEST)
From: Geert Uytterhoeven <>
Subject: Re: Fix IDE initialization when we don't probe for interrupts.
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2003/7/17/140

On Wed, 9 Jul 2003, Linus Torvalds wrote:
> On Wed, 9 Jul 2003, Jeff Garzik wrote:
> > I'm curious where interrupts are re-enabled, though?
> 
> The low-level drivers seem to do it at every IO. Don't ask me why. But it 
> gets done automatically by any code that does
> 
> 	hwif->OUTB(drive->ctl, IDE_CONTROL_REG);
> 
> which is pretty common (just grep for "IDE_CONTROL_REG" and you'll see 
> what I mean).
> 
> I note that I should have made this "disable irq" be dependent on 
> IDE_CONTROL_REG being non-zero. Although I don't see when that register 
> _can_ be zero, it would be a major bummer not to have access to the 
> control register.
> 
> (Obviously it must be zero for some architecture, though, or those
> conditionals woulnd't make sense. Alan?  Bartlomiej? What kind of sick
> pseudo-IDE controller doesn't have a control register?).
IDE can live without the control register (what do you _really_ need it for?).
Hence some hardware doesn't provide it, by leaving out the second bank of 8 IDE
registers.
Another trick is the `IDE doubler' for Amiga (but I guess you can make it work
on any IDE interface): with a few diodes you can map the second bank of 8 IDE
registers to a second IDE chain, doubling the number of devices you can
attach.
Gr{oetje,eeting}s,
						Geert
--
Geert Uytterhoeven -- There's lots of Linux beyond ia32 -- geert@linux-m68k.org
In personal conversations with technical people, I call myself a hacker. But
when I'm talking to journalists I just say "programmer" or something like that.
							    -- Linus Torvalds
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.kernel.org
More majordomo info at  
http://vger.kernel.org/majordomo-info.html
Please read the FAQ at  
http://www.tux.org/lkml/