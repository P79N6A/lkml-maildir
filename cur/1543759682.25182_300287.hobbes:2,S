Date: Mon, 07 Mar 2005 03:07:17 +0100
From: Christian Schmid <>
Subject: Re: BUG: Slowdown on 3000 socket-machines tracked down
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2005/3/6/171

> I have a tool that can also generate TCP traffic on a large number of
> sockets.  If I can understand what you are trying to do, I may be able
> to reproduce the problem.  My biggest machine at present has only
> 2GB of RAM, however...not sure if that matters or not.
But if the problem is what I think it is, you should get the problem by doing the following.
Best use 2.6.11 since the problem got even worse there compared to 2.6.10.
Create a server on one machine. This server should wait for incoming sockets and when they come, 
just send out bytes ("x" or whatever, it just doesn't matter) to that sockets. Please use a 
send-buffer of 64 kbytes.
On the other machine you just create clients, which connect to the server and read the data. They 
just need to read them, nothing more. Please limit the reading to once per 300 ms, so they only read 
around 200 kb/sec each. Then watch your traffic as you create more sockets. When you reach 2000 
sockets on 2.6.11, it should slow down more and more. You should see the same like me on the 
attached graph.
First one 2.6.11, second one 2.6.10
Chris
[image]