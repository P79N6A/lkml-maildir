Date: Tue, 28 Dec 2004 19:49:25 -0800
From: "David S. Miller" <>
Subject: Re: [sunrpc] remove xdr_kmap()
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2004/12/28/163

On Tue, 28 Dec 2004 18:09:38 -0800
William Lee Irwin III <wli@holomorphy.com> wrote:
> On Tue, 28 Dec 2004 15:04:16 -0800 William Lee Irwin III <wli@holomorphy.com> wrote:
> >> In this process, I stumbled over a blatant kmap() deadlock in
> >> xdr_kmap(), which fortunately is never called.
> 
> On Tue, Dec 28, 2004 at 05:12:46PM -0800, David S. Miller wrote:
> > This got zapped by a cleanup patch by Adrian Bunk which
> > I applied yesterdat.  Linus just hasn't pulled from my
> > tree yet.
> 
> Sounds good. I only missed it because it was in the middle of a
> larger set of changes. Now I just have to find where in nfs the
> missing flush_dcache_page() calls need to be so I can boot 2.6
> on a bunch of boxen.
I remember adding the calls ages ago, wonder what happened.
I see a bunch of memclear_highpage_flush() calls, but flush_dcache_page()
calls.  I guess these are done at the sunrpc/xdr layer.
There is a flush_dcache_page() call for xdr_partial_copy_from_skb()
but calls are also needed in _copy_to_pages() and
_shift_data_right_pages().  The rest which access pages are copying
from pages, not into them, so those should be ok.
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.kernel.org
More majordomo info at  
http://vger.kernel.org/majordomo-info.html
Please read the FAQ at  
http://www.tux.org/lkml/