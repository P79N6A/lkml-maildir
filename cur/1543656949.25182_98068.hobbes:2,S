Date: Mon, 23 Dec 2002 13:03:49 +0100
From: Tomas Szepe <>
Subject: Re: Read this and be ashamed ;) or: Awfull performance loss since 2.4.18 to 2.4.21-pre2
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2002/12/23/33

> 2.4.18
> 2147483648 bytes transferred in 119.140681 seconds (18024772 bytes/sec)
>
> 2.4.19
> 2147483648 bytes transferred in 140.305836 seconds (15305733 bytes/sec)
Well I'm getting the numbers the other way round. <g>
Machine:
$ egrep 'model name|MHz' /proc/cpuinfo
model name      : AMD Athlon(tm) processor
cpu MHz         : 996.037
$ grep MemTotal /proc/meminfo
MemTotal:       516588 kB
$ egrep 'Bridge|DMA rate' /proc/ide/via
South Bridge:                       VIA vt82c686b
Highest DMA rate:                   UDMA100
$ cat /proc/ide/ide0/hda/model
ST380021A
$ su -c 'hdparm -Iv /dev/hda| grep -i dma'
 using_dma    =  1 (on)
        DMA: mdma0 mdma1 mdma2 udma0 udma1 udma2 udma3 udma4 *udma5
$ grep [[:blank:]]/[[:blank:]] /etc/fstab
/dev/hda3	/	reiserfs	defaults	1	1
Tests:
$ uname -r
2.4.18
$ time sh -c 'sync; sync; sync; dd if=/dev/zero of=hoax bs=16k count=131072; sync; sync; sync'
131072+0 records in
131072+0 records out
real    1m44.708s
user    0m0.140s
sys     0m20.340s
=> 19.56MB/s
$ uname -r
2.4.20
$ time sh -c 'sync; sync; sync; dd if=/dev/zero of=hoax bs=16k count=131072; sync; sync; sync'
131072+0 records in
131072+0 records out
real    1m27.980s
user    0m0.120s
sys     0m20.290s
=> 23.28MB/s
I also tried machines with disks connected to various SCSI controllers
and in all cases more recent kernels gave better results than older
ones (sym53c8xx: two-disk raid1 - 2.4.18: ~35MB/s, 2.4.20: ~40MB/s).
I'm using reiserfs 3.6 everywhere.
-- 
Tomas Szepe <szepe@pinerecords.com>
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.kernel.org
More majordomo info at  
http://vger.kernel.org/majordomo-info.html
Please read the FAQ at  
http://www.tux.org/lkml/