Date: Sun, 12 Sep 1999 17:25:03 +0100 (WEST)
From: "T.A. dos Santos" <>
Subject: nfsd Security: /// bad export. error
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/1999/9/12/54

   Some time ago i reported receiving this error in a knfsd 1.4.4 and
later setup with kernels 2.2.7 and above. This happened only under extreme
stress in the 100GB+ nfs export - at night during a backup with Arkeia, in
this case. I was asked to patch the kernel with the following patch, in
order to get some information about the moment it happens. The patch is:
--- nfsfh.c.orig        Thu Jul 15 20:37:20 1999
+++ nfsfh.c     Thu Jul 15 20:37:55 1999
@@ -1143,6 +1143,10 @@
                        printk("nfsd Security: %s/%s bad export.\n",
                               dentry->d_parent->d_name.name,
                               dentry->d_name.name);
+                       printk("nfsd Security: %p %p %p.\n",
+                               exp->ex_dentry,
+                               tdentry,
+                               dentry);
                        goto out;
                }
        }                    
   Anyway, it finally happened, after almost two months. To fix it was
only a matter of restarting nfs. No reboot needed. The results were:
Sep  6 22:34:59 jerry kernel: nfsd Security: /// bad export.
Sep  6 22:34:59 jerry kernel: nfsd Security: c0083e60 d0621140 d0621140.
Sep  6 22:35:00 jerry kernel: nfsd Security: /// bad export.
Sep  6 22:35:00 jerry kernel: nfsd Security: c0083e60 d0621140 d0621140.
... ... ...
Sep  7 06:46:14 jerry kernel: nfsd Security: /// bad export.
Sep  7 06:46:14 jerry kernel: nfsd Security: c0083e60 d0621140 d0621140.
I hope it helps someone to solve the problem. It is the only problem we
have been having with it in a heavily used server. And it only happens
each two months or so.
Reagrds,
TA
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.rutgers.edu
Please read the FAQ at 
http://www.tux.org/lkml/