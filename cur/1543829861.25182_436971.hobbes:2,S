Date: Mon, 26 Jun 2006 11:17:55 +0200
From: Toralf Förster <>
Subject: Fwd: Re: linux-2.6.17.1: undefined reference to `online_page'
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2006/6/26/46

----------  Weitergeleitete Nachricht  ----------
Subject: Re: linux-2.6.17.1: undefined reference to `online_page'
Date: Monday 26 June 2006 11:14
From: Toralf Förster <toralf.foerster@gmx.de>
To: Yasunori Goto <y-goto@jp.fujitsu.com>
Am Monday 26 June 2006 09:39 schrieben Sie:
> > In-Reply-To: <200606231001.33766.toralf.foerster@gmx.de>
> > 
> > On Fri, 23 Jun 2006 10:01:33 +0200, Toralf Foerster wrote:
> > 
> > > I got the compile error :
> > > 
> > > ...
> > >   UPD     include/linux/compile.h
> > >   CC      init/version.o
> > >   LD      init/built-in.o
> > >   LD      .tmp_vmlinux1
> > > mm/built-in.o: In function `online_pages':
> > > : undefined reference to `online_page'
> > > make: *** [.tmp_vmlinux1] Error 1
> > > 
> > > with this config:
> > 
> > > CONFIG_X86_32=y
> > 
> > > CONFIG_NOHIGHMEM=y
> > 
> > > CONFIG_SPARSEMEM_MANUAL=y
> > > CONFIG_SPARSEMEM=y
> > > CONFIG_HAVE_MEMORY_PRESENT=y
> > > CONFIG_SPARSEMEM_STATIC=y
> > > CONFIG_MEMORY_HOTPLUG=y
> > 
> > Yes, that config is broken. mm/memory_hotplug.c::online_pages() calls
> > online_page() but without HIGHMEM that doesn't get built and no dummy
> > function gets defined.
> 
> Toralf-san. How is this patch?
> Or do you want to use memory hotplug without highmem?
> 
> Bye.
> 
> ---
> 
> add_memory() for i386 add memory to highmem. So, if CONFIG_HIGHMEM
> is not set, CONFIG_MEMORY_HOTPLUG shouldn't be set.
> 
> 
> Signed-off-by: Yasunori Goto <y-goto@jp.fujitsu.com>
> 
> ---
>  mm/Kconfig |    2 +-
>  1 file changed, 1 insertion(+), 1 deletion(-)
> 
> Index: linux-2.6.17/mm/Kconfig
> ===================================================================
> --- linux-2.6.17.orig/mm/Kconfig	2006-06-26 14:19:11.000000000 +0900
> +++ linux-2.6.17/mm/Kconfig	2006-06-26 14:19:53.000000000 +0900
> @@ -115,7 +115,7 @@ config SPARSEMEM_EXTREME
>  # eventually, we can have this option just 'select SPARSEMEM'
>  config MEMORY_HOTPLUG
>  	bool "Allow for memory hot-add"
> -	depends on SPARSEMEM && HOTPLUG && !SOFTWARE_SUSPEND
> +	depends on SPARSEMEM && HOTPLUG && !SOFTWARE_SUSPEND && !(X86_32 && !HIGHMEM)
>  
>  comment "Memory hotplug is currently incompatible with Software Suspend"
>  	depends on SPARSEMEM && HOTPLUG && SOFTWARE_SUSPEND
> 
Works fine with that patch, thanks :-)
BTW, I created the .config using the command sequence "make randconfig && <adapt .config to local machine> &&
make oldconfig".
-- 
MfG/Sincerely
Toralf Förster
-------------------------------------------------------
-- 
MfG/Sincerely
Toralf Förster
[unhandled content-type:application/pgp-signature]