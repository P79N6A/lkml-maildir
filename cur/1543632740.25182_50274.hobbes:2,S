Date: Tue, 4 Jun 2002 19:28:54 +0200
From: Trond Myklebust <>
Subject: Re: nfs slowdown since 2.5.4
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2002/6/4/199

On Tuesday 04 June 2002 19:16, Matthias Welk wrote:
> On Tuesday 04 June 2002 18:48, Trond Myklebust wrote:
> > On Tuesday 04 June 2002 17:56, Matthias Welk wrote:
> > > To get more info about this problem I compared the compile time and the
> > > nfs traffic between 2.4.18-4 and 2.5.20 on a RedHat 7.3 system.
> > > The sources (mosfet-liquid0.9.5.tar.gz - KDE style) were located on the
> > > local disc and the libraries were linked over nfs.
> > > The results attached to this mail show the big difference !
Does the appended patch make a difference?
Cheers,
  Trond
--- linux-2.5.20/fs/nfs/dir.c.orig	Mon Jun  3 03:44:49 2002
+++ linux-2.5.20/fs/nfs/dir.c	Tue Jun  4 19:24:21 2002
@@ -519,7 +519,6 @@
 	dput(parent);
 	return 1;
  out_bad:
-	NFS_CACHEINV(dir);
 	if (inode && S_ISDIR(inode->i_mode)) {
 		/* Purge readdir caches. */
 		nfs_zap_caches(inode);