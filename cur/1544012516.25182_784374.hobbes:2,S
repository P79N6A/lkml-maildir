Date: Sat, 27 Dec 2008 15:25:54 +0100
From: Johannes Weiner <>
Subject: Re: [PATCH] 2.6.28, vmalloc.c, vmap_page_range
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2008/12/27/90

On Sat, Dec 27, 2008 at 10:02:21AM +0100, Ingo Molnar wrote:
> > > --- a/mm/vmalloc.c~vmallocc-fix-flushing-in-vmap_page_range
> > > +++ a/mm/vmalloc.c
> > > @@ -151,11 +151,12 @@ static int vmap_pud_range(pgd_t *pgd, un
> > >   *
> > >   * Ie. pte at addr+N*PAGE_SIZE shall point to pfn corresponding to pages[N]
> > >   */
> > > -static int vmap_page_range(unsigned long addr, unsigned long end,
> > > +static int vmap_page_range(unsigned long start_addr, unsigned long end,
> > >  				pgprot_t prot, struct page **pages)
> > >  {
> > >  	pgd_t *pgd;
> > >  	unsigned long next;
> > > +	unsigned long addr = start_addr;
> > 
> > Ugh, start_addr is an awful name.  How about start?  I know it doesn't 
> > hold the same amount of information but it's a local API, the 
> > pgd_offset_k() should make the unit unambiguous, it goes better with the 
> > end parameter and it's unique enough for this short function.
> 
> i'd like to observe that there's 449 start_addr instances in the kernel 
> source, 17 of them in mm/*.c alone. So if it's 'ugly' (it isnt to me), 
> this patch is not the place to start worrying about it. If you feel 
> strongly about it then prepare a cleanup patch that eradicates them all, 
> put your justification for why it's bad into the changelog and post it to 
> lkml.
It would surely not justify such a big change.
And at least in mm/* you have them paired with `end_addr' if they
denote range start and end.
	Hannes