Date: Sun, 01 Feb 2009 10:17:16 +0100
From: Peter Zijlstra <>
Subject: Re: hackbench [pthread mode] regression with 2.6.29-rc3
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2009/2/1/13

On Sun, 2009-02-01 at 16:29 +0800, Lin Ming wrote:
> > Bisect located below patch.
> > commit 490dea45d00f01847ebebd007685d564aaf2cd98
> > Author: Peter Zijlstra <peterz@infradead.org>
> > Date:   Mon Nov 24 17:06:57 2008 +0100
> > 
> >    itimers: remove the per-cpu-ish-ness
> > 
> >    Either we bounce once cacheline per cpu per tick, yielding n^2 bounces
> >    or we just bounce a single..
> > 
> >    Also, using per-cpu allocations for the thread-groups complicates the
> >    per-cpu allocator in that its currently aimed to be a fixed sized
> >    allocator and the only possible extention to that would be vmap based,
> >    which is seriously constrained on 32 bit archs.
> > 
> > 
> > After above patch is reverted, hackbench result is restored.
> 
> oltp has ~3% regression with 2.6.29-rc3 on 4core*2p stokley machine.
> After above patch reverted, the regression disappeared.
*sigh*, did they gain anything with introduction of the per-cpu crap?
f06febc96ba8e0af80bcc3eaec0a109e88275fac
5ce73a4a5a4893a1aa4cdeed1b1a5a6de42c43b6
bb34d92f643086d546b49cef680f6f305ed84414
ad133ba3dc283300e5b62b5b7211d2f39fbf6ee7
ce394471d13bf071939a9a0b48c64c297676d233