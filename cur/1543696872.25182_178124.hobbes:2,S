Date: Thu, 13 Nov 2003 21:31:04 -0800
From: "Nakajima, Jun" <>
Subject: RE: invalid SMP mptable on Toshiba Satellite 2430-301
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2003/11/14/5

What's happening is that the kernel did not found interesting things in
ACPI (no local APIC and no I/O APIC), and decided to fall back to MPS.
Then MPS detection code was not robust, calling panic(). So we should
fix the MPS code that calls panic().
We can stop the fallback to MPS if ACPI is detected right, but probably
we should keep the priority at this point, assuming MPS is still more
correct; this is a bug with MPS parsing. 
	Jun
> -----Original Message-----
> From: linux-kernel-owner@vger.kernel.org [mailto:linux-kernel-
> owner@vger.kernel.org] On Behalf Of Jochen Voss
> Sent: Thursday, November 13, 2003 10:45 AM
> To: Linus Torvalds
> Cc: linux-kernel@vger.kernel.org
> Subject: Re: invalid SMP mptable on Toshiba Satellite 2430-301
> 
> Hello,
> 
> On Thu, Nov 13, 2003 at 10:13:08AM -0800, Linus Torvalds wrote:
> > Hmm.. Do you have ACPI enabled? We really shouldn't need the MP
table if
> > the information is elsewhere, but the mptable assumptions might be a
bit
> > entrenched.
> 
> With SMP and ACPI enabled I get the following kernel
> boot messages
> 
>     Intel MultiProcessor Specification v1.4
> 	Virtual Wire compatibility mode.
>     SMP mptable: bad signature [0x0]!
>     BIOS bug, MP table errors detected!...
>     ... disabling SMP support. (tell your hw vendor)
> 
> The last message is generated by the following code
> in arch/i386/kernel/mpparse.c:
> 
>     if (!smp_read_mpc((void *)mpf->mpf_physptr)) {
>         smp_found_config = 0;
>         printk(KERN_ERR "BIOS bug, MP table errors detected!...\n");
>         printk(KERN_ERR "... disabling SMP support. (tell your hw
> vendor)\n");
>         return;
>     }
> 
> I don't know what effects are caused by the 'smp_found_config = 0',
> but later-on the following messages appear:
> 
>     No local APIC present or hardware disabled
>     ...
>     CPU:     After generic identify, caps: bfebf9ff 00000000 00000000
> 00000000
>     CPU:     After vendor identify, caps: bfebf9ff 00000000 00000000
> 00000000
>     CPU: Trace cache: 12K uops, L1 D cache: 8K
>     CPU: L2 cache: 512K
>     CPU: Hyper-Threading is disabled
>     CPU:     After all inits, caps: bfebf9ff 00000000 00000000
00000080
>     ...
>     SMP motherboard not detected.
>     Local APIC not detected. Using dummy APIC emulation.
>     Starting migration thread for cpu 0
>     CPUS done 4
> 
> I hope this helps,
> Jochen
> --
> 
http://seehuhn.de/
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.kernel.org
More majordomo info at  
http://vger.kernel.org/majordomo-info.html
Please read the FAQ at  
http://www.tux.org/lkml/