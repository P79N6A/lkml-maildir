Date: Thu, 26 Jun 2003 08:25:54 -0400
From: joe briggs <>
Subject: Re: AMD MP, SMP, Tyan 2466, REISERFS I/O error
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2003/6/26/39

I am working on a Tyan 2466 SMP/Athlon server now and am getting tons of 
reiserf errors (see attached /var/log/syslog) that claim an i/o error, yet 
the log does not show any errors from the driver (should it?).  
Unfortunately, Reiser does not indicate which drive the error is produced 
from.  My configuration is:
Tyan 2466 SMP 2 x AMD2400-MP
512 MB PC2100 DDR-> not registered!
Debian woody
2.4.21 reiser
system drive (os, swap) wd800-bb (80 gb ide)
data drives: 3ware 7200, 2 x wd2000 (200 gb ide) RAID-0
On Wednesday 25 June 2003 07:17 pm, Edward Tandi wrote:
> On Wed, 2003-06-25 at 23:59, Timothy Miller wrote:
> > Edward Tandi wrote:
> > > Yes, for SMP mode you absolutely need to use 'registered' RAM. Normal
> > > PC2100 ram will work OK with one processor but quickly fails with two
> > > (I had the same problems). Apparently, DDR RAM uses one clock edge to
> > > transfer in one direction and the opposite edge to transfer back again
> > > so the registers do synchronisation between one processor writing to
> > > the same location that the other one reads from. That's how it was
> > > explained to me anyway.
> >
> > DDR memory works very much like single data rate, except that data is
> > transferred (in whichever direction it's going) on both edges of the
> > clock, thus doubling the transfer rate.  The memory does not switch
> > between reading and writing as you describe it.
> >
> > I believe registering is for reliability.  Data is transferred one clock
> > cycle later but reduces signal loading.
>
> Thanks for the clarification. I do not profess to be an expert in the
> technology. Two writes or a read+write per clock cycle is close enough
> for the purpose of the discussion.
>
> The point I was trying to make is that the registers are there to deal
> with an SMP race condition of some sort. Athlon MP motherboards fitted
> with two processors will not work properly without 'registered' RAM. I
> have hard experience of this and it this experience I am sharing with
> someone who is seeing the same symptoms.
>
> Ed-T.
-- 
Joe Briggs
Briggs Media Systems
105 Burnsen Ave.
Manchester NH 01304 USA
TEL 603-232-3115 FAX 603-625-5809 MOBILE 603-493-2386
www.briggsmedia.comJun 26 07:04:10 sentry kernel: vs-5150: search_by_key: invalid format found in block 266772. Fsck?
Jun 26 07:04:10 sentry kernel: vs-5657: reiserfs_do_truncate: i/o failure occurred trying to truncate [22 154 0xfffffffffffffff DIRECT]
Jun 26 07:04:10 sentry kernel: is_tree_node: node level 11226 does not match to the expected one 1
Jun 26 07:04:10 sentry kernel: vs-5150: search_by_key: invalid format found in block 266772. Fsck?
Jun 26 07:04:10 sentry kernel: vs-5350: reiserfs_delete_solid_item: i/o failure occurred trying to delete [22 154 0x0 SD]
Jun 26 07:04:10 sentry kernel: is_tree_node: node level 11226 does not match to the expected one 1
Jun 26 07:04:10 sentry kernel: vs-5150: search_by_key: invalid format found in block 266772. Fsck?
Jun 26 07:04:10 sentry kernel: vs-13050: reiserfs_update_sd: i/o failure occurred trying to update [22 140 0x0 SD] stat datais_tree_node: node level 11226 does not match to the expected one 1
Jun 26 07:04:10 sentry kernel: vs-5150: search_by_key: invalid format found in block 266772. Fsck?
Jun 26 07:04:10 sentry kernel: vs-5657: reiserfs_do_truncate: i/o failure occurred trying to truncate [22 140 0xfffffffffffffff DIRECT]
Jun 26 07:04:10 sentry kernel: is_tree_node: node level 11226 does not match to the expected one 1
Jun 26 07:04:10 sentry kernel: vs-5150: search_by_key: invalid format found in block 266772. Fsck?
Jun 26 07:04:10 sentry kernel: vs-5350: reiserfs_delete_solid_item: i/o failure occurred trying to delete [22 140 0x0 SD]
Jun 26 07:04:10 sentry kernel: is_tree_node: node level 11226 does not match to the expected one 1
Jun 26 07:04:10 sentry kernel: vs-5150: search_by_key: invalid format found in block 266772. Fsck?
Jun 26 07:04:10 sentry kernel: vs-13050: reiserfs_update_sd: i/o failure occurred trying to update [22 101 0x0 SD] stat datais_tree_node: node level 11226 does not match to the expected one 1
Jun 26 07:04:10 sentry kernel: vs-5150: search_by_key: invalid format found in block 266772. Fsck?
Jun 26 07:04:10 sentry kernel: vs-5657: reiserfs_do_truncate: i/o failure occurred trying to truncate [22 101 0xfffffffffffffff DIRECT]
Jun 26 07:04:10 sentry kernel: is_tree_node: node level 11226 does not match to the expected one 1
Jun 26 07:04:10 sentry kernel: vs-5150: search_by_key: invalid format found in block 266772. Fsck?
Jun 26 07:04:10 sentry kernel: vs-5350: reiserfs_delete_solid_item: i/o failure occurred trying to delete [22 101 0x0 SD]
Jun 26 07:04:10 sentry kernel: is_tree_node: node level 11226 does not match to the expected one 1
Jun 26 07:04:10 sentry kernel: vs-5150: search_by_key: invalid format found in block 266772. Fsck?
Jun 26 07:04:10 sentry kernel: vs-13050: reiserfs_update_sd: i/o failure occurred trying to update [22 152 0x0 SD] stat datais_tree_node: node level 11226 does not match to the expected one 1
Jun 26 07:04:10 sentry kernel: vs-5150: search_by_key: invalid format found in block 266772. Fsck?
Jun 26 07:04:10 sentry kernel: vs-5657: reiserfs_do_truncate: i/o failure occurred trying to truncate [22 152 0xfffffffffffffff DIRECT]
Jun 26 07:04:10 sentry kernel: is_tree_node: node level 11226 does not match to the expected one 1
Jun 26 07:04:10 sentry kernel: vs-5150: search_by_key: invalid format found in block 266772. Fsck?
Jun 26 07:04:10 sentry kernel: vs-5350: reiserfs_delete_solid_item: i/o failure occurred trying to delete [22 152 0x0 SD]
Jun 26 07:04:10 sentry kernel: is_tree_node: node level 11226 does not match to the expected one 1
Jun 26 07:04:10 sentry kernel: vs-5150: search_by_key: invalid format found in block 266772. Fsck?
Jun 26 07:04:10 sentry kernel: vs-13050: reiserfs_update_sd: i/o failure occurred trying to update [22 104 0x0 SD] stat datais_tree_node: node level 11226 does not match to the expected one 1
Jun 26 07:04:10 sentry kernel: vs-5150: search_by_key: invalid format found in block 266772. Fsck?
Jun 26 07:04:10 sentry kernel: vs-5657: reiserfs_do_truncate: i/o failure occurred trying to truncate [22 104 0xfffffffffffffff DIRECT]
Jun 26 07:04:10 sentry kernel: is_tree_node: node level 11226 does not match to the expected one 1
Jun 26 07:04:10 sentry kernel: vs-5150: search_by_key: invalid format found in block 266772. Fsck?
Jun 26 07:04:10 sentry kernel: vs-5350: reiserfs_delete_solid_item: i/o failure occurred trying to delete [22 104 0x0 SD]