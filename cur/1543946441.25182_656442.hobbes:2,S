Date: Tue, 19 Feb 2008 23:13:38 +0100
From: Jim Meyering <>
Subject: [PATCH] hfsplus: handle match_strdup failure
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2008/2/19/453

* fs/hfsplus/options.c (hfsplus_parse_options): Handle match_strdup failure.
Signed-off-by: Jim Meyering <meyering@redhat.com>
---
 fs/hfsplus/options.c |    3 ++-
 1 files changed, 2 insertions(+), 1 deletions(-)
diff --git a/fs/hfsplus/options.c b/fs/hfsplus/options.c
index dc64fac..9997cbf 100644
--- a/fs/hfsplus/options.c
+++ b/fs/hfsplus/options.c
@@ -132,7 +132,8 @@ int hfsplus_parse_options(char *input, struct hfsplus_sb_info *sbi)
 				return 0;
 			}
 			p = match_strdup(&args[0]);
-			sbi->nls = load_nls(p);
+			if (p)
+				sbi->nls = load_nls(p);
 			if (!sbi->nls) {
 				printk(KERN_ERR "hfs: unable to load nls mapping \"%s\"\n", p);
 				kfree(p);
-- 
1.5.4.2.134.g82883