Date: Wed, 23 Jan 2008 18:41:48 +0800
From: "Bryan Wu" <>
Subject: Re: [PATCH] procfs: constify function pointer tables
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2008/1/23/64

On Jan 23, 2008 5:06 PM, Jan Engelhardt <jengelh@computergmbh.de> wrote:
>
> On Jan 23 2008 12:18, Bryan Wu wrote:
> >> [PATCH] procfs: constify function pointer tables
> >> ---
> >>  arch/alpha/kernel/setup.c     |    2 +-
> >>  arch/blackfin/kernel/setup.c  |    2 +-
> >>  [...]
> >> diff --git a/arch/alpha/kernel/setup.c b/arch/alpha/kernel/setup.c
> >> index bd5e68c..823f18e 100644
> >> --- a/arch/alpha/kernel/setup.c
> >> +++ b/arch/alpha/kernel/setup.c
> >> @@ -1472,7 +1472,7 @@ c_stop(struct seq_file *f, void *v)
> >>  {
> >>  }
> >>
> >> -struct seq_operations cpuinfo_op = {
> >> +const struct seq_operations cpuinfo_op = {
> >>         .start  = c_start,
> >>         .next   = c_next,
> >>         .stop   = c_stop,
> [...]
> >Thanks, I understand the seq_xxx() API needs "const struct seq_operations *".
> >So for Blackfin part, I agree with Mike.
> >
> >but there are still some other files need add "const":
> >---
> >/opt/git-tree/blackfin-2.6$ grep -r seq_operations arch/*
> >arch/alpha/kernel/setup.c:struct seq_operations cpuinfo_op = {
>
> The patch already touches that :-)
>
Oh, this patch does not touch all, following is the missing list:
---
arch/arm/kernel/setup.c:struct seq_operations cpuinfo_op = {
arch/arm/mach-davinci/clock.c:static struct seq_operations davinci_ck_op = {
arch/avr32/kernel/cpu.c:struct seq_operations cpuinfo_op = {
arch/avr32/mm/tlb.c:static struct seq_operations tlb_ops = {
arch/ia64/hp/common/sba_iommu.c:static struct seq_operations ioc_seq_ops = {
arch/ia64/kernel/perfmon.c:struct seq_operations pfm_seq_ops = {
arch/ia64/kernel/setup.c:struct seq_operations cpuinfo_op = {
arch/ia64/sn/kernel/sn2/sn2_smp.c:static struct seq_operations
sn2_ptc_seq_ops = {
arch/ia64/sn/kernel/sn2/sn_hwperf.c:static struct seq_operations
sn_topology_seq_ops = {
arch/mips/kernel/proc.c:struct seq_operations cpuinfo_op = {
arch/powerpc/kernel/setup-common.c:struct seq_operations cpuinfo_op = {
arch/powerpc/platforms/pseries/hvCall_inst.c:static struct
seq_operations hcall_inst_seq_ops = {
arch/s390/kernel/setup.c:struct seq_operations cpuinfo_op = {
arch/sh/kernel/setup.c:struct seq_operations cpuinfo_op = {
arch/sh64/kernel/setup.c:struct seq_operations cpuinfo_op = {
arch/sparc/kernel/setup.c:struct seq_operations cpuinfo_op = {
arch/sparc64/kernel/setup.c:struct seq_operations cpuinfo_op = {
arch/x86/kernel/cpu/proc.c:struct seq_operations cpuinfo_op = {
arch/x86/kernel/setup_64.c:struct seq_operations cpuinfo_op = {
----
maybe you did not use the latest git tree.
-Bryan Wu