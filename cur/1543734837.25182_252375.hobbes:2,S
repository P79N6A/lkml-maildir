Date: Tue, 14 Sep 2004 18:20:02 -0400
From: Mike Waychison <>
Subject: Re: TG3 doesn't work in kernel 2.4.27 (David S. Miller)
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2004/9/14/390

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1
David S. Miller wrote:
> On Wed, 8 Sep 2004 23:07:28 +1000
> Anton Blanchard <anton@samba.org> wrote:
>
>
>>
>>
>>>I've had mixed results.  On some of my blades it never works.  On others
>>>it will come up every third attempt or so.
>>
>>2.6 BK as of 2 days ago wasnt working on my JS20 either. Ive been
>>meaning to look closer but havent had a chance yet.
>
>
> Are you going to work on this soon Anton?  I will cook up some
> debugging patches, this bug sucks and I want to fix it soon.
I've gone through the changes you've made lately and I found a thinko,
patch attached.
With this patch, I can turn off autoneg on our b1600's switch and the
b200x falls back to 1000FD as required.
Signed-Off: Mike Waychison <michael.waychison@sun.com>
- --
Mike Waychison
Sun Microsystems, Inc.
1 (650) 352-5299 voice
1 (416) 202-8336 voice
http://www.sun.com
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
NOTICE:  The opinions expressed in this email are held by me,
and may not represent the views of Sun Microsystems, Inc.
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.2.5 (GNU/Linux)
iD8DBQFBR26QdQs4kOxk3/MRAoCrAJ95xamjKjB1gSnNa63PrncjvHEfWwCghxkJ
UOQQ0P+4kc/FnbwfeXEaGHA=
=G6li
-----END PGP SIGNATURE-----
# This is a BitKeeper generated patch for the following project:
# Project Name: Linux kernel tree
# This patch format is intended for GNU patch command version 2.5 or higher.
# This patch includes the following deltas:
#	           ChangeSet	1.2191  -> 1.2192 
#	   drivers/net/tg3.c	1.203   -> 1.204  
#
# The following is the BitKeeper ChangeSet Log
# --------------------------------------------
# 04/09/14	root@lnx42.localdomain	1.2192
# tg3.c:
#   - fixed small thinko for hw autoneg fallback to 1000FD
# --------------------------------------------
#
diff -Nru a/drivers/net/tg3.c b/drivers/net/tg3.c
--- a/drivers/net/tg3.c	Tue Sep 14 22:13:16 2004
+++ b/drivers/net/tg3.c	Tue Sep 14 22:13:16 2004
@@ -2168,7 +2168,7 @@
 					else
 						val |= 0x4010880;
 
-					tw32_f(MAC_SERDES_CFG, serdes_cfg);
+					tw32_f(MAC_SERDES_CFG, val);
 				}
 
 				tw32_f(SG_DIG_CTRL, 0x01388400);