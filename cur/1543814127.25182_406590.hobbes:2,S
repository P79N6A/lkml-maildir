Date: Tue, 14 Mar 2006 13:36:33 -0800
From: Andrew Morton <>
Subject: Re: [PATCH] provide hrtimer exports for module use [Was: Exports for hrtimer APIs]
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2006/3/14/254

"Stone, Joshua I" <joshua.i.stone@intel.com> wrote:
>
> Andrew Morton wrote:
> > "Stone, Joshua I" <joshua.i.stone@intel.com> wrote:
> >> I have noticed that the hrtimer APIs in 2.6.16 RCs are not exported,
> >> and therefore modules are unable to use hrtimers.  I have not seen
> >> any discussion on this point, so I presume that this is either an
> >> oversight, or there has not been any case presented for exporting
> >> hrtimers. 
> >> 
> >> I would like to add hrtimer support to SystemTap, which by design
> >> requires the use of dynamically loaded kernel modules.  Can the
> >> appropriate exports for hrtimers please be added?
> > 
> > Please send a patch, so we can see what's needed.
> > 
> > EXPORT_SYMBOL_GPL would be preferred.
> 
> This patch adds the exports needed for modules to use the
> hrtimer APIs.
> 
> --- linux-2.6.16-rc6/kernel/hrtimer.c	2006-03-14 10:44:13.000000000
> -0800
> +++ linux-2.6.16-rc6-hrtexp/kernel/hrtimer.c	2006-03-14
> 11:13:48.000000000 -0800
Wordwrapped...
> +EXPORT_SYMBOL_GPL(ktime_add_ns);
> +EXPORT_SYMBOL_GPL(hrtimer_forward);
> +EXPORT_SYMBOL_GPL(hrtimer_start);
> +EXPORT_SYMBOL_GPL(hrtimer_try_to_cancel);
> +EXPORT_SYMBOL_GPL(hrtimer_cancel);
> +EXPORT_SYMBOL_GPL(hrtimer_get_remaining);
> +EXPORT_SYMBOL_GPL(hrtimer_get_next_event);
> +EXPORT_SYMBOL_GPL(hrtimer_init);
> +EXPORT_SYMBOL_GPL(hrtimer_get_res);
> +EXPORT_SYMBOL_GPL(hrtimer_nanosleep);
gee, that's a lot of exports.  I don't know whether all of these would be
considered stable over the long-term?
Can you tell us a bit about why systemtap modules need the hrtimer
capability?  How it's being used and for what, etc?
Thanks.
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.kernel.org
More majordomo info at  
http://vger.kernel.org/majordomo-info.html
Please read the FAQ at  
http://www.tux.org/lkml/