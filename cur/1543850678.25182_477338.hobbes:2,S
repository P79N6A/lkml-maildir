Date: Sun, 29 Oct 2006 08:40:07 -0800
From: Andi Kleen <>
Subject: Re: [PATCH 1/7] header and stubs for paravirtualizing critical operations
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2006/10/29/66

Can you add a high level comment to entry.S what paravirt mode
is all about and perhaps a quick cheat sheet on the macros?
> +/* SMP boot always wants to use real time delay to allow sufficient time
> for + * the APs to come online */
> +#define USE_REAL_TIME_DELAY
That's ugly. Can't you call different wait functions for that case instead?
> +#ifdef CONFIG_PARAVIRT
> +#include <asm/paravirt.h>
> +#else
> +static inline void init_IRQ(void)
> +{
> +	native_init_IRQ();
> +}
> +#endif /* CONFIG_PARAVIRT */
You could probably avoid a lot of ifdefs by strategic use of 
__attribute__((weak))
> +#ifdef CONFIG_PARAVIRT
> +#include <asm/paravirt.h>
> +#else
This is probably a good candidate for rename to native + wrapper
macros too. Otherwise we'll always have to hack two different
places later.
-Andi
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.kernel.org
More majordomo info at  
http://vger.kernel.org/majordomo-info.html
Please read the FAQ at  
http://www.tux.org/lkml/