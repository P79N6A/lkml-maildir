Date: Sun, 25 May 2003 13:23:59 +0200
From: Manfred Spraul <>
Subject: Re: [RFC][PATCH][2.5] Possible race in wait_task_zombie and finish_task_switch
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2003/5/25/39

Do we have an idea which reference is miscounted? It seems that there 
are 4 different kinds of references to a task structure:
- the reference for the stack itself, acquired by setting usage to 2, 
dropped by schedule_tail.
- the reference for wait4, acquired by setting usage to 2, dropped by 
wait_task_zombie.
- references for the pid structures, maintained by pid.c
- temporary references for looking at tsk->{fs,mm,files,tty}, used by 
/proc, ptrace, tty.
>kernel BUG at kernel/sched.c:746!
>  
>
Hmm. What is schedule.c:746? There is no BUG in that area in the bk tree.
Zwane, is it easy to reproduce the crash? I could write a patch that 
adds 4 refcounters, then we could find out in which area we must look.
--
    Manfred
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.kernel.org
More majordomo info at  
http://vger.kernel.org/majordomo-info.html
Please read the FAQ at  
http://www.tux.org/lkml/