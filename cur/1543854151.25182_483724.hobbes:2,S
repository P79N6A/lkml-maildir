Date: Sat, 18 Nov 2006 12:39:07 +0200 (EET)
From: Tero Roponen <>
Subject: Re: [Linux-fbdev-devel] fb: modedb uses wrong default_mode
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2006/11/18/50

On Fri, 17 Nov 2006, Andrew Morton wrote:
> 
> Here's the current version of this monster patch:
> 
> From: Jordan Crouse <jordan.crouse@amd.com>
> 
> If no default mode is specified, it should be grabbed from the supplied
> database, not the default one.
> 
> [teanropo@jyu.fi: fix it]
> [akpm@osdl.org: simplify it]
> [akpm@osdl.org: remove pointless DEFAULT_MODEDB_INDEX]
> Signed-off-by: Jordan Crouse <jordan.crouse@amd.com>
> Cc: Geert Uytterhoeven <geert@linux-m68k.org>
> Cc: "Antonino A. Daplas" <adaplas@pol.net>
> Signed-off-by: Tero Roponen <teanropo@jyu.fi>
> Cc: James Simmons <jsimmons@infradead.org>
> Signed-off-by: Andrew Morton <akpm@osdl.org>
> ---
> 
>  drivers/video/modedb.c |    6 +++---
>  1 files changed, 3 insertions(+), 3 deletions(-)
> 
> diff -puN drivers/video/modedb.c~video-get-the-default-mode-from-the-right-database drivers/video/modedb.c
> --- a/drivers/video/modedb.c~video-get-the-default-mode-from-the-right-database
> +++ a/drivers/video/modedb.c
> @@ -34,8 +34,6 @@ const char *global_mode_option;
>       *  Standard video mode definitions (taken from XFree86)
>       */
> 
> -#define DEFAULT_MODEDB_INDEX	0
> -
>  static const struct fb_videomode modedb[] = {
>      {
>  	/* 640x400 @ 70 Hz, 31.5 kHz hsync */
> @@ -505,8 +503,10 @@ int fb_find_mode(struct fb_var_screeninf
>  	db = modedb;
>  	dbsize = ARRAY_SIZE(modedb);
>      }
> +
>      if (!default_mode)
> -	default_mode = &modedb[DEFAULT_MODEDB_INDEX];
> +	default_mode = &db[0];
> +
>      if (!default_bpp)
>  	default_bpp = 8;
> 
> _
I'm using neofb and this Works For Me (TM).
Thanks,
Tero Roponen
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.kernel.org
More majordomo info at  
http://vger.kernel.org/majordomo-info.html
Please read the FAQ at  
http://www.tux.org/lkml/