Date: Tue, 6 Feb 2007 14:42:30 +0100
From: Haavard Skinnemoen <>
Subject: Re: [PATCH] libata: Fix (hopefully) all the remaining problems with devices failing setup/identify
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2007/2/6/141

On Wed, 31 Jan 2007 17:26:05 +0000
Alan <alan@lxorguk.ukuu.org.uk> wrote:
> Two fixes in this test patch. One of them allows old CF cards to refuse
> pio mode setting, and one to wait for the drive to settle after a set
> features changes the speed settings, which is based upon the workarounds
> used by drivers/ide.
> 
> Please test and report back if you have an afflicted system. This patch
> isn't for merging just testing.
Just ran into the CF problem you describe when implementing support for
CompactFlash on AVR32 using an old 32 MB TwinMos card. Works fine with
this patch applied; without it, libata gives up after failing to set
xfermode (err_mask=0x1).
> The CF card fix will still display errors when the card works (got fixes
> for that once I know the cure works) but should then be found/usable.
Actually, I don't see any errors, but the card comes up in PIO0 mode
(which is correct behaviour as far as I can tell):
ata1: PATA max PIO0 cmd 0xA4800000 ctl 0xA480000E bmdma 0x0 irq 67
scsi0 : pata_pcmcia
ata1.00: CFA, max PIO0, 62592 sectors: LBA
ata1.00: ata1: dev 0 multi count 0
ata1.00: configured for PIO0
scsi 0:0:0:0: Direct-Access     ATA      32MB CHH         Rev  PQ: 0 ANSI: 5
Thanks for the patch. I would probably have spent a long time debugging
this without it.
Haavard
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.kernel.org
More majordomo info at  
http://vger.kernel.org/majordomo-info.html
Please read the FAQ at  
http://www.tux.org/lkml/