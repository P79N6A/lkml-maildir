Date: Thu, 23 Jun 2005 00:41:23 +0200
From: Ingo Molnar <>
Subject: Re: PREEMPT_RT vs I-PIPE: the numbers, part 2
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2005/6/22/373

* Karim Yaghmour <karim@opersys.com> wrote:
> > so ... give the -50-12 -RT tree a try and report back the lpptest 
> > results you are getting.
> 
> First things first, we want to report back that our setup is validated 
> before we go onto this one. So we've modified LRTBF to do the 
> busy-wait thing.
here's another bug in the way you are testing PREEMPT_RT irq latencies.  
Right now you are doing this in lrtbf-0.1a/drivers/par-test.c:
    if (request_irq ( PAR_TEST_IRQ,
                                          &par_test_irq_handler,
 #if CONFIG_PREEMPT_RT
                                           SA_NODELAY,
 #else //!CONFIG_PREEMPT_RT
                                           SA_INTERRUPT,
 #endif //PREEMPT_RT
you should set the SA_INTERRUPT flag in the PREEMPT_RT case too! I.e. 
the relevant line above should be:
                                           SA_NODELAY | SA_INTERRUPT,
otherwise par_test_irq_handler will run with interrupts enabled, opening 
the window for other interrupts to be injected and increasing the 
worst-case latency! Take a look at drivers/char/lpptest.c how to do this 
properly. Also, double-check that there is no IRQ 7 thread running on 
the PREEMPT_RT kernel, to make sure you are measuring irq latencies.
	Ingo
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.kernel.org
More majordomo info at  
http://vger.kernel.org/majordomo-info.html
Please read the FAQ at  
http://www.tux.org/lkml/