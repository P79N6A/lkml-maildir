Date: Mon, 4 Jun 2007 22:26:05 +0200
From: "Antonio Mignolli" <>
Subject: Re: lid switch hangs notebook
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2007/6/4/352

Interesting...
The lid problem was solved, but many others arised.
I don't remember what lapic is, I didn't put the lapic on kernel
command line, but it seemed to be active by default:
# find /sys -name "*lapic*"
/sys/devices/system/lapic_nmi
/sys/devices/system/lapic_nmi/lapic_nmi0
/sys/devices/system/lapic
/sys/devices/system/lapic/lapic0
I put a "nolapic" in cmdline, and this time no hangs,
even WITH acpi support in kernel, pressing the button
a dozen of times (without nolapic it hanged after a couple of times).
BUT:
- Module b44 (broadcom network adapter) fails to load, giving,
    with debug actived:
    b44 0000:01:0e.0: Cannot find proper PCI device base address, aborting.
- Alsa does not work
 ... No time for analyze other issues.
Thanks for helping,
I'll take a look to lapic.
On 6/4/07, Andreas Mohr <andi@rhlx01.hs-esslingen.de> wrote:
> Hi,
>
> On Mon, Jun 04, 2007 at 12:57:21PM +0200, Antonio Mignolli wrote:
> > Hi.
> > The problem reported below has not been solved,
> > I tried with the last stable kernel 2.6.21.3.
> >
> > But it seems not to be an ACPI issue,
> > I removed ACPI support from the kernel,
> > and still have the problem.
> > What else could be?
>
> Have you enabled local APIC ("lapic" command line) since?
> Enabling local APIC is known to cause just these issues on some
> machines (HARD lockup on AC power/screen dimming/Fn keys change),
> and I'm currently trying to nail what exactly the problem is.
> People say it's a broken BIOS (probably one which doesn't contain support
> for local APIC despite the CPU offering one), but I'm not willing to assume
> this yet, it may just as well be incomplete APIC IRQ routing setup
> or so).
> OTOH I'm not entirely sure whether "lapic" use is fully independent
> from ACPI support (which you disabled), but I think it is, so my reasoning
> may be valid.
>
> find /sys -name "*lapic*"
> should reveal whether local APIC is currently active or not and thus
> whether this might be responsible or not.
>
> Andreas Mohr
>
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.kernel.org
More majordomo info at  
http://vger.kernel.org/majordomo-info.html
Please read the FAQ at  
http://www.tux.org/lkml/