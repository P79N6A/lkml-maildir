Date: Sun, 17 Feb 2008 23:05:43 -0500
From: "David P. Reed" <>
Subject: Re: [linux-kernel] Re: [PATCH 1/3] x86: fix init_8259A() to not use outb_pic
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2008/2/17/429

Rene Herman wrote:
> On 17-02-08 23:25, Alan Cox wrote:
>
>> On Sun, 17 Feb 2008 16:56:28 -0500 (EST)
>> "David P. Reed" <dpreed@reed.com> wrote:
>>
>>> fix init_8259A() which initializes the 8259 PIC to not use outb_pic,
>>> which is a renamed version of outb_p, and delete outb_pic define.
>>
>> NAK
>>
>> The entire point of inb_pic/outb_pic is to isolate the various methods
>> and keep the logic for delays in one place. Undoing this just creates a
>> nasty mess.
>>
>> Quite probably inb_pic/outb_pic will end up as static inlines that do 
>> inb
>> or outb with a udelay of 1 or 2 but that is where the knowledge belongs.
>
> Additional NAK in sofar that the PIC delays were reported to be 
> necesary with some VIA chipsets earlier in these threads.
>
> Rene.
>
This not being a place where performance matters, I will submit a new 
patch that changes inb_pic and outb_pic to use udelay(2).  However, note 
that init_8259A does not use these consistently in its own accesses to 
the PIC registers.  Should I change it to use the _pic calls whereever 
it touches the PIC registers to be conservative?  Note that there is a 
udelay(100) after the registers are all setup, perhaps this is the real 
VIA requirement...