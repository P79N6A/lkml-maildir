Date: Wed, 22 May 2002 11:16:10 +0100
From: "Stephen C. Tweedie" <>
Subject: Re: 2.2 kernel - Ext3 & Raid patches
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2002/5/22/126

Hi,
On Tue, May 21, 2002 at 07:21:33PM -0600, Andreas Dilger wrote:
> On May 21, 2002  16:40 -0500, Jon Hedlund wrote:
> > Last September Stephan told someone on the linux-kernel list that 
> > Ext3 and Raid 1 didn't work together on the 2.2 kernel. 
> > Has this been fixed or have I just been lucky?
> 
> You've just been lucky.  I forget the exact scenario, but it is
> something like if journal replay is happening while the RAID is being 
> reconstructed after a crash you can get garbage written to your disk.
Right --- the raid resync code in 2.2 uses the normal buffer cache,
which results in writes being scheduled for clean buffers, behind
ext3's back.  That's not allowed --- it violates the write ordering
requirements that make ext3 work, and trips up debugging assert
failures in the ext3 write checking code.
You might get away with it, but a raid resync on ext3 on 2.2 is
basically not safe.  If you wait until after the resync before
mounting the ext3 filesystem, you'll be OK.
It should work on 2.4.
Cheers,
 Stephen
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.kernel.org
More majordomo info at  
http://vger.kernel.org/majordomo-info.html
Please read the FAQ at  
http://www.tux.org/lkml/