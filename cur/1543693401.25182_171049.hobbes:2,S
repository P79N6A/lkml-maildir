Date: Tue, 7 Oct 2003 09:59:37 -0600
From: Andreas Dilger <>
Subject: Re: Can dbench be used for benchmarking fs?
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2003/10/7/103

On Oct 07, 2003  18:45 +0400, Nikita Danilov wrote:
> Andreas Dilger writes:
>  > On Oct 07, 2003  16:42 +0400, E. Gryaznova wrote:
>  > > I use dbench for benchmarking the file systems and some results are
>  > > suspicious for me.
>  > > :
>  > > :
>  > > :
>  > > As the result: the measuring deviation is equal = 23.4062 - 15.7005 =
>  > > 7.7057 or about ~38% from average value.
>  > > 
>  > > So, I have 2 questions :
>  > > 1. Is there a way to avoid such big deviations on measuring a file
>  > > systems throughput and to get more stable results?
>  > > 2. Can dbench be used for benchmarking the file systems and if it is so
>  > > -- what is the predictable error on the measuring?
>  > 
>  > Dbench is not a good filesystem benchmark, because it deletes all of the
>  > files at the end.  Use something else for the filesystem benchmark - there
> 
> Err... What is wrong with deleting all files at the end? Or do you mean
> it should mix file operations during run?
> 
>  > are lots of them (bonnie, iozone, mongo, etc).
> 
> But why variance is so large?
Dbench is a bad filesystem benchmark because if all (or some large part)
of the files are deleted before the VM flushes them to disk, then you are
not really testing filesystem performance very much.  If you have enough
RAM in your system and a fast enough CPU you could complete the entire
dbench run without ever writing any data to disk.  There is some filesystem
activity (you need to create files and map pages), but it isn't a good test
of filesystem throughput.
The reason there is so much variability in the tests is that if the test
takes even a small amount more time to run this means more data gets flushed
to disk by the VM (instead of being deleted and never written), making the
test run longer and even _more_ data needs to get written, etc.
Dbench is a good multi-threaded filesystem stress program, but it isn't
a good benchmark.
Cheers, Andreas
--
Andreas Dilger
http://sourceforge.net/projects/ext2resize/
http://www-mddsp.enel.ucalgary.ca/People/adilger/
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.kernel.org
More majordomo info at  
http://vger.kernel.org/majordomo-info.html
Please read the FAQ at  
http://www.tux.org/lkml/