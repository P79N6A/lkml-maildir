Date: Tue, 23 Mar 1999 11:21:08 -0500 (EST)
From: "Nicholas J. Leon" <>
Subject: UDMA issues under 2.2.3
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/1999/3/23/54

Hmm. Just upgraded to an hdparm that actually shows the UDMA mode settings
and have a question or two.
According to hdparm -I, all of my drives are in UDMA mode2. Which they
shouldn't be; because I have the "use UDMA by default" DISABLED (my system
will lock up if I attempt to access two drives in UDMA mode at the same
time - as in a parallel fsck).
root(2)@neko [104 /usr2/root] # hdparm -I /dev/hda
/dev/hda:
hda: drive_cmd: status=0x51 { DriveReady SeekComplete Error }
hda: drive_cmd: error=0x04 { DriveStatusError }
 Model=DW CCA6304L0                            , FwRev=800.L980,
SerialNo=DWW-4T02208072 2
 Config={ HardSect NotMFM HdSw>15uSec SpinMotCtl Fixed DTR>5Mbs FmtGapReq
}
 RawCHS=13328/15/63, TrkSize=57600, SectSize=600, ECCbytes=22
 BuffType=3(DualPortCache), BuffSize=256kB, MaxMultSect=16, MultSect=8
 DblWordIO=no, maxPIO=2(fast), DMA=yes, maxDMA=0(slow)
 CurCHS=13328/15/63, CurSects=12594960, LBA=yes
 LBA CHS=784/255/63 Remapping, LBA=yes, LBAsects=12594960
 tDMA={min:120,rec:120}, DMA modes: mword0 mword1 mword2
 IORDY=on/off, tPIO={min:160,w/IORDY:120}, PIO modes: mode3 mode4
 UDMA modes: mode0 mode1 *mode2
This is the default. Everytime I use hdparm, I get the errors. Also...
root(2)@neko [105 /usr2/root] # hdparm -d0 -I /dev/hda
/dev/hda:
 setting using_dma to 0 (off)
hda: DMA disabled
 using_dma    =  0 (off)
hda: drive_cmd: status=0x51 { DriveReady SeekComplete Error }
hda: drive_cmd: error=0x04 { DriveStatusError }
 Model=DW CCA6304L0                            , FwRev=800.L980,
SerialNo=DWW-4T02208072 2
 DblWordIO=no, maxPIO=2(fast), DMA=yes, maxDMA=0(slow)
 IORDY=on/off, tPIO={min:160,w/IORDY:120}, PIO modes: mode3 mode4
 UDMA modes: mode0 mode1 *mode2
Shouldnt that have turned off UDMA of some sort?? It seems my commands
aren't making any difference.
Also, if I do something like
hdparm -X34 /dev/hda
 or
hdparm -X66 /dev/hda
my system will crash within seconds. Even though X66 should be putting hda
into the mode it claims its already in. Right?
I'm terribly confused here ... could someone explain what is happening?
Why do I get errors now that I've upgraded to hdparm-3.5. Why are my
drives showing being in UDMA mode when I have told them not to even USE
dma? In my system BIOS, I have UDMA turned off in every fashion. In
.config, CONFIG_IDEDMA_AUTO is not set. I certainly don't have any lines
in my rc scripts to enable UDMA mode.
G'day! <more confused than ever>
--                                             n i c h o l a s  j  l e o n
elegance through simplicity*
http://mrnick.binary9.net
*nicholas@binary9.net
good fortune through truth*roaming:njllm@email.msn.com*ICQ#2170994*U+($++)
TRA#6805*not all questions have answers*pseudogeek:P+++($++)L+($++)W=lm@b9
2.3x10e-53*seek the path-not the destination*madison*pain builds character
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.rutgers.edu
Please read the FAQ at 
http://www.tux.org/lkml/