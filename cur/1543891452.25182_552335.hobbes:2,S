Date: Sat, 02 Jun 2007 18:45:55 +0900
From: Tejun Heo <>
Subject: Re: 2.6.22-rc3 hibernate(?) disables SMART on ide
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2007/6/2/44

David Greaves wrote:
> I have 2 ide disks. If I enable SMART and hibernate/suspend2disk, SMART is
> disabled when I resume.
> 
> Same as in 2.6.21.1
> 
> cu:~# smartctl -son /dev/hda
> smartctl version 5.36 [i686-pc-linux-gnu] Copyright (C) 2002-6 Bruce Allen
> Home page is 
http://smartmontools.sourceforge.net/
> 
> === START OF ENABLE/DISABLE COMMANDS SECTION ===
> SMART Enabled.
> 
> cu:~# /usr/net/bin/hibernate
> [poweron resume here]
> cu:~# smartctl -a /dev/hda
> smartctl version 5.36 [i686-pc-linux-gnu] Copyright (C) 2002-6 Bruce Allen
> Home page is 
http://smartmontools.sourceforge.net/
> 
> === START OF INFORMATION SECTION ===
> Model Family:     Seagate Barracuda ATA II family
> Device Model:     ST320420A
> Serial Number:    3CL04RKY
> Firmware Version: 3.21
> User Capacity:    20,404,101,120 bytes
> Device is:        In smartctl database [for details use: -P show]
> ATA Version is:   4
> ATA Standard is:  Exact ATA specification draft version not indicated
> Local Time is:    Fri Jun  1 22:37:15 2007 BST
> SMART support is: Available - device has SMART capability.
> SMART support is: Disabled
> 
> SMART Disabled. Use option -s with argument 'on' to enable it.
According to the ATA standard, the device (drive) itself is responsible
for preserving SMART enabled status over power cycles.  It seems your
drive doesn't wanna do that.  I don't think mangling with SMART setup in
the kernel is wise thing to do.  Bruce, any ideas?  Maybe hook smartd
such that it gets suspend/resume events?
Thanks.
-- 
tejun
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.kernel.org
More majordomo info at  
http://vger.kernel.org/majordomo-info.html
Please read the FAQ at  
http://www.tux.org/lkml/