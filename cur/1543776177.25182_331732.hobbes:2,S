Date: Wed, 06 Jul 2005 16:35:36 +0200
From: Alexandre Buisse <>
Subject: Re: compilation error sound/pci/bt87x.c:807 [Re: Linux 2.6.13-rc2]
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2005/7/6/386

Tomasz Torcz wrote:
>   CC [M]  sound/pci/bt87x.o
>sound/pci/bt87x.c: In function `snd_bt87x_detect_card':
>sound/pci/bt87x.c:807: error: `driver' undeclared (first use in this function)
>sound/pci/bt87x.c:807: error: (Each undeclared identifier is reported only once
>sound/pci/bt87x.c:807: error: for each function it appears in.)
>make[2]: *** [sound/pci/bt87x.o] Error 1
>make[1]: *** [sound/pci] Error 2
>make: *** [sound] Error 2
> 
>
Hi,
The attached patch should fix it.
Regards,
Alexandre
Signed-off-by: Alexandre Buisse <Alexandre.Buisse@ens-lyon.fr>
--- linux-2.6.13-rc2/sound/pci/bt87x.c.old	2005-07-06 16:29:08.000000000 +0200
+++ linux-2.6.13-rc2/sound/pci/bt87x.c	2005-07-06 16:25:05.000000000 +0200
@@ -47,6 +47,8 @@
 static int digital_rate[SNDRV_CARDS] = { [0 ... (SNDRV_CARDS-1)] = 0 }; /* digital input rate */
 static int load_all;	/* allow to load the non-whitelisted cards */
 
+static struct pci_driver driver;
+
 module_param_array(index, int, NULL, 0444);
 MODULE_PARM_DESC(index, "Index value for Bt87x soundcard");
 module_param_array(id, charp, NULL, 0444);
@@ -804,7 +806,7 @@
 	int i;
 	const struct pci_device_id *supported;
 
-	supported = pci_match_device(driver, pci);
+	supported = pci_match_device(&driver, pci);
 	if (supported)
 		return supported->driver_data;
 