Date: Wed, 1 Aug 2007 16:45:54 -0700
From: Andrew Morton <>
Subject: Re: [patch -mm][Intel-IOMMU] Optimize sg map/unmap calls
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2007/8/1/484

On Wed, 1 Aug 2007 13:06:23 -0700
"Keshavamurthy, Anil S" <anil.s.keshavamurthy@intel.com> wrote:
> +/* Computes the padding size required, to make the
> + * the start address naturally aligned on its size
> + */
> +static int
> +iova_get_pad_size(int size, unsigned int limit_pfn)
> +{
> +	unsigned int pad_size = 0;
> +	unsigned int order = ilog2(size);
> +
> +	if (order)
> +		pad_size = (limit_pfn + 1) % (1 << order);
> +
> +	return pad_size;
> +}
This isn't obviously doing the right thing for non-power-of-2 inputs.
ilog2() rounds down...
Please check that this, and all the other ilog2()s which have been added
are doing the right thing if they can be presented with non-power-of-2
inputs?
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.kernel.org
More majordomo info at  
http://vger.kernel.org/majordomo-info.html
Please read the FAQ at  
http://www.tux.org/lkml/