Date: Sat, 9 Oct 1999 20:03:57 +0200 (CEST)
From: Andrea Arcangeli <>
Subject: xtime lock declared in wrong pos
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/1999/10/9/116

I didn't noticed an #ifndef __alpha__ while fixing the xtime races that is
breaking the alpha compile of 2.2.13pre14 (and pre15 as it's not been
changed). here a trivial fix against 2.2.13pre14:
--- 2.2.13pre14aa/kernel/time.c.~1~	Tue Sep 28 18:32:40 1999
+++ 2.2.13pre14aa/kernel/time.c	Sat Oct  9 19:58:40 1999
@@ -56,6 +56,13 @@
 	do_get_fast_time(t);
 }
 
+/* The xtime_lock is not only serializing the xtime read/writes but it's also
+   serializing all accesses to the global NTP variables.
+   NOTE NOTE: We really need a spinlock here as the global irq locking
+   only protect us against the timer irq and not against other time-related
+   syscall running under us. */
+extern rwlock_t xtime_lock;
+
 #ifndef __alpha__
 
 /*
@@ -77,13 +84,6 @@
 	}
 	return i;
 }
-
-/* The xtime_lock is not only serializing the xtime read/writes but it's also
-   serializing all accesses to the global NTP variables.
-   NOTE NOTE: We really need a spinlock here as the global irq locking
-   only protect us against the timer irq and not against other time-related
-   syscall running under us. */
-extern rwlock_t xtime_lock;
 
 /*
  * sys_stime() can be implemented in user-level using
Andrea
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.rutgers.edu
Please read the FAQ at 
http://www.tux.org/lkml/