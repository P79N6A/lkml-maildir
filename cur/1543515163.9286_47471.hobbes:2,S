Date: Sat, 06 Nov 1999 00:08:38 +0000
From: Tom Eastep <>
Subject: [PATCH] 2.2.14pre4 ide.c w/no CONFIG_BLK_DEV_IDEPCI
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/1999/11/5/122

The attached patch allows ide.c to compile where CONFIG_BLK_DEV_IDEPCI
is not defined.
-Tom
-- 
Tom Eastep               \    Opinions expressed here
teastep@evergo.net        \    are my own and not 
Shoreline, Washington USA  \    those of my employer
Work: tom.eastep@compaq.com \________________________--- linux/drivers/block/ide.c~	Fri Nov  5 15:34:17 1999
+++ linux/drivers/block/ide.c	Fri Nov  5 15:43:03 1999
@@ -1419,11 +1419,13 @@
 			 */
 			(void)ide_ack_intr(hwif->io_ports[IDE_STATUS_OFFSET], hwif->io_ports[IDE_IRQ_OFFSET]);
 			unexpected_intr(irq, hwgroup);
+#ifdef CONFIG_BLK_DEV_IDEPCI
 		} else {
 			/*
 			 * Whack the status register, just in case we have a leftover pending IRQ.
 			 */
 			(void)IN_BYTE(hwif->io_ports[IDE_STATUS_OFFSET]);
+#endif	/* CONFIG_BLK_DEV_IDEPCI */
 		}
 		spin_unlock_irqrestore(&io_request_lock, flags);
 		return;