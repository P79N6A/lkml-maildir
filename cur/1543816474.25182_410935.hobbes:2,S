Date: Sun, 26 Mar 2006 08:10:39 +0530
From: Srivatsa Vaddagiri <>
Subject: Re: [PATCH 2.6.16-mm1 1/2] sched_domain: handle kmalloc failure
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2006/3/25/181

On Sat, Mar 25, 2006 at 06:06:05PM -0800, Andrew Morton wrote:
> This is rather ugly, sorry.
That was about my reaction too when I was going thr'
build_sched_domains()!
> So if the kmalloc failed we'll try to limp along without load balancing?
Not exactly. We will still load balance at lower domains (between
threads of a CPU & between CPUs of a node) that dont require any memory
allocation.
> I think it would be better to free any thus-far allocated memory and to
> fail the whole thing.
This would result in absolutely no load balancing (even for domain
levels which didnt need any memory allocation - like at threads-of-a-cpu
level). Is that acceptable?
> Returning void from build_sched_domains was wrong.
If we decide to return an error, then it has to be percolated all the
way down (for ex: update_cpu_domains should now have to return an error
too if partition_sched_domains returns an error)?
> build_sched_domains() should be static and __cpuinit, btw.
Ok ..Will take care of that in the next version of the patch.
And thanks for the response to the patch!
-- 
Regards,
vatsa
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.kernel.org
More majordomo info at  
http://vger.kernel.org/majordomo-info.html
Please read the FAQ at  
http://www.tux.org/lkml/