Date: Sat, 27 Mar 1999 10:19:32 -0500 (EST)
From: "Michael H. Warfield" <>
Subject: Re: smbfs still timing out
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/1999/3/27/47

mev0003@unt.edu enscribed thusly:
> On 26 Mar, Eloy A. Paris spewed forth:
> :: I have seen this here too, and also when doing an ls on the root
> :: directory of my NT box. The page file is locked or something so
> :: whatever smbfs is trying to do with the file at the moment of a ls, it
> :: gets an error from NT.
> :: 
> :: peloy.-
> :: 
> :: Michael H. Warfield <mhw@wittsend.com> wrote:
> :: > mev0003@unt.edu enscribed thusly:
> :: > 
> :: > 	[...]
> :: > 
> [snip]
> Fsck, Fsck, Fsck, Fsck, It happened again.  
> Mar 27 02:47:05 reliant kernel: smb_retry: signal failed, error=-3
> Mar 27 02:47:05 reliant kernel: smb_retry: signal failed, error=-3
> Mar 27 02:48:45 reliant last message repeated 2 times
> Mar 27 03:53:40 reliant kernel: smb_retry: signal failed, error=-3
> That's with the password included in the command line.
	Ok...  That keeps me from running down after a wild goose chase.
It's not the password cache then...
	The error=-3 is telling me that the smbmount daemon is gone, or didn't
get registered right, or blew a core ball, or something.  The smbfs module
is trying to signal it to rebuild the connection and it's not there.  When
this happens, can you do a "ps ax" and check if there is an smbmount process
running?
	If there is not, then the problem is to determine what happened to it.
	What you might want to do is to do the mount and then find the process
id of the smbmount daemon.  Once you have that, run gdb on the smbmount
binary and "attach {PID}" from the gdb prompt and then "continue".  If
smbmount exits for some reason, you'll get a gdb prompt back with the exit
reason.  If it's some error, you can type "where" and get a traceback.
That will tell me a lot, if this thing is exiting prematurely.
> Here's what's currently mounted:
> root:reliant lib$ mount
> /dev/sda1 on / type ext2 (rw)
> none on /proc type proc (rw)
> /dev/sda3 on /home type ext2 (rw)
> /dev/sda2 on /usr/local type ext2 (rw)
> //WINNT/C$ on /home/me2v/mounts type smbfs (0)
> //WINNT/ME2V on /home/me2v/winnt type smbfs (0)
> /dev/scd0 on /mnt/cdrom type iso9660 (ro)
> 
> and you have to be root to umount the shares when this happens too:
> me2v:reliant me2v$ smbumount mounts 
> Could not open mounts: Input/output error
> 
> root:reliant lib$ umount /home/me2v/mounts 
> root:reliant lib$ 
> 
> 
> gAR!!
> 
> -- 
> Matthew Vanecek
> Studies in Business Computers at the University of North Texas
> 
http://www.unt.edu/bcis
> Visit my Website at 
http://people.unt.edu/~mev0003
> *****************************************************************
> For 93 million miles, there is nothing between the sun and my shadow
> except me. I'm always getting in the way of something...
	Mike
-- 
 Michael H. Warfield    |  (770) 985-6132   |  mhw@WittsEnd.com
  (The Mad Wizard)      |  (770) 925-8248   |  
http://www.wittsend.com/mhw/
  NIC whois:  MHW9      |  An optimist believes we live in the best of all
 PGP Key: 0xDF1DD471    |  possible worlds.  A pessimist is sure of it!
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.rutgers.edu
Please read the FAQ at 
http://www.tux.org/lkml/