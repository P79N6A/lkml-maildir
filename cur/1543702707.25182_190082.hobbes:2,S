Date: Sat, 10 Jan 2004 17:01:43 -0800
From: Matthew Dharm <>
Subject: Re: [linux-usb-devel] Re: USB hangs
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2004/1/10/228

On Sun, Jan 11, 2004 at 01:49:34AM +0100, Oliver Neukum wrote:
> Am Sonntag, 11. Januar 2004 01:23 schrieb Matthew Dharm:
> > Where is USB kmalloc'ing with GFP_KERNEL?  I thought we tracked all those
> > down and eliminated them.
> > 
> 
> static int ohci_mem_init (struct ohci *ohci)
> {
> 	ohci->td_cache = pci_pool_create ("ohci_td", ohci->ohci_dev,
> 		sizeof (struct td),
> 		32 /* byte alignment */,
> 		0 /* no page-crossing issues */,
> 		GFP_KERNEL | OHCI_MEM_FLAGS);
> 	if (!ohci->td_cache)
> 		return -ENOMEM;
> 	ohci->dev_cache = pci_pool_create ("ohci_dev", ohci->ohci_dev,
> 		sizeof (struct ohci_device),
> 		16 /* byte alignment */,
> 		0 /* no page-crossing issues */,
> 		GFP_KERNEL | OHCI_MEM_FLAGS);
> 	if (!ohci->dev_cache)
> 		return -ENOMEM;
> 	return 0;
> }
> 
> This one here looks dangerous.
I'll agree that it looks dangerous, tho pci_pool_create() is something I
know little about.
Is this 2.4 or 2.6 code here?
Matt
-- 
Matthew Dharm                              Home: mdharm-usb@one-eyed-alien.net 
Maintainer, Linux USB Mass Storage Driver
Okay, this isn't funny anymore! Let me down!  I'll tell Bill on you!!
					-- Microsoft Salesman
User Friendly, 4/1/1998
[unhandled content-type:application/pgp-signature]