Date: Fri, 14 Nov 2003 06:15:06 +0100
From: Roger Larsson <>
Subject: [CODE RFC] redefining sched_setscheduler using LD_PRELOAD
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2003/11/14/4

Hi,
(Jack O'Quin got me thinking about rt_monitor again - thanks!)
This is an alternative to capabilities / SCHED_SOFTRR...
I use my old rt_monitor 
* protects the system on RT overload
* performs the actual setting of scheduler type
* it does not even have to be visible for lusers!
My old testprogram RT has been converted to
a library fit for preloading.
It works like this.
As root start
# rt_monitor
As normal user start latencytest
$ ./rts path/to/latencytest none 2 128 10
rts has two options
	-i	do not raise the priority.
	-v	be more verbose.
* It does also limit the effective min/max range.
Do also try (don't try this as root unless rt_monitor is running)
$ ./rts path/to/latencytest none 2 1024 99
* In this case rt_monitor captures the process and renices it.
  (SCHED_OTHER + nice)
BUGS:
* better build and installation system
* could ignore RT processes already running when rt_monitor starts
* rt_monitor functionallity has not been reverified...
* it can't lock memory :-( No PIDs in calls.
* code that checks uid before using the redefined functions won't work
  (I have an modified latencytest)
* client get stuck if there is no monitor running.
/RogerL
-- 
Roger Larsson
Skellefte√•
Sweden
[unhandled content-type:application/x-zip]