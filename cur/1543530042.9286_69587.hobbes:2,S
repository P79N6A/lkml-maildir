Date: Tue, 14 Mar 2000 15:28:07 -0600
From: Michael Gerdts <>
Subject: pre-patch-2.3.52-3: sparc compile problem personality.h
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2000/3/15/110

Some problems come up in compiling 2.3.51 + pre-patch-2.3.52-3.  The exact
message was lost in my scrollback buffer, so I don't have the exact text.
Anyway, prepatch 2.3.52-3 added 
    put_exec_domain(current->exec_domain);
to linux/arch/sparc/kernel/sys_solaris.c.  put_exec_domain is a macro
defined in personality.h, which makes use of __MOD_DEC_USE_COUNT.  Since
neither sys_solaris.c nor personality.h include <linux/module.h>, the
__MOD_DEC_USE_COUNT macro is not expanded.  The proposed fix is attached.
An alternative patch would be to add 
#include <linux/module.h> 
to sys_solaris.c before 
#include <linux/personality.h>
Mike
-- 
Mike Gerdts
UNIX Systems Administrator
Computer-Aided Engineering Center
University of Wisconsin - Madison
*** linux/include/linux/personality.h.orig	Tue Mar 14 15:16:14 2000
--- linux/include/linux/personality.h	Tue Mar 14 14:57:15 2000
***************
*** 3,8 ****
--- 3,9 ----
  
  #include <linux/linkage.h>
  #include <linux/ptrace.h>
+ #include <linux/module.h>
  
  
  /* Flags for bug emulation. These occupy the top three bytes. */