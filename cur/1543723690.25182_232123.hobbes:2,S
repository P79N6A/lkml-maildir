Date: Mon, 05 Jul 2004 01:36:42 +0900
From: OGAWA Hirofumi <>
Subject: Re: [BUG] FAT broken in 2.6.7-bk15
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2004/7/4/70

Ali Akcaagac <aliakc@web.de> writes:
> Ok after some further research I figured this out. My last working
> version of the Linux Kernel was 2.6.7 which worked with my rescue
> system. I now applied the bk* patches upwards to check which one caused
> the issue and I figured that this happened between bk3 to bk4 (so the
> problem occoured with the bk4 patch). The diskimage was created with
> mtools 3.9.9 and worked perfectly before.
Ah, my fault. I changed the handling of "codepage" options, but it wasn't
mentioned on changelog at all. (Sorry, I didn't notice this changes.)
Now, the codepage option recognizes only real NLS codepage module.
(It uses FAT_DEFAULT_CODEPAGE, not NLS_DEFAULT. And FAT_DEFAULT_CODEPAGE
only recognizes the numbers.)
Previously, it recognized/loaded all NLS modules via CONFIG_NLS_DEFAULT,
if it can't load the nls_cp437.ko or specified codepage.
But this is seriously wrong. For example, if fatfs using the
nls_utf8.ko for codepage, it will store the wrong 8.3-alias to
disk. (At least, windows can't read this. And several peoples reported
this problem.)
Anyway, could you please check FAT_DEFAULT_CODE/FAT_DEFAULT_IOCHARSET
and NLS_xxx in your .config.
Yes, this should be done automatically by config system. However...
-- 
OGAWA Hirofumi <hirofumi@mail.parknet.co.jp>
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.kernel.org
More majordomo info at  
http://vger.kernel.org/majordomo-info.html
Please read the FAQ at  
http://www.tux.org/lkml/