Date: Fri, 14 May 2004 22:37:36 -0700
From: Bryan O'Sullivan <>
Subject: Re: [PATCH][3/7] perfctr-2.7.2 for 2.6.6-mm2: x86_64
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2004/5/15/3

On Fri, 2004-05-14 at 08:14, Andi Kleen wrote:
> Before merging all that I would definitely recommend some generic
> module to allocate performance counters. IBM had a patch for this
> long ago, and it is even more needed now.
That's currently handled in user space, by PAPI (which sits on top of
perfctr).  One reason *not* to do it in the kernel is the bloat it would
entail; just look at the horrendous mess that is the P4 performance
counter event selector.
> Why do you check for K8 C stepping? I don't see any code that
> does anything special with that.
The reason it's interesting at all is that it's the first K8 stepping
that introduces new performance counter unit masks.  The kernel driver
already passes its notion of what the CPU type is up to userspace. 
(Clearly, userspace could figure this out, since it's just parsing the
cpuid instruction.)
It also checks the CPU type in a few places internally; it just doesn't
happen to care internally about K8 stepping C.  Thoroughness?
	<b
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.kernel.org
More majordomo info at  
http://vger.kernel.org/majordomo-info.html
Please read the FAQ at  
http://www.tux.org/lkml/