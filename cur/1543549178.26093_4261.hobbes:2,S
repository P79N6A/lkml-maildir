Date: Wed, 20 Sep 2000 03:17:44 +0900
From: Hisaaki Shibata <>
Subject: Re: stuck on TLB IPI wait (CPU#0) at 2.2.17+reiserfs+ide+raid
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2000/9/19/28

Thanks, Chris Mason,
> > few weeks ago, I installed a PROMISE Ultra66 IDE card into my SMP Linux
> > box. But my box sometimes hang up at high load average with "stuck on TLB
> > IPI wait (CPU#0)" messages.
> > My kernel is linux-2.2.17 with following patches.
> > linux-2.2.17-reiserfs-3.5.25-patch.gz
> > ide.2.2.17.all.20000904.patch.bz2
> > raid-2.2.17-A0
> This is a known issue with the way reiserfs uses the scheduler task queue.
> The following patch from Andi Kleen should take care of it for you:
> 
> --- linux/kernel/sched.c-o	Wed Feb  9 14:27:20 2000
> +++ linux/kernel/sched.c	Wed Mar 29 12:53:41 2000
> @@ -803,6 +803,7 @@
>  	goto handle_bh_back;
> 
>  handle_tq_scheduler:
> +	__sti(); 
>  	run_task_queue(&tq_scheduler);
>  	goto tq_scheduler_back;
After using this patch, My linux box work very well with high load average
and heavy disk access application like encoding MP3s.
Thank you very much and best regards,
-- 
 WWWWW  shibata@luky.org
 |O-O|  Hisaaki Shibata @ Fukuoka-shi JAPAN
0(mmm)0 P-mail: 070-5419-3233    IRC: #luky
   ~    
http://his.luky.org/
 last update:2000.3.12
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.kernel.org
Please read the FAQ at 
http://www.tux.org/lkml/