Date: Wed, 28 Apr 1999 02:53:51 -0400
From:  sphilp@ameritec ...
Subject: Slow copies between IDE interfaces
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/1999/4/28/7

Hello,
I'm wondering if the performance I'm seeing from a simple file copy from a
VFAT partition to a ext2 partition is normal or if I've got something
configured horribly wrong.  Here's the info...
/dev/hda is a Quantum Bigfoot 6.4G drive with a single VFAT partition on it.
/dev/hdc is a Maxtor 7G drive containing 2 ext2 partitions and a swap partition.
The file in question is stored on /dev/hda, and being copied to /dev/hdc.
Here's how I timed it:
[root@tippy Club_Mix_97]# time cp "/mnt/windows/CD Rips/Club_Mix_97/audio_02.wav" .
0.01user 2.01system 2:16.88elapsed 1%CPU (0avgtext+0avgdata 0maxresident)k
0inputs+0outputs (11520major+10minor)pagefaults 0swaps
[root@tippy Club_Mix_97]# ls -l audio_02.wav 
-rwxr-xr-x   1 root     root     46840124 Apr 28 02:37 audio_02.wav
Now, color me reactionary, but that seems a little slow.  It translates into
something around 350k/sec.   Is this the best it gets, or have I screwed the 
pooch on this?
I'm running 2.2.6-ac1, with the VIA DMA stuff activated.  I didn't get any
difference in speed from the copy if I turned off DMA on both drives via
hdparm.  Here is dmesg's version of the hardware detection at boot:
Linux version 2.2.6-ac1 (root@tippy) (gcc version 2.7.2.3) #7 Tue Apr 20 04:17:37 EDT 1999
Detected 335833504 Hz processor.
Console: colour VGA+ 80x25
Calibrating delay loop... 670.11 BogoMIPS
Memory: 128240k/131072k available (836k kernel code, 408k reserved, 1524k data, 64k init)
CPU: AMD AMD-K6(tm) 3D processor stepping 00
Checking 386/387 coupling... OK, FPU using exception 16 error reporting.
Checking 'hlt' instruction... OK.
POSIX conformance testing by UNIFIX
PCI: PCI BIOS revision 2.10 entry at 0xfb330
PCI: Using configuration type 1
PCI: Probing PCI hardware
PCI: 00:3b [1106/3040/000604] has unknown header type 00, ignoring.
PCI: 00:38 [1106/0586]: Work around ISA DMA hangs (00)
Activating ISA DMA hang workarounds.
Linux NET4.0 for Linux 2.2
Based upon Swansea University Computer Society NET3.039
NET4: Unix domain sockets 1.0 for Linux NET4.0.
NET4: Linux TCP/IP 1.0 for NET4.0
IP Protocols: ICMP, UDP, TCP
Starting kswapd v 1.5 
parport0: PC-style at 0x378 [SPP,ECP,ECPEPP,ECPPS2]
parport0: detected irq 7; use procfs to enable interrupt-driven operation.
matroxfb: Matrox MGA-G200 (AGP) detected
matroxfb: 1280x1024x24bpp (virtual: 1280x2183)
matroxfb: framebuffer at 0xEC000000, mapped to 0xc8805000, size 8388608
Console: switching to colour frame buffer device 160x64
fb0: MATROX VGA frame buffer device
Detected PS/2 Mouse Port.
Serial driver version 4.27 with no serial options enabled
ttyS00 at 0x03f8 (irq = 4) is a 16550A
ttyS01 at 0x02f8 (irq = 3) is a 16550A
lp0: using parport0 (polling).
es1371: version v0.11 time 04:18:56 Apr 20 1999
es1371: found adapter at io 0xe800 irq 10
es1371: features: joystick 0x200
es1371: codec vendor TRA revision 3
es1371: codec features none
es1371: stereo enhancement: no 3D stereo enhancement
js: Version 1.2.13 using 335 MHz RDTSC timer.
js0: SideWinder GamePad at 0x201
VP_IDE: IDE controller on PCI bus 00 dev 39
VP_IDE: not 100% native mode: will probe irqs later
    ide0: BM-DMA at 0xe400-0xe407, BIOS settings: hda:DMA, hdb:DMA
ide0: VIA Bus-Master (U)DMA Timing Config Success
    ide1: BM-DMA at 0xe408-0xe40f, BIOS settings: hdc:DMA, hdd:DMA
ide1: VIA Bus-Master (U)DMA Timing Config Success
hda: QUANTUM BIGFOOT_CY6480A, ATA DISK drive
hdb: CD-ROM CDU701, ATAPI CDROM drive
hdc: Maxtor 87000A8, ATA DISK drive
hdd: probing with STATUS(0x00) instead of ALTSTATUS(0x50)
hdd: probing with STATUS(0x00) instead of ALTSTATUS(0x50)
ide0 at 0x1f0-0x1f7,0x3f6 on irq 14
ide1 at 0x170-0x177,0x376 on irq 15
hda: QUANTUM BIGFOOT_CY6480A, 6204MB w/67kB Cache, CHS=790/255/63, DMA
hdc: Maxtor 87000A8, 6679MB w/256kB Cache, CHS=14475/15/63, (U)DMA
hdb: ATAPI 14X CD-ROM drive, 128kB Cache
Uniform CDROM driver Revision: 2.54
Floppy drive(s): fd0 is 1.44M
FDC 0 is a post-1991 82077
PPP: version 2.3.3 (demand dialling)
TCP compression code copyright 1989 Regents of the University of California
PPP line discipline registered.
Partition check:
 hda: hda1
 hdc: [PTBL] [851/255/63] hdc1 hdc2 hdc3
VFS: Mounted root (ext2 filesystem) readonly.
Freeing unused kernel memory: 64k freed
Adding Swap: 104416k swap-space (priority -1)
/dev/vmmon: Module vmmon registered with major=10 minor=165 tag=$Name: build-135 $ 
/dev/vmmon: vmx86 module initialized 
vmnet0: bridge peer interface eth0 not found, will wait for it to come up
vmnet0: bridge eth0 attached
registered device ppp0
-- 
Steve Philp
sphilp@ameritech.net
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.rutgers.edu
Please read the FAQ at 
http://www.tux.org/lkml/