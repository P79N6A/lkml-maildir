Date: Mon, 12 Aug 2002 16:45:21 +0200 (CEST)
From: Jan NOwaK <>
Subject: remove_proc_entry behaviour
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2002/8/12/129

Hello linux-kernel,
I'm writing a patch that uses proc filesystem, and allows creating
entries in one of /proc subdirectory. They are created by proc_mkdir
and proc_symlink. But there is a problem when they are to be removed.
I use remove_proc_entry. They are deleted, but I get the message:
remove_proc_entry: lease/test busy, count=1
de_put: deferred delete of test
I found that first line is generated by the following code in
remove_proc_entry:
        if (!atomic_read(&de->count))
                  free_proc_entry(de);
           else {
                  de->deleted = 1;
                  printk("remove_proc_entry: %s/%s busy, count=%d\n",
                           parent->name, de->name, atomic_read(&de->count));
          }
The presence of printk suggests that something goes wrong. Is it true?
What is the proper way of removing proc entry that wouldn't generate
this message? I get it although I'm sure that entry isn't used by
anything else...
nok
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.kernel.org
More majordomo info at  
http://vger.kernel.org/majordomo-info.html
Please read the FAQ at  
http://www.tux.org/lkml/