Date: Sun, 30 Jan 2000 16:10:46 -0500
From: "Markley, Todd" <>
Subject: RE: Hangs after "Loading" but before "Uncompressing"
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2000/1/30/95

 Dick:
       I installed version 2.3.40 of the linux kernel and
installed your patch. The result is that it still hangs
the same way. So now I have continued to add debugging
prints to video.S to find the exact location of the hang.
The result is that it locks up in the "basic_detect:"
routine at the first "int $0x10". It looks to me like
this routine is trying to identify the type of display.
So I tried to help out a little by changing the subroutine
to read this way:
basic_detect:
        movb    $0x1a, %al                      # 1a means VGA...
        incb    adapter
        incb    adapter
        ret
If I understand what the routine is doing then this should
return as if a VGA was detected. (I may have missed something
here, but it boots ok on another system.) The kernel will now
do the "vga=ask", and I can select mode zero. Next the system
hangs in the "restore_screen:" subroutine. Do you have any new
ideas? Is this "int $0x10" function in the motherboard BIOS or
in the video card BIOS? Could this problem have anything to do
with video BIOS shadow settings?
Todd Markley
-----Original Message-----
From: Richard B. Johnson
Subject: RE: Hangs after "Loading" but before "Uncompressing"
Try this patch:
--- linux/arch/i386/boot/video.S.orig	Thu Jan 27 10:08:19 2000
+++ linux/arch/i386/boot/video.S	Thu Jan 27 10:16:55 2000
@@ -1006,9 +1006,8 @@
 	lgsw	0x20e(%di), %si			# GS:SI=mode list
 	movw	$128, %cx			# Iteration limit
 vesa1:
-# gas version 2.9.1, using BFD version 2.9.1.0.23 buggers the next
inst.
-# XXX:	lodsw	%gs:(%si), %ax			# Get next mode in the
list
-	.byte	0x65, 0xAD			# %gs seg prefix + lodsw
+	movw	%gs:(%si), %ax
+	addw	$2, %si
 	cmpw	$0xffff, %ax			# End of the table?
 	jz	vesar
 	
Cheers,
Dick Johnson
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.rutgers.edu
Please read the FAQ at 
http://www.tux.org/lkml/