Date: Sun, 11 Feb 2007 01:26:40 -0500
From: Tejun Heo <>
Subject: Re: [patch] linux/io.h: forward declare struct pci_dev
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2007/2/11/9

Christoph Hellwig wrote:
> I haven't looked at what causes it, but any leakage of pci details
> into io.h is bogus.  I'd suggest that the original submitter fixes
> up that problem instead.
pci_iomap() depends on two things - PCI and iomap.  AFAIK, there is no 
config to test whether the current arch supports iomap or not. 
Previously it worked because those archs which don't support either one 
doesn't have set CONFIG_GENERIC_IOMAP while not implementing 
arch-specific ones && not compiling any driver which uses the iomap 
interface.  This is why pci_iomap() ended up in lib/iomap.c in the first 
place; otherwise, it cannot be conditionalized correctly as devers 
currently shows (the 'not implementing arch-specific ones' part cannot 
be easily tested).
So, it seems what we need is either 1. bogus iomap implementation for 
all archs or 2. CONFIG_IOMAP.  Hmmm... I think CONFIG_IOMAP is better as 
it will allow leaving out related devres parts (or any generic function 
using iomap).
-- 
tejun
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.kernel.org
More majordomo info at  
http://vger.kernel.org/majordomo-info.html
Please read the FAQ at  
http://www.tux.org/lkml/