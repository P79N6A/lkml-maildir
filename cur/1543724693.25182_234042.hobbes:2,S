Date: Tue, 13 Jul 2004 03:14:46 -0700
From: William Lee Irwin III <>
Subject: Re: Preempt Threshold Measurements
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2004/7/13/54

On Tue, Jul 13, 2004 at 03:48:45PM +1000, Nick Piggin wrote:
> cond_resched_lock just below this needs something similar.
Maybe it does.
Index: mm7-2.6.7/include/linux/sched.h
===================================================================
--- mm7-2.6.7.orig/include/linux/sched.h	2004-07-13 03:06:12.759495000 -0700
+++ mm7-2.6.7/include/linux/sched.h	2004-07-13 03:14:00.122445032 -0700
@@ -1053,7 +1053,8 @@
 		preempt_enable_no_resched();
 		__cond_resched();
 		spin_lock(lock);
-	}
+	} else
+		touch_preempt_timing();
 }
 
 /* Reevaluate whether the task has signals pending delivery.
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.kernel.org
More majordomo info at  
http://vger.kernel.org/majordomo-info.html
Please read the FAQ at  
http://www.tux.org/lkml/