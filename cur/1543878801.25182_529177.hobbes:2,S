Date: Tue, 10 Apr 2007 18:20:47 +0530
From: Srinivasa Ds <>
Subject: [PATCH] Build break on ppc64 for 2.6.21-rc6-mm1
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2007/4/10/105

When I tried to compile 2.6.21-rc6-mm1 on ppc64, I got the below error 
message.
======================
arch/powerpc/sysdev/timer.c:51: error: variable ‘timer_sysclass’ has 
initializer but incomplete type
arch/powerpc/sysdev/timer.c:52: error: unknown field ‘resume’ specified in 
initializer
arch/powerpc/sysdev/timer.c:52: warning: excess elements in struct initializer
arch/powerpc/sysdev/timer.c:52: warning: (near initialization 
for ‘timer_sysclass’)
arch/powerpc/sysdev/timer.c:53: error: unknown field ‘suspend’ specified in 
initializer
arch/powerpc/sysdev/timer.c:53: warning: excess elements in struct initializer
arch/powerpc/sysdev/timer.c:53: warning: (near initialization 
for ‘timer_sysclass’)
arch/powerpc/sysdev/timer.c:54: error: unknown field ‘kset’ specified in 
initializer
arch/powerpc/sysdev/timer.c:54: error: extra brace group at end of initializer
arch/powerpc/sysdev/timer.c:54: error: (near initialization 
for ‘timer_sysclass’)
arch/powerpc/sysdev/timer.c:54: error: extra brace group at end of initializer
arch/powerpc/sysdev/timer.c:54: error: (near initialization 
for ‘timer_sysclass’)
arch/powerpc/sysdev/timer.c:54: warning: excess elements in struct initializer
arch/powerpc/sysdev/timer.c:54: warning: (near initialization 
for ‘timer_sysclass’)
arch/powerpc/sysdev/timer.c:57: error: variable ‘device_timer’ has initializer 
but incomplete type
arch/powerpc/sysdev/timer.c:58: error: unknown field ‘id’ specified in 
initializer
arch/powerpc/sysdev/timer.c:58: warning: excess elements in struct initializer
arch/powerpc/sysdev/timer.c:58: warning: (near initialization 
for ‘device_timer’)
arch/powerpc/sysdev/timer.c:59: error: unknown field ‘cls’ specified in 
initializer
arch/powerpc/sysdev/timer.c:59: warning: excess elements in struct initializer
arch/powerpc/sysdev/timer.c:59: warning: (near initialization 
for ‘device_timer’)
arch/powerpc/sysdev/timer.c: In function ‘time_init_device’:
arch/powerpc/sysdev/timer.c:64: warning: implicit declaration of 
function ‘sysdev_class_register’
arch/powerpc/sysdev/timer.c:66: warning: implicit declaration of 
function ‘sysdev_register’
make[1]: *** [arch/powerpc/sysdev/timer.o] Error 1
make: *** [arch/powerpc/sysdev] Error 2
=======================================
Below patch fixes this problem. please let me know comments on this.
Signed-off-by: Srinivasa Ds <srinivasa@in.ibm.com>
---
 arch/powerpc/sysdev/timer.c |    1 +
 1 file changed, 1 insertion(+)
Index: linux-2.6.21-rc6/arch/powerpc/sysdev/timer.c
===================================================================
--- linux-2.6.21-rc6.orig/arch/powerpc/sysdev/timer.c
+++ linux-2.6.21-rc6/arch/powerpc/sysdev/timer.c
@@ -7,6 +7,7 @@
  */
 
 #include <linux/time.h>
+#include <linux/sysdev.h>
 #include <asm/rtc.h>
 
 static unsigned long suspend_rtc_time;