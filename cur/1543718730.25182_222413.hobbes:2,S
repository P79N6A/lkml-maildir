Date: Mon, 24 May 2004 17:05:04 +1000
From: Stephen Rothwell <>
Subject: Re: [PATCH] dynamic addition of virtual disks on PPC64 iSeries
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2004/5/24/33

Hi Andrew,
On Sun, 23 May 2004 23:29:20 -0700 Andrew Morton <akpm@osdl.org> wrote:
>
> Stephen Rothwell <sfr@canb.auug.org.au> wrote:
> >
> > This patch allows us to dynamically add virtual disks to an iSeries
> >  partition. It works like this: after you have created the virtual disk
> >  file on OS/400 and attached it to the Linux partition, you need to read
> >  /sys/bus/vio/drivers/viodasd/probe.  This will do the probe and list any
> >  new disks discovered.
> > 
> >  This was the nicest way I could think of doing this as the interface to
> >  the hypervisor is polled ...
> 
> Is it possible to present all the virtual disks as partitions of a single
> disk, use the "partition table" to query what is present?
The virtual disks are just that: disks.  They present as /dev/iseries/vda
etc and have their own partitions. I can't change that, I will get skinned
by current users.  It was bad enough when I removed the ide emulation hack
... :-)
(Just in case of confusion: the "Linux partition" I referred to above is a
logical partition fo the whole machine.)
> Or to generate a hotplug event when a disk is added?  Even if there's no
> notification to the kernel, it should be possible to generate the hotplug
> events in response to a /proc-based trigger.
I guess that would be possible.  In this case I am trying to do the
minimum change.
> It's a shame you didn't cc linux-kernel on this - the blockdev police would
> have better ideas than I.
I have now sent the patch to LKML and cc'd this reply there as well.
-- 
Cheers,
Stephen Rothwell                    sfr@canb.auug.org.au
http://www.canb.auug.org.au/~sfr/
[unhandled content-type:application/pgp-signature]