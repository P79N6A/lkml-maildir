Date: Tue, 10 Jan 2006 08:43:36 +0100
From: Vojtech Pavlik <>
Subject: Re: PROBLEM: PS/2 keyboard does not work with 2.6.15
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2006/1/10/41

On Mon, Jan 09, 2006 at 12:23:04PM -0500, Alan Stern wrote:
> On Mon, 9 Jan 2006, Dmitry Torokhov wrote:
> 
> > > It would be nice to know which part of the usb-handoff code causes the
> > > problem.
> > 
> > Well, it's not handoff code causing problems per se, it's just that it
> > does not look like it performs handoff. If it did then disabling USB
> > legacy emulation in BIOS would have no effect, right?
> 
> On the other hand, if the BIOS worked correctly then the ps/2 port would
> have no problems regardless of whether USB legacy emulation was on or off.  
> Given that the keyboard works during bootup, I see only two possibilities:
> 
> 	The USB handoff code somehow causes the BIOS to mess up the
> 	state of the 8042;
> 
> 	The 8042 driver interacts badly with the firmware when USB
> 	legacy emulation is on, and the USB handoff code doesn't
> 	successfully turn off legacy emulation.
It's usually that the BIOS does an incomplete emulation of the i8042
chip, while still getting in the way to the real i8042. Usually GRUB and
DOS don't care about sending any commands to the i8042, and so they
work. The Linux i8042.c driver needs to use them to enable the PS/2
mouse port and do other probing, and if the commans are not working, it
just bails out.
The question of course is why the handoff code doesn't work on that
platform.
-- 
Vojtech Pavlik
SuSE Labs, SuSE CR
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.kernel.org
More majordomo info at  
http://vger.kernel.org/majordomo-info.html
Please read the FAQ at  
http://www.tux.org/lkml/