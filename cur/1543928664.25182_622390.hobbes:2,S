Date: Thu, 29 Nov 2007 10:02:55 +0200
From: "Pekka Enberg" <>
Subject: Re: [RFC] kmemcheck: trap uses of uninitialized memory (v2)
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2007/11/29/40

Hi Vegard,
On Nov 27, 2007 5:16 PM, Vegard Nossum <vegard.nossum@gmail.com> wrote:
> +config KMEMCHECK
> +       bool "Trap use of uninitialized memory"
> +       depends on X86_32 && !CC_OPTIMIZE_FOR_SIZE
> +       help
> +         This option enables tracing of dynamically allocated kernel memory
> +         to see if memory is used before it has been given an initial value.
> +         Be aware that this requires half of your memory for bookkeeping and
> +         will insert extra code at *every* read and write to tracked memory
> +         thus slow down the kernel code (but user code is unaffected).
Is it really necessary to track every memory address? Tracking slab
objects would require far less memory. You might also want to make
kzalloc() and GFP_ZERO mark the memory area as initialized to avoid
some page faults.
On Nov 27, 2007 5:16 PM, Vegard Nossum <vegard.nossum@gmail.com> wrote:
> +       /* Actually allocate twice as much, since we need to track the
> +        * status of each byte within the allocation. */
> +       if (!(flags & __GFP_NOTRACK)) {
If you change __GFP_NOTRACK to __GFP_TRACK, you can avoid the double
negation here.
                                    Pekka
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.kernel.org
More majordomo info at  
http://vger.kernel.org/majordomo-info.html
Please read the FAQ at  
http://www.tux.org/lkml/