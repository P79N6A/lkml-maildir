Date: Mon, 10 Jan 2005 03:11:09 +0100
From: Marc Lehmann <>
Subject: sockets stuck in FIN_WAIT2 and CLOSE_WAIT state in 2.6.10
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2005/1/9/137

After upgrading to linux-2.6.10 (on 2004-12-26), my rsh processes start to
hang despite the server side having closed the connection.
Inspection showed that one of the two rsh processes exited:
   16011 ?        SN     0:00      0     6  1717   600  0.0 rsh ruth cd xmltv && ./upd
   16012 ?        ZN     0:00      0     0     0     0  0.0 [rsh] <defunct>
lsof shows both sockets:
   rsh     16011 root    3u  IPv4 6454542          TCP doom:1014->ruth:shell (FIN_WAIT2)
   rsh     16011 root    5u  IPv4 6454545          TCP doom:1013->ruth:1023 (CLOSE_WAIT)
and the remaining rsh process hangs in select on the FIN_WAIT2 socket:
   select(6, [3], NULL, NULL, NULL
Some of the hung processes are stuck for 14 days now.
I did not have the same problem with 2.6.10-rc1, or 2.6.8.1, which I used
before.
This is on a x86 SMP kernel using Debian GNU/Linux. If this problem is
already known, my apologies, I couldn't access a kernel list archive. If
you want more info, feel free to contact me.
-- 
                The choice of a
      -----==-     _GNU_
      ----==-- _       generation     Marc Lehmann
      ---==---(_)__  __ ____  __      pcg@goof.com
      --==---/ / _ \/ // /\ \/ /      
http://schmorp.de/
      -=====/_/_//_/\_,_/ /_/\_\      XX11-RIPE
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.kernel.org
More majordomo info at  
http://vger.kernel.org/majordomo-info.html
Please read the FAQ at  
http://www.tux.org/lkml/