Date: Wed, 17 Dec 2008 23:15:35 +0800
From: 	tom.leiming@gmail ...
Subject: [PATCH] driver core:fix duplicate removing driver link in __device_release_driver
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2008/12/17/217

From: Ming Lei <tom.leiming@gmail.com>
In __device_release_driver(),driver_sysfs_remove() has removed the
driver link under device dir in sysfs, but sysfs_remove_link() is
called again to do such thing. Remove the duplicate call to
sys_remove_link().
Signed-off-by: Ming Lei <tom.leiming@gmail.com>
---
 drivers/base/dd.c |    1 -
 1 files changed, 0 insertions(+), 1 deletions(-)
diff --git a/drivers/base/dd.c b/drivers/base/dd.c
index 20febc0..2a0b8cc 100644
--- a/drivers/base/dd.c
+++ b/drivers/base/dd.c
@@ -298,7 +298,6 @@ static void __device_release_driver(struct device *dev)
 	drv = dev->driver;
 	if (drv) {
 		driver_sysfs_remove(dev);
-		sysfs_remove_link(&dev->kobj, "driver");
 
 		if (dev->bus)
 			blocking_notifier_call_chain(&dev->bus->p->bus_notifier,
-- 
1.6.0