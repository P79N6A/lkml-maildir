Date: Mon, 19 Aug 2002 17:09:01 +0200
From: Michael Dreher <>
Subject: 2.4.20-pre2-ac2 pcmcia panic
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2002/8/19/102

Hi Alan, Hi David,
somehow IDE over PCMCIA has stopped working.
2.4.20-pre2 with pcmcia-cs-3.2.1 is OK (dmesg and lspci -v are attached).
2.4.20-pre2-ac2 with pcmcia-cs-3.2.1 locks the box and makes 2 LEDs blink.
Nothing in the logs, unfortunately no serial console (this is my only 
computer at the moment).
2.4.19-ac4 with pcmcia-cs-3.1.33 shows the same symptoms.
2.4.19-ac4 with pcmcia-cs-3.1.34 does not lock up, but also does not work.
Kernel pcmcia never worked on this box, so I had to resort to the version of
David Hinds.
I could not try 2.4.20-pre2-ac4, since it boots extremely slow.
All usb related messages come after some long timeout only, and somewhere
in init it stops.
sorry for this vague description. If you need more info, just ask.
Best regards,
Michael
Linux version 2.4.20-pre2 (root@karpfen) (gcc version 2.95.3 20010315 (SuSE)) #3 Mon Aug 19 14:13:20 CEST 2002
BIOS-provided physical RAM map:
 BIOS-e820: 0000000000000000 - 000000000009b000 (usable)
 BIOS-e820: 000000000009b000 - 00000000000a0000 (reserved)
 BIOS-e820: 00000000000c0000 - 00000000000d0000 (reserved)
 BIOS-e820: 00000000000dc000 - 00000000000e0000 (reserved)
 BIOS-e820: 00000000000e4000 - 0000000000100000 (reserved)
 BIOS-e820: 0000000000100000 - 000000000eef0000 (usable)
 BIOS-e820: 000000000eef0000 - 000000000eeff000 (ACPI data)
 BIOS-e820: 000000000eeff000 - 000000000ef00000 (ACPI NVS)
 BIOS-e820: 000000000ef00000 - 000000000f000000 (usable)
 BIOS-e820: 00000000fff80000 - 0000000100000000 (reserved)
240MB LOWMEM available.
On node 0 totalpages: 61440
zone(0): 4096 pages.
zone(1): 57344 pages.
zone(2): 0 pages.
Sony Vaio laptop detected.
Kernel command line: BOOT_IMAGE=linux20pre2 ro root=303 BOOT_FILE=/boot/vmlinuz-2.4.20-pre2 sonypi=251,1,1,1
Initializing CPU#0
Detected 727.811 MHz processor.
Console: colour VGA+ 80x25
Calibrating delay loop... 1405.74 BogoMIPS
Memory: 240304k/245760k available (1438k kernel code, 4988k reserved, 576k data, 80k init, 0k highmem)
Dentry cache hash table entries: 32768 (order: 6, 262144 bytes)
Inode cache hash table entries: 16384 (order: 5, 131072 bytes)
Mount-cache hash table entries: 4096 (order: 3, 32768 bytes)
Buffer-cache hash table entries: 16384 (order: 4, 65536 bytes)
Page-cache hash table entries: 65536 (order: 6, 262144 bytes)
CPU: Before vendor init, caps: 0084893f 0081813f 0000000e, vendor = 7
CPU: L1 I Cache: 64K (64 bytes/line), D cache 64K (32 bytes/line)
CPU: L2 Cache: 512K (128 bytes/line)
CPU: Processor revision 1.4.0.3, 733 MHz
CPU: Code Morphing Software revision 4.2.7-8-278
CPU: 20011004 02:04 official release 4.2.7#7
CPU: After vendor init, caps: 0084893f 0081813f 0000000e 00000000
CPU serial number disabled.
CPU:     After generic, caps: 0080893f 0081813f 0000000e 00000000
CPU:             Common caps: 0080893f 0081813f 0000000e 00000000
CPU: Transmeta(tm) Crusoe(tm) Processor TM5800 stepping 03
Checking 'hlt' instruction... OK.
POSIX conformance testing by UNIFIX
mtrr: v1.40 (20010327) Richard Gooch (rgooch@atnf.csiro.au)
mtrr: detected mtrr type: none
PCI: PCI BIOS revision 2.10 entry at 0xfd85e, last bus=0
PCI: Using configuration type 1
PCI: Probing PCI hardware
PCI: Using IRQ router ALI [10b9/1533] at 00:07.0
PCI: Found IRQ 9 for device 00:12.0
PCI: Sharing IRQ 9 with 00:0a.0
PCI: Sharing IRQ 9 with 00:0b.0
Linux NET4.0 for Linux 2.4
Based upon Swansea University Computer Society NET3.039
Initializing RT netlink socket
BlueZ Core ver 2.2 Copyright (C) 2000,2001 Qualcomm Inc
Written 2000,2001 by Maxim Krasnyansky <maxk@qualcomm.com>
apm: BIOS version 1.2 Flags 0x0b (Driver version 1.16)
Starting kswapd
Journalled Block Device driver loaded
ACPI: APM is already active, exiting
pty: 256 Unix98 ptys configured
Serial driver version 5.05c (2001-07-08) with MANY_PORTS SHARE_IRQ SERIAL_PCI enabled
PCI: Found IRQ 9 for device 00:08.0
Redundant entry in serial pci_table.  Please send the output of
lspci -vv, this message (10b9,5457,104d,80ec)
and the manufacturer and name of serial board or modem board
to serial-pci-info@lists.sourceforge.net.
register_serial(): autoconfig failed
sonypi: unknown event port1=0x2f,port2=0x08
sonypi: unknown event port1=0x00,port2=0x00
sonypi: unknown event port1=0x2f,port2=0x08
sonypi: Sony Programmable I/O Controller Driver v1.13.
sonypi: detected type2 model, verbose = on, fnkeyinit = on, camera = on, compat = off, nojogdial = off
sonypi: enabled at irq=11, port1=0x1080, port2=0x1084
Real Time Clock Driver v1.10e
Uniform Multi-Platform E-IDE driver Revision: 6.31
ide: Assuming 33MHz system bus speed for PIO modes; override with idebus=xx
ALI15X3: IDE controller on PCI bus 00 dev 80
ALI15X3: detected chipset, but driver not compiled in!
PCI: No IRQ known for interrupt pin A of device 00:10.0. Please try using pci=biosirq.
ALI15X3: chipset revision 196
ALI15X3: not 100% native mode: will probe irqs later
hda: IC25N030ATDA04-0, ATA DISK drive
ide0 at 0x1f0-0x1f7,0x3f6 on irq 14
hda: 58605120 sectors (30006 MB) w/1806KiB Cache, CHS=3648/255/63
Partition check:
 hda: hda1 hda2 < hda5 hda6 > hda3 hda4
PPP generic driver version 2.4.2
PPP Deflate Compression module registered
PPP BSD Compression module registered
8139too Fast Ethernet driver 0.9.26
PCI: Found IRQ 9 for device 00:0b.0
PCI: Sharing IRQ 9 with 00:0a.0
PCI: Sharing IRQ 9 with 00:12.0
eth0: RealTek RTL8139 Fast Ethernet at 0xcf800800, 08:00:46:46:db:0c, IRQ 9
eth0:  Identified 8139 chip type 'RTL-8139C'
Linux video capture interface: v1.00
SCSI subsystem driver Revision: 1.00
kmod: failed to exec /sbin/modprobe -s -k scsi_hostadapter, errno = 2
usb.c: registered new driver usbdevfs
usb.c: registered new driver hub
PCI: Found IRQ 9 for device 00:0f.0
usb-ohci.c: USB OHCI at membase 0xcf802000, IRQ 9
usb-ohci.c: usb-00:0f.0, Acer Laboratories Inc. [ALi] USB 1.1 Controller
usb.c: new USB bus registered, assigned bus number 1
usb.c: kmalloc IF c129fca0, numif 1
usb.c: new device strings: Mfr=0, Product=2, SerialNumber=1
usb.c: USB device number 1 default language ID 0x0
Product: USB OHCI Root Hub
SerialNumber: cf802000
hub.c: USB hub found
hub.c: 2 ports detected
hub.c: standalone hub
hub.c: ganged power switching
hub.c: global over-current protection
hub.c: Port indicators are not supported
hub.c: power on to power good time: 2ms
hub.c: hub controller current requirement: 0mA
hub.c: port removable status: RR
hub.c: local power source is good
hub.c: no over-current condition exists
hub.c: enabling power on all ports
usb.c: hub driver claimed interface c129fca0
usb.c: kusbd: /sbin/hotplug add 1
usb.c: kusbd policy returned 0xfffffffe
PCI: Found IRQ 9 for device 00:14.0
usb-ohci.c: USB OHCI at membase 0xc00e0000, IRQ 9
usb-ohci.c: usb-00:14.0, Acer Laboratories Inc. [ALi] USB 1.1 Controller (#2)
usb.c: new USB bus registered, assigned bus number 2
usb.c: kmalloc IF c129fdc0, numif 1
usb.c: new device strings: Mfr=0, Product=2, SerialNumber=1
usb.c: USB device number 1 default language ID 0x0
Product: USB OHCI Root Hub
SerialNumber: c00e0000
hub.c: USB hub found
hub.c: 2 ports detected
hub.c: standalone hub
hub.c: ganged power switching
hub.c: global over-current protection
hub.c: Port indicators are not supported
hub.c: power on to power good time: 2ms
hub.c: hub controller current requirement: 0mA
hub.c: port removable status: RR
hub.c: local power source is good
hub.c: no over-current condition exists
hub.c: enabling power on all ports
usb.c: hub driver claimed interface c129fdc0
usb.c: kusbd: /sbin/hotplug add 1
usb.c: kusbd policy returned 0xfffffffe
usb.c: registered new driver hiddev
usb.c: registered new driver hid
hid-core.c: v1.8.1 Andreas Gal, Vojtech Pavlik <vojtech@suse.cz>
hid-core.c: USB HID support drivers
usb.c: registered new driver acm
acm.c: v0.21:USB Abstract Control Model driver for USB modems and ISDN adapters
usb.c: registered new driver usblp
printer.c: v0.11: USB Printer Device Class driver
bluetooth.c: USB Bluetooth support registered
usb.c: registered new driver bluetooth
bluetooth.c: USB Bluetooth tty driver v0.12
Initializing USB Mass Storage driver...
usb.c: registered new driver usb-storage
USB Mass Storage support registered.
mice: PS/2 mouse device common for all mice
NET4: Linux TCP/IP 1.0 for NET4.0
IP Protocols: ICMP, UDP, TCP, IGMP
IP: routing cache hash table of 2048 buckets, 16Kbytes
TCP: Hash tables configured (established 16384 bind 16384)
NET4: Unix domain sockets 1.0/SMP for Linux NET4.0.
BlueZ L2CAP ver 2.1 Copyright (C) 2000,2001 Qualcomm Inc
Written 2000,2001 by Maxim Krasnyansky <maxk@qualcomm.com>
BlueZ SCO ver 0.3 Copyright (C) 2000,2001 Qualcomm Inc
Written 2000,2001 by Maxim Krasnyansky <maxk@qualcomm.com>
EXT3-fs: INFO: recovery required on readonly filesystem.
EXT3-fs: write access will be enabled during recovery.
hub.c: port 1, portstatus 101, change 1, 12 Mb/s
hub.c: port 1 connection change
hub.c: port 1, portstatus 101, change 1, 12 Mb/s
hub.c: port 1, portstatus 101, change 0, 12 Mb/s
hub.c: port 1, portstatus 101, change 0, 12 Mb/s
hub.c: port 1, portstatus 101, change 0, 12 Mb/s
hub.c: port 1, portstatus 101, change 0, 12 Mb/s
hub.c: port 1, portstatus 103, change 10, 12 Mb/s
hub.c: USB new device connect on bus1/1, assigned device number 2
usb.c: kmalloc IF c129ff40, numif 1
usb.c: new device strings: Mfr=1, Product=2, SerialNumber=0
usb.c: USB device number 2 default language ID 0x409
Manufacturer: Sony
Product: USB Memory Stick Slot
scsi0 : SCSI emulation for USB Mass Storage devices
  Vendor: Sony      Model: MSC-U02           Rev: 1.00
  Type:   Direct-Access                      ANSI SCSI revision: 02
WARNING: USB Mass Storage data integrity not assured
USB Mass Storage device found at 2
usb.c: usb-storage driver claimed interface c129ff40
usb.c: kusbd: /sbin/hotplug add 2
usb.c: kusbd policy returned 0xfffffffe
hub.c: port 2, portstatus 100, change 0, 12 Mb/s
hub.c: port 1, portstatus 301, change 1, 1.5 Mb/s
hub.c: port 1 connection change
hub.c: port 1, portstatus 301, change 1, 1.5 Mb/s
hub.c: port 1, portstatus 301, change 0, 1.5 Mb/s
hub.c: port 1, portstatus 301, change 0, 1.5 Mb/s
hub.c: port 1, portstatus 301, change 0, 1.5 Mb/s
hub.c: port 1, portstatus 301, change 0, 1.5 Mb/s
hub.c: port 1, portstatus 303, change 10, 1.5 Mb/s
hub.c: USB new device connect on bus2/1, assigned device number 2
usb.c: kmalloc IF cef62380, numif 1
usb.c: skipped 1 class/vendor specific interface descriptors
usb.c: new device strings: Mfr=1, Product=2, SerialNumber=0
usb.c: USB device number 2 default language ID 0x409
Manufacturer: ELECOM
Product: ELECOM USB mouse with wheel 
input0: USB HID v1.10 Mouse [ELECOM ELECOM USB mouse with wheel ] on usb2:2.0
usb.c: hid driver claimed interface cef62380
usb.c: kusbd: /sbin/hotplug add 2
usb.c: kusbd policy returned 0xfffffffe
hub.c: port 2, portstatus 100, change 0, 12 Mb/s
(recovery.c, 254): journal_recover: JBD: recovery, exit status 0, recovered transactions 59163 to 59219
(recovery.c, 256): journal_recover: JBD: Replayed 357 and revoked 0/1 blocks
kjournald starting.  Commit interval 5 seconds
EXT3-fs: ide0(3,3): orphan cleanup on readonly fs
ext3_orphan_cleanup: deleting unreferenced inode 392762
ext3_orphan_cleanup: deleting unreferenced inode 103598
EXT3-fs: ide0(3,3): 2 orphan inodes deleted
EXT3-fs: recovery complete.
EXT3-fs: mounted filesystem with ordered data mode.
VFS: Mounted root (ext3 filesystem) readonly.
Freeing unused kernel memory: 80k freed
EXT3 FS 2.4-0.9.17, 10 Jan 2002 on ide0(3,3), internal journal
kjournald starting.  Commit interval 5 seconds
EXT3 FS 2.4-0.9.17, 10 Jan 2002 on ide0(3,4), internal journal
EXT3-fs: mounted filesystem with ordered data mode.
Adding Swap: 299992k swap-space (priority -1)
Linux PCMCIA Card Services 3.2.1
  kernel build: 2.4.20-pre2 #3 Mon Aug 19 14:13:20 CEST 2002
  options:  [pci] [cardbus] [apm]
Intel ISA/PCI/CardBus PCIC probe:
PCI: Found IRQ 9 for device 00:12.0
PCI: Sharing IRQ 9 with 00:0a.0
PCI: Sharing IRQ 9 with 00:0b.0
  Ricoh RL5C475 rev 80 PCI-to-CardBus at slot 00:12, mem 0x10000000
    host opts [0]: [serial irq] [io 3/6/1] [mem 3/6/1] [pci irq 9] [lat 168/176] [bus 1/1]
    ISA irqs (default) = 3,4,5,7,10,12,15 PCI status changes
eth0: Setting 100mbps full-duplex based on auto-negotiated partner ability 45e1.
eth0: Promiscuous mode enabled.
device eth0 entered promiscuous mode
meye: using 2 buffers with 600k (1200k total) for capture
cs: memory probe 0xa0000000-0xa0ffffff: clean.
cs: IO port probe 0x0100-0x04ff: excluding 0x200-0x207 0x220-0x22f 0x330-0x337 0x388-0x38f 0x3c0-0x3df 0x408-0x40f 0x480-0x48f 0x4d0-0x4d7
cs: IO port probe 0x0208-0x021f: clean.
cs: IO port probe 0x0230-0x032f: clean.
cs: IO port probe 0x0338-0x0387: clean.
cs: IO port probe 0x0390-0x03bf: clean.
cs: IO port probe 0x03e0-0x0407: clean.
cs: IO port probe 0x0410-0x047f: clean.
cs: IO port probe 0x0490-0x04cf: clean.
cs: IO port probe 0x04d8-0x04ff: clean.
cs: IO port probe 0x0800-0x08ff: clean.
cs: IO port probe 0x0a00-0x0aff: clean.
cs: IO port probe 0x0c00-0x0cff: clean.
hde: CD-224E, ATAPI CD/DVD-ROM drive
ide2 at 0x180-0x187,0x386 on irq 3
ide-cs: hde: Vcc = 5.0, Vpp = 0.0
hde: bad special flag: 0x03
00:00.0 Host bridge: Transmeta Corporation: Unknown device 0395 (rev 01)
	Subsystem: Sony Corporation: Unknown device 80ec
	Flags: bus master, medium devsel, latency 0
	Memory at e8100000 (32-bit, non-prefetchable) [size=1M]
00:00.1 RAM memory: Transmeta Corporation: Unknown device 0396
	Subsystem: Sony Corporation: Unknown device 80ec
	Flags: fast devsel
00:00.2 RAM memory: Transmeta Corporation: Unknown device 0397
	Subsystem: Sony Corporation: Unknown device 80ec
	Flags: fast devsel
00:06.0 Multimedia audio controller: Acer Laboratories Inc. [ALi]: Unknown device 5451 (rev 02)
	Subsystem: Sony Corporation: Unknown device 80ec
	Flags: bus master, medium devsel, latency 64, IRQ 9
	I/O ports at 1400 [size=256]
	Memory at e8014000 (32-bit, non-prefetchable) [size=4K]
	Capabilities: [dc] Power Management version 2
00:07.0 ISA bridge: Acer Laboratories Inc. [ALi] M1533 PCI to ISA Bridge [Aladdin IV]
	Subsystem: Sony Corporation: Unknown device 80ec
	Flags: bus master, medium devsel, latency 0
	Capabilities: [a0] Power Management version 1
00:08.0 Modem: Acer Laboratories Inc. [ALi]: Unknown device 5457 (prog-if 00 [Generic])
	Subsystem: Sony Corporation: Unknown device 80ec
	Flags: medium devsel, IRQ 9
	Memory at e8015000 (32-bit, non-prefetchable) [size=4K]
	I/O ports at 1800 [size=256]
	Capabilities: [40] Power Management version 2
00:09.0 FireWire (IEEE 1394): Texas Instruments: Unknown device 8021 (rev 02) (prog-if 10 [OHCI])
	Subsystem: Sony Corporation: Unknown device 80ec
	Flags: medium devsel, IRQ 9
	Memory at e8018000 (32-bit, non-prefetchable) [size=2K]
	Memory at e8010000 (32-bit, non-prefetchable) [size=16K]
	Capabilities: [44] Power Management version 2
00:0a.0 Multimedia controller: Citicorp TTI: Unknown device 2011
	Subsystem: Sony Corporation: Unknown device 80ec
	Flags: medium devsel, IRQ 9
	I/O ports at 1c00 [size=256]
	Memory at e8200000 (32-bit, non-prefetchable) [size=1M]
	Capabilities: [40] Power Management version 2
00:0b.0 Ethernet controller: Realtek Semiconductor Co., Ltd. RTL-8139 (rev 10)
	Subsystem: Sony Corporation: Unknown device 80ec
	Flags: bus master, medium devsel, latency 64, IRQ 9
	I/O ports at 2000 [size=256]
	Memory at e8018800 (32-bit, non-prefetchable) [size=256]
	Capabilities: [50] Power Management version 2
00:0c.0 VGA compatible controller: ATI Technologies Inc: Unknown device 4c59 (prog-if 00 [VGA])
	Subsystem: Sony Corporation: Unknown device 80ec
	Flags: stepping, medium devsel, IRQ 9
	Memory at f0000000 (32-bit, prefetchable) [size=128M]
	I/O ports at 2400 [size=256]
	Memory at e8000000 (32-bit, non-prefetchable) [size=64K]
	Expansion ROM at <unassigned> [disabled] [size=128K]
	Capabilities: [50] Power Management version 2
00:0f.0 USB Controller: Acer Laboratories Inc. [ALi] M5237 USB (rev 03) (prog-if 10 [OHCI])
	Subsystem: Sony Corporation: Unknown device 80ec
	Flags: bus master, medium devsel, latency 64, IRQ 9
	Memory at e8016000 (32-bit, non-prefetchable) [size=4K]
	Capabilities: [60] Power Management version 2
00:10.0 IDE interface: Acer Laboratories Inc. [ALi] M5229 IDE (rev c4) (prog-if a0)
	Subsystem: Sony Corporation: Unknown device 80ec
	Flags: bus master, medium devsel, latency 64
	I/O ports at 01f0 [size=16]
	I/O ports at 03f4
	I/O ports at 0170 [size=16]
	I/O ports at 0374
	I/O ports at 2800 [size=16]
	Capabilities: [60] Power Management version 2
00:11.0 Non-VGA unclassified device: Acer Laboratories Inc. [ALi] M7101 PMU
	Subsystem: Sony Corporation: Unknown device 80ec
	Flags: medium devsel
00:12.0 CardBus bridge: Ricoh Co Ltd RL5c475 (rev 80)
	Subsystem: Sony Corporation: Unknown device 80ec
	Flags: bus master, medium devsel, latency 168, IRQ 9
	Memory at 10000000 (32-bit, non-prefetchable) [size=4K]
	Bus: primary=00, secondary=01, subordinate=01, sec-latency=176
	I/O window 0: 00000000-00000003
	I/O window 1: 00000000-00000003
	16-bit legacy interface ports at 0001
00:14.0 USB Controller: Acer Laboratories Inc. [ALi] M5237 USB (rev 03) (prog-if 10 [OHCI])
	Subsystem: Sony Corporation: Unknown device 80ec
	Flags: bus master, medium devsel, latency 64, IRQ 9
	Memory at 000e0000 (32-bit, non-prefetchable) [size=4K]
	Capabilities: [60] Power Management version 2