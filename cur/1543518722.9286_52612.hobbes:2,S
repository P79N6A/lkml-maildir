Date: Fri, 10 Dec 1999 16:27:55 +0100 (CET)
From: Ingo Molnar <>
Subject: Re: Alpha: virt_to_bus/GFP_DMA problem
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/1999/12/10/96

On Fri, 10 Dec 1999, Thomas Sailer wrote:
> Anyway, the following patch should safely disable recording
> when virt_to_bus(kmalloc(GFP_DMA)) > 16M. Playback should
> still work, as interestingly the playback controller
> has a full 32bit address register.
ack, now i understand, this is on the _Alpha_, stupid me. It should be
really trivial to create a 16MB GFP_DMA zone on the Alpha (right now it
creates one single zone). Could you try the attached patch?
probably the right solution is to introduce an Alpha-specific DMA24BIT
zone?
	Ingo
--- linux/arch/alpha/mm/init.c.orig4	Fri Dec 10 07:18:19 1999
+++ linux/arch/alpha/mm/init.c	Fri Dec 10 07:20:30 1999
@@ -210,6 +210,9 @@
 #undef ORDER_MASK
 #undef ORDER_ALIGN
 
+	// HACK
+	dma_pfn = 16*1024*1024/PAGE_SIZE;
+
 	if (dma_pfn > high_pfn)
 		zones_size[ZONE_DMA] = high_pfn;
 	else {