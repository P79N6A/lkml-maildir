Date: Thu, 10 Jun 1999 11:09:41 -0400
From: Camm Maguire <>
Subject: 2.2.7, ftape hang, and lsmod problems
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/1999/6/10/116

Greetings!  For some as yet unknown reason, an ftape backup failed
with a device timeout a few days ago.  This by itself wasn't so bad,
but even after the tar process died, lsmod still shows the module in
use, used by -1 processes, and the module becomes unloadable, forcing
a reboot to clear.  Here's the relevant output/log data:
=============================================================================
intech4# lsof |grep qft
intech4# lsmod
Module                  Size  Used by
ppp                    20356   2  (autoclean)
zft-compressor         16368  -1  (autoclean)
zftape                 59144  -1  (autoclean) [zft-compressor]
ftape                 107396   0  (autoclean) [zft-compressor zftape]
ide-disk                5952   1  (autoclean)
ide-mod                39948   1  (autoclean) [ide-disk]
nfs                    29156   3  (autoclean)
lockd                  30696   1  (autoclean) [nfs]
sunrpc                 50524   1  (autoclean) [nfs lockd]
slip                    7644   2  (autoclean)
slhc                    4408   2  (autoclean) [ppp slip]
af_packet               6324   2  (autoclean)
unix                   10832  31  (autoclean)
serial                 18968   3  (autoclean)
wd                      4652   1  (autoclean)
8390                    6220   0  (autoclean) [wd]
BusLogic               32484   2  (autoclean)
sd_mod                 16292   2  (autoclean)
scsi_mod               37756   2  (autoclean) [BusLogic sd_mod]
intech4# 
=============================================================================
Jun  8 03:00:28 intech4 kernel: ftape v3.04d 25/11/97 
Jun  8 03:00:28 intech4 kernel: [000] ftape-init.c (ftape_init) - installing QIC-117 floppy tape hardware drive ... . 
Jun  8 03:00:28 intech4 kernel: [001] ftape-init.c (ftape_init) - ftape_init @ 0xc188b050. 
Jun  8 03:00:28 intech4 kernel: [002]   ftape-buffer.c (add_one_buffer) - buffer nr #1 @ c0903870, dma area @ c0358000. 
Jun  8 03:00:28 intech4 kernel: [003]   ftape-buffer.c (add_one_buffer) - buffer nr #2 @ c0fe8020, dma area @ c0c38000. 
Jun  8 03:00:28 intech4 kernel: [004]   ftape-buffer.c (add_one_buffer) - buffer nr #3 @ c0fe8e30, dma area @ c0bc0000. 
Jun  8 03:00:28 intech4 kernel: [005]   ftape-calibr.c (time_inb) - inb() duration: 2152 nsec. 
Jun  8 03:00:28 intech4 kernel: [006]  ftape-calibr.c (ftape_calibrate) - TC for `ftape_udelay()' = 5919 nsec (at 1279 counts). 
Jun  8 03:00:28 intech4 kernel: [007]  ftape-calibr.c (ftape_calibrate) - TC for `fdc_wait()' = 4115 nsec (at 1279 counts). 
Jun  8 03:00:29 intech4 kernel: zftape for ftape v3.04d 25/11/97 
Jun  8 03:00:29 intech4 kernel: vfs interface for ftape floppy tape driver. 
Jun  8 03:00:29 intech4 kernel: [008] zftape-init.c (zft_init) - zft_init @ 0xc18b1970. 
Jun  8 03:00:29 intech4 kernel: [009] zftape-init.c (zft_init) - installing zftape VFS interface for ftape driver .... 
Jun  8 03:00:29 intech4 kernel: [013]    ftape-ctl.c (ftape_log_vendor_id) - tape drive type: Iomega 3200. 
Jun  8 03:00:29 intech4 kernel: [014]    ftape-ctl.c (ftape_log_vendor_id) -  
Jun  8 03:00:29 intech4 kernel: please report this to the ftape maintainer 
Jun  8 03:00:30 intech4 kernel: [015]     ftape-io.c (ftape_report_configuration) - TR-3 tape detected. 
Jun  8 03:00:30 intech4 kernel: [016]    ftape-ctl.c (ftape_init_drive) - post QIC-117B drive @ 1000 Kbps. 
Jun  8 03:00:30 intech4 kernel: [017]     ftape-ctl.c (ftape_calibrate_data_rate) - Highest FDC supported data rate: 1000 Kbps. 
Jun  8 03:00:32 intech4 kernel: [018]       ftape-io.c (ftape_report_configuration) - TR-3 tape detected. 
Jun  8 03:00:32 intech4 kernel: [019]    ftape-ctl.c (ftape_init_drive) - unknown length QIC-3020 tape. 
Jun  8 03:00:35 intech4 kernel: [020]       ftape-read.c (ftape_decode_header_segment) - calculated tape length is 777 ft. 
Jun  8 03:00:35 intech4 kernel: [021]         ftape-bsm.c (print_bad_sector_map) - 1606585 Kb usable on this tape. 
Jun  8 03:00:35 intech4 kernel: [022]         ftape-bsm.c (print_bad_sector_map) - 2857 bad sectors. 
Jun  8 03:00:35 intech4 kernel: [023]     zftape-read.c (zft_read_header_segments) - Segments written since first format: 421694. 
Jun  8 03:00:36 intech4 kernel: [024]     zftape-read.c (zft_read_header_segments) - ft_first_data_segment: 2, ft_last_data_segment: 55499. 
Jun  8 03:00:41 intech4 kernel: [025]   ftape-ctl.c (ftape_disable) - == Non-fatal errors this run: ==. 
Jun  8 03:00:41 intech4 kernel: [026]   ftape-ctl.c (ftape_disable) - fdc isr statistics: 
Jun  8 03:00:41 intech4 kernel: [027]   ftape-ctl.c (ftape_disable) - ecc statistics: 
Jun  8 03:00:41 intech4 kernel: [028]   ftape-ctl.c (ftape_disable) - tape motion statistics: 
Jun  8 03:01:02 intech4 kernel: zftape compressor v1.00a 970514 for ftape v3.04d 25/11/97 
Jun  8 03:01:02 intech4 kernel: Compressor for zftape (lzrw3 algorithm) 
Jun  8 03:01:02 intech4 kernel: [029]    zftape-compress.c (zft_compressor_init) - zft_compressor_init @ 0xc187d5c0. 
Jun  8 03:01:02 intech4 kernel: [030]    zftape-compress.c (zft_compressor_init) - installing compressor for zftape .... 
Jun  8 03:03:29 intech4 kernel: [031]       zftape-compress.c (zftc_stats) - compression statistics (writing): 
Jun  8 03:04:28 intech4 kernel: [032]     ftape-read.c (correct_and_copy_fraction) - ecc corrected segment: 33034. 
Jun  8 03:04:50 intech4 kernel: [041]   ftape-ctl.c (ftape_disable) - == Non-fatal errors this run: ==. 
Jun  8 03:04:50 intech4 kernel: [042]   ftape-ctl.c (ftape_disable) - fdc isr statistics: 
Jun  8 03:04:50 intech4 kernel: [043]   ftape-ctl.c (ftape_disable) - ecc statistics: 
Jun  8 03:04:50 intech4 kernel: [044]   ftape-ctl.c (ftape_disable) - tape motion statistics: 
Jun  8 03:04:52 intech4 kernel: [046]       ftape-io.c (ftape_report_operation) - No acknowledge after 301 msec. (90 iter). 
Jun  8 03:04:52 intech4 kernel: [047]       ftape-io.c (ftape_report_operation) - timeout on Acknowledge. 
Jun  8 03:04:52 intech4 kernel: [048]       ftape-io.c (ftape_report_operation) - No acknowledge after 301 msec. (92 iter). 
Jun  8 03:04:52 intech4 kernel: [049]       ftape-io.c (ftape_report_operation) - timeout on Acknowledge. 
Jun  8 03:04:53 intech4 kernel: [050]       ftape-io.c (ftape_report_operation) - No acknowledge after 302 msec. (90 iter). 
Jun  8 03:04:53 intech4 kernel: [051]       ftape-io.c (ftape_report_operation) - timeout on Acknowledge. 
Jun  8 03:04:53 intech4 kernel: [052]       ftape-io.c (ftape_report_operation) - No acknowledge after 302 msec. (92 iter). 
Jun  8 03:04:53 intech4 kernel: [053]       ftape-io.c (ftape_report_operation) - timeout on Acknowledge. 
Jun  8 03:04:53 intech4 kernel: [054]      ftape-io.c (ftape_report_raw_drive_status) - report_operation failed after 4 trials. 
Jun  8 03:04:53 intech4 kernel: [055]     ftape-io.c (ftape_wakeup_drive) - ftape_report_raw_drive_status(&status) failed: -5. 
Jun  8 03:04:53 intech4 kernel: [056]    ftape-ctl.c (ftape_activate_drive) - known wakeup method failed. 
Jun  8 03:04:53 intech4 kernel: [057]   ftape-ctl.c (ftape_enable) - ftape_activate_drive(&ftape_status.fti_drive_type) failed: -5. 
Jun  8 03:04:53 intech4 kernel: [058]  zftape-ctl.c (_zft_open) - ftape_enable failed: -5. 
Jun  8 03:04:53 intech4 kernel: [059] zftape-init.c (zft_open) - _ftape_open failed. 
Jun  8 03:04:54 intech4 kernel: [060]       ftape-io.c (ftape_report_operation) - No acknowledge after 302 msec. (87 iter). 
Jun  8 03:04:54 intech4 kernel: [061]       ftape-io.c (ftape_report_operation) - timeout on Acknowledge. 
Jun  8 03:04:54 intech4 kernel: [062]       ftape-io.c (ftape_report_operation) - No acknowledge after 300 msec. (93 iter). 
Jun  8 03:04:54 intech4 kernel: [063]       ftape-io.c (ftape_report_operation) - timeout on Acknowledge. 
Jun  8 03:04:54 intech4 kernel: [064]       ftape-io.c (ftape_report_operation) - No acknowledge after 303 msec. (94 iter). 
Jun  8 03:04:54 intech4 kernel: [065]       ftape-io.c (ftape_report_operation) - timeout on Acknowledge. 
Jun  8 03:04:55 intech4 kernel: [066]       ftape-io.c (ftape_report_operation) - No acknowledge after 300 msec. (93 iter). 
Jun  8 03:04:55 intech4 kernel: [067]       ftape-io.c (ftape_report_operation) - timeout on Acknowledge. 
Jun  8 03:04:55 intech4 kernel: [068]      ftape-io.c (ftape_report_raw_drive_status) - report_operation failed after 4 trials. 
Jun  8 03:04:55 intech4 kernel: [069]     ftape-io.c (ftape_wakeup_drive) - ftape_report_raw_drive_status(&status) failed: -5. 
Jun  8 03:04:55 intech4 kernel: [070]    ftape-ctl.c (ftape_activate_drive) - known wakeup method failed. 
Jun  8 03:04:55 intech4 kernel: [071]   ftape-ctl.c (ftape_enable) - ftape_activate_drive(&ftape_status.fti_drive_type) failed: -5. 
Jun  8 03:04:55 intech4 kernel: [072]  zftape-ctl.c (_zft_open) - ftape_enable failed: -5. 
Jun  8 03:04:55 intech4 kernel: [073] zftape-init.c (zft_open) - _ftape_open failed. 
Jun  8 03:04:56 intech4 kernel: [074]       ftape-io.c (ftape_report_operation) - No acknowledge after 303 msec. (94 iter). 
Jun  8 03:04:56 intech4 kernel: [075]       ftape-io.c (ftape_report_operation) - timeout on Acknowledge. 
Jun  8 03:04:56 intech4 kernel: [076]       ftape-io.c (ftape_report_operation) - No acknowledge after 302 msec. (87 iter). 
Jun  8 03:04:56 intech4 kernel: [077]       ftape-io.c (ftape_report_operation) - timeout on Acknowledge. 
Jun  8 03:04:57 intech4 kernel: [078]       ftape-io.c (ftape_report_operation) - No acknowledge after 300 msec. (92 iter). 
Jun  8 03:04:57 intech4 kernel: [079]       ftape-io.c (ftape_report_operation) - timeout on Acknowledge. 
Jun  8 03:04:57 intech4 kernel: [080]       ftape-io.c (ftape_report_operation) - No acknowledge after 302 msec. (94 iter). 
Jun  8 03:04:57 intech4 kernel: [081]       ftape-io.c (ftape_report_operation) - timeout on Acknowledge. 
Jun  8 03:04:57 intech4 kernel: [082]      ftape-io.c (ftape_report_raw_drive_status) - report_operation failed after 4 trials. 
Jun  8 03:04:57 intech4 kernel: [083]     ftape-io.c (ftape_wakeup_drive) - ftape_report_raw_drive_status(&status) failed: -5. 
Jun  8 03:04:57 intech4 kernel: [084]    ftape-ctl.c (ftape_activate_drive) - known wakeup method failed. 
Jun  8 03:04:57 intech4 kernel: [085]   ftape-ctl.c (ftape_enable) - ftape_activate_drive(&ftape_status.fti_drive_type) failed: -5. 
Jun  8 03:04:57 intech4 kernel: [086]  zftape-ctl.c (_zft_open) - ftape_enable failed: -5. 
Jun  8 03:04:57 intech4 kernel: [087] zftape-init.c (zft_open) - _ftape_open failed. 
Jun  8 03:04:58 intech4 kernel: [088]       ftape-io.c (ftape_report_operation) - No acknowledge after 300 msec. (93 iter). 
Jun  8 03:04:58 intech4 kernel: [089]       ftape-io.c (ftape_report_operation) - timeout on Acknowledge. 
Jun  8 03:04:58 intech4 kernel: [090]       ftape-io.c (ftape_report_operation) - No acknowledge after 302 msec. (90 iter). 
Jun  8 03:04:58 intech4 kernel: [091]       ftape-io.c (ftape_report_operation) - timeout on Acknowledge. 
Jun  8 03:04:59 intech4 kernel: [092]       ftape-io.c (ftape_report_operation) - No acknowledge after 303 msec. (94 iter). 
Jun  8 03:04:59 intech4 kernel: [093]       ftape-io.c (ftape_report_operation) - timeout on Acknowledge. 
Jun  8 03:04:59 intech4 kernel: [094]       ftape-io.c (ftape_report_operation) - No acknowledge after 300 msec. (84 iter). 
Jun  8 03:04:59 intech4 kernel: [095]       ftape-io.c (ftape_report_operation) - timeout on Acknowledge. 
Jun  8 03:04:59 intech4 kernel: [096]      ftape-io.c (ftape_report_raw_drive_status) - report_operation failed after 4 trials. 
Jun  8 03:04:59 intech4 kernel: [097]     ftape-io.c (ftape_wakeup_drive) - ftape_report_raw_drive_status(&status) failed: -5. 
Jun  8 03:04:59 intech4 kernel: [098]    ftape-ctl.c (ftape_activate_drive) - known wakeup method failed. 
Jun  8 03:04:59 intech4 kernel: [099]   ftape-ctl.c (ftape_enable) - ftape_activate_drive(&ftape_status.fti_drive_type) failed: -5. 
Jun  8 03:04:59 intech4 kernel: [100]  zftape-ctl.c (_zft_open) - ftape_enable failed: -5. 
Jun  8 03:04:59 intech4 kernel: [101] zftape-init.c (zft_open) - _ftape_open failed. 
Jun  8 03:04:59 intech4 kernel: [102]       ftape-io.c (ftape_report_operation) - No acknowledge after 302 msec. (92 iter). 
Jun  8 03:04:59 intech4 kernel: [103]       ftape-io.c (ftape_report_operation) - timeout on Acknowledge. 
Jun  8 03:05:00 intech4 kernel: [104]       ftape-io.c (ftape_report_operation) - No acknowledge after 301 msec. (93 iter). 
Jun  8 03:05:00 intech4 kernel: [105]       ftape-io.c (ftape_report_operation) - timeout on Acknowledge. 
Jun  8 03:05:00 intech4 kernel: [106]       ftape-io.c (ftape_report_operation) - No acknowledge after 300 msec. (93 iter). 
Jun  8 03:05:00 intech4 kernel: [107]       ftape-io.c (ftape_report_operation) - timeout on Acknowledge. 
Jun  8 03:05:00 intech4 kernel: [108]       ftape-io.c (ftape_report_operation) - No acknowledge after 300 msec. (93 iter). 
Jun  8 03:05:00 intech4 kernel: [109]       ftape-io.c (ftape_report_operation) - timeout on Acknowledge. 
Jun  8 03:05:00 intech4 kernel: [110]      ftape-io.c (ftape_report_raw_drive_status) - report_operation failed after 4 trials. 
Jun  8 03:05:00 intech4 kernel: [111]     ftape-io.c (ftape_wakeup_drive) - ftape_report_raw_drive_status(&status) failed: -5. 
Jun  8 03:05:00 intech4 kernel: [112]    ftape-ctl.c (ftape_activate_drive) - known wakeup method failed. 
Jun  8 03:05:00 intech4 kernel: [113]   ftape-ctl.c (ftape_enable) - ftape_activate_drive(&ftape_status.fti_drive_type) failed: -5. 
Jun  8 03:05:00 intech4 kernel: [114]  zftape-ctl.c (_zft_open) - ftape_enable failed: -5. 
Jun  8 03:05:00 intech4 kernel: [115] zftape-init.c (zft_open) - _ftape_open failed. 
Jun  8 03:05:01 intech4 kernel: [116]       ftape-io.c (ftape_report_operation) - No acknowledge after 300 msec. (93 iter). 
Jun  8 03:05:01 intech4 kernel: [117]       ftape-io.c (ftape_report_operation) - timeout on Acknowledge. 
Jun  8 03:05:01 intech4 kernel: [118]       ftape-io.c (ftape_report_operation) - No acknowledge after 302 msec. (94 iter). 
Jun  8 03:05:01 intech4 kernel: [119]       ftape-io.c (ftape_report_operation) - timeout on Acknowledge. 
Jun  8 03:05:02 intech4 kernel: [120]       ftape-io.c (ftape_report_operation) - No acknowledge after 303 msec. (94 iter). 
Jun  8 03:05:02 intech4 kernel: [121]       ftape-io.c (ftape_report_operation) - timeout on Acknowledge. 
Jun  8 03:05:02 intech4 kernel: [122]       ftape-io.c (ftape_report_operation) - No acknowledge after 302 msec. (94 iter). 
Jun  8 03:05:02 intech4 kernel: [123]       ftape-io.c (ftape_report_operation) - timeout on Acknowledge. 
Jun  8 03:05:02 intech4 kernel: [124]      ftape-io.c (ftape_report_raw_drive_status) - report_operation failed after 4 trials. 
Jun  8 03:05:02 intech4 kernel: [125]     ftape-io.c (ftape_wakeup_drive) - ftape_report_raw_drive_status(&status) failed: -5. 
Jun  8 03:05:02 intech4 kernel: [126]    ftape-ctl.c (ftape_activate_drive) - known wakeup method failed. 
Jun  8 03:05:02 intech4 kernel: [127]   ftape-ctl.c (ftape_enable) - ftape_activate_drive(&ftape_status.fti_drive_type) failed: -5. 
Jun  8 03:05:02 intech4 kernel: [128]  zftape-ctl.c (_zft_open) - ftape_enable failed: -5. 
Jun  8 03:05:02 intech4 kernel: [129] zftape-init.c (zft_open) - _ftape_open failed. 
=============================================================================
Thanks!
Camm Maguire			     			camm@enhanced.com
==========================================================================
"The earth is but one country, and mankind its citizens."  --  Baha'u'llah
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.rutgers.edu
Please read the FAQ at 
http://www.tux.org/lkml/