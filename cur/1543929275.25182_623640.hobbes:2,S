Date: Mon, 3 Dec 2007 12:26:07 +0300
From: Alexey Dobriyan <>
Subject: kobject ->k_name memory leak
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2007/12/3/20

Hi, Greg!
Commit ce2c9cb0259acd2aed184499ebe41ab00da13b25 aka
"kobject: remove the static array for the name" introduced memory leak
of a module name after modprobe/rmmod. Apparently for modules ->release
callback is NULL.
kobject_cleanup: ->release = 00000000, name = 'foo_sysctl'
Pid: 1927, comm: rmmod Not tainted 2.6.24-rc3-e1cca7e8d484390169777b423a7fe46c7021fec1 #5
 [<c10d4a58>] kobject_cleanup+0xb8/0xc0
 [<c10d4a60>] kobject_release+0x0/0x10
 [<c10d587b>] kref_put+0x2b/0xa0
 [<c11dbe85>] _spin_unlock+0x25/0x40
 [<c1045b78>] free_module+0x78/0xd0
 [<c104773f>] sys_delete_module+0x12f/0x1a0