Date: Fri, 02 Aug 2002 08:48:06 -0500
From: James Bottomley <>
Subject: Re: [PATCH] Bio Traversal Changes
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2002/8/2/107

The SCSI changes (small that they are) look reasonable.
This does look like it exposes an existing problem in the tag/barrier 
approach, though.
The bio can be split by making multiple requests over segements of the bio, 
correct?  If this is a BIO_RW_BARRIER, then each of these requests will be a 
REQ_BARRIER.  However, in the SCSI paradigm where we translate REQ_BARRIER to 
ordered tag, each of the requests will get a new ordered tag as it comes back 
around through end_that_request_first, potentially allowing other tags to be 
inserted in between these, which would be incorrect, since other bios would be 
inserted in between the segments of this one, thus violating the barrier.
Is the above correct?  If it is, I may have finally found a use for linked 
scsi tasks (gives you the ability to have one tag cover multiple commands).
James
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.kernel.org
More majordomo info at  
http://vger.kernel.org/majordomo-info.html
Please read the FAQ at  
http://www.tux.org/lkml/