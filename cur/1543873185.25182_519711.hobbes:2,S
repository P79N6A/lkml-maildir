Date: Tue, 13 Mar 2007 18:29:32 -0400
From: (Lennart Sorensen)
Subject: Small fixes for jsm driver
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2007/3/13/364

The jsm driver fails when you try to use the TIOCSSERIAL ioctl.  The
reason is that the driver never sets uart_port.uartclk, causing the data
received using TIOCGSERIAL to not match the internal state of the driver.
This patch fixes this problem by settings the uartclk to the value used
by the serial_core (16 times the baud base).
Signed-off-by: Len Sorensen <lsorense@csclub.uwaterloo.ca>
--- a/drivers/serial/jsm/jsm_tty.c	2007-03-13 15:53:39.000000000 -0400
+++ b/drivers/serial/jsm/jsm_tty.c	2007-03-13 15:55:15.000000000 -0400
@@ -471,6 +471,7 @@
 			continue;
 
 		brd->channels[i]->uart_port.irq = brd->irq;
+		brd->channels[i]->uart_port.uartclk = 14745600;
 		brd->channels[i]->uart_port.type = PORT_JSM;
 		brd->channels[i]->uart_port.iotype = UPIO_MEM;
 		brd->channels[i]->uart_port.membase = brd->re_map_membase;
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.kernel.org
More majordomo info at  
http://vger.kernel.org/majordomo-info.html
Please read the FAQ at  
http://www.tux.org/lkml/