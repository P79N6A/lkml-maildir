Date: Tue, 10 Sep 2002 12:17:29 +0200 (CEST)
From: Roman Zippel <>
Subject: Re: Question about pseudo filesystems
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2002/9/10/45

Hi,
On Tue, 10 Sep 2002, Daniel Phillips wrote:
> There's a simple solution though: examine the module->count under the same
> spinlock as try_inc_mod_count, which is what sys_delete_module does.  We just
> encapsulate that check in a handy wrapper and define it as part of the
> try_inc_mod_count interface.  At this point the thing is generalized to the
> point where the module count isn't used at all by module.c, so the same
> interface will also accomodate the still-under-construction magic wait for
> quiescent state(), needed for modules that don't fit the mod_count model.
I implemented something like this some time ago. If module->count isn't
used by module.c anymore, why should it be in the module structure?
Consequently I removed it from the module struct (what breaks of course
unloading of all modules, so I'll probably reintroduce it with big a
warning). If the count isn't in the module structure, the locking will
become quite simpler. More info is here
http://marc.theaimsgroup.com/?l=linux-kernel&m=102754132716703&w=2
bye, Roman
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.kernel.org
More majordomo info at  
http://vger.kernel.org/majordomo-info.html
Please read the FAQ at  
http://www.tux.org/lkml/