Date: Thu, 14 Aug 2003 18:26:30 +0200
From: Arkadiusz Miskiewicz <>
Subject: finding which pci device works as ide controller for root fs
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2003/8/14/102

Hi,
I need /dev/hdX -> pci id mapping for geninitrd script - with modular IDE I 
need to load some IDE controller driver from initrd to mount root fs.
Now I'm loading all modules for IDE devices found from:
awk ' { print $2 } ' /proc/bus/pci/devices
+ simple file which maps PCI ID to module name like
808684cb piix
How to find controller which is used for root fs (and do not load other 
modules)? I suppose that on 2.4 this is impossible from userspace but on 2.6 
maybe sysfs will be useful.
[arekm@mobarm arekm]$ ls -l /sys/block/hda/device
lrwxrwxrwx    1 root     root           46 2003-08-14 00:49 
/sys/block/hda/device -> ../../devices/pci0000:00/0000:00:11.1/ide0/0.0
Is it possible to get PCI ID from sysfs for specified device?
-- 
Arkadiusz Mi≈õkiewicz    CS at FoE, Wroclaw University of Technology
arekm@sse.pl   AM2-6BONE, 1024/3DB19BBD, arekm(at)ircnet, PLD/Linux
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.kernel.org
More majordomo info at  
http://vger.kernel.org/majordomo-info.html
Please read the FAQ at  
http://www.tux.org/lkml/