Date: Sun, 5 Feb 2006 20:50:46 +0100
From: Adrian Bunk <>
Subject: Re: [PATCH] Fix build failure in recent pm_prepare_* changes.
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2006/2/5/116

On Sun, Feb 05, 2006 at 02:02:20PM -0500, Dave Jones wrote:
> On Sun, Feb 05, 2006 at 01:56:10PM +0100, Olaf Hering wrote:
>  >  On Fri, Feb 03, Linux Kernel Mailing List wrote:
>  > 
>  > > tree 8f70444139c8564c0f1e88e1f33adda036ae6a96
>  > > parent 278ff9537030bbb292b33504f5e1f6e0126793eb
>  > > author Dave Jones <davej@redhat.com> Fri, 03 Feb 2006 19:03:44 -0800
>  > > committer Linus Torvalds <torvalds@g5.osdl.org> Sat, 04 Feb 2006 00:32:00 -0800
>  > > 
>  > > [PATCH] Fix build failure in recent pm_prepare_* changes.
>  > > 
>  > > kernel/power/power.h:49: error: static declaration of 'pm_prepare_console' follows non-static declaration
>  > > include/linux/suspend.h:46: error: previous declaration of 'pm_prepare_console' was here
>  > > kernel/power/power.h:50: error: static declaration of 'pm_restore_console' follows non-static declaration
>  > > include/linux/suspend.h:47: error: previous declaration of 'pm_restore_console' was here
>  > > 
>  > > Signed-off-by: Dave Jones <davej@redhat.com>
>  > 
>  > this one is not correct, please have a closer look at
>  > f7b8988ff50d99c99746f65f420364e91362c065
>  > 
>  >   CC      drivers/macintosh/via-pmu.o
>  > drivers/macintosh/via-pmu.c: In function 'pmac_suspend_devices':
>  > drivers/macintosh/via-pmu.c:2078: error: implicit declaration of function 'pm_prepare_console'
>  > drivers/macintosh/via-pmu.c: In function 'pmac_wakeup_devices':
>  > drivers/macintosh/via-pmu.c:2194: error: implicit declaration of function 'pm_restore_console'
>  > make[2]: *** [drivers/macintosh/via-pmu.o] Error 1
> 
> Strange, my ppc[64] builds compiled and linked without failure. I think perhaps
> it's time I added -Werror-implicit-function-declaration to the Makefile.
>...
If it compiles and links and gcc guessed the prototype correctly 
everything is fine. If it compiles and links and gcc guessed the 
prototype wrongly, you have a hard to find runtime error...
I'd love to add this flag to the global Makefile, but Andrew always 
rejected it because it turns link errors into compile errors (sic) 
breaking his powerpc all*config builds due to virt_to_bus/bus_to_virt. 
But then he rejected to mark virt_to_bus/bus_to_virt as __deprecated on 
i386 because it currently generates some warnings...  :-(
> 		Dave
cu
Adrian
-- 
       "Is there not promise of rain?" Ling Tan asked suddenly out
        of the darkness. There had been need of rain for many days.
       "Only a promise," Lao Er said.
                                       Pearl S. Buck - Dragon Seed
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.kernel.org
More majordomo info at  
http://vger.kernel.org/majordomo-info.html
Please read the FAQ at  
http://www.tux.org/lkml/