Date: Mon, 17 Feb 2003 14:14:43 -0800
From: Simon Kirby <>
Subject: [2.4.21-pre4] IDE hangs box after timeout
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2003/2/17/194

Hello,
I don't think this happened on older kernels (< 2.4.18ish), but it may
have happened on 2.4.20 (though I have other problems with 2.4.20 on this
box that makes testing more difficult -- it tends to Oops fairly often).
Anyway, this box has a massive collection of old (and new) drives to make
a large storage area, using MD linear.  The box has two SCSI cards, two
promise cards (PDC20269), and onboard IDE (PIIX4).  Because the box has
so many drives, I had to use a number of power splitters which are, of
course, cheap and thus unreliable, and occasionally a few drives will
fall off of the bus.  This is the real problem, yes, but it seems to be
triggering a lockup bug in 2.4.21-pre4.  When hda falls off the bus due
to power loss, I see this on the console:
hda: dma_timer_expiry: dma status == 0x21
hda: timeout waiting for DMA
hda: timeout waiting for DMA
hda: (__ide_dma_test_irq) called while not waiting
...followed by a complete lockup where sysreq does not appear to work.
dmesg and config available here:
	
http://blue.netnation.com/sim/ref/alfie.dmesg
	
http://blue.netnation.com/sim/ref/alfie.config
( Yes, a new power supply is on order. :) )
Simon-
[        Simon Kirby        ][        Network Operations        ]
[     sim@netnation.com     ][     NetNation Communications     ]
[  Opinions expressed are not necessarily those of my employer. ]
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.kernel.org
More majordomo info at  
http://vger.kernel.org/majordomo-info.html
Please read the FAQ at  
http://www.tux.org/lkml/