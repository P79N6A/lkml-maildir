Date: Mon, 07 Jan 2008 17:21:01 -0800
From: Jeremy Fitzhardinge <>
Subject: [PATCH] x86: export native_read_tsc
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2008/1/7/374

native_read_tsc is needed by modules, so it should be exported.
make -C /home/jeremy/hg/xen/paravirt/linux O=/home/jeremy/hg/xen/paravirt/linux-x86_64 
  Using /home/jeremy/hg/xen/paravirt/linux as source for kernel
  GEN     /home/jeremy/hg/xen/paravirt/linux-x86_64/Makefile
  CHK     include/linux/version.h
  CHK     include/linux/utsrelease.h
  CALL    /home/jeremy/hg/xen/paravirt/linux/scripts/checksyscalls.sh
  CHK     include/linux/compile.h
Kernel: arch/x86/boot/bzImage is ready  (#49)
  Building modules, stage 2.
  MODPOST 257 modules
ERROR: "native_read_tsc" [drivers/input/gameport/gameport.ko] undefined!
Signed-off-by: Jeremy Fitzhardinge <jeremy@xensource.com>
Cc: Glauber de Oliveira Costa <glommer@gmail.com>
---
 arch/x86/kernel/rtc.c |    2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)
===================================================================
--- a/arch/x86/kernel/rtc.c
+++ b/arch/x86/kernel/rtc.c
@@ -204,4 +204,4 @@ unsigned long long native_read_tsc(void)
 
 	return EAX_EDX_VAL(val, low, high);
 }
-
+EXPORT_SYMBOL(native_read_tsc);