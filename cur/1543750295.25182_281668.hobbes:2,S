Date: Wed, 29 Dec 2004 00:23:06 +0100
From: Sam Ravnborg <>
Subject: Re: make errors (make clean, make menuconfig) make -C /usr/src/linux-2.6.10 O=/usr/src/linux-2.6.10 menuconfig
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2004/12/28/125

On Tue, Dec 28, 2004 at 12:19:34AM +0100, Sam Ravnborg wrote:
> ...
> 
> It is the following code snippet that causes the troubles:
> ---
> outputmakefile:
>         $(Q)if /usr/bin/env test ! $(srctree) -ef $(objtree); then \
>         $(CONFIG_SHELL) $(srctree)/scripts/mkmakefile
> ---
env was behaving different in some setups - and located in other places.
Since I cannot remeber why it is there I the fix was simple - remove it.
	Sam
# This is a BitKeeper generated diff -Nru style patch.
#
# ChangeSet
#   2004/12/28 19:12:15+01:00 sam@mars.ravnborg.org 
#   kbuild: drop use of /usr/bin/env in top-level Makefile
#   
#   The use of env is not needed, and caused the output makefile to be
#   created in some setups where it was not supposed to.
#   Seems to be an issue with GNU sh-utils version of env.
#   
#   One user also reported env to be located in another place (/usr/local/bin/..).
#   This patch fixes bug: 
http://bugme.osdl.org/show_bug.cgi?id=3953
#   
#   Thanks to "Mark Williams (MWP)" <mwp@internode.on.net> for helping tracking this down.
#   
#   Signed-off-by: Sam Ravnborg <sam@ravnborg.org>
# 
# Makefile
#   2004/12/28 19:11:36+01:00 sam@mars.ravnborg.org +1 -1
#   Drop usage of /usr/bin/env
# 
diff -Nru a/Makefile b/Makefile
--- a/Makefile	2004-12-29 00:20:21 +01:00
+++ b/Makefile	2004-12-29 00:20:21 +01:00
@@ -389,7 +389,7 @@
 # using a seperate output directory. This allows convinient use
 # of make in output directory
 outputmakefile:
-	$(Q)if /usr/bin/env test ! $(srctree) -ef $(objtree); then \
+	$(Q)if test ! $(srctree) -ef $(objtree); then \
 	$(CONFIG_SHELL) $(srctree)/scripts/mkmakefile              \
 	    $(srctree) $(objtree) $(VERSION) $(PATCHLEVEL)         \
 	    > $(objtree)/Makefile;                                 \
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.kernel.org
More majordomo info at  
http://vger.kernel.org/majordomo-info.html
Please read the FAQ at  
http://www.tux.org/lkml/