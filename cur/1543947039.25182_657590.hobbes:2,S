Date: Thu, 21 Feb 2008 09:33:22 -0800
From: Randy Dunlap <>
Subject: Re: 2.6.25-rc2-git4 BUG: sysfs_readdir
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2008/2/21/251

Greg KH wrote:
> On Thu, Feb 21, 2008 at 08:25:53AM -0800, Randy Dunlap wrote:
>> One of my (x86_64) test machines got this on booting 2.6.25-rc2-git4.
>>
>> insmod used greatest stack depth: 4144 bytes left
>> EXT3-fs: INFO: recovery required on readonly filesystem.
>> EXT3-fs: write access will be enabled during recovery.
>> kjournald starting.  Commit interval 5 seconds
>> EXT3-fs: recovery complete.
>> EXT3-fs: mounted filesystem with ordered data mode.
>> modprobe used greatest stack depth: 3600 bytes left
>> BUG: unable to handle kernel NULL pointer dereference at 0000000000000000
>> IP: [<ffffffff802d0f16>] sysfs_readdir+0xe0/0x13f
> 
> That's really wierd, as nothing has changed in this area in a while now.
> did 2.6.25-rc2 work for you ok?
Yes, all previous 2.6.25-versions worked for me.
> Can you enable CONFIG_DEBUG_KOBJECT and see if the kernel log shows you
> what is happening here?  Hm, that's only going to tell you what files
> were created, not what was being read from sysfs...
> 
> How about adding the patch at:
> 
http://www.kernel.org/pub/linux/kernel/people/gregkh/gregkh-2.6/gregkh-01-driver/sysfs-crash-debugging.patch
> which has been in -mm for forever that will add the last-accessed sysfs
> file to the oops report.  That might give us more information here.
I'll try those, but I doubt that this is easily reproducible.
-- 
~Randy