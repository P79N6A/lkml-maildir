Date: Wed, 10 Dec 2008 01:07:57 +0100
From: Andres Freund <>
Subject: Re: EXT4 ENOSPC Bug
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2008/12/9/344

Hi Ted,
Very Strange:
I booted (after an crash which I did not see) a somewhat older kernel and I 
once more caught the issue. Unfortunately I do not have your patch in this 
older kernel.
older kernel: 2.6.28-rc5-andres-00070-g4e14e83
kernel I rean whole last week: 2.6.28-rc6-andres-00007-ged31348
There seem to have been no significant ext4 related changes to the kernel  
between those.
for i in `seq 1 1000`;do touch tmp$i;done
touch: cannot touch `tmp139': No space left on device
...
rm tmp*;for i in `seq 1 200`;do dd if=/dev/zero of=tmp$i bs=1024k count=1;done
dd: opening `tmp139': No space left on device
139
..
Various different blocksizes and filesizes all return the same result.
This all hints to the patch Anesh linked. But it is included in 2.6.28-rc5. 
Any idea how that could happen?
The kernel install is just a "make;make install; update-initramfs -c -k `make 
kernelrelease`; update-grub" run...
A short idea how I could verify on binary level what kernelrelease it really 
is?
If a somehow corrupted compile (murked ccache?) is the culprit of this (in 
addition to my inaccuracies) I am very sorry for all your work.
I let this kernel run for the next hours if you want to run some tests...
Thanks,
Andres
[unhandled content-type:application/pgp-signature]