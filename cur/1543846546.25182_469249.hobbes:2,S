Date: Wed, 04 Oct 2006 10:54:03 +1000
From: Michael Ellerman <>
Subject: Re: [PATCH 4/5] Generic BUG for powerpc
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2006/10/3/378

On Tue, 2006-10-03 at 13:16 -0700, Jeremy Fitzhardinge wrote:
> plain text document attachment (mm)
> This makes powerpc use the generic BUG machinery.  The biggest
> difference from the previous powerpc bug code is that it no longer
> reports the function name, since it is redundant with kallsyms, and
> not needed in general.
> 
> There is an overall reduction of code, since module_32/64 duplicated several
> functions.
> 
> Unfortunately there's no way to tell gcc that BUG won't return, so the
> BUG macro includes a goto loop.  This will generate a real jmp
> instruction, which is never used.
I posted a patch a few weeks back to use __builtin_trap(), which gives
GCC the hint that it's not going to return.
(
http://patchwork.ozlabs.org/linuxppc/patch?id=7047
)
Unfortunately this generated some negative feedback from some of our
crackhead ... er wonderful colleagues who want to be able to step over
BUGs in some circumstances.
(
http://ozlabs.org/pipermail/linuxppc-dev/2006-September/026161.html
)
I think they conceeded that it could be configurable, but I wasn't sure
it was worth the trouble.
cheers
-- 
Michael Ellerman
OzLabs, IBM Australia Development Lab
wwweb: 
http://michael.ellerman.id.au
phone: +61 2 6212 1183 (tie line 70 21183)
We do not inherit the earth from our ancestors,
we borrow it from our children. - S.M.A.R.T Person
[unhandled content-type:application/pgp-signature]