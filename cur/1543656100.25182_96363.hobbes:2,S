Date: Sun, 15 Dec 2002 02:58:27 -0800
From: "Adam J. Richter" <>
Subject: Patch(2.5.51): __pnp_add_device dereferenced bad pointer
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2002/12/15/18

	__pnp_add_device dereferences a bad pointer when it traverses
the dev->id chain, because id->next is not initialized in certain cases,
causing my Sony Picturebook pcg-c1vn to crash at boot.  Here is a patch.
-- 
Adam J. Richter     __     ______________   575 Oroville Road
adam@yggdrasil.com     \ /                  Milpitas, California 95035
+1 408 309-6081         | g g d r a s i l   United States of America
                         "Free Software For The Rest Of Us."
--- linux-2.5.51/drivers/pnp/driver.c	2002-12-09 18:46:14.000000000 -0800
+++ linux/drivers/pnp/driver.c	2002-12-15 02:52:47.000000000 -0800
@@ -164,6 +164,7 @@
 		return -EINVAL;
 	if (!dev)
 		return -EINVAL;
+	id->next = NULL;
 	ptr = dev->id;
 	while (ptr && ptr->next)
 		ptr = ptr->next;