Date: Tue, 11 Nov 2008 11:00:50 +0100
From: Ingo Molnar <>
Subject: Re: [patch] add /proc/pid/stack to dump task's stack trace
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2008/11/11/94

* Andrew Morton <akpm@linux-foundation.org> wrote:
> On Fri, 7 Nov 2008 10:29:02 +0100
> Ingo Molnar <mingo@elte.hu> wrote:
> 
> > > I guess the 0400 mode on that file will suffice...
> > 
> > correct, 0400 is used already in the present patch:
> > 
> >  phoenix:~> cat /proc/1/stack
> >  cat: /proc/1/stack: Permission denied
> > 
> > but that is _not_ enough, it should be narrowed even more, to the 
> > boundaries that i pointed out in my first review feedback mail, and 
> > which is not implemented yet:
> > 
> >  1) only root should be allowed to do this - i.e. file needs to be 
> >     root-owned.
> > 
> >  2) there also needs to be a .config entry for folks to be able to
> >     turn it off altogether - just like folks can turn off sysrq-t 
> >     dumping via the .config.
> 
> Doing the above is desirable for another reason: given our rather 
> erratic history with the stack backtracer, this /proc file is 
> possibly a convenient way of oopsing the kernel, sending of off into 
> la-la-land, etc.
the stack tracer is rock-solid on x86 since Arjan started cleaning up 
the backtracing mess which we indeed had in x86 for years:
- adding frame-pointer support to 64-bit to improve the
  quality of stack-traces
- eliminating the broken and fragile dwarf2-unwinder
- expanding the use of the generic stacktrace infrastructure to
  lockdep, ftrace and other areas of code
if you know about any remaining fragility please holler, we havent had 
a backtracer induced oops for a long time :-)
	Ingo