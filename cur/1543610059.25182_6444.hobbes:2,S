Date: Sat, 17 Nov 2001 19:38:57 -0000
From: "Matthew Gregan" <>
Subject: Re: Alpha XLT 366 fails to boot kernel >= 2.4.14
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2001/11/17/11

Matthew Gregan <mgregan@jade.co.nz> said:
Linus, please consider including the attached patch in 2.4.15.
> My Alpha XLT 366 fails to boot kernels 2.4.14 and higher - the problem
> appears to be related to the cpu_hz struct added in (I think)
> 2.4.14-pre8 or detection of the CPU (EV5, EV56, etc.)
I'm now fairly sure the problem lies in the min/max settings in cpu_hz.
See: 
http://www.support.compaq.com/alpha-tools/info/system-codes.html
There are EV5 CPUs listed from 250 up to 366 MHz, and EV56 CPUs listed 
from 333 up to 667 MHz.
> I have attached a patch to fix cpu_hz, which gets the machine booting
> with 2.4.15-pre5.
I've included an updated patch that sets the min/max values in cpu_hz in 
arch/alpha/kernel/time.c to more correct values for EV5 and EV56 - I 
haven't verified that the other CPU types have correct min/max values.
diff -urN linux-2.4.15-pre5.orig/arch/alpha/kernel/time.c linux-2.4.15-pre5/arch/alpha/kernel/time.c
--- linux-2.4.15-pre5.orig/arch/alpha/kernel/time.c     Sun Nov 18 00:17:55 2001
+++ linux-2.4.15-pre5/arch/alpha/kernel/time.c  Sun Nov 18 08:00:20 2001
@@ -186,8 +186,8 @@
                [EV4_CPU]    = {  150000000,  300000000 },
                [LCA4_CPU]   = {  150000000,  300000000 },      /* guess */
                [EV45_CPU]   = {  200000000,  300000000 },
-               [EV5_CPU]    = {  266000000,  333333333 },
-               [EV56_CPU]   = {  366000000,  667000000 },
+               [EV5_CPU]    = {  250000000,  433000000 },
+               [EV56_CPU]   = {  333000000,  667000000 },
                [PCA56_CPU]  = {  400000000,  600000000 },      /* guess */
                [PCA57_CPU]  = {  500000000,  600000000 },      /* guess */
                [EV6_CPU]    = {  466000000,  600000000 },
Cheers,
Matthew.
-- 
Matthew Gregan                                     Operations Consultant
JADE Direct Central Systems                            NZ: 0 800 65 2266
Aoraki Corporation Limited                             AU: 1 800 12 0181
PO Box 20-152, Christchurch 8005                     Cell: +64 2977 8839
New Zealand                                           Fax: +64 3358 7156
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.kernel.org
More majordomo info at  
http://vger.kernel.org/majordomo-info.html
Please read the FAQ at  
http://www.tux.org/lkml/