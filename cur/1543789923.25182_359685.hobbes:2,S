Date: Sat, 22 Oct 2005 00:25:16 +0200
From: Francois Romieu <>
Subject: Re: [PATCH 2.6.14-rc3] sis5513.c: enable ATA133 for the SiS965 southbridge
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2005/10/21/223

wsong <wsong.cn@gmail.com> :
> This patch has conflict with sata_sis driver. They both register this
> id 0x0180. But pci ide driver is loaded first. So if you have sata
> drive connected as root, dang, you'll get kernel panic. I had this
> problem with 2.6.14_rc4-mm1. Simply delete the third line from
> structure sis5513_pci_tbl resolved it.
> 
> I know it's just a work around.
The lspci I have received for a k8s-mx exhibit a 5513 whose PCI ID is
already correctly set. If the ID masking and register remapping is not
really relevant on a 180, the code below could be enough. If it is wrong,
it may be better to check the availability of a good backup system before
using it.
Some features documentation suggest that the 760 and the 755 should
mostly go along with the same southbridge. 
Signed-off-by: Francois Romieu <romieu@fr.zoreil.com>
diff --git a/drivers/ide/pci/sis5513.c b/drivers/ide/pci/sis5513.c
--- a/drivers/ide/pci/sis5513.c
+++ b/drivers/ide/pci/sis5513.c
@@ -20,6 +20,7 @@
  * ATA16/33 support from specs
  * ATA133 support for SiS961/962 by L.C. Chang <lcchang@sis.com.tw>
  * ATA133 961/962/963 fixes by Vojtech Pavlik <vojtech@suse.cz>
+ * ATA133 965 hack by Ueimor <romieu@fr.zoreil.com>
  *
  * Documentation:
  *	SiS chipset documentation available under NDA to companies only
@@ -87,6 +88,9 @@ static const struct {
 	u8 chipset_family;
 	u8 flags;
 } SiSHostChipInfo[] = {
+	{ "SiS760",	PCI_DEVICE_ID_SI_760,	ATA_133  },
+	{ "SiS755",	PCI_DEVICE_ID_SI_755,	ATA_133  },
+
 	{ "SiS745",	PCI_DEVICE_ID_SI_745,	ATA_100  },
 	{ "SiS735",	PCI_DEVICE_ID_SI_735,	ATA_100  },
 	{ "SiS733",	PCI_DEVICE_ID_SI_733,	ATA_100  },
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.kernel.org
More majordomo info at  
http://vger.kernel.org/majordomo-info.html
Please read the FAQ at  
http://www.tux.org/lkml/