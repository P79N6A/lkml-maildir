Date: Wed, 15 Jun 2005 16:54:38 +0200
From: Alexander Sandler <>
Subject: Weirdness in error handling in SCSI and block layers.
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2005/6/15/91

Hi list.
I recently noticed something wrong in error handling in between SCSI
and block device driver layers.
The problem is that SCSI errors are not actually passed to block
device layer. When scsi_end_request() calls end_that_request_chunk()
it passes only the uptodate value which set earlier, at the end of
scsi_io_completion(), and only indicate whether request succeeded or
failed. Eventually __end_that_request_first() calls bio_endio() with
either -EIO or uptodate value (that in case of success will be 0). As
a result, instead of getting error code that more or less indicates
what kind of error took place, block device layer always gets -EIO.
Any comments/ideas?
Alexander Sandler.
PS: Please CC to me.
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.kernel.org
More majordomo info at  
http://vger.kernel.org/majordomo-info.html
Please read the FAQ at  
http://www.tux.org/lkml/