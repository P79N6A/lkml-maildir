Date: Mon, 2 Feb 2009 21:22:46 +0100
From: Luca Tettamanti <>
Subject: Re: [PATCH 1/2] RFC: ACPI: Interface for ACPI drivers to place quirk code which gets executed early
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2009/2/2/229

Il Mon, Feb 02, 2009 at 06:22:10PM +0100, Thomas Renninger ha scritto: 
> These two patches are tested on a ASUS machine and worked as expected,
> but probably may still need some cleanup.
I'd keep the DMI+HID approach since it's more flexible:
- (AFAICS) Thinkpads have different methods for hwmon depending on the
  model and no fixed HID
- With DMI it would be possible to include ASUS motherboards (ATK w/
  hwmon) but exclude ASUS laptops (ATK w/o hwmon).
> diff --git a/drivers/acpi/scan.c b/drivers/acpi/scan.c
> index c54d7b6..1c25747 100644
> --- a/drivers/acpi/scan.c
> +++ b/drivers/acpi/scan.c
> @@ -10,6 +10,7 @@
>  #include <linux/kthread.h>
> 
>  #include <acpi/acpi_drivers.h>
> +#include "acpi.h"
> 
>  #define _COMPONENT		ACPI_BUS_COMPONENT
>  ACPI_MODULE_NAME("scan");
> @@ -1562,6 +1563,8 @@ static int __init acpi_scan_init(void)
> 
>  	if (result)
>  		acpi_device_unregister(acpi_root, ACPI_BUS_REMOVAL_NORMAL);
> +	else
> +		acpi_device_quirks();
Hum, it's not immediatly clear why you put that call in the else
branch. Maybe put:
if (!result)
        acpi_device_quirks();
before the cleanup?
Luca
-- 
"La mia teoria scientifica preferita e` quella secondo la quale gli 
 anelli di Saturno sarebbero interamente composti dai bagagli andati 
 persi nei viaggi aerei." -- Mark Russel