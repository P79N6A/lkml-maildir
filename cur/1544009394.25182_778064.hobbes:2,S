Date: Sun, 07 Dec 2008 23:24:58 -0600
From: Robert Hancock <>
Subject: Re: IO space memcpy support for userspace.
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2008/12/8/2

Carlos O'Donell wrote:
> On Sat, Dec 6, 2008 at 1:34 AM, Dave Airlie <airlied@gmail.com> wrote:
>> Its a real pain in the ass with dynamic buffer objects, we don't want userspace
>> to care where they are located, the kernel migrates them in/out of
>> video memory, GART, local RAM etc.
>>
>> However I suspect I just need on these platforms to ban any CPU
>> accesses to pixmaps in VRAM. However
>> sw fallbacks to the front buffer will always need these accesses.
>>
>> Its going to be a real pain getting any traction this stuff upstream
>> (X.org/Mesa) where the world is x86 and maybe the odd powerpc, having
>> to do special accessors for shithouse hw is never going to be fun.
> 
> Is there no case on x86 when this matters?
> 
> What about ARM, ColdFire or MIPS?
On x86, assuming the kernel hasn't done stupid things like map memory 
ranges with conflicting memory types, etc. then no, it doesn't matter 
what instructions you use to beat on the memory range, which is as it 
should be. If this IA64 case is as described by Dave this really sounds 
like a case of a brain damaged platform IMHO.. having memory-mapped 
ranges where using certain instructions to write to them locks the 
machine is just ridiculous. This sounds like one of those cases where a 
hardware designer pawns off a particular case as "software can deal with 
it" and causes the software people 10 times as much aggravation as they 
saved themselves..
> 
> As the embedded market continues to grow I hope to see X.org/Mesa on
> more hardware with different memory access rules.
> 
> Cheers,
> Carlos.