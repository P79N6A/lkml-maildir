Date: 05 Jun 1999 12:45:40 +0200
From: Stefan Hornburg <>
Subject: Re: 2.3.5. ISDN-Problem
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/1999/6/5/26

"David S. Miller" <davem@redhat.com> writes:
>    From: Stefan Hornburg <racke@linuxia.de>
>    Date: 	04 Jun 1999 22:29:52 +0200
> 
>    Jun  4 22:21:32 gundel ipppd[1178]: local  IP address 192.109.225.59
>    Jun  4 22:21:32 gundel ipppd[1178]: remote IP address 192.109.225.7
>    Jun  4 22:21:32 gundel kernel: kmalloc: Size (160000) too large
>    Jun  4 22:21:32 gundel ipppd[1178]: ioctl(SIOCGIFCONF): No buffer space available
> 
>    Are there any patches available ?
> 
> The better question is why the ISDN tools are using a 160K buffer for
> SIOCGIFCONF calls?
> 
> But we'll fix this for a future 2.3.x release...
Here's the fix for the ISDN tools 
(thanks to Mike Galbraith <mikeg@weiden.de>):
Hi,
Due to the changes in 2.3.5:net/core/dev.c, dev_ifconf() can only
handle a buffer of up to 128k (kmalloc).  The stock MAX_IFS define
causes an attempted allocation of 160000.  4096 fits perfectly.
	-Mike
-------------------------dinky-diff---------------------------
--- ./ipppd/sys-linux.c.org	Thu Jun  3 15:57:36 1999
+++ ./ipppd/sys-linux.c	Thu Jun  3 15:57:50 1999
@@ -93,7 +93,7 @@
 
 static char *lock_file;
 
-#define MAX_IFS		5000
+#define MAX_IFS		4096
 
 #define FLAGS_GOOD (IFF_UP          | IFF_BROADCAST)
 #define FLAGS_MASK (IFF_UP          | IFF_BROADCAST | \
-- 
LinuXia - Solutions of Cool Competence - Internetprogramming and more
D-30163 Hannover, Waldstra√üe 4, 0511-3941290 (
http://www.linuxia.de/
)
Come to the land of real computing where penguins and their friends
spread the word of Open Source which crushes windows instantly.
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.rutgers.edu
Please read the FAQ at 
http://www.tux.org/lkml/