Date: Thu, 1 May 2008 01:21:02 +0400
From: Alexey Dobriyan <>
Subject: Re: [patch, -git] isdn: hysdn_procconf.c build fix
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2008/4/30/400

On Wed, Apr 30, 2008 at 12:24:47PM -0700, Harvey Harrison wrote:
> On Wed, 2008-04-30 at 12:14 -0700, Andrew Morton wrote:
> > On Wed, 30 Apr 2008 23:03:05 +0400
> > "Denis V. Lunev" <den@openvz.org> wrote:
> > > > 
> > > > allmodconfig is for one thing and one thing only: compilation coverage
> > > > testing.  If there is anything which is not compiled after `make
> > > > allmodconfig' then that's a bug.
> > > > 
> > > > But how to fix it?  Perhaps we need to add a CONFIG_ALLFOOCONFIG which can
> > > > be tested at the appropriate places.
> > > 
> > > I think that the same should be applied to allyesconfig
> > 
> > That's what ALLFOOCONFIG refers to ;)
> > 
> > There _might_ be a need to discriminate between allyesconfig and
> > allmodconfig, but usually not, I expect.
> > 
> > Perhaps we should implement CONFIG_ALLYESCONFIG, CONFIG_ALLMODCONFIG and
> > CONFIG_ALLFOOCONFIG, where
> > 
> > 	ALLFOOCONFIG = ALLYESCONFIG || ALLMODCONFIG
> > 
> > (where FOO is renamed to something sensible, but what?)
> 
> ALLBUILDCONFIG
ALLCRAPCONFIG
Driver wasn't built because of BROKEN_ON_SMP, so both allyes and allmod
wouldn't help.
If one repeats Ingo's trick on e.g. driver that is arch specific from other
arch, compile will die horrible death due to different includes, so the
trick is not universal.
Things that help:
* UP allmodconfig builds
	echo 'CONFIG_SMP=n' >1
	make KCONFIG_ALLCONFIG=1 allmodconfig
  alpha-smp-n-debug-n.log:
    CC [M]  drivers/isdn/hysdn/hysdn_procconf.o
  drivers/isdn/hysdn/hysdn_procconf.c: In function 'hysdn_procconf_init':
  drivers/isdn/hysdn/hysdn_procconf.c:408: error: too few arguments to function 'proc_create'
* double-checking logs that driver indeed was rebuilt
* attention, attention, attention -- code can hide in huge ifdef section
  and config option won't be turned on, so driver compiles, but not
  relevant part.