Date: Thu, 21 Apr 2005 11:36:26 +0800
From: Li Shaohua <>
Subject: Re: [PATCH 4/6]cpu state clean after hot remove
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2005/4/20/187

On Tue, 2005-04-12 at 13:31, Li Shaohua wrote:
> @@ -1052,7 +1086,7 @@ static void __init smp_boot_cpus(unsigne
>  		if (max_cpus <= cpucount+1)
>  			continue;
> 
> -		if (do_boot_cpu(apicid))
> +		if ((cpu = alloc_cpu_id() > 0) && do_boot_cpu(apicid, cpu))
>  			printk("CPU #%d not responding - cannot use it.\n",
>  								apicid);
>  		else
Oops, there is a typo in the patch. Andrew, please apply below patch
against above patch. Sorry for the inconvenience.
Thanks,
Shaohua
---
 linux-2.6.11-root/arch/i386/kernel/smpboot.c |    2 +-
 1 files changed, 1 insertion(+), 1 deletion(-)
diff -puN arch/i386/kernel/smpboot.c~smpboot arch/i386/kernel/smpboot.c
--- linux-2.6.11/arch/i386/kernel/smpboot.c~smpboot	2005-04-21 11:27:53.913041424 +0800
+++ linux-2.6.11-root/arch/i386/kernel/smpboot.c	2005-04-21 11:28:44.103411328 +0800
@@ -1166,7 +1166,7 @@ static void __init smp_boot_cpus(unsigne
 		if (max_cpus <= cpucount+1)
 			continue;
 
-		if ((cpu = alloc_cpu_id() > 0) && do_boot_cpu(apicid, cpu))
+		if (((cpu = alloc_cpu_id()) <= 0) || do_boot_cpu(apicid, cpu))
 			printk("CPU #%d not responding - cannot use it.\n",
 								apicid);
 		else
_
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.kernel.org
More majordomo info at  
http://vger.kernel.org/majordomo-info.html
Please read the FAQ at  
http://www.tux.org/lkml/