Date: Tue, 16 Dec 2008 15:26:59 +0900
From: Daisuke Nishimura <>
Subject: Re: Why are the pages not migrated to current cpuset after 'memory_migrate' is set true
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2008/12/16/13

Hi.
On Tue, 16 Dec 2008 13:11:57 +0800, Miao Xie <miaox@cn.fujitsu.com> wrote:
> Hi, Paul
> 
> I found the pages that task had allocated to it on nodes in its previous cpuset
> were not migrated to the tasks' current cpuset after 'memory_migrate' was set
> true. It looks strange for users. Why are the pages not migrated to current
> cpuset after 'memory_migrate' is set true?
> 
I don't know the reason of current behavior, but
> Step I did
> 1, allocate pages on cpuset (mems is 0, memory_migrate is 0)
> 2, change cpuset's mems (mems: 0 -> 1)
> 3, change cpuset's memory_migrate(memory_migrate: 0 -> 1) 
> 
from/to which node kernel should migrate pages in general ?
Should kernel remember previous value of "mems" ? What if we change "mems"
several times before setting memory_migrate ON ?
IMHO, current behavior is not so strange. All users have to do is
set memory_migrate ON *before* changing "mems" or attaching task
if they want to migrate pages.
Thanks,
Daisuke Nishimura.