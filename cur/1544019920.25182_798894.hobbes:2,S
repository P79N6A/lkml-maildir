Date: Thu, 29 Jan 2009 20:49:52 -0800 (PST)
From: Linus Torvalds <>
Subject: Re: [PATCH] Fix OOPS in mmap_region() when merging adjacent VM_LOCKED file segments
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2009/1/29/529

On Thu, 29 Jan 2009, Lee Schermerhorn wrote:
> 
> Just want to note that install_special_mappings()--used for, e.g., the
> vdso--sets VM_DONTEXPAND [one of the VM_SPECIAL flags] which, if we want
> to prevent merging, makes a lot of sense to me.
Yes. VM_DONTEXPAND in many ways really fits the "don't merge" thing, 
because the whole mremap() VM expansion thing is really equivalent to this 
explicit merge.
> It appears that get_user_pages() will balk at addresses in vmas with 
> VM_IO [and VM_PFNMAP] which might not be what one wants.  For example, 
> you can't pre-populate the ptes via make_pages_present() with this flag.
Well, anybody who plays games with vm_pgoff really _should_ be VM_IO. I 
don't see any real reason for it except for having a very special IO 
mapping. Of course, you quite possibly _also_ want VM_DONTEXPAND.
		Linus