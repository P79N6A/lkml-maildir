Date: Mon, 17 May 1999 19:40:39 -0700 (PDT)
From: Simon Kirby <>
Subject: Re: gettimeofday non-monotonic on 2.2.7 SMP
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/1999/5/19/107

On Mon, 17 May 1999, dave madden wrote:
>  =>From: Simon Kirby <sim@netnation.com>
>  =>...
>  =>My dual celeron 300As @ 450 MHz (2.2.9) running your program gives:
>  =>
>  =>Mon May 17 18:05:40 1999: fwd:774496/0:back max 0000000
>  =>Mon May 17 18:05:41 1999: fwd:913473/0:back max 0000000
> 
> That's what I expect, but what I get is:
> 
> Mon May 17 18:57:17 1999: fwd:362637/4:back max 0000003
> Mon May 17 18:57:18 1999: fwd:866801/9:back max 0000003
> Mon May 17 18:57:19 1999: fwd:873531/7:back max 0000004
> Mon May 17 18:57:20 1999: fwd:872292/8:back max 0000003
> Mon May 17 18:57:21 1999: fwd:873949/9:back max 0000003
> 
> with max [i.e. maximum clock decrement detected] going up to
> 5000-10000 (5-10ms) when I'm writing a CD or scrolling a Netscape
> window.
Just tried both (burning and scrolling in Netscape), no difference.
> Somebody else also reported success with a Dell SMP box running 2.2.9,
> so I compiled a copy for myself, but it didn't make any difference
> from 2.2.7.
Hmmm...
On loaded dual PII 350 at work:
Mon May 17 19:37:12 1999: fwd:279221/0:back max 0000000
Mon May 17 19:37:13 1999: fwd:596811/0:back max 0000000
Mon May 17 19:37:14 1999: fwd:670958/0:back max 0000000
Mon May 17 19:37:15 1999: fwd:678423/0:back max 0000000
Mon May 17 19:37:16 1999: fwd:647993/0:back max 0000000
Mon May 17 19:37:17 1999: fwd:672833/0:back max 0000000
Mon May 17 19:37:18 1999: fwd:665179/0:back max 0000000
Mon May 17 19:37:19 1999: fwd:638165/0:back max 0000000
Mon May 17 19:37:20 1999: fwd:624374/0:back max 0000000
Mon May 17 19:37:21 1999: fwd:675673/0:back max 0000000
Mon May 17 19:37:22 1999: fwd:651241/0:back max 0000000
Mon May 17 19:37:23 1999: fwd:682325/0:back max 0000000
Mon May 17 19:37:24 1999: fwd:639810/0:back max 0000000
Mon May 17 19:37:25 1999: fwd:627182/0:back max 0000000
Loaded dual PIII 450:
Mon May 17 19:38:09 1999: fwd:414354/0:back max 0000000
Mon May 17 19:38:10 1999: fwd:607775/0:back max 0000000
Mon May 17 19:38:11 1999: fwd:620345/0:back max 0000000
Mon May 17 19:38:12 1999: fwd:600607/0:back max 0000000
Mon May 17 19:38:13 1999: fwd:611782/0:back max 0000000
Mon May 17 19:38:14 1999: fwd:617592/0:back max 0000000
Mon May 17 19:38:15 1999: fwd:617667/0:back max 0000000
Mon May 17 19:38:16 1999: fwd:642869/0:back max 0000000
Mon May 17 19:38:17 1999: fwd:617755/0:back max 0000000
Mon May 17 19:38:18 1999: fwd:638355/0:back max 0000000
Mon May 17 19:38:19 1999: fwd:635935/0:back max 0000000
>  =>Another thing..Perhaps try enabling "MTRR" in the kernel if it's not
>  =>already to synchronize TSCs at bootup.  I'm not sure if MTRR does this or 
>  =>not, actually, so maybe try flashing a new BIOS if all else fails.  I know
>  =>some BIOSes don't synchronize the TSCs properly, and this would confuse
>  =>gettimeofday()...
> 
> I'm using MTRR, but that code doesn't mention the TSC.  My box is an
> Intel N440BX motherboard with the latest BIOS; what are your Celerons
> on?
All of the above (including my Celerons) are on ASUS P2B-DS boards.  Don't
have any other boards...
Simon-
| Simon Kirby               |   Systems Administration |
| mailto:sim@netnation.com  | NetNation Communications |
| 
http://www.netnation.com/
 |     Tech: (604) 684-6892 |
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.rutgers.edu
Please read the FAQ at 
http://www.tux.org/lkml/