Date: Thu, 09 May 2002 09:00:28 -0400
From: James Bottomley <>
Subject: Re: Problems with 2.5.14 PCI reorg and non-PCI architectures
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2002/5/9/118

greg@kroah.com said:
> arch/i386/pci/dma.c now only contains pci_alloc_consistent() and
> pci_free_consistent().  What kind of configuration are you using that
> works without CONFIG_PCI and yet calls those functions?  Is it a
> ISA_PNP type configuration?  Do you have a .config that this fails on?
The problem is that this is not necessarily PCI related on other platforms.
My cross platform SCSI driver, 53c700.c, uses pci_alloc_consistent because it 
has to work on parisc archs as well (which do have consistent memory even 
though a few of them don't have PCI busses).  It was failing a test compile.  
I can manipulate the #ifdefs so that it doesn't use the consistent allocation 
functions on x86, but I think, in principle, cross platform drivers should be 
able to use these functions.
> I'd be glad to move it back, but I'd like to understand who is using
> those functions outside of the pci and isa_pnp drivers. 
Yes, please.  If you look at a lot of the non-x86 arch drivers, some of them 
also use pci_alloc_consistent.  I think the only other x86 example I can come 
up with is aic7xxx_old which also supports the 7770 chip which is used for 
SCSI in the intel xpress motherboard (pure EISA).
James
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.kernel.org
More majordomo info at  
http://vger.kernel.org/majordomo-info.html
Please read the FAQ at  
http://www.tux.org/lkml/