Date: Tue, 20 Jul 1999 13:55:09 -0400 (EDT)
From: William Stearns <>
Subject: PROBLEM: System halt/oops during during first login after boot on 2.3.11-pre6.
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/1999/7/20/105

[1.] One line summary of the problem:    
	System halt/oops during during first login after boot on 2.3.11-pre6.
[2.] Full description of the problem/report:
	As I was booting into 2.3.11-pre6, the system suddenly oopsed.  The 
oops was only partially written to /var/log/messages.  I believe a 
second oops related to "init" showed up on the screen immediately after.
	As good news, the "bad page middle" errors didn't show up... :-)
	I realize that the "egcs" below may make this less than 100% useful, 
but I figured a half useful report might be better than none.
	I'm not able to try this again right now and won't be able to 
do more testing until late this evening; the laptop is needed for the 
day job...  When I do, I'll hand copy any oopses and resbumit this.
[3.] Keywords (i.e., modules, networking, kernel):
	boot, oops, cold hang (no sysrq)
[4.] Kernel version (from /proc/version):
	Actually, this is from 2.3.10, but the same compiler was used for 
the 2.3.10+2.3.11-pre6 that had trouble.
Linux version 2.3.10 (root@sparrow.websense.net) (gcc version egcs-2.91.66 19990314/Linux (egcs-1.1.2 release)) #1 Thu Jul 8 20:55:41 EDT 1999
[5.] Output of Oops.. message (if applicable) with symbolic information 
     resolved (see Documentation/oops-tracing.txt)
	The oops in /var/log/messages was truncated.  Here's all I have:
Jul 20 12:28:46 sparrow kernel: Unable to handle kernel NULL pointer dereference at virtual address 00000064
Jul 20 12:28:46 sparrow kernel:  printing eip:
Jul 20 12:28:46 sparrow kernel: c0122f73
Jul 20 12:28:46 sparrow kernel: current->thread.cr3 = 00cfa000, %cr3 = 00cfa000
Jul 20 12:28:46 sparrow kernel: *pde = 00000000
Jul 20 12:28:46 sparrow kernel: Oops: 0000
Jul 20 12:28:46 sparrow kernel: CPU:    0
Jul 20 12:28:46 sparrow kernel: EIP:    0010:[swap_out+95/220]
Jul 20 12:28:46 sparrow kernel: EFLAGS: 00010202
Jul 20 12:28:46 sparrow kernel: eax: 00000000   ebx: 00000000   ecx: c000c000
edx: 00000000
Jul 20 12:28:46 sparrow kernel: esi: 00000000   edi: 00000000   ebp: 00000005
esp: c000bfb0
Jul 20 12:28:46 sparrow kernel: ds: 0018   es: 0018   ss: 0018
Jul 20 12:28:46 sparrow kernel: Process kswapd (pid: 3, stackpage=c000b000)
Jul 20 12:28:46 sparrow kernel: Stack: 00000030 c000a000 00000000 00000000 c012304d 00000006 00000030 00000f00
Jul 20 12:28:46 sparrow kernel:        c01a7a4e c000a1c9 c01230be 00
	Ksymoops doesn't do much:
Options used: -V (default)
              -o /lib/modules/2.3.11/ (specified)
              -K (specified)
              -L (specified)
              -m /usr/src/linux/System.map (default)
              -c 1 (default)
No modules in ksyms, skipping objects
Jul 20 12:28:46 sparrow kernel: Unable to handle kernel NULL pointer dereference at virtual address 00000064
Jul 20 12:28:46 sparrow kernel: c0122f73
Jul 20 12:28:46 sparrow kernel: *pde = 00000000
Jul 20 12:28:46 sparrow kernel: Oops: 0000
Jul 20 12:28:46 sparrow kernel: CPU:    0
Jul 20 12:28:46 sparrow kernel: EIP:    0010:[swap_out+95/220]
Jul 20 12:28:46 sparrow kernel: EFLAGS: 00010202
Jul 20 12:28:46 sparrow kernel: eax: 00000000   ebx: 00000000   ecx: c000c000
Jul 20 12:28:46 sparrow kernel: esi: 00000000   edi: 00000000   ebp: 00000005
Jul 20 12:28:46 sparrow kernel: ds: 0018   es: 0018   ss: 0018
Jul 20 12:28:46 sparrow kernel: Process kswapd (pid: 3, stackpage=c000b000)
Jul 20 12:28:46 sparrow kernel: Stack: 00000030 c000a000 00000000 00000000 c012304d 00000006 00000030 00000f00
Jul 20 12:28:46 sparrow kernel:        c01a7a4e c000a1c9 c01230be 00
	
[6.] A small shell script or example program which triggers the
     problem (if possible)
[7.] Environment
[7.1.] Software (add the output of the ver_linux script here)
-- Versions installed: (if some fields are empty or looks
-- unusual then possibly you have very old versions)
Linux sparrow.websense.net 2.3.10 #1 Thu Jul 8 20:55:41 EDT 1999 i586 unknown
Kernel modules         2.1.121
Gnu C                  egcs-2.91.66
Binutils               2.9.1.0.23
Linux C Library        2.1.1
Dynamic linker         ldd (GNU libc) 2.1.1
Procps                 2.0.2
Mount                  2.9o
Net-tools              1.52
Console-tools          1999.03.02
Sh-utils               1.16
Modules Loaded         ip_masq_portfw ip_masq_autofw sb uart401 sound soundcore ppp_deflate bsd_comp ppp slhc ds i82365 pcmcia_core dummy
[7.2.] Processor information (from /proc/cpuinfo):
processor       : 0
vendor_id       : GenuineIntel
cpu family      : 5
model           : 2
model name      : Pentium 75 - 200
stepping        : 5
cpu MHz         : 90.208196
fdiv_bug        : no
hlt_bug         : no
sep_bug         : no
f00f_bug        : yes
coma_bug        : no
fpu             : yes
fpu_exception   : yes
cpuid level     : 1
wp              : yes
flags           : fpu vme de pse tsc msr mce cx8
bogomips        : 35.94
[7.3.] Module information (from /proc/modules):
	Loaded after rebooting into 2.3.10, but probably the same.
ip_masq_portfw          2352   0 (autoclean) (unused)
ip_masq_autofw          2304   1 (autoclean)
sb                     34260   0 (unused)
uart401                 6064   0 [sb]
sound                  59404   0 [sb uart401]
soundcore               2660   6 [sb sound]
ppp_deflate            40036   0 (unused)
bsd_comp                3696   0 (unused)
ppp                    20204   0 [ppp_deflate bsd_comp]
slhc                    4424   0 [ppp]
ds                      6028   2
i82365                 11164   2
pcmcia_core            33456   0 [ds i82365]
dummy                    856   0 (unused)
[7.4.] SCSI information (from /proc/scsi/scsi)
	No scsi loaded at that time.
[7.5.] Other information that might be relevant to the problem
       (please look in /proc and include all information that you
       think to be relevant):
[X.] Other notes, patches, fixes, workarounds:
	Toshiba laptop with APM enabled, compiled UP, 40M, single 4G IDE.
Straight console, hadn't gotten to X.
	Pcmcia-cs didn't compile correctly.  It's possible it _was_ loaded
from an old compiled version, but no pcmcia cards were in the slots.
	Kernel configuration:
CONFIG_EXPERIMENTAL=y
CONFIG_M586TSC=y
CONFIG_X86_WP_WORKS_OK=y
CONFIG_X86_INVLPG=y
CONFIG_X86_BSWAP=y
CONFIG_X86_POPAD_OK=y
CONFIG_X86_TSC=y
CONFIG_1GB=y
CONFIG_MTRR=y
CONFIG_MODULES=y
CONFIG_MODVERSIONS=y
CONFIG_KMOD=y
CONFIG_NET=y
CONFIG_SYSVIPC=y
CONFIG_SYSCTL=y
CONFIG_BINFMT_AOUT=m
CONFIG_BINFMT_ELF=y
CONFIG_BINFMT_MISC=m
CONFIG_PARPORT=m
CONFIG_PARPORT_PC=m
CONFIG_APM=y
CONFIG_APM_DO_ENABLE=y
CONFIG_APM_CPU_IDLE=y
CONFIG_APM_POWER_OFF=y
CONFIG_BLK_DEV_FD=m
CONFIG_BLK_DEV_IDE=y
CONFIG_BLK_DEV_IDEDISK=y
CONFIG_BLK_DEV_LOOP=m
CONFIG_BLK_DEV_NBD=m
CONFIG_BLK_DEV_RAM=y
CONFIG_BLK_DEV_INITRD=y
CONFIG_PARIDE_PARPORT=m
CONFIG_PACKET=m
CONFIG_NETLINK=y
CONFIG_RTNETLINK=y
CONFIG_NETLINK_DEV=y
CONFIG_FIREWALL=y
CONFIG_UNIX=y
CONFIG_INET=y
CONFIG_IP_MULTICAST=y
CONFIG_IP_ADVANCED_ROUTER=y
CONFIG_RTNETLINK=y
CONFIG_NETLINK=y
CONFIG_IP_MULTIPLE_TABLES=y
CONFIG_IP_ROUTE_MULTIPATH=y
CONFIG_IP_ROUTE_TOS=y
CONFIG_IP_ROUTE_NAT=y
CONFIG_IP_FIREWALL=y
CONFIG_IP_ALWAYS_DEFRAG=y
CONFIG_IP_ROUTE_FWMARK=y
CONFIG_IP_TRANSPARENT_PROXY=y
CONFIG_IP_MASQUERADE=y
CONFIG_IP_MASQUERADE_ICMP=y
CONFIG_IP_MASQUERADE_MOD=y
CONFIG_IP_MASQUERADE_IPAUTOFW=m
CONFIG_IP_MASQUERADE_IPPORTFW=m
CONFIG_IP_MASQUERADE_MFW=m
CONFIG_NET_IPIP=m
CONFIG_NET_IPGRE=m
CONFIG_NET_IPGRE_BROADCAST=y
CONFIG_IP_MROUTE=y
CONFIG_IP_PIMSM_V1=y
CONFIG_IP_ALIAS=y
CONFIG_SYN_COOKIES=y
CONFIG_INET_RARP=m
CONFIG_SKB_LARGE=y
CONFIG_IPV6=m
CONFIG_IPV6_EUI64=y
CONFIG_IPV6_NO_PB=y
CONFIG_IPX=m
CONFIG_IPX_INTERN=y
CONFIG_SPX=m
CONFIG_NET_SCHED=y
CONFIG_NETLINK=y
CONFIG_RTNETLINK=y
CONFIG_NET_SCH_CBQ=m
CONFIG_NET_SCH_CSZ=m
CONFIG_NET_SCH_PRIO=m
CONFIG_NET_SCH_RED=m
CONFIG_NET_SCH_SFQ=m
CONFIG_NET_SCH_TEQL=m
CONFIG_NET_SCH_TBF=m
CONFIG_NET_QOS=y
CONFIG_NET_ESTIMATOR=y
CONFIG_SCSI=m
CONFIG_BLK_DEV_SD=m
CONFIG_CHR_DEV_ST=m
CONFIG_BLK_DEV_SR=m
CONFIG_BLK_DEV_SR_VENDOR=y
CONFIG_SCSI_CONSTANTS=y
CONFIG_NETDEVICES=y
CONFIG_DUMMY=m
CONFIG_EQUALIZER=m
CONFIG_ETHERTAP=m
CONFIG_NET_ETHERNET=y
CONFIG_NET_ISA=y
CONFIG_PPP=m
CONFIG_SLIP=m
CONFIG_SLIP_COMPRESSED=y
CONFIG_SLIP_SMART=y
CONFIG_TR=y
CONFIG_SHAPER=m
CONFIG_VT=y
CONFIG_VT_CONSOLE=y
CONFIG_SERIAL=y
CONFIG_SERIAL_CONSOLE=y
CONFIG_UNIX98_PTYS=y
CONFIG_UNIX98_PTY_COUNT=256
CONFIG_PRINTER=m
CONFIG_MOUSE=y
CONFIG_PSMOUSE=y
CONFIG_RTC=y
CONFIG_VIDEO_DEV=m
CONFIG_VIDEO_BWQCAM=m
CONFIG_VIDEO_CQCAM=m
CONFIG_QUOTA=y
CONFIG_AUTOFS_FS=m
CONFIG_FAT_FS=m
CONFIG_MSDOS_FS=m
CONFIG_UMSDOS_FS=m
CONFIG_VFAT_FS=m
CONFIG_ISO9660_FS=m
CONFIG_JOLIET=y
CONFIG_MINIX_FS=m
CONFIG_NTFS_FS=m
CONFIG_NTFS_RW=y
CONFIG_PROC_FS=y
CONFIG_DEVPTS_FS=y
CONFIG_EXT2_FS=y
CONFIG_CODA_FS=m
CONFIG_NFS_FS=m
CONFIG_NFSD=m
CONFIG_SUNRPC=m
CONFIG_LOCKD=m
CONFIG_SMB_FS=m
CONFIG_NCP_FS=m
CONFIG_NCPFS_PACKET_SIGNING=y
CONFIG_NCPFS_STRONG=y
CONFIG_NCPFS_NFS_NS=y
CONFIG_NCPFS_OS2_NS=y
CONFIG_NCPFS_MOUNT_SUBDIR=y
CONFIG_NLS=y
CONFIG_NLS_CODEPAGE_437=y
CONFIG_NLS_CODEPAGE_850=m
CONFIG_NLS_ISO8859_1=y
CONFIG_NLS_ISO8859_15=m
CONFIG_VGA_CONSOLE=y
CONFIG_VIDEO_SELECT=y
CONFIG_SOUND=m
CONFIG_SOUND_OSS=m
CONFIG_SOUND_SB=m
CONFIG_SOUND_ADLIB=m
CONFIG_SOUND_MPU401=m
CONFIG_SOUND_OPL3SA1=m
CONFIG_SOUND_SOFTOSS=m
CONFIG_SOUND_YM3812=m
CONFIG_MAGIC_SYSRQ=y
---------------------------------------------------------------------------
	"When in danger or in doubt, run in circles, scream and shout."
	-- Troubleshooters creed.
--------------------------------------------------------------------------
William Stearns (wstearns@pobox.com).  Mason, Buildkernel, named2hosts, 
and ipfwadm2ipchains are at: 
http://www.pobox.com/~wstearns/
--------------------------------------------------------------------------
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.rutgers.edu
Please read the FAQ at 
http://www.tux.org/lkml/