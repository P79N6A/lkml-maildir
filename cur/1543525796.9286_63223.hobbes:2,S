Date: Mon, 14 Feb 2000 20:52:46 +0000 (UTC)
From: "James Turinsky [lkml]" <>
Subject: Re: 2.3.45 compile problems: (ac97_codec.c)
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2000/2/14/120

I applied it and it compiled and worked (es1371/ac97_codec as modules)
but when I load a mixer (aumix/kmix) the mixer croaks and causes... a
divide error! (Whee!)
ksymoops 2.3.3 on i686 2.3.45.  Options used
     -v /usr/src/linux/vmlinux (specified)
     -k /proc/ksyms (default)
     -l /proc/modules (default)
     -o /lib/modules/2.3.45/ (default)
     -m /usr/src/linux/System.map (default)
Feb 14 15:22:00 Jewel kernel: ac97_codec: ac97 vendor id1: 0x4352, id2: 0x5903 (Unknown) 
(ksymoops chopped off this next line with the divide error message; I
think the ksymoops maintainer should check into that.)
Feb 14 15:23:03 Jewel kernel: divide error: 0000
Feb 14 15:23:03 Jewel kernel: CPU:    0 
Feb 14 15:23:03 Jewel kernel: EIP:    0010:[<c88360c4>] 
Using defaults from ksymoops -t elf32-i386 -a i386
Feb 14 15:23:03 Jewel kernel: EFLAGS: 00010292 
Feb 14 15:23:03 Jewel kernel: eax: 00001f40   ebx: 00000018   ecx: 00000001   edx: 00000000 
Feb 14 15:23:03 Jewel kernel: esi: 00000064   edi: 00000000   ebp: 00000050   esp: c6803ed0 
Feb 14 15:23:03 Jewel kernel: ds: 0018   es: 0018   ss: 0018 
Feb 14 15:23:03 Jewel kernel: Process aumix (pid: 662, stackpage=c6803000) 
Feb 14 15:23:03 Jewel kernel: Stack: c68543c0 c6bfe030 80044d03 bffff9e0 c88365c9 c6bfe030 00000003 c68543c0  
Feb 14 15:23:03 Jewel kernel:        bffff9e0 80044d03 ffffffe7 00000000 c6802000 c418d000 c01cfefa 00000001  
Feb 14 15:23:03 Jewel kernel:        c01db561 00000286 00000040 080511a8 c743f4cc 00000286 080511e8 00000000  
Feb 14 15:23:03 Jewel kernel: Call Trace: [<c88365c9>] [con_flush_chars+18/24] [write_chan+577/752] [tty_write+424/592] [sys_rt_sigaction+117/204] [<c883a232>] [sys_ioctl+367/408]  
Feb 14 15:23:03 Jewel kernel: Code: f7 ff 89 f5 89 c3 29 dd 6b c9 64 89 c8 99 f7 ff 89 f1 89 c3  
>>EIP; c88360c4 <[ac97_codec]ac97_read_mixer+74/118>   <=====
Trace; c88365c9 <[ac97_codec]ac97_mixer_ioctl+1f9/2b0>
Code;  c88360c4 <[ac97_codec]ac97_read_mixer+74/118>
00000000 <_EIP>:
Code;  c88360c4 <[ac97_codec]ac97_read_mixer+74/118>   <=====
   0:   f7 ff                     idiv   %edi,%eax   <=====
Code;  c88360c6 <[ac97_codec]ac97_read_mixer+76/118>
   2:   89 f5                     mov    %esi,%ebp
Code;  c88360c8 <[ac97_codec]ac97_read_mixer+78/118>
   4:   89 c3                     mov    %eax,%ebx
Code;  c88360ca <[ac97_codec]ac97_read_mixer+7a/118>
   6:   29 dd                     sub    %ebx,%ebp
Code;  c88360cc <[ac97_codec]ac97_read_mixer+7c/118>
   8:   6b c9 64                  imul   $0x64,%ecx,%ecx
Code;  c88360cf <[ac97_codec]ac97_read_mixer+7f/118>
   b:   89 c8                     mov    %ecx,%eax
Code;  c88360d1 <[ac97_codec]ac97_read_mixer+81/118>
   d:   99                        cltd   
Code;  c88360d2 <[ac97_codec]ac97_read_mixer+82/118>
   e:   f7 ff                     idiv   %edi,%eax
Code;  c88360d4 <[ac97_codec]ac97_read_mixer+84/118>
  10:   89 f1                     mov    %esi,%ecx
Code;  c88360d6 <[ac97_codec]ac97_read_mixer+86/118>
  12:   89 c3                     mov    %eax,%ebx
Linux Jewel.SomeSites.com 2.3.45 #1 Mon Feb 14 14:54:13 EST 2000 i686
unknown
Kernel modules         2.3.9
Gnu C                  2.95.2
Binutils               2.9.5.0.16
Linux C Library        2.1.2
Dynamic linker         ldd (GNU libc) 2.1.2
Procps                 2.0.6
Mount                  2.9y
Net-tools              1.53
Console-tools          0.2.2
Sh-utils               2.0
Modules Loaded         bsd_comp es1371 ac97_codec ide-scsi 3c59x
-- JT, who seems to be doing an awful lot of bug reporting lately...
On Mon, 14 Feb 2000, Frank de Lange wrote:
> On Mon, Feb 14, 2000 at 12:25:06PM -0500, Jeff Garzik wrote:
> > Does this patch fix things?
> 
> ac97_codec.c: In function `ac97_probe_codec_Rsmp_b505a3f5':
> ac97_codec.c:501: parse error before `;'
> ac97_codec.c:505: break statement not within loop or switch
> ac97_codec.c:506: warning: control reaches end of non-void function
> ac97_codec.c: At top level:
> ac97_codec.c:507: parse error before `}'
> ac97_codec.c:510: parse error before string constant
> ac97_codec.c:511: warning: type defaults to `int' in declaration of `printk_Rsmp_1b7d4074'
> ac97_codec.c:511: warning: function declaration isn't a prototype
> ac97_codec.c:511: warning: data definition has no type or storage class
> ac97_codec.c:514: parse error before `->'
> ac97_codec.c:542: parse error before `->'
> ac97_codec.c:542: warning: type defaults to `int' in declaration of `ac97_set_mixer'
> ac97_codec.c:542: warning: function declaration isn't a prototype
> ac97_codec.c:542: conflicting types for `ac97_set_mixer'
> ac97_codec.c:280: previous declaration of `ac97_set_mixer'
> ac97_codec.c:542: warning: data definition has no type or storage class
> ac97_codec.c:178: warning: `ac97_read_mixer' defined but not used
> ac97_codec.c:228: warning: `ac97_write_mixer' defined but not used
> ac97_codec.c:325: warning: `ac97_mixer_ioctl' defined but not used
> ac97_codec.c:104: warning: `mixer_defaults' defined but not used
> make[2]: *** [ac97_codec.o] Error 1
> 
> Cheers//Frank
> 
> -- 
>   WWWWW      ________________________
>  ## o o\    /     Frank de Lange      \
>  }#   \|   /    +31-70-3712708 day     \
>   ##---# _/    +31-320-252965 night     \
>    ####   \ frank.de.lange@inet.kpn.com /
>            \    frank@unternet.org     /
>             --------------------------
> 
> -
> To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
> the body of a message to majordomo@vger.rutgers.edu
> Please read the FAQ at 
http://www.tux.org/lkml/
> 
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.rutgers.edu
Please read the FAQ at 
http://www.tux.org/lkml/