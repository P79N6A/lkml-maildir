Date: Mon, 4 Jan 1999 02:00:52 -0700 (MST)
From: Michal Jaegermann <>
Subject: Alpha: 2.2.0-pre4-ac1 ok but ATAPI CD not quite
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/1999/1/4/151

Here are results of tests of 2.2.0-pre4-ac1 on two different types,
UX (a.k.a. Ruffian) and EB64+, of Alpha.  The following patch is
required for a succesful compilation:
--- linux-2.2.0-pre4/ipc/util.c~	Sun Jan  3 19:26:46 1999
+++ linux-2.2.0-pre4/ipc/util.c	Sun Jan  3 19:51:02 1999
@@ -13,8 +13,10 @@
 #include <linux/shm.h>
 #include <linux/init.h>
 #include <linux/msg.h>
-#include <asm/ipc.h>
 #include <asm/uaccess.h>
+#ifndef __alpha__
+#include <asm/ipc.h>
+#endif
 
 #if defined(CONFIG_SYSVIPC)
 
as the header in question does not exist on Alpha.
After this fix on each machine both "platform specific" and "generic"
kernels compiled and booted.  Compiler used on UX was egcs-1.1.1, with
a fix to 'collect.c'; on EB64+ egcs-2.92.33 19981226 (gcc2 ss-980609
experimental).
There is, though, one weird problem.  EB64+ has disks on SCSI
controller (ncr53c875) but ATAPI CD-ROM.  When I am booting
"generic Alpha" kernel this CD is identified like this:
hda: NEC CD-ROM DRIVE:284, ATAPI CDROM drive
ide0 at 0x1f0-0x1f7,0x3f6 on irq 14
hda: ATAPI 8X CDROM drive, 128kB Cache
Uniform CDROM driver Revision: 2.51
and CDs are accesible as expected.  With identically configured
kernel where only "generic" board type was replaced with "eb64+"
I see:
hda: NEC CD-ROM DRIVE:284, ATAPI CDROM drive
ide0: UNABLE TO GET IRQ -14
hda: ERROR, PORTS ALREADY IN USE
and the device is dead.  Both results are consistent through
many attempts to boot.  I do not have comparison with UX as
there is no hooked up CD on this box at the moment. :-(
I should add that with all 2.0.x series kernels I get this
on eb64+ machine:
hda: IRQ probe failed (-14)
hda: IRQ probe failed (-14)
hda: NEC CD-ROM DRIVE:284, ATAPI CDROM drive
hda: IRQ probe failed (-14)
ide0 at 0x1f0-0x1f7,0x3f6 on irq 14
always in the same order; i.e. IRQ probe fails in 75% of cases but
CD drive works. :-)
Floppy is also detected in somewhat weird manner (2.88M is bogus
as this info is really not available on Alpha):
Floppy drive(s): fd0 is 2.88M
DOR0=4
floppy interrupt on bizarre fdc 1
handler=0000000000000000
FDC 0 is a National Semiconductor PC87306
whereas in 2.0.x kernels this simply looks like this:
Floppy drive(s): fd0 is 2.88M
FDC 0 is a National Semiconductor PC87306
but that drive works. :-)
  Michal
  michal@harddata.com
  michal@ellpspace.math.ualberta.ca
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.rutgers.edu
Please read the FAQ at 
http://www.tux.org/lkml/