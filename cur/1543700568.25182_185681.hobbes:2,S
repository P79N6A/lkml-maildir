Date: Tue, 23 Dec 2003 11:41:55 +1100
From: Nick Piggin <>
Subject: Re: [TRIVIAL PATCH] Use valid node number when unmapping CPUs
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2003/12/22/185

Matthew Dobson wrote:
> The cpu_2_node array for i386 is initialized to 0 for each CPU, 
> effectively mapping all CPUs to node 0 unless changed.  When we unmap 
> CPUs, however, we stick a -1 in the array, mapping the CPU to an 
> invalid node.  This really isn't helpful.  We should map the CPU to 
> node 0, to make sure that callers of cpu_to_node() and friends aren't 
> returned a bogus node number.  This trivial patch changes the 
> unmapping code to place a 0 in the node mapping for removed CPUs.
>
> Cheers!
I'd prefer it got initialised to -1 for each cpu, and either set to -1
or not touched during unmap.
0 is more bogus than the alternatives, isn't it? At least for the subset
of CPUs not on node 0. Callers should be fixed.
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.kernel.org
More majordomo info at  
http://vger.kernel.org/majordomo-info.html
Please read the FAQ at  
http://www.tux.org/lkml/