Date: Fri, 20 Jan 2006 13:13:36 -0500
From: 	Valdis.Kletnieks@vt ...
Subject: Re: Iptables error [Was: 2.6.16-rc1-mm2]
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2006/1/20/220

On Fri, 20 Jan 2006 17:23:18 +0100, Jiri Slaby said:
> Andrew Morton wrote:
> >Changes since 2.6.16-rc1-mm1:
> >
> >
> > linus.patch
> Hello,
> 
> Commit 4f2d7680cb1ac5c5a70f3ba2447d5aa5c0a1643a (Linus' 2.6 git tree) breaks my
> iptables (1.3.4):
> This is it:
> [NETFILTER] x_tables: Make XT_ALIGN align as strictly as necessary.
> 
> Or else we break on ppc32 and other 32-bit platforms.
> 
> Based upon a patch from Harald Welte.
> 
> Signed-off-by: David S. Miller <davem@davemloft.net>
> --- include/linux/netfilter/x_tables.h
> +++ include/linux/netfilter/x_tables.h
> @@ -19,7 +19,7 @@ struct xt_get_revision
> /* For standard target */
> #define XT_RETURN (-NF_REPEAT - 1)
> -#define XT_ALIGN(s) (((s) + (__alignof__(void *)-1)) & ~(__alignof__(void *)-1))
> +#define XT_ALIGN(s) (((s) + (__alignof__(u_int64_t)-1)) & ~(__alignof__(u_int64_t)-1))
> /* Standard return verdict, or do jump. */
> #define XT_STANDARD_TARGET ""
Confirmed here.  Backing out this one-liner makes iptables work for me.
i686 on a Pentium-4, gcc 4.1.0 from Fedora -devel tree.
[unhandled content-type:application/pgp-signature]