Date: Fri, 18 Jan 2008 14:02:23 -0500
From: "H. Peter Anvin" <>
Subject: Re: [PATCHv2] x86: Use v8086_mode helper, trivial unification
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2008/1/18/429

Harvey Harrison wrote:
> On Fri, 2008-01-18 at 16:00 +0100, Ingo Molnar wrote:
>>>> +	/*
>>>> +	 * Did it hit the DOS screen memory VA from vm86 mode?
>>>> +	 */
>>>> +	if (v8086_mode(regs)) {
>>>> +		unsigned long bit = (address - 0xA0000) >> PAGE_SHIFT;
>>>> +		if (bit < 32)
>>>> +			tsk->thread.screen_bitmap |= 1 << bit;
>>>> +	}
>> this does not build on 64-bit, because screen_bitmap is 32-bit only - so 
>> i had to pull the patch. I suspect a small #ifdef section would look 
>> better here?
>>
> 
> My original patch had the ifdef, you can grab that one.
> 
Me bad, I should have been less definite in my reply.
	-hpa