Date: Mon, 23 Aug 2004 14:23:11 -0700
From: Jesse Barnes <>
Subject: Re: kernbench on 512p
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2004/8/23/277

On Friday, August 20, 2004 1:19 pm, Manfred Spraul wrote:
> Jesse Barnes wrote:
> >Looks like a bit more context has changed.  Manfred, care to respin
> > against -mm3 so I can test?
>
> The patches are attached. Just boot-tested on a single-cpu system.
>
> Three  changes:
> - I've placed the per-group structure into rcu_state. That's simpler but
> wrong: the state should be allocated from node-local memory, not a big
> global array.
> - I found a bug/race in the cpu_offline path: When the last cpu of a
> group goes offline then the group must be forced into quiescent state.
> The "&& (!forced)" was missing.
> - I've removed the spin_unlock_wait(). It was intended to synchronize
> cpu_online_mask changes with the calculation of ->outstanding. Paul
> convinced me that this is not necessary.
I haven't been able to boot successfully with this patch applied.  Things seem 
to get real slow around the time init starts, and the system becomes 
unusable.  I applied them on top of stock 2.6.8.1-mm4, which boots fine 
without them (testing that again to make sure, but I booted it a few times 
this morning w/o incident).
Jesse
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.kernel.org
More majordomo info at  
http://vger.kernel.org/majordomo-info.html
Please read the FAQ at  
http://www.tux.org/lkml/