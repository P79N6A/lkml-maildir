Date: Sat, 2 Apr 2005 03:43:13 -0800
From: Paul Jackson <>
Subject: new SGI TIOCX driver in *-mm driver model locking broken
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2005/4/2/21

Looks like the new SGI TIOCX driver that Bruce Losure added to *-mm via
the patch "bk-ia64.patch" includes an instance of the old style driver
locking, that Patrick Mochel was changed to a new locking model.
If I try to compile 2.6.12-rc1-mm4 for SN2 with the config option
  CONFIG_SGI_TIOCX=y
the build fails with a bunch of errors on line 527 of tiocx.c, starting
with:
arch/ia64/sn/kernel/tiocx.c: In function `tiocx_exit':
arch/ia64/sn/kernel/tiocx.c:527: error: structure has no member named `bus_list'
The code in question includes the lines:
> static void __exit tiocx_exit(void)
> {
>         struct device *dev;
>         struct device *tdev;
> 
>         ...
>         list_for_each_entry_safe(dev, tdev, &tiocx_bus_type.devices.list,
>                                  bus_list) {
Someone, perhaps Patrick, needs to work the new locking model magic
on this piece of code.
-- 
                  I won't rest till it's the best ...
                  Programmer, Linux Scalability
                  Paul Jackson <pj@engr.sgi.com> 1.650.933.1373, 1.925.600.0401
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.kernel.org
More majordomo info at  
http://vger.kernel.org/majordomo-info.html
Please read the FAQ at  
http://www.tux.org/lkml/