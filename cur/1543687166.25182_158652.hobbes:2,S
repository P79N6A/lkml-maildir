Date: Tue, 19 Aug 2003 08:42:10 -0700
From: "Nguyen, Tom L" <>
Subject: RE: Updated MSI Patches
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2003/8/19/137

Tuesday, August 12, 2003, Zwane Mwaikambo wrote
>> +#ifdef CONFIG_PCI_MSI
>> +			/* Is this an active MSI? */
>> +			if (msi_desc[j])
>> +				continue;
>> +#endif
>> Since the code determinces whether this entry is NULL or not, I think any  
>> locking for msi_desc may not be required.
>Yes but there is other code which modifies msi_desc members. i think a per 
>msi_desc lock is needed. You could also use a kmem_cache to allocate them, 
>and perhaps utilise HWCACHE_ALIGN.
We will have set_affinity support for MSI in our next update release. The above
code will be deleted. Utilize HWCACHE_ALIGN to allocate msi_desc is a good
suggestion. Thanks!
On Thu, 7 Aug 2003, Zwane Mwaikambo wrote:
>> - Change the interface name from msi_free_vectors to msix_free_vectors since 
>> this interface is used for MSI-X device drivers, which request for releasing 
>> the number of vector back to the PCI subsystem.
>> - Change the function name from remove_hotplug_vectors to 
>> msi_remove_pci_irq_vectors to have a close match with function name 
>> msi_get_pci_irq_vector.
>I think the vector allocator code can all be arch specific generic, 
>there is no particular reason as to why it has to be MSI specific.
Some IHVs suggest changing the interface names from msi_alloc_vectors/
msi_free_vectors to msix_alloc_vectors/msix_free_vectors. You have a good point 
of keeping these generic. Agree.
Thanks,
Long
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.kernel.org
More majordomo info at  
http://vger.kernel.org/majordomo-info.html
Please read the FAQ at  
http://www.tux.org/lkml/