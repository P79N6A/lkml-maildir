Date: Tue, 12 Feb 2008 20:22:27 +0100
From: Andi Kleen <>
Subject: Re: [git pull] kgdb-light -v10
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2008/2/12/325

On Tue, Feb 12, 2008 at 10:11:13AM -0800, Linus Torvalds wrote:
> 
> 
> On Tue, 12 Feb 2008, Andi Kleen wrote:
> >
> > >  - the kgdb commands should always act on the *current* CPU only
> > >  - add one command that says "switch over to CPU #n" which just releases 
> > >    the current CPU and sends an IPI to that CPU #n (no timeouts, no 
> > >    synchronous waiting, no nothing - it's like a "continue", but with a 
> > >    "try to get the other CPU to stop"
> > 
> > The problem I see here is that the kernel tends to get badly confused
> > if one CPU just stops responding. At some point someone does an global
> > IPI and that then hangs.  You would need to hotunplug the CPU which
> > is theoretically possible, but quite intrusive.
> 
> You're thinking about this totally *wrong*.
> 
> You definitely do not want to hot-unplug or isolate anything at all. 
I agree that it wouldn't be a good idea -- i was just pointing out
consequences of your proposal.
> Just let the other CPU's hang naturally if they need to wait for IPI's 
> etc. What's the downside?
There tend to be timeouts (e.g. softlock/nmi watchdog at least). I think
some of the IPIs eventually time out too.  In general losing a lot 
of time can lead to weird side effects.
-Andi