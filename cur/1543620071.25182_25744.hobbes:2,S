Date: Tue, 5 Feb 2002 15:56:32 +0100 (CET)
From: Adrian Bunk <>
Subject: [patch] fix 2.4.18-pre8 compile error in cosa.c
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2002/2/5/57

Hi Marcelo,
the patch below fixes the following compile error in 2.4.18-pre8:
<--  snip  -->
gcc -D__KERNEL__ -I/home/bunk/linux/kernel-2.4/linux/include -Wall
-Wstrict-prototypes -Wno-trigraphs -O2 -fomit-frame-pointer
-fno-strict-aliasing -fno-common -pipe -mpreferred-stack-boundary=2
-march=k6   -DKBUILD_BASENAME=cosa  -c -o cosa.o cosa.c
cosa.c:109: parse error
<--  snip  -->
Line 109 is
  #if LINUX_VERSION_CODE < KERNEL_VERSION(2,3,1)
I was first thinking about including linux/version.h to fix it but since
in another place where there's in the cosa.c in kernel 2.2.20 a check for
2.2 kernels the code for the older kernels was already removed in the
cosa.c in kernel 2.4.18-pre8 I assume that it's no longer intended to use
this version of the file in 2.2 kernels.
--- drivers/net/wan/cosa.c.old	Tue Feb  5 15:37:20 2002
+++ drivers/net/wan/cosa.c	Tue Feb  5 15:47:37 2002
@@ -105,13 +105,6 @@
 #include <net/syncppp.h>
 #include "cosa.h"
-/* Linux version stuff */
-#if LINUX_VERSION_CODE < KERNEL_VERSION(2,3,1)
-typedef struct wait_queue *wait_queue_head_t;
-#define DECLARE_WAITQUEUE(wait, current) \
-	struct wait_queue wait = { current, NULL }
-#endif
-
 /* Maximum length of the identification string. */
 #define COSA_MAX_ID_STRING	128
cu
Adrian
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.kernel.org
More majordomo info at  
http://vger.kernel.org/majordomo-info.html
Please read the FAQ at  
http://www.tux.org/lkml/