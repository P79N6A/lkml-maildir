Date: Thu, 10 Oct 2002 15:55:18 -0700
From: "H. Peter Anvin" <>
Subject: Re: weird semantics of cpu/*/msr
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2002/10/10/294

Martin Waitz wrote:
> hi :)
> 
> the i386 msr driver is a bit strange:
> 
> * when reading/writing, it does not update the file position/msr register
> * file position is used directly as msr register
> 
> that is, reads with count>8 do read from the same register multiple
> times, and writes overwrite themselves.
> 
> i would expect the following semantics:
> * file position is (msr register * 8). position%8!=0 is invalid
> * read/write updating file position.
> 
> that would make it possible to write/read multiple MSRs with one
> syscall, which is very handy when initializing P4 performance counters.
> 
> should i implement that behaviour?
> of course it would break binary compatibility with existing
> uses of that drivers.
> perhaps we would need a new location for the new api.
> 
No, you should not.
Simply put, the semantics were chosen for what typically makes sense
w.r.t. MSRs.
	-hpa
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.kernel.org
More majordomo info at  
http://vger.kernel.org/majordomo-info.html
Please read the FAQ at  
http://www.tux.org/lkml/