Date: Fri, 23 Mar 2007 10:00:17 -0500
From: Larry Finger <>
Subject: Re: 2.6.21-rc4-mm1
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2007/3/23/156

Cornelia Huck wrote:
> On Thu, 22 Mar 2007 13:55:51 -0500,
> Larry Finger <larry.finger@lwfinger.net> wrote:
>> I applied the debug patch, but I don't see any error codes being returned. This time I also got the
>> General Protection Faults. An excerpt of the log is attached.
> 
> Hm, I think I have an idea about what happened.
> 
> The firmware class tried to suppress the first KOBJ_ADD uevent by
> returning -ENODEV in firmware_uevent if FW_STATUS_READY was not set.
> This only worked as long as the return code of kobject_uevent was not
> checked in device_add. hack-to-make-wireless-work.patch made that first
> uevent return successfully, but this possible triggered some udev rule
> too early, leading to firmware load failures.
> 
> The following (completely untested) patch uses uevent_suppress to stop
> the uevent from being generated during device_add. Does this work for
> you?
Yes it does. Good job. On my first reboot with the new code, the startup of X hung with the black
screen and the big X cursor, but that seems to have been a single occurrence. With the patch, the
bcm43xx firmware is loaded and the device is working.
Thanks,
Larry
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.kernel.org
More majordomo info at  
http://vger.kernel.org/majordomo-info.html
Please read the FAQ at  
http://www.tux.org/lkml/