Date: Mon, 10 Dec 2007 14:50:02 +0900
From: Yasunori Goto <>
Subject: Re: sparsemem: Make SPARSEMEM_VMEMMAP selectable
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2007/12/10/6

Looks good to me.
Thanks.
Acked-by: Yasunori Goto <y-goto@jp.fujitsu.com>
> 
> From: Geoff Levand <geoffrey.levand@am.sony.com>
> 
> SPARSEMEM_VMEMMAP needs to be a selectable config option to
> support building the kernel both with and without sparsemem
> vmemmap support.  This selection is desirable for platforms
> which could be configured one way for platform specific
> builds and the other for multi-platform builds.
> 
> Signed-off-by: Miguel Boton <mboton@gmail.com>
> Signed-off-by: Geoff Levand <geoffrey.levand@am.sony.com>
> ---
> 
> Andrew, 
> 
> Please consider for 2.6.24.
> 
> -Geoff
> 
> 
>  mm/Kconfig |   15 +++++++--------
>  1 file changed, 7 insertions(+), 8 deletions(-)
> 
> --- a/mm/Kconfig
> +++ b/mm/Kconfig
> @@ -112,18 +112,17 @@ config SPARSEMEM_EXTREME
>  	def_bool y
>  	depends on SPARSEMEM && !SPARSEMEM_STATIC
> 
> -#
> -# SPARSEMEM_VMEMMAP uses a virtually mapped mem_map to optimise pfn_to_page
> -# and page_to_pfn.  The most efficient option where kernel virtual space is
> -# not under pressure.
> -#
>  config SPARSEMEM_VMEMMAP_ENABLE
>  	def_bool n
> 
>  config SPARSEMEM_VMEMMAP
> -	bool
> -	depends on SPARSEMEM
> -	default y if (SPARSEMEM_VMEMMAP_ENABLE)
> +	bool "Sparse Memory virtual memmap"
> +	depends on SPARSEMEM && SPARSEMEM_VMEMMAP_ENABLE
> +	default y
> +	help
> +	 SPARSEMEM_VMEMMAP uses a virtually mapped memmap to optimise
> +	 pfn_to_page and page_to_pfn operations.  This is the most
> +	 efficient option when sufficient kernel resources are available.
> 
>  # eventually, we can have this option just 'select SPARSEMEM'
>  config MEMORY_HOTPLUG
> 
> 
-- 
Yasunori Goto 