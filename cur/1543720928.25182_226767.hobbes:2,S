Date: Fri, 11 Jun 2004 19:32:53 +0200
From: Martin Schwidefsky <>
Subject: [PATCH] s390: common i/o layer.
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2004/6/11/125

[PATCH] s390: common i/o layer.
From: Cornelia Huck <cohuck@de.ibm.com>
Common i/o layer changes:
 - Remove bogus defines.
 - Fix length of strncmp on bus id.
Signed-off-by: Martin Schwidefsky <schwidefsky@de.ibm.com>
diffstat:
 drivers/s390/cio/chsc.c   |    3 +--
 drivers/s390/cio/chsc.h   |    1 -
 drivers/s390/cio/device.c |    5 +++--
 3 files changed, 4 insertions(+), 5 deletions(-)
diff -urN linux-2.6/drivers/s390/cio/chsc.c linux-2.6-s390/drivers/s390/cio/chsc.c
--- linux-2.6/drivers/s390/cio/chsc.c	Fri Jun 11 19:09:24 2004
+++ linux-2.6-s390/drivers/s390/cio/chsc.c	Fri Jun 11 19:09:57 2004
@@ -1,7 +1,7 @@
 /*
  *  drivers/s390/cio/chsc.c
  *   S/390 common I/O routines -- channel subsystem call
- *   $Revision: 1.111 $
+ *   $Revision: 1.112 $
  *
  *    Copyright (C) 1999-2002 IBM Deutschland Entwicklung GmbH,
  *			      IBM Corporation
@@ -24,7 +24,6 @@
 #include "ioasm.h"
 #include "chsc.h"
 
-#define CHPID_LONGS (256 / (8 * sizeof(long))) /* 256 chpids */
 static struct channel_path *chps[NR_CHPIDS];
 
 static void *sei_page;
diff -urN linux-2.6/drivers/s390/cio/chsc.h linux-2.6-s390/drivers/s390/cio/chsc.h
--- linux-2.6/drivers/s390/cio/chsc.h	Mon May 10 04:33:13 2004
+++ linux-2.6-s390/drivers/s390/cio/chsc.h	Fri Jun 11 19:09:57 2004
@@ -23,5 +23,4 @@
 extern void s390_process_css( void );
 extern void chsc_validate_chpids(struct subchannel *);
 extern void chpid_is_actually_online(int);
-extern int is_chpid_online(int);
 #endif
diff -urN linux-2.6/drivers/s390/cio/device.c linux-2.6-s390/drivers/s390/cio/device.c
--- linux-2.6/drivers/s390/cio/device.c	Fri Jun 11 19:09:24 2004
+++ linux-2.6-s390/drivers/s390/cio/device.c	Fri Jun 11 19:09:57 2004
@@ -1,7 +1,7 @@
 /*
  *  drivers/s390/cio/device.c
  *  bus driver for ccw devices
- *   $Revision: 1.119 $
+ *   $Revision: 1.120 $
  *
  *    Copyright (C) 2002 IBM Deutschland Entwicklung GmbH,
  *			 IBM Corporation
@@ -526,7 +526,8 @@
 		cdev = to_ccwdev(dev);
 		if ((cdev->private->state == DEV_STATE_DISCONNECTED) &&
 		    (cdev->private->devno == devno) &&
-		    (!strncmp(cdev->dev.bus_id, sibling->dev.bus_id, 4))) {
+		    (!strncmp(cdev->dev.bus_id, sibling->dev.bus_id,
+			      BUS_ID_SIZE))) {
 			cdev->private->state = DEV_STATE_NOT_OPER;
 			break;
 		}
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.kernel.org
More majordomo info at  
http://vger.kernel.org/majordomo-info.html
Please read the FAQ at  
http://www.tux.org/lkml/