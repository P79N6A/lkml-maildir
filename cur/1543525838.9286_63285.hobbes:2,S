Date: Mon, 14 Feb 2000 21:53:38 +0100 (CET)
From: Gerd Knorr <>
Subject: 2.2.13 Oops: chrdev_open / kmod / videodev
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2000/2/14/182

  Hi *,
I get kernel oopses if there is some invalid insmod option in the
/etc/modules.conf config file and that module gets loaded by kmod.
This is 2.2.13 with a few patches: dvd, new i2c, bttv 0.7.18.
If I start some app (like v4l-conf) which opens /dev/video0, the kernel
asks modprobe to load the driver.  modprobe loads all modules required by
bttv just fine (videodev, i2c-core, i2c-algo-bit).  It fails on bttv due
to the invalid insmod option.  Then the kernel throws a oops at me.  Log
below.
modules.conf looks like this:
	alias char-major-81     videodev
	alias char-major-81-0   bttv
	options bttv            foo=bar
It does _not_ happen if configured this way:
	alias char-major-81     bttv
	options bttv            foo=bar
BTW: 2.3.45 oopses too.
  Gerd
-------------------------------------------------------------
Feb 14 21:22:21 bogomips kernel: Linux video capture interface: v0.01 ALPHA 
Feb 14 21:22:21 bogomips kernel: i2c-core.o: i2c core module 
Feb 14 21:22:21 bogomips kernel: i2c-algo-bit.o: i2c bit algorithm module 
Feb 14 21:22:21 bogomips insmod: /lib/modules/2.2.13/misc/bttv.o: invalid parameter foo
Feb 14 21:22:21 bogomips kernel: Unable to handle kernel paging request at virtual address cc8ad167 
Feb 14 21:22:21 bogomips kernel: current->tss.cr3 = 0aed7000, %cr3 = 0aed7000 
Feb 14 21:22:21 bogomips kernel: *pde = 0bb65063 
Feb 14 21:22:21 bogomips kernel: *pte = 00000000 
Feb 14 21:22:21 bogomips kernel: Oops: 0000 
Feb 14 21:22:21 bogomips kernel: CPU:    0 
Feb 14 21:22:21 bogomips kernel: EIP:    0010:[<cc8ad167>] 
Feb 14 21:22:21 bogomips kernel: EFLAGS: 00010292 
Feb 14 21:22:21 bogomips kernel: eax: 00000000   ebx: caed9f10   ecx: 000002eb   edx: 00000000 
Feb 14 21:22:21 bogomips kernel: esi: 00000000   edi: cc8ad5a0   ebp: caf406e0   esp: caed9eec 
Feb 14 21:22:21 bogomips kernel: ds: 0018   es: 0018   ss: 0018 
Feb 14 21:22:21 bogomips kernel: Process v4l-conf (pid: 744, process nr: 46, stackpage=caed9000) 
Feb 14 21:22:21 bogomips kernel: Stack: 00000031 cc8ad15e caed9f10 cc8ad424 00000051 00000000 00000000 cb799b00  
Feb 14 21:22:21 bogomips kernel:        caf42330 72616863 6a616d2d 382d726f 00302d31 c012c5d5 caf42330 00000006  
Feb 14 21:22:21 bogomips kernel:        00000001 c0125d44 caf42330 cb799b00 bffffc4c bffffb6c cb799b00 00000000  
Feb 14 21:22:21 bogomips kernel: Call Trace: [open_namei+469/776] [chrdev_open+72/88] [filp_open+184/264] [filp_open+17/264] [sys_open+63/160] [sys_open+38/160] [error_code+45/52]  
Feb 14 21:22:21 bogomips kernel:        [system_call+52/56]  
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.rutgers.edu
Please read the FAQ at 
http://www.tux.org/lkml/