Date: Tue, 5 Sep 2006 10:41:56 +0900
From: KAMEZAWA Hiroyuki <>
Subject: Re: [RFC][PATCH] ps command race fix take 4 [1/4] callback subroutine
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2006/9/4/297

On Mon, 04 Sep 2006 16:48:43 -0600
ebiederm@xmission.com (Eric W. Biederman) wrote:
> KAMEZAWA Hiroyuki <kamezawa.hiroyu@jp.fujitsu.com> writes:
> 
> > Updated some dirty codes. maybe easier to read than previous one.
> >
> > This ps command fix (proc_pid_readdir() fix) fixes the problem by
> >
> > - attach a callback for updating pointer from file descriptor to a task invoked
> >   at release_task()
> > - no additional global lock is required.
> > - walk through all and only task structs which is thread group leader.
> >
> > *Bad* point is adding additonal (small) lock and callback in exit path.
> With an unbounded callback chain length influenced by user space.
> 
yes. 1000 ps process will add 1000 chains. 1000 callbacks are called if a task is
removed while 1000 ps task points to it.
-Kame
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.kernel.org
More majordomo info at  
http://vger.kernel.org/majordomo-info.html
Please read the FAQ at  
http://www.tux.org/lkml/