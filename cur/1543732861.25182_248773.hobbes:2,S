Date: Fri, 03 Sep 2004 17:46:00 +0100
From: Andy Whitcroft <>
Subject: Re: [PATCH] tidy AMD 768MPX fix
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2004/9/3/245

> Even if we use a different software page size in some future x86 release
> the workaround is to reserve 4096 bytes. I don't think this change makes
> sense therefore.
I have always assumed that PAGE_SIZE in the bootmem allocator was
hardware page size; such that if software PAGE_SIZE was to change that
it would necessarily be replaced with two different constants.  But fair
enough.  In that case perhaps we should at least fix the code indent
etc.  Revised patch below.
-apw
=== 8< ===
Fix indentation and layout of AMD 768MPX errata #56 fix.
Revision: $Rev: 620 $
Signed-off-by: Andy Whitcroft <apw@shadowen.org>
diffstat 020-tidy-AMD-768MPX-fix
---
 setup.c |   10 ++++++----
 1 files changed, 6 insertions(+), 4 deletions(-)
diff -X /home/apw/brief/lib/vdiff.excl -rupN reference/arch/i386/kernel/setup.c current/arch/i386/kernel/setup.c
--- reference/arch/i386/kernel/setup.c	2004-09-02 18:05:57.000000000 +0100
+++ current/arch/i386/kernel/setup.c	2004-09-03 17:34:58.000000000 +0100
@@ -1052,12 +1052,14 @@ static unsigned long __init setup_memory
 	/* reserve EBDA region, it's a 4K region */
 	reserve_ebda_region();
 
-    /* could be an AMD 768MPX chipset. Reserve a page  before VGA to prevent
-       PCI prefetch into it (errata #56). Usually the page is reserved anyways,
-       unless you have no PS/2 mouse plugged in. */
+	/*
+	 * could be an AMD 768MPX chipset. Reserve a page before VGA to
+	 * prevent PCI prefetch into it (errata #56). Usually the page is
+	 * reserved anyways, unless you have no PS/2 mouse plugged in.
+	 */
 	if (boot_cpu_data.x86_vendor == X86_VENDOR_AMD &&
 	    boot_cpu_data.x86 == 6)
-	     reserve_bootmem(0xa0000 - 4096, 4096);
+		reserve_bootmem(0xa0000 - 4096, 4096);
 
 #ifdef CONFIG_SMP
 	/*
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.kernel.org
More majordomo info at  
http://vger.kernel.org/majordomo-info.html
Please read the FAQ at  
http://www.tux.org/lkml/