Date: Wed, 10 Oct 2007 20:22:23 +0200
From: Pierre Ossman <>
Subject: Re: idio{,ma}tic typos (was Re: + fix-vm_can_nonlinear-check-in-sys_remap_file_pages.patch added to -mm tree)
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2007/10/10/157

On Wed, 10 Oct 2007 14:45:40 +0400
Alexey Dobriyan <adobriyan@sw.ru> wrote:
> ["if (!x & y)" patch from yanzheng@]
> ["if (!x & y)" patch from adobriyan@]
> ["if (!x & y)" patches from viro@]
> 
> While we're at it, below is somewhat ugly sparse patch for detecting
> "&& 0x" typos.
> 
The maintainer for tifm is Alex Dubov, so cc:ing him.
> drivers/mmc/host/tifm_sd.c:183:9: warning: dubious && 0x
> 
> 	if ((r_data->flags & MMC_DATA_WRITE)
>             && DATA_CARRY)
> 		writel(host->bounce_buf_data[0],
> 		host->dev->addr
> 		+ SOCK_MMCSD_DATA);
> 
> 	given that DATA_CARRY is always used together with
> ->cmd_flags, this place is asking for obvious fixlet:
> 
> 
> [PATCH] tifm_sd.c: fix DATA_CARRY check
> 
> Signed-off-by: Alexey Dobriyan <adobriyan@sw.ru>
> ---
> 
>  drivers/mmc/host/tifm_sd.c |    2 +-
>  1 file changed, 1 insertion(+), 1 deletion(-)
> 
> --- a/drivers/mmc/host/tifm_sd.c
> +++ b/drivers/mmc/host/tifm_sd.c
> @@ -180,7 +180,7 @@ static void tifm_sd_transfer_data(struct tifm_sd
> *host) host->sg_pos++;
>  			if (host->sg_pos == host->sg_len) {
>  				if ((r_data->flags & MMC_DATA_WRITE)
> -				    && DATA_CARRY)
> +				    && (host->cmd_flags &
> DATA_CARRY)) writel(host->bounce_buf_data[0],
>  					       host->dev->addr
>  					       + SOCK_MMCSD_DATA);
> 
> 
> 
Rgds
Pierre
[unhandled content-type:application/pgp-signature]