Date: Sun, 14 Dec 2008 00:52:15 +0100 (CET)
From: Michael Schmitz <>
Subject: Re: [PATCH 2/3] ide: add ide_[un]lock_hwgroup() helpers
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2008/12/13/184

Hi,
> [ Sorry for the late reply. ]
No worries - I haven't been very active either. It's home improvement season 
down under...
> > Something I've run into while working on the locking stuff: what happens if the 
> > above ide_lock_hwgroup(hwgroup) sleeps for long enough to trigger the request 
> > timer? 
> 
> AFAICS this happens before the hwgroup timeout timer is armed and IDE is not
> using block layer request timers yet so we should be fine here..
OK; I'll just let it block while SCSI requests are in flight. Thanks for 
pondering this :-)
There's another change I'll send via Geert: since in Falcon, IDE uses stdma_intr 
as interrupt handler (interrupts dispatched there to whichever driver has 
exclusive use of the ST-DMA and associated interrupt), and this handler has been 
registered prior to IDE setup it is not necessary to request the IDE interrupt 
on Falcon when probing the IDE interface. In fact, this results in the IDE 
interrupt possibly getting run while the lock is not being held by IDE. 
Other than that it all seems to work fine. 
	Michael