Date: Thu, 4 Aug 2005 09:36:10 -0700
From: Ashok Raj <>
Subject: Re: [patch 5/8] x86_64:Dont do broadcast IPIs when hotplug is enabled in flat mode.
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2005/8/4/171

On Thu, Aug 04, 2005 at 12:51:07PM +0200, Andi Kleen wrote:
> >  static void flat_send_IPI_allbutself(int vector)
> >  {
> > +#ifndef CONFIG_HOTPLUG_CPU
> >  	if (((num_online_cpus()) - 1) >= 1)
> >  		__send_IPI_shortcut(APIC_DEST_ALLBUT, vector,APIC_DEST_LOGICAL);
> > +#else
> > +	cpumask_t allbutme = cpu_online_map;
> > +	int me = get_cpu(); /* Ensure we are not preempted when we clear */
> > +	cpu_clear(me, allbutme);
> > +	flat_send_IPI_mask(allbutme, vector);
> > +	put_cpu();
> 
> This still needs the num_online_cpus()s check.
Opps missed that... Thanks for spotting it.
I will send an updated one to Andrew.
-- 
Cheers,
Ashok Raj
- Open Source Technology Center
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.kernel.org
More majordomo info at  
http://vger.kernel.org/majordomo-info.html
Please read the FAQ at  
http://www.tux.org/lkml/