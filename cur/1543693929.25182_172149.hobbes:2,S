Date: Sun, 12 Oct 2003 22:14:19 +0200
From: Pavel Machek <>
Subject: Re: 2.7 thoughts
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2003/10/12/70

Hi!
> > Perhaps I've naive here, but - with hot-pluggable CPU machines, do you not
> > de-activate the CPU through software first, before pulling the CPU out, at
> > which point it is not in use?
> 
> Well, you deleted my reply, but never mind that.
> 
> This obviously can't work unless the kernel gets some kind of warning.
       ~~~~~~~~~~~~~~~~~~~~
> Userspace and kernel register state, once lost that way, can't be
> recovered, and if tasks are automatically suspended (e.g. cpu dumps to
> somewhere and a miracle occurs), you'll deadlock if the kernel was in
> a non-preemptible critical section at the time.
Of course it _can_ work without warning, it would just be *extremely*
hard to do within linux. [When you have big enough cluster, you have
to deal with nodes failing randomly; when you get big enough SMP,
you'll have same issue].
One [stupid] method to handle this would be to do periodic system
snapshots, and if cpu fails rollback and try again without that
cpu. You'll get nasty issues with network (duplicated packets on tx),
and funny stuff on console, but certainly way to make this work
exists.
								Pavel
-- 
When do you have a heart between your knees?
[Johanka's followup: and *two* hearts?]
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.kernel.org
More majordomo info at  
http://vger.kernel.org/majordomo-info.html
Please read the FAQ at  
http://www.tux.org/lkml/