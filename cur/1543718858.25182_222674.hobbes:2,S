Date: Tue, 25 May 2004 00:46:21 -0700
From: Andrew Morton <>
Subject: Re: Bug#250477: kernel-source-2.4.26: Lots of debug in RAID5
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2004/5/25/36

Neil Brown <neilb@cse.unsw.edu.au> wrote:
>
> -					printk("raid5: switching cache buffer size, %d --> %d\n", oldsize, size);
>  +					static long recent;
>  +					static int cnt;
>  +					static int warned;
>  +					if (time_after(recent+HZ, jiffies))
>  +						cnt++;
>  +					else {
>  +						recent = jiffies;
>  +						cnt = 0;
>  +					}
>  +					if (cnt > 50 && ! warned) {
>  +						printk("raid5: WARNING:array used in unsupported configuration, expect poor performance\n");
>  +						warned = 1;
>  +					}
>  +					if (!warned)
>  +						printk("raid5: switching cache buffer size, %d --> %d\n", oldsize, size);
Is it not possible to use __printk_ratelimit() in here?
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.kernel.org
More majordomo info at  
http://vger.kernel.org/majordomo-info.html
Please read the FAQ at  
http://www.tux.org/lkml/