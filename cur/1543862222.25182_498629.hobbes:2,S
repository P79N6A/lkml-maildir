Date: Fri, 12 Jan 2007 13:18:00 +0000
From: Frederik Deweerdt <>
Subject: Re: 2.6.20-rc4-mm1
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2007/1/12/72

On Fri, Jan 12, 2007 at 11:25:58AM +0100, Mariusz Kozlowski wrote:
> Hello,
> 
> 	Doesn't build on my laptop.
> 
> drivers/mmc/mmc.c: In function 'mmc_lock_unlock':
> drivers/mmc/mmc.c:1527: error: dereferencing pointer to incomplete type
> drivers/mmc/mmc.c:1527: warning: type defaults to 'int' in declaration of '_________p1'
> drivers/mmc/mmc.c:1527: error: dereferencing pointer to incomplete type
> drivers/mmc/mmc.c:1527: warning: assignment makes pointer from integer without a cast
> make[2]: *** [drivers/mmc/mmc.o] Error 1
> make[1]: *** [drivers/mmc] Error 2
> make: *** [drivers] Error 2
> 
Hi,
That's because mmc_lock_unlock should depend on CONFIG_KEYS, it uses struct key.
Could you try the following patch (compile tested)?
Regards,
Frederik
Signed-off-by: Frederik Deweerdt <frederik.deweerdt@gmail.com>
diff --git a/drivers/mmc/mmc.c b/drivers/mmc/mmc.c
index 3956023..c1fe01d 100644
--- a/drivers/mmc/mmc.c
+++ b/drivers/mmc/mmc.c
@@ -1503,6 +1503,8 @@ static void mmc_setup(struct mmc_host *h
 		mmc_process_ext_csds(host);
 }
 
+#ifdef CONFIG_MMC_PASSWORDS
+
 /**
  *	mmc_lock_unlock - send LOCK_UNLOCK command to a specific card.
  *	@card: card to which the LOCK_UNLOCK command should be sent
@@ -1617,6 +1619,8 @@ out:
 	return err;
 }
 
+#endif /* CONFIG_MMC_PASSWORDS */
+
 /**
  *	mmc_detect_change - process change of state on a MMC socket
  *	@host: host which changed state.
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.kernel.org
More majordomo info at  
http://vger.kernel.org/majordomo-info.html
Please read the FAQ at  
http://www.tux.org/lkml/