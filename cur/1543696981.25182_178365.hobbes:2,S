Date: Sat, 15 Nov 2003 12:33:10 -0500
From: "" <>
Subject: Problem: make bzImage crashes with a vmlinux Error 1
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2003/11/15/48

1. make bzImage crashes with a vmlinux Error 1.
2. When kernel 2.4.22 is compiled including the SiS chipsets or SiS agp
drivers, I get this error:
ld -m elf_i386 -T /usr/src/linux-2.4.22/arch/i386/vmlinux.lds -e stext
arch/i386/kernel/head.o arch/i386/kernel/init_task.o init/main.o
init/version.o init/do_mounts.o \
        --start-group \
        arch/i386/kernel/kernel.o arch/i386/mm/mm.o kernel/kernel.o mm/mm.o
fs/fs.o ipc/ipc.o \
         drivers/acpi/acpi.o drivers/parport/driver.o drivers/char/char.o
drivers/block/block.o drivers/misc/misc.o drivers/net/net.o
drivers/char/agp/agp.o drivers/char/drm/drm.o drivers/ide/idedriver.o
drivers/cdrom/driver.o drivers/sound/sounddrivers.o drivers/pci/driver.o
drivers/pnp/pnp.o drivers/video/video.o drivers/media/media.o \
        net/network.o \
        /usr/src/linux-2.4.22/arch/i386/lib/lib.a
/usr/src/linux-2.4.22/lib/lib.a /usr/src/linux-2.4.22/arch/i386/lib/lib.a \
        --end-group \
        -o vmlinux
drivers/char/drm/drm.o(.text+0x64b4): In function `sis_fb_alloc':
: undefined reference to `sis_malloc'
drivers/char/drm/drm.o(.text+0x654d): In function `sis_fb_alloc':
: undefined reference to `sis_free'
drivers/char/drm/drm.o(.text+0x65af): In function `sis_fb_free':
: undefined reference to `sis_free'
drivers/char/drm/drm.o(.text+0x6993): In function `sis_final_context':
: undefined reference to `sis_free'
make: *** [vmlinux] Error 1
3. Keywords: kernel modules
4. Linux version 2.4.22 (root@localserver) (gcc version 3.2.3) #5 Fri Nov
14 11:53:20 EST 2003
5. N/A
6. The config file created in make menuconfig is attached to this bug
report.
7. Slackware 9.1
7.1. Linux localserver 2.4.22 #5 Fri Nov 14 11:53:20 EST 2003 i586 unknown
unknown GNU/Linux
Gnu C                  3.3.2
Gnu make               3.80
util-linux             2.12
mount                  2.12
modutils               2.4.25
e2fsprogs              1.34
jfsutils               1.1.3
pcmcia-cs              3.2.5
quota-tools            3.09.
PPP                    2.4.1
Linux C Library        2.3.2
Dynamic linker (ldd)   2.3.2
Linux C++ Library      5.0.5
Procps                 2.0.16
Net-tools              1.60
Kbd                    1.08
Sh-utils               5.0
Modules Loaded         ne 8390 crc32
7.2. cat /proc/cpuinfo
processor       : 0
vendor_id       : AuthenticAMD
cpu family      : 5
model           : 8
model name      : AMD-K6(tm) 3D processor
stepping        : 12
cpu MHz         : 380.227
cache size      : 64 KB
fdiv_bug        : no
hlt_bug         : no
f00f_bug        : no
coma_bug        : no
fpu             : yes
fpu_exception   : yes
cpuid level     : 1
wp              : yes
flags           : fpu vme de pse tsc msr mce cx8 pge mmx syscall 3dnow
k6_mtrr
bogomips        : 758.57
7.3. cat /proc/modules
ne                      6592   1
8390                    5968   0 [ne]
crc32                   2880   0 [8390]
7.4. cat /proc/ioports
0000-001f : dma1
0020-003f : pic1
0040-005f : timer
0060-006f : keyboard
0080-008f : dma page reg
00a0-00bf : pic2
00c0-00df : dma2
00f0-00ff : fpu
0170-0177 : ide1
01f0-01f7 : ide0
02f8-02ff : serial(auto)
0300-031f : eth0
0376-0376 : ide1
03c0-03df : vga+
03f6-03f6 : ide0
03f8-03ff : serial(auto)
0cf8-0cff : PCI conf1
c000-cfff : PCI Bus #01
  cc00-cc7f : Silicon Integrated Systems [SiS] SiS530 3D PCI/AGP
de00-deff : C-Media Electronics Inc CM8338A
ffa0-ffaf : Silicon Integrated Systems [SiS] 5513 [IDE]
cat /proc/iomem
00000000-0009fbff : System RAM
0009fc00-0009ffff : reserved
000a0000-000bffff : Video RAM area
000c0000-000c7fff : Video ROM
000f0000-000fffff : System ROM
00100000-07beffff : System RAM
  00100000-002b8e6d : Kernel code
  002b8e6e-0034adff : Kernel data
07bf0000-07bf7fff : ACPI Tables
07bf8000-07bfffff : ACPI Non-volatile Storage
e7e00000-e7efffff : PCI Bus #01
  e7ef0000-e7efffff : Silicon Integrated Systems [SiS] SiS530 3D PCI/AGP
e8000000-ebffffff : Silicon Integrated Systems [SiS] 530 Host
fec00000-fec00fff : reserved
fee00000-fee00fff : reserved
fffc0000-ffffffff : reserved
7.5. lspci -vvv
00:00.0 Host bridge: Silicon Integrated Systems [SiS] 530 Host (rev 02)
        Control: I/O+ Mem+ BusMaster+ SpecCycle- MemWINV- VGASnoop- ParErr-
Stepping- SERR- FastB2B-
        Status: Cap+ 66Mhz- UDF- FastB2B- ParErr- DEVSEL=medium >TAbort-
<TAbort- <MAbort+ >SERR- <PERR-
        Latency: 32
        Region 0: Memory at e8000000 (32-bit, non-prefetchable) [size=64M]
        Capabilities: [c0] AGP version 2.0
                Status: RQ=32 Iso- ArqSz=0 Cal=0 SBA+ ITACoh- GART64-
HTrans- 64bit- FW- AGP3- Rate=x1,x2
                Command: RQ=1 ArqSz=0 Cal=0 SBA- AGP- GART64- 64bit- FW-
Rate=<none>
00:00.1 IDE interface: Silicon Integrated Systems [SiS] 5513 [IDE] (rev d0)
(prog-if 8a [Master SecP PriP])
        Subsystem: Silicon Integrated Systems [SiS] SiS5513 EIDE Controller
(A,B step)
        Control: I/O+ Mem- BusMaster+ SpecCycle- MemWINV- VGASnoop- ParErr-
Stepping- SERR- FastB2B-
        Status: Cap- 66Mhz- UDF- FastB2B- ParErr- DEVSEL=fast >TAbort-
<TAbort- <MAbort- >SERR- <PERR-
        Latency: 128
        Interrupt: pin A routed to IRQ 0
        Region 0: I/O ports at <ignored>
        Region 1: I/O ports at <ignored>
        Region 2: I/O ports at <ignored>
        Region 3: I/O ports at <ignored>
        Region 4: I/O ports at ffa0 [size=16]
00:01.0 ISA bridge: Silicon Integrated Systems [SiS] 85C503/5513 (rev b1)
        Control: I/O+ Mem+ BusMaster+ SpecCycle+ MemWINV- VGASnoop- ParErr-
Stepping- SERR- FastB2B-
        Status: Cap- 66Mhz- UDF- FastB2B- ParErr- DEVSEL=medium >TAbort-
<TAbort- <MAbort- >SERR- <PERR-
        Latency: 0
00:01.1 Class ff00: Silicon Integrated Systems [SiS] ACPI
        Control: I/O- Mem- BusMaster- SpecCycle- MemWINV- VGASnoop- ParErr-
Stepping- SERR- FastB2B-
        Status: Cap- 66Mhz- UDF- FastB2B- ParErr- DEVSEL=medium >TAbort-
<TAbort- <MAbort- >SERR- <PERR-
00:02.0 PCI bridge: Silicon Integrated Systems [SiS] SiS 530 Virtual
PCI-to-PCI bridge (AGP) (prog-if 00 [Normal decode])
        Control: I/O+ Mem+ BusMaster+ SpecCycle- MemWINV- VGASnoop- ParErr-
Stepping- SERR- FastB2B-
        Status: Cap- 66Mhz- UDF- FastB2B- ParErr- DEVSEL=fast >TAbort-
<TAbort- <MAbort- >SERR- <PERR-
        Latency: 0
        Bus: primary=00, secondary=01, subordinate=01, sec-latency=0
        I/O behind bridge: 0000c000-0000cfff
        Memory behind bridge: e7e00000-e7efffff
        Prefetchable memory behind bridge: fec00000-ffcfffff
        BridgeCtl: Parity- SERR- NoISA+ VGA+ MAbort- >Reset- FastB2B-
00:0c.0 Multimedia audio controller: C-Media Electronics Inc CM8338A (rev
10)
        Subsystem: C-Media Electronics Inc: Unknown device 0000
        Control: I/O+ Mem- BusMaster+ SpecCycle- MemWINV- VGASnoop- ParErr-
Stepping- SERR+ FastB2B-
        Status: Cap+ 66Mhz- UDF- FastB2B- ParErr- DEVSEL=medium >TAbort-
<TAbort- <MAbort- >SERR- <PERR-
        Latency: 32 (500ns min, 6000ns max)
        Interrupt: pin A routed to IRQ 10
        Region 0: I/O ports at de00 [size=256]
        Capabilities: [c0] Power Management version 1
                Flags: PMEClk- DSI- D1+ D2+ AuxCurrent=0mA
PME(D0-,D1-,D2-,D3hot-,D3cold-)
                Status: D0 PME-Enable- DSel=0 DScale=0 PME-
01:00.0 VGA compatible controller: Silicon Integrated Systems [SiS] SiS530
3D PCI/AGP (rev a2) (prog-if 00 [VGA])
        Subsystem: Silicon Integrated Systems [SiS] SiS530,620 GUI
Accelerator+3D
        Control: I/O+ Mem+ BusMaster+ SpecCycle- MemWINV- VGASnoop- ParErr-
Stepping- SERR- FastB2B-
        Status: Cap+ 66Mhz+ UDF- FastB2B- ParErr- DEVSEL=medium >TAbort-
<TAbort- <MAbort- >SERR- <PERR-
        Latency: 32 (500ns min)
        Region 0: Memory at ff000000 (32-bit, prefetchable) [size=8M]
        Region 1: Memory at e7ef0000 (32-bit, non-prefetchable) [size=64K]
        Region 2: I/O ports at cc00 [size=128]
        Capabilities: [40] Power Management version 1
                Flags: PMEClk- DSI- D1- D2+ AuxCurrent=0mA
PME(D0-,D1-,D2-,D3hot-,D3cold-)
                Status: D0 PME-Enable- DSel=0 DScale=0 PME-
        Capabilities: [50] AGP version 1.0
                Status: RQ=2 Iso- ArqSz=0 Cal=0 SBA- ITACoh- GART64-
HTrans- 64bit- FW- AGP3- Rate=x1,x2
                Command: RQ=1 ArqSz=0 Cal=0 SBA- AGP- GART64- 64bit- FW-
Rate=<none>
7.6. N/A
7.7. cat pci
PCI devices found:
  Bus  0, device   0, function  0:
    Host bridge: Silicon Integrated Systems [SiS] 530 Host (rev 2).
      Master Capable.  Latency=32.
      Non-prefetchable 32 bit memory at 0xe8000000 [0xebffffff].
  Bus  0, device   0, function  1:
    IDE interface: Silicon Integrated Systems [SiS] 5513 [IDE] (rev 208).
      Master Capable.  Latency=128.
      I/O at 0xffa0 [0xffaf].
  Bus  0, device   1, function  0:
    ISA bridge: Silicon Integrated Systems [SiS] 85C503/5513 (rev 177).
  Bus  0, device   1, function  1:
    Class ff00: Silicon Integrated Systems [SiS] ACPI (rev 0).
  Bus  0, device   2, function  0:
    PCI bridge: Silicon Integrated Systems [SiS] SiS 530 Virtual PCI-to-PCI
bridge (AGP) (rev 0).
      Master Capable.  No bursts.  Min Gnt=12.
  Bus  0, device  12, function  0:
    Multimedia audio controller: C-Media Electronics Inc CM8338A (rev 16).
      IRQ 10.
      Master Capable.  Latency=32.  Min Gnt=2.Max Lat=24.
      I/O at 0xde00 [0xdeff].
  Bus  1, device   0, function  0:
    VGA compatible controller: Silicon Integrated Systems [SiS] SiS530 3D
PCI/AGP (rev 162).
      Master Capable.  Latency=32.  Min Gnt=2.
      Prefetchable 32 bit memory at 0xff000000 [0xff7fffff].
      Non-prefetchable 32 bit memory at 0xe7ef0000 [0xe7efffff].
      I/O at 0xcc00 [0xcc7f].
X. This format goes by the format displayed in the website
http://www.kernel.org/pub/linux/docs/lkml/reporting-bugs.html.
 My guess to
reproduce this problem is to download the linux-2.4.22 kernel from
www.kernel.org and use the config file I send you to reproduce it. If it
was anything I did wrong, please Email me back explaining what went wrong.
Thank you.
--------------------------------------------------------------------
mail2web - Check your email from the web at
http://mail2web.com/
 .
[unhandled content-type:application/octet-stream]