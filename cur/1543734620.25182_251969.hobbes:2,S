Date: Tue, 14 Sep 2004 04:35:33 +0200
From: Tonnerre <>
Subject: Re: [patch 1/2] Incorrect PCI interrupt assignment on ES7000 for platform GSI
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2004/9/13/351

Salut,
On Mon, Sep 13, 2004 at 07:50:59PM -0600, Natalie.Protasevich@unisys.com wrote:
> diff -puN arch/i386/kernel/acpi/boot.c~mypatch arch/i386/kernel/acpi/boot.c
> --- linux/arch/i386/kernel/acpi/boot.c~mypatch	2004-09-13 14:08:21.192015024 -0600
> +++ linux-root/arch/i386/kernel/acpi/boot.c	2004-09-13 14:10:51.457171248 -0600
> @@ -442,6 +442,7 @@ int acpi_gsi_to_irq(u32 gsi, unsigned in
>  unsigned int acpi_register_gsi(u32 gsi, int edge_level, int active_high_low)
>  {
>  	unsigned int irq;
> +	unsigned int plat_gsi;
> 
>  #ifdef CONFIG_PCI
>  	/*
> @@ -463,10 +464,10 @@ unsigned int acpi_register_gsi(u32 gsi, 
> 
>  #ifdef CONFIG_X86_IO_APIC
>  	if (acpi_irq_model == ACPI_IRQ_MODEL_IOAPIC) {
> -		mp_register_gsi(gsi, edge_level, active_high_low);
> +		plat_gsi = mp_register_gsi(gsi, edge_level, active_high_low);
>  	}
>  #endif
> -	acpi_gsi_to_irq(gsi, &irq);
> +	acpi_gsi_to_irq(plat_gsi, &irq);
>  	return irq;
>  }
>  EXPORT_SYMBOL(acpi_register_gsi);
Looking at that,  won't that cause problems if  we don't have IOAPIC?
Then you end up using an undefined value as GSI.
			    Tonnerre
[unhandled content-type:application/pgp-signature]