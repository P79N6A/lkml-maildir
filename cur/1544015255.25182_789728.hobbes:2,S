Date: Sat, 10 Jan 2009 09:58:11 +0000
From: Richard Purdie <>
Subject: Re: [git pull] drm
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2009/1/10/51

On Sat, 2009-01-10 at 12:04 +1000, Dave Airlie wrote:
> On Sat, Jan 10, 2009 at 11:13 AM, Richard Purdie
> <rpurdie@linux.intel.com> wrote:
> > On Fri, 2009-01-09 at 18:03 +0000, Richard Purdie wrote:
> >> On Fri, 2009-01-09 at 15:07 +0000, Richard Purdie wrote:
> >> > I just updated to the latest kernel from git to test some other patches
> >> > and after logging into GDM the X server hangs before launching the
> >> > desktop (it appears to be trying to run glxinfo) on my Thinkpad T61
> >> > (i915 graphics). Bisection shows this happens after applying this
> >> > commit:
> >> >
> >> > On Mon, 2008-12-29 at 08:32 +0000, Dave Airlie wrote:
> >> > > commit 7c1c2871a6a3a114853ec6836e9035ac1c0c7f7a
> >> > > Author: Dave Airlie <airlied@redhat.com>
> >> > > Date:   Fri Nov 28 14:22:24 2008 +1000
> >
> > The patch below gets my system working again with the latest kernels.
> > Was dropping the drm_addmap() call for i915 intentional or not?
> 
> Yes, so now we need to find out what happens in your userspace, when
> it hangs is the machine dead?
> 
> or can you ssh in? any oops in the logs? can you get a sysrq-t
> backtrace for X.org and glxinfo?
The machine's keyboard and console switching is dead and the login in
process drops the wifi but I think I can get in through ssh over
ethernet. The power button does make it shutdown cleanly and there is no
oops. I'll try and get backtraces later, probably tonight.
I have a question though, where in the i915 driver is
master_priv->sarea_priv assigned a value? or master_priv->sarea for that
matter? As far as I can tell those pointers are never assigned values?
Is there a drm_getsarea() call missing? 
Perhaps my patch fixes things since sarea and sarea_priv are given a
value?
Cheers,
Richard