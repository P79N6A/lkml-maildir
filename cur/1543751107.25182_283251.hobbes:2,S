Date: Wed, 5 Jan 2005 12:24:35 +0100
From: Ingo Molnar <>
Subject: Re: ptrace single-stepping change breaks Wine
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2005/1/5/54

* Thomas Sailer <sailer@scs.ch> wrote:
> > I'm afraid Alexandre has decided not to apply this patch (the ABI
> > personality syscall). His reasoning is as follows:
> 
> Quite understandably.
another workaround to switch off flex-mmap is to set the stack ulimit to
'unlimited':
 saturn:~> cat /proc/self/maps | tail -7
 b7db3000-b7db4000 r--p 00cfd000 03:41 3735973    /usr/lib/locale/locale-archive
 b7db4000-b7de1000 r--p 00ccc000 03:41 3735973    /usr/lib/locale/locale-archive
 b7de1000-b7de7000 r--p 00cc3000 03:41 3735973    /usr/lib/locale/locale-archive
 b7de7000-b7fe7000 r--p 00000000 03:41 3735973    /usr/lib/locale/locale-archive
 b7fe7000-b7fe8000 rw-p b7fe7000 00:00 0
 bff2c000-c0000000 rw-p bff2c000 00:00 0
 ffffe000-fffff000 ---p 00000000 00:00 0
 saturn:~> ulimit -s unlimited
 saturn:~> cat /proc/self/maps | tail -7
 42188000-4218a000 rw-p 00014000 03:41 3433982    /lib/ld-2.3.3.so
 4218c000-422aa000 r-xp 00000000 03:41 3434006    /lib/tls/libc-2.3.3.so
 422aa000-422ac000 r--p 0011d000 03:41 3434006    /lib/tls/libc-2.3.3.so
 422ac000-422ae000 rw-p 0011f000 03:41 3434006    /lib/tls/libc-2.3.3.so
 422ae000-422b0000 rw-p 422ae000 00:00 0
 bfea0000-c0000000 rw-p bfea0000 00:00 0
 ffffe000-fffff000 ---p 00000000 00:00 0
e.g. SuSE defaults to an unlimited stack so flex-mmap is effectively
disabled there.
To set the VM to legacy, for all apps, set /proc/sys/vm/legacy_va_layout
to 1.
	Ingo
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.kernel.org
More majordomo info at  
http://vger.kernel.org/majordomo-info.html
Please read the FAQ at  
http://www.tux.org/lkml/