Date: Thu, 04 Nov 2004 14:11:17 -0500
From: Robert Love <>
Subject: Re: [patch] kobject_uevent: fix init ordering
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2004/11/4/275

On Thu, 2004-11-04 at 20:04 +0100, Kay Sievers wrote:
Hey, Kay.
> Looks good. Don't know why this never failed on any kernel I used.
> Does the failure happens on a SMP kernel?
In the original patches, I had the initialization done as module_init(),
which is done very late in the init ordering.  At some point it was
changed to core_initcall(), which is the very first things initialized.
> >  static int send_uevent(const char *signal, const char *obj, const void *buf,
> > -			int buflen, int gfp_mask)
> > +		       int buflen, int gfp_mask)
Ugh.  I am sure Greg can sort it out, but following patch has just the
init call ordering change.
	Robert Love
fix kobject_uevent init ordering
 lib/kobject_uevent.c |    2 +-
 1 files changed, 1 insertions(+), 1 deletions(-)
diff -urN linux-2.6.10-rc1/lib/kobject_uevent.c linux/lib/kobject_uevent.c
--- linux-2.6.10-rc1/lib/kobject_uevent.c	2004-10-25 16:17:09.000000000 -0400
+++ linux/lib/kobject_uevent.c	2004-11-04 13:20:32.731836880 -0500
@@ -149,7 +147,7 @@
 	return 0;
 }
 
-core_initcall(kobject_uevent_init);
+postcore_initcall(kobject_uevent_init);
 
 #else
 static inline int send_uevent(const char *signal, const char *obj,
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.kernel.org
More majordomo info at  
http://vger.kernel.org/majordomo-info.html
Please read the FAQ at  
http://www.tux.org/lkml/