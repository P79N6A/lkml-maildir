Date: Sat, 4 Dec 2004 18:33:27 +0100
From: Francois Romieu <>
Subject: Re: realtek r8169 + kernel 2.4.24 (openmosix)
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2004/12/4/41

Nicholas Papadakos <panic@quake.gr> :
[...]
> I copied the latest r8169.c file from kernel 2.4.28 but it didn't compile at
> all giving an error message:
> 
> r8169.c: In function `rtl8169_init_board':
> r8169.c:683: warning: implicit declaration of function `SET_NETDEV_DEV'
Don't bother: comment out this line.
> r8169.c:683: error: structure has no member named `dev'
> r8169.c: In function `rtl8169_make_unusable_by_asic':
> r8169.c:1164: warning: integer constant is too large for "long" type
> make[2]: *** [r8169.o] Error 1
Please apply:
--- drivers/net/r8169.c	2004-12-04 18:22:18.000000000 +0100
+++ drivers/net/r8169.c	2004-12-04 18:22:37.000000000 +0100
@@ -1161,7 +1161,7 @@ rtl8169_hw_start(struct net_device *dev)
 
 static inline void rtl8169_make_unusable_by_asic(struct RxDesc *desc)
 {
-	desc->addr = 0x0badbadbadbadbad;
+	desc->addr = 0x0badbadbadbadbadull;
 	desc->status &= ~cpu_to_le32(OWNbit | RsvdMask);
 }
 
[...]
> The patch I previously applied was a patch made by you in personal and it
> was posted in this mailing list.
> The patch name was : r8169-debug.patch and it contained the following.
> --- r8169.c-realtek	2004-01-17 14:14:50.000000000 +0100
> +++ r8169.c-debug	2004-01-17 14:17:25.000000000 +0100
> @@ -1290,6 +1290,11 @@ static void rtl8169_tx_interrupt (struct
>  	dirty_tx = priv->dirty_tx;
>  	tx_left = priv->cur_tx - dirty_tx;
> 
> +	if (entry + tx_left > NUM_TX_DESC) {
> +		printk(KERN_ERR, "r8169 bug. Please mail
> netdev@oss.sgi.com\n");
> +		return;
> +	}
> +
>  	while (tx_left > 0) {
>  		if( (priv->TxDescArray[entry].status & OWNbit) == 0 ){
>  			dev_kfree_skb_irq( priv->Tx_skbuff[dirty_tx %
> NUM_TX_DESC] );
It was just a debug patch, not a fix.
[info removed]
Thanks.
Would your application benefit from larger (> 1500 bytes) frames ?
(no need to include a complete copy of the original message)
--
Ueimor
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.kernel.org
More majordomo info at  
http://vger.kernel.org/majordomo-info.html
Please read the FAQ at  
http://www.tux.org/lkml/