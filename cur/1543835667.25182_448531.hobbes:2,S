Date: Mon, 31 Jul 2006 16:51:22 +0200
From: "J.A. Magallón" <>
Subject: Re: [2.6.18-rc1-mm2] libata: DMA speed too slow for cdrecord
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2006/7/31/151

On Mon, 31 Jul 2006 12:09:01 +0100, Alan Cox <alan@lxorguk.ukuu.org.uk> wrote:
> Ar Sad, 2006-07-29 am 23:54 +0200, ysgrifennodd J.A. Magallón:
> > ata1: PATA max UDMA/100 cmd 0x1F0 ctl 0x3F6 bmdma 0xF000 irq 14
> 
> Chip configuration reports OK
> > scsi0 : ata_piix
> > ata1.00: ATAPI, max UDMA/33
> > ata1.01: ATAPI, max MWDMA0, CDB intr
> > ata1.00: configured for PIO3
> > ata1.01: configured for PIO3
> 
> Your tree appears to have the old speed setting code in it not the new
> speed setting code. As a result of this it tries to set both to MWDMA0
> which isn't available on the ICH chips and so falls back to PIO3.
> 
Oops, sorry for the mix...
I was posting 2 separate bug reports, and mixed the relase numbers.
Where this really happens is on -rc1-mm2.
As you say, -rc1-mm2 gives:
ata_piix 0000:00:1f.1: version 2.00ac6
ACPI: PCI Interrupt 0000:00:1f.1[A] -> GSI 18 (level, low) -> IRQ 16
PCI: Setting latency timer of device 0000:00:1f.1 to 64
ata1: PATA max UDMA/100 cmd 0x1F0 ctl 0x3F6 bmdma 0xF000 irq 14
scsi0 : ata_piix
ata1.00: ATAPI, max UDMA/33
ata1.01: ATAPI, max MWDMA0, CDB intr
ata1.00: configured for PIO3
ata1.01: configured for PIO3
whereas -rc2-mm1 says:
ata_piix 0000:00:1f.1: version 2.00ac6
ACPI: PCI Interrupt 0000:00:1f.1[A] -> GSI 18 (level, low) -> IRQ 16
PCI: Setting latency timer of device 0000:00:1f.1 to 64
ata1: PATA max UDMA/100 cmd 0x1F0 ctl 0x3F6 bmdma 0xF000 irq 14
scsi0 : ata_piix
ata1.00: ATAPI, max UDMA/33 
ata1.01: ATAPI, max MWDMA0, CDB intr
ata1.00: configured for UDMA/33
ata1.01: configured for PIO3
So I see that rc2-mm1 should work. But my problem is the other bug report,
this latest kernel does not show the second ide channel on the host.
What file is the new speed selection code in ? libata-core.c, ata-piix.c ?
I can try to get the old kernel patched...
Or is there any patch available ?
I think i will have to unplug the zip drive till this is resolved ;).
TIA
--
J.A. Magallon <jamagallon()ono!com>     \               Software is like sex:
                                         \         It's better when it's free
Mandriva Linux release 2007.0 (Cooker) for i586
Linux 2.6.17-jam04 (gcc 4.1.1 20060724 (prerelease) (4.1.1-3mdk)) #1 SMP PREEMPT
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.kernel.org
More majordomo info at  
http://vger.kernel.org/majordomo-info.html
Please read the FAQ at  
http://www.tux.org/lkml/