Date: Mon, 05 Sep 2005 09:17:43 +0900
From: Kalin KOZHUHAROV <>
Subject: 2.6.11.11 and rsync oops (SATA related?)
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2005/9/4/219

Hi, there.
Long time no posting - didn't have kernel problems for long time :-)
That is why I am still running 2.6.11.11 (2.6.12 elsewhere). Will move
to 2.6.13 soon.
Yesterday just bought a new SATAII drive (Seagate Barracuda 7200.8
ST3300831AS) and while trying to rsync some data from the old drives the
rsync process died with segfault. My SiI3112 controller is not SATAII,
but it should work in SATA mode, have another drive for year+. Looking
at the dmesg I saw 3 oopses (see the shortened .dmesg file). Run the
ksymoops and got some output (see .ksymoops.bz2).
Although it does not seem very related to the drive, that is the only
recent change in hardware, in software: udev . The machine (MB: A7V8X
Deluxe) was working stable for 6 months with a few restarts.
As far as reproducibility goes, apart from those 3 oopses everything is
OK, didn't even have to restart and am now continuing to rsync some
200GB more.
Any ideas as to what caused this?
Kalin.
P.S. Attaching the files :-|
-- 
|[ ~~~~~~~~~~~~~~~~~~~~~~ ]|
+-> 
http://ThinRope.net/
 <-+
|[ ______________________ ]|
Linux version 2.6.11.11-dorf (root@poi) (gcc version 3.3.5 (Gentoo Linux 3.3.5-r1, ssp-3.3.2-3, pie-8.7.7.1)) #1 Sun May 29 01:39:53 JST 2005
Uniform Multi-Platform E-IDE driver Revision: 7.00alpha2
ide: Assuming 33MHz system bus speed for PIO modes; override with idebus=xx
NFORCE2: IDE controller at PCI slot 0000:00:09.0
NFORCE2: chipset revision 162
NFORCE2: not 100% native mode: will probe irqs later
NFORCE2: BIOS didn't set cable bits correctly. Enabling workaround.
NFORCE2: BIOS didn't set cable bits correctly. Enabling workaround.
NFORCE2: 0000:00:09.0 (rev a2) UDMA133 controller
    ide0: BM-DMA at 0xf000-0xf007, BIOS settings: hda:DMA, hdb:DMA
    ide1: BM-DMA at 0xf008-0xf00f, BIOS settings: hdc:DMA, hdd:DMA
Probing IDE interface ide0...
hda: WDC WD1000BB-00CAA0, ATA DISK drive
ide0 at 0x1f0-0x1f7,0x3f6 on irq 14
Probing IDE interface ide1...
hdc: WDC WD2000JB-00DUA0, ATA DISK drive
ide1 at 0x170-0x177,0x376 on irq 15
SiI3112 Serial ATA: IDE controller at PCI slot 0000:01:0b.0
SiI3112 Serial ATA: chipset revision 2
SiI3112 Serial ATA: 100% native mode on irq 18
    ide2: MMIO-DMA , BIOS settings: hde:pio, hdf:pio
    ide3: MMIO-DMA , BIOS settings: hdg:pio, hdh:pio
Probing IDE interface ide2...
hde: WDC WD360GD-00FLA0, ATA DISK drive
ide2 at 0xf8802080-0xf8802087,0xf880208a on irq 18
Probing IDE interface ide3...
hdg: ST3300831AS, ATA DISK drive
hdg: applying pessimistic Seagate errata fix
ide3 at 0xf88020c0-0xf88020c7,0xf88020ca on irq 18
Probing IDE interface ide4...
Probing IDE interface ide5...
hda: max request size: 128KiB
hda: 195371568 sectors (100030 MB) w/2048KiB Cache, CHS=65535/16/63, UDMA(100)
hda: cache flushes not supported
 hda: hda1 hda2 hda3 hda4 < hda5 hda6 >
hdc: max request size: 1024KiB
hdc: 390721968 sectors (200049 MB) w/8192KiB Cache, CHS=24321/255/63, UDMA(100)
hdc: cache flushes supported
 hdc: hdc1 hdc2 hdc3 < hdc5 hdc6 > hdc4
hde: max request size: 64KiB
hde: 72303840 sectors (37019 MB) w/8192KiB Cache, CHS=16383/255/63, UDMA(133)
hde: cache flushes supported
 hde: hde1 hde2
hdg: max request size: 7KiB
hdg: 586072368 sectors (300069 MB) w/8192KiB Cache, CHS=36481/255/63
hdg: cache flushes supported
 hdg: hdg1
RPC: error 5 connecting to server 127.0.0.1
RPC: error 5 connecting to server 127.0.0.1
Unable to handle kernel NULL pointer dereference at virtual address 00000108
 printing eip:
c013249b
*pde = 00000000
Oops: 0000 [#1]
PREEMPT 
Modules linked in: ipt_TCPMSS ipt_REJECT ipt_state iptable_filter iptable_mangle ppp_synctty ppp_async ppp_generic slhc w83l785ts asb100 i2c_sensor i2c_nforce2 i2c_core ext3 jbd mbcache ip_nat_ftp iptable_nat ip_tables ip_conntrack_ftp ip_conntrack forcedeth via_rhine mii ehci_hcd ohci_hcd usbcore ipv6
CPU:    0
EIP:    0060:[<c013249b>]    Not tainted VLI
EFLAGS: 00010213   (2.6.11.11-dorf) 
EIP is at page_waitqueue+0x1b/0x30
eax: 580da100   ebx: c10da100   ecx: 00000020   edx: 00000000
esi: 00000002   edi: 0000000e   ebp: c1b53f40   esp: c1b53d90
ds: 007b   es: 007b   ss: 0068
Process pdflush (pid: 193, threadinfo=c1b52000 task=c198a570)
Stack: c0132573 c10da100 c10da100 c01779bd c1106fa0 c1b53f40 c1b53dd4 00000000 
       0000000e f7c0e5b0 00000000 00000001 ffffffff c019ac60 00000000 00000000 
       f7c2068c 000020a6 00000000 00000000 00000000 0000000e 00000000 c10d6120 
Call Trace:
 [<c0132573>] unlock_page+0x23/0x40
 [<c01779bd>] mpage_writepages+0x21d/0x3e0
 [<c019ac60>] reiserfs_writepage+0x0/0x40
 [<c01389ad>] do_writepages+0x3d/0x50
 [<c0175c31>] __sync_single_inode+0x71/0x220
 [<c0175e47>] __writeback_single_inode+0x67/0x150
 [<c0131060>] handle_IRQ_event+0x30/0x70
 [<c0131194>] __do_IRQ+0xf4/0x160
 [<c01760c7>] sync_sb_inodes+0x197/0x2a0
 [<c01762a4>] writeback_inodes+0xd4/0xf0
 [<c0138663>] background_writeout+0x73/0xc0
 [<c013920a>] __pdflush+0xca/0x1c0
 [<c0139300>] pdflush+0x0/0x30
 [<c0139328>] pdflush+0x28/0x30
 [<c01385f0>] background_writeout+0x0/0xc0
 [<c0139300>] pdflush+0x0/0x30
 [<c012a825>] kthread+0xa5/0xb0
 [<c012a780>] kthread+0x0/0xb0
 [<c0100871>] kernel_thread_helper+0x5/0x14
Code: c4 18 c3 89 f0 e8 d6 9c 00 00 eb e9 8d 74 26 00 8b 44 24 04 b9 20 00 00 00 8b 10 69 c0 01 00 37 9e c1 ea 1d 8b 14 95 48 d0 47 c0 <2b> 8a 08 01 00 00 8b 92 00 01 00 00 d3 e8 8d 04 c2 c3 8d 76 00 
 <1>Unable to handle kernel NULL pointer dereference at virtual address 00000108
 printing eip:
c013249b
*pde = 00000000
Oops: 0000 [#2]
PREEMPT 
Modules linked in: ipt_TCPMSS ipt_REJECT ipt_state iptable_filter iptable_mangle ppp_synctty ppp_async ppp_generic slhc w83l785ts asb100 i2c_sensor i2c_nforce2 i2c_core ext3 jbd mbcache ip_nat_ftp iptable_nat ip_tables ip_conntrack_ftp ip_conntrack forcedeth via_rhine mii ehci_hcd ohci_hcd usbcore ipv6
CPU:    0
EIP:    0060:[<c013249b>]    Not tainted VLI
EFLAGS: 00010213   (2.6.11.11-dorf) 
EIP is at page_waitqueue+0x1b/0x30
eax: 1eeda120   ebx: c10da120   ecx: 00000020   edx: 00000000
esi: c1b66000   edi: c1b67eb4   ebp: c1b67f5c   esp: c1b67e10
ds: 007b   es: 007b   ss: 0068
Process kswapd0 (pid: 195, threadinfo=c1b66000 task=c1b38aa0)
Stack: c0132573 c10da120 c10da120 c013d637 c10da120 00000001 00000000 00000012 
       00000001 00000001 f18405a0 00000004 00000001 c1b67e44 c1b67e44 00000004 
       00000001 c1145de0 c10c7d40 c10dd7c0 c1105b20 c10cb820 c10e69e0 c1629e60 
Call Trace:
 [<c0132573>] unlock_page+0x23/0x40
 [<c013d637>] shrink_list+0x237/0x430
 [<c013df53>] refill_inactive_zone+0x3e3/0x510
 [<c013d992>] shrink_cache+0x162/0x340
 [<c013d10a>] shrink_slab+0x8a/0x190
 [<c013e132>] shrink_zone+0xb2/0xe0
 [<c013e5c4>] balance_pgdat+0x274/0x360
 [<c013e78e>] kswapd+0xde/0x100
 [<c012ad30>] autoremove_wake_function+0x0/0x60
 [<c0102612>] ret_from_fork+0x6/0x14
 [<c012ad30>] autoremove_wake_function+0x0/0x60
 [<c013e6b0>] kswapd+0x0/0x100
 [<c0100871>] kernel_thread_helper+0x5/0x14
Code: c4 18 c3 89 f0 e8 d6 9c 00 00 eb e9 8d 74 26 00 8b 44 24 04 b9 20 00 00 00 8b 10 69 c0 01 00 37 9e c1 ea 1d 8b 14 95 48 d0 47 c0 <2b> 8a 08 01 00 00 8b 92 00 01 00 00 d3 e8 8d 04 c2 c3 8d 76 00 
 <1>Unable to handle kernel paging request at virtual address ff8405b4
 printing eip:
c013d50f
*pde = 00002067
*pte = 00000000
Oops: 0000 [#3]
PREEMPT 
Modules linked in: ipt_TCPMSS ipt_REJECT ipt_state iptable_filter iptable_mangle ppp_synctty ppp_async ppp_generic slhc w83l785ts asb100 i2c_sensor i2c_nforce2 i2c_core ext3 jbd mbcache ip_nat_ftp iptable_nat ip_tables ip_conntrack_ftp ip_conntrack forcedeth via_rhine mii ehci_hcd ohci_hcd usbcore ipv6
CPU:    0
EIP:    0060:[<c013d50f>]    Not tainted VLI
EFLAGS: 00010286   (2.6.11.11-dorf) 
EIP is at shrink_list+0x10f/0x430
eax: 00000000   ebx: c10da100   ecx: 00000001   edx: ff8405a0
esi: f551e000   edi: f551fc5c   ebp: f551fcfc   esp: f551fbc8
ds: 007b   es: 007b   ss: 0068
Process rsync (pid: 8084, threadinfo=f551e000 task=f4521040)
Stack: c10da100 00000001 00000000 00000000 00000001 00000001 f18405a0 00000017 
       00000000 c1106fb8 c10d6138 00000009 00000001 c10a75c0 c1068800 c1094760 
       c109fe60 c10afec0 c106c8c0 c10b0040 c1076080 c10910c0 c107b2a0 c107ccc0 
Call Trace:
 [<c013d992>] shrink_cache+0x162/0x340
 [<c02aad70>] ide_dma_exec_cmd+0x30/0x40
 [<c02aadb6>] ide_dma_start+0x36/0x50
 [<c02acba9>] __ide_do_rw_disk+0x389/0x560
 [<c013e132>] shrink_zone+0xb2/0xe0
 [<c013e1c9>] shrink_caches+0x69/0x70
 [<c013e288>] try_to_free_pages+0xb8/0x180
 [<c013730e>] __alloc_pages+0x1ae/0x450
 [<c01398fb>] __do_page_cache_readahead+0x11b/0x160
 [<c01123c7>] try_to_wake_up+0xa7/0xc0
 [<c0139b1a>] blockable_page_cache_readahead+0x6a/0x80
 [<c0139c8d>] page_cache_readahead+0x15d/0x2c0
 [<c0133086>] do_generic_mapping_read+0x5a6/0x5c0
 [<c0133385>] __generic_file_aio_read+0x1f5/0x230
 [<c01330a0>] file_read_actor+0x0/0xf0
 [<c01334fd>] generic_file_read+0xbd/0xe0
 [<c012ad30>] autoremove_wake_function+0x0/0x60
 [<c012ad30>] autoremove_wake_function+0x0/0x60
 [<c0165f94>] sys_select+0x234/0x4d0
 [<c0133440>] generic_file_read+0x0/0xe0
 [<c0151c17>] vfs_read+0xd7/0x150
 [<c0151f21>] sys_read+0x51/0x80
 [<c010272f>] syscall_call+0x7/0xb
Code: 02 00 00 8b 03 a9 00 00 01 00 0f 85 94 02 00 00 8b 03 8b 53 10 c1 e8 10 83 e0 01 0f 85 10 03 00 00 f6 c2 01 0f 45 d0 85 d2 74 21 <8b> 42 14 31 c9 85 c0 75 08 8d 42 1c 39 42 1c 74 05 b9 01 00 00 
 
[unhandled content-type:application/octet-stream]