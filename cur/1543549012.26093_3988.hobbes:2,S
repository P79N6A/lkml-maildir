Date: Sun, 17 Sep 2000 23:18:53 +0200
From: Dag B <>
Subject: Re: Linux-2.4.0-test9-pre2 -> still CardBus problems
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2000/9/17/102

Linus Torvalds wrote:
> Ok. I think we're getting to the point where there are no major known
> bugs. That means that as of the final 2.4.0-test9 I will no longer accept
> any patches that don't have a critical problem (as defined by Teds list)
> associated with them. 
[snip]
> - PCI bridge scanning fix: assign numbers properly
[snip]
Don't know if this was intended to fix the CardBus problem on certain
DELL (others?) laptops. It doesn't work on mine, anyway. I do get a
slightly more informative error message though... And my CardBus is now
bus #6 and not #4 as it was with test8. If that makes a difference.
I have enbled some debugging in the output below. All pcmcia/cardbus
stuff is built as modules. Using the native kernel bits only. (It is no
better with the standalone package from David Hinds.) 
Linux version 2.4.0-test9 (root@dagblap) (gcc version 2.95.2 19991024
(release)) #4 Sun Sep 17 22:31:09 CE
ST 2000
BIOS-provided physical RAM map:
 BIOS-e820: 000000000009fc00 @ 0000000000000000 (usable)
 BIOS-e820: 0000000000000400 @ 000000000009fc00 (reserved)
 BIOS-e820: 000000000000c000 @ 00000000000c0000 (reserved)
 BIOS-e820: 0000000005ef0000 @ 0000000000100000 (usable)
 BIOS-e820: 0000000000010000 @ 0000000005ff0000 (ACPI data)
 BIOS-e820: 0000000000060000 @ 00000000100a0000 (reserved)
 BIOS-e820: 0000000000200000 @ 00000000ffe00000 (reserved)
On node 0 totalpages: 24560
zone(0): 4096 pages.
zone(1): 20464 pages.
zone(2): 0 pages.
Kernel command line: BOOT_IMAGE=test9p2d ro root=/dev/discs/disc0/part5
Initializing CPU#0
Detected 363965751 Hz processor.
Console: colour dummy device 80x25
Calibrating delay loop... 725.81 BogoMIPS
Memory: 94180k/98240k available (1497k kernel code, 3672k reserved, 104k
data, 196k init, 0k highmem)
Dentry-cache hash table entries: 16384 (order: 5, 131072 bytes)
Buffer-cache hash table entries: 4096 (order: 2, 16384 bytes)
Page-cache hash table entries: 32768 (order: 5, 131072 bytes)
Inode-cache hash table entries: 8192 (order: 4, 65536 bytes)
CPU: Intel Mobile Pentium II stepping 0a
Checking 'hlt' instruction... OK.
POSIX conformance testing by UNIFIX
mtrr: v1.36 (20000221) Richard Gooch (rgooch@atnf.csiro.au)
PCI: BIOS32 Service Directory structure at 0xc00ffe80
PCI: BIOS32 Service Directory entry at 0xffe90
PCI: BIOS probe returned s=00 hw=01 ver=02.10 l=01
PCI: PCI BIOS revision 2.10 entry at 0xfc0ee, last bus=1
PCI: Using configuration type 1
PCI: Probing PCI hardware
PCI: IDE base address fixup for 00:07.1
PCI: Scanning for ghost devices on bus 0
PCI: Scanning for ghost devices on bus 1
PCI: IRQ init
PCI: Interrupt Routing Table found at 0xc00fbda0
00:07 slot=00 0:00/0000 1:00/0000 2:00/0000 3:63/def8
01:00 slot=00 0:60/def8 1:61/def8 2:00/0000 3:00/0000
00:03 slot=00 0:63/def8 1:63/def8 2:00/0000 3:00/0000
00:0d slot=00 0:62/def8 1:00/0000 2:00/0000 3:00/0000
00:11 slot=00 0:62/def8 1:62/def8 2:62/def8 3:62/def8
PCI: Using IRQ router default [8086/1234] at 00:07.0
PCI: IRQ fixup
PCI: Allocating resources
PCI: Resource f4000000-f7ffffff (f=1208, d=0, p=0)
PCI: Resource 00000860-0000086f (f=101, d=0, p=0)
PCI: Resource 0000ece0-0000ecff (f=101, d=0, p=0)
PCI: Resource 0000ec80-0000ecbf (f=101, d=0, p=0)
PCI: Resource fb000000-fbffffff (f=1208, d=0, p=0)
PCI: Resource fdc00000-fdffffff (f=200, d=0, p=0)
PCI: Resource fdb00000-fdbfffff (f=200, d=0, p=0)
PCI: Resource fac00000-faffffff (f=1208, d=0, p=0)
PCI: Resource fda00000-fdafffff (f=200, d=0, p=0)
PCI: Sorting device list...
Limiting direct PCI/PCI transfers.
[snip]
# lsmod
Module                  Size  Used by
# modprobe yenta_socket
# lsmod
Module                  Size  Used by
yenta_socket            9836   2 
pcmcia_core            43840   0  [yenta_socket]
# dmesg
[snip]
Linux PCMCIA Card Services 3.1.20
  options:  [pci] [cardbus] [pm]
cs.c 1.267 2000/08/30 22:07:31 (David Hinds)
Yenta IRQ list 0098, PCI irq11
Socket status: 30000006
cs: pcmcia_register_socket(0xc6a7a280)
Yenta IRQ list 0098, PCI irq11
Socket status: 30000020
cs: pcmcia_register_socket(0xc6a7a280)
# modprobe ds
# dmesg
[snip]
ds.c 1.108 2000/08/07 19:06:15 (David Hinds)
cs: cb_alloc(bus 6): vendor 0x115d, device 0x0003
PCI: Failed to allocate resource 0 for PCI device 115d:0003
PCI: Failed to allocate resource 1 for PCI device 115d:0003
PCI: Failed to allocate resource 2 for PCI device 115d:0003
PCI: Failed to allocate resource 6 for PCI device 115d:0003
PCI: Device 06:00.0 not available because of resource collisions
PCI: Failed to allocate resource 0 for PCI device 115d:0103
PCI: Failed to allocate resource 1 for PCI device 115d:0103
PCI: Failed to allocate resource 2 for PCI device 115d:0103
PCI: Failed to allocate resource 6 for PCI device 115d:0103
PCI: Device 06:00.1 not available because of resource collisions
# lspci
00:00.0 Host bridge: Intel Corporation 440BX/ZX - 82443BX/ZX Host bridge
(rev 03)
00:01.0 PCI bridge: Intel Corporation 440BX/ZX - 82443BX/ZX AGP bridge
(rev 03)
00:03.0 CardBus bridge: Texas Instruments PCI1225 (rev 01)
00:03.1 CardBus bridge: Texas Instruments PCI1225 (rev 01)
00:07.0 Bridge: Intel Corporation 82371AB PIIX4 ISA (rev 02)
00:07.1 IDE interface: Intel Corporation 82371AB PIIX4 IDE (rev 01)
00:07.2 USB Controller: Intel Corporation 82371AB PIIX4 USB (rev 01)
00:07.3 Bridge: Intel Corporation 82371AB PIIX4 ACPI (rev 02)
00:0d.0 Ethernet controller: 3Com Corporation 3c905 100BaseTX [Boomerang]
01:00.0 VGA compatible controller: Neomagic Corporation [MagicMedia
256AV] (rev 20)
01:00.1 Multimedia audio controller: Neomagic Corporation [MagicMedia
256AV Audio] (rev 20)
06:00.0 Ethernet controller: Xircom Cardbus Ethernet 10/100 (rev 03)
06:00.1 VGA compatible controller: Xircom Cardbus Ethernet + 56k Modem
(rev 03)
# cat /proc/ioports 
0000-001f : dma1
0020-003f : pic1
0040-005f : timer
0060-006f : keyboard
0080-008f : dma page reg
00a0-00bf : pic2
00c0-00df : dma2
00f0-00ff : fpu
0170-0177 : ide1
01f0-01f7 : ide0
02e8-02ef : serial(auto)
0376-0376 : ide1
03c0-03df : vesafb
03f6-03f6 : ide0
03f8-03ff : serial(auto)
0800-083f : Intel Corporation 82371AB PIIX4 ACPI
0840-085f : Intel Corporation 82371AB PIIX4 ACPI
0860-086f : Intel Corporation 82371AB PIIX4 IDE
  0860-0867 : ide0
  0868-086f : ide1
0cf8-0cff : PCI conf1
1000-10ff : PCI CardBus #02
1400-14ff : PCI CardBus #02
1800-18ff : PCI CardBus #06
1c00-1cff : PCI CardBus #06
c000-cfff : PCI Bus #01
ec80-ecbf : 3Com Corporation 3c905 100BaseTX [Boomerang]
  ec80-ecbf : eth0
ece0-ecff : Intel Corporation 82371AB PIIX4 USB
# modprobe xircom_tulip_cb
PCI: Device 06:00.1 not available because of resource collisions
tulip_attach(06:00.0)
PCI: Device 06:00.0 not available because of resource collisions
tulip_attach(06:00.0)
PCI: Device 06:00.0 not available because of resource collisions
Anyone able to tell me what resource collisions we are talking about
here?
Dag B
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.kernel.org
Please read the FAQ at 
http://www.tux.org/lkml/