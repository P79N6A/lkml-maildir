Date: Tue, 11 Mar 2008 16:39:25 +0530
From: Balbir Singh <>
Subject: Re: [PATCH] Move memory controller allocations to their own slabs (v2)
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2008/3/11/149

Pavel Emelyanov wrote:
> Balbir Singh wrote:
>> Pavel Emelyanov wrote:
>>> Balbir Singh wrote:
>>>> Move the memory controller data structure page_cgroup to its own slab cache.
>>>> It saves space on the system, allocations are not necessarily pushed to order
>>>> of 2 and should provide performance benefits. Users who disable the memory
>>>> controller can also double check that the memory controller is not allocating
>>>> page_cgroup's.
>>> Can you, please, check how many objects-per-page we have with and 
>>> without this patch for SLAB and SLUB?
>>>
>>> Thanks.
>> I can for objects-per-page with this patch for SLUB and SLAB. I am not sure
>> about what to check for without this patch. The machine is temporarily busy,
> 
> Well, the objects-per-page without the patch is objects-per-page for
> according kmalloc cache :)
> 
OK, so here is the data
On my 64 bit powerpc system (structure size could be different on other systems)
1. sizeof page_cgroup is 40 bytes
   which means kmalloc will allocate 64 bytes
2. With 4K pagesize SLAB with HWCACHE_ALIGN, 59 objects are packed per slab
3. With SLUB the value is 102 per slab
-- 
	Warm Regards,
	Balbir Singh
	Linux Technology Center
	IBM, ISTL