Date: Sun, 10 Jun 2007 05:00:14 +0100
From: Al Viro <>
Subject: Re: [patch 7/8] fdmap v2 - implement sys_socket2
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2007/6/10/1

On Sat, Jun 09, 2007 at 08:48:39PM -0700, Linus Torvalds wrote:
> Agreed. That was actually part of the reason why I thought clone() was
> much better than the pthreads interface.
> 
> That said, the Linux !CLONE_FILES does have downsides:
> 
>  - it is potentially much slower to do than sharing everything (if you 
>    have lots of file descriptors, incrementing the refcounts etc is 
>    actually a real overhead)
Huh?  We _skip_ the overhead when descriptor table is not shared.  Think
for a minute - we can skip playing with refcount of fget() in the beginning
of syscall if and only if we know that nobody will touch the reference from
the descriptor table.  I.e. if descriptor table is not shared.  IOW, it's
the other way round - it's _faster_ to not share descriptors.
>  - it simply doesn't work, if the library wants to run in the same 
>    execution context, and just wants to open one (or more) file 
>    descriptors for some helper thing.
True, but...  That really depends on the potential uses.  Any real-world
examples (e.g. in related threads)?
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.kernel.org
More majordomo info at  
http://vger.kernel.org/majordomo-info.html
Please read the FAQ at  
http://www.tux.org/lkml/