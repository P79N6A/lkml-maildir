Date: 20 Oct 2002 00:36:39 -0700
From: "David S. Miller" <>
Subject: Re: [PATCH] 2.5.44: net/ipv4/ip_proc.c compile error fix for AX25 enabled
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2002/10/20/28

On Sat, 2002-10-19 at 23:48, Hans-Joachim Hetscher wrote:
> ip_proc.c does't compile for CONFIG_AX25.
> 
> Here the patch ...
This points out another problem, that it doesn't handle
CONFIG_AX25_MODULE either.
I've fixed all of this in my tree as follows:
# This is a BitKeeper generated patch for the following project:
# Project Name: Linux kernel tree
# This patch format is intended for GNU patch command version 2.5 or higher.
# This patch includes the following deltas:
#	           ChangeSet	1.812   -> 1.813  
#	  net/ipv4/ip_proc.c	1.10    -> 1.11   
#
# The following is the BitKeeper ChangeSet Log
# --------------------------------------------
# 02/10/20	davem@nuts.ninka.net	1.813
# net/ipv4/ip_proc.c: Include linux/ax25.h and handle modular AX25.
# --------------------------------------------
#
diff -Nru a/net/ipv4/ip_proc.c b/net/ipv4/ip_proc.c
--- a/net/ipv4/ip_proc.c	Sun Oct 20 00:20:53 2002
+++ b/net/ipv4/ip_proc.c	Sun Oct 20 00:20:53 2002
@@ -31,7 +31,9 @@
 extern int tcp_get_info(char *, char **, off_t, int);
 
 #ifdef CONFIG_PROC_FS
-#ifdef CONFIG_AX25
+#if defined(CONFIG_AX25) || defined(CONFIG_AX25_MODULE)
+
+#include <linux/ax25.h>
 
 /* ------------------------------------------------------------------------ */
 /*
@@ -64,7 +66,7 @@
 	return buf;
 
 }
-#endif /* CONFIG_AX25 */
+#endif /* CONFIG_AX25 || CONFIG_AX25_MODULE */
 
 struct arp_iter_state {
 	int is_pneigh, bucket;
@@ -196,7 +198,7 @@
 
 	read_lock(&n->lock);
 	/* Convert hardware address to XX:XX:XX:XX ... form. */
-#ifdef CONFIG_AX25
+#if defined(CONFIG_AX25) || defined(CONFIG_AX25_MODULE)
 	if (hatype == ARPHRD_AX25 || hatype == ARPHRD_NETROM)
 		ax2asc2((ax25_address *)n->ha, hbuffer);
 	else {
@@ -207,7 +209,7 @@
 		hbuffer[k++] = ':';
 	}
 	hbuffer[--k] = 0;
-#ifdef CONFIG_AX25
+#if defined(CONFIG_AX25) || defined(CONFIG_AX25_MODULE)
 	}
 #endif
 	sprintf(tbuf, "%u.%u.%u.%u", NIPQUAD(*(u32*)n->primary_key));
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.kernel.org
More majordomo info at  
http://vger.kernel.org/majordomo-info.html
Please read the FAQ at  
http://www.tux.org/lkml/