Date: Wed, 1 Sep 1999 16:17:07 -0400
From: "Theodore Y. Ts'o" <>
Subject: set_current_state
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/1999/9/1/133

Hi Linus,
When I checked the serial driver integration into 2.3.16, I noticed that
one of the changes was to change 
	current->state = TASK_INTERRUPTIBLE;
to
	set_current_state(TASK_INTERRUPTIBLE);
Looking at the sched.h header file, it's pretty clear that this is there
to protect against race conditions on SMP kernels.  Which makes me
wonder why you only changed that one line, but not all of the other
lines in the driver which set current->state.  Doing a quick grep over
drivers/char/*.c, I see a lot of drivers which still use "current->state
= ... " and some that use "set_current_state(...)"
Are there any circumstances where we should keep the old usage?  Or
should we change them all to use set_current_state()?  And if it's the
latter, would you like a patch which does a global replace of
"current->state = ..." to "set_current_state(...)", either in the serial
driver or in all files in drivers/char/*.c (where most of the old usage
seems to be concentrated).
Thanks!
						- Ted
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.rutgers.edu
Please read the FAQ at 
http://www.tux.org/lkml/