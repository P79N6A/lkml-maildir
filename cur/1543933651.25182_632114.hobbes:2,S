Date: Thu, 27 Dec 2007 14:18:58 -0800
From: David Brownell <>
Subject: Re: [PATCH] USB Kconfig: Reorganize USB Kconfig Menu
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2007/12/27/123

On Sunday 23 December 2007, Al Boldi wrote:
> 
> Reogranize USB Kconfig Menu, and move USB_GADGET out into the Device Driver
> Menu.  This helps the USB Kconfig Menu to be more logical/usable.
> 
> Cc: David Brownell <david-b@pacbell.net>
> Cc: Greg KH <greg@kroah.com>
> Cc: Andrew Morton <akpm@linux-foundation.org>
> Signed-off-by: Al Boldi <a1426z@gawab.com>
Along those lines, sure ... but this particular patch can't quite
be the answer.  For one thing, it rather critially needs the appended,
else it won't work on ARM.  (And quite a lot of the ARM platforms
need the gadget stack!!)
There are ISTR a few other platforms which, for reasons unknown to
me, don't source drivers/Kconfig but recreate portions of it on
their own ... that's not something that this patch should change.
Also, looking at this in xconfig shows some oddness.  That "core"
submenu holds stuff that would logically be part of the toplevel
menu for host side USB.  While that toplevel menu has the USS720
driver, which seems more like a "miscellany" thing...
The comment about SCSI shouldn't show when SCSI is defined; and
the comment aboue "SCSI disk support" belongs with the mass storage
menu, not at the top level.  The way that the mass storage menu
is presented also hides the fact that you can get fully functional
mass storage support without checking *any* of the drivers there,
since the core already handles standard devices.
That "ARCH_HAS_HCD" mess has IMO outlived its utility, and should
vanish.
- Dave
--- a/arch/arm/Kconfig	2007-12-27 14:01:31.000000000 -0800
+++ b/arch/arm/Kconfig	2007-12-27 14:01:43.000000000 -0800
@@ -1068,6 +1068,8 @@ source "drivers/hid/Kconfig"
 
 source "drivers/usb/Kconfig"
 
+source "drivers/usb/gadget/Kconfig"
+
 source "drivers/mmc/Kconfig"
 
 source "drivers/leds/Kconfig"