Date: Fri, 4 May 2007 15:49:38 -0400 (EDT)
From: "Robert P. J. Day" <>
Subject: [PATCH] MTD: Delete allegedly obsolete "bank_size" field of mtd_info.
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2007/5/4/457

Delete the allegedly obsolete "bank_size" member of struct mtd_info.
Signed-off-by: Robert P. J. Day <rpjday@mindspring.com>
---
  the only other references to the symbol "bank_size" in the entire
tree are here:
$ grep -rw bank_size *
drivers/net/e1000/e1000_hw.c:    int32_t  bank_size;
drivers/net/e1000/e1000_hw.c:        bank_size = ICH_FLASH_SECTOR_SIZE;
drivers/net/e1000/e1000_hw.c:        bank_size = ICH_FLASH_SEG_SIZE_4K;
drivers/net/e1000/e1000_hw.c:        bank_size = ICH_FLASH_SEG_SIZE_64K;
drivers/net/e1000/e1000_hw.c:            flash_linear_address = bank * bank_size + j * sub_sector_size;
and those don't look like they have anything to do with mtd_info.
  compile-tested under x86 with "make allyesconfig".
diff --git a/drivers/mtd/mtdpart.c b/drivers/mtd/mtdpart.c
index 1af9890..9c62368 100644
--- a/drivers/mtd/mtdpart.c
+++ b/drivers/mtd/mtdpart.c
@@ -347,7 +347,6 @@ int add_mtd_partitions(struct mtd_info *master,
 		slave->mtd.subpage_sft = master->subpage_sft;
 		slave->mtd.name = parts[i].name;
-		slave->mtd.bank_size = master->bank_size;
 		slave->mtd.owner = master->owner;
 		slave->mtd.read = part_read;
diff --git a/include/linux/mtd/mtd.h b/include/linux/mtd/mtd.h
index 45d482c..150f1b4 100644
--- a/include/linux/mtd/mtd.h
+++ b/include/linux/mtd/mtd.h
@@ -137,9 +137,6 @@ struct mtd_info {
 	int numeraseregions;
 	struct mtd_erase_region_info *eraseregions;
-	/* This really shouldn't be here. It can go away in 2.5 */
-	u_int32_t bank_size;
-
 	int (*erase) (struct mtd_info *mtd, struct erase_info *instr);
 	/* This stuff for eXecute-In-Place */
-- 
========================================================================
Robert P. J. Day
Linux Consulting, Training and Annoying Kernel Pedantry
Waterloo, Ontario, CANADA
http://fsdev.net/wiki/index.php?title=Main_Page
========================================================================
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.kernel.org
More majordomo info at  
http://vger.kernel.org/majordomo-info.html
Please read the FAQ at  
http://www.tux.org/lkml/