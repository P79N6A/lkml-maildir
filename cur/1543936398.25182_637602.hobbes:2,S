Date: Sat, 12 Jan 2008 00:56:20 +0100
From: Bartlomiej Zolnierkiewicz <>
Subject: Re: [PATCH 04/21] ide-floppy: cleanup and unify debugging macro calls
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2008/1/12/79

On Friday 11 January 2008, Borislav Petkov wrote:
> * some debug_log() calls were not using "ide-floppy: " prefix
> 
> * a few used printk levels different than KERN_INFO (KERN_NOTICE
>   and KERN_ERR, which is the default one if no level is given)
> 
> There should be no functional change resulting from this patch.
Hmm, but there are functional changes as noted above, I removed this line
from the patch description.
> Signed-off-by: Borislav Petkov <bbpetkov@yahoo.de>
> ---
with IDEFLOPPY_DEBUG_LOG set to 1:
drivers/ide/ide-floppy.c: In function ‘idefloppy_pc_intr’:
drivers/ide/ide-floppy.c:704: warning: too many arguments for format
drivers/ide/ide-floppy.c: In function ‘idefloppy_do_request’:
drivers/ide/ide-floppy.c:1126: error: ‘struct request’ has no member named ‘flags’
make[1]: *** [drivers/ide/ide-floppy.o] Error 1
make: *** [drivers/ide/ide-floppy.o] Error 2
which translate to:
[...]
>  		if ((stat & ERR_STAT) || test_bit(PC_DMA_ERROR, &pc->flags)) {
>  			/* Error detected */
> -			debug_log(KERN_INFO "ide-floppy: %s: I/O error\n",
> -				drive->name);
> +			debug_log("I/O error\n", drive->name);
"%s: I/O error\n"
[...]
> -	debug_log(KERN_INFO "dev: %s, flags: %lx, errors: %d\n",
> +	debug_log("dev: %s, flags: %lx, errors: %d\n",
>  			rq->rq_disk ? rq->rq_disk->disk_name : "?",
>  			rq->flags, rq->errors);
This was broken before this patch by rq->flags -> rq->cmd_type change
(so your patch is not to blame for breaking IDEFLOPPY_DEBUG_LOG ;).
I fixed the above issues while merging the patch.
--
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.kernel.org
More majordomo info at  
http://vger.kernel.org/majordomo-info.html
Please read the FAQ at  
http://www.tux.org/lkml/