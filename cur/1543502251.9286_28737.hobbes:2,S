Date: Fri, 9 Jul 1999 10:56:34 +0200
From: Pavel Machek <>
Subject: Re: Loop Devices over NFS don't work?
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/1999/7/9/42

Hi!
> > > You could fall back to read/write in theory. There is an interesting project
> > > for you 8)
> > 
> > Really? Think about deadlocks. Both nbd and loop are _evil_. Mount
> > sparse file over loopback, then write to both filessytems in heavy way
> > to see why. THIS IS NOT EASY.
> 
> Time to embarrass myself once more on l-k ;) Intuition tells me that deadlocks
> and races need to be thought about, but unfortunately I can't see what they
> are.
> 
> How is writing to a filesystem on the loopbacked device simultaneously with
> the hosting filesystem any different from writing to two files on the hosted
> filesystem simultaneously?
Because for writing _datablock_ on loopfs you need to write
_indirectblock_ on hosting filesystem. Something that could not have
happened before. And now imagine writing _indirectblock_ on loop,
which results into write of _indirectblock_ on hosting fs. I am not
telling you I understand those issues. I just see it is not easy.
> Swapping, of course, is a different issue. Do we have any flags at the moment
> which prevent people from trying to swap to inappropriate block devices (nbd,
> certain raid levels with md, etc.)?
No and I'd like to see such patch.
								Pavel
-- 
I'm really pavel@ucw.cz. Look at 
http://195.113.31.123/~pavel.
  Pavel
Hi! I'm a .signature virus! Copy me into your ~/.signature, please!
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.rutgers.edu
Please read the FAQ at 
http://www.tux.org/lkml/