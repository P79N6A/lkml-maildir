Date: Sat, 23 Feb 2008 20:30:31 +0100
From: Gabriel C <>
Subject: Re: modular intel-agp does not work on my box
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2008/2/23/298

Dave Jones wrote:
> On Sat, Feb 23, 2008 at 12:03:55AM -0800, Andrew Morton wrote:
> 
>  > >  > You are right without EDAC built , agp modular does work fine. I'm on 2.6.25-rc2-00477-g1a4c6be right now.
>  > >  > So it is an EDAC bug ?
>  > > 
>  > > No, it's a failing of the pci driver model. It currently doesn't
>  > > allow more than one driver to be bound to a single PCI device.
>  > > For multi-function devices like bridges, this means we see problems
>  > > like the one you mention.
>  > 
>  > Well that sounds pretty bad.  What will distros do about this?
> 
> either
> *  ship both modular, and let the user decide which one he wants.
If you do so you have to blacklist one by default because udev will magically load both.
> *  build just one of them (typically agp)
> *  build them both, and let the above bug happen
Well the bug was not with both build into the kernel. 
CONFIG_EDAC=Y CONFIG_EDAC_<something>=m, CONFIG_AGP=m CONFIG_AGP_INTEL=m breaks agp already.
> *  build agp into the kernel, and edac modular, breaking edac
>    for a minority.
What does happen if one builds both into the kernel ? ( eg: all the *_AGP* Y , and all the *_EDAC* y ) 
Guessing no one of them will work ?
> 
>  > Is there something short-term-and-sleazy we can do to "fix" it?
> 
> not that I'm aware of.  I think Greg has been working on a long-term fix.
> 
> 	Dave
> 
Gabriel