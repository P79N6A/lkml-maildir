Date: Fri, 30 Sep 2005 18:16:11 +0400
From: Alexey Dobriyan <>
Subject: Fwd: [PATCH] cpufreq: honor cpu_sibling_map in speedstep-centrino.c
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2005/9/30/93

To: kernel-janitors@lists.osdl.org
speedstep-centrino.c should honor cpu_sibling_map for the sake of
recent Intel processors, which support both Centrino-style Enhanced
SpeedStep and hyperthreading; even newer dual-core chips may need the
same fix.
--- linux-source-2.6.13.2/arch/i386/kernel/cpu/cpufreq/speedstep-centrino.c~	2005-08-28 19:41:01.000000000 -0400
+++ linux-source-2.6.13.2/arch/i386/kernel/cpu/cpufreq/speedstep-centrino.c	2005-09-28 17:23:37.000000000 -0400
@@ -498,6 +498,10 @@
 	if (cpu->x86_vendor != X86_VENDOR_INTEL || !cpu_has(cpu, X86_FEATURE_EST))
 		return -ENODEV;
 
+#ifdef CONFIG_SMP
+	policy->cpus = cpu_sibling_map[policy->cpu];
+#endif
+
 	for (i = 0; i < N_IDS; i++)
 		if (centrino_verify_cpu_id(cpu, &cpu_ids[i]))
 			break;
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.kernel.org
More majordomo info at  
http://vger.kernel.org/majordomo-info.html
Please read the FAQ at  
http://www.tux.org/lkml/