Date: Tue, 17 Feb 2004 19:26:15 +0100
From: Adrian Bunk <>
Subject: [patch] 2.6.3-rc3-mm1: fix Pentium M patch
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2004/2/17/142

On Mon, Feb 16, 2004 at 01:58:23AM -0800, Andrew Morton wrote:
>...
> - Dropped the x86 CPU-type selection patches
>...
> Changes since 2.6.3-rc2-mm1:
>...
> -better-i386-cpu-selection.patch
> -cpu-options-default-to-y.patch
> -i386-default-to-n.patch
> 
>  Dropped
>...
This patch wasn't accepted when I sent the first versions against 2.5, 
and now it's too late for 2.6...
Well, that's life. I understand your reasons and I'll resubmit it for 
2.7 .
Removing the cpu selection patch uncovers a bug in my Pentium M I 
already wanted to get a brown paperbag for.
Besides this, it seems a small part of the cpu selection patch was 
actually in pentium-m-support.
The patch below resolves these two issues.
Please apply
Adrian
--- linux-2.6.3-rc3-mm1/arch/i386/Kconfig.old	2004-02-17 19:22:53.000000000 +0100
+++ linux-2.6.3-rc3-mm1/arch/i386/Kconfig	2004-02-17 19:23:28.000000000 +0100
@@ -348,8 +348,8 @@
 	int
 	default "7" if MPENTIUM4 || X86_GENERIC
 	default "4" if X86_ELAN || M486 || M386
-	default "5" if MWINCHIP3D || MWINCHIP2 || MWINCHIPC6 || MCRUSOE || MCYRIXIII || MK6 || MPENTIUMM || MPENTIUMIII || MPENTIUMII || M686 || M586MMX || M586TSC || M586 || MVIAC3_2
-	default "6" if MK7 || MK8
+	default "5" if MWINCHIP3D || MWINCHIP2 || MWINCHIPC6 || MCRUSOE || MCYRIXIII || MK6 || MPENTIUMIII || MPENTIUMII || M686 || M586MMX || M586TSC || M586 || MVIAC3_2
+	default "6" if MK7 || MK8 || MPENTIUMM
 
 config RWSEM_GENERIC_SPINLOCK
 	bool
--- linux-2.6.3-rc3-mm1/include/asm-i386/module.h.old	2004-02-17 19:24:18.000000000 +0100
+++ linux-2.6.3-rc3-mm1/include/asm-i386/module.h	2004-02-17 19:24:42.000000000 +0100
@@ -51,7 +51,7 @@
 #elif defined CONFIG_MVIAC3_2
 #define MODULE_PROC_FAMILY "VIAC3-2 "
 #else
-#define MODULE_PROC_FAMILY "this needs to be fixed"
+#error unknown processor family
 #endif
 
 #ifdef CONFIG_REGPARM
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.kernel.org
More majordomo info at  
http://vger.kernel.org/majordomo-info.html
Please read the FAQ at  
http://www.tux.org/lkml/