Date: Thu, 19 Aug 2004 09:16:51 +0200
From: Eric Valette <>
Subject: Re: 2.6.8.1-mm1 and Asus L3C : problematic change found, can be reverted. Real fix still missing
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2004/8/19/21

Karol Kozimor wrote:
> Okay, so I think I've finally got what's happening here.
> Enabling the SMBus device (00:1f.3) seems to mess up the resource
> reservation code, specifically the 0xe800 port region. Here's the diff
> between 2.6.8.1-mm1 acpi=off and the same kernel with no arguments:
Hi Karol,
This is the same problem on every asus motherboard including very old 
ones like my A7V : the ACPI pre-allocates the ioport region for the SMB 
bus because the DTSD contain indication to do so and special care should 
be used in order to reuse the IO port range already owned by ACPI 
(motherboard).
See :
<
http://lkml.org/lkml/2004/8/3/160>
And especially the end of /proc/oprots current one (before ACPI fix, I 
was forced to avoid/not fail ioport reservation for SMB in i2c-viapro.c)
e800-e80f : 0000:00:04.4	<===============
    e800-e80f : motherboard
But with the shaohua li proposed fix for 
<
http://bugme.osdl.org/show_bug.cgi?id=3049>,
 i2c-viapro.c becomes owner 
of part of this ioport range:
e800-e80f : 0000:00:04.4
   e800-e80f : motherboard
     e800-e807 : viapro-smbus    <========
So in other words, it is possible either to force reallocation of an 
ioport range already owned by ACPI now (at least in some configuration) 
or to avoid this io port allocation has it is already mapped like my 
proposed kludge to make A7V work...
However :
	1) I have no clue however of the correct way to do this,
	2) I do not know if the fix for 
<
http://bugme.osdl.org/show_bug.cgi?id=3049>
 is also valid for this ASUS 
motherboard/laptop,
	3) I still would like to know what you want to do with the SMB bus...
-- eric
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.kernel.org
More majordomo info at  
http://vger.kernel.org/majordomo-info.html
Please read the FAQ at  
http://www.tux.org/lkml/