Date: Wed, 07 Jan 2004 16:41:38 -0500
From: Trond Myklebust <>
Subject: Re: 2.6.1-rc1-tiny2
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2004/1/7/249

PÃ¥ on , 07/01/2004 klokka 15:10, skreiv Matt Mackall:
> NFS is a good example of why the guarantees of mempool are being
> overstated - it still needs to allocate SKBs to make progress and
> preallocating a pool for other data structures can make that fail
> where it otherwise might not. The pool size for NFS (32) is also
> completely arbitrary as far as I can tell.
If you are in a hardware situation where you actually care about the
permanent size of that mempool, then you're barking up entirely the
wrong tree: there is a hell of a lot more memory to reclaim from not
having to build up all those nfs_page lists in the first place.
i.e. Rip out the entire asynchronous NFS read/write support, not just
the mempools.
As for the usefulness of the mempools in the situation where you have
asynchronous I/O: I agree that the socket layer screws any chance of a
guarantee. So does the server if it goes down, the network itself can
screw you,.... All in all, it is surprising how few guarantees NFS
offers you.
I therefore see the mempools as more of an optimization that mainly
avoid sleeping under a certain limited set of "reasonable"
circumstances.
Cheers,
  Trond
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.kernel.org
More majordomo info at  
http://vger.kernel.org/majordomo-info.html
Please read the FAQ at  
http://www.tux.org/lkml/