Date: Fri, 03 Mar 2006 19:45:50 -0500
From: "Jun'ichi Nomura" <>
Subject: [PATCH 0/6] dm/md sysfs dependency tree (rev.3)
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2006/3/3/281

Hello,
This is an updated version of dm/md sysfs dependency tree patch set.
For example, if dm-0 maps to sda, we'll have following symlinks;
   /sys/block/dm-0/slaves/sda --> /sys/block/sda
   /sys/block/sda/holders/dm-0 --> /sys/block/dm-0
Thanks for Alasdair, Neil and Greg for reviews and comments.
I think the patches get much better shape than before.
I'm happy to hear any other comments for these patches.
Patches included are:
  1. [PATCH 1/6] kobject_add_dir
     Adding kobject_add_dir() function which creates
     a subdirectory for a given kobject.
  2. [PATCH 2/6] add holders/slaves subdirectory to /sys/block
     Creating "slaves" and "holders" directories in /sys/block/<disk>,
     creating "holders" directory under /sys/block/<disk>/<partition>
  3. [PATCH 3/6] bd_claim_by_kobject
     Adding bd_claim_by_kobject() function which takes kobject as
     additional signature of holder device and creates sysfs symlinks
     between holder device and claimed device.
     bd_release_from_kobject() is a counter part of bd_claim_by_kobject.
  4. [PATCH 4/6] bd_claim_by_disk
     Variants which take gendisk instead of kobject
     and do kobject_{get,put}(&gendisk->kobj).
  5. [PATCH 5/6] md to use bd_claim_by_disk
     Use bd_claim_by_disk.
  6. [PATCH 6/6] dm to use bd_claim_by_disk
     Use bd_claim_by_disk.
Patches from 1 to 5 work both on 2.6.16-rc5 and 2.6.16-rc5-mm2.
I hope them to be included in mm if there's no problem.
Patch 6 depends on dm-table-store-md.patch in
http://www.kernel.org/pub/linux/kernel/people/agk/patches/2.6/editing/.
The dm-table-store-md.patch might theoretically require some
locking/release-ordering fixes in dm core which is under
investigation though it's separate issue.
Thanks,
-- 
Jun'ichi Nomura, NEC Solutions (America), Inc.
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.kernel.org
More majordomo info at  
http://vger.kernel.org/majordomo-info.html
Please read the FAQ at  
http://www.tux.org/lkml/