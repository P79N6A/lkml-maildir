Date: Thu, 26 Jul 2007 18:11:32 +0100 (BST)
From: Hugh Dickins <>
Subject: Re: [patch] mm: reduce pagetable-freeing latencies
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2007/7/26/285

On Wed, 25 Jul 2007, Benjamin Herrenschmidt wrote:
> 
> In fact, i discussed with peter and I think the best is to only have one
> entry in the stack mmu_gather structure.
Four or eight would be much nicer than one, but you're right there's
a stackdepth worry: good spotting of those unmap_mapping_range cases,
I'd certainly been thinking we were fairly near the top of the stack
in unmap_vmas, which is not so (or not obviously so) in those cases.
> If we fail to allocate a page
> to batch entries, we flush that one and steal it :-) Then we have a page
> to gather more.
That will often be the case for anonymous pages, but not for pagecache
pages.  I had wondered whether to make exit_mmap unmap the stack first
(rather than text first as usually happens), but seems rather a hack.
Hugh
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.kernel.org
More majordomo info at  
http://vger.kernel.org/majordomo-info.html
Please read the FAQ at  
http://www.tux.org/lkml/