Date: Thu, 21 Jan 1999 12:13:10 -0500
From: Greg Wooledge <ic5035%>
Subject: Re: help: PS/2 hard drive not found
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/1999/1/21/235

On Tue, Jan 19, 1999 at 09:24:24PM -0600, Dave Weis wrote:
> > I found something called QBMCA and ran that on one of the machines.  It
> > reports 8 MCA slots (which doesn't sound right -- this is an awfully
> > small case), with a token ring card in slot 2.  The Linux kernel sees
> 
> What are the other POS id's?
They're all marked as empty, or unoccupied, or whatever terminology
was used.
On Wed, Jan 20, 1999 at 10:09:34AM +0100, David Weinehall wrote:
> This is a SCSI-machine. The ibmmca.c SCSI-driver is at the moment
> non-working with the v2.1 kernels newer than v2.1.31 (!). Install the
> driver from v2.1.30, and everything should work. You might have to tweak
> it to detect the adapter, though. It should use 0x3540 as base-address.
The 2.2.0-pre9 kernel does see a SCSI adapter here, but it panics:
IBM MCA SCSI: integrated SCSI found, io=0x3540, scsi id=7.
IBM MCA SCSI: Removing current logical SCSI-device mapping.
IBM MCA SCSI: Probing SCSI-devices.<0>Kernel panic: IBM MCA SCSI: command error.  Last SCSI_CMD=0x0.
In interrupt handler - not syncing
The 2.1.30 ibmmca.[ch] files won't work with 2.2.0-pre9.  There are
changes to the SCSI code which are beyond my ability to reconcile.
I've tried building kernel 2.1.30, but it does not compile.  So I tried
2.1.31, and *that* doesn't compile, either.  And neither does 2.1.32!
I get this:
gcc -D__KERNEL__ -I/usr/src/linux/include -D__ASSEMBLY__ -D__SMP__ -traditional -c locks.S -o locks.o
/tmp/cca07070: Assembler messages:
/tmp/cca07070:66: Error: operands given don't match any known 386 instruction
/tmp/cca07070:69: Error: operands given don't match any known 386 instruction
Of course, there are far less than 66 lines in locks.S....
This is with gcc 2.7.2.3, and binutils 2.9.1 (with BFD 2.9.1.0.15).
Naturally this occurs right near the end of the build, so it takes quite
some time to learn that I've just wasted a whole lot of time.
What kernel version should I try to use?  Should I downgrade binutils
to something ancient?  All I want is a relatively stable desktop
system, which can see the (216 MB IBM MCA) SCSI hard drive and the
(IBM) token ring card.  I'm not afraid to mix-and-match files between
different kernel versions, but randomly trying different combinations
is going to take *way* too long.
> Oh, there is one. It's called rf955657.exe and expands to a disk from dos.
> You can get it at ftp.pc.ibm.com in the directory pub/pccbbs/refdisks.
> There's also a rd955657.exe file which is the advanced diagnostics for
> that model.
Ah.  The documentation says that that one's for the "9556/9557", not the
Model 56, so I didn't recognize that it was what I wanted.  I used that
to verify that this PS/2 does indeed have a SCSI adapter and a SCSI disk.
On Wed, Jan 20, 1999 at 12:02:38PM +0000, Shaw Carruthers wrote:
> Model 56 has SCSI drives and mcascsi in 2.2.0-pre should work just fine.
The ibmmca.c driver does not work (see above).
On Wed, Jan 20, 1999 at 08:58:45AM -0600, Charles Cazabon wrote:
> > I'm trying to install Linux on a PS/2 (Model 56 486SLC2).  Actually
> 
> Virtually identical to the model 55, and before that, 50.  Up-down toggle
> switch for power at the front right hand corner of the case?
No, this has a push-button on the front panel.
> Any MCA SCSI card should work if you really want SCSI.  Used MCA hardware can
> normally be had quite cheaply.
I have no budget for this, and no knowledge of where to find used MCA
hardware.  I'm just absolutely sick of Windows 3.1.  I've been able to
use Linux at every place I've worked before, except here (so far).  The
PS/2 machines I have available already have the MCA SCSI cards in them.
I'm trying to avoid buying any hardware unless I have to.  This is both
because it will come out of my own pocket, and because making dramatic
hardware changes to any of the PCs here could be seen as a territorial
violation.  Not only am I in the Unix support group, rather than the
desktop support group, but I'm also a contractor, not an employee.
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.rutgers.edu
Please read the FAQ at 
http://www.tux.org/lkml/