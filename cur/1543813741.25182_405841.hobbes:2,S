Date: Sun, 12 Mar 2006 22:48:20 +0000
From: Alasdair G Kergon <>
Subject: [PATCH 4/7] dm: store md name
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2006/3/12/158

From: Mike Anderson <andmike@us.ibm.com>
The patch stores a printable device number in struct mapped_device 
for use in warning messages and with a proposed netlink interface.
Signed-off-by: Mike Anderson <andmike@us.ibm.com>
Signed-Off-By: Alasdair G Kergon <agk@redhat.com>
Index: linux-2.6.16-rc5/drivers/md/dm.c
===================================================================
--- linux-2.6.16-rc5.orig/drivers/md/dm.c	2006-03-12 18:08:57.000000000 +0000
+++ linux-2.6.16-rc5/drivers/md/dm.c	2006-03-12 18:14:57.000000000 +0000
@@ -68,6 +68,7 @@ struct mapped_device {
 
 	request_queue_t *queue;
 	struct gendisk *disk;
+	char name[16];
 
 	void *interface_ptr;
 
@@ -828,6 +829,7 @@ static struct mapped_device *alloc_dev(u
 	md->disk->private_data = md;
 	sprintf(md->disk->disk_name, "dm-%d", minor);
 	add_disk(md->disk);
+	format_dev_t(md->name, MKDEV(_major, minor));
 
 	atomic_set(&md->pending, 0);
 	init_waitqueue_head(&md->wait);
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.kernel.org
More majordomo info at  
http://vger.kernel.org/majordomo-info.html
Please read the FAQ at  
http://www.tux.org/lkml/