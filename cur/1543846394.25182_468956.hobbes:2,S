Date: Tue, 3 Oct 2006 12:43:16 +0200
From: Ingo Molnar <>
Subject: Re: [PATCH 3/3] IRQ: Maintain regs pointer globally rather than passing to IRQ handlers
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2006/10/3/77

* Andrew Morton <akpm@osdl.org> wrote:
> > I don't personally mind the patch, I just wanted to bring that issue 
> > up.
> 
> yup.  Perhaps we could add
> 
> #define IRQ_HANDLERS_DONT_USE_PTREGS
> 
> so that out-of-tree drivers can reliably do their ifdefing.
i'd suggest we do something like:
 #define __PT_REGS
so that backportable drivers can do:
  static irqreturn_t irq_handler(int irq, void *dev_id __PT_REGS)
instead of an #ifdef jungle. Older kernel bases can define __PT_REGS in 
their interrupt.h (or in the backported driver's header, in one place)
 #ifndef __PT_REGS
 # define __PT_REGS , struct pt_regs *regs
 #endif
this would minimize the direct impact in the source-code.
	Ingo
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.kernel.org
More majordomo info at  
http://vger.kernel.org/majordomo-info.html
Please read the FAQ at  
http://www.tux.org/lkml/