Date: Sat, 22 Dec 2007 08:31:30 +1100
From: Benjamin Herrenschmidt <>
Subject: Re: [RFC] dma: passing "attributes" to dma_map_* routines
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2007/12/21/223

On Fri, 2007-12-21 at 10:00 -0800, akepner@sgi.com wrote:
> On Fri, Dec 21, 2007 at 07:56:25AM +1100, Benjamin Herrenschmidt wrote:
> > ...
> > Can't you just have a primitive to sync things up that you call
> > explicitely from your driver after fetching a new status entry ?
> > 
> 
> Well, the only mechanisms I know to get things synced are the ones 
> I mentioned before: 1) generate an interrupt, 2) write to memory 
> which has the "barrier" attribute. Obviously 1 is out - giving  
> the memory used for status indications the barrier attribute is 
> the most primitive means I'm aware of.
Well, I'm not totally against turning "direction" into a flag mask, as I
do have requests to do something similar on some PowerPC's in fact in
order to control the ordering guarantees of a given DMA mapping (ie.
relaxed vs. fully ordered).
I'm just worried that we'll end up with as many semantics for those
flags as we have host bridges & archs around, which would be bad.
Ben.