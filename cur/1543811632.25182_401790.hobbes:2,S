Date: Tue, 28 Feb 2006 09:42:09 +1100
From: Neil Brown <>
Subject: Re: Linux v2.6.16-rc5
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2006/2/27/354

On Monday February 27, axboe@suse.de wrote:
> On Mon, Feb 27 2006, Dave Jones wrote:
> > On Sun, Feb 26, 2006 at 09:27:28PM -0800, Linus Torvalds wrote:
> > 
> >  > Have I missed anything? Holler. And please keep reminding about any 
> >  > regressions since 2.6.15.
> > 
> > We seem to have a nasty bio slab leak.
> > 
https://bugzilla.redhat.com/bugzilla/show_bug.cgi?id=183017
> > 
https://bugzilla.redhat.com/bugzilla/show_bug.cgi?id=182970
> > 
> > Two seperate reports, both using raid1, sata_via and firewire
> > Curiously, they're both on x86-64 too.
> > 
> > Will keep an eye open for other reports of this as they come in.
> > 
> > (The kernels they mention in those reports are fairly recent.
> >  2.6.15-1.1977_FC5 is ctually based on 2.6.16rc4-git6)
> 
> This smells very much like a raid1 bio leak, I thought Neil had
> diagnosed and fixed that already though - Neil?
It certainly does smell like a raid1 bio leak, and we have had those
before, but I've looked over the relevant code several time and cannot
find one.  And my test machine doesn't show a leak.
There are some different code paths depending on whether the
underlying devices support BIO_RW_BARRIER or not, so my testing isn't
conclusive - I think my devices do support BIO_RW_BARRIER so it could
just happen where BIO_RW_BARRIER isn't supported .... but the code
still looks good.
There are new code paths to handle auto-correcting read errors, and
they probably haven't been exercises as much as I would like (some,
but not lots and lots) so maybe there is an issue there, but nobody is
reporting disk errors along with the bio leak, and given the size of
the leak, it would need to be lots of errors.
I think we need to narrow down where the problem was introduced.  The
current:
  2.6.14.7  works,
  2.6.16-rc4  doesn't
is too broad.
NeilBrown
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.kernel.org
More majordomo info at  
http://vger.kernel.org/majordomo-info.html
Please read the FAQ at  
http://www.tux.org/lkml/