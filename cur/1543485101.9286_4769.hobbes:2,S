Date: Tue, 9 Feb 1999 10:39:56 +0000
From: Philipp Rumpf <>
Subject: Unknown interrupt code
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/1999/2/9/9

This one would work better IMO.
diff -ur /linux/arch/i386/kernel/irq.c linux/arch/i386/kernel/irq.c
--- /linux/arch/i386/kernel/irq.c	Thu Jan 21 11:50:43 1999
+++ linux/arch/i386/kernel/irq.c	Tue Feb  9 10:35:59 1999
@@ -993,13 +993,11 @@
 
 __asm__("\n" __ALIGN_STR"\n"
 	"common_unexpected:\n\t"
-	SAVE_ALL
-	"pushl $ret_from_intr\n\t"
-	"jmp strange_interrupt");
+	"call strange_interrupt");
 
 void strange_interrupt(int irqnum)
 {
-	printk("Unexpected interrupt %d\n", irqnum & 255);
+	printk("Unexpected interrupt %d\n", irqnum);
 	for (;;);
 }
 
@@ -1013,7 +1011,7 @@
 
 		jumpto -= (unsigned long)(code+10);
 		code[0] = 0x68;		/* pushl */
-		*(int *)(code+1) = i - 512;
+		*(int *)(code+1) = i;
 		code[5] = 0xe9;		/* jmp */
 		*(int *)(code+6) = jumpto;
 
Only in linux/arch/i386/kernel: irq.c~