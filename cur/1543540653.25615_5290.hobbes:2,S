Date: Thu, 3 Aug 2000 12:09:43 +0200
From: Frank van Maarseveen <>
Subject: 2.2.14+autofs-2.2.14-20000123.diff: Oops
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2000/8/3/18

After seeing tons of ghost entries in an autofs4  mount pount I
stopped the automounter and restarted it again. The first Oops
was triggered then. After noticing that it didn't work I stopped
autofs again and (after still seeing a mount) umounted by hand.
That caused the second Oops. The reboot hanged, had to power cycle.
This all reminds me of a little patch posted by Kurt Garloff
some time ago on l-k which fixed a race in namei.c. but has not
yet been approved of AFAIK.
===Oops 1===
WARNING: This version of ksymoops is obsolete.
WARNING: The current version can be obtained from 
ftp://ftp.ocs.com.au/pub/ksymoops
Options used: -V (default)
              -o /lib/modules/2.2.14-x6/ (default)
              -k /proc/ksyms (default)
              -l /proc/modules (default)
              -m /boot/System.map-2.2.14-x6 (specified)
              -c 1 (default)
No modules in ksyms, skipping objects
Aug  3 11:20:49 tornio kernel: Unable to handle kernel NULL pointer dereference at virtual address 00000008 
Aug  3 11:20:49 tornio kernel: current->tss.cr3 = 0344c000, %cr3 = 0344c000 
Aug  3 11:20:49 tornio kernel: *pde = 00000000 
Aug  3 11:20:49 tornio kernel: Oops: 0000 
Aug  3 11:20:49 tornio kernel: CPU:    0 
Aug  3 11:20:49 tornio kernel: EIP:    0010:[kmem_cache_free+64/372] 
Aug  3 11:20:49 tornio kernel: EFLAGS: 00010082 
Aug  3 11:20:49 tornio kernel: eax: 0000007c   ebx: c3a2dba0   ecx: 00000000   edx: c3a2dc1c 
Aug  3 11:20:49 tornio kernel: esi: c3eff620   edi: 00000286   ebp: c32cf210   esp: c341ff2c 
Aug  3 11:20:49 tornio kernel: ds: 0018   es: 0018   ss: 0018 
Aug  3 11:20:49 tornio kernel: Process automount (pid: 25646, process nr: 37, stackpage=c341f000) 
Aug  3 11:20:49 tornio kernel: Stack: c36e1800 c32cf210 c3a2dc1c c3a2dc20 c012f22b c3eff620 c3a2dba0 c3a2dba0  
Aug  3 11:20:49 tornio kernel:        c3a2dc20 c012f53c c3a2dba0 00000000 c16fb9e0 c16fb9e0 c017b848 c36e1800  
Aug  3 11:20:49 tornio kernel:        c16fba04 00000001 c16fb9e0 00000000 c017b6ea c16fb9e0 c29d2540 ffffffe7  
Aug  3 11:20:49 tornio kernel: Call Trace: [dput+223/328] [shrink_dcache_sb+284/296] [autofs_catatonic_mode+116/124] [autofs_root_ioctl+258/412] [sys_ioctl+421/448] [system_call+52/56]  
Aug  3 11:20:49 tornio kernel: Code: 8b 69 08 81 fd 2b 2f c3 a5 0f 85 d9 00 00 00 8b 69 0c 85 ed  
Code:  00000000 Before first symbol            00000000 <_IP>: <===
Code:  00000000 Before first symbol               0:	8b 69 08             	movl   0x8(%ecx),%ebp <===
Code:  00000003 Before first symbol               3:	81 fd 2b 2f c3 a5    	cmpl   $0xa5c32f2b,%ebp
Code:  00000009 Before first symbol               9:	0f 85 d9 00 00 00    	jne     000000e8 Before first symbol
Code:  0000000f Before first symbol               f:	8b 69 0c             	movl   0xc(%ecx),%ebp
Code:  00000012 Before first symbol              12:	85 ed                	testl  %ebp,%ebp
===Oops 2===
WARNING: This version of ksymoops is obsolete.
WARNING: The current version can be obtained from 
ftp://ftp.ocs.com.au/pub/ksymoops
Options used: -V (default)
              -o /lib/modules/2.2.14-x6/ (default)
              -k /proc/ksyms (default)
              -l /proc/modules (default)
              -m /boot/System.map-2.2.14-x6 (specified)
              -c 1 (default)
No modules in ksyms, skipping objects
Aug  3 11:22:13 tornio kernel: Unable to handle kernel NULL pointer dereference at virtual address 00000000 
Aug  3 11:22:13 tornio kernel: current->tss.cr3 = 0273b000, %cr3 = 0273b000 
Aug  3 11:22:13 tornio kernel: *pde = 00000000 
Aug  3 11:22:13 tornio kernel: Oops: 0002 
Aug  3 11:22:13 tornio kernel: CPU:    0 
Aug  3 11:22:13 tornio kernel: EIP:    0010:[kmem_cache_free+333/372] 
Aug  3 11:22:13 tornio kernel: EFLAGS: 00010286 
Aug  3 11:22:13 tornio kernel: eax: 0000003e   ebx: c0e11300   ecx: 00000024   edx: 00000017 
Aug  3 11:22:13 tornio kernel: esi: c3eff620   edi: 00000286   ebp: 00000000   esp: c18dbf2c 
Aug  3 11:22:13 tornio kernel: ds: 0018   es: 0018   ss: 0018 
Aug  3 11:22:13 tornio kernel: Process umount (pid: 4411, process nr: 60, stackpage=c18db000) 
Aug  3 11:22:13 tornio kernel: Stack: c36e1800 0000000c c0e1137c c0e11380 c012f22b c3eff620 c0e11300 c0e11300  
Aug  3 11:22:13 tornio kernel:        c0e11380 c012f53c c0e11300 c36e1800 fffffffe 0000000c c0127932 c36e1800  
Aug  3 11:22:13 tornio kernel:        0000000c fffffffa c2c4f870 0000000c c0127a57 0000000c 00000000 00000000  
Aug  3 11:22:13 tornio kernel: Call Trace: [dput+223/328] [shrink_dcache_sb+284/296] [do_umount+78/284] [umount_dev+87/160] [sys_umount+179/192] [sys_oldumount+12/16] [system_call+52/56]  
Aug  3 11:22:13 tornio kernel: Code: c7 05 00 00 00 00 00 00 00 00 eb 12 8d 76 00 56 53 68 de c2  
Code:  00000000 Before first symbol            00000000 <_IP>: <===
Code:  00000000 Before first symbol               0:	c7 05 00 00 00 00 00 	movl   $0x0,0x0 <===
Code:  00000007 Before first symbol               7:	00 00 00 
Code:  0000000a Before first symbol               a:	eb 12                	jmp     0000001e Before first symbol
Code:  0000000c Before first symbol               c:	8d 76 00             	leal   0x0(%esi),%esi
Code:  0000000f Before first symbol               f:	56                   	pushl  %esi
Code:  00000010 Before first symbol              10:	53                   	pushl  %ebx
Code:  00000011 Before first symbol              11:	68 de c2 00 00       	pushl  $0xc2de
-- 
Frank
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.rutgers.edu
Please read the FAQ at 
http://www.tux.org/lkml/