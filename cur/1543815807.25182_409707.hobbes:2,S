Date: Wed, 22 Mar 2006 13:46:33 -0800
From: Andrew Morton <>
Subject: Re: [PATCH] PM-Timer: doesn't use workaround if chipset is not buggy
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2006/3/22/388

OGAWA Hirofumi <hirofumi@mail.parknet.co.jp> wrote:
>
> 
> ...
>
> This patch adds blacklist of buggy chip, and if chip is not buggy,
> this uses fast normal version instead of slow workaround version.
> 
> If chip is buggy, warnings "pmtmr is slow". But sounds like there is
> gray zone. I found the PIIX4 errata, but I couldn't find the ICH4
> errata.  But some motherboard seems to have problem.
> 
> So, if found a ICH4, also warnings, and uses a workaround version.  If
> user's ICH4 is good actually, user can specify the "pmtmr_good" boot
> parameter to use fast version.
> 
> ...
>
> +static int __init pmtmr_bug_check(void)
> +{
> +	static struct pci_device_id gray_list[] __initdata = {
> +		/* these chipsets may have bug. */
> +		{ PCI_DEVICE(PCI_VENDOR_ID_INTEL, PCI_DEVICE_ID_INTEL_82801DB_0) },
> +		{ },
> +	};
>
> ...
>
> +	dev = pci_get_device(PCI_VENDOR_ID_INTEL,
> +			     PCI_DEVICE_ID_INTEL_82371AB_3, NULL);
>
> ...
>
> +device_initcall(pmtmr_bug_check);
Can this code use the PCI quirk infrastructure?
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.kernel.org
More majordomo info at  
http://vger.kernel.org/majordomo-info.html
Please read the FAQ at  
http://www.tux.org/lkml/