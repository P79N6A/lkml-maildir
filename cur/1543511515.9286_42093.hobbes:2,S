Date: Mon, 4 Oct 1999 21:57:05 +0200 (CEST)
From: Sebastian <>
Subject: Re: [teso] Re: predictable IP ID
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/1999/10/4/100

On Mon, 4 Oct 1999, Theodore Y. Ts'o wrote:
Hi.
> To the Teso crew, if you could try redoing your analysis with the
> following patch applied, I would greatly appreciate it.  The problem is
> that the secret[] isn't array isn't getting properly initialized, and
> the crypto hash doesn't work well when the secret is all zero's.  Chalk
> this up to another example of "why C is inherently an unsafe programming
> langauge".  (blush)
> 
> 	if (!rekey_time || (tv.tv_sec - rekey_time) > REKEY_INTERVAL) {
> 		rekey_time = tv.tv_sec;
> 		/* First three words are overwritten below. */
> -		get_random_bytes(&secret+3, sizeof(secret)-12);
> +		get_random_bytes(&secret[3], sizeof(secret)-12);
> 		count = (tv.tv_sec/REKEY_INTERVAL) << HASH_BITS;
> 	}
This fix is only part of the problem, we tested kernels with only this fix
applied a few days ago, they were still vulnerable. A real fix has already
been issued, you may want to look on the linux kernel mailing list for an
in depth discussion. Also we've written some mails on bugtraq about this.
Alan already wrote us an email with all the details, a fix/new kernel
should be available soon.
> 							- Ted
ciao,
scut / teso security
-- 
- scut@nb.in-berlin.de - 
http://nb.in-berlin.de/scut/
 - sacbuctd@ircnet  --
-- you don't need a lot of people to be great, you need a few great to be --
-- the best -----------------------------------------------------------------
--- nuclear arrival weapon spy agent remain undercover, hi echelon ----------
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.rutgers.edu
Please read the FAQ at 
http://www.tux.org/lkml/