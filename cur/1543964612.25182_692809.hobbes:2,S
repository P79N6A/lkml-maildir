Date: Wed, 14 May 2008 14:56:37 -0700 (PDT)
From: Linus Torvalds <>
Subject: Re: [announce] "kill the Big Kernel Lock (BKL)" tree
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2008/5/14/456

On Wed, 14 May 2008, Jonathan Corbet wrote:
> 
> There's also every char device open() method - a rather long list in its
> own right.  I'd be surprised if one in ten of them really needs it, but
> one has to look...
I don't think there are *that* many. I found only 83 instances of 
"register_chrdev()" in the kernel, so the open methods should be pretty 
limited.
Of course, some open methods call other sub-registrations, but you'd start 
off by moving the lock_kernel() down just *one* stage. 
So it literally should be:
 - remove one lock_kernel/unlock_kernel pair in fs/char_dev.c
 - add max 83 pairs in the places that register those things
 - external modules will need to add it themselves some day.
> 1: We could add an unlocked_open() to the file_operations structure;
>    drivers could be converted over as they are verified not to need the
>    BKL on open.  Disadvantages are that it grows this structure for a
>    relatively rare case - most open() calls already don't need the BKL.
>    But it's a relatively easy path without flag days.
I really don't think it's worth the pain. See above. The numbers aren't 
that huge, and external modules simply aren't a pressing enough issue.
		Linus