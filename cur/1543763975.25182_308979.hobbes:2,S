Date: Tue, 5 Apr 2005 12:06:44 +0200
From: Pavel Machek <>
Subject: Re: [ACPI] Re: 2.6.12-rc1-mm4 and suspend2ram (and synaptics)
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2005/4/5/112

On Po 04-04-05 10:16:00, Norbert Preining wrote:
> Hi Pavel!
> 
> On Mon, 04 Apr 2005, Pavel Machek wrote:
> > I'd like to fix the problem, but first I need to know where the
> > problem is.  If it works with minimal config, I know that it is one of
> > drivers you deselected.
> 
> It's b44. It *was* working with b44 insmod-ed and up and running, but
> now as soon as b44-eth0 is ifup-ed while suspending, the resume freezes.
> If I do a ifdown eth0 before suspending, it works.
Does this one help?
								Pavel
--- clean/drivers/net/b44.c	2005-04-05 10:55:16.000000000 +0200
+++ linux/drivers/net/b44.c	2005-04-05 10:56:33.000000000 +0200
@@ -1927,6 +1927,8 @@
 	b44_free_rings(bp);
 
 	spin_unlock_irq(&bp->lock);
+
+	free_irq(dev->irq, dev);
 	return 0;
 }
 
@@ -1940,6 +1942,9 @@
 	if (!netif_running(dev))
 		return 0;
 
+	if (request_irq(dev->irq, b44_interrupt, SA_SHIRQ, dev->name, dev))
+		printk(KERN_ERR PFX "%s: request_irq failed\n", dev->name);
+
 	spin_lock_irq(&bp->lock);
 
 	b44_init_rings(bp);
-- 
People were complaining that M$ turns users into beta-testers...
...jr ghea gurz vagb qrirybcref, naq gurl frrz gb yvxr vg gung jnl!
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.kernel.org
More majordomo info at  
http://vger.kernel.org/majordomo-info.html
Please read the FAQ at  
http://www.tux.org/lkml/