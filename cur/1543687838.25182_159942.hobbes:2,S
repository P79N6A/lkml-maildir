Date: Sun, 24 Aug 2003 19:53:21 +0200
From: Willy Tarreau <>
Subject: Re: [AMD76X]
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2003/8/24/75

On Sun, Aug 24, 2003 at 09:33:23AM +1000, Herbert Xu wrote:
> Hi:
> 
> amd76x_pm.c will crash if no chipsets are found and CONFIG_HOTPLUG is
> turned on.  This patch makes it return with a failure instead.
Hi !
I'm wondering whether this patch should be needed too.
Cheers,
Willy
--- linux-2.4.22-rc3/drivers/char/amd76x_pm.c.orig	Sun Aug 24 19:52:42 2003
+++ linux-2.4.22-rc3/drivers/char/amd76x_pm.c	Sun Aug 24 19:53:49 2003
@@ -620,6 +620,8 @@
 #ifndef AMD76X_NTH
 	if (!amd76x_pm_cfg.curr_idle) {
 		printk(KERN_ERR "amd76x_pm: Idle function not changed\n");
+		pci_unregister_driver(&amd_nb_driver);
+		pci_unregister_driver(&amd_sb_driver);
 		return 1;
 	}
 
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.kernel.org
More majordomo info at  
http://vger.kernel.org/majordomo-info.html
Please read the FAQ at  
http://www.tux.org/lkml/