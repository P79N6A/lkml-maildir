Date: Mon, 2 May 2005 15:23:57 +0200 (CEST)
From: Grzegorz Kulewski <>
Subject: How to flush data to disk reliably?
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2005/5/2/39

Hi,
I am writing an app that has log files. These log files must be reliably 
and permanently flushed to disk on some points. These log files can be:
a. normal files on some (local) filesytem,
b. some block device (disk/partition).
I am asking how to flush the data from these logs to disk. I know of 
several methods:
1. open with O_SYNC,
2. sync(2),
3. fsync,
4. fdatasync,
5. msync (if they are mmaped).
Which of these are best and most reliable for (a/b) and for (IDE/SCSI)? 
What are differences between them? Maybe some other method? Are there any 
other precautions that I should be aware of? What about write caches? Are 
write barriers implemented (on IDE and SATA/SCSI) or should I turn caches 
off?
I am using Linux 2.6. (But I will be glad to hear about differences 
between 2.4 and 2.6 in this aspect if there are any.)
Thanks in advance,
Grzegorz Kulewski
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.kernel.org
More majordomo info at  
http://vger.kernel.org/majordomo-info.html
Please read the FAQ at  
http://www.tux.org/lkml/