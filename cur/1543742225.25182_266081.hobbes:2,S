Date: Thu, 28 Oct 2004 20:48:17 -0700
From: William Lee Irwin III <>
Subject: Re: [RFC] Consolidate lots of hugepage code
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2004/10/28/473

On Fri, Oct 29, 2004 at 01:37:08PM +1000, David Gibson wrote:
> wA lot of the code in arch/*/mm/hugetlbpage.c is quite similar.  This
> patch attempts to consolidate a lot of the code across the arch's,
> putting the combined version in mm/hugetlb.c.  There are a couple of
> uglyish hacks in order to cover all the hugepage archs, but the result
> is a very large reduction in the total amount of code.  It also means
> things like hugepage lazy allocation could be implemented in one
> place, instead of six.
> As yet this is entirely untested, except on ppc64.  Comments?
> Objections?  Testing acks?
> Notes:
> 	- this patch changes the meaning of set_huge_pte() to be more
> 	  analagous to set_pte()
> 	- does SH4 need special huge_ptep_get_and_clear()??
Further consolidation is premature given that outstanding hugetlb bugs
have the implication that architectures' needs are not being served by
the current arch/core split. I have at least two relatively major hugetlb
bugs outstanding, the lack of a flush_dcache_page() analogue first, and
another (soon to be a reported to affected distros) less well-understood.
Unless they're directly toward the end of restoring hugetlb to a sound
state, they're counterproductive to merge before patches doing so.
-- wli
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.kernel.org
More majordomo info at  
http://vger.kernel.org/majordomo-info.html
Please read the FAQ at  
http://www.tux.org/lkml/