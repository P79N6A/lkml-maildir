Date: Wed, 30 Apr 2008 21:42:39 +0100
From: Alan Cox <>
Subject: [PATCH 2/2] mm: Fix overcommit overflow
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2008/4/30/426

Thanks, one more reason to boot to 2.6.24.5...
This patch needed, too, I guess.
From: Sami Farin <safari-kernel@safari.iki.fi>
Signed-off-by: Sami Farin <safari-kernel@safari.iki.fi>
Signed-off-by: Alan Cox <alan@redhat.com>
Tested-by: Sami Farin <safari-kernel@safari.iki.fi>
diff --git a/fs/proc/proc_misc.c b/fs/proc/proc_misc.c
index 3462bfd..a208a7b 100644
--- a/fs/proc/proc_misc.c
+++ b/fs/proc/proc_misc.c
@@ -132,7 +132,7 @@ static int meminfo_read_proc(char *page, char **start, off_t off,
 #define K(x) ((x) << (PAGE_SHIFT - 10))
 	si_meminfo(&i);
 	si_swapinfo(&i);
-	committed = atomic_read(&vm_committed_space);
+	committed = vm_atomic_read(&vm_committed_space);
 	allowed = ((totalram_pages - hugetlb_total_pages())
 		* sysctl_overcommit_ratio / 100) + total_swap_pages;
 
-- 
Do what you love because life is too short for anything else.