Date: Wed, 14 Jan 2009 19:33:32 -0800 (PST)
From: Linus Torvalds <>
Subject: Re: [patch 2/8] compiler-gcc.h: add more comments to RELOC_HIDE
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2009/1/14/617

On Thu, 15 Jan 2009, Rusty Russell wrote:
> On Tuesday 13 January 2009 04:03:49 Christoph Lameter wrote:
> > But that is not what is occurring. We do not do &var + LARGE_OFFSET.
> > Instead one does
> > 
> > 	((void *)&var) + LARGE_OFFSET
> > 
> > or
> > 	((unsigned long)&var) + LARGE_OFFSET
> > 
> > The cast should cause the C compiler to drop all assumptions about size.
> 
> No, and that's the point.  Sorry, at this point you need to talk to a gcc expert.  As I have said, I did and I believe what he told me.
Yeah, I personally believe in the "should cause the C compiler" part, but 
gcc doesn't work that way. It will remember where the value came from, 
even when the pointer has been cast to something else.
			Linus