Date: Sun, 23 Jul 2006 11:12:43 -0700
From: Paul Jackson <>
Subject: Re: [PATCH] Cpuset: fix ABBA deadlock with cpu hotplug lock
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2006/7/23/56

[I added the CC list from the "remove cpu hotplug bustification" thread. -pj]
Nine days ago, I offered this patch to fix a particular instance of
ABBA deadlock we were seeing on a single customer machine, between the
cpu hotplug lock and one of the cpuset locks.  In this case, the patch
was simple enough - reorder a couple of operations to avoid the risk of
taking these locks in the wrong order.
pj wrote:
> This fix appears right from inspection, but it will take a few
> more days running it on that customers workload to be confident
> we nailed it.  We don't have any other reproducible test case.
We now have enough exposure running this fix on that customers workload
to be confident this fix works.  We should have seen at least ten of
these crashes by now.  We've seen zero.
If the upcoming 2.6.18 is still open for non-critical fixes please
consider this patch.  In this case, it is non-critical because few
systems (exactly one system, world wide, so far) hit it.  It is quite
fatal when hit.
On the other hand, if you decide to nuke the cpu hotplug lock for
2.6.18, then just forget this patch, as it would no longer apply.
There's no need of trimming the patients ingrown toenail if you
amputate the leg.
-- 
                  I won't rest till it's the best ...
                  Programmer, Linux Scalability
                  Paul Jackson <pj@sgi.com> 1.925.600.0401
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.kernel.org
More majordomo info at  
http://vger.kernel.org/majordomo-info.html
Please read the FAQ at  
http://www.tux.org/lkml/