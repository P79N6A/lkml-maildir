Date: Fri, 23 Mar 2001 11:04:13 +0100
From: Kurt Garloff <>
Subject: Re: Some strange patch to drivers/input/keybdev.c
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2001/3/23/42

Hi,
On Thu, Mar 22, 2001 at 09:42:55PM -0500, Pete Zaitcev wrote:
> Some guy sent me the attached patch. He says it allows
> him to use 2 additional keys on the 106 key USB keyboard.
> I never saw a 106 key keyboard before, USB or not.
> Does anyone understand what is going on? Vojtech?
don't know if it's related, but new keyboards tend to have those annoying
APM keys. On my keyboard, they generate the scan sequences e0 5e (Power
OFF), e0 5f (Sleep) and e0 63 (Wake Up). I guess the USB kbd also has those
toy keys.
Patch to support those keys on a normal PS/2 kbd attached.
Regards,
-- 
Kurt Garloff  <garloff@suse.de>                          Eindhoven, NL
GPG key: See mail header, key servers         Linux kernel development
SuSE GmbH, Nuernberg, FRG                               SCSI, Security
--- linux.compile.old/drivers/char/pc_keyb.c	Tue Jul 11 15:00:25 2000
+++ linux.compile/drivers/char/pc_keyb.c	Wed Jan 31 18:51:41 2001
@@ -153,6 +153,10 @@
 
 #define E1_PAUSE   119
 
+#define E0_PWOFF   115
+#define E0_SLEEP   116
+#define E0_ALARM   117
+
 /*
  * The keycodes below are randomly located in 89-95,112-118,120-127.
  * They could be thrown away (and all occurrences below replaced by 0),
@@ -230,10 +234,10 @@
   0, 0, 0, 0, 0, E0_KPSLASH, 0, E0_PRSCR,	      /* 0x30-0x37 */
   E0_RALT, 0, 0, 0, 0, E0_F13, E0_F14, E0_HELP,	      /* 0x38-0x3f */
   E0_DO, E0_F17, 0, 0, 0, 0, E0_BREAK, E0_HOME,	      /* 0x40-0x47 */
-  E0_UP, E0_PGUP, 0, E0_LEFT, E0_OK, E0_RIGHT, E0_KPMINPLUS, E0_END,/* 0x48-0x4f */
+  E0_UP, E0_PGUP, 0, E0_LEFT, E0_OK, E0_RIGHT, E0_KPMINPLUS, E0_END, /* 0x48-0x4f */
   E0_DOWN, E0_PGDN, E0_INS, E0_DEL, 0, 0, 0, 0,	      /* 0x50-0x57 */
-  0, 0, 0, E0_MSLW, E0_MSRW, E0_MSTM, 0, 0,	      /* 0x58-0x5f */
-  0, 0, 0, 0, 0, 0, 0, 0,			      /* 0x60-0x67 */
+  0, 0, 0, E0_MSLW, E0_MSRW, E0_MSTM, E0_PWOFF, E0_SLEEP, /* 0x58-0x5f */
+  0, 0, 0, E0_ALARM, 0, 0, 0, 0,		      /* 0x60-0x67 */
   0, 0, 0, 0, 0, 0, 0, E0_MACRO,		      /* 0x68-0x6f */
   0, 0, 0, 0, 0, 0, 0, 0,			      /* 0x70-0x77 */
   0, 0, 0, 0, 0, 0, 0, 0			      /* 0x78-0x7f */[unhandled content-type:application/pgp-signature]