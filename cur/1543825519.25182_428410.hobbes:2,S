Date: Tue, 30 May 2006 22:05:09 +0200
From: Ingo Molnar <>
Subject: Re: [patch, -rc5-mm1] lock validator: disable NMI watchdog if CONFIG_LOCKDEP, i386
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2006/5/30/301

* Ingo Molnar <mingo@elte.hu> wrote:
> yeah, totally agreed, they need to be raw notifiers. Havent had time 
> to investigate it in detail yet - i went for the easier hack of 
> disabling NMIs while lockdep is enabled.
hm ... atomic_notifier_call_chain ought to be fine - it uses 
rcu_read_lock(), which uses preempt_disable(), which is NMI-safe.
so i think this NMI problem might be lockdep-specific. I think it might 
be the NMI iret that confuses lockdep. (and irqflags-trace in 
particular)
	Ingo
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.kernel.org
More majordomo info at  
http://vger.kernel.org/majordomo-info.html
Please read the FAQ at  
http://www.tux.org/lkml/