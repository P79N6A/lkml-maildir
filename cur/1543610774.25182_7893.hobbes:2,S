Date: Mon, 26 Nov 2001 17:03:49 +0100 (MET)
From: "Maciej W. Rozycki" <>
Subject: [patch] 2.4.16: 802.1Q VLAN non-modular
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2001/11/26/100

Hi,
 It appears the 802.1Q VLAN support didn't receive even basic testing,
sigh...  It doesn't compile non-modular, due to vlan_proc_cleanup() being
discarded, yet needed in vlan_proc_init().  Following is a fix. 
  Maciej
-- 
+  Maciej W. Rozycki, Technical University of Gdansk, Poland   +
+--------------------------------------------------------------+
+        e-mail: macro@ds2.pg.gda.pl, PGP key available        +
patch-mips-2.4.14-20011123-vlan-0
diff -up --recursive --new-file linux-mips-2.4.14-20011123.macro/net/8021q/vlanproc.c linux-mips-2.4.14-20011123/net/8021q/vlanproc.c
--- linux-mips-2.4.14-20011123.macro/net/8021q/vlanproc.c	Tue Nov  6 07:56:16 2001
+++ linux-mips-2.4.14-20011123/net/8021q/vlanproc.c	Sun Nov 25 02:28:24 2001
@@ -116,7 +116,7 @@ static char conf_hdr[] = "VLAN Dev name	
  *	Clean up /proc/net/vlan entries
  */
 
-void __exit vlan_proc_cleanup(void)
+void vlan_proc_cleanup(void)
 {
 	if (proc_vlan_conf)
 		remove_proc_entry(name_conf, proc_vlan_dir);
@@ -462,7 +462,7 @@ int __init vlan_proc_init (void)
 	return 0;
 }
 
-void __exit vlan_proc_cleanup(void)
+void vlan_proc_cleanup(void)
 {
 	return;
 }
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.kernel.org
More majordomo info at  
http://vger.kernel.org/majordomo-info.html
Please read the FAQ at  
http://www.tux.org/lkml/