Date: Sat, 6 May 2006 12:32:51 -0700
From: David Brownell <>
Subject: Re: USB 2.0 ehci failure with large amount of RAM (4GB) on x86_64
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2006/5/6/72

On Thursday 04 May 2006 10:46 pm, Nathan Becker wrote:
> Yes, GART_IOMMU is already turned on.  Do you want me to send more
> detailed debugging messages?
And when you tell the kernel to only use 2 GB, it works again right?
Just trying to rule out hardware or hardware-init bugs.
Maybe you could change both dma masks to be 31 bits and then force the
IOMMU active, so it gives out addresses below 2GB.  You should be able
to make it so that the EHCI controller never sees addresss with the
high bit set, making your 4 GB config act like a 2 GB one (via IOMMU).
Which one hopes means "working" ... it'd be good to know a workaround!
This isn't neceessarily a variant of that known NForce silicon bug, but you
could help confirm that by changing the "3strikes" message so it prints
out urb->transfer_dma ... and maybe make qh_completions() dump the dma
addresses of the qh and qtd too (iff urb->status becomes -EPROTO).
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.kernel.org
More majordomo info at  
http://vger.kernel.org/majordomo-info.html
Please read the FAQ at  
http://www.tux.org/lkml/