Date: Wed, 27 Apr 2005 16:23:44 +0200
From: Andi Kleen <>
Subject: New debugging patch was Re: x86-64 bad pmds in 2.6.11.6 II
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2005/4/27/109

Could someone who reproduces this problem apply the following
patch and see if the WARN_ON triggers?
diff -u linux-2.6.11/mm/memory.c-o linux-2.6.11/mm/memory.c
--- linux-2.6.11/mm/memory.c-o	2005-03-02 08:38:08.000000000 +0100
+++ linux-2.6.11/mm/memory.c	2005-04-27 15:48:19.777104735 +0200
@@ -94,6 +94,7 @@
 	if (pmd_none(*pmd))
 		return;
 	if (unlikely(pmd_bad(*pmd))) {
+		printk("%s:%d: ", current->comm, current->pid);
 		pmd_ERROR(*pmd);
 		pmd_clear(pmd);
 		return;
@@ -113,6 +114,7 @@
 	unsigned long addr = start, next;
 	pmd_t *pmd, *__pmd;
 
+	WARN_ON(start == end);
 	if (pud_none(*pud))
 		return;
 	if (unlikely(pud_bad(*pud))) {
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.kernel.org
More majordomo info at  
http://vger.kernel.org/majordomo-info.html
Please read the FAQ at  
http://www.tux.org/lkml/