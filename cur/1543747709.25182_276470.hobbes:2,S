Date: Fri, 3 Dec 2004 15:07:39 +0100
From: Friedrich Delgado Friedrichs <>
Subject: Re: Problem: Kernel Panic/Oops on shutdown with 2.6.9 and Dell Optiplex SX280
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2004/12/3/71

Hello!
Alan Cox schrieb:
> Are you running some kind of sniffer tool on these machines. That
> message itself is the last sniffer type application exiting. If you are
> running such a tool then it tells you that the shutdown got that far
> into the shutdown scripts which may help the search.
Yes, it's arpwatch.
In fact there are 5 init scripts which could trigger the bug. One of
them (powersaved) runs fuser directly. I've traced the other shutdown
scripts via "sh -x -v" and none of them appears to call fuser.
The line from /etc/init.d/powersaved is
for X in $(fuser /proc/acpi/event);do
> something newer might help. 10rc2 has a fairly number of the problems
> fixed and  a few new ones (eg it won't boot on some boxes) but might be
> useful to at least see if you are chaasing a fixed bug
This, together with your comment about USB + SCSI bug fixes below
sounds as if we really want to use 2.6.10rc2 (if it boots), because
having a machine crash during normal work is a lot worse than on
shutdown.
> > nnpfs 213484 1 - Live 0xe02ad000
> > subfs 12288 1 - Live 0xe01c4000
>
> This is ARLA stuff ?
nnpfs is the kernel-side portion of the AFS Client, subfs is from the
submount package (km_submount) from SuSE 9.1. It allows users to
insert cds and change to /media/cdrecorder to access them and also
allows the user to eject the cd as soon as there's no process in
/media/cdrecorder any more. See 
http://submount.sourceforge.net/
Thanks for your help!
I already mentioned to Andrew Morton that right now it seems prudent
to continue with 2.6.10rc2 (to get rid of the USB and scsi problems)
and try to convince __d_path to give a conclusive hint about the
culprit.
Kind regards
     FDF
--
Friedrich Delgado Friedrichs (IT-Services), DFN-CERT Services GmbH
https://www.dfn-cert.de
, +49 40 808077-555 (Hotline)
12. DFN-CERT Workshop und Tutorien, CCH Hamburg, 2-3. Maerz 2005
[unhandled content-type:application/pgp-signature]