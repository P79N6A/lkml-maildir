Date: 14 May 2004 21:36:38 -0400
From: Len Brown <>
Subject: Re: peculiar problem with 2.6, 8139too + ACPI
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2004/5/14/303

On Fri, 2004-05-14 at 09:28, Robert Fendt wrote:
> I have the following problem: the 8139too driver produces lots of
> overruns and is _very_ slow (but strangely not always; the problem
> seems to be site-dependant, too). And here is what is weird: if I
> artifically raise the system load (e.g. compile a kernel just for
> fun), the download speed grows by at least an order of magnitude.
It is possible that the system is getting into a high power saving
mode on idle.  Device bus master activity or interrupts will wake
it up -- but the latency to return from power savings mode may be
so high that the device experiences receive buffer overruns.
Some devices handle this latency better than others,
and with a network, dropping RX packets can cause the
connection to thrash, and it seems that is what you see.
If the 8139too has statistics counters showing if it gets
RX buffer over-runs, that would be interseting to observe.
Also, to see what idle power saving states you have, their
latency and their usage, please do this:
cat /proc/acpi/processor/CPU0/power
It would also be interesting to know if you see the problem
more frequently when running on battery power, since some
systems have higher c-state exit latency when on battery.
It would also be interesting to know if you see the same
frequency of the problem on 2.4, since it has 100HZ clock
vs 1000HZ clock on 2.6 -- and this can have a significant
effect on the effectivness of idle c-states.
cheers,
-Len
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.kernel.org
More majordomo info at  
http://vger.kernel.org/majordomo-info.html
Please read the FAQ at  
http://www.tux.org/lkml/