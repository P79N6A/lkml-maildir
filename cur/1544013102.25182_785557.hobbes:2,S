Date: Wed, 31 Dec 2008 16:27:09 -0600
From: Jayson King <>
Subject: Re: large intermittent latency spike 2.6.28 (and 2.6.27.10), bisect commit ca7e716c7833aeaeb8fedd6d004c5f5d5e14d325 -> Revert "sched_clock: prevent scd->clock from moving backwards"
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2008/12/31/261

Arjan van de Ven wrote:
 > Jayson King <dev@jaysonking.com> wrote:
 >> Please disregard this. ...
 >
 > can you run latencytop to see if it can pinpoint a cause of latency?
Like I said in my other reply I was running the wrong kernel when I 
wrote that (oops)... So now I am still sure it is ca7e716.
Ingo's patch makes the same change that reverting ca7e716 does here:
-	max_clock = scd->tick_gtod + TICK_NSEC;
+	max_clock = wrap_max(scd->clock, scd->tick_gtod + TICK_NSEC);
And with that change (I'm using Ingo's patch now) I can't trigger the 
hang anymore. And before, I could reliably trigger it in a short time.
Jayson