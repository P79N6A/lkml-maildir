Date: Sun, 26 Aug 2007 13:00:44 +0100
From: Alistair John Strachan <>
Subject: Re: "exception Emask: 0x42" errors with 2.6.22.x and SATA drives
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2007/8/26/28

On Friday 24 August 2007 20:20:02 Alan Cox wrote:
> On Fri, 24 Aug 2007 14:39:10 +0100
>
> "Dermot Bradley" <dermot.bradley@sla-mobile.com> wrote:
> > I've just built a new machine using a ASUS M2A-VM boardboard (ATI SB600
> > chipset), AMD X2 3800+ processor, and 2 Western Digital 2.5" 80Gb drives
> > running in RAID-1 using MD. I've had these problems with both 2.6.22.1
> > and now 2.6.22.5 kernels.
> >
> > I'm getting the following errors on occasion:
> >
> > Aug 24 13:19:22 playpbx kernel: APIC error on CPU0: 00(40)
> > Aug 24 13:19:33 playpbx kernel: APIC error on CPU0: 40(40)
>
> This is not good.
FWIW, I've got the HDMI version of this board and I have exactly the same 
problem (even with the newest BIOS) if nmi_watchdog is not set to zero. Try 
booting with nmi_watchdog=0 (default on x86-64, I think) and see if these go 
away.
I guess the APIC has some difficulties handling NMIs.
> > Aug 24 13:55:31 playpbx kernel: ata3.00: exception Emask 0x42 SAct
> > 0x7fc77 SErr0x800 action 0x6 frozen
> > Aug 24 13:55:31 playpbx kernel: ata3.00: (spurious completions during
> > NCQ issue=0x0 SAct=0x7fc77 FIS=004040a1:00000008)
>
> Probably not connected - your drive seems to be talking rubbish
>
> Neither are good, the latter is probably a drive firmware problem and the
> kernel will give up using NCQ with it if it keeps doing that, which
> should be just fine.
I get the feeling this problem is independent of the APIC errors, and I don't 
see it here. I'm using Hitachi Deskstars on the on-board controller in AHCI 
mode, and everything works fine.
As Alan said, it's very possibly just the drive not properly supporting NCQ.
-- 
Cheers,
Alistair.
137/1 Warrender Park Road, Edinburgh, UK.
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.kernel.org
More majordomo info at  
http://vger.kernel.org/majordomo-info.html
Please read the FAQ at  
http://www.tux.org/lkml/