Date: 30 Jul 2000 22:44:58 -0700
From: (Linus Torvalds)
Subject: Re: Cache coherency... and locking
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2000/7/31/4

In article <Pine.LNX.4.10.10007280922170.20318-100000@waste.org>,
Oliver Xymoron  <oxymoron@waste.org> wrote:
>
>Because cache coherence is both complex and expensive and treating a NUMA
>as a tight cluster rather than a single machine (as you mention) is
>probably a saner architecture.
This is not necessarily all that true any more. People have gotten
better at doing cache coherency, and there are people who want to try
it. Let them.
Yes, I suspect that for true scalability you _do_ want to consider the
machine to be a tight cluster. However, I don't think it's unreasonable
to do a ccNUMA architecture of, say, 4x4 (four nodes with 4 CPU's each),
and use it in an SMP manner.
Such a setup doesn't actually _have_ to be expensive - assuming standard
chipsets were to come out etc. Remember what made SMP cheap. 
Let's see what the complexity issues are. I suspect it might work out
ok on a reasonable scale.
(and once it doesn't scale any more, we'll start treating them as
separate machines.  The decision on how to partition it might even end
up depending on what kind of load people put on the machine.  Even if
you end up using the system as a cluster the cache coherency will at
least make some things easier..)
>CC is primarily a big deal for user space, for apps pretending they're on
>SMP. We don't want to encourage this model as it's fundamentally a bad
>match for the hardware.
Agreed. But those user applications do exist. Oh, well..
>As for the kernel, supporting the two models should be relatively easy
>compared to something like adding SMP support in the first place..  We are
>already paying close attention to memory-sharing assumptions for
>performance reasons and the number of inter-processor primitives is small.
Yes. I think it would probably not be all that horrible to have ccNUMA
support and then decide to not even use it when the cluster model
behaves better. Some of the basic NUMA support is quite simple right
now, and we'll see how far we're interested in walking that path.
Almost certainly not as far as some have gone.
			Linus
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.rutgers.edu
Please read the FAQ at 
http://www.tux.org/lkml/