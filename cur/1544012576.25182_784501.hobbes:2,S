Date: Sun, 28 Dec 2008 16:09:26 +0200
From: Avi Kivity <>
Subject: Re: [PATCH 0/3] Remove interrupt stack table usage from x86_64 kernel
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2008/12/28/39

(restoring cc list)
Andi Kleen wrote:
> One of the other problems: NMIs and MCEs have the same problem with SYSCALL
> 
This one however looks unsolvable.  Userspace can point %rsp into 
arbitrary memory, issue a syscall, and hope for an nmi.  Since we're in 
cpl 0 and are not using IST, the processor will not switch stacks, and 
the nmi stack frame will corrupt any memory the user chooses to point to.
Even without a malicious user, %rsp could legitimately point at unmapped 
memory.
I don't see how syscall could work on i386, and indeed:
> vdso32.so-$(VDSO32-y)        += int80
> vdso32.so-$(CONFIG_COMPAT)    += syscall
> vdso32.so-$(VDSO32-y)        += sysenter
It's disabled.  Is that the reason?
-- 
error compiling committee.c: too many arguments to function