Date: Fri, 16 Jan 2009 14:28:04 +0900
From: MinChan Kim <>
Subject: [PATCH] Remove needless flush_dcache_page call
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2009/1/16/4

Now, Anyone don't maintain cramfs.
I don't know who is maintain romfs. so I send this patch to linux-mm, 
lkml, linux-dev. 
I am not sure my thought is right. 
When readpage is called, page with argument in readpage is just new 
allocated because kernel can't find that page in page cache. 
At this time, any user process can't map the page to their address space. 
so, I think D-cache aliasing probelm never occur. 
It make sense ?
---
diff --git a/arch/arm/mach-integrator/clock.h b/arch/arm/mach-integrator/clock.h
deleted file mode 100644
index e69de29..0000000
diff --git a/fs/cramfs/inode.c b/fs/cramfs/inode.c
index a07338d..40c8b84 100644
--- a/fs/cramfs/inode.c
+++ b/fs/cramfs/inode.c
@@ -492,7 +492,6 @@ static int cramfs_readpage(struct file *file, struct page * page)
 		pgdata = kmap(page);
 	memset(pgdata + bytes_filled, 0, PAGE_CACHE_SIZE - bytes_filled);
 	kunmap(page);
-	flush_dcache_page(page);
 	SetPageUptodate(page);
 	unlock_page(page);
 	return 0;
diff --git a/fs/romfs/inode.c b/fs/romfs/inode.c
index 98a232f..d008262 100644
--- a/fs/romfs/inode.c
+++ b/fs/romfs/inode.c
@@ -454,7 +454,6 @@ romfs_readpage(struct file *file, struct page * page)
 
 	if (!result)
 		SetPageUptodate(page);
-	flush_dcache_page(page);
 
 	unlock_page(page);