Date: Wed, 24 Jan 2007 00:53:06 +0000
From: Oleg Verych <>
Subject: [patch] kbuild: create KBUILD_OUTPUT
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2007/1/23/258

kbuild: create KBUILD_OUTPUT
 When requesting build to another directory, try to create it first.
Cc: Sam Ravnborg <sam@ravnborg.org>
Signed-off-by: Oleg Verych <olecom@flower.upol.cz>
---
,-*- bash -*-
|olecom@deen:~/kernel.org/_work/src/linux-2.6.20-rc5$
|olecom@deen:~/kernel.org/_work/src/linux-2.6.20-rc5$ make O=/tmp/build
|cd: 1: can't cd to /tmp/build
|Makefile:116: *** output directory "/tmp/build" does not exist.  Stop.
|olecom@deen:~/kernel.org/_work/src/linux-2.6.20-rc5$ patch -p1 <../../va-patch/
|kbuild-create-output-dir.patch
|patching file Makefile
|olecom@deen:~/kernel.org/_work/src/linux-2.6.20-rc5$ make O=/tmp/build
|HOSTCC scripts/basic/fixdep HOSTCC scripts/basic/docproc make[3]: ***
|[scripts/basic/docproc] Interrupt make[2]: *** [scripts_basic] Interrupt
|make: *** [_all] Interrupt
|
|olecom@deen:~/kernel.org/_work/src/linux-2.6.20-rc5$
`-*-
--- linux-2.6.20-rc5/Makefile~orig	2007-01-12 19:54:26.000000000 +0100
+++ linux-2.6.20-rc5/Makefile	2007-01-24 00:59:55.926951750 +0100
@@ -113,5 +113,5 @@
 # check that the output directory actually exists
 saved-output := $(KBUILD_OUTPUT)
-KBUILD_OUTPUT := $(shell cd $(KBUILD_OUTPUT) && /bin/pwd)
+KBUILD_OUTPUT := $(shell d=$(KBUILD_OUTPUT) ; mkdir -p $$d && cd $$d && pwd)
 $(if $(KBUILD_OUTPUT),, \
      $(error output directory "$(saved-output)" does not exist))
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.kernel.org
More majordomo info at  
http://vger.kernel.org/majordomo-info.html
Please read the FAQ at  
http://www.tux.org/lkml/