Date: Mon, 18 Sep 2006 07:45:36 +0100
From: David Woodhouse <>
Subject: Re: [patch 1/8] extend make headers_check to detect more problems
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2006/9/18/26

On Mon, 2006-09-18 at 08:21 +0200, Sam Ravnborg wrote:
> Can't we do this with a hdrchk$$$ filename to avoid using
> random entropy for each compile? 
I'd like to move to a scheme where we do headers_install and
headers_check _without_ starting with a rm -rf
$(HDR_INSTALL_PATH)/include.
We could probably do it by adding a rule along the lines of
$(filter-out $(unifdef-y) $(header-y),$(wildcard $(INSTALL_HDR_PATH)/$(dst)/*.h):
	rm $@
... i.e. remove every .h file from the destination directory except the
ones we just created. 
Then we can make $(INSTALL_HDR_PATH)/$(dst)/%.h depend on
$(srctree)/$(src)/%.h so that it doesn't get re-exported unless it's
changed. And we can keep a stamp file around (or the output of the test
compilation after Arnd's patch) which shows that the _check_ step has
been done too. Something like .checked.%.h
After we do that, a second invocation of 'make headers_check' should
have nothing to do, which will encourage people to keep using it.
-- 
dwmw2
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.kernel.org
More majordomo info at  
http://vger.kernel.org/majordomo-info.html
Please read the FAQ at  
http://www.tux.org/lkml/