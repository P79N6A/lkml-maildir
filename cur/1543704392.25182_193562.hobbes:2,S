Date: Sat, 24 Jan 2004 10:10:39 -0800
From: Andrew Morton <>
Subject: Re: [PATCH] Remove More Unneccessary CPU Notifiers
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2004/1/24/88

Rusty Russell <rusty@rustcorp.com.au> wrote:
>
> Three more removed CPU notifiers extracted from the hotplug CPU patch.
> 
>  kernel/softirq.c: the tasklet cpu prepration callback is useless:
>  the vectors are already initialized to NULL.  Even with the hotplug
>  CPU patches, they're of little or no use.
> 
>  fs/buffer.c: once again, they are already initialized to zero.
> 
>  mm/page_alloc.c: once again, already initialized to zero.
But when hot-remove is implemented we will need to migrate a going-away
CPU's per-cpu data into a different CPU's storage area, will we not?
If so, some of these notifiers need to remain in place.
Or are you saying that we should just leave the per-cpu accounting in a
non-zero state when its CPU has gone away, and rely upon the stats
gathering code iterating across all cpu_possible cpus?
That's a bit lame in the case of __get_page_state() at least.  We've had
problems with excess CPU consumption in there at times and it would be good
to be able to change that function to iterate across all online CPUs, not
all possible ones.  We can do that if we have a notifier which spills the
numbers from the gone-away CPU into the local CPU's slot.
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.kernel.org
More majordomo info at  
http://vger.kernel.org/majordomo-info.html
Please read the FAQ at  
http://www.tux.org/lkml/