Date: Fri, 11 Feb 2000 21:30:29 -0500 (EST)
From: Jean-Luc Pedneault <>
Subject: [2.3.43] Segfault during booting
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2000/2/12/40

I get this while booting:
---<snip>---
[...]
scsi : 0 hosts.
scsi : detected total.
Real Time Clock Driver v1.10
Linux agpgart interface v0.99 (c) Jeff Hartmann
agpgart: Maximum main memory to use for agp memory: 94M
agpgart: Detected Via VP3 chipset
general protection fault: 0000
CPU:    0
EIP:    0010:[<c01265097>]
EFLAGS: 00010202
eax: 00010202   ebx: 0123e063   ecx: 0021e2c8   edx: 00000010
esi: c123e06c   edi: 00400000   ebp: c0101c84   esp: c7feff64
ds: 0018   es: 0018   ss: 0018
Process swapper (pid: 1, stackpage=c7fef000)
Stack: c8017000 00004000 00000000 00000000 07f92000 00000000 01b80000 
00000163
       0001b000 0001b000 0123e063 c801b000 c0101c84 c01266a1 c8400000
00004000
       00000040 00000001 c0251912 00004000 c026b0ac c0245fdc c0105000
000000a0
Call Trace: [<c8017000>] [<c801b000>] [<c0101c84>] [<c0126601>]
[<c8400000>] [<c0105000>] [<c0221160>]
            [<c010709b>] [<c0108dbf>]
Code: 0f 22 e0 eb 08 89 f6 0f 20 d8 0f 22 d8 31 c0 5b 5e 5f 5d 83
---<snip>---
config used:
---<snip>---
CONFIG_X86=y
CONFIG_ISA=y
CONFIG_UID16=y
CONFIG_EXPERIMENTAL=y
CONFIG_MK6=y
CONFIG_X86_WP_WORKS_OK=y
CONFIG_X86_INVLPG=y
CONFIG_X86_BSWAP=y
CONFIG_X86_POPAD_OK=y
CONFIG_X86_TSC=y
CONFIG_NOHIGHMEM=y
CONFIG_MTRR=y
CONFIG_MODULES=y
CONFIG_KMOD=y
CONFIG_NET=y
CONFIG_PCI=y
CONFIG_PCI_GOANY=y
CONFIG_PCI_BIOS=y
CONFIG_PCI_DIRECT=y
CONFIG_PCI_NAMES=y
CONFIG_HOTPLUG=y
CONFIG_SYSVIPC=y
CONFIG_SYSCTL=y
CONFIG_KCORE_ELF=y
CONFIG_BINFMT_AOUT=y
CONFIG_BINFMT_ELF=y
CONFIG_BINFMT_MISC=y
CONFIG_PARPORT=m
CONFIG_PARPORT_PC=m
CONFIG_PARPORT_PC_FIFO=y
CONFIG_ACPI=y
CONFIG_BLK_DEV_FD=y
CONFIG_BLK_DEV_IDE=y
CONFIG_BLK_DEV_IDEDISK=y
CONFIG_BLK_DEV_IDESCSI=m
CONFIG_BLK_DEV_IDEPCI=y
CONFIG_BLK_DEV_IDEDMA_PCI=y
CONFIG_IDEDMA_PCI_AUTO=y
CONFIG_IDEDMA_PCI_EXPERIMENTAL=y
CONFIG_BLK_DEV_VIA82CXXX=y
CONFIG_BLK_DEV_IDEDMA=y
CONFIG_IDEDMA_AUTO=y
CONFIG_BLK_DEV_LOOP=m
CONFIG_PACKET=y
CONFIG_UNIX=y
CONFIG_INET=y
CONFIG_SKB_LARGE=y
CONFIG_IPX=m
CONFIG_SPX=m
CONFIG_SCSI=y
CONFIG_BLK_DEV_SD=m
CONFIG_SD_EXTRA_DEVS=0
CONFIG_ST_EXTRA_DEVS=0
CONFIG_BLK_DEV_SR=m
CONFIG_BLK_DEV_SR_VENDOR=y
CONFIG_SR_EXTRA_DEVS=2
CONFIG_CHR_DEV_SG=m
CONFIG_NETDEVICES=y
CONFIG_DUMMY=m
CONFIG_NET_ETHERNET=y
CONFIG_NET_EISA=y
CONFIG_VIA_RHINE=m
CONFIG_PPP=m
CONFIG_PPP_ASYNC=m
CONFIG_PPP_SYNC_TTY=m
CONFIG_PPP_DEFLATE=m
CONFIG_PPP_BSDCOMP=m
CONFIG_VT=y
CONFIG_VT_CONSOLE=y
CONFIG_SERIAL=y
CONFIG_UNIX98_PTYS=y
CONFIG_UNIX98_PTY_COUNT=256
CONFIG_PRINTER=m
CONFIG_MOUSE=y
CONFIG_PSMOUSE=y
CONFIG_JOYSTICK=m
CONFIG_JOY_ANALOG=m
CONFIG_NVRAM=m
CONFIG_RTC=y
CONFIG_DRM=y
CONFIG_AGP=y
CONFIG_AGP_VIA=y
CONFIG_USB=m
CONFIG_USB_UHCI=m
CONFIG_USB_UHCI_ALT=m
CONFIG_USB_PRINTER=m
CONFIG_USB_SCANNER=m
CONFIG_USB_AUDIO=m
CONFIG_USB_ACM=m
CONFIG_USB_SERIAL=m
CONFIG_USB_CPIA=m
CONFIG_USB_IBMCAM=m
CONFIG_USB_OV511=m
CONFIG_USB_DC2XX=m
CONFIG_USB_STORAGE=m
CONFIG_USB_USS720=m
CONFIG_USB_DABUSB=m
CONFIG_USB_HID=m
CONFIG_USB_KBD=m
CONFIG_USB_MOUSE=m
CONFIG_USB_GRAPHIRE=m
CONFIG_USB_WMFORCE=m
CONFIG_INPUT_KEYBDEV=m
CONFIG_INPUT_MOUSEDEV=m
CONFIG_INPUT_JOYDEV=m
CONFIG_INPUT_EVDEV=m
CONFIG_QUOTA=y
CONFIG_AUTOFS4_FS=y
CONFIG_FAT_FS=m
CONFIG_MSDOS_FS=m
CONFIG_VFAT_FS=m
CONFIG_ISO9660_FS=y
CONFIG_JOLIET=y
CONFIG_PROC_FS=y
CONFIG_DEVPTS_FS=y
CONFIG_EXT2_FS=y
CONFIG_UDF_FS=m
CONFIG_NFS_FS=y
CONFIG_NFSD=y
CONFIG_SUNRPC=y
CONFIG_LOCKD=y
CONFIG_SMB_FS=m
CONFIG_MSDOS_PARTITION=y
CONFIG_NLS=y
CONFIG_NLS_CODEPAGE_437=m
CONFIG_NLS_CODEPAGE_863=m
CONFIG_NLS_ISO8859_1=m
CONFIG_VGA_CONSOLE=y
CONFIG_VIDEO_SELECT=y
CONFIG_SOUND=m
CONFIG_SOUND_OSS=m
CONFIG_SOUND_VMIDI=m
CONFIG_SOUND_SB=m
CONFIG_SOUND_YM3812=m
CONFIG_MAGIC_SYSRQ=y
---<snip>---
Since agpgart is the last thing loaded before getting this segfault, I
completely turned off AGP, including DRI. Now it boots, but I can't load
any module: I get such a segfault too, this type, this one is taken
directly from my /var/log/messages:
---<snip>---
Feb 11 20:56:35 inso kernel: general protection fault: 0000
Feb 11 20:56:35 inso kernel: CPU:    0
Feb 11 20:56:35 inso kernel: EIP:    0010:[vmalloc_area_pages+785/808]
Feb 11 20:56:35 inso kernel: EFLAGS: 00010202
Feb 11 20:56:35 inso kernel: eax: 05bc2000   ebx: 0123e063   ecx: 001a2f94
edx: 00000010
Feb 11 20:56:35 inso kernel: esi: c123e044   edi: 00400000   ebp: c0101c84
esp: c60cbf58
Feb 11 20:56:35 inso kernel: ds: 0018   es: 0018   ss: 0018
Feb 11 20:56:35 inso kernel: Process insmod (pid: 1009,
stackpage=c60cb000)
Feb 11 20:56:35 inso kernel: Stack: c8010000 00001000 c1213850 c7d10000
06295000 00000000 75ac0000 00000163
Feb 11 20:56:35 inso kernel:        00011000 00011000 0123e063 c8011000
c0101c84 c0126371 c8400000 00001000
Feb 11 20:56:35 inso kernel:        00000009 00000c44 c01184ba 00000c44
c60ca000 40106fe0 00000c44 bfffeaa8
Feb 11 20:56:35 inso kernel: Call Trace: [<c8010000>] [<c8011000>]
[swapper_pg_dir+3204/4096] [vmalloc+113/168] [<c8400000>]
[sys_create_module+362/588] [system_call+52/56]
Feb 11 20:56:35 inso kernel: Code: 0f 22 e0 eb 08 89 f6 0f 20 d8 0f 22 d8
31 c0 5b 5e 5f 5d 83
---<snip>---
I get that on any module that has no dependancy, like soundcore or
parport; those that have dependancies will only display the usual
unresolved symbols errors.
Notice that the executed Code that is responsible of the error is the same
sequence -- so that may hint that it's possible to reproduce the segfault
on other machines.
Tell me how the Call Trace works, but I think that c8010000 is the address
of the last called function, and the latest one with a symbol within is
swapper_pg_dir --> could this mean a incompatibility with the swapper
(inside the kernel) and another module? memory corruption? I haven't
investigated that a lot.
I used egcs-1.1.2 to compile the kernel. System runs RH6.1 w/ K6-2/450 and
a VIA MVP3 mobo.
A little side-note: I have no use for the AGP and DRI drivers; I'm
compiling them to be ready once nVidia releases their long-awaited high
performance drivers, and for the moment XFree86 4 comes out. I also have
no USB peripheral; I'm compiling them all to see if it still compiles fine
(2.3.39-41, I think, had one module that wouldn't compile at all. It's
fixed now).
I hope it can help.
- JL
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.rutgers.edu
Please read the FAQ at 
http://www.tux.org/lkml/