Date: Sat, 16 Jan 1999 14:21:34 +0000
From: "Manuel J. Galan" <>
Subject: Re: Linux 2.2.0pre7ac2
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/1999/1/16/71

Zlatko Calusic wrote:
> 
> alan@lxorguk.ukuu.org.uk (Alan Cox) writes:
> 
> > > > o       de4x5 should compile ok now
> > > [...]
> > >
> > > Yes, it compiles but the changes in asm/string.h make it oops
> > > on first use. (using both gcc and egcs as per RH52 std.)
> >
> > Ok. de4x5 will just have to stay not compiling with some egcs for 2.2.0,
> > sorry people.
> >
> 
> I can't believe it.
> 
> It was recently that de4x5 got fixed (wrt egcs) and now we have
> problems again. How's that happened?
> --
> Zlatko
There was a new patch for asm-i386/string.h proposed in the list
that was changing the last "g" operator with a "b" operator. I've
checked it and seems to work OK with both gcc and egcs...
OTOS I think that it is too a big fuss for such a little issue: strstr 
does not seem to be a performance critical function anyway...I have used
the C library version and I have not appreciated any performance loss.diff -u --recursive --new-file v2.2.0-pre7/linux/include/asm-i386/string.h linux/include/asm-i386/string.h
--- v2.2.0-pre7/linux/include/asm-i386/string.h	Thu Dec 31 10:29:02 1998
+++ linux/include/asm-i386/string.h	Thu Jan 14 10:31:41 1999
@@ -213,7 +213,7 @@
 	"jne 1b\n\t"
 	"xorl %%eax,%%eax\n\t"
 	"2:"
-	:"=a" (__res), "=&c" (d0), "=&S" (d1), "=&d" (d2), "=&D" (d3) : "0" (0),"1" (0xffffffff),"2" (cs),"g" (ct));
+	:"=a" (__res), "=&c" (d0), "=&S" (d1), "=&d" (d2), "=&D" (d3) : "0" (0),"1" (0xffffffff),"2" (cs),"b" (ct));
 return __res;
 }
 