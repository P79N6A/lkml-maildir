Date: Sun, 22 Oct 2000 11:49:47 +1100
From: Andrew Morton <>
Subject: Re: lowish-lat for 2.4.0-test10-pre3
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2000/10/21/78

Andi Kleen wrote:
> 
> On Sun, Oct 22, 2000 at 12:58:00AM +1100, Andrew Morton wrote:
> >  reschedule:
> > +     sti
> >       call SYMBOL_NAME(schedule)    # test
> 
> The sti can be removed because one of the first things schedule() does is a
> sti [forgot to mention that earlier]
Yup.  But it's the rare path and I was being paranoid :)
schedule() actually does *two* sti's.  One is
open-coded in the tq scheduler code and the other
is subtly buried inside release_kernel_lock().  It should
be hoisted right up to the start of the function.
BTW: regarding this comment:
>  On the Mendocino the `cli' adds ~15 cycles to system calls.  The
>  cunning removal of a conditional jump from the syscall and interrupt
>  fastpath reduces this to 13 cycles.
>
>  So `getpid()' now takes 1.005x as long as it used to.  So shoot me.
The arithmetic was wrong.  22nSec on 530nSec is 1.04x.
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.kernel.org
Please read the FAQ at 
http://www.tux.org/lkml/