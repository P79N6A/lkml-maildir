Date: Fri, 12 Oct 2001 12:09:49 -0700
From: "Jean-Gabriel Rican" <>
Subject: Re: [PATCH] for Multiple Device driver - md.c (kernel 2.4.12)
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2001/10/12/125

Ingo,
Yes you are right: raidhotadd does the job and I cannot believe that I
wasn't considering it myself. Probably I was so focused on the process of
adding a hot spare that I forgot to try this.
It looks that my patch isn't necessary required after all. The only
advantage that it offers is that it saves a raidhotremove call (and the test
to see if the drive is really faulty or still present in the RAID array -
because raidhotadd will fail in this case), but in rest it seems to be
rather equivalent.
Anyway, thank you for the solution and I hope that I didn't caused any
inconvenience.
Jean-Gabriel Rican
>
> > Suppose you can hot-swap a hard disk in a system. Now if you have a
> > degraded Software RAID device (for example a RAID-5 with one disk
> > failed) and you replace the failed disk on-the-fly you cannot start
> > reconstruction (with raidhotadd) of the Software RAID device with the
> > replaced disk because it says it is BUSY.
>
> this is possible already: you should first raidhotremove the failed drive,
> then raidhotadd the new drive. It can be the 'same' drive if it's a
> hot-swap disk, or it can be another, spare disk.
>
> > + if (rdev && rdev->faulty) {
> > + err = hot_remove_disk(mddev, dev);
>
> what your patch does is a forced remove of any drive that is
> raidhotadd-ed. This is less finegrained than the current solution, and
> might make the method more volatile. (easier to mess up accidentally.) Is
> there anything your patch allows that is not possible today, via
> raidhotremove+raidhotadd?
>
> Ingo
>
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.kernel.org
More majordomo info at  
http://vger.kernel.org/majordomo-info.html
Please read the FAQ at  
http://www.tux.org/lkml/