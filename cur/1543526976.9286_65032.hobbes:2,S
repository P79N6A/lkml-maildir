Date: Tue, 22 Feb 2000 19:43:44 +0100
From: Q <>
Subject: fork: out of memory
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2000/2/22/145

When I'm trying something, I connect as many as possible times from 1
process to an other, both on localhost. After a few connections the
systems becomes totaly unuseable. I then get fork: out of memory, whenever
I try to do anything. At that time I still use about 15 MB as cache, and
about 300 KB as buffer. I have a total of 64 MB RAM.
I started this when the box was up about 20 hour, and was playing mp3's
during that time. I was only able to get 20 connections then. When I
stopped playing mp3's I was able to get a max of about 200 connections,
which means a total of 400 (2 processes connected to each other).
After a reboot, it connected alot faster, and I was able to have 500
(1000) connections, and everything still worked fine then. If I
disconnected them, and connected them again, I still was able to get 500
connections, but during the period it was connecting, I got the out of
memory error, after that it worked fine again.
The program that tries to connect, opens 1000 connections, and then writes
to those 1000 in a for loop, it doesn't check return value's. It also 
reads all what the other program is sending, which doesn't check return
value either. So, I never close the socket's until the program exist. 
Starting an other program that also tries those 1000 connections, doesn't
give me a more total connections either.
I have a feeling there is some memory loss somewhere...
And why am I only able to have 500 connections? With 2.3.42 I was still
able to get 750, now (2.3.46) is stops at 500. Shouldn't I be able to have
atleast 1000 connections to it, or does it just take too much RAM? Why
isn't it using that cache memory?
Q
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.rutgers.edu
Please read the FAQ at 
http://www.tux.org/lkml/