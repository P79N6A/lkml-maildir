Date: Sat, 9 Sep 2000 02:20:12 -0700 (PDT)
From: Andre Hedrick <>
Subject: Re: Notebook disk spindown
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2000/9/9/71

On Sat, 9 Sep 2000, Russell King wrote:
> Andre Hedrick writes:
> > You know that it would take me 25 minutes or less to fix the code if I had
> > a full native taskfile.  This would allow a (void *)(void) to be set in
> > kernel apmd and have all the drive data and callouts.
> 
> Andre,
> 
> I totally fail to see how taskfile will fix the problem of apmd not
> allowing my laptop to automatically suspend or hibernate.
I did to until I asked somebody, then thought about it, read some more,
and requestioned the notion, and then it seemed reasonable.
If apmd could issue a WIN_STANDBY value and execute WIN_STANDBYNOW1 then
the drive would know the thresholds to attempt a "suspend".  Where as an
issue of WIN_SLEEPNOW1 would "hibernate" the drive.
> Please explain how the ability to suspend/hibernate, which seems to
> be dependent on apmd has to do with whether or not the kernel
> provides taskfile, which apmd would not use.
If there were callable ioctl's or callout functions, apmd could actively
control suspend/hibernate and apm-drive power thresholds to increase
battery runtime.  At least this was the intent of the additions set
forward by the drive guys, as explained to me.
> Please, for your own sake, think about the problem being discussed
> before posting "taskfile would fix that" comments.
I have and offered it to the folks at linuxcare the apmd guys.
The ideas were to create an ioctl pair that would/could knock-out a drive
and preserve the settings, because the reset command to wake it up flushes
the settings.  Thus after the wakeup reset, and a checkpower-loop for
ready-status in a passive drive query, the completion of the command would
set the drive and host back to pre- suspend/hibernate mode.
This in combination of the bios telling apmd to do something, apmd now can
parallel the bios if there is a problem and correct if possible.
Once I get my laptop, I will verify this and send you the results.
Now if I missed the initial point, I apologize.
Cheers,
Andre Hedrick
The Linux ATA/IDE guy
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.kernel.org
Please read the FAQ at 
http://www.tux.org/lkml/