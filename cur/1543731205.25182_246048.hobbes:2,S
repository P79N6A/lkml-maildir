Date: Fri, 27 Aug 2004 01:49:32 -0700
From: Joshua Kwan <>
Subject: [PATCH 2.6] disambiguate esp.c clones
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2004/8/27/22

Hello,
Debian's initial ramdisk creation scripts rely on the content of
/proc/scsi to determine which module is needed for the ramdisk.
Unfortunately, bad things happen when a bazillion different drivers
use the _exact same name_ for /proc, namely the esp family.
Is it wrong to give them all unique names? Here's a patch against
2.6.8.1 which does so. Of course, there may be *some* crackheaded
reason that they should all contain the same name...
Thanks
-- 
Joshua Kwan
--- kernel-source-2.6.8/drivers/scsi/mca_53c9x.c~	2004-08-27 01:40:00.000000000 -0700
+++ kernel-source-2.6.8/drivers/scsi/mca_53c9x.c	2004-08-27 01:40:02.000000000 -0700
@@ -445,7 +445,7 @@
 }
 
 static Scsi_Host_Template driver_template = {
-	.proc_name		= "esp",
+	.proc_name		= "mca_53c9x",
 	.name			= "NCR 53c9x SCSI",
 	.detect			= mca_esp_detect,
 	.slave_alloc		= esp_slave_alloc,
--- kernel-source-2.6.8/drivers/scsi/jazz_esp.c~	2004-08-27 01:40:35.000000000 -0700
+++ kernel-source-2.6.8/drivers/scsi/jazz_esp.c	2004-08-27 01:41:06.000000000 -0700
@@ -286,7 +286,7 @@
 }
 
 static Scsi_Host_Template driver_template = {
-	.proc_name		= "esp",
+	.proc_name		= "jazz_esp",
 	.proc_info		= &esp_proc_info,
 	.name			= "ESP 100/100a/200",
 	.detect			= jazz_esp_detect,
--- kernel-source-2.6.8/drivers/scsi/mac_esp.c~	2004-08-27 01:41:22.000000000 -0700
+++ kernel-source-2.6.8/drivers/scsi/mac_esp.c	2004-08-27 01:41:27.000000000 -0700
@@ -731,7 +731,7 @@
 }
 
 static Scsi_Host_Template driver_template = {
-	.proc_name		= "esp",
+	.proc_name		= "mac_esp",
 	.name			= "Mac 53C9x SCSI",
 	.detect			= mac_esp_detect,
 	.slave_alloc		= esp_slave_alloc,
--- kernel-source-2.6.8/drivers/scsi/dec_esp.c~	2004-08-27 01:42:06.000000000 -0700
+++ kernel-source-2.6.8/drivers/scsi/dec_esp.c	2004-08-27 01:42:08.000000000 -0700
@@ -120,7 +120,7 @@
 }
 
 static Scsi_Host_Template driver_template = {
-	.proc_name		= "esp",
+	.proc_name		= "dec_esp",
 	.proc_info		= &esp_proc_info,
 	.name			= "NCR53C94",
 	.detect			= dec_esp_detect,
--- kernel-source-2.6.8/drivers/scsi/sun3x_esp.c~	2004-08-27 01:46:32.000000000 -0700
+++ kernel-source-2.6.8/drivers/scsi/sun3x_esp.c	2004-08-27 01:46:36.000000000 -0700
@@ -370,7 +370,7 @@
 }
 
 static Scsi_Host_Template driver_template = {
-	.proc_name		= "esp",
+	.proc_name		= "sun3x_esp",
 	.proc_info		= &esp_proc_info,
 	.name			= "Sun ESP 100/100a/200",
 	.detect			= sun3x_esp_detect,[unhandled content-type:application/pgp-signature]