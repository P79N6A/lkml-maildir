Date: Fri, 22 Jun 2007 18:25:18 +0900
From: Mattia Dongili <>
Subject: Re: can't suspend on vaio sz (rc4 and rc5 are ok) [was Re: 2.6.22-rc4-mm2]
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2007/6/22/97

On Thu, Jun 21, 2007 at 11:49:37PM +0200, Rafael J. Wysocki wrote:
> On Thursday, 21 June 2007 21:39, Alan Stern wrote:
> > On Thu, 21 Jun 2007, Rafael J. Wysocki wrote:
> > 
> > > > I'll see if I can reproduce your problem here.
> > > 
> > > Yes, I can.  It's only necessary to load usb-storage (without any devices
> > > actually using it) and it fails device_suspend() immediately (I don't think
> > > it's freezer-related).
> > > 
> > > I've got the following trace from it:
> > > 
> > > usb_endpoint usbdev3.2_ep81: PM: suspend 0->1, parent 3-1:1.0 already 2
> > > Suspending device 3-1:1.0
> > > Suspending device usbdev3.2_ep00
> > > Suspending device 3-1
> > > Suspending device eth1
> > > Suspending device eth0
> > > Suspending device usbdev3.1
> > > Suspending device usbdev3.1_ep81
> > > Suspending device 3-0:1.0
> > > Suspending device usbdev3.1_ep00
> > > Suspending device usb3
> > > hub 3-0:1.0: hub_suspend
> > > ohci_hcd 0000:00:02.1: needs reinit!
> > > usb usb3: suspend fail, err -16
> > > usb usb3: 'global' suspend -16
> > > hub 3-0:1.0: hub_resume
> > > hub 3-0:1.0: activate --> -108
> > > suspend_device(): usb_suspend+0x0/0x30() returns -16
> > > Could not suspend device usb3: error -16
> > > WARNING: at /home/rafael/src/mm/linux-2.6.22-rc4-mm2/drivers/usb/core/urb.c:293 usb_submit_urb()
> > 
> > Well, a large part of the problem is that
> > 
> > 	usb-try-to-debug-bug-8561.patch
> > 
> > hasn't been reverted in 2.6.22-rc4-mm2.
> 
> Yes, the problem is not present after reverting this patch.
Not for me, I had that patch already reverted. As I said there was a
point when bisecting which the kernel came back to life instead of just
hanging trying to suspend.
I'll try to get a trace with that. May the usb_storage verbose debug
help there?
-- 
mattia
:wq!
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.kernel.org
More majordomo info at  
http://vger.kernel.org/majordomo-info.html
Please read the FAQ at  
http://www.tux.org/lkml/