Date: Sat, 10 Sep 2005 23:55:25 +0900
From: Akinobu Mita <>
Subject: Re: [PATCH 0/6] jbd cleanup
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2005/9/10/95

On Fri, Sep 09, 2005 at 02:15:22AM -0700, Andrew Morton wrote:
> Akinobu Mita <mita@miraclelinux.com> wrote:
> >
> > The following 6 patches cleanup the jbd code and kill about 200 lines. 
> >
> 
> Thanks, but I'm not inclined to apply them.
> 
> a) Maybe 70-80% of the Linux world uses this filesystem.  We need to be
>    very cautious in making changes to it.
And we need many eyeballs.
(I've tried to understand how the jbd works several times.
 But I always failed.)
> b) A relatively large number of people are carrying quite large
>    out-of-tree patches, some of which they're hoping to merge sometime. 
>    Admittedly more against ext3 than JBD, but there is potential here to
>    cause those people trouble.
> 
> Plus the switch to list_heads in journal_s has some impact on type safety
> and debuggability - I considered doing it years ago but decided not to
> because I found I _used_ those pointers fairly commonly in development. 
> list_heads are a bit of a pain in gdb (kgdb and kernel core dumps), for
> example.
About the debuggability of list_heads, how about adding the kind of
the following gdb macros in .gdbinit?
---
define list_entry
	set $ptr=$arg0
	p ($arg1 *)((char *)$ptr - (size_t) &(($arg1 *)0)->$arg2)
end
define list_entry_s
	set $ptr=$arg0
	p (struct $arg1 *)((char *)$ptr - (size_t) &((struct $arg1 *)0)->$arg2)
end
define to_journal_head
	list_entry_s $arg0 journal_head b_list
end
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.kernel.org
More majordomo info at  
http://vger.kernel.org/majordomo-info.html
Please read the FAQ at  
http://www.tux.org/lkml/