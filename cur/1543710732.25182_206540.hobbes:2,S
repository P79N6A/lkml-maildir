Date: Mon, 15 Mar 2004 12:28:19 -0500
From: "chas williams (contractor)" <>
Subject: Re: [Linux-ATM-General] NICSTAR_USE_SUNI broken in 2.6.3+
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2004/3/15/110

In message <Pine.LNX.4.30.0403131045040.3568-100000@swamp.bayern.net>,Peter Dau
m writes:
>I have a bunch of machines with Forerunner LE ATM NICs.
>Starting with kernel version 2.6.3 the kernel crashes at
>boot time (see dump below) when CONFIG_ATM_NICSTAR_USE_SUNI
>
>EIP; c0252650 <suni_start+35/17d>   <=====
this points directly to suni.c:236, in particular the PRIV(dev)->dev
bit.  it looks like gcc3 fixups from akpm inadvertently converted PRIV()
to dev_data instead of phy_data.
the following patch should get things running again.
dave, can you apply to 2.6?  thanks!
# This is a BitKeeper generated patch for the following project:
# Project Name: Linux kernel tree
# This patch format is intended for GNU patch command version 2.5 or higher.
# This patch includes the following deltas:
#	           ChangeSet	1.1603  -> 1.1604 
#	  drivers/atm/suni.c	1.9     -> 1.10   
#
# The following is the BitKeeper ChangeSet Log
# --------------------------------------------
# 04/03/15	chas@relax.cmf.nrl.navy.mil	1.1604
# [ATM]: [suni] dev_data should really by phy_data
# --------------------------------------------
#
diff -Nru a/drivers/atm/suni.c b/drivers/atm/suni.c
--- a/drivers/atm/suni.c	Mon Mar 15 12:23:09 2004
+++ b/drivers/atm/suni.c	Mon Mar 15 12:23:09 2004
@@ -230,7 +230,7 @@
 	unsigned long flags;
 	int first;
 
-	if (!(dev->dev_data = kmalloc(sizeof(struct suni_priv),GFP_KERNEL)))
+	if (!(dev->phy_data = kmalloc(sizeof(struct suni_priv),GFP_KERNEL)))
 		return -ENOMEM;
 
 	PRIV(dev)->dev = dev;
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.kernel.org
More majordomo info at  
http://vger.kernel.org/majordomo-info.html
Please read the FAQ at  
http://www.tux.org/lkml/