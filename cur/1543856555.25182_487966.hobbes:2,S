Date: Mon, 04 Dec 2006 00:57:50 -0500
From: Wendy Cheng <>
Subject: Re: [PATCH] prune_icache_sb
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2006/12/4/10

Andrew Morton wrote:
>On Sun, 03 Dec 2006 12:49:42 -0500
>Wendy Cheng <wcheng@redhat.com> wrote:
>
> 
>
>>I read this as "It is ok to give system admin(s) commands (that this 
>>"drop_pagecache_sb() call" is all about) to drop page cache. It is, 
>>however, not ok to give filesystem developer(s) this very same function 
>>to trim their own page cache if the filesystems choose to do so" ?
>> 
>>
>
>If you're referring to /proc/sys/vm/drop_pagecache then no, that isn't for
>administrators - it's a convenience thing for developers, to get repeatable
>benchmarks.  Attempts to make it a per-numa-node control for admin purposes have
>been rejected.
> 
>
Just saw you suggested the "next door" LKML thread ("la la la la ... 
swappiness") to use "-o sync" ? Well, now I do see you're determined ... 
anyway, I think I got my stuff working without this kernel patch ... 
still under testing though.
The rename post will be done first thing tomorrow morning.
>>[snip] .......
>> 
>>
>hmm, I suppose that makes sense.
>
>Are there dentries associated with these locks?
> 
>
Yes, dentries are part of the logic (during lookup time) but 
book-keepings (reference count, reclaim, delete, etc) are all done thru 
inode structures.
> 
>
>>>Did you look at improving that lock-lookup algorithm, btw?  Core kernel has
>>>no problem maintaining millions of cached VFS objects - is there any reason
>>>why your lock lookup cannot be similarly efficient?
>>> 
>>> 
>>>
Yes, just found the new DLM uses "jhash" call (include/linux/jhash.h). 
I'm on an older version of DLM that uses FNV hash algorithm 
(
http://www.isthe.com/chongo/tech/comp/fnv/
). Will do some performance 
test runs to compare these two methods.
A final note on this subject - I may not agree with you (about various 
things) but your comments and amazingly quick responses are very very 
appreciated !
-- Wendy
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.kernel.org
More majordomo info at  
http://vger.kernel.org/majordomo-info.html
Please read the FAQ at  
http://www.tux.org/lkml/