Date: Mon, 10 Mar 2008 21:51:17 +0000
From: Alan Cox <>
Subject: [PATCH] istallion: TIOCG/SSOFTCAR handling removal
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2008/3/10/317

This is handled (and correctly) by the core code so does not belong
incorrectly in the driver.
Signed-off-by: Alan Cox <alan@redhat.com>
diff -u --new-file --recursive --exclude-from /usr/src/exclude linux.vanilla-2.6.25-rc3-mm1/drivers/char/istallion.c linux-2.6.25-rc3-mm1/drivers/char/istallion.c
--- linux.vanilla-2.6.25-rc3-mm1/drivers/char/istallion.c	2008-03-10 12:57:52.000000000 +0000
+++ linux-2.6.25-rc3-mm1/drivers/char/istallion.c	2008-03-10 13:19:38.000000000 +0000
@@ -1682,16 +1682,6 @@
 	rc = 0;
 
 	switch (cmd) {
-	case TIOCGSOFTCAR:
-		rc = put_user(((tty->termios->c_cflag & CLOCAL) ? 1 : 0),
-			(unsigned __user *) arg);
-		break;
-	case TIOCSSOFTCAR:
-		if ((rc = get_user(ival, (unsigned __user *) arg)) == 0)
-			tty->termios->c_cflag =
-				(tty->termios->c_cflag & ~CLOCAL) |
-				(ival ? CLOCAL : 0);
-		break;
 	case TIOCGSERIAL:
 		rc = stli_getserial(portp, argp);
 		break;