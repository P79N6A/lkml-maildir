Date: Sun, 14 Nov 2004 09:18:00 +0100
From: Manfred Spraul <>
Subject: Re: [PATCH] __init in mm/slab.c
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2004/11/14/14

 From the bk commit log:
>ChangeSet 1.2132, 2004/11/13 20:59:55-08:00, Andries.Brouwer@cwi.nl
>
>	[PATCH] __init in mm/slab.c
>
>	The below removes an __initdata
>	(for initarray_generic that is referenced in non-init code).
> 
>
I think the patch is wrong and should be reverted: initarray_generic is 
referenced, but never used:
> if (g_cpucache_up == NONE) {
>         /* Note: the first kmem_cache_create must create
>          * the cache that's used by kmalloc(24), otherwise
>          * the creation of further caches will BUG().
>          */
>         cachep->array[smp_processor_id()] = &initarray_generic.cache;
>         g_cpucache_up = PARTIAL;
> } else {
>         cachep->array[smp_processor_id()] = kmalloc(sizeof(struct 
> arraycache_init),GFP_KERNEL);
> }
g_cpucache_up is NONE during bootstrap and FULL after boot. Thus the 
initarray is never accessed after boot.
Andries, why did you propose this change? Does the current code trigger 
an automatic test?
--
    Manfred
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.kernel.org
More majordomo info at  
http://vger.kernel.org/majordomo-info.html
Please read the FAQ at  
http://www.tux.org/lkml/