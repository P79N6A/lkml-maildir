Date: Thu, 18 Oct 2001 12:39:09 +0200 (MEST)
From: Enver Haase <>
Subject: Bug in request_irq() ?
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2001/10/18/47

Hi developers,
I have some NetMos card here: 2 parallel ports, PCI.
This card is somewhat funny. I believe it fires interrupts for nothing: I
cannot boot Win98 when the Lexmark 4039 is turned on which is connected to
one of the ports (it crashes).
Back to Linux (2.4.12, "ECP symbol name patch"):
When I configure the card to share the IRQ line with the NE2000 PCI
clone, then the machine hangs as soon as the card is "ifconfig"ed.
When I configure the card to share the IRQ line with the onboard USB, then
the machine hangs as soon as the USB driver is initialized.
When I configure the card to be have an own un-shared interrupt line, and
let the NE2000clone and USB share a line, all works well.
Remember, there is no registered interrupt driver for PCI parallel port
cards. I suspect request_irq() has a problem when a device wants to 
get an IRQ sharing it with a device that fires interrupts but has no own
driver.
A work-around could be disabling interrupts in the parallel port driver,
but that would mean it has to be initialized before all the other devices
sharing the IRQ --- which is prone to errors.
This is all based on more observation than code-reading so there might be
a better explanation: only I don't know it, yet.
Greetings,
Enver
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.kernel.org
More majordomo info at  
http://vger.kernel.org/majordomo-info.html
Please read the FAQ at  
http://www.tux.org/lkml/