Date: Sat, 02 Feb 2002 17:07:10 +0100
From: Roman Zippel <>
Subject: Re: [PATCH] syscall latency improvement #1 (253p6)
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2002/2/2/12

Hi,
David Howells wrote:
> +/* this struct must occupy one 32-bit chunk so that is can be read in one go */
> +struct task_work {
> +       __s8    need_resched;
> +       __u8    syscall_trace;  /* count of syscall interceptors */
> +       __u8    sigpending;
> +       __u8    notify_resume;  /* request for notification on
> +                                  userspace execution resumption */
> +} __attribute__((packed));
> +
Did you test whether single stepping over a single syscall works? From
reading the patch/source I can't see how it should, but I haven't tested
it yet. The problem is that syscall tracing is only important at syscall
entry. At syscall exit we have to check whether single stepping is
active. These are two different operations, but I only see two tests
against syscall_trace.
BTW it doesn't work with 2.4, but there is no test for PT_DTRACE at all,
so it's not really surprising.
Second, could we move above structure into e.g. <asm/processor.h>? This
would allow architectures to reorder the bytes, as above is obviously
optimized for little endian machines.
bye, Roman
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.kernel.org
More majordomo info at  
http://vger.kernel.org/majordomo-info.html
Please read the FAQ at  
http://www.tux.org/lkml/