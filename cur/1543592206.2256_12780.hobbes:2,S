Date: Thu, 24 May 2001 15:51:38 +0200
From: Erik Mouw <>
Subject: [PATCH] Minor cleanup in drivers/net/pcmcia/Makefile
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2001/5/24/63

Hi,
Because make can't track intermediate targets made in a rule, the
ibmtr_cs drivers was rebuild every time you run "make modules". This
patch fixes that by making the intermediate files explicit rules in the
Makefile. Patch is against linux-2.4.5-pre5, but should apply cleanly
against other kernel versions as well. Please apply.
Erik
--- drivers/net/pcmcia/Makefile.orig	Thu May 24 15:33:26 2001
+++ drivers/net/pcmcia/Makefile	Thu May 24 15:35:53 2001
@@ -38,8 +38,10 @@
 include $(TOPDIR)/Rules.make
 
 tmp-ibmtr.o: ../tokenring/ibmtr.c
-	$(CC) $(CFLAGS) -D__NO_VERSION__ -DPCMCIA -c -o $@ ../tokenring/ibmtr.c
+	$(CC) $(CFLAGS) -D__NO_VERSION__ -DPCMCIA -c -o $@ $<
 
-ibmtr_cs.o: tmp-ibmtr.o ibmtr_cs.c
-	$(CC) $(CFLAGS) -DPCMCIA -c -o tmp-$@ ibmtr_cs.c
-	$(LD) -r -o $@ tmp-$@ tmp-ibmtr.o
+tmp-ibmtr_cs.o: ibmtr_cs.c
+	$(CC) $(CFLAGS) -DPCMCIA -c -o $@ $<
+
+ibmtr_cs.o: tmp-ibmtr.o tmp-ibmtr_cs.o
+	$(LD) -r -o $@ tmp-ibmtr_cs.o tmp-ibmtr.o
-- 
J.A.K. (Erik) Mouw, Information and Communication Theory Group, Department
of Electrical Engineering, Faculty of Information Technology and Systems,
Delft University of Technology, PO BOX 5031,  2600 GA Delft, The Netherlands
Phone: +31-15-2783635  Fax: +31-15-2781843  Email: J.A.K.Mouw@its.tudelft.nl
WWW: 
http://www-ict.its.tudelft.nl/~erik/
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.kernel.org
More majordomo info at  
http://vger.kernel.org/majordomo-info.html
Please read the FAQ at  
http://www.tux.org/lkml/