Date: Sun, 7 Jan 2001 13:55:15 +0000 (GMT)
From: Alan Cox <>
Subject: Re: ftruncate returning EPERM on vfat filesystem
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2001/1/7/57

> +
> +       /* FAT cannot truncate to a longer file */
> +       if (attr->ia_valid & ATTR_SIZE) {
> +               if (attr->ia_size > inode->i_size)
> +                       return -EPERM;
> +       }
> 
>         error = inode_change_ok(inode, attr);
>         if (error)
> 
> Can someone tell me if this is the cause of my samba problems, and if
> so, why this was added and if this is safe to revert?
To stop a case where the fs gets corrupted otherwise. You can change that to
return 0 which is more correct but most not remove it.
(ftruncate is specified to make the file at most length bytes long, extending
the file is not a guaranteed side effect according to the docs I have)
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.kernel.org
Please read the FAQ at 
http://www.tux.org/lkml/