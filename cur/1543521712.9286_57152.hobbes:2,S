Date: Tue, 11 Jan 2000 15:32:12 -0800 (PST)
From: David Dyck <>
Subject: 2.3.39 doesn't build xconfig or menuconfig (libc5 / old_uid_t?)
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2000/1/12/68

When I attempt 
  make xconfig
I get the error
  /usr/include/linux/types.h:35: parse error before `old_uid_t'
A simple one line program (uidt.c)
  #include <signal.h>
also gets errors with respect to old_uid_t
  /usr/include/asm/siginfo.h:27: parse error before `old_uid_t'
dd:dcd$ gcc -M uidt.c
uidt.o: uidt.c /usr/include/signal.h /usr/include/features.h \
 /usr/include/sys/cdefs.h /usr/include/sys/types.h \
 /usr/include/linux/types.h /usr/include/linux/posix_types.h \
 /usr/include/asm/posix_types.h /usr/include/asm/types.h \
 /usr/include/sys/bitypes.h /usr/include/linux/signal.h \
 /usr/include/asm/signal.h /usr/include/asm/siginfo.h
My links are set up to point to the kernel sources
    /usr/include/asm -> /usr/src/linux/include/asm-i386/
    /usr/include/linux -> /usr/src/linux/include/linux/
If I modify  /usr/include/asm/posix_types.h
to unconditionally 'export' the following 2 typedef lines (near line 32)
typedef unsigned short  __kernel_old_uid_t;
typedef unsigned short  __kernel_old_gid_t;
Here's a patch
--- linux/include/asm-i386/posix_types.h-	Tue Jan 11 13:05:12 2000
+++ linux/include/asm-i386/posix_types.h	Tue Jan 11 13:05:45 2000
@@ -31,9 +31,9 @@
 
 #ifdef __KERNEL__
 #define UID16_COMPAT_NEEDED
+#endif /* __KERNEL__ */
 typedef unsigned short	__kernel_old_uid_t;
 typedef unsigned short	__kernel_old_gid_t;
-#endif /* __KERNEL__ */
 
 #ifdef __GNUC__
 typedef long long	__kernel_loff_t;
I'm not convinced that this is the 'right' thing to do, but at least
the kernel and user applications compile.
   (Currently I've tweeked something, so I'm getting an oops in 2.3.39
    when I go multi user but I'm not quite ready to submit that)
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.rutgers.edu
Please read the FAQ at 
http://www.tux.org/lkml/