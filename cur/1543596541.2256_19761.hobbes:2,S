Date: 06 Jul 2001 09:42:29 +0300
From: Ville Nummela <>
Subject: tasklets in 2.4.6
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2001/7/6/17

Hi,
I have little question about tasklets in the kernel 2.4.6:
In kernel/softirq.c, line 178:
                if (test_bit(TASKLET_STATE_SCHED, &t->state))
                        tasklet_schedule(t);
What's the idea behind this line? If the tasklet is already scheduled,
schedule it again? This does not make much sense to me.
Also, few lines before:
                       if (test_bit(TASKLET_STATE_SCHED, &t->state))
                                goto repeat;
Here we'll loop forever if the tasklet should schedule itself.
So if the tasklet schedules itself we'll loop it forever, and if it doesn't
it'll get never run again.
If we'd change the line 178 to:
                if (!test_bit(TASKLET_STATE_SCHED, &t->state))
the tasklet would get scheduled if it was NOT scheduled, and everything would
go on happily forever :)
But anyway, I'm probably missing something here, perhaps someone could educate
me a bit ;-)
-- 
 |   ville.nummela@necsom.com tel: +358-40-8480344               
 |   So Linus, what are we doing tonight?                             
 |   The same thing we every night Tux. Try to take over the world!   
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.kernel.org
More majordomo info at  
http://vger.kernel.org/majordomo-info.html
Please read the FAQ at  
http://www.tux.org/lkml/