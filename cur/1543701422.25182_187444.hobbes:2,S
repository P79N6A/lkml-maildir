Date: Thu, 1 Jan 2004 05:27:27 -0500
From: Lennert Buytenhek <>
Subject: Re: [2.6.0-mm2] e100 driver hangs after period of moderate receive load
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2004/1/1/19

On Wed, Dec 31, 2003 at 09:21:56PM -0500, Thomas Molina wrote:
> [hangs on e100 under moderate receive load]
> > > Yes, NAPI was indeed enabled.
> > > 
> > > I 'went back' to 2.6.1-rc1 and that seems fine now.  Any patches you want
> > > me to try on top of 2.6.0-mm2?
> > 
> > Well, the two are vastly different, since -mm2 includes a complete 
> > rewrite of e100.
> > 
> > Does disabling NAPI in -mm2 change anything?
> 
> I have one of these beasts so I decided to test it after seeing this 
> message.  2.6.0-mm2 NAPI enabled and I am not seeing any of the symptoms 
> described here.  My test consists of downloading an iso from RedHat's ftp 
> site.  I'm not sure that is generating the kind of traffic you are talking 
> about, but I'm open to suggestions on what test to run trying to duplicate 
> what is being reported.
Make sure you have slab debugging enabled to see if you also get the slab
corruption messages, and then hit the machine with anything above 50000
packets per second.  pktgen from a different machine on the same subnet
works nicely for that.  I doubt that downloading a Red Hat iso would give
you a load anywhere near that.
Oh, do you have an SMP box?  This was on a 2-way (4-way HT) SMP box.  Not
sure if that matters here.
I'm just about to try 2.6.0-mm2 without NAPI.
--L
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.kernel.org
More majordomo info at  
http://vger.kernel.org/majordomo-info.html
Please read the FAQ at  
http://www.tux.org/lkml/