Date: Wed, 12 Nov 2008 10:53:19 -0600
From: "Serge E. Hallyn" <>
Subject: Re: Signals to cinit
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2008/11/12/223

Quoting Oleg Nesterov (oleg@redhat.com):
> --- K-IS/kernel/signal.c~T	2008-11-10 19:21:17.000000000 +0100
> +++ K-IS/kernel/signal.c	2008-11-10 20:31:24.000000000 +0100
> @@ -798,11 +798,19 @@ static inline int legacy_queue(struct si
>  	return (sig < SIGRTMIN) && sigismember(&signals->signal, sig);
>  }
> 
> +#define SIG_FROM_USER	INT_MIN		/* MSB */
> +
>  static int send_signal(int sig, struct siginfo *info, struct task_struct *t,
>  			int group)
>  {
>  	struct sigpending *pending;
>  	struct sigqueue *q;
> +	int from_ancestor_ns;
> +
> +	from_ancestor_ns = !is_si_special(info) &&
> +		(info->si_signo | SIG_FROM_USER) &&
I assume you mean '&'?
> +		/* if t can't see us we are from parent ns */
> +		task_pid_nr_ns(current, t->current->nsproxy->pid_ns) <= 0;
This doesn't look so bad...  (but still looking through followup emails)
-serge