Date: Tue, 15 May 2007 13:48:14 -0700
From: Yinghai Lu <>
Subject: [PATCH] serial: set DTR in uart for kernel serial console
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2007/5/15/267

Hope format is OK. Sending with KMail Message/Insert File
YH
[PATCH] serial: set DTR in uart for kernel serial console
Some UARTs on other side need host uart DTR is set, otherwise will not 
receive char from the host that kernel is runing during kernel boot stage.
BTW:
earlyprintk and early_uart are hard coded to set DTR/RTS.
Signed-off-by: Yinghai Lu <yinghai.lu@sun.com>
Cc: Russell King <rmk@arm.linux.org.uk>
Cc: Andi Kleen <ak@suse.de>
Cc: Bjorn Helgaas <bjorn.helgaas@hp.com> 
diff --git a/drivers/serial/8250.c b/drivers/serial/8250.c
index 48e259a..a925547 100644
--- a/drivers/serial/8250.c
+++ b/drivers/serial/8250.c
@@ -2397,6 +2397,11 @@ static void __init serial8250_isa_init_ports(void)
 		up->mcr_force = ALPHA_KLUDGE_MCR;
 
 		up->port.ops = &serial8250_pops;
+
+		/* some uarts on other side don't support no flow control. So we set
+		 * DTR in host uart to make them happy  --- YHLU
+		 */
+		up->port.mctrl |= TIOCM_DTR; 
 	}
 
 	for (i = 0, up = serial8250_ports;
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.kernel.org
More majordomo info at  
http://vger.kernel.org/majordomo-info.html
Please read the FAQ at  
http://www.tux.org/lkml/