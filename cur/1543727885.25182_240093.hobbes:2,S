Date: Mon, 9 Aug 2004 15:34:55 +0200
From: Stephane Jourdois <>
Subject: Re: 2.6.8-rc2-mm1: bluetooth broken?
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2004/8/9/123

On Mon, Aug 09, 2004 at 03:24:03PM +0200, Marcel Holtmann wrote:
> > > this is what I was thinking, because I always run the latest stuff from
> > > the Bitkeeper repository directly. Seems that there is something in the
> > > -mm patches that broke it. Can someone test the latest -mm and report if
> > > the Bluetooth subsystem is working or not?
> > 
> > Not working here since 2.6.8-rc2-mm2.
> > Works in 2.6.8-rc2-mm1.
> 
> I never used a -mm patch, so you must be a little bit more specific what
> is not working. What Bluetooth hardware are you using? Do the logfiles
> or dmesg include anything helpful?
I use a usb dongle, unfortunately included in my laptop, so I can't see
any serial number or anything.
lspci -v :
----
[..snip..]
0000:00:1d.0 USB Controller: Intel Corp. 82801EB/ER (ICH5/ICH5R) USB UHCI #1 (rev 02) (prog-if 00 [UHCI])
        Subsystem: CLEVO/KAPOK Computer: Unknown device 0500
        Flags: bus master, medium devsel, latency 0, IRQ 193
        I/O ports at 1cc0 [size=32]
0000:00:1d.1 USB Controller: Intel Corp. 82801EB/ER (ICH5/ICH5R) USB UHCI #2 (rev 02) (prog-if 00 [UHCI])
        Subsystem: CLEVO/KAPOK Computer: Unknown device 0500
        Flags: bus master, medium devsel, latency 0, IRQ 201
        I/O ports at 1ce0 [size=32]
0000:00:1d.2 USB Controller: Intel Corp. 82801EB/ER (ICH5/ICH5R) USB UHCI #3 (rev 02) (prog-if 00 [UHCI])
        Subsystem: CLEVO/KAPOK Computer: Unknown device 0500
        Flags: bus master, medium devsel, latency 0, IRQ 185
        I/O ports at 2000 [size=32]
0000:00:1d.3 USB Controller: Intel Corp. 82801EB/ER (ICH5/ICH5R) USB UHCI #4 (rev 02) (prog-if 00 [UHCI])
        Subsystem: CLEVO/KAPOK Computer: Unknown device 0500
        Flags: bus master, medium devsel, latency 0, IRQ 193
        I/O ports at 2020 [size=32]
0000:00:1d.7 USB Controller: Intel Corp. 82801EB/ER (ICH5/ICH5R) USB2 EHCI Controller (rev 02) (prog-if 20 [EHCI])
        Subsystem: CLEVO/KAPOK Computer: Unknown device 0500
        Flags: bus master, medium devsel, latency 0, IRQ 209
        Memory at e8000000 (32-bit, non-prefetchable) [size=1K]
        Capabilities: [50] Power Management version 2
        Capabilities: [58] #0a [20a0]
[..snip..]
----
I use it to communicate using HIDP with my Logitech MX900 mouse, which
works perfectly under 2.6.8-rc2-mm1, and no more since 2.6.8-rc2-mm2.
strace hidd --search :
---- 
[..snip..]
socket(PF_BLUETOOTH, SOCK_RAW, 6)       = 3
socket(PF_BLUETOOTH, SOCK_RAW, 1)       = 4
brk(0)                                  = 0x804d000
brk(0x806e000)                          = 0x806e000
brk(0)                                  = 0x806e000
ioctl(4, 0x800448d2, 0x804d008)         = 0
close(4)                                = 0
socket(PF_BLUETOOTH, SOCK_RAW, 1)       = 4
ioctl(4, 0x800448d2, 0x804d008)         = 0
close(4)                                = 0
socket(PF_BLUETOOTH, SOCK_RAW, 1)       = 4
ioctl(4, 0x800448d3, 0xbfffe940)        = -1 ENODEV (No such device)
close(4)                                = 0
fstat64(1, {st_mode=S_IFIFO|0600, st_size=0, ...}) = 0
mmap2(NULL, 4096, PROT_READ|PROT_WRITE, MAP_PRIVATE|MAP_ANONYMOUS, -1, 0) = 0xb7ea0000
socket(PF_BLUETOOTH, SOCK_RAW, 1)       = 4
ioctl(4, 0x800448d2, 0x804d008)         = 0
close(4)                                = 0
close(3)                                = 0
write(1, "Searching ...\n", 14Searching ...
)         = 14
munmap(0xb7ea0000, 4096)                = 0
----
I saw several lines as those in my dmesg :
----
usb 4-2: usbfs: USBDEVFS_CONTROL failed cmd hid2hci rqt 64 rq 0 len 0 ret -32
----
I'll try now to narrow which patch is broking things for me in -mm.
I'll post my results to this thread.
++
-- 
 ///  Stephane Jourdois         /"\  ASCII RIBBON CAMPAIGN \\\
(((    Ingénieur développement  \ /    AGAINST HTML MAIL    )))
 \\\   24 rue Cauchy             X                         ///
  \\\  75015  Paris             / \    +33 6 8643 3085    ///
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.kernel.org
More majordomo info at  
http://vger.kernel.org/majordomo-info.html
Please read the FAQ at  
http://www.tux.org/lkml/