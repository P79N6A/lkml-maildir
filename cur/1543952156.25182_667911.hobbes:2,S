Date: Sat, 15 Mar 2008 11:34:26 +0300
From: Cyrill Gorcunov <>
Subject: [PATCH] x86: traps_32.c - use KSYM_NAME_LEN instead of numeric value
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2008/3/15/21

It's safer to use KSYM_NAME_LEN instead of numeric constant
because we could get buffer overrun someday if KSYM_NAME_LEN
would be changed to a bigger value.
Signed-off-by: Cyrill Gorcunov <gorcunov@gmail.com>
---
I've patched 64bit version but forgot about 32bit. So
lets fix it too.
Index: linux-2.6.git/arch/x86/kernel/traps_32.c
===================================================================
--- linux-2.6.git.orig/arch/x86/kernel/traps_32.c	2008-02-09 22:27:13.000000000 +0300
+++ linux-2.6.git/arch/x86/kernel/traps_32.c	2008-03-15 11:21:16.000000000 +0300
@@ -109,7 +109,7 @@ void printk_address(unsigned long addres
 	const char *symname;
 	char *modname;
 	char *delim = ":";
-	char namebuf[128];
+	char namebuf[KSYM_NAME_LEN];
 	char reliab[4] = "";
 
 	symname = kallsyms_lookup(address, &symsize, &offset,