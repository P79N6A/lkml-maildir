Date: Thu, 29 Apr 1999 18:34:21 +0200
From: Helge Hafting <>
Subject: Re: Removable media bug
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/1999/4/29/78

> > Exactly. Just as a umount forces writing of all buffers, it must
> > invalidate the buffers. I'm curious why noone noticed that earlier.
> 
> He has a faulty floppy drive, everyone else doesn't is the short summary.
> The FDC has a "disk changed" detection line.
> 
> That is why we support
> 
> 	floppy=broken_dcl
> 
> as a boot option
I don't think it is safe to keep the buffers around just because
the disk wasn't ejected.  Because the unmounted filesystem can
be changed while unmounted.  There are several ways:
1. Writing directly to the device, such as "dd of=/dev/fd0"
I don't know, maybe the buffer system catch that one.
2. Scsi devices may be connected to several machines simultaneously.
unmount at one machine, mount for writing at the other.  Then
reverse this.  No ejecting, no writing to the device from the
first machine, disk contents still changed.
3. The diskette device could be hot-swapped without ejecting.
Unlikely but possible.
Helge Hafting
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.rutgers.edu
Please read the FAQ at 
http://www.tux.org/lkml/