Date: Thu, 28 Jan 1999 10:22:00 -0800 (PST)
From: Linus Torvalds <>
Subject: Re: Linux-2.2.0 bad VM behaviour "dd if=/dev/zero of=/dev/hdc bs=256k"
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/1999/1/28/107

On Thu, 28 Jan 1999, Andi Kleen wrote:
> On Thu, Jan 28, 1999 at 08:24:18AM +0100, Petri Mattila wrote:
> > At 11:17 AM 1/27/99 -0800, Linus Torvalds wrote:
> > 
> > >This is one of my peeves - we should really start the IO once we've filled
> > >up "X nr" of full buffers. But I've always been too lazy to do it.
> > 
> > But could somebody please explain why on earth processes get swapped out
> > if I turn on DMA transfer, but stay in memory with PIO transfer?
> 
> One possible explanation could be that PIO mode is much slower and eats more 
> CPU time, so the kswapd has more(less(?)) time to swap things out.
> This is only a crazy theory @)
I don't think that's a crazy theory. It's almost certainly timing-related.
However, I don't think it's the fact that PIO is slower (it isn't really
all that much slower), it's more a fact that PIO is _synchronous_ wrt the
kernel.
With DMA enabled, it will be much more likely that you have other
processes trying to get memory while the IO is active, and that
concurrency means that the mm layer is probably much more likely to see
pages in the "locked" phase - which in turn means that we're less likely
to free them, which results in us being more eager to free something else
(ie page out stuff). 
Yes, all conjecture, and it's probably not exactly right, but something
along these lines is probably what is going on. Timing and concurrency
differences changing the way the system behaves.
		Linus
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.rutgers.edu
Please read the FAQ at 
http://www.tux.org/lkml/