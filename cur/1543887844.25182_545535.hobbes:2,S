Date: Wed, 16 May 2007 19:19:20 -0700
From: Yinghai Lu <>
Subject: [PATCH]x86_64: early_print kernel console should send CRLF not LFCR
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2007/5/16/534

[PATCH]x86_64: early_print kernel console should send CRLF not LFCR
   in 
	commit d358788f3f30113e49882187d794832905e42592
	Author: Russell King <rmk@dyn-67.arm.linux.org.uk>
	Date:   Mon Mar 20 20:00:09 2006 +0000
    Glen Turner reported that writing LFCR rather than the more
    traditional CRLF causes issues with some terminals.
    Since this aflicts many serial drivers, extract the common code
    to a library function (uart_console_write) and arrange for each
    driver to supply a "putchar" function.
    but early_printk is left out. 
    Signed-off-by: Yinghai Lu <yinghai.lu@sun.com>
    Cc: Andi Kleen <ak@suse.de>
    Cc: Russell King <rmk@arm.linux.org.uk>
diff --git a/arch/x86_64/kernel/early_printk.c b/arch/x86_64/kernel/early_printk.c
index 56eaa25..296d2b0 100644
--- a/arch/x86_64/kernel/early_printk.c
+++ b/arch/x86_64/kernel/early_printk.c
@@ -91,9 +91,9 @@ static int early_serial_putc(unsigned char ch)
 static void early_serial_write(struct console *con, const char *s, unsigned n)
 {
 	while (*s && n-- > 0) {
-		early_serial_putc(*s);
 		if (*s == '\n')
 			early_serial_putc('\r');
+		early_serial_putc(*s);
 		s++;
 	}
 }
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.kernel.org
More majordomo info at  
http://vger.kernel.org/majordomo-info.html
Please read the FAQ at  
http://www.tux.org/lkml/