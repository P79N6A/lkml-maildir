Date: Fri, 29 Feb 2008 08:28:28 -0800
From: David Wilder <>
Subject: Re: [patch 2/3]  Trace code and documentation
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2008/2/29/190

Andrew Morton wrote:
> On Tue, 26 Feb 2008 14:38:48 -0800 "David J. Wilder" <dwilder@us.ibm.com> wrote:
> 
>> +	if (strncmp(buf, "start", strlen("start")) == 0) {
>> +		ret = trace_start(trace);
>> +		if (ret)
>> +			return ret;
>> +	} else if (strncmp(buf, "stop", strlen("stop")) == 0)
>> +		trace_stop(trace);
> 
> Does gcc manage to avoid the pointless strlen() calls here?
> 
> It's a bit untidy that you can write "startfoo" in there and the kernel
> will happily accept it.
I agree.  I will change it to something like this in my next update.
buf[count-1] = '\0';
if (strcmp(buf, "start") == 0) {
	ret = trace_start(trace);
	if (ret)
		return ret;
} else if (strcmp(buf, "stop") == 0)
	trace_stop(trace);
else
	return -EINVAL;