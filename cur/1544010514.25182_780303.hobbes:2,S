Date: Sun, 14 Dec 2008 00:15:51 +0100
From: Bartlomiej Zolnierkiewicz <>
Subject: Re: [PATCH 2/3] ide: add ide_[un]lock_hwgroup() helpers
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2008/12/13/172

[ Sorry for the late reply. ]
On Wednesday 19 November 2008, Michael Schmitz wrote:
> > -	while (!hwgroup->busy) {
> > -		hwgroup->busy = 1;
> > -		/* for atari only */
> > -		ide_get_lock(ide_intr, hwgroup);
> > +	while (!ide_lock_hwgroup(hwgroup)) {
> 
> Something I've run into while working on the locking stuff: what happens if the 
> above ide_lock_hwgroup(hwgroup) sleeps for long enough to trigger the request 
> timer? 
AFAICS this happens before the hwgroup timeout timer is armed and IDE is not
using block layer request timers yet so we should be fine here..
Thanks,
Bart