Date: Sun, 21 Mar 2004 19:33:42 -0500
From: Jeff Garzik <>
Subject: Re: can device drivers return non-ram via vm_ops->nopage?
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2004/3/21/166

Russell King wrote:
> On Sun, Mar 21, 2004 at 07:10:53PM -0500, Jeff Garzik wrote:
> 
>>For the first kind, please read fb_mmap in drivers/video/fbmem.c.  Look 
>>at the _horror_ of ifdefs in exporting the framebuffer.  And that horror 
>>is what's often needed when letting userspace mmap(2) PCI memory IO regions.
> 
> 
> Most of this:
[...]
> exists because architectures haven't defined their private
> pgprot_writecombine() implementations, preferring instead to add
> to the preprocessor junk instead.
Agreed but the larger point is that that code should not be in fbmem.c 
at all.
There are two main types of usage for bus IO memory (MMIO), data and 
hardware registers.  Both types driver writers currently export to 
userspace via mmap(2).  Caching and write combining are simply 
driver-controlled attributes one must consider.
	Jeff
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.kernel.org
More majordomo info at  
http://vger.kernel.org/majordomo-info.html
Please read the FAQ at  
http://www.tux.org/lkml/