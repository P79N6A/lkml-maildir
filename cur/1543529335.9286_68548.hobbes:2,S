Date: Fri, 10 Mar 2000 21:54:14 -0500 (EST)
From: James Simmons <>
Subject: Re: Running JOBS list.
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2000/3/10/142

> Fbcon races
I didn't finish the fbdev API changes. Its better but not perfect. You
will see. I sent a patch to Geert to look over before he sends it to
linus that updates vfb.c to show how a 2.4.X driver should be written. As
for races. Its still not really multihead friendly. Neither is the console
code as several of us with multihead system discover. SMP and multihead 
and console system don't mix :( The con2fb mapping is just a mess. Things
like fbcon=map:0110 bombs if you don't have a second video card. Their is
no way to fix this. Its a chicken and egg problem. fbcon_setup is called
before fbmem_init so you can't do any sanity checking. The con2fb mapping
stuff is just pure crap. Its just a pure hack to get multihead somewhat
working. I hate it and can't wait to see it removed in 2.5.X. 
The second problem is vgacon and fbcon. Until this last kernel you can
boot vgacon and then inmod a fbdev driver and then fbcon would take over.
Now the problem is most video card when they go from VGA mode to a non VGA
mode can NOT go back to VGA mode. So if you go to rmmod the fbdev driver
you are fubar. I just made a patch that changes the config.in files to
have it so you either have to choose fbcon or vgacon. Its one or the
other. This brings me to another question. Can prom console run at the
same time as the framebuffers on a sparc station ? Same for some of the
SGI stations. Can a newport console also run at the same time as a
framebuffer console. This way my patch can ensure you can select between
fbcon or some other console type. 
> Some FB drivers check the A000 area and find it busy then bomb out
I know cirrus, dnfb, and vga16. I can see vga16 since this is really
for a isa card. vga16 should be called last since many cards start in VGA
mode program a few registers then switch to MMIO thus freeing this region.
Its then safe for the next card to do this. As for cirrus and dnfb. I
don't have the docs for these cards but I assume it should be possible to
switch to MMIO mode for these cards.
"Look it's a text editor, no it's a OS, no it's Emacs"
James Simmons                                           ____/| 
fbdev/gfx developer                                     \ o.O| 
http://www.linux-fbdev.org
                               =(_)= 
http://linuxgfx.sourceforge.net
                            U
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.rutgers.edu
Please read the FAQ at 
http://www.tux.org/lkml/