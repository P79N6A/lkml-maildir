Date: Mon, 05 Sep 2005 11:02:18 -0500
From: hanasaki <>
Subject: kernel 2.6.13 hangs / freezes with nvidia kernel module on switch to virtual console (also 2.6.12)
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2005/9/5/133

kernel 2.6.13 hangs / freezes with nvidia
kernel module on switch to virtual console
Running Debian testing and stable and built the kernel with the attached
config.  Then the NVidia installer was run.  Everything boots and runs
fine.  X and Gnome come up and run.  Switching to a Virtual Console
locks up the system and shows some crazy colors.
The system ran fine with the same configs until ~kernel 2.6.12.x and has
exhibited this failing behavior since then with multiple kernels.
The graphics card is a shown below and has two outputs both in use for
two monitors.  Thus the actual driver from NV is needed.  I do not
believe the Xfree nv driver supports dual head.
======================
NVidia version
NVIDIA-Linux-x86-1.0-7676-pkg1.run <= from nvidia.com
Debian: testing and stable
Linux ___ 2.6.13 #1 SMP Mon Sep 5 01:26:53 CDT 2005 i686 GNU/Linux
lspci
0000:00:00.0 Host bridge: VIA Technologies, Inc. VT8377 [KT400/KT600
AGP] Host Bridge (rev 80)
0000:00:01.0 PCI bridge: VIA Technologies, Inc. VT8237 PCI Bridge
0000:00:07.0 Ethernet controller: Broadcom Corporation NetXtreme BCM5705
Gigabit Ethernet (rev 03)
0000:00:0d.0 FireWire (IEEE 1394): VIA Technologies, Inc. IEEE 1394 Host
Controller (rev 46)
0000:00:0e.0 Multimedia audio controller: C-Media Electronics Inc CM8738
(rev 10)
0000:00:0f.0 IDE interface: VIA Technologies, Inc.
VT82C586A/B/VT82C686/A/B/VT823x/A/C PIPC Bus Master IDE (rev 06)
0000:00:10.0 USB Controller: VIA Technologies, Inc. VT82xxxxx UHCI USB
1.1 Controller (rev 81)
0000:00:10.1 USB Controller: VIA Technologies, Inc. VT82xxxxx UHCI USB
1.1 Controller (rev 81)
0000:00:10.2 USB Controller: VIA Technologies, Inc. VT82xxxxx UHCI USB
1.1 Controller (rev 81)
0000:00:10.3 USB Controller: VIA Technologies, Inc. VT82xxxxx UHCI USB
1.1 Controller (rev 81)
0000:00:10.4 USB Controller: VIA Technologies, Inc. USB 2.0 (rev 86)
0000:00:11.0 ISA bridge: VIA Technologies, Inc. VT8237 ISA bridge
[K8T800 South]
0000:01:00.0 VGA compatible controller: nVidia Corporation NV 36
[GeForce 5700 Ultra] (rev a1)
kernel config - attached
lsmod
Module                  Size  Used by
it87                   20320  0
eeprom                  6416  0
lm90                   11300  0
i2c_sensor              3264  3 it87,eeprom,lm90
i2c_isa                 2368  0
i2c_dev                 8448  0
i2c_viapro              7376  0
ipv6                  254208  19
lp                      9924  0
parport_pc             38596  1
parport                35144  2 lp,parport_pc
evdev                   8000  0
floppy                 56276  0
pcspkr                  3744  0
usb_storage            74560  0
snd_cmipci             32544  0
gameport               12488  1 snd_cmipci
snd_pcm                84804  1 snd_cmipci
snd_page_alloc          8968  1 snd_pcm
snd_opl3_lib            9920  1 snd_cmipci
snd_timer              22532  2 snd_pcm,snd_opl3_lib
snd_hwdep               7904  1 snd_opl3_lib
snd_mpu401_uart         6848  1 snd_cmipci
snd_rawmidi            21792  1 snd_mpu401_uart
snd_seq_device          7756  2 snd_opl3_lib,snd_rawmidi
snd                    48420  8
snd_cmipci,snd_pcm,snd_opl3_lib,snd_timer,snd_hwdep,snd_mpu401_uart,snd_rawmidi,snd_seq_device
eth1394                18696  0
ohci1394               33716  0
nvidia               3707496  12
sr_mod                 14756  0
sd_mod                 14592  0
sbp2                   21960  0
ide_cd                 39428  0
[unhandled content-type:application/x-gzip]