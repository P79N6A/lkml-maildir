Date: Tue, 30 May 2006 22:49:01 +0200
From: Ingo Molnar <>
Subject: Re: [patch, -rc5-mm1] lock validator: fix RT_HASH_LOCK_SZ
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2006/5/30/316

* Roland Dreier <rdreier@cisco.com> wrote:
>  > on lockdep we have a quite big spinlock_t, so keep the size down.
> 
> Yes, that builds fine.
> 
> However the kernel won't boot for me... it oopses early on in 
> save_stack_trace().  I'm attaching a bootlog, plus another try booting 
> with nmi_watchdog=0, plus my config.
there's some bad interaction between the new dwarf2 unwind info 
stackframe walker code in mm1 and lockdep's stacktrace code on x86_64. 
I'm investigating this currently, meanwhile you can try the quick hack 
below.
	Ingo
Index: linux/arch/x86_64/kernel/stacktrace.c
===================================================================
--- linux.orig/arch/x86_64/kernel/stacktrace.c
+++ linux/arch/x86_64/kernel/stacktrace.c
@@ -127,7 +127,8 @@ save_context_stack(struct stack_trace *t
 			skip--;
 		if (trace->nr_entries >= trace->max_entries)
 			break;
-		if (!addr)
+#warning fixme
+//		if (!addr)
 			return 0;
 		/*
 		 * Stack frames must go forwards (otherwise a loop could
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.kernel.org
More majordomo info at  
http://vger.kernel.org/majordomo-info.html
Please read the FAQ at  
http://www.tux.org/lkml/