Date: Tue, 15 Jan 2008 18:11:46 +0100
From: Andi Kleen <>
Subject: Re: [PATCH x86] [15/16] Force __cpuinit on for CONFIG_PM without HOTPLUG_CPU
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2008/1/15/221

On Tue, Jan 15, 2008 at 05:25:13PM +0100, Sam Ravnborg wrote:
> On Tue, Jan 15, 2008 at 04:17:42PM +0100, Ingo Molnar wrote:
> > 
> > * Sam Ravnborg <sam@ravnborg.org> wrote:
> > 
> > > > find below the current set of warnings on -git. There are 62.
> > > 
> > > The correct figure is 112.
> > > 
> > > You need to do a:
> > > make KCFLAGS=-fno-unit-at-a-time
> > > build to see them all.
> > 
> > btw., please add a .config option to trigger the -fno-unit-at-a-time 
> > flags. Something like CONFIG_SECTION_ERRORS=y - plus perhaps combine it 
> > with the patch below that turns such section bugs into detectable build 
> > errors. A distro does not want to build a kernel that could potentially 
> > corrupt kernel memory. (it's a security risk as well.) If we make the 
> > err=1 dependent on CONFIG_SECTION_ERRORS then we'll have this 
> > configurable.
> 
> The plan is to let section mismatch warnings become errors 
> after the merge window - so we hit -mm first.
A lot of those I look at seem to be not really bugs; also my
impression is that they sometimes crop up randomly. e.g. you
change something completely unrelated and suddenly you get
a section warning somewhere else.
> And I will add a config option to:
> - set -fno-unit-at-a-time
I was told future gcc versions would remove that. Why do you
want it?
> - add no-inline to all functions marked __init*
> - and maybe disable __inline if that gives additional errors
I sometimes do that for debugging "define static noinline" 
in specific files or similar because it's easier to make sense of oopses
when functions not inlined.  Not sure it would work
as a global option though because if you do it globally
then all the inlines in all .hs would be affected and that might
lead to immense code bloat.
-Andi