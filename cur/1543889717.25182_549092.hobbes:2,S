Date: Fri, 25 May 2007 10:08:27 +0200
From: Ingo Molnar <>
Subject: [patch] i386, numaq: enable TSCs again
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2007/5/25/78

Andi, Andrew, do you remember why we disabled TSCs on NUMAQ? It was 
slightly async between CPUs, right? In that case we should try the patch 
below.
	Ingo
--------------------->
Subject: [patch] i386, numaq: enable TSCs again
From: Ingo Molnar <mingo@elte.hu>
enable TSCs on NUMAQ again. sched_clock() got improved and
the scheduler treats it as a per-CPU clock, so there should
be no issues from the slightly async TSCs on NUMAQ. Please
holler if this is wrong ...
Signed-off-by: Ingo Molnar <mingo@elte.hu>
---
 arch/i386/kernel/numaq.c |    3 +--
 1 file changed, 1 insertion(+), 2 deletions(-)
Index: linux-cfs-2.6.22-rc2-mm1.q/arch/i386/kernel/numaq.c
===================================================================
--- linux-cfs-2.6.22-rc2-mm1.q.orig/arch/i386/kernel/numaq.c
+++ linux-cfs-2.6.22-rc2-mm1.q/arch/i386/kernel/numaq.c
@@ -81,8 +81,7 @@ int __init get_memcfg_numaq(void)
 static int __init numaq_tsc_disable(void)
 {
 	if (num_online_nodes() > 1) {
-		printk(KERN_DEBUG "NUMAQ: disabling TSC\n");
-		tsc_disable = 1;
+		printk(KERN_DEBUG "NUMAQ: NOT disabling TSC. System still ok?\n");
 	}
 	return 0;
 }
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.kernel.org
More majordomo info at  
http://vger.kernel.org/majordomo-info.html
Please read the FAQ at  
http://www.tux.org/lkml/