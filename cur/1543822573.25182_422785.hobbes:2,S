Date: Wed, 10 May 2006 22:31:09 -0400
From: Dave Jones <>
Subject: Re: [RFC] [PATCH] Execute PCI quirks on resume from suspend-to-RAM
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2006/5/10/350

On Wed, May 10, 2006 at 11:36:41PM +0200, Carl-Daniel Hailfinger wrote:
 > Greg KH wrote:
 > > On Wed, May 10, 2006 at 12:30:34PM +0200, Carl-Daniel Hailfinger wrote:
 > >> Thinking about it again, if we restored the full pci config space
 > >> on resume, this quirk handling would be completely unnecessary.
 > >> Any reasons why we don't do that?
 > > 
 > > We do do that.  Look at pci_restore_state().
 > > 
 > > Actually, look at it in the latest -mm tree, that version works better
 > > than mainline does right now :)
 > 
 > Sorry. Even the version in -mm does not restore all 256 bytes, so it
 > will not change anything.
You can't generically look at a PCI device past the first 32 bytes.
*anything* could be there, including registers which cause the machine
to lock up when they get read.
This is exactly the reason that lspci by default only shows 32 bytes,
and you need to be root to see past that limit.
 > So either we really restore the full config space (probably a good idea
 > by itself)
No, *really* *really* bad idea :)
		Dave
-- 
http://www.codemonkey.org.uk
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.kernel.org
More majordomo info at  
http://vger.kernel.org/majordomo-info.html
Please read the FAQ at  
http://www.tux.org/lkml/