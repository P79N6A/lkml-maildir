Date: Tue, 6 May 2003 03:21:23 +0300
From: Thomas Backlund <>
Subject: Re: [PATCH 2.4.21-rc1] vesafb with large memory
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2003/5/5/290

ViestissÃ¤ Sunnuntai 4. Toukokuuta 2003 12:49, Willy TARREAU kirjoitti:
> Hi Thomas,
>
> > the correct line should AFAIK be:
> > video_size = screen_info.lfb_width * screen_info.lfb_height *
> > video_bpp;
> >
> > (AFAIK we are calculating bits here, not bytes so the '/8' you used is
> > wrong... could you try without it, and let me know...)
>
> No, after verification, I insist, we're really calculating BYTES here.
> Please take a look :
Yes, 
you are right...
[...]
>
> So I think that the correct line really is :
>   video_size = screen_info.lfb_width * screen_info.lfb_height *
> video_bpp / 8;
There is a problem with this, ...
If we calculate the exact memory like this, there wont be any
memory remapped to do double/tripple buffering...
So the question is: shoud one take the formula and add ' * 2' to 
atleast get the double buffering supported...
(in the patch I made for mdk, I kept a modified override part so that
the user can change this, if he needs it....)
Alan,
any comments on this?
> (Which also handles line widths which are not multiple of 8).
Well actually, in that formula it does not matter where you put the '/8',
the result is always the same...
> BTW, I wonder why we truncate the mtrr size to the highest lower power
> of 2. Shouldn't we round it up to the next one ?
>
Isn't it a hardware requirement?
I think I read it in a nvidia document once... 
(of course they may be wrong...)
-- 
Thomas Backlund
tmb@iki.fi
www.iki.fi/tmb
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.kernel.org
More majordomo info at  
http://vger.kernel.org/majordomo-info.html
Please read the FAQ at  
http://www.tux.org/lkml/