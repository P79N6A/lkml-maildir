Date: Mon, 3 Mar 2008 17:30:11 -0800
From: Andrew Morton <>
Subject: Re: [PATCH 2/2] x86_64: Cleanup non-smp usage of cpu maps v3
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2008/3/3/614

On Mon, 3 Mar 2008 17:02:35 -0800
Andrew Morton <akpm@linux-foundation.org> wrote:
> I was unable to bisect it more finely than this:
> 
> init-move-setup-of-nr_cpu_ids-to-as-early-as-possible-v3.patch
> generic-percpu-infrastructure-to-rebase-the-per-cpu-area-to-zero-v3.patch OK
> x86_64-fold-pda-into-per-cpu-area-v3.patch
> x86_64-fold-pda-into-per-cpu-area-v3-fix.patch				
> x86_64-cleanup-non-smp-usage-of-cpu-maps-v3.patch			BAD
> 
> because when x86_64-cleanup-non-smp-usage-of-cpu-maps-v3.patch was removed
> the machine hung quite early, when playing around with TSC calibration I
> think.
This just happened again with the patches dropped, so it is a separate bug -
just another regression.
I now recall that it has been happening on every fifth-odd boot for a few
weeks now.  The machine prints
Time: tsc clocksource has been installed
then five instances of "system 00:01: iomem range 0x...", then it hangs. 
ie: it never prints "system 00:01: iomem range 0xfe600000-0xfe6fffff has
been reserved" from 
http://userweb.kernel.org/~akpm/dmesg-akpm2.txt.
It may have some correlation with whether the machine was booted via
poweron versus `reboot -f', dunno.