Date: Sun, 4 May 2008 11:00:25 +0200
From: Ingo Molnar <>
Subject: Re: [RFC][PATCH] sched_clock_cpu()
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2008/5/4/50

* David Miller <davem@davemloft.net> wrote:
> > that wont work very well when sched_clock() is called from within 
> > CONFIG_LOCK_STAT instrumentation. Does the patch below solve the 
> > boot problems for you?
> 
> Also, no platform can set HAVE_STABLE_CLOCK until we instantiate it in 
> a Kconfig somewhere.  I've choosen to do it in kernel/Kconfig.hz and 
> here are the sparc/sparc64 bits as well, I've booted this up with 
> Peter's patch on my 64-cpu niagara2 box and done some basic testing.
applied, thanks David.
right now this topic looks good in review and in testing but it is 
stalled on a bug: in overnight testing it triggered an ftrace self-test 
hang that i bisected down to that patch. While that doesnt affect 
mainline it's something that shows that the new sched_clock() code is 
not as widely usable as the old code - have to investigate that some 
more.
> It would be nice if a powerpc person could test the trivial powerpc 
> Kconfig patch.
> 
> Possibly this should be HAVE_UNSTABLE_CLOCK, then only one platform 
> needs to set it :-)
heh, indeed :)
Initially i thought that it's better to first be safe, but this really 
will only affect x86 in practice, so ... i think we'll switch around the 
flag, turning this into a no-effort thing for everything but x86.
	Ingo