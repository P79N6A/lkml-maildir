Date: Mon, 12 Sep 2005 16:40:01 +0000 (UTC)
From: Antonio Amorim <>
Subject: Re: [PATCH] 2.6.13 flocks remove flock hits BUG();
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2005/9/12/211

Jakub W. Jozwicki <jakub007@...> writes: 
> 
> Because of incomplete conditional flocks_remove_flock runs into    
> BUG() which is below 'ifs'. This was visible with using unionfs.   
> 
> --- locks.c	2005-09-02 16:38:40.770509784 +0200      
> +++ locks-fixed.c	2005-09-02 16:37:22.000000000 +0200      
>  <at>  <at>  -1908,7 +1908,7  <at>  <at>       
> 
>  	while ((fl = *before) != NULL) {      
>  		if (fl->fl_file == filp) {      
> -			if (IS_FLOCK(fl)) {      
> +			if (IS_FLOCK(fl) || IS_POSIX(fl)) {      
>  				locks_delete_lock(before);      
>  				continue;      
>  			}      
> 
What was the UNIONFS version that you were able to compile with the 2.6.13 
kernel. Did it work ok after applying the patrch? 
All the best, 
Antonio Amorim 
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.kernel.org
More majordomo info at  
http://vger.kernel.org/majordomo-info.html
Please read the FAQ at  
http://www.tux.org/lkml/