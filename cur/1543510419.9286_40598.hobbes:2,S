Date: Thu, 23 Sep 1999 21:43:18 -0400 (EDT)
From: Richard Guy Briggs <>
Subject: Re: Headerless packets hitting ethernet?
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/1999/9/23/173

-----BEGIN PGP SIGNED MESSAGE-----
> Greetings, oh mighty hackers.
> 
> I've made an interesting and very annoying discovery. In some
> circumstances, packets are going out on the wire which seem to be
> completely missing the ethernet header. A wire sniffer saw packets which
> started immediately with an IP header instead.
> 
> The problem is one we'd never have noticed if we hadn't tried to run
> this system on a cable modem. The modem scans the first packet it sees,
> grabs the MAC address, and won't let go unless you reset it. Of course,
> if there's no ethernet header, what it thinks is the MAC address is
> entirely bogus, and will totally ignore any further legitimate packets
> coming from that ethernet card.
> 
> These packets show up most reliably when I'm running a DHCP client on
> the interface. If I assign it a static address, one or two show up, but
> not until after at least one legitimate packet goes through, so no harm
> is done. I suspect that fact the interface is not really completely
> configured has something to do with this.
> 
> The system is currently running a heavily patched 2.0.36 (i.e., not
> quite 2.0.38). I'm currently trying other kernel versions to see if they
> have the same problem. Although with such scanty information I know not
> to expect a solution from anyone, what I really want to know is: does
> this seem even remotely familiar to anyone? Are we the only people
> who've seen this problem?
We've seen this under 2.2.12.
> It seems quite possible that nobody has noticed this but us. Most
> ethernet devices would just ignore these headerless packets. But hope
> springs eternal.
We (FreeS/WAN) have noticed bogus skb->mac.raw pointers which seem to
co-inside with missing ethernet headers.  They were crashing our
kernel module until we decided to completely ignore it and use other
methods to determine if there was a hard header present.  When an skb
is first allocated, mac.raw should be NULL, which we were counting on
being true if there was no hard header.  We still don't know what the
source of the bogus packets was, even trying to force ARP lookups.
> --Galen Hazelwood
	slainte mhath, RGB
- -- 
Richard Guy Briggs -- PGP key available                Auto-Free Ottawa! Canada
<
http://www.conscoop.ottawa.on.ca/rgb/>
                   </www.flora.org/afo/>
Prevent Internet Wiretapping!       --      FreeS/WAN:<www.xs4all.nl/~freeswan>
Thanks for voting Green! -- <green.ca>          Marillion:<www.marillion.co.uk>
-----BEGIN PGP SIGNATURE-----
Version: 2.6.3i
Charset: noconv
iQCVAwUBN+rXNN+sBuIhFagtAQHGdQP/T7sjbibBTw599QWQkRkszuVIpQ4H+pPJ
CO5D/C5G5YPVhDFsoitAWOtZulR9n5OnPtdoZbFWe9UjPP3sfeaijaU4mNYU08E4
3YeZwmHrrEOsmEs9voAVy6tHieFju8LLD3oca6Idc4Oex2JM7er/6hdNj+HCwcB0
vXXiXQNdIQw=
=WMqD
-----END PGP SIGNATURE-----
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.rutgers.edu
Please read the FAQ at 
http://www.tux.org/lkml/