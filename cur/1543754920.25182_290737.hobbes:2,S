Date: Fri, 28 Jan 2005 11:55:13 -0500 (EST)
From: Pavel Roskin <>
Subject: [PATCH] Move HPET options from top level, enable HPET_TIMER prompt
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2005/1/28/119

Hello!
"make menuconfig" for x86_64 looks somewhat funky:
[ ] Provide RTC interrupt (NEW)
     Code maturity level options  --->
     General setup  --->
...
I believe all x86_64 specific options for HPET timer should be moved to 
the "Processor type and features" menu.  That's where they are located for 
i386.  There are two such options - HPET_TIMER and HPET_EMULATE_RTC.
Also, there is no prompt for HPET_TIMER, so it's always set.  However, the 
help text ends with "If unsure, say Y".  Kind of pointless, isn't it?  I 
enabled the prompt and deselected HPET_TIMER.  The kernel compiled and 
booted just fine.  Kernel messages don't indicate that HPET is used, but 
they said so when HPET_TIMER was enabled.
The patch does two things:
- HPET_TIMER and HPET_EMULATE_RTC are moved from the top-level to
   "Processor type and features"
- HPET_TIMER can be deselected (just like on i386)
The patch is against current Linux snapshot (svn revision 26268).
-- 
Regards,
Pavel RoskinIndex: arch/x86_64/Kconfig
===================================================================
--- arch/x86_64/Kconfig	(revision 26268)
+++ arch/x86_64/Kconfig	(working copy)
@@ -62,23 +62,6 @@
 	  with klogd/syslogd or the X server. You should normally N here,
 	  unless you want to debug such a crash.
 
-config HPET_TIMER
-	bool
-	default y
-	help
-	  Use the IA-PC HPET (High Precision Event Timer) to manage
-	  time in preference to the PIT and RTC, if a HPET is
-	  present.  The HPET provides a stable time base on SMP
-	  systems, unlike the RTC, but it is more expensive to access,
-	  as it is off-chip.  You can find the HPET spec at
-	  <
http://www.intel.com/labs/platcomp/hpet/hpetspec.htm>.
-
-	  If unsure, say Y.
-
-config HPET_EMULATE_RTC
-	bool "Provide RTC interrupt"
-	depends on HPET_TIMER && RTC=y
-
 config GENERIC_ISA_DMA
 	bool
 	default y
@@ -193,6 +176,23 @@
 	bool
 	default y
 
+config HPET_TIMER
+	bool "HPET Timer Support"
+	default y
+	help
+	  Use the IA-PC HPET (High Precision Event Timer) to manage
+	  time in preference to the PIT and RTC, if a HPET is
+	  present.  The HPET provides a stable time base on SMP
+	  systems, unlike the RTC, but it is more expensive to access,
+	  as it is off-chip.  You can find the HPET spec at
+	  <
http://www.intel.com/labs/platcomp/hpet/hpetspec.htm>.
+
+	  If unsure, say Y.
+
+config HPET_EMULATE_RTC
+	bool "Provide RTC interrupt"
+	depends on HPET_TIMER && RTC=y
+
 config MTRR
 	bool "MTRR (Memory Type Range Register) support"
 	---help---