Date: Wed, 12 May 2004 16:18:17 -0400
From:  Valdis.Kletnieks@vt ...
Subject: Re: MSEC_TO_JIFFIES is messed up...
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2004/5/12/167

On Wed, 12 May 2004 22:03:05 +0200, Ingo Molnar said:
> due to overflows. But we know that HZ is 1000 in the arch-dependent
> param.h, and in sched.c we use the HZ dependent variant:
That should read   we "know" that HZ is 1000....
How about this instead?
#if HZ == 1000
#define JIFFIES_TO_MSEC(x)  (x)
#else
#define JIFFIES_TO_MSEC(x) ((x) * 1000 / HZ)
#endif
That will DTRT if somebody changes HZ for their build, and still allow
us to avoud the *1000/1000 conversion for most builds.....
[unhandled content-type:application/pgp-signature]