Date: Tue, 21 Aug 2001 20:27:58 +1000
From: Keith Owens <>
Subject: Re: 2.4.8-ac8, agpgart, r128, and mtrr
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2001/8/21/43

On Tue, 21 Aug 2001 05:01:53 -0700 (PDT), 
Brian Dushaw <dushaw@apl.washington.edu> wrote:
>I have an ATI Technologies Inc Rage 128 PF video card.
>The module r128.o needs to have agpgart loaded first and depmod
>does not seem to set this up properly.  I've added the line:
>"pre-install r128 modprobe agpgart " to my /etc/modules.conf file.
"before r128 agpgart" is better.
>I wouldn't have thought this would require user intervention like this.
modprobe and depmod only handle direct symbol dependencies between
modules.  The only symbols exported by agpgart are agp_free_memory,
agp_allocate_memory, agp_copy_info, agp_bind_memory, agp_unbind_memory,
agp_enable, agp_backend_acquire, agp_backend_release.  None of these
symbols are referenced by r128 so modprobe is quite correct, there is
no symbol dependency between agpgart and r128.  If you want it to be
automatic, then r128 must reference an agpgart symbol.
But the drm maintainers decided not to rely on agp.  If agp is present
it will be used, if agp is not present then drm runs without it.
drivers/char/drm/drm_agpsupport.h uses inter_module_get() to see if agp
is loaded and to extract agp data, if available.  This allows drm to
run without forcing agp to be present and loaded.  So if you want agp
before drm, it must be explicitly loaded.  Design decision.
>Aug 20 13:04:37 localhost modprobe: modprobe: Can't locate module block-major-33
block-major-33 is the third IDE hard disk/CD-ROM interface, for hd[ef].
>Aug 20 13:04:40 localhost modprobe: modprobe: Can't locate module char-major-226
char-major-226 is DRI (DRM_MAJOR).  That one puzzles me, I cannot see
where it is being triggered from.
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.kernel.org
More majordomo info at  
http://vger.kernel.org/majordomo-info.html
Please read the FAQ at  
http://www.tux.org/lkml/