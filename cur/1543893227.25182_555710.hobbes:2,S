Date: Sun, 10 Jun 2007 18:39:19 +0200
From: "Udo A. Steinberg" <>
Subject: Re: libata limiting to UDMA/33 instead of UDMA/100
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2007/6/10/129

On Sun, 10 Jun 2007 17:12:59 +0100 Alan Cox (AC) wrote:
AC> Doh logic was backwards when moved from the old to new driver as the old
AC> driver was so messy.
AC> 
AC> Try this and if you can confirm it works and results match the cable you
AC> have.
AC> 
AC> --- drivers/ata/pata_pdc202xx_old.c~	2007-06-10 16:50:55.655743368
AC> +0100 +++ drivers/ata/pata_pdc202xx_old.c	2007-06-10
AC> 16:50:55.655743368 +0100 @@ -31,8 +31,8 @@
AC>  
AC>  	pci_read_config_word(pdev, 0x50, &cis);
AC>  	if (cis & (1 << (10 + ap->port_no)))
AC> -		return ATA_CBL_PATA80;
AC> -	return ATA_CBL_PATA40;
AC> +		return ATA_CBL_PATA40;
AC> +	return ATA_CBL_PATA80;
AC>  }
AC>  
AC>  /**
Alan,
The patch fixes my cable detection problem. Now everything is back to
UDMA/100 again. I noticed that ata1/ata2 claim to be using irq0, although
they do in fact use irq10. This seems to be a purely cosmetical problem.
ACPI: PCI Interrupt 0000:00:11.0[A] -> Link [LNKB] -> GSI 10 (level, low) -> IRQ 10
scsi0 : pata_pdc202xx_old
scsi1 : pata_pdc202xx_old
ata1: PATA max UDMA/100 cmd 0x00019400 ctl 0x00019002 bmdma 0x00018000 irq 0
ata2: PATA max UDMA/100 cmd 0x00018800 ctl 0x00018402 bmdma 0x00018008 irq 0
ata1.00: ata_hpa_resize 1: sectors = 60036480, hpa_sectors = 60036480
ata1.00: ATA-5: IBM-DTLA-307030, TX4OA5AA, max UDMA/100
ata1.00: 60036480 sectors, multi 16: LBA 
ata1.01: ata_hpa_resize 1: sectors = 241254720, hpa_sectors = 241254720
ata1.01: ATA-6: IC35L120AVV207-0, V24OA63A, max UDMA/100
ata1.01: 241254720 sectors, multi 16: LBA48 
ata1.00: ata_hpa_resize 1: sectors = 60036480, hpa_sectors = 60036480
ata1.00: configured for UDMA/100
ata1.01: ata_hpa_resize 1: sectors = 241254720, hpa_sectors = 241254720
ata1.01: configured for UDMA/100
Cheers,
	- Udo
[unhandled content-type:application/pgp-signature]