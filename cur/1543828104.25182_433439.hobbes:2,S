Date: Fri, 16 Jun 2006 17:51:20 +0200
From: Jan Blunck <>
Subject: Re: [patch 0/5] [PATCH,RFC] vfs: per-superblock unused dentries list (2nd version)
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2006/6/16/96

On Mon, Jun 05, Neil Brown wrote:
> I understand that this is where problem is because the selected
> dentries don't stay at the end of the list very long in some
> circumstances. In particular, other filesystems' dentries get mixed
> in. 
No. The problem is that the LRU list is too long and therefore unmounting
seems to take ages.
> You have addressed this by having multiple unused lists so the
> dentries of other filesystems don't get mixed in.
> 
> It seems to me that an alternate approach would be:
> 
>   - get select_parent and shrink_dcache_anon to move the selected
>     dentries on to some new list.
>   - pass this list to prune_dcache
>   - splice any remainder back on to the global list when finished.
I had this idea too. At least select_parent could use something like that. But
that wouldn't help in the umount situation.
Jan
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.kernel.org
More majordomo info at  
http://vger.kernel.org/majordomo-info.html
Please read the FAQ at  
http://www.tux.org/lkml/