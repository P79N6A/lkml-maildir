Date: Tue, 25 Sep 2007 09:13:16 +0800
From: lepton <>
Subject: Re: [PATCH] 2.6.22.6 user-mode linux: use address instead of value as argument in os_free_irq_by_cb
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2007/9/24/481

I added dump_stack and some printk in host kernel. The following is what 
I got when sys_reboot in host kernel is called, the first line is 
printing the process state and ptrace state and pid of the calling
process. the following is the call path.
Sep 22 14:25:49 pc kernel: linux         Rptrace: 00000000 pid:3698
Sep 22 14:25:49 pc kernel:  [<c01234a7>] kernel_halt+0x8/0x24
Sep 22 14:25:49 pc kernel:  [<c01239b2>] sys_reboot+0x14c/0x1c7
Sep 22 14:25:49 pc kernel:  [<c0120712>] recalc_sigpending+0xb/0x1d
Sep 22 14:25:49 pc kernel:  [<c0121ed2>] dequeue_signal+0x9d/0x11b
Sep 22 14:25:49 pc kernel:  [<c012222b>]
get_signal_to_deliver+0xe1/0x389
Sep 22 14:25:49 pc kernel:  [<c0101bd5>] do_notify_resume+0x84/0x5f1
Sep 22 14:25:49 pc kernel:  [<c012212c>] ptrace_notify+0x6f/0x8d
Sep 22 14:25:49 pc kernel:  [<c010249e>] syscall_call+0x7/0xb
Sep 22 14:25:49 pc kernel:  =======================
Sep 22 14:25:50 pc kernel: sd 1:0:0:0: [sda] Synchronizing SCSI cache
Sep 22 14:25:50 pc kernel: sd 1:0:0:0: [sda] Stopping disk
Sep 22 14:25:51 pc kernel: System halted.
On Mon, Sep 24, 2007 at 01:02:20PM -0400, Jeff Dike wrote:
> I would say that you shouldn't be running UMLs as root.  However, a
> sys_reboot shouldn't escape being ptraced either.  This is a bug, but
> I don't see any connection between it and ptrace missing a final
> system call.
> 
> 				Jeff
> 
> -- 
> Work email - jdike at linux dot intel dot com
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.kernel.org
More majordomo info at  
http://vger.kernel.org/majordomo-info.html
Please read the FAQ at  
http://www.tux.org/lkml/