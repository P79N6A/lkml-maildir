Date: Fri, 7 Jan 2000 22:33:35 -0800
From: Richard Henderson <>
Subject: axp 2.3.38 patches
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2000/1/8/54

The first half are for correctness, the second half
are for warnings (primarily lseek definition errors
and printf type mismatches).
r~
diff -rup linux/arch/alpha/config.in 2.3.38/arch/alpha/config.in
--- linux/arch/alpha/config.in	Thu Jan  6 15:04:09 2000
+++ 2.3.38/arch/alpha/config.in	Fri Jan  7 19:03:50 2000
@@ -250,6 +250,10 @@ endmenu
 
 source drivers/char/Config.in
 
+source drivers/usb/Config.in
+
+source drivers/misc/Config.in
+
 source fs/Config.in
 
 if [ "$CONFIG_VT" = "y" ]; then
diff -rup linux/arch/alpha/defconfig 2.3.38/arch/alpha/defconfig
--- linux/arch/alpha/defconfig	Thu Jan  6 15:04:09 2000
+++ 2.3.38/arch/alpha/defconfig	Fri Jan  7 19:06:58 2000
@@ -28,6 +28,7 @@ CONFIG_ALPHA_GENERIC=y
 # CONFIG_ALPHA_EB64P is not set
 # CONFIG_ALPHA_EB66 is not set
 # CONFIG_ALPHA_EB66P is not set
+# CONFIG_ALPHA_EIGER is not set
 # CONFIG_ALPHA_JENSEN is not set
 # CONFIG_ALPHA_LX164 is not set
 # CONFIG_ALPHA_MIATA is not set
@@ -44,14 +45,14 @@ CONFIG_ALPHA_GENERIC=y
 # CONFIG_ALPHA_SABLE is not set
 # CONFIG_ALPHA_TAKARA is not set
 CONFIG_PCI=y
-CONFIG_PCI_NAMES=y
 # CONFIG_SMP is not set
+CONFIG_PCI_NAMES=y
 CONFIG_NET=y
 CONFIG_SYSVIPC=y
 # CONFIG_BSD_PROCESS_ACCT is not set
+CONFIG_SYSCTL=y
 CONFIG_KCORE_ELF=y
 # CONFIG_KCORE_AOUT is not set
-CONFIG_SYSCTL=y
 CONFIG_BINFMT_AOUT=y
 CONFIG_BINFMT_ELF=y
 # CONFIG_BINFMT_MISC is not set
@@ -84,6 +85,7 @@ CONFIG_BLK_DEV_FD=y
 # CONFIG_BLK_DEV_MD is not set
 # CONFIG_BLK_DEV_RAM is not set
 # CONFIG_BLK_DEV_XD is not set
+# CONFIG_BLK_DEV_DAC960 is not set
 CONFIG_PARIDE_PARPORT=y
 # CONFIG_PARIDE is not set
 # CONFIG_BLK_DEV_IDE_MODES is not set
@@ -92,7 +94,8 @@ CONFIG_PARIDE_PARPORT=y
 #
 # Networking options
 #
-# CONFIG_PACKET is not set
+CONFIG_PACKET=y
+# CONFIG_PACKET_MMAP is not set
 # CONFIG_NETLINK is not set
 # CONFIG_NETFILTER is not set
 # CONFIG_FILTER is not set
@@ -135,6 +138,7 @@ CONFIG_BLK_DEV_SR=y
 #
 # Some SCSI devices (e.g. CD jukebox) support multiple LUNs
 #
+# CONFIG_SCSI_DEBUG_QUEUES is not set
 # CONFIG_SCSI_MULTI_LUN is not set
 CONFIG_SCSI_CONSTANTS=y
 # CONFIG_SCSI_LOGGING is not set
@@ -148,6 +152,7 @@ CONFIG_SCSI_CONSTANTS=y
 # CONFIG_SCSI_AHA1542 is not set
 # CONFIG_SCSI_AHA1740 is not set
 # CONFIG_SCSI_AIC7XXX is not set
+# CONFIG_SCSI_IPS is not set
 # CONFIG_SCSI_ADVANSYS is not set
 # CONFIG_SCSI_IN2000 is not set
 # CONFIG_SCSI_AM53C974 is not set
@@ -164,6 +169,7 @@ CONFIG_SCSI_CONSTANTS=y
 # CONFIG_SCSI_INIA100 is not set
 # CONFIG_SCSI_NCR53C406A is not set
 # CONFIG_SCSI_SYM53C416 is not set
+# CONFIG_SCSI_SIM710 is not set
 # CONFIG_SCSI_NCR53C7xx is not set
 # CONFIG_SCSI_NCR53C8XX is not set
 # CONFIG_SCSI_SYM53C8XX is not set
@@ -201,6 +207,7 @@ CONFIG_NET_ETHERNET=y
 # CONFIG_LANCE is not set
 # CONFIG_NET_VENDOR_SMC is not set
 # CONFIG_NET_VENDOR_RACAL is not set
+# CONFIG_DEPCA is not set
 # CONFIG_NET_ISA is not set
 CONFIG_NET_EISA=y
 # CONFIG_PCNET32 is not set
@@ -211,16 +218,27 @@ CONFIG_DE4X5=y
 # CONFIG_DGRS is not set
 # CONFIG_EEXPRESS_PRO100 is not set
 # CONFIG_NE2K_PCI is not set
+# CONFIG_SIS900 is not set
 # CONFIG_TLAN is not set
 # CONFIG_VIA_RHINE is not set
 # CONFIG_NET_POCKET is not set
+
+#
+# Ethernet (1000 Mbit)
+#
+# CONFIG_ACENIC is not set
+# CONFIG_SK98LIN is not set
 # CONFIG_FDDI is not set
 # CONFIG_PPP is not set
 # CONFIG_SLIP is not set
+
+#
+# Wireless LAN (non-hamradio)
+#
 # CONFIG_NET_RADIO is not set
 
 #
-# Token ring devices
+# Token Ring driver support
 #
 # CONFIG_TR is not set
 # CONFIG_NET_FC is not set
@@ -228,13 +246,12 @@ CONFIG_DE4X5=y
 #
 # Wan interfaces
 #
-# CONFIG_HOSTESS_SV11 is not set
-# CONFIG_COSA is not set
-# CONFIG_SEALEVEL_4021 is not set
-# CONFIG_DLCI is not set
-# CONFIG_WAN_DRIVERS is not set
-# CONFIG_LAPBETHER is not set
-# CONFIG_X25_ASY is not set
+# CONFIG_WAN is not set
+
+#
+# PCMCIA network device support
+#
+# CONFIG_NET_PCMCIA is not set
 
 #
 # Amateur Radio support
@@ -264,6 +281,11 @@ CONFIG_UNIX98_PTYS=y
 CONFIG_UNIX98_PTY_COUNT=256
 
 #
+# I2C support
+#
+# CONFIG_I2C is not set
+
+#
 # Mice
 #
 # CONFIG_BUSMOUSE is not set
@@ -271,7 +293,16 @@ CONFIG_MOUSE=y
 CONFIG_PSMOUSE=y
 # CONFIG_82C710_MOUSE is not set
 # CONFIG_PC110_PAD is not set
+
+#
+# Joysticks
+#
+# CONFIG_JOYSTICK is not set
 # CONFIG_QIC02_TAPE is not set
+
+#
+# Watchdog Cards
+#
 # CONFIG_WATCHDOG is not set
 # CONFIG_NVRAM is not set
 # CONFIG_RTC is not set
@@ -280,17 +311,31 @@ CONFIG_PSMOUSE=y
 # Video For Linux
 #
 # CONFIG_VIDEO_DEV is not set
-
-#
-# Joystick support
-#
-# CONFIG_JOYSTICK is not set
 # CONFIG_DTLK is not set
+# CONFIG_R3964 is not set
+# CONFIG_APPLICOM is not set
 
 #
 # Ftape, the floppy tape device driver
 #
 # CONFIG_FTAPE is not set
+# CONFIG_DRM is not set
+# CONFIG_DRM_TDFX is not set
+
+#
+# PCMCIA character device support
+#
+CONFIG_PCMCIA_SERIAL=y
+# CONFIG_PCMCIA_SERIAL_CS is not set
+
+#
+# USB support
+#
+# CONFIG_USB is not set
+
+#
+# Misc devices
+#
 
 #
 # Filesystems
@@ -298,11 +343,11 @@ CONFIG_PSMOUSE=y
 # CONFIG_QUOTA is not set
 # CONFIG_AUTOFS_FS is not set
 # CONFIG_AFFS_FS is not set
-# CONFIG_HFS_FS is not set
 # CONFIG_FAT_FS is not set
 # CONFIG_MSDOS_FS is not set
 # CONFIG_UMSDOS_FS is not set
 # CONFIG_VFAT_FS is not set
+# CONFIG_CRAMFS is not set
 CONFIG_ISO9660_FS=y
 # CONFIG_JOLIET is not set
 # CONFIG_MINIX_FS is not set
@@ -313,6 +358,7 @@ CONFIG_DEVPTS_FS=y
 # CONFIG_ROMFS_FS is not set
 CONFIG_EXT2_FS=y
 # CONFIG_SYSV_FS is not set
+# CONFIG_UDF_FS is not set
 # CONFIG_UFS_FS is not set
 
 #
@@ -320,6 +366,7 @@ CONFIG_EXT2_FS=y
 #
 # CONFIG_CODA_FS is not set
 CONFIG_NFS_FS=y
+# CONFIG_NFSD is not set
 CONFIG_SUNRPC=y
 CONFIG_LOCKD=y
 # CONFIG_SMB_FS is not set
@@ -329,16 +376,20 @@ CONFIG_LOCKD=y
 # Partition Types
 #
 # CONFIG_PARTITION_ADVANCED is not set
-CONFIG_MSDOS_PARTITION=y
 CONFIG_OSF_PARTITION=y
-# CONFIG_SMD_DISKLABEL is not set
-# CONFIG_SGI_DISKLABEL is not set
+CONFIG_MSDOS_PARTITION=y
+# CONFIG_SGI_PARTITION is not set
+# CONFIG_SUN_PARTITION is not set
 # CONFIG_NLS is not set
 
 #
 # Console drivers
 #
 CONFIG_VGA_CONSOLE=y
+
+#
+# Frame-buffer support
+#
 # CONFIG_FB is not set
 
 #
diff -rup linux/arch/alpha/kernel/osf_sys.c 2.3.38/arch/alpha/kernel/osf_sys.c
--- linux/arch/alpha/kernel/osf_sys.c	Fri Jan  7 19:30:22 2000
+++ 2.3.38/arch/alpha/kernel/osf_sys.c	Fri Jan  7 19:01:45 2000
@@ -439,7 +439,7 @@ static int osf_ufs_mount(char *dirname, 
 
 	dentry = getdev(tmp.devname, 0);
 	retval = PTR_ERR(dentry);
-	if (IS_ERR(dentry)
+	if (IS_ERR(dentry))
 		goto out;
 	retval = do_mount(dentry->d_inode->i_bdev, tmp.devname, dirname, 
 				"ext2", flags, NULL);
@@ -471,7 +471,6 @@ out:
 
 static int osf_procfs_mount(char *dirname, struct procfs_args *args, int flags)
 {
-	int retval;
 	struct procfs_args tmp;
 
 	if (copy_from_user(&tmp, args, sizeof(tmp)))
diff -rup linux/arch/alpha/kernel/pci.c 2.3.38/arch/alpha/kernel/pci.c
--- linux/arch/alpha/kernel/pci.c	Thu Jan  6 15:04:15 2000
+++ 2.3.38/arch/alpha/kernel/pci.c	Fri Jan  7 19:01:45 2000
@@ -251,11 +251,13 @@ pcibios_fixup_bus(struct pci_bus *bus)
 	/* Propogate hose info into the subordinate devices.  */
 
 	struct pci_controler *hose = (struct pci_controler *) bus->sysdata;
-	struct pci_dev *dev;
+	struct list_head *ln;
 
 	bus->resource[0] = hose->io_space;
 	bus->resource[1] = hose->mem_space;
-	for (dev = bus->devices; dev; dev = dev->sibling) {
+
+	for (ln = bus->devices.next; ln != &bus->devices; ln = ln->next) {
+		struct pci_dev *dev = pci_dev_b(ln);
 		if ((dev->class >> 8) != PCI_CLASS_BRIDGE_PCI)
 			pcibios_fixup_device_resources(dev, bus);
 	}
diff -rup linux/arch/alpha/mm/init.c 2.3.38/arch/alpha/mm/init.c
--- linux/arch/alpha/mm/init.c	Thu Jan  6 15:04:15 2000
+++ 2.3.38/arch/alpha/mm/init.c	Fri Jan  7 19:01:45 2000
@@ -274,7 +274,8 @@ srm_paging_stop (void)
 }
 #endif
 
-static void __init printk_memory_info(void)
+static void __init
+printk_memory_info(void)
 {
 	unsigned long codesize, reservedpages, datasize, initsize, tmp;
 	extern int page_is_ram(unsigned long) __init;
diff -rup linux/drivers/scsi/scsi_merge.c 2.3.38/drivers/scsi/scsi_merge.c
--- linux/drivers/scsi/scsi_merge.c	Fri Jan  7 19:30:23 2000
+++ 2.3.38/drivers/scsi/scsi_merge.c	Fri Jan  7 19:24:00 2000
@@ -74,7 +74,7 @@
  * Enable a bunch of additional consistency checking.   Turn this off
  * if you are benchmarking.
  */
-static int dump_stats(struct request *req,
+static void dump_stats(struct request *req,
 		      int use_clustering,
 		      int dma_host,
 		      int segments)
@@ -113,6 +113,8 @@ here:									\
 	dump_stats(req, _CLUSTER, _DMA, __count_segments(req, _CLUSTER, _DMA, NULL)); \
     }
 #else
+#define dump_stats(req, use_clustering, dma_host, segments) \
+	panic("Ththththaats all folks.  Too dangerous to continue.\n")
 #define SANITY_CHECK(req, _CLUSTER, _DMA)
 #endif
 
diff -rup linux/include/asm-alpha/core_cia.h 2.3.38/include/asm-alpha/core_cia.h
--- linux/include/asm-alpha/core_cia.h	Wed Sep  1 15:34:01 1999
+++ 2.3.38/include/asm-alpha/core_cia.h	Fri Jan  7 19:08:30 2000
@@ -218,32 +218,12 @@
  * Data structure for handling CIA machine checks.
  */
 
-/* EV5-specific info.  */
-struct el_CIA_procdata {
-	unsigned long shadow[8];	/* PALmode shadow registers */
-	unsigned long paltemp[24];	/* PAL temporary registers */
-	/* EV5-specific fields */
-	unsigned long exc_addr;		/* Address of excepting instruction. */
-	unsigned long exc_sum;		/* Summary of arithmetic traps. */
-	unsigned long exc_mask;		/* Exception mask (from exc_sum). */
-	unsigned long exc_base;		/* PALbase at time of exception. */
-	unsigned long isr;		/* Interrupt summary register. */
-	unsigned long icsr;		/* Ibox control register. */
-	unsigned long ic_perr_stat;
-	unsigned long dc_perr_stat;
-	unsigned long va;		/* Effective VA of fault or miss. */
-	unsigned long mm_stat;
-	unsigned long sc_addr;
-	unsigned long sc_stat;
-	unsigned long bc_tag_addr;
-	unsigned long ei_addr;
-	unsigned long fill_syn;
-	unsigned long ei_stat;
-	unsigned long ld_lock;
-};
-
 /* System-specific info.  */
 struct el_CIA_sysdata_mcheck {
+#if 0
+	/* ??? Where did this come from.  It appears to bear no
+	   relation to the cia logout written in the milo sources.
+	   Who knows what happens in the srm console... */
 	unsigned long      coma_gcr;
 	unsigned long      coma_edsr;
 	unsigned long      coma_ter;
@@ -285,6 +265,19 @@ struct el_CIA_sysdata_mcheck {
 	unsigned long      epic_data5;
 	unsigned long      epic_data6;
 	unsigned long      epic_data7;
+#else
+	unsigned long	cpu_err0;
+	unsigned long	cpu_err1;
+	unsigned long	cia_err;
+	unsigned long	cia_stat;
+	unsigned long	err_mask;
+	unsigned long	cia_syn;
+	unsigned long	mem_err0;
+	unsigned long	mem_err1;
+	unsigned long	pci_err0;
+	unsigned long	pci_err1;
+	unsigned long	pci_err2;
+#endif
 };
 
 
diff -rup linux/include/asm-alpha/core_pyxis.h 2.3.38/include/asm-alpha/core_pyxis.h
--- linux/include/asm-alpha/core_pyxis.h	Wed Sep  1 15:34:01 1999
+++ 2.3.38/include/asm-alpha/core_pyxis.h	Fri Jan  7 19:08:30 2000
@@ -203,6 +203,10 @@
  * Data structure for handling PYXIS machine checks:
  */
 struct el_PYXIS_sysdata_mcheck {
+#if 0
+	/* ??? Where did this come from.  It appears to bear no
+	   relation to the pyxis logout written in the milo sources.
+	   Who knows what happens in the srm console... */
     u_long      coma_gcr;
     u_long      coma_edsr;
     u_long      coma_ter;
@@ -244,6 +248,19 @@ struct el_PYXIS_sysdata_mcheck {
     u_long      epic_data5;
     u_long      epic_data6;
     u_long      epic_data7;
+#else
+	unsigned long	cpu_err0;
+	unsigned long	cpu_err1;
+	unsigned long	cia_err;
+	unsigned long	cia_stat;
+	unsigned long	err_mask;
+	unsigned long	cia_syn;
+	unsigned long	mem_err0;
+	unsigned long	mem_err1;
+	unsigned long	pci_err0;
+	unsigned long	pci_err1;
+	unsigned long	pci_err2;
+#endif
 };
 
 diff -rup linux/drivers/char/tty_io.c 2.3.38/drivers/char/tty_io.c
--- linux/drivers/char/tty_io.c	Tue Oct 19 10:22:20 1999
+++ 2.3.38/drivers/char/tty_io.c	Fri Jan  7 19:01:45 2000
@@ -344,7 +344,7 @@ static int hung_up_tty_ioctl(struct inod
 	return cmd == TIOCSPGRP ? -ENOTTY : -EIO;
 }
 
-static long long tty_lseek(struct file * file,	long long offset, int orig)
+static loff_t tty_lseek(struct file * file, loff_t offset, int orig)
 {
 	return -ESPIPE;
 }
diff -rup linux/drivers/char/vc_screen.c 2.3.38/drivers/char/vc_screen.c
--- linux/drivers/char/vc_screen.c	Thu Aug  5 14:34:02 1999
+++ 2.3.38/drivers/char/vc_screen.c	Fri Jan  7 19:01:45 2000
@@ -59,7 +59,7 @@ vcs_size(struct inode *inode)
 	return size;
 }
 
-static long long vcs_lseek(struct file *file, long long offset, int orig)
+static loff_t vcs_lseek(struct file *file, loff_t offset, int orig)
 {
 	int size = vcs_size(file->f_dentry->d_inode);
 
diff -rup linux/drivers/pnp/quirks.c 2.3.38/drivers/pnp/quirks.c
--- linux/drivers/pnp/quirks.c	Fri Jan  7 19:30:22 2000
+++ 2.3.38/drivers/pnp/quirks.c	Fri Jan  7 19:26:16 2000
@@ -16,6 +16,8 @@
 #include <linux/pci.h>
 #include <linux/init.h>
 #include <linux/isapnp.h>
+#include <linux/string.h>
+
 
 static void __init quirk_awe32_resources(struct pci_dev *dev)
 {
diff -rup linux/fs/ext2/file.c 2.3.38/fs/ext2/file.c
--- linux/fs/ext2/file.c	Fri Jan  7 19:30:24 2000
+++ 2.3.38/fs/ext2/file.c	Fri Jan  7 19:02:31 2000
@@ -28,7 +28,7 @@
 #define MIN(a,b) (((a)<(b))?(a):(b))
 #define MAX(a,b) (((a)>(b))?(a):(b))
 
-static long long ext2_file_lseek(struct file *, long long, int);
+static loff_t ext2_file_lseek(struct file *, loff_t, int);
 static int ext2_open_file (struct inode *, struct file *);
 
 #define EXT2_MAX_SIZE(bits)							\
@@ -45,9 +45,9 @@ EXT2_MAX_SIZE(10), EXT2_MAX_SIZE(11), EX
 /*
  * Make sure the offset never goes beyond the 32-bit mark..
  */
-static long long ext2_file_lseek(
+static loff_t ext2_file_lseek(
 	struct file *file,
-	long long offset,
+	loff_t offset,
 	int origin)
 {
 	struct inode *inode = file->f_dentry->d_inode;
diff -rup linux/fs/lockd/xdr.c 2.3.38/fs/lockd/xdr.c
--- linux/fs/lockd/xdr.c	Sat Feb  6 12:46:21 1999
+++ 2.3.38/fs/lockd/xdr.c	Fri Jan  7 19:01:45 2000
@@ -95,8 +95,8 @@ nlm_decode_fh(u32 *p, struct nfs_fh *f)
 
 	if ((len = ntohl(*p++)) != sizeof(*f)) {
 		printk(KERN_NOTICE
-			"lockd: bad fhandle size %x (should be %d)\n",
-			len, sizeof(*f));
+			"lockd: bad fhandle size %u (should be %lu)\n",
+			len, (unsigned long) sizeof(*f));
 		return NULL;
 	}
 	memcpy(f, p, sizeof(*f));
diff -rup linux/fs/nfs/inode.c 2.3.38/fs/nfs/inode.c
--- linux/fs/nfs/inode.c	Thu Jan  6 15:04:09 2000
+++ 2.3.38/fs/nfs/inode.c	Fri Jan  7 19:01:45 2000
@@ -681,7 +681,7 @@ printk("nfs_notify_change: revalidate fa
 	if (attr->ia_valid & ATTR_SIZE) {
 		if (attr->ia_size != fattr.size)
 			printk("nfs_notify_change: attr=%Ld, fattr=%d??\n",
-				attr->ia_size, fattr.size);
+			       (long long) attr->ia_size, fattr.size);
 		inode->i_size  = attr->ia_size;
 		inode->i_mtime = fattr.mtime.seconds;
 	}
diff -rup linux/fs/nfsd/export.c 2.3.38/fs/nfsd/export.c
--- linux/fs/nfsd/export.c	Thu Jan  6 15:04:14 2000
+++ 2.3.38/fs/nfsd/export.c	Fri Jan  7 19:01:45 2000
@@ -221,7 +221,7 @@ exp_export(struct nfsctl_export *nxp)
 
 	dprintk("exp_export called for %s:%s (%x/%ld fl %x).\n",
 			nxp->ex_client, nxp->ex_path,
-			nxp->ex_dev, nxp->ex_ino, nxp->ex_flags);
+			nxp->ex_dev, (long) nxp->ex_ino, nxp->ex_flags);
 	dev = to_kdev_t(nxp->ex_dev);
 	ino = nxp->ex_ino;
 
@@ -453,11 +453,11 @@ exp_rootfh(struct svc_client *clp, kdev_
 		ino = dentry->d_inode->i_ino;
 	
 		dprintk("nfsd: exp_rootfh(%s [%p] %s:%x/%ld)\n",
-		         path, dentry, clp->cl_ident, dev, ino);
+		         path, dentry, clp->cl_ident, dev, (long) ino);
 		exp = exp_parent(clp, dev, dentry);
 	} else {
 		dprintk("nfsd: exp_rootfh(%s:%x/%ld)\n",
-		         clp->cl_ident, dev, ino);
+		         clp->cl_ident, dev, (long) ino);
 		if ((exp = exp_get(clp, dev, ino)))
 			if (!(dentry = dget(exp->ex_dentry))) {
 				printk("exp_rootfh: Aieee, NULL dentry\n");
@@ -478,7 +478,7 @@ exp_rootfh(struct svc_client *clp, kdev_
 		printk("exp_rootfh: Aieee, ino/dev mismatch\n");
 		printk("exp_rootfh: arg[dev(%x):ino(%ld)]"
 		       " inode[dev(%x):ino(%ld)]\n",
-		       dev, ino, inode->i_dev, inode->i_ino);
+		       dev, (long) ino, inode->i_dev, (long) inode->i_ino);
 	}
 
 	/*
diff -rup linux/fs/nfsd/nfsfh.c 2.3.38/fs/nfsd/nfsfh.c
--- linux/fs/nfsd/nfsfh.c	Mon Nov 22 17:29:23 1999
+++ 2.3.38/fs/nfsd/nfsfh.c	Fri Jan  7 19:01:45 2000
@@ -614,7 +614,7 @@ fh_compose(struct svc_fh *fhp, struct sv
 	struct dentry *parent = dentry->d_parent;
 
 	dprintk("nfsd: fh_compose(exp %x/%ld %s/%s, ino=%ld)\n",
-		exp->ex_dev, exp->ex_ino,
+		exp->ex_dev, (long) exp->ex_ino,
 		parent->d_name.name, dentry->d_name.name,
 		(inode ? inode->i_ino : 0));
 
diff -rup linux/fs/proc/generic.c 2.3.38/fs/proc/generic.c
--- linux/fs/proc/generic.c	Thu Jan  6 15:04:14 2000
+++ 2.3.38/fs/proc/generic.c	Fri Jan  7 19:01:45 2000
@@ -20,7 +20,7 @@ static ssize_t proc_file_read(struct fil
 			      size_t nbytes, loff_t *ppos);
 static ssize_t proc_file_write(struct file * file, const char * buffer,
 			       size_t count, loff_t *ppos);
-static long long proc_file_lseek(struct file *, long long, int);
+static loff_t proc_file_lseek(struct file *, loff_t, int);
 
 int proc_match(int len, const char *name,struct proc_dir_entry * de)
 {
@@ -139,8 +139,8 @@ proc_file_write(struct file * file, cons
 }
 
 
-static long long
-proc_file_lseek(struct file * file, long long offset, int orig)
+static loff_t
+proc_file_lseek(struct file * file, loff_t offset, int orig)
 {
     switch (orig) {
     case 0:
diff -rup linux/net/ipv4/route.c 2.3.38/net/ipv4/route.c
--- linux/net/ipv4/route.c	Fri Jan  7 19:30:27 2000
+++ 2.3.38/net/ipv4/route.c	Fri Jan  7 19:26:16 2000
@@ -2261,8 +2261,9 @@ void __init ip_rt_init(void)
 	if (!rt_hash_table)
 		panic("Failed to allocate IP route cache hash table\n");
 
-	printk("IP: routing cache hash table of %u buckets, %dKbytes\n",
-	       rt_hash_mask, (rt_hash_mask*sizeof(struct rt_hash_bucket))/1024);
+	printk("IP: routing cache hash table of %u buckets, %ldKbytes\n",
+	       rt_hash_mask,
+	       (long) (rt_hash_mask*sizeof(struct rt_hash_bucket))/1024);
 
 	for (rt_hash_log=0; (1<<rt_hash_log) != rt_hash_mask; rt_hash_log++)
 		/* NOTHING */;
diff -rup linux/net/socket.c 2.3.38/net/socket.c
--- linux/net/socket.c	Thu Jan  6 15:04:08 2000
+++ 2.3.38/net/socket.c	Fri Jan  7 19:01:45 2000
@@ -85,7 +85,7 @@
 #include <linux/netfilter.h>
 
 static int sock_no_open(struct inode *irrelevant, struct file *dontcare);
-static long long sock_lseek(struct file *file, long long offset, int whence);
+static loff_t sock_lseek(struct file *file, loff_t offset, int whence);
 static ssize_t sock_read(struct file *file, char *buf,
 			 size_t size, loff_t *ppos);
 static ssize_t sock_write(struct file *file, const char *buf,
@@ -419,7 +419,7 @@ int sock_recvmsg(struct socket *sock, st
  *	Sockets are not seekable.
  */
 
-static long long sock_lseek(struct file *file,long long offset, int whence)
+static loff_t sock_lseek(struct file *file, loff_t offset, int whence)
 {
 	return -ESPIPE;
 }
diff -rup linux/net/sunrpc/svcsock.c 2.3.38/net/sunrpc/svcsock.c
--- linux/net/sunrpc/svcsock.c	Mon Aug 23 10:01:02 1999
+++ 2.3.38/net/sunrpc/svcsock.c	Fri Jan  7 19:01:45 2000
@@ -266,10 +266,10 @@ svc_sendto(struct svc_rqst *rqstp, struc
 	set_fs(oldfs);
 #endif
 
-	dprintk("svc: socket %p sendto([%p %d... ], %d, %d) = %d\n",
-			rqstp->rq_sock,
-			iov[0].iov_base, iov[0].iov_len, nr,
-			buflen, len);
+	dprintk("svc: socket %p sendto([%p %lu... ], %d, %d) = %d\n",
+		rqstp->rq_sock, iov[0].iov_base,
+		(unsigned long) iov[0].iov_len, nr,
+		buflen, len);
 
 	return len;
 }
@@ -326,8 +326,8 @@ svc_recvfrom(struct svc_rqst *rqstp, str
 	set_fs(oldfs);
 #endif
 
-	dprintk("svc: socket %p recvfrom(%p, %d) = %d\n", rqstp->rq_sock,
-				iov[0].iov_base, iov[0].iov_len, len);
+	dprintk("svc: socket %p recvfrom(%p, %lu) = %d\n", rqstp->rq_sock,
+		iov[0].iov_base, (unsigned long) iov[0].iov_len, len);
 
 	return len;
 }