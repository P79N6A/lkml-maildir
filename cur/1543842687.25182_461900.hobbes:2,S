Date: Sat, 09 Sep 2006 16:36:26 -0700
From: Jeremy Fitzhardinge <>
Subject: [PATCH] Fix asm-i386/desc.h:pack_descriptor()
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2006/9/9/142

Fix pack_descriptor:
 1. flags are bits 20-23 in the high word
 2. limit's 4 msb are bits 16-19 in the high word
These haven't mattered so far, because all users have had small limits
and a flags setting of 0.
Signed-off-by: Jeremy Fitzhardinge <jeremy@xensource.com>
===================================================================
--- a/include/asm-i386/desc.h
+++ b/include/asm-i386/desc.h
@@ -41,7 +41,7 @@ static inline void pack_descriptor(__u32
 {
 	*a = ((base & 0xffff) << 16) | (limit & 0xffff);
 	*b = (base & 0xff000000) | ((base & 0xff0000) >> 16) |
-	     ((type & 0xff) << 8) | ((flags & 0xf) << 12);
+		(limit & 0x000f0000) | ((type & 0xff) << 8) | ((flags & 0xf) << 20);
 }
 
 static inline void pack_gate(__u32 *a, __u32 *b,
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.kernel.org
More majordomo info at  
http://vger.kernel.org/majordomo-info.html
Please read the FAQ at  
http://www.tux.org/lkml/