Date: Wed, 22 Aug 2007 20:08:25 -0600
From: Zan Lynx <>
Subject: Re: 2.6.23-rc3-mm1 - memory layout change?  - lost support for MAP_32BIT? - mono crashes
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2007/8/22/548

On Wed, 2007-08-22 at 02:06 -0700, Andrew Morton wrote:
> 
ftp://ftp.kernel.org/pub/linux/kernel/people/akpm/patches/2.6/2.6.23-rc3/2.6.23-rc3-mm1/
After installing this new wonder kernel on my AMD-64 laptop, I
discovered that Beagle wouldn't start.  While enjoying how fast my
system felt ( :) ) I also discovered that Evolution wouldn't start
because it was built with mono integration.
Can't live without email, so I poked at it and discovered that if I run
mono applications (including Evolution) with the legacy memory layout,
they work.
Like this: setarch x86_64 -L evolution
This didn't happen on -rc2-mm2, so I think somebody changed something.
Mono claims to mmap with the MAP_32BIT option.
In -rc3-mm1 strace shows mono's mmap like this:
mmap(NULL, 65536, PROT_READ|PROT_WRITE|PROT_EXEC, MAP_PRIVATE|MAP_ANONYMOUS|MAP_32BIT, -1, 0) = 0x7fa21f5cb000
It's got MAP_32BIT, but that's not a 32-bit address...
-- 
Zan Lynx <zlynx@acm.org>
[unhandled content-type:application/pgp-signature]