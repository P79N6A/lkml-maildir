Date: Thu, 29 Jul 2004 15:17:21 -0700
From: Jesse Barnes <>
Subject: Re: arch_init_sched_domains() oops
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2004/7/29/293

On Thursday, July 29, 2004 2:56 pm, Dave Hansen wrote:
> This happened on a NUMA running 2.6.8-rc2-mm1:
Is this stock 2.6.8-rc2-mm1?  If so, you may need the attached patch.
Jesse
diff -Napur -X /home/jbarnes/dontdiff linux-2.6.8-rc2-mm1.orig/kernel/sched.c linux-2.6.8-rc2-mm1/kernel/sched.c
--- linux-2.6.8-rc2-mm1.orig/kernel/sched.c	2004-07-28 09:36:36.000000000 -0700
+++ linux-2.6.8-rc2-mm1/kernel/sched.c	2004-07-28 09:34:45.000000000 -0700
@@ -3770,8 +3770,6 @@ __init static void arch_init_sched_domai
 		cpumask_t nodemask = node_to_cpumask(cpu_to_node(i));
 
 #ifdef CONFIG_NUMA
-		if (i != first_cpu(sd->groups->cpumask))
-			continue;
 		sd = &per_cpu(node_domains, i);
 		group = cpu_to_node_group(i);
 		*sd = SD_NODE_INIT;