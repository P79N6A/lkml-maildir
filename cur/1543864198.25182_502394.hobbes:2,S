Date: Sat, 27 Jan 2007 21:41:02 -0500
From: 	Valdis.Kletnieks@vt ...
Subject: Re: mm snapshot broken-out-2007-01-26-00-36.tar.gz uploaded
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2007/1/27/166

On Sat, 27 Jan 2007 13:41:16 PST, Andrew Morton said:
> > > On 26/01/07, akpm@osdl.org <akpm@osdl.org> wrote:
> > >> The mm snapshot broken-out-2007-01-26-00-36.tar.gz has been uploaded to
> > >> 
ftp://ftp.kernel.org/pub/linux/kernel/people/akpm/mm/broken-out-2007-01-26-00-36.tar.gz
> I have everything compiling now, mostly.  The number of fixes which were
> needed was just extraordinary.  I'm thinking about making changes...
Another one - I can't get this to build for x86_64. (Skipping over all the
already-mentioned build errors that others have already reported...)
First, I had to do some ad-crock hacking of Kconfig files to get kernel/timer.c
to build right, because otherwise it didn't include any of the defines in
include/kernel/clockchips.c so CLOCK_EVT_NOTIFY_RESUME wasn't defined (either
that, or a #ifdef for GENERIC_TIME had its #endif land in the wrong place?)
--- linux-2.6.20-rc6-mm1/arch/x86_64/Kconfig.dist	2007-01-26 14:30:53.000000000 -0500
+++ linux-2.6.20-rc6-mm1/arch/x86_64/Kconfig	2007-01-27 07:14:22.000000000 -0500
@@ -32,6 +32,14 @@ config GENERIC_TIME_VSYSCALL
 	bool
 	default y
 
+config GENERIC_CLOCKEVENTS
+	bool
+	default y
+
+config GENERIC_CLOCKEVENTS_BROADCAST
+	bool
+	default y
+
 config ZONE_DMA32
 	bool
 	default y
@@ -126,6 +134,8 @@ source "init/Kconfig"
 
 menu "Processor type and features"
 
+source "kernel/time/Kconfig"
+
 choice
 	prompt "Subarchitecture Type"
 	default X86_PC
And even after that, I hit this:
  CC      kernel/time/clocksource.o
In file included from kernel/time/clocksource.c:31:
include/linux/tick.h:45: error: field sched_timer has incomplete type
make: *** [kernel/time/clocksource.o: Error 1
--- linux-2.6.20-rc6-mm1/kernel/time/clocksource.c.dist	2007-01-27 19:36:31.000000000 -0500
+++ linux-2.6.20-rc6-mm1/kernel/time/clocksource.c	2007-01-27 19:36:03.000000000 -0500
@@ -28,6 +28,7 @@
 #include <linux/sysdev.h>
 #include <linux/init.h>
 #include <linux/module.h>
+#include <linux/hrtimer.h>
 #include <linux/tick.h>
 
 /* XXX - Would like a better way for initializing curr_clocksource */
Then we live long enough to hit this:
  CC      block/elevator.o
block/elevator.c: In function elv_insert:
block/elevator.c:611: error: unplug_it undeclared (first use in this function)
--- linux-2.6.20-rc6-mm1/block/elevator.c.dist	2007-01-26 14:30:36.000000000 -0500
+++ linux-2.6.20-rc6-mm1/block/elevator.c	2007-01-27 19:57:02.000000000 -0500
@@ -604,12 +604,6 @@ void elv_insert(request_queue_t *q, stru
 		 */
 		rq->cmd_flags |= REQ_SOFTBARRIER;
 
-		/*
-		 * Most requeues happen because of a busy condition,
-		 * don't force unplug of the queue for that case.
-		 */
-		unplug_it = 0;
-
 		if (q->ordseq == 0) {
 			list_add(&rq->queuelist, &q->queue_head);
 			break;
(How did *that* one manage to compile for anybody??!?)
After all that, I finally got a clean compile....  Maybe later I'll get brave
and actually try to boot it. :)
[unhandled content-type:application/pgp-signature]