Date: Sun, 2 Apr 2006 12:20:02 +0100
From: John Mylchreest <>
Subject: Re: [PATCH 1/1] POWERPC: Fix ppc32 compile with gcc+SSP in 2.6.16
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2006/4/2/37

On Sun, Apr 02, 2006 at 01:10:02PM +0200, Olaf Hering <olh@suse.de> wrote:
>  On Sun, Apr 02, John Mylchreest wrote:
> 
> > On Sun, Apr 02, 2006 at 12:28:15PM +0200, Olaf Hering <olh@suse.de> wrote:
> > >  On Sun, Apr 02, John Mylchreest wrote:
> > > 
> > > >   BOOTLD  arch/powerpc/boot/zImage.vmode
> > > >   arch/powerpc/boot/prom.o(.text+0x19c): In function `call_prom':
> > > >   : undefined reference to `__stack_smash_handler'
> > > 
> > > Any this strange "security feature" is disabled by defining __KERNEL__?
> > 
> > That correct, yes. SSP is actually used by quite a lot of vendors, and
> > shouldn't be used outside of userland. Typically speaking it isn't, but
> > in this case its being leaked.
> 
> Either way, file a bugreport upstream to remove the dep on __KERNEL__ in
> the gcc patch.
> 
> A patch which adds -fno-dumb-feature to CFLAGS may be acceptable.
Going from that, I can push a patch for gcc upstream to remove the
__KERNEL__ dep, but gcc4.1 ships with ssp by standard, and the semantics
between the IBM patch for SSP applied to gcc-3 and ggc-4 have changed.
-fno-stack-protector would work for gcc4, but for gcc3 it could still be
patially enabled, and requires -fno-stack-protector-all. Mind If I ask
whats incorrect about defining __KERNEL__ for the bootcflags?
-- 
Role:            Gentoo Linux Kernel Lead
Gentoo Linux:    
http://www.gentoo.org
Public Key:      gpg --recv-keys 9C745515
Key fingerprint: A0AF F3C8 D699 A05A EC5C  24F7 95AA 241D 9C74 5515
[unhandled content-type:application/pgp-signature]