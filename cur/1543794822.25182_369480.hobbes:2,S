Date: Tue, 22 Nov 2005 16:19:25 +0200
From: Denis Vlasenko <>
Subject: Re: Compaq Presario "reboot" problems
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2005/11/22/107

On Tuesday 22 November 2005 16:09, linux-os (Dick Johnson) wrote:
> Okay, the results are the same. The machine reboots. It doesn't
> run the memory-test so it probably didn't cold-boot. It's hard to
> tell with these lap-tops because the time in the BIOS is so
> brief. Anyway, it reboots into Linux, but can't reboot into Windows
> as before.
You may want to try to add triple-fault reset as suggested here
(based on your own idea actually):
> If it does not, try this reboot=tc - this is closely resembles
> what you proposed in your mail (pseudo-patch):
>
> static int __init reboot_setup(char *str)
> {
>        while(1) {
>                switch (*str) {
> +               case 't': /* "triple fault" reboot */
> +                       reboot_thru_bios = 2;
> +                       break;
>                case 'w': /* "warm" reboot (no memory testing etc) */
>                        reboot_mode = 0x1234;
>                        break;
> ...
> void machine_emergency_restart(void)
> {
> +       if (reboot_thru_bios == 2) {
> +               *((unsigned short *)__va(0x472)) = reboot_mode;
> +               load_idt(&no_idt);
> +               __asm__ __volatile__("int3");
> +     }
>        if (!reboot_thru_bios) {
>                if (efi_enabled) {
>                        efi.reset_system(EFI_RESET_COLD, EFI_SUCCESS, 0, NULL);
--
vda
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.kernel.org
More majordomo info at  
http://vger.kernel.org/majordomo-info.html
Please read the FAQ at  
http://www.tux.org/lkml/