Date: Wed, 21 Dec 2005 16:59:34 +0100
From: Ingo Molnar <>
Subject: Re: [patch 05/15] Generic Mutex Subsystem, mutex-core.patch
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2005/12/21/128

* Oleg Nesterov <oleg@tv-sign.ru> wrote:
> > +__mutex_wakeup_waiter(struct mutex *lock __IP_DECL__)
> > +{
> > +	struct mutex_waiter *waiter;
> > ...
> > +	if (!waiter->woken) {
> > +		waiter->woken = 1;
> > +		wake_up_process(waiter->ti->task);
> > +	}
> 
> Is it optimization? If yes - why? From mutex.h:
> 
> 	- only one task can hold the mutex at a time
> 	- only the owner can unlock the mutex
> 
> So, how can this help?
yes, it's an optimization. I've removed it from the latest queue because 
it didnt trigger all that often, but the optimization is valid: while we 
have a 'waiter in flight', another (fast) task might grab the mutex, and 
might release it - in which case it could attempt to wake up the waiter 
again - which this flag optimizes.
	Ingo
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.kernel.org
More majordomo info at  
http://vger.kernel.org/majordomo-info.html
Please read the FAQ at  
http://www.tux.org/lkml/