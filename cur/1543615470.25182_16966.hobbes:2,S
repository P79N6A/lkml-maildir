Date: Sun, 30 Dec 2001 07:39:10 -0500
From: Andy Gaynor <>
Subject: losetuping files in tmpfs fails?
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2002/1/3/169

Whilst trying to figure out why my dang stripes won't persist (a separate
but worrisome issue), I wrote a dittie which creates a couple junk files in
/tmp (tmpfs), associates loop devices with them, whoops, losetup craps out.
  /home/root# losetup -d /dev/loop/5 2>/dev/null # Free /dev/loop/5
  /home/root# cd /home/root             # Go home
  /home/root# mount | grep /home        # Filesystem is ...
  /dev/md/8 on /home type reiserfs (rw) #   reiserfs
  /home/root# echo foo > foo            # Create file foo
  /home/root# losetup /dev/loop/5 foo   # Give foo to /dev/loop/5
  /home/root# losetup -d /dev/loop/5    # Free /dev/loop/5
  /home/root# rm foo                    # Remove foo
  /home/root# cd /tmp                   # Go to /tmp
  /tmp# mount | grep tmp                # Filesystem is ...
  tmpfs on /tmp type tmpfs (rw)         #   tmpfs
  /tmp# echo foo > foo                  # Create file foo
  /tmp# losetup /dev/loop/5 foo         # Give foo to /dev/loop/5
  ioctl: LOOP_SET_FD: Invalid argument  #   DISCO!!!                <o >  <o >
  /tmp# rm foo                          # Remove foo
    Version information:
  Distribution: Debian Woody, up-to-date as of a week ago
  Kernel: Linux 2.4.17
    I don't subscribe to linux-kernel@vger.kernel.org.  If you want me to
see a message, please mail it to me.  If my site is down, send to
stupid_email_tricks@mailandnews.com.  And bonk my administrator with a
wiffle bat.
Regards, [Ag]   Andy Gaynor   silver@silver.unix-fu.org
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.kernel.org
More majordomo info at  
http://vger.kernel.org/majordomo-info.html
Please read the FAQ at  
http://www.tux.org/lkml/