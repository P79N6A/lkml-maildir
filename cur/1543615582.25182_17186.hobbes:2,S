Date: Fri, 4 Jan 2002 15:11:27 +0100
From: Andrea Arcangeli <>
Subject: Re: [2.4.17/18pre] VM and swap - it's really unusable
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2002/1/4/99

On Thu, Jan 03, 2002 at 08:14:42PM -0600, M.H.VanLeeuwen wrote:
> Stephan von Krawczynski wrote:
> > 
> > On Mon, 31 Dec 2001 11:14:04 -0600
> > "M.H.VanLeeuwen" <vanl@megsinet.net> wrote:
> > 
> > > [...]
> > > vmscan patch:
> > >
> > > a. instead of calling swap_out as soon as max_mapped is reached, continue to
> > try>    to free pages.  this reduces the number of times we hit
> > try_to_free_pages() and>    swap_out().
> > 
> > I experimented with this some time ago, but found out it hit performance and
> > (to my own surprise) did not do any good at all. Have you tried this
> > stand-alone/on top of the rest to view its results?
> > 
> > Regards,
> > Stephan
> 
> Stephan,
> 
> Here is what I've run thus far.  I'll add nfs file copy into the mix also...
> 
> System: SMP 466 Celeron 192M RAM, running KDE, xosview, and other minor apps.
> 
> Each run after clean & cache builds has 1 more setiathome client running upto a
> max if 8 seti clients.  No, this isn't my normal way of running setiathome, but
> each instance uses a nice chunk of memory.
> 
> Note: this is a single run for each of the columns using "make -j2 bzImage" each time.
> 
> I will try to run aa and rmap this evening and/or tomorrow.
The design changes Linus did was explicitly to left the mapped pages
into the inactive list so we learn when we should trigger swapout. Also
it is nicer to swapout over the shrinking. rc2aa2 should work just fine.
Have a look at how such logic is implemented there. (btw, I will shortly
sync with 18pre, 2.2 and 2.5)
Andrea
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.kernel.org
More majordomo info at  
http://vger.kernel.org/majordomo-info.html
Please read the FAQ at  
http://www.tux.org/lkml/