Date: Fri, 15 Jun 2001 20:23:33 -0400
From: Andrey Savochkin <>
Subject: [patch] unpaired lock/unlock_kernel in fs/locks.c
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2001/6/15/122

Please apply the fix for unpaired lock/unlock_kernel in fs/locks.c
	Andrey
--- fs/locks.c~	Fri Jun 15 17:14:05 2001
+++ fs/locks.c	Fri Jun 15 19:16:31 2001
@@ -856,7 +856,7 @@
 	new_fl2 = locks_alloc_lock(0);
 	error = -ENOLCK; /* "no luck" */
 	if (!(new_fl && new_fl2))
-		goto out;
+		goto out_nolock;
 
 	lock_kernel();
 	if (caller->fl_type != F_UNLCK) {
@@ -1004,6 +1004,7 @@
 	}
 out:
 	unlock_kernel();
+out_nolock:
 	/*
 	 * Free any unused locks.
 	 */
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.kernel.org
More majordomo info at  
http://vger.kernel.org/majordomo-info.html
Please read the FAQ at  
http://www.tux.org/lkml/