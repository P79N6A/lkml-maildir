Date: Mon, 22 Dec 2003 21:46:28 +0100
From: Michael Hunold <>
Subject: [PATCH][2.6] change two annoying messages from framebuffer drivers
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2003/12/22/126

Hello,
the Linux-on-a-CD system Knoppix has nearly all framebuffer drivers for
2.4.23 compiled in. Additionally, it surpresses most kernel messages by
lowering the kernel log level.
Two framebuffer drivers (clgenfb.c and hgafb.c), however, use KERN_ERR
to say that their particular card has *not* been found which is very
annoying.
Especially the clgenfb.c driver simply says on bootup:
  >  Couldn't find PCI device
which can really confuse newbie users.
I've already send a patch that fixes this for 2.4 -- Marcelo and Geert 
Uytterhoeven have already ack'ed it.
The same change should be done for 2.6, too IMHO.
The appended patch replaces two KERN_ERR with KERN_INFO and additionally
makes the cirrusfb.c message more descriptive.
Please apply, thanks!
CU
Michael.
diff -ur xx-linux-2.6/drivers/video/clgenfb.c xx-linux-2.6.p/drivers/video/clgenfb.c
--- xx-linux-2.6/drivers/video/cirrusfb.c	2003-06-13 16:51:37.000000000 +0200
+++ xx-linux-2.6.p/drivers/video/cirrusfb.c	2003-12-12 13:48:34.000000000 +0100
@@ -2528,7 +2528,7 @@
 
 	pdev = clgen_pci_dev_get (btype);
 	if (!pdev) {
-		printk (KERN_ERR " Couldn't find PCI device\n");
+		printk (KERN_INFO "cirrusfb: couldn't find Cirrus Logic PCI device\n");
 		DPRINTK ("EXIT, returning 1\n");
 		return 1;
 	}
diff -ur xx-linux-2.6/drivers/video/hgafb.c xx-linux-2.6.p/drivers/video/hgafb.c
--- xx-linux-2.6/drivers/video/hgafb.c	2001-11-12 18:46:25.000000000 +0100
+++ xx-linux-2.6.p/drivers/video/hgafb.c	2003-12-12 13:47:01.000000000 +0100
@@ -539,7 +539,7 @@
 int __init hgafb_init(void)
 {
 	if (! hga_card_detect()) {
-		printk(KERN_ERR "hgafb: HGA card not detected.\n");
+		printk(KERN_INFO "hgafb: HGA card not detected.\n");
 		return -EINVAL;
 	}
 