Date: Thu, 1 Nov 2001 01:50:15 +0100
From: David Weinehall <>
Subject: Re: [PATCH] Stop APM readers from responding to events
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2001/10/31/324

On Thu, Nov 01, 2001 at 01:29:00AM +1100, Stephen Rothwell wrote:
> Hi Linus,
> 
> This is just a small patch, but fills a hole.  Thanks to Thomas Hood for a
> patch.
> 
> Alan, This will also apply to 2.4.13-ac5.
Shouldn't this be done using capabilities instead?!
> diff -ruN 2.4.14-pre5/arch/i386/kernel/apm.c 2.4.14-pre5-APM.1/arch/i386/kernel/apm.c
> --- 2.4.14-pre5/arch/i386/kernel/apm.c	Wed Oct 24 16:12:20 2001
> +++ 2.4.14-pre5-APM.1/arch/i386/kernel/apm.c	Thu Nov  1 01:09:48 2001
> @@ -1471,7 +1471,7 @@
>  	as = filp->private_data;
>  	if (check_apm_user(as, "ioctl"))
>  		return -EIO;
> -	if (!as->suser)
> +	if ((!as->suser) || (!as->writer))
>  		return -EPERM;
>  	switch (cmd) {
>  	case APM_IOC_STANDBY:
/David Weinehall
  _                                                                 _
 // David Weinehall <tao@acc.umu.se> /> Northern lights wander      \\
//  Project MCA Linux hacker        //  Dance across the winter sky //
\>  
http://www.acc.umu.se/~tao/
    </   Full colour fire           </
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.kernel.org
More majordomo info at  
http://vger.kernel.org/majordomo-info.html
Please read the FAQ at  
http://www.tux.org/lkml/