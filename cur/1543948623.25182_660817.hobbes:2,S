Date: Wed, 27 Feb 2008 20:45:12 -0500
From: Dave Quigley <>
Subject: Re: [PATCH 05/11] NFSv4: Add label recommended attribute and NFSv4 flags
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2008/2/27/523

On Thu, 2008-02-28 at 12:52 +1100, James Morris wrote:
> On Wed, 27 Feb 2008, David P. Quigley wrote:
> 
> > +#define NFS4_MAXLABELLEN	255
> 
> I remember raising this before, but I think we need to try and find a 
> better way to implement this than always allocating labels of a fixed and 
> possibly too-small size.
> 
> What about perhaps starting with a statically allocated array of say 64 
> bytes (I can't see any labels on my system larger than that), and then 
> falling back to a a dynamic allocation of up to 32k if it turns out to be 
> too small ?  i.e. large labels are a slow path and there is no practical 
> limit on label size.
> 
> 
> - James
I'm not convinced that it is worth all of that extra logic just to save
some space on a transient data structure. 255 characters seems to be
overkill to begin with considering you don't often get a label like the
one below which is only 90 characters.
thisismyuser_u:withseveralroles_r:andanoverlylongtype_t:s0-s12:c0,c1,c2,c3,c4,c5,c6,c7,c8