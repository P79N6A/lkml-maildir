Date: Mon, 06 Aug 2007 12:57:07 -0400
From: Gregory Haskins <>
Subject: Re: [PATCH] RT: Add priority-queuing and priority-inheritance to workqueue infrastructure
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2007/8/6/281

On Mon, 2007-08-06 at 20:50 +0400, Oleg Nesterov wrote:
> Yes.
> 
> > Do you agree that if the context was the same there is a bug?  Or did I
> > miss something else?
> 
> Yes sure. We can't expect we can "flush" work_struct with flush_workqueue()
> unless we know it doesn't re-schedule itself.
Agreed.
> 
> OTOH, it is not the bug to call flush_workqueue() even if that work was
> queued by us, it should complete.
Well, I guess it depends on the application but that would be highly
unusual unless the flush was already superfluous to begin with.
Typically you only call flush to ensure a strongly ordered operation.
The reschedule defeats the strong ordering and thus would break anything
that was dependent on it.
But we are splitting hairs at this point since we both agree that the
API as put forth in the PI patch was deficient ;)
-Greg
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.kernel.org
More majordomo info at  
http://vger.kernel.org/majordomo-info.html
Please read the FAQ at  
http://www.tux.org/lkml/