Date: Tue, 8 Aug 2000 02:39:58 +0200 (CEST)
From: Urban Widmark <>
Subject: smbfs ascii options
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2000/8/7/149

Hello
I'm looking for some advice if I'm on the right track here or not ...
failing to find an answer in other places.
smbfs takes a binary struct from smbmount. This makes it slow for changes
in the options to smbfs to become visible to the user since it requires
changes to smbmount. And changes to smbmount wont be "public" until the
next release of samba.
I would like to change smbfs to recieve an ascii string for the fs
specific options, just like ext2, vfat etc does. The idea is to make it
possible for smbmount to pass options that didn't exist when that version
was released. Any chance of doing this in 2.2.18-pre? (and 2.4.0-test)
It does not break existing userspace.
If you or anyone on the list has reasons why this would be a bad idea and
why a binary struct is much better, please tell me. For some reason the
fs:es I know of with "special" mount programs (smbfs, ncpfs, nfs - well
not really) all pass a binary struct. Just a coincidence?
It will look something like this in smbfs. Feel free to give me a better
name than getopt. It steals ideas from getopt, but doesn't look like it.
(kgetopt?)
    
http://www.hojdpunkten.ac.se/054/smbfs-2.2.17-pre14-ascii-options.patch
I'll move getopt.[ch] into fs/smbfs to not add code no one else uses to 
lib, it was just for the ext2 test.
To see if the "getopt" thing could be useful to someone else I tried to
change ext2 to use it:
    
http://www.hojdpunkten.ac.se/054/ext2-2.2.17-pre14-ascii-options.patch
(I'm not suggesting that change, just playing. It compiles but I haven't
 run it ... so don't. In fact none of this is supposed to work.)
For completeness, here is a guess on what samba would need to enable this:
    
http://www.hojdpunkten.ac.se/054/smbmount-2.0.7-ascii.patch
(smbmnt does things with the existing options, so they are passed
 separately).
Comments? (on the code or the idea)
/Urban
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.rutgers.edu
Please read the FAQ at 
http://www.tux.org/lkml/