Date: Mon, 12 Nov 2007 13:03:50 -0500
From: "Ron Yorgason" <>
Subject: Better support for Delkin cardbus CF adapters -- IDE layer
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2007/11/12/146

Please CC me with any responses, I'm not on the lkml.
I'm trying to build a budget SSD using cardbus CF adapters & fast CF
cards.  The latest CF adapters support UDMA and PIO access methods,
and CF cards support these too.  The latest Delkin model boasts speeds
of 45MB/s.
I currently own this card from Synchrotech,
http://www.synchrotech.com/products/media-adapters-pcmcia-memory-cards_01.html
as well as the latest Delkin model.  The Synchrotech is recognized as
a Delkin, with PCI vendor id =0x1145, device id = 0xf021.  The new
Delkin has device id 0xf103.  I presume that in order to have the new
Delkin recognized, I just need to add the appropriate line to the
struct pci_device_id table.
But I'm concerned about performance.  The delkin_cb.c file states:
 *  This is slightly peculiar, in that it is a PCI driver,
 *  but is NOT an IDE PCI driver -- the IDE layer does not directly
 *  support hot insertion/removal of PCI interfaces, so this driver
 *  is unable to use the IDE PCI interfaces.  Instead, it uses the
 *  same interfaces as the ide-cs (PCMCIA) driver uses.
 *  On the plus side, the driver is also smaller/simpler this way.
My attempts to use hdparm to turn on DMA for my device have failed.  I
assume this means DMA is not currently supported.  In my tests, read
support seems fast enough, but writing maxes out around 2MB/s.  And if
there is a lot of reading and writing going on (ie, trying to compile
the kernel), performance is pretty abysmal.  What would it take to get
proper DMA support?  Is it an architecture problem, in that this
doesn't use the normal IDE PCI driver?  Is it a lack of documentation
on card specs?  What can I do to help?
--Ron
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.kernel.org
More majordomo info at  
http://vger.kernel.org/majordomo-info.html
Please read the FAQ at  
http://www.tux.org/lkml/