Date: Mon, 6 Dec 2004 00:20:01 +0200
From: Paul Mundt <>
Subject: Re: [PATCH] ARCH_SLAB_MINALIGN for 2.6.10-rc3
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2004/12/5/135

Hi Manfred,
On Sun, Dec 05, 2004 at 10:30:46PM +0100, Manfred Spraul wrote:
> >--- orig/include/asm-sh64/uaccess.h
> >+++ mod/include/asm-sh64/uaccess.h
> >@@ -313,6 +313,12 @@
> >   sh64 at the moment). */
> >#define ARCH_KMALLOC_MINALIGN 8
> >
> >+/*
> >+ * We want 8-byte alignment for the slab caches as well, otherwise we have
> >+ * the same BYTES_PER_WORD (sizeof(void *)) min align in 
> >kmem_cache_create().
> >+ */
> >+#define ARCH_SLAB_MINALIGN 8
> >+
> > 
> >
> Could you make that dependant on !CONFIG_DEBUG_SLAB? Setting align to a 
> non-zero value disables some debug code.
> 
align is only being set to ARCH_SLAB_MINALIGN in kmem_cache_create()
where it is otherwise being set to BYTES_PER_WORD as a default. Unless I
am missing something, that will always set it non-zero irregardless of
whether ARCH_SLAB_MINALIGN is set.
Are you suggesting that ARCH_SLAB_MINALIGN be set to 0 in the
CONFIG_DEBUG_SLAB case? In that case, the check should be in mm/slab.c
and not in the arch-specific code (as any other platform wishing to have
fixed slab min alignment would have to do the same checks).
[unhandled content-type:application/pgp-signature]