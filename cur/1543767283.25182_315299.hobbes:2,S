Date: Sat, 30 Apr 2005 22:33:31 +0530
From: Suparna Bhattacharya <>
Subject: Re: [Ext2-devel] [RFC] Adding multiple block allocation
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2005/4/30/92

On Fri, Apr 29, 2005 at 05:44:26PM -0700, Mingming Cao wrote:
> Oops, sorry about the empty message ...
> 
> > -static int ext3_writepages_get_block(struct inode *inode, sector_t iblock,
> > -			struct buffer_head *bh, int create)
> > +static int ext3_writepages_get_blocks(struct inode *inode, sector_t iblock,
> > +		unsigned long max_blocks, struct buffer_head *bh, int create)
> >  {
> > -	return ext3_direct_io_get_blocks(inode, iblock, 1, bh, create);
> > +	return ext3_direct_io_get_blocks(inode, iblock, max_blocks, bh, create);
> >  }
> > 
> 
> I have a question here, ext3_direct_io_get_blocks use DIO_CREDITS
> (EXT3_RESERVE_TRANS_BLOCKS + 32 = ) to reserve the space for
> journalling, but it seems based on assumption of one data block update
> once a time. Is it sufficent to re-use that routine for multiple block
> allocation here? Don't we need something like
> ext3_writepage_trans_blocks() here?
Quite likely - with your patch, as get_blocks actually allocates
multiple blocks at a time, the min credits estimate would 
change for ext3_direct_io_get_blocks/ext3_writepages_get_blocks.
Regards
Suparna
> 
> Thanks,
> Mingming
> 
> 
> 
> -------------------------------------------------------
> This SF.Net email is sponsored by: NEC IT Guy Games.
> Get your fingers limbered up and give it your best shot. 4 great events, 4
> opportunities to win big! Highest score wins.NEC IT Guy Games. Play to
> win an NEC 61 plasma display. Visit 
http://www.necitguy.com/?r=20
> _______________________________________________
> Ext2-devel mailing list
> Ext2-devel@lists.sourceforge.net
> 
https://lists.sourceforge.net/lists/listinfo/ext2-devel
-- 
Suparna Bhattacharya (suparna@in.ibm.com)
Linux Technology Center
IBM Software Lab, India
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.kernel.org
More majordomo info at  
http://vger.kernel.org/majordomo-info.html
Please read the FAQ at  
http://www.tux.org/lkml/