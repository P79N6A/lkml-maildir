Date: Wed, 1 Sep 1999 15:48:36 +0200
From: Jens Axboe <>
Subject: Re: CDROM bug in 2.3.x
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/1999/9/1/67

On Wed, Sep 01 1999, David S. Miller wrote:
> This one has been there for a while, and I finally sat
> down just now to track it down.
> 
> What I see is that the generic cdrom driver is passing
> down packet commands with a buffer length which is
> negative.  I see that some of the cgc command building
> routines are setting negative buffer lengths on purpose.
> 
> This is illegal and is confusing SCSI drivers quite
> badly, because the scsi command will have
> SCpnt->request_bufflen < 0 and this will be given to
> the controller for the DMA request.
> 
> I don't know what the intentions were here, but this
> does need to be fixed somehow so I leave it to Jens
> to figure out the correct fix.
It sets the negative buflens for the ide-cd driver,
which otherwise assumes that the transfer is going
in the wrong directions. It did seem odd to me at
first, but I wasn't aware that the SCSI drivers
got confused. I'll fix it up.
> Thanks.
> 
> Later,
> David S. Miller
> davem@redhat.com
-- 
*  Jens Axboe <axboe@image.dk>
*  Linux CD-ROM Maintainer
*  
http://www.kernel.dk
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.rutgers.edu
Please read the FAQ at 
http://www.tux.org/lkml/