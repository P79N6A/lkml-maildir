Date: Thu, 1 May 2008 17:38:45 -0700
From: Chris Wright <>
Subject: Re: Comprehensive list of kernel self-modifications?
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2008/5/1/452

* Yan (rottled@gmail.com) wrote:
> I have been working on verifying kernel integrity and am trying to
> differentiate
> between vmlinux image on disk and the kernel loaded into memory. I understand
>  that the kernel modifies itself (on x86 at least) during at least a few points:
> 
> 
> 1. It applies alternative instructions with apply_alternatives() from
> check_bugs().
>     The locations of all alternatives are found between __alt_instructions and
>     __alt_instructions__end.
Similarly, there's apply_paravirt() for CONFIG_PARAVIRT kernels.
(Also kprobes, or anything that calls text_poke(), but I doubt it's what
you're looking for).
> 2. It also applies what looks to be relocation. I see the list of
> reloc addresses at
>     the end of vmlinux image and it appears that relocate_kernel in
> relocate_kernel.S
>     applies the relocations. I can't tell how it knows where the list
> of addresses that
>     need relocations is found. Nothing that I found points to that
> area, and the on-
>     disk data seems to live what gets mapped to as BSS when its running.
BSS?  It's not on disk outside of elf header and mapped and cleared at
startup (see clear_bss, for example).