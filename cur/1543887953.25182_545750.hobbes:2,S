Date: Thu, 17 May 2007 22:43:06 +0530
From: "Satyam Sharma" <>
Subject: Re: Asynchronous scsi scanning
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2007/5/17/202

Hi Matthew,
On 5/16/07, Matthew Wilcox <matthew@wil.cx> wrote:
> [...]
> > /sys/module/scsi_mod/parameters/wait_for_async_scans (?)
> > Doesn't really matter, but perhaps who created the sysfs namespace
> > for scsi in /sys/module/scsi_mod/... could be the best person to suggest.
>
> No, it does matter.  Your suggestion doesn't work, because
> /sys/module/scsi_mod/parameters/ belongs to the module code.  To create
> a new attribute there, you use the module_param() code -- and there's
> no way to have code called when your parameter is changed.
Ok, thanks for pointing out that /sys/module/scsi_mod/parameters/wait...
is _wrong_. Could you suggest something that would be _right_?
> > OK, I'll get really silly here myself. I don't want even that half a second
> > of
> > overhead when that module is being _built_ (during make modules), not
> > the overhead of copying / installing at modules_install time.
>
> You're claiming that 0.7 second (I just timed it on a 3 year old
> laptop) *inconveniences* you?
...
On 5/16/07, Satyam Sharma <satyam.sharma@gmail.com> wrote:
OK, I'll get really silly here myself. ...
...
On 5/16/07, Satyam Sharma <satyam.sharma@gmail.com> wrote:
It's not _inconvenient_. Just that writing/building a module for accomplishing
something like that ... is just not _right_.
...
On 5/16/07, Satyam Sharma <satyam.sharma@gmail.com> wrote:
static int __init wait_scan_init(void)
{
        scsi_complete_async_scans();
        return 0;
/* BTW this could've been return scsi_complete_async_scans();
 * I see scsi_complete_async_scans() never fails, but still. */
}
late_initcall(wait_scan_init);
... does _not_ deserve to be a module, and writing/building a module
for something like this (just to run a function in some kernel subsytem)
does not seem to be the proper way to solve the problem either.
...
> This whole thing is such a tempest in a teapot.  I really don't
> understand why you care so much.
You're almost right here. But IMHO this is simply a case of
doing something in some kernel subsystem in a proper/better
way than it is being done presently.
Anyway, like I said on another thread, discussions here tend to be
most productive only over code, so I'll try and make a patch to do
this some other way.
Thanks,
Satyam
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.kernel.org
More majordomo info at  
http://vger.kernel.org/majordomo-info.html
Please read the FAQ at  
http://www.tux.org/lkml/