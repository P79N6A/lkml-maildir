Date: Mon, 1 Feb 1999 17:13:04 -0600
From: Sean Connor <>
Subject: VIA/Sound crashes -- here's the patch
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/1999/2/1/182

Here's the patch that I meant to include with my previous message. :)
--- linux/drivers/sound/dmabuf.c.v	Tue Jan  5 14:32:48 1999
+++ linux/drivers/sound/dmabuf.c	Tue Jan  5 14:59:10 1999
@@ -214,9 +214,9 @@
 		dmap->dma_mode = DMODE_NONE;
 	dmap->flags &= ~DMA_BUSY;
 	
-	flags=claim_dma_lock();
-	disable_dma(dmap->dma);
-	release_dma_lock(flags);
+	/*flags=claim_dma_lock();*/
+	/*disable_dma(dmap->dma);*/
+	/*release_dma_lock(flags);*/
 	
 	if (sound_dmap_flag == DMAP_FREE_ON_CLOSE)
 		sound_free_dmap(dmap);
@@ -355,7 +355,7 @@
 	
 	f=claim_dma_lock();
 	clear_dma_ff(dmap->dma);
-	disable_dma(dmap->dma);
+	/*disable_dma(dmap->dma);*/
 	release_dma_lock(f);
 	
 	restore_flags(flags);
@@ -1159,7 +1159,7 @@
 
 		flags=claim_dma_lock();
 		clear_dma_ff(adev->dmap_out->dma);
-		disable_dma(adev->dmap_out->dma);
+		/*disable_dma(adev->dmap_out->dma);*/
 		release_dma_lock(flags);
 	}
 	return 0;
-- 
  -Sean Connor  (sec@konatsu.ml.org)
                (sec@cableregina.com)         ,,,,
                (sec@softhome.net)        ,-^^,--/
                                  _--_  .' ,-'  /    ()
                              *,,'    '/  /--------------.
   O]=========================| >     <> (           (o)  )
                              *'`,    ,\  \--------------'
                                  ^--^  '. '-,  \
                                          '-__'--\
                                              ````
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.rutgers.edu
Please read the FAQ at 
http://www.tux.org/lkml/