Date: Tue, 10 Apr 2001 14:04:17 +0200 (CEST)
From: Mikulas Patocka <>
Subject: Re: No 100 HZ timer !
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2001/4/10/69

> > > > Its worth doing even on the ancient x86 boards with the PIT.
> > > 
> > > Note that programming the PIT is sloooooooow and doing it on every timer
> > > add_timer/del_timer would be a pain.
> > 
> > You only have to do it occasionally.
> > 
> > When you add a timer newer than the current one 
> > 	(arguably newer by at least 1/2*HZ sec)
> > When you finish running the timers at an interval and the new interval is
> > significantly larger than the current one.
> > 
> > Remember each tick we poke the PIT anyway
> 
> Reprogramming takes 3-4 times as long.  However, I still agree
> it's a good idea.
Adding and removing timers happens much more frequently than PIT tick, so
comparing these times is pointless.
If you have some device and timer protecting it from lockup on buggy
hardware, you actually
send request to device
add timer
receive interrupt and read reply
remove timer
With the curent timer semantics, the cost of add timer and del timer is
nearly zero. If you had to reprogram the PIT on each request and reply, it
would slow things down. 
Note that you call mod_timer also on each packet received - and in worst
case (which may happen), you end up reprogramming the PIT on each packet.
Mikulas
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.kernel.org
More majordomo info at  
http://vger.kernel.org/majordomo-info.html
Please read the FAQ at  
http://www.tux.org/lkml/