Date: Wed, 22 Sep 2004 17:41:10 +1000
From: Stephen Rothwell <>
Subject: [PATCH] PPC64 iSeries: allow ibmvscsic to initialise
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2004/9/22/20

Hi Andrew,
This patch supplies an device so that ibmvscsic will actually have
its probe routine called and so allow ti to actually initialise on
(legacy) iSeries machines.
It also adds a device for the virtual console (for consistency only
at the moment).
Signed-off-by: Stephen Rothwell <sfr@canb.auug.org.au>
-- 
Cheers,
Stephen Rothwell                    sfr@canb.auug.org.au
http://www.canb.auug.org.au/~sfr/
diff -ruN 2.6.9-rc2-bk7/arch/ppc64/kernel/vio.c 2.6.9-rc2-bk7-vio.1/arch/ppc64/kernel/vio.c
--- 2.6.9-rc2-bk7/arch/ppc64/kernel/vio.c	2004-08-19 17:02:00.000000000 +1000
+++ 2.6.9-rc2-bk7-vio.1/arch/ppc64/kernel/vio.c	2004-09-22 17:14:32.000000000 +1000
@@ -225,6 +225,10 @@
 	struct vio_dev *viodev;
 	int i;
 
+	/* there is only one of each of these */
+	vio_register_device_iseries("viocons", 0);
+	vio_register_device_iseries("vscsi", 0);
+
 	vlan_map = HvLpConfig_getVirtualLanIndexMap();
 	for (i = 0; i < HVMAXARCHITECTEDVIRTUALLANS; i++) {
 		if ((vlan_map & (0x8000 >> i)) == 0)[unhandled content-type:application/pgp-signature]