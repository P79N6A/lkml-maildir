Date: Sat, 9 Sep 2000 19:40:17 +0200
From: Jan Niehusmann <>
Subject: Re: Scsi disks duplicated
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2000/9/9/19

On Sat, Sep 09, 2000 at 07:25:53PM +0200, Torben Mathiasen wrote:
> This seems to some kind of scsi weirdness. Jens reports its the 
> same with sr. Maybe Eric have a comment on this?
Some additional datapoints: I just commented out the last two lines
of sd.c:
--- sd.c.orig	Sat Sep  9 17:47:46 2000
+++ sd.c	Sat Sep  9 17:47:57 2000
@@ -1388,5 +1388,5 @@
 		kfree(sd_gendisks);
 }
 
-module_init(init_sd);
-module_exit(exit_sd);
+/*module_init(init_sd);
+module_exit(exit_sd);*/
Now -test8 works for me (with the duplicated scsi devices, lvm didn't work).
This patch may break scsi modules - I have scsi compiled into the kernel and
didn't test modules.
But it seems obvious to me that with module_init(init_sd), the partition
detection code runs twice: once after hardware detection, and once when the
module_init()-Functions get called.
Jan
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.kernel.org
Please read the FAQ at 
http://www.tux.org/lkml/