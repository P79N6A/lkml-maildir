Date: Thu, 4 Jan 2001 09:27:51 +0000
From: Tim Waugh <>
Subject: Re: Printing to off-line printer in 2.4.0-prerelease
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2001/1/4/23

On Thu, Jan 04, 2001 at 01:08:01AM +0100, Peter Osterlund wrote:
> The tunelp man-page seems to think there are printers that need the
> LP_CAREFUL handling. I also noted that if I disconnect my printer from
> the computer, the data will no longer be lost. Apparently the printer
> confuses the parallel port when it is powered off.
I'm afraid that with some (most) printers there's just nothing that
can be done about this, to my knowledge.
> @@ -188,10 +188,7 @@
>  	int error = 0;
>  	unsigned int last = lp_table[minor].last_error;
>  	unsigned char status = r_str(minor);
> -	if ((status & LP_PERRORP) && !(LP_F(minor) & LP_CAREFUL))
> -		/* No error. */
> -		last = 0;
> -	else if ((status & LP_POUTPA)) {
> +	if ((status & LP_POUTPA)) {
>  		if (last != LP_POUTPA) {
>  			last = LP_POUTPA;
>  			printk(KERN_INFO "lp%d out of paper\n", minor);
Believe it or not, there are some printers out there that wave
LP_POUTPA all over the place even when they're happy: they set
LP_PERRORP to mean 'happy', which is what the check is for.
So this part of the patch would break that. :-(
Tim.
*/
[unhandled content-type:application/pgp-signature]