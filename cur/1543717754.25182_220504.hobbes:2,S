Date: Fri, 14 May 2004 13:19:26 +0200
From: Vojtech Pavlik <>
Subject: Re: [PATCH] HPET driver
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2004/5/14/48

On Thu, May 13, 2004 at 07:49:22PM -0400, Jeff Garzik wrote:
> Andrew Morton wrote:
> >Jeff Garzik <jgarzik@pobox.com> wrote:
> >
> >>>+    vma->vm_flags |= (VM_IO | VM_SHM | VM_LOCKED);
> >>>+    vma->vm_page_prot = pgprot_noncached(vma->vm_page_prot);
> >>>+    addr = __pa(addr);
> >>
> >>where did these flags come from?  don't you just want VM_RESERVED?
> >
> >
> >VM_IO is the way to mark mmapped I/O devices. 
> >
> >	vma->vm_flags |= VM_IO;
> >
> >should be sufficient here.
> >
> >hm, I'm trying to decrypt how the driver accesses the hardware.  It's
> >taking copies of kernel virtual addresses based off hpet_virt_address, but
> >there are no readl's or writel's in there.  Is the actual device access
> >done over in time_hpet.c?
> 
> 
> HPET writes into RAM at magic addresses, so it's not really a bus address.
Since it lives in the bridge (either north or south), IMO it is a bus
address ... at least on AMD machines it's the same space where MMIO
comes from.
> Thus I think only VM_RESERVED is needed...
> 
> 	Jeff
-- 
Vojtech Pavlik
SuSE Labs, SuSE CR
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.kernel.org
More majordomo info at  
http://vger.kernel.org/majordomo-info.html
Please read the FAQ at  
http://www.tux.org/lkml/