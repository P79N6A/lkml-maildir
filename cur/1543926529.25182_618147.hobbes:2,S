Date: Thu, 15 Nov 2007 23:35:20 +0100 (CET)
From: Mikulas Patocka <>
Subject: Re: Temporary lockup on loopback block device
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2007/11/15/451

> > On 2.6.23 it could happen even without loopback
> 
> Let's focus on this point, because we already know how the lockup
> happens _with_ loopback and any other kind of bdi stacking.
> 
> Can you describe the setup?  Or better still, can you reproduce it and
> post the sysrq-t output?
Hi
The trace is this, it is perfectly reproducible. It is 128M machine, 
Pentium 2 300MHz, host filesystem ext2, loop filesystems ext2 and spadfs 
(both of them locked up). But the problem is really over in 2.6.24, I 
think there is no more need to investigate it.
Mikulas
Nov 10 19:34:45 gerlinda kernel: SysRq : HELP : loglevel0-8 reBoot tErm 
Full kIll saK showMem Nice powerOff showPc show-all-timers(Q) unRaw Sync 
showTasks Unmount shoW-blocked-tasks
Nov 10 19:34:53 gerlinda kernel: SysRq : Show Blocked State
Nov 10 19:34:53 gerlinda kernel:   task                PC stack   pid 
father
Nov 10 19:34:54 gerlinda kernel: dd            D 00000286     0  4603   
2985
Nov 10 19:34:55 gerlinda kernel:        c580bcdc 00000086 c0308c20 
00000286 00000286 c580bcec 002a4e87 00000000
Nov 10 19:34:55 gerlinda kernel:        c580bd10 c0284bba c580bd1c 
00000000 c03775e0 c03775e0 002a4e87 c011d050
Nov 10 19:34:55 gerlinda kernel:        c117c030 c03771a0 00000064 
c02f8eb4 c0283efe c580bd44 c0145ebc 00000000
Nov 10 19:34:55 gerlinda kernel: Call Trace:
Nov 10 19:34:55 gerlinda kernel:  [<c0284bba>] schedule_timeout+0x4a/0xc0
Nov 10 19:34:55 gerlinda kernel:  [<c011d050>] process_timeout+0x0/0x10
Nov 10 19:34:55 gerlinda kernel:  [<c0283efe>] 
io_schedule_timeout+0xe/0x20
Nov 10 19:34:55 gerlinda kernel:  [<c0145ebc>] congestion_wait+0x6c/0x90
Nov 10 19:34:55 gerlinda kernel:  [<c01274e0>] 
autoremove_wake_function+0x0/0x50Nov 10 19:34:55 gerlinda kernel:  
[<c014135f>] balance_dirty_pages_ratelimited_nr+0x11f/0x1e0
Nov 10 19:34:55 gerlinda kernel:  [<c013cb98>] 
generic_file_buffered_write+0x2f8/0x6f0
Nov 10 19:34:55 gerlinda kernel:  [<c01198b7>] irq_exit+0x47/0x70
Nov 10 19:34:55 gerlinda kernel:  [<c01049e7>] do_IRQ+0x47/0x80
Nov 10 19:34:55 gerlinda kernel:  [<c0102cbf>] common_interrupt+0x23/0x28
Nov 10 19:34:55 gerlinda kernel:  [<c013d1e3>] 
__generic_file_aio_write_nolock+0x253/0x540
Nov 10 19:34:55 gerlinda kernel:  [<c012a87b>] 
hrtimer_run_queues+0x6b/0x290
Nov 10 19:34:55 gerlinda kernel:  [<c013d526>] 
generic_file_aio_write+0x56/0xd0 Nov 10 19:34:55 gerlinda kernel:  
[<c012ed9f>] tick_handle_periodic+0xf/0x70
Nov 10 19:34:55 gerlinda kernel:  [<c015a1d6>] do_sync_write+0xc6/0x110
Nov 10 19:34:55 gerlinda kernel:  [<c01274e0>] 
autoremove_wake_function+0x0/0x50Nov 10 19:34:55 gerlinda kernel:  
[<c01c604f>] clear_user+0x2f/0x50
Nov 10 19:34:55 gerlinda kernel:  [<c0120000>] ptrace_notify+0x30/0x90
Nov 10 19:34:55 gerlinda kernel:  [<c015aa56>] vfs_write+0xa6/0x140
Nov 10 19:34:55 gerlinda kernel:  [<c8926310>] SPADFS_FILE_WRITE+0x0/0x10 
[spadfs]
Nov 10 19:34:55 gerlinda kernel:  [<c015b031>] sys_write+0x41/0x70
Nov 10 19:34:55 gerlinda kernel:  [<c0102b16>] syscall_call+0x7/0xb
Nov 10 19:34:55 gerlinda kernel:  =======================
> Thanks,
> Miklos
> 
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.kernel.org
More majordomo info at  
http://vger.kernel.org/majordomo-info.html
Please read the FAQ at  
http://www.tux.org/lkml/