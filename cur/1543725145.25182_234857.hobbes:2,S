Date: Fri, 16 Jul 2004 16:16:03 -0400
From: Lee Revell <>
Subject: Re: [linux-audio-user] 2.6.8-rc1-mm1 [and alsa xrun debugging]
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2004/7/16/113

On Fri, 2004-07-16 at 10:25, Florian Schmidt wrote:
> after reading lee's email i had to try this kernel.. so i went over to www.de.kernel.org, grabbed 2.6.8-rc1 and patched it up with this patch: 
> 
> 
http://www.ussg.iu.edu/hypermail/linux/kernel/0407.1/1453.html
> 
> On first sight it looks very good. many of the sporadic xruns i experienced 
> with jack in RT mode are gone. even a "find /" parallel to a "make bzImage" 
> seems not to provoke any xruns [i use ext3]. But: i use fluxbox and it supports 
> desktop wheeling [switching desktop via scrollwheel - very handy] and doing this 
> excessively and rapidly provokes xruns easily. Also starting mozilla just provoked 
> an xrun..
Try the included patch.  Andrew Morton suggested this, and it works
great for me, but it is not in -mm1.
Lee
--- drivers/char/tty_io.c_orig  2004-07-16 16:10:11.000000000 -0400
+++ drivers/char/tty_io.c       2004-07-16 16:10:31.000000000 -0400
@@ -679,17 +679,13 @@
                return -ERESTARTSYS;
        }
        if ( test_bit(TTY_NO_WRITE_SPLIT, &tty->flags) ) {
-               lock_kernel();
                written = write(tty, file, buf, count);
-               unlock_kernel();
        } else {
                for (;;) {
                        unsigned long size = max((unsigned long)PAGE_SIZE*2, 16384UL);
                        if (size > count)
                                size = count;
-                       lock_kernel();
                        ret = write(tty, file, buf, size);
-                       unlock_kernel();
                        if (ret <= 0)
                                break;
                        written += ret;
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.kernel.org
More majordomo info at  
http://vger.kernel.org/majordomo-info.html
Please read the FAQ at  
http://www.tux.org/lkml/