Date: Sun, 13 Mar 2005 15:54:55 -0800 (PST)
From: Linus Torvalds <>
Subject: Re: [patch] x86: fix ESP corruption CPU bug
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2005/3/13/128

On Mon, 14 Mar 2005, Pavel Machek wrote:
> 
> What about flag similar to _TIF_SYSCALL_TRACE (call it
> _TIF_THIS_BEAST_USES_V86 or something), and only do the tests in the
> slowpath if it is set? As normal applications do not use v86, we could
> make this 0 instructions in syscall fast path...
It wouldn't help you. You'd need to mix in two of the values anyway, so at 
most you'd save one instruction. And the cost would be that anything that 
has ever used vm86 mode (can you say "X server"?) would be slower. Not a 
good trade-off.
Oh, I guess you could clear the flag when you know there's no vm86 state
anywhere (easy enough, those things never nest), but then it still comes
back to "extra complexity that you can get wrong, just to save a single
"mov" instruction - that "mov" may have partial-register-stall issues, 
but still..).
		Linus
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.kernel.org
More majordomo info at  
http://vger.kernel.org/majordomo-info.html
Please read the FAQ at  
http://www.tux.org/lkml/