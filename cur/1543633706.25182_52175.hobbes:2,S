Date: Thu, 13 Jun 2002 12:20:53 +0400
From: Andrey Panin <>
Subject: Re: [PATCH: NEW SUBARCHITECTURE FOR 2.5.21] support for NCR voyager (3/4/5xxx series)
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2002/6/13/49

Attached patch is needed to compile kernel with Voyager patch applied
for the SMP PC machine.
Also some questions, mostly related to arch-split patch:
[Q1] Will it be better to  create separate directory for PC architecture
and split some PC'isms from arch/i386/generic ? Right now it contains
acpi.c, bootflag.c and dmi_scan.c which are not generic in any way :)
[Q2] May be directory naming like mach-visws, mach-voyager and possible 
mach-pc will be more convinent ?
-- 
Andrey Panin            | Embedded systems software engineer
pazke@orbita1.ru        | PGP key: wwwkeys.eu.pgp.netdiff -urN -X /usr/share/dontdiff linux.vanilla/arch/i386/config.in linux/arch/i386/config.in
--- linux.vanilla/arch/i386/config.in	Thu Jun 13 00:30:57 2002
+++ linux/arch/i386/config.in	Wed Jun 12 20:25:15 2002
@@ -425,11 +425,6 @@
    fi
 fi
 
-if [ "$CONFIG_X86_LOCAL_APIC" = "y" ]; then
-   define_bool CONFIG_X86_EXTRA_IRQS y
-   define_bool CONFIG_X86_FIND_SMP_CONFIG y
-fi
-
 endmenu
 
 source lib/Config.in
@@ -443,6 +438,13 @@
    if [ "$CONFIG_SMP" = "y" ]; then
       define_bool CONFIG_X86_SMP y
       define_bool CONFIG_X86_HT y
+      define_bool CONFIG_X86_IO_APIC y
+      define_bool CONFIG_X86_LOCAL_APIC y
    fi
    define_bool CONFIG_X86_BIOS_REBOOT y
+fi
+
+if [ "$CONFIG_X86_LOCAL_APIC" = "y" ]; then
+   define_bool CONFIG_X86_EXTRA_IRQS y
+   define_bool CONFIG_X86_FIND_SMP_CONFIG y
 fi
diff -urN -X /usr/share/dontdiff linux.vanilla/arch/i386/generic/Makefile linux/arch/i386/generic/Makefile
--- linux.vanilla/arch/i386/generic/Makefile	Thu Jun 13 00:30:50 2002
+++ linux/arch/i386/generic/Makefile	Thu Jun 13 00:38:25 2002
@@ -18,7 +18,6 @@
 
 obj-y				:= setup.o
 
-obj-$(CONFIG_PCI)		+= pci-pc.o pci-irq.o
 obj-$(CONFIG_X86_LOCAL_APIC)	+= mpparse.o
 
 include $(TOPDIR)/Rules.make[unhandled content-type:application/pgp-signature]