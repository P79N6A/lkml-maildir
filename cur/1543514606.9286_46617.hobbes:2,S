Date: Sat, 30 Oct 1999 14:56:01 -0500 (CDT)
From: "Scott G. Miller" <>
Subject: SMC-Ultra sluggishness.... more data
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/1999/10/30/45

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1
Okay, I've managed to get the NIC into the sluggish mode, though I'm not
exactly sure how.  Below is the relevant data, including a bit of tcpdump
for an ftp fetch of the kernel.  Normally this would run at about 300k per
second, but its stalling bad and running at an ETA of 60 minutes right
now:
bash-2.02# cat /proc/interrupts
           CPU0       
  0:    6949727          XT-PIC  timer
  1:      42566          XT-PIC  keyboard
  2:          0          XT-PIC  cascade
  8:          3          XT-PIC  rtc
  9:     221820          XT-PIC  bttv
 10:    2322587          XT-PIC  aic7xxx, Trident 4DWave PCI
 11:     516788          XT-PIC  SMC EtherEZ
 12:     355106          XT-PIC  PS/2 Mouse
 13:          1          XT-PIC  fpu
 14:      37335          XT-PIC  ide0
 15:       1085          XT-PIC  ide1
NMI:          0
 
bash-2.02# cat /proc/ioports   
0000-001f : dma1
0020-003f : pic1
0040-005f : timer
0060-006f : keyboard
0070-007f : rtc
0080-008f : dma page reg
00a0-00bf : pic2
00c0-00df : dma2
00f0-00ff : fpu
0170-0177 : ide1
01f0-01f7 : ide0
0240-025f : SMC EtherEZ
02f8-02ff : serial(set)
0376-0376 : ide1
03c0-03df : vga+
03f6-03f6 : ide0
03f8-03ff : serial(set)
b800-b8ff : Trident 4DWave PCI
d000-d0be : aic7xxx
d800-d807 : ide0
d808-d80f : ide1
bash-2.02# ifconfig          
eth0      Link encap:Ethernet  HWaddr 00:E0:29:03:E4:79  
          inet addr:149.159.42.2  Bcast:149.159.42.255  Mask:255.255.255.0
          UP BROADCAST RUNNING MULTICAST  MTU:1500  Metric:1
          RX packets:424641 errors:0 dropped:0 overruns:0 frame:63
          TX packets:110534 errors:39 dropped:0 overruns:0 carrier:78
          collisions:38597 txqueuelen:100 
          Interrupt:11 Base address:0x250 Memory:c8000-ca000 
lo        Link encap:Local Loopback  
          inet addr:127.0.0.1  Mask:255.0.0.0
          UP LOOPBACK RUNNING  MTU:3924  Metric:1
          RX packets:24979 errors:0 dropped:0 overruns:0 frame:0
          TX packets:24979 errors:0 dropped:0 overruns:0 carrier:0
          collisions:0 txqueuelen:0 
Here's about 20 seconds of the tcpdump, notice how there's practically no
actual transfer activity: 
14:54:24.178845 149.159.42.2.2705 > 129.79.6.139.21: P 1075964569:1075964577(8) ack 2069996118 win 32120 <nop,nop,timestamp 6966906 9947838> (DF)
14:54:24.180799 129.79.6.139.21 > 149.159.42.2.2705: P 1:17(16) ack 8 win 10136 <nop,nop,timestamp 9948605 6966906> (DF)
14:54:24.180987 149.159.42.2.2705 > 129.79.6.139.21: P 8:35(27) ack 17 win 32120 <nop,nop,timestamp 6966906 9948605> (DF)
14:54:24.183391 129.79.6.139.21 > 149.159.42.2.2705: P 17:31(14) ack 35 win 10136 <nop,nop,timestamp 9948606 6966906> (DF)
14:54:24.183551 149.159.42.2.2705 > 129.79.6.139.21: P 35:62(27) ack 31 win 32120 <nop,nop,timestamp 6966906 9948606> (DF)
14:54:24.186193 129.79.6.139.21 > 149.159.42.2.2705: P 31:51(20) ack 62 win 10136 <nop,nop,timestamp 9948606 6966906> (DF)
14:54:24.187472 149.159.42.2.2705 > 129.79.6.139.21: P 62:88(26) ack 51 win 32120 <nop,nop,timestamp 6966907 9948606> (DF)
14:54:24.189230 129.79.6.139.21 > 149.159.42.2.2705: P 51:81(30) ack 88 win 10136 <nop,nop,timestamp 9948606 6966907> (DF)
14:54:24.189374 149.159.42.2.2705 > 129.79.6.139.21: P 88:115(27) ack 81 win 32120 <nop,nop,timestamp 6966907 9948606> (DF)
14:54:24.192361 129.79.6.139.20 > 149.159.42.2.2707: S 2072241050:2072241050(0) win 8760 <mss 1460> (DF)
14:54:24.192442 149.159.42.2.2707 > 129.79.6.139.20: S 1100703962:1100703962(0) ack 2072241051 win 32120 <mss 1460> (DF)
14:54:24.232834 129.79.6.139.21 > 149.159.42.2.2705: . ack 115 win 10136 <nop,nop,timestamp 9948611 6966907> (DF)
14:54:27.684075 149.159.42.2.2707 > 129.79.6.139.20: S 1100703962:1100703962(0) ack 2072241051 win 32120 <mss 1460> (DF)
14:54:27.685746 129.79.6.139.20 > 149.159.42.2.2707: S 2072241050:2072241050(0) win 8760 <mss 1460> (DF)
14:54:27.685823 149.159.42.2.2707 > 129.79.6.139.20: S 1100703962:1100703962(0) ack 2072241051 win 32120 <mss 1460> (DF)
14:54:27.686982 129.79.6.139.20 > 149.159.42.2.2707: . ack 1 win 8760 (DF)
14:54:27.687343 129.79.6.139.21 > 149.159.42.2.2705: P 81:165(84) ack 115 win 10136 <nop,nop,timestamp 9948956 6966907> (DF)
14:54:27.702645 129.79.6.139.20 > 149.159.42.2.2707: P 1:1461(1460) ack 1 win 8760 (DF)
14:54:27.702724 149.159.42.2.2707 > 129.79.6.139.20: . ack 1461 win 30660 (DF)
14:54:27.704058 149.159.42.2.2705 > 129.79.6.139.21: . ack 165 win 32120 <nop,nop,timestamp 6967259 9948956> (DF)
14:54:27.707107 129.79.6.139.20 > 149.159.42.2.2707: . 1461:2921(1460) ack 1 win 8760 (DF)
14:54:27.707987 129.79.6.139.20 > 149.159.42.2.2707: P 2921:4097(1176) ack 1 win 8760 (DF)
14:54:27.714055 149.159.42.2.2707 > 129.79.6.139.20: . ack 4097 win 32120 (DF)
14:54:27.718282 129.79.6.139.20 > 149.159.42.2.2707: . 5557:7017(1460) ack 1 win 8760 (DF)
14:54:27.718337 149.159.42.2.2707 > 129.79.6.139.20: . ack 4097 win 32120 (DF)
14:54:27.719176 129.79.6.139.20 > 149.159.42.2.2707: P 7017:8193(1176) ack 1 win 8760 (DF)
14:54:27.719238 149.159.42.2.2707 > 129.79.6.139.20: . ack 4097 win 32120 (DF)
14:54:32.328818 129.79.6.139.20 > 149.159.42.2.2707: . 4097:5557(1460) ack 1 win 8760 (DF)
14:54:32.328924 149.159.42.2.2707 > 129.79.6.139.20: . ack 8193 win 29200 (DF)
14:54:32.333607 129.79.6.139.20 > 149.159.42.2.2707: . 8193:9653(1460) ack 1 win 8760 (DF)
14:54:32.334843 129.79.6.139.20 > 149.159.42.2.2707: P 9653:11113(1460) ack 1 win 8760 (DF)
14:54:32.335027 149.159.42.2.2707 > 129.79.6.139.20: . ack 11113 win 30660 (DF)
14:54:32.340303 129.79.6.139.20 > 149.159.42.2.2707: . 12289:13749(1460) ack 1 win 8760 (DF)
14:54:32.340361 149.159.42.2.2707 > 129.79.6.139.20: . ack 11113 win 30660 (DF)
14:54:32.341534 129.79.6.139.20 > 149.159.42.2.2707: . 13749:15209(1460) ack 1 win 8760 (DF)
14:54:32.341587 149.159.42.2.2707 > 129.79.6.139.20: . ack 11113 win 30660 (DF)
14:54:37.130177 129.79.6.139.20 > 149.159.42.2.2707: . 11113:12573(1460) ack 1 win 8760 (DF)
14:54:37.130284 149.159.42.2.2707 > 129.79.6.139.20: . ack 15209 win 29200 (DF)
14:54:37.137663 129.79.6.139.20 > 149.159.42.2.2707: . 15209:16385(1176) ack 1 win 8760 (DF)
14:54:37.139055 129.79.6.139.20 > 149.159.42.2.2707: . 16385:17845(1460) ack 1 win 8760 (DF)
14:54:37.634063 149.159.42.2.2707 > 129.79.6.139.20: . ack 17845 win 32120 (DF)
14:54:37.638165 129.79.6.139.20 > 149.159.42.2.2707: . 17845:19305(1460) ack 1 win 8760 (DF)
14:54:37.639045 129.79.6.139.20 > 149.159.42.2.2707: . 19305:20481(1176) ack 1 win 8760 (DF)
14:54:37.640412 129.79.6.139.20 > 149.159.42.2.2707: . 20481:21941(1460) ack 1 win 8760 (DF)
14:54:37.640465 149.159.42.2.2707 > 129.79.6.139.20: . ack 21941 win 30660 (DF)
14:54:37.644960 129.79.6.139.20 > 149.159.42.2.2707: . 21941:23401(1460) ack 1 win 8760 (DF)
14:54:37.645839 129.79.6.139.20 > 149.159.42.2.2707: . 23401:24577(1176) ack 1 win 8760 (DF)
14:54:37.647300 129.79.6.139.20 > 149.159.42.2.2707: . 24577:26037(1460) ack 1 win 8760 (DF)
14:54:37.647350 149.159.42.2.2707 > 129.79.6.139.20: . ack 26037 win 30660 (DF)
14:54:42.000959 129.79.6.139.20 > 149.159.42.2.2707: . 21941:23401(1460) ack 1 win 8760 (DF)
14:54:42.001102 149.159.42.2.2707 > 129.79.6.139.20: . ack 26037 win 30660 (DF)
14:54:42.006700 129.79.6.139.20 > 149.159.42.2.2707: . 26037:27497(1460) ack 1 win 8760 (DF)
14:54:42.007596 129.79.6.139.20 > 149.159.42.2.2707: P 27497:28673(1176) ack 1 win 8760 (DF)
14:54:42.504065 149.159.42.2.2707 > 129.79.6.139.20: . ack 28673 win 32120 (DF)
14:54:42.526528 129.79.6.139.20 > 149.159.42.2.2707: . 28673:30133(1460) ack 1 win 8760 (DF)
14:54:42.527790 129.79.6.139.20 > 149.159.42.2.2707: . 30133:31593(1460) ack 1 win 8760 (DF)
14:54:42.527897 149.159.42.2.2707 > 129.79.6.139.20: . ack 31593 win 30660 (DF)
14:54:42.528761 129.79.6.139.20 > 149.159.42.2.2707: P 31593:32769(1176) ack 1 win 8760 (DF)
14:54:42.543954 129.79.6.139.20 > 149.159.42.2.2707: P 34229:35689(1460) ack 1 win 8760 (DF)
14:54:42.544021 149.159.42.2.2707 > 129.79.6.139.20: . ack 32769 win 30660 (DF)
14:54:46.313090 129.79.6.139.20 > 149.159.42.2.2707: . 32769:34229(1460) ack 1 win 8760 (DF)
14:54:46.313196 149.159.42.2.2707 > 129.79.6.139.20: . ack 35689 win 30660 (DF)
14:54:46.317530 129.79.6.139.20 > 149.159.42.2.2707: . 35689:36865(1176) ack 1 win 8760 (DF)
14:54:46.318893 129.79.6.139.20 > 149.159.42.2.2707: . 36865:38325(1460) ack 1 win 8760 (DF)
14:54:46.814074 149.159.42.2.2707 > 129.79.6.139.20: . ack 38325 win 32120 (DF)
14:54:46.818388 129.79.6.139.20 > 149.159.42.2.2707: . 38325:39785(1460) ack 1 win 8760 (DF)
14:54:47.314174 149.159.42.2.2707 > 129.79.6.139.20: . ack 39785 win 32120 (DF)
14:54:47.319136 129.79.6.139.20 > 149.159.42.2.2707: . 42421:43881(1460) ack 1 win 8760 (DF)
14:54:47.319211 149.159.42.2.2707 > 129.79.6.139.20: . ack 39785 win 32120 (DF)
14:54:49.833073 129.79.6.139.20 > 149.159.42.2.2707: . 39785:41245(1460) ack 1 win 8760 (DF)
14:54:49.833176 149.159.42.2.2707 > 129.79.6.139.20: . ack 41245 win 30660 (DF)
14:54:49.837605 129.79.6.139.20 > 149.159.42.2.2707: . 41245:42705(1460) ack 1 win 8760 (DF)
14:54:49.838484 129.79.6.139.20 > 149.159.42.2.2707: . 42705:43881(1176) ack 1 win 8760 (DF)
14:54:49.838591 149.159.42.2.2707 > 129.79.6.139.20: . ack 43881 win 32120 (DF)
14:54:49.844560 129.79.6.139.20 > 149.159.42.2.2707: . 45057:46517(1460) ack 1 win 8760 (DF)
14:54:49.844618 149.159.42.2.2707 > 129.79.6.139.20: . ack 43881 win 32120 (DF)
14:54:49.845796 129.79.6.139.20 > 149.159.42.2.2707: . 46517:47977(1460) ack 1 win 8760 (DF)
14:54:49.845972 149.159.42.2.2707 > 129.79.6.139.20: . ack 43881 win 32120 (DF)
I'm not going to reset the stack, so if you have any other tests you want
me to throw at it, let me know.
	Scott
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.0.0 (GNU/Linux)
Comment: For info see 
http://www.gnupg.org
iD8DBQE4G01SpXyM95IyRhURAtRNAKDEoct9F1Yw1sguvotD4bM6If0qNwCfdCyw
VBBIWFJqOpiht6+c/pDc+5M=
=5h8t
-----END PGP SIGNATURE-----
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.rutgers.edu
Please read the FAQ at 
http://www.tux.org/lkml/