Date: Thu, 21 Feb 2002 10:43:33 +1100 (EST)
From: Neil Brown <>
Subject: Re: 2.5.5 -- filesystems.c:30: In function `sys_nfsservctl': dereferencing pointer to incomplete type
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2002/2/20/213

On  February 20, rml@tech9.net wrote:
> On Wed, 2002-02-20 at 15:27, Neil Brown wrote:
> 
> > Opps, my mistake.
> > 
> > Please try this.
> 
> This does not apply to my include/linux/nfsd/interface.h ?
> 
> In 2.5.5, that file is 24 lines long.  The first hunk applies, but the
> second, at line 155, obviously does not.
Post in haste ... repent at leisure....
I made that patch against my current, heavily patches tree as I though
that the changes to interface.h wouldn't conflict... I was wrong.
The correct patch, which applies against 2.5.5 and compiles with out
errors for several combinationg of CONFIG_MODULES enabled or not, and
CONFIG_NFSD being Y, M, or N, is below.
NeilBrown
 ----------- Diffstat output ------------
 ./include/linux/nfsd/interface.h |    4 +++-
 1 files changed, 3 insertions(+), 1 deletion(-)
--- ./include/linux/nfsd/interface.h	2002/02/20 21:58:11	1.1
+++ ./include/linux/nfsd/interface.h	2002/02/20 23:35:19	1.2
@@ -12,13 +12,15 @@
 
 #include <linux/config.h>
 
-#ifdef CONFIG_NFSD_MODULE
+#ifndef CONFIG_NFSD
+#ifdef CONFIG_MODULES
 
 extern struct nfsd_linkage {
 	long (*do_nfsservctl)(int cmd, void *argp, void *resp);
 	struct module *owner;
 } * nfsd_linkage;
 
+#endif
 #endif
 
 #endif /* LINUX_NFSD_INTERFACE_H */
> 
> 	Robert Love
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.kernel.org
More majordomo info at  
http://vger.kernel.org/majordomo-info.html
Please read the FAQ at  
http://www.tux.org/lkml/