Date: Fri, 7 May 2004 12:34:37 -0500
From:  mikem@beardog ...
Subject: cpqarray update for 2.6
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2004/5/7/119

This patch fixes 2 minor issues that break our Array Configuration utility.
my_io was changed to a pointer so the & had to removed when using it with copy_to_user().
Sometime in 2.5 SG_MAX got changed to 31. Maybe to copy cciss? Now I'm changing it back to 32 so our app can work.
Please consider this for inclusion.
Thanks,
mikem
-------------------------------------------------------------------------------
 cpqarray.c |    2 +-
 ida_cmd.h  |    2 +-
 2 files changed, 2 insertions(+), 2 deletions(-)
diff -burpN lx266-rc2.orig/drivers/block/cpqarray.c lx266-rc2-cpqarray/drivers/block/cpqarray.c
--- lx266-rc2.orig/drivers/block/cpqarray.c	2004-04-03 21:36:24.000000000 -0600
+++ lx266-rc2-cpqarray/drivers/block/cpqarray.c	2004-05-05 10:55:16.000000000 -0500
@@ -1193,7 +1193,7 @@ static int ida_ioctl(struct inode *inode
 		if (error)
 			goto out_passthru;
 		error = -EFAULT;
-		if (copy_to_user(io, &my_io, sizeof(*my_io)))
+		if (copy_to_user(io, my_io, sizeof(*my_io)))
 			goto out_passthru;
 		error = 0;
 out_passthru:
diff -burpN lx266-rc2.orig/drivers/block/ida_cmd.h lx266-rc2-cpqarray/drivers/block/ida_cmd.h
--- lx266-rc2.orig/drivers/block/ida_cmd.h	2004-04-03 21:36:54.000000000 -0600
+++ lx266-rc2-cpqarray/drivers/block/ida_cmd.h	2004-05-05 10:53:59.000000000 -0500
@@ -67,7 +67,7 @@ typedef struct {
 	__u8	reserved;
 } rhdr_t;
 
-#define SG_MAX			31
+#define SG_MAX			32
 typedef struct {
 	rhdr_t	hdr;
 	sg_t	sg[SG_MAX];
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.kernel.org
More majordomo info at  
http://vger.kernel.org/majordomo-info.html
Please read the FAQ at  
http://www.tux.org/lkml/