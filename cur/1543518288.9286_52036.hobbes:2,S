Date: 07 Dec 1999 19:09:39 -0800
From: Ulrich Drepper <>
Subject: Re: 2.3.30pre1 syscall w/6 args support?
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/1999/12/7/189

Linus Torvalds <torvalds@transmeta.com> writes:
> Anybody who thinks that having two different libc's on different machines
> is acceptable is so out of touch with reality that it is scary.
In your always friendly way of explaining your opinions (== laws) you
completely miss that there are/will be different versions anyhow.
Some people want to use other features (let's say, FPU, MXX) which are
not generally available and so there are different libraries.  This is
not something new which is coming up with the syscalls.  They simply
add another dimension which is absolutely no problem to manage.
And also: look what a syscall implementation would have to do.  There
is still a syscall wrapper necessary since your magic code does not do
proper error handling.  You have to
- get the arguments from the stack
- push them immediately again
(these two steps can only be avoided if you have a syscall with less
 than two arguments; if you have less you can temporarily store the
 return address in %edx, and %ebx in %ecx)
- call the magic function
- correct the stack to remove the parameters
- handle errors
- return
So besides your unnecessary memory reads in the magic function, you
also to read and write all parameters in the syscall wrapper and then
correct the stack pointer afterwards (which is a quite expensive
operation if you want to work with the stack pointer immediately
afterwards).
-- 
---------------.      drepper at gnu.org  ,-.   1325 Chesapeake Terrace
Ulrich Drepper  \    ,-------------------'   \  Sunnyvale, CA 94089 USA
Cygnus Solutions `--' drepper at cygnus.com   `------------------------
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.rutgers.edu
Please read the FAQ at 
http://www.tux.org/lkml/