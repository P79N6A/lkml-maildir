Date: Mon, 21 May 2001 12:27:33 +0200 (CEST)
From: kees <>
Subject: lockups with SMP 2.4.4 (next one)
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2001/5/21/29

Hi
Within one hour I got the next one, kdb log in attachment.
first line of kdb_log:
------------------------------------------------
Entering kdb (current=0xc2168000, pid 1593) kdb: Debugger re-entered on cpu 1, new reason = 10
on processor 0      Strange, cpu 1 should not be running
     Not executing a kdb command
     No longjmp available for recovery
due to WatchDog Interrupt @ 0xc0108f05
     Cannot recover, allowing event to proceed
eax = 0xc0111eb4 ebx = 0xc03de880 ecx = 0x00000004 edx = 0xc03de888 
esi = 0xc6d01640 edi = 0x00000012 esp = 0xc2169e9c eip = 0xc0108f05 
ebp = 0xc2169eac xss = 0x00000018 xcs = 0x00000010 eflags = 0x00000002 
xds = 0xc2160018 xes = 0xc01c0018 origeax = 0xc0111eb4 &regs = 0xc2169e68
[0]kdb> o2o6o8o-o9o4ooooo''5'i'a'd'kdb: expected enter got 0xe9 status 0x14
Unknown kdb command: 'o2o6o8o'
*** input to kdb ^^^^^^^  is rubbish because something felt on keyboard...
[0]kdb> cpu      
Currently on cpu 0
Available cpus: 0, 1*
[0]kdb> bt
    EBP       EIP         Function(args)
0xc2169eac 0xc0108f05 free_irq+0x71 (0x4, 0xc03fc3d0)
                               kernel .text 0xc0100000 0xc0108e94 0xc0108f2c
0xc2169ec8 0xc01d2141 shutdown+0xf9 (0xc12af680)
                               kernel .text 0xc0100000 0xc01d2048 0xc01d22b0
0xc2169ee0 0xc01d3aa0 rs_close+0x138 (0xc3f71000, 0xc6062d40)
                               kernel .text 0xc0100000 0xc01d3968 0xc01d3b3c
0xc2169f50 0xc01c07ef release_dev+0x26f (0xc6062d40)
 
------------------------------------------------------------------------
Observations: 
- compiling the kernel as UP keeps it from crashing
- the bios RTC is most of the times disturbed after a crash
The application 'hart' does basically the following:
	for(;;)
	{	
		open port (ttyS0)
		write a few bytes
		ioctl toggle RTS line
		read a few bytes (with poll)
		close port
	}
If some information is required, I'll try to provide it.
Kees
Entering kdb (current=0xc2168000, pid 1593) kdb: Debugger re-entered on cpu 1, new reason = 10
on processor 0      Strange, cpu 1 should not be running
     Not executing a kdb command
     No longjmp available for recovery
due to WatchDog Interrupt @ 0xc0108f05
     Cannot recover, allowing event to proceed
eax = 0xc0111eb4 ebx = 0xc03de880 ecx = 0x00000004 edx = 0xc03de888 
esi = 0xc6d01640 edi = 0x00000012 esp = 0xc2169e9c eip = 0xc0108f05 
ebp = 0xc2169eac xss = 0x00000018 xcs = 0x00000010 eflags = 0x00000002 
xds = 0xc2160018 xes = 0xc01c0018 origeax = 0xc0111eb4 &regs = 0xc2169e68
[0]kdb> o2o6o8o-o9o4ooooo''5'i'a'd'kdb: expected enter got 0xe9 status 0x14
Unknown kdb command: 'o2o6o8o'
*** input to kdb ^^^^^^^  is rubbish because something felt on keyboard...
[0]kdb> cpu      
Currently on cpu 0
Available cpus: 0, 1*
[0]kdb> bt
    EBP       EIP         Function(args)
0xc2169eac 0xc0108f05 free_irq+0x71 (0x4, 0xc03fc3d0)
                               kernel .text 0xc0100000 0xc0108e94 0xc0108f2c
0xc2169ec8 0xc01d2141 shutdown+0xf9 (0xc12af680)
                               kernel .text 0xc0100000 0xc01d2048 0xc01d22b0
0xc2169ee0 0xc01d3aa0 rs_close+0x138 (0xc3f71000, 0xc6062d40)
                               kernel .text 0xc0100000 0xc01d3968 0xc01d3b3c
0xc2169f50 0xc01c07ef release_dev+0x26f (0xc6062d40)
                               kernel .text 0xc0100000 0xc01c0580 0xc01c0adc
0xc2169f60 0xc01c0e8b tty_release+0x2f (0xc4d05440, 0xc6062d40)
                               kernel .text 0xc0100000 0xc01c0e5c 0xc01c0ec8
0xc2169f80 0xc0134c85 fput+0x41 (0xc6062d40, 0xc344d780, 0x0, 0xc6062d40, 0x0)
                               kernel .text 0xc0100000 0xc0134c44 0xc0134d38
0xc2169fa8 0xc0133bc1 filp_close+0xb9 (0xc6062d40, 0xc344d780, 0xc2168000, 0xbffff254)
                               kernel .text 0xc0100000 0xc0133b08 0xc0133bd0
0xc2169fbc 0xc0133c2f sys_close+0x5f (0x3, 0xbffff2bb, 0x8049b40, 0x4000aa20, 0xbffff39c)
                               kernel .text 0xc0100000 0xc0133bd0 0xc0133c48
           0xc0106d37 system_call+0x37
                               kernel .text 0xc0100000 0xc0106d00 0xc0106d40
[0]kdb> ps
Task Addr  Pid      Parent   [*] cpu  State Thread     Command
0xc1234000 00000001 00000000  0  000  stop  0xc1234350 init
0xc12e4000 00000002 00000001  0  001  stop  0xc12e4350 keventd
0xc12d6000 00000003 00000001  0  001  stop  0xc12d6350 kswapd
0xc12d4000 00000004 00000001  0  001  stop  0xc12d4350 kreclaimd
0xc12d0000 00000005 00000001  0  000  stop  0xc12d0350 bdflush
0xc12ce000 00000006 00000001  0  000  stop  0xc12ce350 kupdated
0xc13fa000 00000008 00000001  0  000  stop  0xc13fa350 scsi_eh_1
0xc7a74000 00000128 00000001  0  000  stop  0xc7a74350 syslogd
0xc7a1a000 00000132 00000001  0  000  run   0xc7a1a350 klogd
0xc7b74000 00000173 00000001  0  000  stop  0xc7b74350 mingetty
0xc7aca000 00000174 00000001  0  001  stop  0xc7aca350 mingetty
0xc1332000 00000175 00000001  0  001  stop  0xc1332350 mingetty
0xc7c1c000 00000176 00000001  0  000  stop  0xc7c1c350 mingetty
0xc7d90000 00000177 00000001  0  001  stop  0xc7d90350 mingetty
0xc7706000 00000253 00000001  0  001  stop  0xc7706350 timed
0xc7564000 00000380 00000001  0  001  stop  0xc7564350 named
0xc7748000 00000457 00000001  0  001  stop  0xc7748350 atd
0xc72a6000 00000466 00000001  0  000  stop  0xc72a6350 inetd
0xc7290000 00000481 00000001  0  001  stop  0xc7290350 lpd
0xc72c8000 00000506 00000001  0  001  stop  0xc72c8350 safe_mysqld
0xc718c000 00000521 00000506  0  000  stop  0xc718c350 mysqld
0xc6fc0000 00000548 00000521  0  001  stop  0xc6fc0350 mysqld
0xc6fbc000 00000549 00000548  0  001  stop  0xc6fbc350 mysqld
0xc6e4a000 00000559 00000001  0  001  stop  0xc6e4a350 sendmail
0xc6d68000 00000562 00000001  0  000  stop  0xc6d68350 nmbd
0xc6d60000 00000563 00000562  0  000  stop  0xc6d60350 nmbd
0xc7208000 00000566 00000001  0  001  stop  0xc7208350 smbd
0xc6bc6000 00000610 00000001  0  000  stop  0xc6bc6350 cron
0xc6c14000 00000648 00000001  0  001  stop  0xc6c14350 xdm
0xc6b6e000 00000651 00000648  0  000  stop  0xc6b6e350 X
0xc7756000 00000652 00000001  0  000  stop  0xc7756350 mingetty
0xc6916000 00000653 00000648  0  000  stop  0xc6916350 xdm
0xc6402000 00000666 00000001  0  000  stop  0xc6402350 xconsole
0xc60a2000 00000674 00000653  0  000  stop  0xc60a2350 startkde
0xc5676000 00000778 00000001  0  000  stop  0xc5676350 kdeinit
0xc5618000 00000780 00000001  0  000  stop  0xc5618350 kdeinit
0xc55ca000 00000782 00000001  0  000  stop  0xc55ca350 kdeinit
0xc542c000 00000785 00000001  1  001  run   0xc542c350 kdeinit
0xc4b9c000 00000788 00000001  0  000  stop  0xc4b9c350 artsd
0xc4728000 00000804 00000001  0  001  stop  0xc4728350 kdeinit
0xc4796000 00000810 00000001  0  000  stop  0xc4796350 kdeinit
0xc4210000 00000812 00000001  0  000  stop  0xc4210350 kdeinit
0xc4230000 00000814 00000001  0  000  stop  0xc4230350 kdeinit
0xc4060000 00000816 00000001  0  000  stop  0xc4060350 kdeinit
0xc4058000 00000817 00000001  0  000  stop  0xc4058350 kdeinit
0xc3f16000 00000819 00000817  0  000  stop  0xc3f16350 cat
0xc3f04000 00000820 00000001  0  000  stop  0xc3f04350 knotify
0xc3eae000 00000824 00000674  0  000  stop  0xc3eae350 ksmserver
0xc3c6c000 00000828 00000816  0  001  stop  0xc3c6c350 kdeinit
0xc3a12000 00000829 00000828  0  001  stop  0xc3a12350 xosview.bin
0xc39e6000 00000830 00000828  0  001  stop  0xc39e6350 xbiff
0xc383e000 00000843 00000816  0  000  stop  0xc383e350 oclock
0xc3890000 00000844 00000816  0  000  stop  0xc3890350 kdeinit
0xc37a8000 00000846 00000816  0  000  stop  0xc37a8350 kdeinit
0xc35f4000 00000847 00000001  0  000  stop  0xc35f4350 kmix
0xc33d4000 00000860 00000844  0  000  stop  0xc33d4350 bash
0xc33ae000 00000861 00000846  0  000  stop  0xc33ae350 bash
0xc49be000 00001592 00000816  0  000  stop  0xc49be350 xterm
0xc2168000 00001593 00001592  1  000  run   0xc2168350*hart
0xc28a0000 00001730 00000860  0  001  stop  0xc28a0350 vi
0xc2140000 00001868 00000861  0  001  stop  0xc2140350 less
0xc20f0000 00001911 00000610  0  001  stop  0xc20f0350 cron
[0]kdb> btp 1593
    EBP       EIP         Function(args)
0xc12af680 0xc0108f05 free_irq+0x71 (0x4, 0xc03fc3d0)
                               kernel .text 0xc0100000 0xc0108e94 0xc0108f2c
0xc2169ec8 0xc01d2141 shutdown+0xf9 (0xc12af680)
                               kernel .text 0xc0100000 0xc01d2048 0xc01d22b0
0xc2169ee0 0xc01d3aa0 rs_close+0x138 (0xc3f71000, 0xc6062d40)
                               kernel .text 0xc0100000 0xc01d3968 0xc01d3b3c
0xc2169f50 0xc01c07ef release_dev+0x26f (0xc6062d40)
                               kernel .text 0xc0100000 0xc01c0580 0xc01c0adc
0xc2169f60 0xc01c0e8b tty_release+0x2f (0xc4d05440, 0xc6062d40)
                               kernel .text 0xc0100000 0xc01c0e5c 0xc01c0ec8
0xc2169f80 0xc0134c85 fput+0x41 (0xc6062d40, 0xc344d780, 0x0, 0xc6062d40, 0x0)
                               kernel .text 0xc0100000 0xc0134c44 0xc0134d38
0xc2169fa8 0xc0133bc1 filp_close+0xb9 (0xc6062d40, 0xc344d780, 0xc2168000, 0xbffff254)
                               kernel .text 0xc0100000 0xc0133b08 0xc0133bd0
0xc2169fbc 0xc0133c2f sys_close+0x5f (0x3, 0xbffff2bb, 0x8049b40, 0x4000aa20, 0xbffff39c)
                               kernel .text 0xc0100000 0xc0133bd0 0xc0133c48
           0xc0106d37 system_call+0x37
                               kernel .text 0xc0100000 0xc0106d00 0xc0106d40