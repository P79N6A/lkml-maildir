Date: Tue, 29 Apr 2008 11:55:43 -0700
From: Greg KH <>
Subject: Re: [27/37] tehuti: move ioctl perm check closer to function start (CVE-2008-1675)
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2008/4/29/510

On Tue, Apr 29, 2008 at 07:13:09PM +0100, Alan Cox wrote:
> On Tue, 29 Apr 2008 10:19:01 -0700
> Greg KH <gregkh@suse.de> wrote:
> 
> > 2.6.25-stable review patch.  If anyone has any objections, please let us
> > know.
> > 
> > ------------------
> > From: Jeff Garzik <jeff@garzik.org>
> > 
> > Commit f946dffed6334f08da065a89ed65026ebf8b33b4 upstream
> > 
> > Noticed by davem.
> > 
> > Signed-off-by: Jeff Garzik <jgarzik@redhat.com>
> > Signed-off-by: Greg Kroah-Hartman <gregkh@suse.de>
> > 
> > ---
> >  drivers/net/tehuti.c |    5 +++--
> >  1 file changed, 3 insertions(+), 2 deletions(-)
> > 
> > --- a/drivers/net/tehuti.c
> > +++ b/drivers/net/tehuti.c
> > @@ -649,6 +649,9 @@ static int bdx_ioctl_priv(struct net_dev
> >  		DBG("%d 0x%x 0x%x\n", data[0], data[1], data[2]);
> >  	}
> > 
> > +	if (!capable(CAP_NET_ADMIN))
> > +		return -EPERM;
> > +
> 
> Should be CAP_SYS_RAWIO
Hm, that's the way it is in Linus's tree, we should change it there
first.
thanks,
greg k-h