Date: Thu, 3 Apr 2003 23:41:40 -0500
From: Ion Badulescu <>
Subject: Re: Deactivating TCP checksumming
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2003/4/3/263

On Thu, 3 Apr 2003 15:34:59 -0500, Dennis Cook <cook@sandgate.com> wrote:
> Based on various feedback, on my RH Linux 2.4.18 kernel I tried the
> following:
> 
> Set "features" bit NETIF_F_IP_CSUM set (the only feature bit set).
> In my network driver start-transmit check for "CHECKSUM_HW" in ip_summed.
> Using a small test program, use "sendfile" to copy a file to a network
> socket FD.
> Result is none of the packets presented to my network adapter driver have
> ip_summed set to CHECKSUM_HW, so the SW IP stack has already
> computed checksums.
> 
> Is this mechanism possibly broken on kernel 2.4?
No, but you also need the scatter-gather bit to be set. Otherwise the 
network needs to perform at least one copy to linearize the skb, thus it 
will take the opportunity to checksum it at the same time so the 
hardware capability of the board is not used.
Ion
-- 
  It is better to keep your mouth shut and be thought a fool,
            than to open it and remove all doubt.
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.kernel.org
More majordomo info at  
http://vger.kernel.org/majordomo-info.html
Please read the FAQ at  
http://www.tux.org/lkml/