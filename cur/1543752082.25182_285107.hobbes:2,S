Date: Tue, 11 Jan 2005 08:41:17 +0900
From: OGAWA Hirofumi <>
Subject: Re: vfat unlink latency 54.6ms for 128MB files
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2005/1/10/321

Robert Hardy <rhardy@webcon.ca> writes:
> Thanks for your patchset.tar (in another thread) from:
> Thu, 30 Dec 2004 12:02:14 +0900.
>
> Based on the patch above, is an additional cond_resched() call required
> somewhere in your 2004/12/30 patchset?
>
> In your 2004/12/30 patchset, if I am reading it correctly, fat_free seems to
> have moved from cache.c to file.c and the code isn't similar enough for me
> to see where a cond_resched() could be added.
Yes. For that patchset, need to add the similar code to
fat_free_cluster() in fs/fat/fatent.c.
		err = fat_write_entry(sb, &fatent, FAT_ENT_FREE);
		if (err)
			goto error;
		if (sbi->free_clusters != -1)
			sbi->free_clusters++;
                cond_resched();     <---  add this line
	} while (cluster != FAT_ENT_EOF);
> Perhaps you have already have a newer patchset?
Yes. I added the 8~10 patches to patchset. However, current patchset
can't compile temporarily.  Sorry. Please wait for next weekend.
-- 
OGAWA Hirofumi <hirofumi@mail.parknet.co.jp>
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.kernel.org
More majordomo info at  
http://vger.kernel.org/majordomo-info.html
Please read the FAQ at  
http://www.tux.org/lkml/