Date: Mon, 07 Aug 2006 10:32:26 +1000
From: Keith Owens <>
Subject: Mismatch between hdaprm and sdparm output
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2006/8/6/153

NEC Versa S5200 laptop with FUJITSU MHV2080B SATA disk.  Kernel
2.6.16.21-0.13-smp (suselinux 10.1) using ata_piix.  hdparm and sdparm
give inconsistent results, which one should I believe?  My main concern
is write caching (XFS filesystem).
hdparm -I
/dev/sda:
ATA device, with non-removable media
	Model Number:       FUJITSU MHV2080BH
	Serial Number:      NW28T62255WF
	Firmware Revision:  00000028
Standards:
	Supported: 7 6 5 4
	Likely used: 7
Configuration:
	Logical		max	current
	cylinders	16383	16383
	heads		16	16
	sectors/track	63	63
	--
	CHS current addressable sectors:   16514064
	LBA    user addressable sectors:  156301488
	LBA48  user addressable sectors:  156301488
	device size with M = 1024*1024:       76319 MBytes
	device size with M = 1000*1000:       80026 MBytes (80 GB)
Capabilities:
	LBA, IORDY(can be disabled)
	Queue depth: 32
	Standby timer values: spec'd by Standard, no device specific minimum
	R/W multiple sector transfer: Max = 16	Current = 16
	Advanced power management level: 128 (0x80)
	Recommended acoustic management value: 254, current value: 254
	DMA: mdma0 mdma1 mdma2 udma0 udma1 udma2 udma3 udma4 *udma5
	     Cycle time: min=120ns recommended=120ns
	PIO: pio0 pio1 pio2 pio3 pio4
	     Cycle time: no flow control=240ns  IORDY flow control=120ns
Commands/features:
	Enabled	Supported:
	   *	READ BUFFER cmd
	   *	WRITE BUFFER cmd
	   *	Host Protected Area feature set
	   *	Look-ahead
		Write cache
	   *	Power Management feature set
		Security Mode feature set
	   *	SMART feature set
	   *	FLUSH CACHE EXT command
	   *	Mandatory FLUSH CACHE command
	   *	Device Configuration Overlay feature set
	   *	48-bit Address feature set
	   *	Automatic Acoustic Management feature set
	   *	SET MAX security extension
	   *	Advanced Power Management feature set
	   *	DOWNLOAD MICROCODE cmd
	   *	General Purpose Logging feature set
	   *	SMART self-test
	   *	SMART error logging
Security:
	Master password revision code = 65534
		supported
	not	enabled
	not	locked
		frozen
	not	expired: security count
	not	supported: enhanced erase
	80min for SECURITY ERASE UNIT.
Checksum: correct
sdparm --get=WCE
    /dev/sda: ATA       FUJITSU MHV2080B  0000
WCE         1
hdparm -A 1/0 can set/clear write cache, sdparm --set=WCE=0/1 always
gets an error:
sdparm --set=WCE=0 /dev/sda
    /dev/sda: ATA       FUJITSU MHV2080B  0000
    change_mode_page: failed setting page: Caching (SBC)
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.kernel.org
More majordomo info at  
http://vger.kernel.org/majordomo-info.html
Please read the FAQ at  
http://www.tux.org/lkml/