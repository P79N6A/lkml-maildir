Date: 23 Jan 2008 12:09:05 +0100
From: Andi Kleen <>
Subject: Re: [PATCH] Remove BKL from sysctl(2)
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2008/1/23/74

Alan Cox <alan@lxorguk.ukuu.org.uk> writes:
> 
> There are cases that updating the corepath name and dumping a core at the
> same moment can result in the wrong thing being exec()'d or a file being
> opened which is a mix of the old and new name and could go anywhere.
> 
> I see two variants on your patch that work
> 
> #1	Replace the lock_kernel with a sysctl_update mutex and fix both
> paths
> #2	Add locking specifically to the corename path
Doesn't that apply to pretty much all proc_dostring users, not just
corename? 
Some of them might be already broken if their readers don't take BKL.
Also possibly some of the proc_dointvec for multiple numbers.
-Andi