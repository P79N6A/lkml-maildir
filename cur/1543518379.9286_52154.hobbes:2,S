Date: Wed, 08 Dec 1999 13:08:20 -0500
From: "Mike Phillips" <>
Subject: Re: 2.3.30 net_init.c Token Ring Bug -Reply
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/1999/12/8/112

> Fix ifconfig.
OK, here are the two patches required to fix ifconfig, ntoolstr.pat is the fix in net-tools (against 1.53). if_arp.pat is the fix for /usr/include/if_arp.h
Mike
--- if_arp.h.orig	Wed Dec  8 13:49:06 1999
+++ if_arp.h	Wed Dec  8 13:47:02 1999
@@ -119,6 +119,8 @@
 #define ARPHRD_FCPL	786		/* Fibrechanel public loop.  */
 #define ARPHRD_FCPFABRIC 787		/* Fibrechanel fabric.  */
 
+#define ARPHRD_IEEE802_TR 800		/* Magic type ident for TR  */
+ 
 /* ARP ioctl request.  */
 struct arpreq
   {--- tr.c.orig	Wed Dec  8 13:41:17 1999
+++ tr.c	Wed Dec  8 13:45:47 1999
@@ -19,7 +19,7 @@
 #include <asm/types.h>
 #include <sys/types.h>
 #include <sys/socket.h>
-#include <net/if_arp.h>
+#include <net/if_arp.h> 
 #include <linux/if_tr.h>
 #include <stdlib.h>
 #include <stdio.h>
@@ -129,7 +129,7 @@
 
 struct hwtype tr_hwtype =
 {
-    "tr", NULL /* "16/4 Mbps Token Ring" */, ARPHRD_IEEE802, TR_ALEN,
+    "tr", NULL /* "16/4 Mbps Token Ring" */, ARPHRD_IEEE802_TR, TR_ALEN,
     pr_tr, pr_str, in_tr, NULL
 };
 