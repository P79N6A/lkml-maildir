Date: Mon, 27 Feb 2006 04:13:19 -0500
From: Shailabh Nagar <>
Subject: Re: [Patch 5/7]  synchronous block I/O delays
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2006/2/27/80

Arjan van de Ven wrote:
>>+static inline void delayacct_blkio(void)
>>+{
>>+	if (unlikely(current->delays && delayacct_on))
>>+		__delayacct_blkio();
>>+}
>> 
>>
>
>why is this unlikely?
> 
>
delayacct_on is expected to be off most of the time, hence the compound is
unlikely too.
> 
>
>>+	u64 blkio_delay;	/* wait for sync block io completion */
>> 
>>
>
>this misses O_SYNC, msync(), and general throttling.
>
Hmm, that it does :-(
>I get the feeling this is being measured at the wrong level
>currently.... since the number of entry points that needs measuring at
>the current level is hardly finite...
> 
>
Will take another look if it can be done elsewhere. Earlier was using 
io_schedule but that isn't
called from everywhere.
--Shailabh
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.kernel.org
More majordomo info at  
http://vger.kernel.org/majordomo-info.html
Please read the FAQ at  
http://www.tux.org/lkml/