Date: Fri, 23 Jan 2009 19:58:39 +0900
From: Magnus Damm <>
Subject: [PATCH 006/011] sh: plat_early_device_setup() for sh4
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2009/1/23/135

From: Magnus Damm <damm@igel.co.jp>
This patch adds sh4 code to register early platform devices
using plat_early_device_setup().
Signed-off-by: Magnus Damm <damm@igel.co.jp>
---
 arch/sh/kernel/cpu/sh4/setup-sh4-202.c |    5 +++++
 arch/sh/kernel/cpu/sh4/setup-sh7750.c  |    5 +++++
 arch/sh/kernel/cpu/sh4/setup-sh7760.c  |    5 +++++
 3 files changed, 15 insertions(+)
--- 0011/arch/sh/kernel/cpu/sh4/setup-sh4-202.c
+++ work/arch/sh/kernel/cpu/sh4/setup-sh4-202.c	2009-01-23 17:01:55.000000000 +0900
@@ -38,6 +38,11 @@ static int __init sh4202_devices_setup(v
 }
 __initcall(sh4202_devices_setup);
 
+void __init plat_early_device_setup(void)
+{
+	early_platform_add_devices(sh4202_devices, ARRAY_SIZE(sh4202_devices));
+}
+
 void __init plat_irq_setup(void)
 {
 	/* do nothing - all IRL interrupts are handled by the board code */
--- 0011/arch/sh/kernel/cpu/sh4/setup-sh7750.c
+++ work/arch/sh/kernel/cpu/sh4/setup-sh7750.c	2009-01-23 17:00:28.000000000 +0900
@@ -95,6 +95,11 @@ static int __init sh7750_devices_setup(v
 }
 __initcall(sh7750_devices_setup);
 
+void __init plat_early_device_setup(void)
+{
+	early_platform_add_devices(sh7750_devices, ARRAY_SIZE(sh7750_devices));
+}
+
 enum {
 	UNUSED = 0,
 
--- 0011/arch/sh/kernel/cpu/sh4/setup-sh7760.c
+++ work/arch/sh/kernel/cpu/sh4/setup-sh7760.c	2009-01-23 17:01:29.000000000 +0900
@@ -207,6 +207,11 @@ static int __init sh7760_devices_setup(v
 }
 __initcall(sh7760_devices_setup);
 
+void __init plat_early_device_setup(void)
+{
+	early_platform_add_devices(sh7760_devices, ARRAY_SIZE(sh7760_devices));
+}
+
 #define INTC_ICR	0xffd00000UL
 #define INTC_ICR_IRLM	(1 << 7)
 