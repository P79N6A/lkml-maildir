Date: Wed, 3 Nov 2004 10:24:43 -0700
From: Bjorn Helgaas <>
Subject: [PATCH] fix HPET time_interpolator registration
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2004/11/3/148

Fixup after mid-air collision between Christoph adding time_interpolator.mask,
and me removing a static time_interpolator struct from hpet.c.  This causes
a boot-time BUG() on boxes that use the hpet driver.
Fixup after mid-air collision between Christoph adding time_interpolator.mask,
and me removing a static time_interpolator struct from hpet.
Signed-off-by: Bjorn Helgaas <bjorn.helgaas@hp.com>
===== drivers/char/hpet.c 1.14 vs edited =====
--- 1.14/drivers/char/hpet.c	2004-11-02 07:40:42 -07:00
+++ edited/drivers/char/hpet.c	2004-11-03 10:05:26 -07:00
@@ -712,6 +712,7 @@
 	ti->addr = &hpetp->hp_hpet->hpet_mc;
 	ti->frequency = hpet_time_div(hpets->hp_period);
 	ti->drift = ti->frequency * HPET_DRIFT / 1000000;
+	ti->mask = 0xffffffffffffffffLL;
 
 	hpetp->hp_interpolator = ti;
 	register_time_interpolator(ti);