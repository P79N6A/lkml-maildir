Date: Sun, 16 Nov 2003 20:29:13 -0500
From:  Valdis.Kletnieks@vt ...
Subject: Re: Reading libs fails through NFS
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2003/11/16/94

On Mon, 17 Nov 2003 01:45:39 +0100, "J.A. Magallon" said:
>     fd = open("/lib/libnss_files.so.2", O_RDONLY);
> The node boots via PXE, with a version of libnss_files.so.2 on the /lib present
> in the initrd, which is replaced by the mounted one.
Just a shot in the dark, but could there be a bug in the NFS code where it's
getting upset that there's cached pages of the file in memory, but the file
that the cached page is from isn't from the file that NFS can see? (note that
this is possibly *different* than a stale NFS handle when a file is unlinked
and then recreated - here chasing the origin of the page doesn't point at
the NFS mount, but at the initrd mount.
Yes, when you mount over a directory, the previous contents are supposed to
become invisible.  I wonder if there's a bug with that if a file is read and
pages cached 'sufficiently early' in the boot process (i.e. before the
real root gets mounted over the initrd root..)
[unhandled content-type:application/pgp-signature]