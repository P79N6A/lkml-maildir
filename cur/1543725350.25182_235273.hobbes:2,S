Date: Tue, 20 Jul 2004 07:04:49 -0500
From: Steve Lord <>
Subject: Re: 4K stack kernel get Oops in Filesystem stress test
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2004/7/20/39

Cahya Wirawan wrote:
> Hi,
> I use vanila kernel 2.6.7 and 2.6.8-rc1 with 4K stack enabled,
> but if I execute the filesystem stress test from ltp.sf.net (linux test
> project) the machine always crash immediately. Or it will crash also after few
> hours if I do kernel compile test repeatedly. But if I use 8K stack,
> my server survive this filesystem stress test.
> Also my notebook get oops if I used 4k stack in kernel , but it crashed 
> after few minutes running the filesystem stress test (not immediately).
> My configuration is
> compaq proliant ML530/G2 , 2 processor intel 2.4Ghz, 1GB ram ,
> LVM1 volume with XFS filesystem.
> and here is the Oops message:
Don't use 4K stacks and XFS. What you hit here is a path where the
filesystem is getting full and it needs to free some reserved space
by flushing cached data which is using reserved extents. Reserved
extents do not yet have an on disk address and they include a
reservation for the worst case metadata usage. Flushing them will
get you room back.
As you can see, it is a pretty deep call stack, most of XFS is going
to work just fine with a 4K stack, but there are end cases like
this one which will just not fit.
Steve
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.kernel.org
More majordomo info at  
http://vger.kernel.org/majordomo-info.html
Please read the FAQ at  
http://www.tux.org/lkml/