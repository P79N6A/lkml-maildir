Date: Tue, 31 Jul 2007 17:35:36 +0800
From: "rae l" <>
Subject: Re: [PATCH] fs/gfs2: mark struct *_operations const
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2007/7/31/122

On 7/31/07, Steven Whitehouse <swhiteho@redhat.com> wrote:
> Hi,
>
> On Tue, 2007-07-31 at 13:46 +0800, Denis Cheng wrote:
> > these struct *_operations are all method tables, thus should be const.
> >
> > Signed-off-by: Denis Cheng <crquan@gmail.com>
> > ---
> >  fs/gfs2/eaops.c        |    8 ++++----
> >  fs/gfs2/eaops.h        |    4 ++--
> >  fs/gfs2/glock.c        |    2 +-
> >  fs/gfs2/ops_dentry.c   |    3 +--
> >  fs/gfs2/ops_dentry.h   |    2 +-
> >  fs/gfs2/ops_vm.c       |    4 ++--
> >  fs/gfs2/ops_vm.h       |    4 ++--
> >  include/linux/dcache.h |    2 +-
> >  include/linux/mm.h     |    2 +-
> >  9 files changed, 15 insertions(+), 16 deletions(-)
> >
>
> In general this looks good, however where you have made changes in the
> two include files dcache.h and mm.h be aware that other filesystems also
> use these and I suspect there are more places to change than just gfs2.
> Can you do a test build with all filesystems enabled to ensure that
> you've got all the places which can then be marked const? OCFS2, to take
> one example, has a vm_operations_struct which would need to be updated
> on that basis at least.
>
> In fact if you can break this up into a patch which affects only gfs2
> (which I can apply right away) and a patch which affects the core, plus
> updates for the various filesytems that would probably make things
> easier from the merging point of view. Since the latter would affect
> multiple filesystems, it would make sense to push it through -mm rather
> than for me to put it in my git tree,
>
> Steve.
>
I think so. But I've tested it under x86(pentium4) with allyesconfig
and allmodconfig, the compilication process of the kernel looked very
quiet.
$ make mrproper
$ make allyesconfig
$ make fs/
$ make mrproper
$ make allmodconfig
$ make fs/
and the ocfs2 didn't complain.
However, I'll split it into two patches and resend them later.
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.kernel.org
More majordomo info at  
http://vger.kernel.org/majordomo-info.html
Please read the FAQ at  
http://www.tux.org/lkml/