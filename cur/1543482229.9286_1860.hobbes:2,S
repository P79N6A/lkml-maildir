Date: Tue, 26 Jan 1999 15:43:27 +1100
From: Richard Gooch <>
Subject: Re: test of devfs patch v88 [was Re: devfs patch v84 for
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/1999/1/25/237

Roderich Schupp writes:
> 
> Heinz Mauelshagen <mauelsha@ez-darmstadt.telekom.de> said:
> > But i had another problem i didn't see before:
> >  - i autoload cdrom and sr_mod modules trough kmod/modprobe
> >  - modprobe hangs during a "mount -av -t nonfs,nproc" which is called
> >    from a multiuser startup script while trying to autoload both
> >    modules; this doesn't happen without devfs!?
> 
> Yes, I had the same problem, but haven't had time to track it further:
> 
> - isofs and SCSI cdrom as modules
> - /etc/fstab has an entry for my cdrom, but it's marked "noauto"
> - system hangs during "mount -av -t nonfs,noproc"
> 
> Using the debug options for devfs didn't reveal anything obvious
> (but I can supply you with logs). The breaker seems to be "mount"
> doing a readlink(/dev/sr/c0b0t5u0).
How about hacking your boot scripts to do a readlink on the device
before mount starts and seeing if that also hangs?
> BTW Richard: Your sample modules.conf file should put
> 
> alias           /dev/fd         off
> alias           /dev/stdin      off
> alias           /dev/stdout     off
> alias           /dev/stderr     off
> 
> _below_ 
> 
> alias           /dev/st*        st
> alias           /dev/fd*        floppy
> 
> because modprobe scans the list from bottom to top (!) and 
> hence will load the SCSI tape module when devfs asks for "dev/stdin"!
> Actually, one could view this as a bug in modprobe or at least
> unexpected behaviour.
ERK! Gag me with a spoon. OK, I've worked around this misfeature.
Heinz: can you also do this and see if it helps?
				Regards,
					Richard....
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.rutgers.edu
Please read the FAQ at 
http://www.tux.org/lkml/