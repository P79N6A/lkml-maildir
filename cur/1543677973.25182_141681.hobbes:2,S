Date: 19 Jun 2003 01:04:20 -0700
From: "H. Peter Anvin" <>
Subject: Re: How do I make this thing stop laging?  Reboot?  Sounds like  Windows!
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2003/6/19/36

Followup to:  <3EF0214A.3000103@aitel.hist.no>
By author:    Helge Hafting <helgehaf@aitel.hist.no>
In newsgroup: linux.dev.kernel
>
> rmoser wrote:
> [...]
> > Ten minutes later I get the brains to run top.  It seems I have about
> > 50 MB in swap, and 54 MB free memory.  So I wait ten minutes more.
> > 
> > No change.
> > 
> > % swapoff -a; swapon -a
> > 
> > Fixes all my problems.
> > 
> > Now this long story shows something:  The kernel appears to be unable
> > to intelligently pull swap back into RAM.  What gives?
> > 
> Because the problem _is_ unsolvable.  You want the kernel
> to go "oh, lots of free memory showed up, lets pull
> everything in from swap just in case someone might need it."
> 
> 
> That would solve _your_ problem.  But lots of other people
> would get another problem - much _more_ swapping:
> 
> Whenever they quit one big app to run another big one,
> everything is pulled in from swap before the next
> big app start.  Then it starts, and push everything out
> again.  The current system lets you quit one app,
> the stuff in swap remains there until someone actually use it,
> and lots of free memory remain in case it is needed.
> 
> The "intelligent" thing is to leave stuff in swap until
> some app needs it, and pull it in then.  Perhaps with
> some read-ahead/clustering to minimize io load.
> 
This is why you pull things in from swap, but keep tabs on the fact
that it's clean against swap and therefore can be culled at will if
you don't need it.  In other words -- it's present *both* in swap and
RAM.
	-hpa
-- 
<hpa@transmeta.com> at work, <hpa@zytor.com> in private!
"Unix gives you enough rope to shoot yourself in the foot."
Architectures needed: ia64 m68k mips64 ppc ppc64 s390 s390x sh v850 x86-64
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.kernel.org
More majordomo info at  
http://vger.kernel.org/majordomo-info.html
Please read the FAQ at  
http://www.tux.org/lkml/