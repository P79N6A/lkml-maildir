Date: Sat, 3 May 2008 15:14:24 +0200
From: Bartlomiej Zolnierkiewicz <>
Subject: [PATCH 2/3] ide: set REQ_NOMERGE request flag in ide_do_drive_cmd()
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2008/5/3/90

This is a preparation for converting IDE to use blk_execute_rq().
There should be no functional changes caused by this patch.
Cc: FUJITA Tomonori <fujita.tomonori@lab.ntt.co.jp>
Cc: Borislav Petkov <petkovbb@gmail.com>
Cc: Jens Axboe <jens.axboe@oracle.com>
Signed-off-by: Bartlomiej Zolnierkiewicz <bzolnier@gmail.com>
---
 drivers/ide/ide-io.c |    2 ++
 1 file changed, 2 insertions(+)
Index: b/drivers/ide/ide-io.c
===================================================================
--- a/drivers/ide/ide-io.c
+++ b/drivers/ide/ide-io.c
@@ -1603,6 +1603,8 @@ int ide_do_drive_cmd (ide_drive_t *drive
 	if (action == ide_preempt || action == ide_head_wait)
 		where = ELEVATOR_INSERT_FRONT;
 
+	rq->cmd_flags |= REQ_NOMERGE;
+
 	spin_lock_irqsave(&ide_lock, flags);
 	if (action == ide_preempt)
 		hwgroup->rq = NULL;