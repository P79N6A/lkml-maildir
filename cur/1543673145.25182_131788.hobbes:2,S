Date: 11 May 2003 13:04:59 -0600
From: (Eric W. Biederman)
Subject: Re: [PATCH] Use correct x86 reboot vector
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2003/5/11/146

Alan Cox <alan@lxorguk.ukuu.org.uk> writes:
> On Sul, 2003-05-11 at 19:01, Eric W. Biederman wrote:
> > > At least some SMP boxes freak if you do a poweroff request on CPU != 0
> > 
> > As per the MP spec.  The system should reboot on the bootstrap cpu.
> > smp_processor_id() == 0 on x86.  apicid??
> 
> APM now makes its calls on CPU#0 which was the trigger for these
> problems
I have a couple of issues with the current state of affairs.
1) We should always do this to be safe.
2) Reboot has this issue as well.
3) The way APM does it overrides the kernel command line option,
   and apm_power_off forces the cpu twice.
4) We have this implemented in 3 different ways in 3 different places.
5) machine_reboot needs this to do this in interrupt context for
   Sys-req-B and certain cases of panic and that is not currently handled.
On a related note do you know why machine_halt and machine_power_off return?
After shutting everything down that seems very much like the wrong thing
to do.
Eric
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.kernel.org
More majordomo info at  
http://vger.kernel.org/majordomo-info.html
Please read the FAQ at  
http://www.tux.org/lkml/