Date: Tue, 11 Nov 2008 22:34:04 +0100
From: "stephane eranian" <>
Subject: Re: [PATCH] perfmon2 add support for ppc970 processors
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2008/11/11/363

Chris,
Patch applied to both perfmon2 and perfmon3 trees.
Thanks.
On Fri, Nov 7, 2008 at 12:59 AM,  <arges@linux.vnet.ibm.com> wrote:
> From: Chris J Arges <arges@linux.vnet.ibm.com>
>
> Allows ppc970(fx,mp,gx) to use the perfmon_power4 module.
> ---
>  arch/powerpc/perfmon/perfmon.c        |    2 +-
>  arch/powerpc/perfmon/perfmon_power4.c |    8 +++++++-
>  2 files changed, 8 insertions(+), 2 deletions(-)
>
> diff --git a/arch/powerpc/perfmon/perfmon.c b/arch/powerpc/perfmon/perfmon.c
> index a14a1e3..f1d93ee 100644
> --- a/arch/powerpc/perfmon/perfmon.c
> +++ b/arch/powerpc/perfmon/perfmon.c
> @@ -284,7 +284,7 @@ char *pfm_arch_get_pmu_module_name(void)
>        case PV_970:
>        case PV_970FX:
>        case PV_970MP:
> -               return "perfmon_ppc970";
> +               return "perfmon_power4";
>        case PV_BE:
>                return "perfmon_cell";
>        }
> diff --git a/arch/powerpc/perfmon/perfmon_power4.c b/arch/powerpc/perfmon/perfmon_power4.c
> index eba9e8c..b262de3 100644
> --- a/arch/powerpc/perfmon/perfmon_power4.c
> +++ b/arch/powerpc/perfmon/perfmon_power4.c
> @@ -57,8 +57,15 @@ static int pfm_power4_probe_pmu(void)
>        unsigned long pvr = mfspr(SPRN_PVR);
>        int ver = PVR_VER(pvr);
>
> -       if ((ver == PV_POWER4) || (ver == PV_POWER4p))
> +       switch (ver) {
> +       case PV_POWER4:
> +       case PV_POWER4p:
> +       case PV_970:
> +       case PV_970FX:
> +       case PV_970MP:
> +       case PV_970GX:
>                return 0;
> +       }
>
>        return -1;
>  }
> --
> 1.5.4.5
>
> Signed-off-by: Chris J Arges <arges@linux.vnet.ibm.com>
>
>