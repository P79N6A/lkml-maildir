Date: Wed, 12 Dec 2007 13:07:47 +1100
From: Nigel Cunningham <>
Subject: Re: [RFT] Port 0x80 I/O speed
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2007/12/11/374

Rene Herman wrote:
> On 12-12-07 00:55, Nigel Cunningham wrote:
> 
>> (AMD 1.8GHz Turion, running at 800MHz. ATI RS480 - Mitac 8350 mobo)
>>
>> nigel@home:~/Downloads$ gcc port80.c -o port80
>> nigel@home:~/Downloads$ sudo ./port80
>> cycles: out 1235, in 1207
> 
> Looking good.
> 
>> nigel@home:~/Downloads$ gcc -O2 port80.c -o port80
>> nigel@home:~/Downloads$ sudo ./port80
>> cycles: out 1844674407370794, in 1844674407369408
> 
> Obviously not. I suppose this changes with -m32 on the GCC command line?
> (sorry for missing that, I have no 64-bit machines).
Yes, it does:
nigel@home:~/Downloads$ gcc -m32 -o port80 port80.c
nigel@home:~/Downloads$ sudo ./port80
cycles: out 1231, in 1208
nigel@home:~/Downloads$ sudo ./port80
cycles: out 1233, in 1210
Incidentally:
nigel@home:~/Downloads$ processor_speed
(A little script I made because my lappy does a solid lock every now and
then that seems to be cpu-freq related - locking it to one frequency
makes the lock far less common).
Speed is now 1800000.
nigel@home:~/Downloads$ sudo ./port80
cycles: out 2472, in 2505
nigel@home:~/Downloads$ sudo ./port80
cycles: out 2489, in 2515
nigel@home:~/Downloads$ sudo ./port80
cycles: out 2481, in 2503
nigel@home:~/Downloads$ sudo ./port80
cycles: out 2476, in 2507
So the same effect Maxim reported is seen here.
Regards,
Nigel