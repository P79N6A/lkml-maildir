Date: Thu, 14 Feb 2008 13:00:03 -0800
From: Arjan van de Ven <>
Subject: Re: [x86.git#mm] stack protector fixes, vmsplice exploit
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2008/2/14/377

On Thu, 14 Feb 2008 21:25:35 +0100
Ingo Molnar <mingo@elte.hu> wrote:
> 
> * pageexec@freemail.hu <pageexec@freemail.hu> wrote:
> 
> > really, the best defense is to reduce the useful lifetime of any 
> > leaked canary, and you can't get better than syscall granularity 
> > without disproportional effort and impact elsewhere (and i'm sure
> > some would find even this disproportional ;).
> 
> hm, i think per syscall canaries are really expensive.
it's not that bad. Assuming you use a PNR that you re-seed periodically,
it's 
* go to the next random number with PNR
* write to PDA and task struct
give or take 10 cycles total if you squeeze it hard, 20 if you don't.