Date: Sun, 21 Sep 2003 11:04:07 +0300
From: Muli Ben-Yehuda <>
Subject: [PATCH] fix compile warning with version string in sg.c
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2003/9/21/16

When compiling without CONFIG_SCSI_PROC_FS, I get a warning:
drivers/scsi/sg.c:21: warning: `sg_version_str' defined but not used
This patch fixes it, by definining sg_version_str only if
CONFIG_SCSI_PROC_FS is set. It also turns sg_version_str from char* to
char[], to move it from 'data' to 'rodata'. 
diff --exclude-from /home/muli/p/dontdiff -Naur ../linux-2.5/drivers/scsi/sg.c 2.6.0-t5-Werror/drivers/scsi/sg.c
--- ../linux-2.5/drivers/scsi/sg.c	Sat Sep  6 00:19:59 2003
+++ 2.6.0-t5-Werror/drivers/scsi/sg.c	Sun Sep 21 10:29:43 2003
@@ -18,7 +18,11 @@
  *
  */
 #include <linux/config.h>
-static char *sg_version_str = "3.5.29 [20030529]";
+
+#ifdef CONFIG_SCSI_PROC_FS
+const static char sg_version_str[] = "3.5.29 [20030529]";
+#endif /* CONFIG_SCSI_PROC_FS */ 
+
 static int sg_version_num = 30529;	/* 2 digits for each component */
 /*
  *  D. P. Gilbert (dgilbert@interlog.com, dougg@triode.net.au), notes:
-- 
Muli Ben-Yehuda
http://www.mulix.org
[unhandled content-type:application/pgp-signature]