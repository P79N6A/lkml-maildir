Date: 03 Jan 2002 01:44:21 -0700
From: (Eric W. Biederman)
Subject: Re: ISA slot detection on PCI systems?
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2002/1/3/42

"Eric S. Raymond" <esr@thyrsus.com> writes:
> Alan Cox <alan@lxorguk.ukuu.org.uk>:
> > You can make an educated guess. However it is at best an educated guess.
> > The DMI tables will tell you what PCI and ISA slots are present (but
>   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
> > tend to be unreliable on older boxes).  You can also look for an ISA bridge
> > in lspci as a second source of information.
> 
> That sounds like it might be what I'm after.  My goal is to be able to probe 
> the machine and set ISA_CARDS based on the probe.  What's a DMI table and
> how can I query it for the presence of ISA slots?
> 
> What I want to do with this is make ISA-card questions invisible on modern
> PCI-only motherboards.
Auto configuration only works for some variety of Plug-and-Play hardware.
By that I mean that between a combination of the firmware and the hardware
you can detect what is there.  Plug-and-Play does not work reliably on
ISA.  Since PCI has been Plug-and-Play from the start it works well.
I would suggest you assume that for any hardware that isn't present
you assume it isn't there.
For those things where auto detection is not reliable have a menu that
let's you manually select the which pieces you actually want to worry
about sounds reasonable.
Say:
   Unprobeable hardware support
     ISA cards
     i2c devices
     lpc devices
     etc
     etc.
With the kernel moving to support more and more hardware and things
like lm-sensors showing up.  Even the absence of slots does not mean
that there aren't pieces that software can not get adequate
information to setup correctly.
As for DMI and it's ilk.  The only sane thing I can see to do is have
something that will report the motherboard id. (DMI does seem to do
that fairly reiliably, as do MP tables).  And then you build a
database based on motherboard id upon the capabilities of the various
motherboards. 
Looking up the datasheets from the various manufacturers should not be
to hard of a job..  Plus it is a technique that can work on things
other than stock PC's.
Eric
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.kernel.org
More majordomo info at  
http://vger.kernel.org/majordomo-info.html
Please read the FAQ at  
http://www.tux.org/lkml/