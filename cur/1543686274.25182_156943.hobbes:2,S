Date: 12 Aug 2003 14:13:34 -0700
From: john stultz <>
Subject: Re: PCI parallel card causes erratic timekeeping? (2.4.21)
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2003/8/12/227

On Sun, 2003-08-10 at 00:26, Ryan Underwood wrote:
> In the ISA slot, up until recently, we had a dual parallel port card
> that was attached to the network printers.  However, the printers and
> the card were fried in a storm recently; luckily, the server survived.
> We replaced the card with a dual PCI parallel port card (Netmos
> NM9715CV) and the printers are now working fine.
> 
> However, a new problem emerged.  The software clock of the system is
> crazy!  Sometimes it is very fast, other times very slow.  NTP
> constantly loses synchronization, and since this machine is also a
> Kerberos KDC, Kerberos tickets are flakey. :(  This problem exists
> independently of whether a driver is loaded for the card or not; if it
> is in the system at all, the clock runs screwy.  If I remove the card,
> the clock is back to normal as far as I can tell.
[snip]
> Can simply inserting a card generally make a system clock act screwy
> like this?  Should I try to find a different card?
Sounds like the card is blocking the timer interrupt from being handled.
This would cause a loss in time as well as time inconsistencies. I'm a
bit curious about time running too fast, though. It could be NTP trying
to compensate for the slowness and then overcompensates if the card
stops misbehaving. Its also possible calibrate_tsc is being confused by
the card's funkyness. It would be interesting to see what Bogomips is
being reported as the system acts up.
Sounds like a bad card to me. 
thanks
-john
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.kernel.org
More majordomo info at  
http://vger.kernel.org/majordomo-info.html
Please read the FAQ at  
http://www.tux.org/lkml/