Date: Tue, 12 Oct 2004 15:23:43 -0700
From: Pete Zaitcev <>
Subject: Re: [linux-usb-devel] Re: [HID] Fix hiddev devfs oops
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2004/10/12/300

On Wed, 13 Oct 2004 07:21:54 +1000
Herbert Xu <herbert@gondor.apana.org.au> wrote:
> > > Marcelo, the same fix is needed in 2.4 as well.
> > 
> > Would be nice to have a version which applies to 2.4 also.
> 
> I did include a 2.4 patch in that email :)
Herbert, I'm sorry for the wait. Marcelo asked me to take care of this,
but I kept postponing it because I wanted to look closer, and this and
that... It looks entirely reasonable and my hid devices continue to work,
but I haven't tested hiddev (UPS or something ?).
-- Pete
diff -urp -X dontdiff linux-2.4.28-pre3/drivers/usb/hid-core.c linux-2.4.28-pre3-usb/drivers/usb/hid-core.c
--- linux-2.4.28-pre3/drivers/usb/hid-core.c	2004-09-12 14:24:09.000000000 -0700
+++ linux-2.4.28-pre3-usb/drivers/usb/hid-core.c	2004-10-12 15:15:40.000000000 -0700
@@ -1459,8 +1459,8 @@ static int __init hid_init(void)
 
 static void __exit hid_exit(void)
 {
-	hiddev_exit();
 	usb_deregister(&hid_driver);
+	hiddev_exit();
 }
 
 module_init(hid_init);
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.kernel.org
More majordomo info at  
http://vger.kernel.org/majordomo-info.html
Please read the FAQ at  
http://www.tux.org/lkml/