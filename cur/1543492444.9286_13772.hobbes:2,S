Date: Fri, 09 Apr 1999 16:36:45 -0700
From: "David A. Ranch" <>
Subject: AMD PCSCSI (AM53c974) driver bug in 2.2.x in SMP but not  single CPU mode
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/1999/4/9/159

Hello kernel gurus..
I hope this post gets on the kernel list since I'm not subscribed.  
Because of this, please CC: any replies to dranch@trinnet.net 
--
Anyway.. 
I have confirmed a problem with the AMD PC-SCSI driver hanging in 
the 2.2.x kernels when compiled in SMP mode but -NOT- in non-SMP mode.  
It should also be noted that a 2.0.36 kernel with SMP support works 
fine.
This is very reproducable on every boot.
--
Hardware:
	- Hp Vectra XU 5/90C	- Dual Pentium 90 (hehehe)
		+ 48MB RAM
		+ Imagine 128 PCI video
		+ integrated AMD PCscsi controller
		+ integrated AMD PCnet32 controller
		+ newest BIOS installed
	- Linux 2.2.5ac6 (tried main 2.2.5 and other 2.2.5 
		AC patches)
	- Redhat 5.2 with all the recent patches
Error:
	In 2.2.5AC6 kernel with SMP enabled, the box initially 
	boots, sees both processors, network, ide, blah blah, 
	etc and just after it says:
		"Freeing unused kernel memory: 44k freed"
	The SCSI LED locks solid and I periodically get:
	--------------------------------------------------------------
	SCSI host 0 abort (PID 44) timed out - resetting
	SCSI bus is being reset for Host 0 Channel 0
	AM53C974_RESET CALLED
	AM53C974 registry dump:
	IO BASE: 0x1ff00 CTCREG: 0x120000
	CMDREG: 0x42 STATREG: 0x00 ISREF:0xC0
	CFIREG: 0x07 CNTLREG1: 0x57 CNTLREG2: 0x40 CNTLREG3: 0x18 CNTLREG4: 0x44
	DMACMP: 0xC3 DMASTC: 0x0400; DMASPA 0x019C00
	DMAWBC: 0x000 DMAWAC: 0x19000 DMASTATUS: 0x00
	--------------------------------------------------------------
Any thoughts?  This seems like it is a SMP specific issue.  If needed, I can
try a recommended 2.1.x kernel and since this is a play box, I can help
test new patches, etc.
Thanks for the help!
--David
.----------------------------------------------------------------------------.
|  David A. Ranch - Linux/Networking/PC hardware         dranch@trinnet.net  |
!----                                                                    ----!
`----- For more detailed info, see 
http://www.ecst.csuchico.edu/~dranch
 -----'
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.rutgers.edu
Please read the FAQ at 
http://www.tux.org/lkml/