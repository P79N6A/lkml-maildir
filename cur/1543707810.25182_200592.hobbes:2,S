Date: Sat, 21 Feb 2004 10:02:38 +1100
From: Benjamin Herrenschmidt <>
Subject: Re: Double fb_console_init call during do_initcalls
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2004/2/20/261

> I seen the report and begain to create a patch. The module_init fix is 
> easy. Just place module_init and module_exit under #ifdef MODULE. I 
> realize alot of fbdev drivers do this wrong. I will make patches by the 
> end of the day. As for the fbmem.c call on fb_console_init. Well that is 
> tricker to deal with. I will have to figure out a way.
You can also use the fb_registered_client static I added and rename
it to fbcon_initialized ;) Dunno if we actually _need_ the second call
to take_over_console at this point, so i left it called twice, but
I needed the static to protect against registering the notifier twice
(That was what was causing the notifier list to get corrupted and
mode changes to lockup in early implementations)
Ben.
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.kernel.org
More majordomo info at  
http://vger.kernel.org/majordomo-info.html
Please read the FAQ at  
http://www.tux.org/lkml/