Date: Tue, 29 Nov 2005 23:23:30 -0500
From: Dave Jones <>
Subject: printk levels for spinlock debug.
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2005/11/29/283

Signed-off-by: Dave Jones <davej@redhat.com>
--- vanilla/lib/spinlock_debug.c~	2005-11-29 23:21:14.000000000 -0500
+++ vanilla/lib/spinlock_debug.c	2005-11-29 23:21:49.000000000 -0500
@@ -19,9 +19,9 @@ static void spin_bug(spinlock_t *lock, c
 	if (xchg(&print_once, 0)) {
 		if (lock->owner && lock->owner != SPINLOCK_OWNER_INIT)
 			owner = lock->owner;
-		printk("BUG: spinlock %s on CPU#%d, %s/%d\n",
+		printk(KERN_EMERG "BUG: spinlock %s on CPU#%d, %s/%d\n",
 			msg, smp_processor_id(), current->comm, current->pid);
-		printk(" lock: %p, .magic: %08x, .owner: %s/%d, .owner_cpu: %d\n",
+		printk(KERN_EMERG " lock: %p, .magic: %08x, .owner: %s/%d, .owner_cpu: %d\n",
 			lock, lock->magic,
 			owner ? owner->comm : "<none>",
 			owner ? owner->pid : -1,
@@ -77,7 +77,7 @@ static void __spin_lock_debug(spinlock_t
 		/* lockup suspected: */
 		if (print_once) {
 			print_once = 0;
-			printk("BUG: spinlock lockup on CPU#%d, %s/%d, %p\n",
+			printk(KERN_EMERG "BUG: spinlock lockup on CPU#%d, %s/%d, %p\n",
 				smp_processor_id(), current->comm, current->pid,
 					lock);
 			dump_stack();
@@ -119,7 +119,7 @@ static void rwlock_bug(rwlock_t *lock, c
 	static long print_once = 1;
 
 	if (xchg(&print_once, 0)) {
-		printk("BUG: rwlock %s on CPU#%d, %s/%d, %p\n", msg,
+		printk(KERN_EMERG "BUG: rwlock %s on CPU#%d, %s/%d, %p\n", msg,
 			smp_processor_id(), current->comm, current->pid, lock);
 		dump_stack();
 #ifdef CONFIG_SMP
@@ -147,7 +147,7 @@ static void __read_lock_debug(rwlock_t *
 		/* lockup suspected: */
 		if (print_once) {
 			print_once = 0;
-			printk("BUG: read-lock lockup on CPU#%d, %s/%d, %p\n",
+			printk(KERN_EMERG "BUG: read-lock lockup on CPU#%d, %s/%d, %p\n",
 				smp_processor_id(), current->comm, current->pid,
 					lock);
 			dump_stack();
@@ -219,7 +219,7 @@ static void __write_lock_debug(rwlock_t 
 		/* lockup suspected: */
 		if (print_once) {
 			print_once = 0;
-			printk("BUG: write-lock lockup on CPU#%d, %s/%d, %p\n",
+			printk(KERN_EMERG "BUG: write-lock lockup on CPU#%d, %s/%d, %p\n",
 				smp_processor_id(), current->comm, current->pid,
 					lock);
 			dump_stack();
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.kernel.org
More majordomo info at  
http://vger.kernel.org/majordomo-info.html
Please read the FAQ at  
http://www.tux.org/lkml/