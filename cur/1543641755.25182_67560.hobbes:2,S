Date: 01 Sep 2002 21:18:30 +0200
From: Luca Barbieri <>
Subject: [PATCH] Re: 2.5.33 PNPBIOS does not compile
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2002/9/1/9

On Sun, 2002-09-01 at 09:14, Nicholas Miell wrote:
> pnpbios_core.c: In function `call_pnp_bios':
> pnpbios_core.c:167: invalid lvalue in unary `&'
> pnpbios_core.c:167: invalid lvalue in unary `&'
> pnpbios_core.c:169: invalid lvalue in unary `&'
> pnpbios_core.c:169: invalid lvalue in unary `&'
> pnpbios_core.c: In function `pnpbios_init':
> pnpbios_core.c:1276: invalid lvalue in unary `&'
> pnpbios_core.c:1276: invalid lvalue in unary `&'
> pnpbios_core.c:1277: invalid lvalue in unary `&'
> pnpbios_core.c:1277: invalid lvalue in unary `&'
> pnpbios_core.c:1278: invalid lvalue in unary `&'
> pnpbios_core.c:1278: invalid lvalue in unary `&'
> make[2]: *** [pnpbios_core.o] Error 1
> make[2]: Target `first_rule' not remade because of errors.
> make[1]: *** [pnp] Error 2
> 
> ... which is the result of the expansion of the Q_SET_SEL and Q2_SET_SEL
> macros. 
Yes, this should fix the problem.
diff --exclude-from=/home/ldb/src/linux-exclude -urNdp linux-2.5.32/drivers/pnp/pnpbios_core.c linux-2.5.32_pnpbelow/drivers/pnp/pnpbios_core.c
--- linux-2.5.32/drivers/pnp/pnpbios_core.c	2002-08-27 21:26:32.000000000 +0200
+++ linux-2.5.32_pnpbelow/drivers/pnp/pnpbios_core.c	2002-08-31 18:38:38.000000000 +0200
@@ -127,11 +127,11 @@ __asm__(
 
 #define Q_SET_SEL(cpu, selname, address, size) \
 set_base(cpu_gdt_table[cpu][(selname) >> 3], __va((u32)(address))); \
-set_limit(&cpu_gdt_table[cpu][(selname) >> 3], size)
+set_limit(cpu_gdt_table[cpu][(selname) >> 3], size)
 
 #define Q2_SET_SEL(cpu, selname, address, size) \
 set_base(cpu_gdt_table[cpu][(selname) >> 3], (u32)(address)); \
-set_limit(&cpu_gdt_table[cpu][(selname) >> 3], size)
+set_limit(cpu_gdt_table[cpu][(selname) >> 3], size)
 
 /*
  * At some point we want to use this stack frame pointer to unwind
[unhandled content-type:application/pgp-signature]