Date: Thu, 12 Oct 2006 14:30:24 +0900
From: Akinobu Mita <>
Subject: [PATCH] sch_htb: use rb_first() cleanup
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2006/10/12/14

Use rb_first() to get first entry in rb tree.
Cc: "David S. Miller" <davem@davemloft.net>
Signed-off-by: Akinbou Mita <akinobu.mita@gmail.com>
 net/sched/sch_htb.c |    5 ++---
 1 file changed, 2 insertions(+), 3 deletions(-)
Index: work-fault-inject/net/sched/sch_htb.c
===================================================================
--- work-fault-inject.orig/net/sched/sch_htb.c
+++ work-fault-inject/net/sched/sch_htb.c
@@ -786,11 +786,10 @@ static long htb_do_events(struct htb_sch
 	for (i = 0; i < 500; i++) {
 		struct htb_class *cl;
 		long diff;
-		struct rb_node *p = q->wait_pq[level].rb_node;
+		struct rb_node *p = rb_first(&q->wait_pq[level]);
+
 		if (!p)
 			return 0;
-		while (p->rb_left)
-			p = p->rb_left;
 
 		cl = rb_entry(p, struct htb_class, pq_node);
 		if (time_after(cl->pq_key, q->jiffies)) {
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.kernel.org
More majordomo info at  
http://vger.kernel.org/majordomo-info.html
Please read the FAQ at  
http://www.tux.org/lkml/