Date: Mon, 21 Apr 2003 18:39:35 +0200
From: Christoph Hellwig <>
Subject: Re: 2.5.68-bk1 renames IDE disks, /dev/hda is directory
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2003/4/21/107

On Mon, Apr 21, 2003 at 12:08:11PM -0400, Pavel Roskin wrote:
> Hello!
> 
> After upgrading from 2.5.67-bk9 to 2.5.68-bk1 I have found that the devfs
> names for IDE disks have changed.  Instead of the traditional
> 2.4-compatible /dev/ide/host0/bus0/target0/lun0/part1, /dev/hda1 has now
> become /dev/hda/disc0/part1.
> 
> What's really weird is that /dev/hda is now a directory.  That's going to
> break a lot of software!
Hey, that wasn't intentation.  In fact it's a stupid brown-paperbag bug
only hidden by mount-by-label :)
Here's the fix:
--- 1.1/fs/partitions/devfs.c	Sat Apr 19 20:57:36 2003
+++ edited/fs/partitions/devfs.c	Mon Apr 21 17:11:33 2003
@@ -81,7 +81,7 @@
 {
 	char dirname[64], symlink[16];
 
-	if (disk->devfs_name[0] != '\0')
+	if (disk->devfs_name[0] == '\0')
 		sprintf(disk->devfs_name, "%s/disc%d", disk->disk_name,
 				disk->first_minor >> disk->minor_shift);
 
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.kernel.org
More majordomo info at  
http://vger.kernel.org/majordomo-info.html
Please read the FAQ at  
http://www.tux.org/lkml/