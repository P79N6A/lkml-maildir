Date: Thu, 26 Jul 2007 18:30:53 +0200
From: Borislav Petkov <>
Subject: Re: 2.6.23-rc1: no setup signature found...
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2007/7/26/242

On Thu, Jul 26, 2007 at 08:19:08AM -0700, H. Peter Anvin wrote:
> Xudong Guan wrote:
> > On 13:26(+0200) Tue 24 Jul, Borislav Petkov wrote:
> >>    2.6.23-rc1 won't boot on my Asus M6N laptop and the last thing it shows after loading
> >> grub is "No setup signature found...," which, imho, comes from
> >> arch/i386/boot/header.S. I tried printing out the value of setup_sig like so
> > 
> > I hitted the same error message with v2.6.23-rc1-171-ge4903fb.
> > No problem with v2.6.21-3770-g01e73be.
> > Seems there has been some cleanup of the i386/boot code.
> > Anyone can give a quick clue, or should I do a bisect?
I just finished bisecting between v2.6.22..v2.6.23-rc1 (13 kernels compiled, whew...) and Peter you are
right, here's the evidoer:
4fd06960f120e02e9abc802a09f9511c400042a5 is first bad commit
commit 4fd06960f120e02e9abc802a09f9511c400042a5
Author: H. Peter Anvin <hpa@zytor.com>
Date:   Wed Jul 11 12:18:56 2007 -0700
    Use the new x86 setup code for i386
    This patch hooks the new x86 setup code into the Makefile machinery.  It
    also adapts boot/tools/build.c to a two-file (as opposed to three-file)
    universe, and simplifies it substantially.
    Signed-off-by: H. Peter Anvin <hpa@zytor.com>
    Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>
:040000 040000 6560eb5b7e40d93813276544bced8c478f9067f5 fe5f90d9ca08e526559815789175602ba2c51743 M      arch
> The bisect will almost guaranteed show a change at the change to the new
> setup code.  The message means that the setup code wasn't loaded
> correctly into memory; the big question is *why*.
> What distro/version of grub are you running?  
Debian unstable
> I'm wondering if there are
> some old version of grub out there which did the "load four sectors"
> way-anciently-obsolete crap; the other possibility that comes to mind is
> setting up the stack in an invalid manner.
grub version:
[boris@gollum:18:17:27:->  apt-cache show grub
Package: grub
Priority: optional
Section: admin
Installed-Size: 708
Maintainer: Grub Maintainers <pkg-grub-devel@lists.alioth.debian.org>
Architecture: i386
Version: 0.97-29
Depends: libc6 (>= 2.5-5), libncurses5 (>= 5.4-5)
Suggests: grub-doc, mdadm
Filename: pool/main/g/grub/grub_0.97-29_i386.deb
Size: 366884
MD5sum: 2da7a5942db06eaba046dff4615bcce9
SHA1: 7f4da793da209d011ce94fceebaebe0e5f08790f
SHA256: 2596782c08f1f7365e9935f687fef74c67d8702503188f22448db9f0ac98e18e
Description: GRand Unified Bootloader
...
so any ideas/test patches for debugging this are welcome.
-- 
Regards/Gru√ü,
    Boris.
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.kernel.org
More majordomo info at  
http://vger.kernel.org/majordomo-info.html
Please read the FAQ at  
http://www.tux.org/lkml/