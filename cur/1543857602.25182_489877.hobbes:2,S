Date: Sat, 9 Dec 2006 02:46:27 +0000
From: Alan <>
Subject: Re: [PATCH] PCI legacy resource fix
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2006/12/8/364

> Checking the patch, my problem is that the old way, all BAR's were being
> set at start = end = flags = 0. The patch makes it set all the BAR's to
Yes the old quirk used to blank the resources as the values on the chip
are undefined and random. This gives you corrupt resource trees and needs
hacks in the drivers as well
> the normal values. This is what it looks like in lspci, pre this patch:
> 
>         Region 0: I/O ports at <unassigned>
>         Region 1: I/O ports at <unassigned>
>         Region 2: I/O ports at <unassigned>
>         Region 3: I/O ports at <unassigned>
Then your device is in legacy mode, or was disabled
> So my device is not running in compatibility mode, and should not have
The paste you have their shows that it almost certainly is in legacy mode.
> the BAR's set, as Alan's patch does.
Dump the class code and other bits during boot check how your device is
seen (native v legacy/compatibility) and whether the fixup logic
triggers. It should only trigger for legacy devices.
Alan
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.kernel.org
More majordomo info at  
http://vger.kernel.org/majordomo-info.html
Please read the FAQ at  
http://www.tux.org/lkml/