Date: Fri, 1 Feb 2008 23:26:28 -0600
From: Olof Johansson <>
Subject: [PATCH] Fix fallout from PCI: PCIE ASPM support
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2008/2/2/2

On Sat, Feb 02, 2008 at 05:06:42AM +0000, Linux Kernel Mailing List wrote:
>     PCI: PCIE ASPM support
This one broke almost all defconfigs on powerpc, since they enable
CONFIG_EXPERIMENTAL and CONFIG_PCI, and this option defaults to y.
Make it default to 'n' like most other options, and make it depend on
ACPI. Take out the unneccessary default 'n' from the debug option as well.
Signed-off-by: Olof Johansson <olof@lixom.net>
diff --git a/drivers/pci/pcie/Kconfig b/drivers/pci/pcie/Kconfig
index 60104cf..4393bb3 100644
--- a/drivers/pci/pcie/Kconfig
+++ b/drivers/pci/pcie/Kconfig
@@ -32,8 +32,7 @@ source "drivers/pci/pcie/aer/Kconfig"
 #
 config PCIEASPM
 	bool "PCI Express ASPM support(Experimental)"
-	depends on PCI && EXPERIMENTAL
-	default y
+	depends on PCI && ACPI && EXPERIMENTAL
 	help
 	  This enables PCI Express ASPM (Active State Power Management) and
 	  Clock Power Management. ASPM supports state L0/L0s/L1.
@@ -42,7 +41,6 @@ config PCIEASPM
 config PCIEASPM_DEBUG
 	bool "Debug PCI Express ASPM"
 	depends on PCIEASPM
-	default n
 	help
 	  This enables PCI Express ASPM debug support. It will add per-device
 	  interface to control ASPM.