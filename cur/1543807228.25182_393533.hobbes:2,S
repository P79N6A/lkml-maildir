Date: Sat, 4 Feb 2006 12:52:17 +0100
From: Holger Eitzenberger <>
Subject: Re: Linux 2.6.15.2
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2006/2/4/63

On Fri, Feb 03, 2006 at 11:14:14AM -0800, Andrew Morton wrote:
> 
http://www.mail-archive.com/netdev@vger.kernel.org/msg06355.html
> > A look into /proc/sys/net/ipv4/tcp_mem showed that that the values in
> > there were way to high.  I hope that a reduction of these values will
> > help (not done yet).
> Sounds different.  Please test a more recent kernel and if the problem is
> still there, send a report to linux-kernel and cc netdev@vger.kernel.org. 
> Include the contents of /proc/meminfo and /proc/slabinfo.  Thanks.
I solved the issue.
Recent kernels have alloc_large_system_hash() exactly for that, and
tcp_init() uses it.  It has nr_all_pages and nr_kernel_pages to
determine the actual size of usable RAM, whereas 2.6.10 just uses
num_physpages.  That's the reason why the values in tcp_mem are way
too high on machines with 3-4 Gig RAM.
Thanks.  /holger
-- 
ICQ 2882018 ++ Jabber: octavian@amessage.de ++
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.kernel.org
More majordomo info at  
http://vger.kernel.org/majordomo-info.html
Please read the FAQ at  
http://www.tux.org/lkml/