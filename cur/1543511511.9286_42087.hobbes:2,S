Date: Mon, 04 Oct 1999 13:38:45 -0500
From: Art Pina <>
Subject: Errors building Kernel 2.2.18
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/1999/10/4/94

I am aware of the major redesign of pagecache which broke various
filesystems,
however, I thought I'd submit this and hope someone has a workaround.
Building Kernel from Linux 2.2.18 source.
Output from ver_linux:
Linux a260 2.2.13-7mdk #1 Wed Sep 15 18:02:18 CEST 1999 i586 unknown
Kernel modules         2.1.121
Gnu C                  egcs-2.91.66
Binutils               2.9.5.0.6
Linux C Library        2.1.1
Dynamic linker         ldd (GNU libc) 2.1.1
Linux C++ Library      2.9.0
Procps                 2.0.2
Mount                  2.9o
Net-tools              1.52
Console-tools          0.2.0
Sh-utils               1.16
Modules Loaded         hpfs nls_iso8859-1 nls_cp437 vfat fat
========================================================================
Problem:
 
make command output:
ld -m elf_i386 -T /mnt/hda10/ws/kernel/linux/arch/i386/vmlinux.lds -e
stext arch
        --start-group \
        arch/i386/kernel/kernel.o arch/i386/mm/mm.o kernel/kernel.o
mm/mm.o fs/fs.o ipc/ipc.o \
        fs/filesystems.a \
        net/network.a \
        drivers/block/block.a drivers/char/char.o drivers/misc/misc.o
drivers/parport/parport.a driv
ers/net/net.a drivers/scsi/scsi.a drivers/cdrom/cdrom.a
drivers/pci/pci.a drivers/pnp/pnp.a drivers/
video/video.a \
        /mnt/hda10/ws/kernel/linux/arch/i386/lib/lib.a
/mnt/hda10/ws/kernel/linux/lib/lib.a /mnt/hda
10/ws/kernel/linux/arch/i386/lib/lib.a \
        --end-group \
        -o vmlinux
fs/filesystems.a(smbfs.o): In function `smb_get_dircache':
smbfs.o(.text+0x33f1): undefined reference to `get_cached_page'
smbfs.o(.text+0x3444): undefined reference to `get_cached_page'
fs/filesystems.a(smbfs.o): In function `smb_add_to_cache':
smbfs.o(.text+0x35ec): undefined reference to `get_cached_page'
fs/filesystems.a(hpfs.o)(.rodata+0x2398): undefined reference to
`hpfs_writepage'
make: *** [vmlinux] Error 1
 
Solution/Workaround: ???
I tried:
in cache.c replaced get_cached_page with __find_get_page
 and added: #include <linux/pagemap.h>
-- This made the error go away, but the kernel hangs after displaying
the message:
 Uncompressing Kernel..., Ok, ...
 
in inode.c replaced hpfs_writepage with NULL
-- This made the error go away. This appears to be the best thing to do
at the moment, since no routine called "hpfs_writepage" exists.
Perhaps a stub emitting an error message on this function call would be
better.
 
========================================================================
Trivial bug/Syntax error:
 
./tkparse < ../arch/i386/config.in >> kconfig.tk
drivers/char/Config.in: 72: bad if condition
make[1]: *** [kconfig.tk] Error 1
make[1]: Leaving directory `/mnt/hda10/ws/kernel/linux/scripts'
make: *** [xconfig] Error 2
 
Fixed by adding closing ']'.
========================================================================
Thanks,
Art
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.rutgers.edu
Please read the FAQ at 
http://www.tux.org/lkml/