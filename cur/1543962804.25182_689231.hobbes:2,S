Date: Sun, 04 May 2008 18:18:36 +0200 (CEST)
From: Michal Simek <>
Subject: Re: [PATCH 1/2] OF: clean coding style - prom parse.c
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2008/5/4/185

Hi Jiri,
you are right. But the bugs comes from this patch 
http://lkml.org/lkml/2008/5/3/110.
For Paulus: Can you move these files? 
As wrote Joe. The best way will be to fix these files after moving.
Thanks,
Michal
> Hi All,
> 
> I fixed only part of coding style violation. Not all of them.
Actually, you introduced a bug. See:
http://lkml.org/lkml/2008/5/3/141
You should have used KERN_CONT, or even better sprintf and friends to be atomic
in logs.
> But you are right KERN_<level> is necessary.
> 
> For me is especially important to move these files from arch/powerpc to
drivers/of.
> 
> M
> 
>>>  /* Debug utility */
>>>  #ifdef DEBUG
>>>  static void of_dump_addr(const char *s, const u32 *addr, int na)
>>>  {
>>> -	printk("%s", s);
>>> -	while(na--)
>>> -		printk(" %08x", *(addr++));
>>> -	printk("\n");
>>> +	printk(KERN_INFO "%s", s);
>>> +	while (na--)
>>> +		printk(KERN_INFO " %08x", *(addr++));
>>> +	printk(KERN_INFO "\n");
>>>  }
>> You've prefixed KERN_INFO before every address block.
>>
>> How about:
>>
>> print_hex_dump(KERN_<level>, s, DUMP_PREFIX_NONE, 4, addr, na, false);