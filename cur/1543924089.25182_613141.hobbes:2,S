Date: Thu, 1 Nov 2007 09:58:24 -0700
From: Kristen Carlson Accardi <>
Subject: Re: Suspend to ram regression (2.6.24-rc1-git)
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2007/11/1/206

On Thu, 01 Nov 2007 07:20:16 -0400
Jeff Garzik <jeff@garzik.org> wrote:
> Jens Axboe wrote:
> > Reverting just the default AHCI flags makes it work again. IOW, with the
> > below patch I can suspend properly with current -git.
> > 
> > diff --git a/drivers/ata/ahci.c b/drivers/ata/ahci.c
> > index ed9b407..77f7631 100644
> > --- a/drivers/ata/ahci.c
> > +++ b/drivers/ata/ahci.c
> > @@ -190,8 +190,7 @@ enum {
> > 
> >  	AHCI_FLAG_COMMON		= ATA_FLAG_SATA | ATA_FLAG_NO_LEGACY |
> >  					  ATA_FLAG_MMIO | ATA_FLAG_PIO_DMA |
> > -					  ATA_FLAG_ACPI_SATA | ATA_FLAG_AN |
> > -					  ATA_FLAG_IPM,
> > +					  ATA_FLAG_ACPI_SATA | ATA_FLAG_AN,
> >  	AHCI_LFLAG_COMMON		= ATA_LFLAG_SKIP_D2H_BSY,
> 
> 
> sounds like the easy thing to do, in light of this breakage, might be to 
> default it to off, add a module parameter turning it on by setting that 
> flag.
> 
Can you give me a day to fix it first?  I had a similar problem earlier
on in the development, and the fix was not that bad.  The issue was 
related to not bringing the link back up to active before doing suspend/resume,
and the fix was really straight forward.  I'll take a look at this today,
and if I can't come up with a pretty fast fix I'll let you know.
Kristen
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.kernel.org
More majordomo info at  
http://vger.kernel.org/majordomo-info.html
Please read the FAQ at  
http://www.tux.org/lkml/