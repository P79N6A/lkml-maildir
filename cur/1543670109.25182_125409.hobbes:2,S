Date: Tue, 15 Apr 2003 15:27:39 -0700
From: James Cleverdon <>
Subject: [PATCH] 2.4.21-pre7: Summit family (EXA) ID strings
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2003/4/15/241

All future IBM Summit boxes are supposed to have their Product ID strings 
start with "EXA", including the forthcoming x445.
--- 2.4.21-pre7/include/asm-i386/smpboot.h.df	Tue Apr 15 15:15:39 2003
+++ 2.4.21-pre7/include/asm-i386/smpboot.h	Tue Apr 15 15:20:01 2003
@@ -21,7 +21,10 @@ static inline void detect_clustered_apic
 	/*
 	 * Can't recognize Summit xAPICs at present, so use the OEM ID.
 	 */
-	if (!strncmp(oem, "IBM ENSW", 8) && !strncmp(prod, "VIGIL SMP", 9)){
+	if (!strncmp(oem, "IBM ENSW", 8) &&
+	    (!strncmp(prod, "VIGIL SMP", 9) ||
+	     !strncmp(prod, "EXA", 3) ||
+	     !strncmp(prod, "RUTHLESS", 8))){
 		clustered_apic_mode = CLUSTERED_APIC_XAPIC;
 		apic_broadcast_id = APIC_BROADCAST_ID_XAPIC;
 		int_dest_addr_mode = APIC_DEST_PHYSICAL;
-- 
James Cleverdon
IBM xSeries Linux Solutions
{jamesclv(Unix, preferred), cleverdj(Notes)} at us dot ibm dot com--- 2.4.21-pre7/include/asm-i386/smpboot.h.df	Tue Apr 15 15:15:39 2003
+++ 2.4.21-pre7/include/asm-i386/smpboot.h	Tue Apr 15 15:20:01 2003
@@ -21,7 +21,10 @@ static inline void detect_clustered_apic
 	/*
 	 * Can't recognize Summit xAPICs at present, so use the OEM ID.
 	 */
-	if (!strncmp(oem, "IBM ENSW", 8) && !strncmp(prod, "VIGIL SMP", 9)){
+	if (!strncmp(oem, "IBM ENSW", 8) &&
+	    (!strncmp(prod, "VIGIL SMP", 9) ||
+	     !strncmp(prod, "EXA", 3) ||
+	     !strncmp(prod, "RUTHLESS", 8))){
 		clustered_apic_mode = CLUSTERED_APIC_XAPIC;
 		apic_broadcast_id = APIC_BROADCAST_ID_XAPIC;
 		int_dest_addr_mode = APIC_DEST_PHYSICAL;