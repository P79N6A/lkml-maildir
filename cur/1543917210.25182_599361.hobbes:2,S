Date: Wed, 26 Sep 2007 16:20:59 -0700
From: Randy Dunlap <>
Subject: Re: [PATCH] Patches for tiny 386 kernels, again. Linux kernel 2.6.22.7
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2007/9/26/432

On Wed, 26 Sep 2007 11:42:16 -0700 Jonathan Campbell wrote:
> Here is the DMI patch again, written against linux-2.6.23-rc8,
> with some of the #ifdef CONFIG_DMI's removed and moved
> to include/linux/dmi.h. Putting them there in the way I've done
> ensures that you don't have to put #ifdef CONFIG_DMI
> around each dmi_check_machine() and that you don't
> have to apply little patches to so many device drivers.
Damaged as the patch is, I was able to apply it by using
'patch -l' (ignore whitespace) + some fuzz.  Not something that
Linus or Andrew would or should do.
I built and booted the kernel, it's running fine (x86_32 notebook).
> diff -u -r linux-2.6.23-rc8-old/init/Kconfig linux-2.6.23-rc8/init/Kconfig
> --- linux-2.6.23-rc8-old/init/Kconfig    2007-09-21 22:38:23.000000000 +0000
> +++ linux-2.6.23-rc8/init/Kconfig    2007-09-26 00:03:05.000000000 +0000
> @@ -542,6 +542,18 @@
>        on EMBEDDED systems.  /proc/vmstat will only show page counts
>        if VM event counters are disabled.
> 
> +config DMI
> +    default y
> +    bool "Enable DMI support" if EMBEDDED
> +    depends on X86
> +    help
> +      This enables support for processing the Desktop Management
> +      Interface structures present in most modern BIOSes. If you are
> +      building a kernel for an older Pentium, 486, or 386 system and
> +      memory is tight, you can disable this to help reduce the size
> +      of your kernel by about 6K.
> +      If unsure, say Y.
> +
This is in the General setup menu.  How about putting it into the
EMBEDDED menu instead?  [Configure standard kernel features (for
small systems)]
>  config SLUB_DEBUG
>      default y
>      bool "Enable SLUB debugging support" if EMBEDDED
There are still several build warnings that need attention:
drivers/acpi/sleep/main.c:223: warning: 'acpisleep_dmi_table' defined but not used
drivers/pnp/pnpbios/core.c:509: warning: 'pnpbios_dmi_table' defined but not used
arch/i386/pci/irq.c:1035: warning: 'pciirq_dmi_table' defined but not used
arch/i386/pci/common.c:148: warning: 'pciprobe_dmi_table' defined but not used
+#endif // CONFIG_DMI
Use /* ... */ style comments instead of // comments.
---
~Randy
Phaedrus says that Quality is about caring.
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.kernel.org
More majordomo info at  
http://vger.kernel.org/majordomo-info.html
Please read the FAQ at  
http://www.tux.org/lkml/