Date: Mon, 17 Mar 2008 21:08:16 +0000
From: Nix <>
Subject: Re: [2.6.24.x] UML select()/poll() oversleeping reproducibly
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2008/3/17/310

On 17 Mar 2008, Jeff Dike verbalised:
> Below is the same patch with another kluge, which cuts down the
> requested sleep by 10% in hopes of getting the actual sleep closer to
> what's wanted.
Eeuuuuw. :)
> This is unusable in anything resembling mainline, but I'd like to see
> how your various systems react to it.  I'm getting very close to the
> sleeps I asked for (with slight undersleeping, which is a bug).
OK.
Tests on host with clocksource pit:
bash-3.2# bin/select-sleep 5
Slept for 5 seconds.
bash-3.2# bin/select-sleep 10
Slept for 11 seconds.
bash-3.2# bin/select-sleep 30
Slept for 31 seconds.
bash-3.2# bin/select-sleep 60
Slept for 61 seconds.
... so much better than the 4x error without this patch.
Tests on host with clocksource tsc:
bash-3.2# bin/select-sleep 5
Slept for 5 seconds.
bash-3.2# bin/select-sleep 10
Slept for 10 seconds.
bash-3.2# bin/select-sleep 30
Slept for 30 seconds.
bash-3.2# bin/select-sleep 60
Slept for 61 seconds.
Distinctly better than without this patch.
(Am I the only person who finds it strange that (some) clocksource
hackers are arguing about accuracy problems in the ppm range while we're
glad to get an error of `only' single seconds per minute out of it? 
Maybe next year we can invent the `pendulum' clocksource :) )
-- 
`The rest is a tale of post and counter-post.' --- Ian Rawlings
                                                   describes USENET