Date: Tue, 31 May 2005 01:21:37 +0200
From: Rene Herman <>
Subject: External USB2 HDD affects speed hda
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2005/5/30/259

Hi Bartlomiej.
My Maxtor 6Y120P0 on AMD756 (UDMA66) normally gives me 50 MB/s according 
to hdparm -t:
===
# hdparm -t /dev/hda
/dev/hda:
  Timing buffered disk reads:  152 MB in  3.01 seconds =  50.57 MB/sec
===
However, the second I switch on my external USB2 drive (Western Digital 
Essential 160G, connected via a PCI card USB2 controller, on a private IRQ):
===
usb 1-3: new high speed USB device using ehci_hcd and address 3
scsi0 : SCSI emulation for USB Mass Storage devices
usb-storage: device found at 3
usb-storage: waiting for device to settle before scanning
   Vendor: WD        Model: 1600BB External   Rev: 0412
   Type:   Direct-Access                      ANSI SCSI revision: 00
SCSI device sda: 312581808 512-byte hdwr sectors (160042 MB)
sda: assuming drive cache: write through
SCSI device sda: 312581808 512-byte hdwr sectors (160042 MB)
sda: assuming drive cache: write through
  sda: sda1 sda2
Attached scsi disk sda at scsi0, channel 0, id 0, lun 0
usb-storage: device scan complete
===
the hdparm -t result drops down to 42MB/s:
===
# hdparm -t /dev/hda
/dev/hda:
  Timing buffered disk reads:  130 MB in  3.04 seconds =  42.77 MB/sec
===
Switching the USB2 HDD off again does not work to bring back the 50 MB/s:
===
# eject sda
# hdparm -t /dev/hda
/dev/hda:
  Timing buffered disk reads:  128 MB in  3.01 seconds =  42.57 MB/sec
[ push button ]
usb 1-3: USB disconnect, address 3
# hdparm -t /dev/hda
/dev/hda:
  Timing buffered disk reads:  130 MB in  3.04 seconds =  42.73 MB/sec
===
After a reboot, it's 50 MB/s again. Any idea what this is?
The USB HDD is not firing interrupts or anything. It just sits idle. 
Fully repeatable on 2.6.11.11 and 2.6.12-rc5.
Rene.
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.kernel.org
More majordomo info at  
http://vger.kernel.org/majordomo-info.html
Please read the FAQ at  
http://www.tux.org/lkml/