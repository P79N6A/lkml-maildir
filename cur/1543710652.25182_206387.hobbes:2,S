Date: Sun, 14 Mar 2004 23:44:01 +0100
From: Arnd Bergmann <>
Subject: Re: [PATCH] s390: update for altered page_state structure
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2004/3/14/114

> ChangeSet 1.1630, 2004/03/14 13:49:59-08:00, akpm@osdl.org
>
>	[PATCH] s390: update for altered page_state structure
>
>	From: Olaf Hering <olh@suse.de>
>
>	This patch is needed on s390.
>
>
> # This patch includes the following deltas:
> #	           ChangeSet	1.1629  -> 1.1630 
> #	arch/s390/appldata/appldata_mem.c	1.1     -> 1.2    
> #	include/linux/page-flags.h	1.44    -> 1.45   
> #
>
> arch/s390/appldata/appldata_mem.c |   15 +++++++++++----
> include/linux/page-flags.h        |    3 +++
> 2 files changed, 14 insertions(+), 4 deletions(-)
>
>
> diff -Nru a/arch/s390/appldata/appldata_mem.c b/arch/s390/appldata/appldata_mem.c
> --- a/arch/s390/appldata/appldata_mem.c	Sun Mar 14 14:12:59 2004
> +++ b/arch/s390/appldata/appldata_mem.c	Sun Mar 14 14:12:59 2004
> @@ -54,7 +54,9 @@
>  	u64 freeswap;		/* free swap space */
> 
>  // New in 2.6 -->
> -	u64 pgalloc;		/* page allocations */
> +	u64 pgalloc_high;	/* page allocations */
> +	u64 pgalloc_normal;
> +	u64 pgalloc_dma;
>  	u64 pgfault;		/* page faults (major+minor) */
>  	u64 pgmajfault;		/* page faults (major only) */
>  // <-- New in 2.6
> ...
Sorry, this does not look like the right fix. The structure is
effectively ABI, because it is accessed as binary data by the
VM hypervisor. If changes to it can't be avoided, the structure
version needs to be changed as well and all documentation and
VM applications using it must be updated.
In this specific case, it should be simple enough to just leave
the pgalloc field in place and write the sum of the real kernel
values (high+normal+dma) to it.
Gerald, can you please look into this?
      Arnd <><
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.kernel.org
More majordomo info at  
http://vger.kernel.org/majordomo-info.html
Please read the FAQ at  
http://www.tux.org/lkml/