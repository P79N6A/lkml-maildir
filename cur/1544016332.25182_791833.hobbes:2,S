Date: Wed, 14 Jan 2009 00:32:34 -0800
From: Andrew Morton <>
Subject: Re: [PATCH][bugfix] kprobes: fix module compilation error with CONFIG_KPROBES=n
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2009/1/14/74

On Mon, 05 Jan 2009 17:23:05 -0500 Masami Hiramatsu <mhiramat@redhat.com> wrote:
> Define kprobes related data structures even if CONFIG_KPROBES is not set.
> This fixes compilation errors which occur if CONFIG_KPROBES is not set, in
> kprobe using modules.
> 
> Reviewed-by: Ananth N Mavinakayanahalli <ananth@in.ibm.com>
> Signed-off-by: Masami Hiramatsu <mhiramat@redhat.com>
> ---
>  include/linux/kprobes.h |   45 +++++++++++++++++++++++----------------------
>  1 file changed, 23 insertions(+), 22 deletions(-)
> 
> Index: 2.6.28/include/linux/kprobes.h
> ===================================================================
> --- 2.6.28.orig/include/linux/kprobes.h
> +++ 2.6.28/include/linux/kprobes.h
> @@ -37,9 +37,9 @@
>  #include <linux/spinlock.h>
>  #include <linux/rcupdate.h>
>  #include <linux/mutex.h>
> +#include <asm/kprobes.h>
> 
>  #ifdef CONFIG_KPROBES
> -#include <asm/kprobes.h>
> 
The above change breaks alpha, and any other architecture which has no
asm/kprobes.h.
I undid that change, but maybe that rebroke things?