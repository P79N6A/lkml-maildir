Date: Wed, 30 Apr 2008 11:48:06 +0530
From: "NAGABHUSHAN BS" <>
Subject: Re: [RFC PATCH 0/2] Union Mount: Directory listing in glibc
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2008/4/30/27

On Tue, Apr 29, 2008 at 9:34 PM, Jan Blunck <jblunck@suse.de> wrote:
> On Tue, Apr 29, bsn.0007@gmail.com wrote:
>
>  > The RFC discussed about the information glibc readdir needs to get about
>  > union mounted directories and I have assumed the following information
>  > to be available from the kernel for this implementation.
>  >
>  > - Kernel would return all the dirents (including duplicates and whiteouts)
>  > starting from the topmost directory of the union.
>  >
>  > - Indication that this directory is a union mounted directory
>  >       I have assumed that kernel would return a "." whiteout as the first
>  > directory entry of the union. This would tell glibc readdir(3) that it is
>  > working with a union mounted directory and it needs to do duplicate
>  > elimination and whiteout suppression. It starts building a dirent cache
>  > for this purpose.
>
>  IIRC the intention was to emit a "." whiteout when "changing" from one
>  directory to the next. That means when the first directory is completely read
>  the whiteout is emitted. After that glibc knows to start duplicate
>  removal.
>
Yes the intention was to get a "." whiteout when changing from one
directory to next and thats essentially what i have assumed, for
starting duplicate elimination.
Along with that i have also assumed to get a "." whiteout as the first
directory entry of the union, so as to indicate to glibc that the
directory is a union mounted directory.
Regards
Nagabhushan