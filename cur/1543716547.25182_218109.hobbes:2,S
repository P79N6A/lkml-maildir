Date: Tue, 4 May 2004 09:46:55 +1000
From: Neil Brown <>
Subject: Re: d_splice_alias() problem.
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2004/5/3/178

On Friday April 30, Nikita@Namesys.COM wrote:
> 
> Also, Al Viro pointed to me that it's not clear why DCACHE_DISCONNECTED
> dentry is DCACHE_HASHED at all. If it were unhashed, last dput (done by
> nfsd thread) would destroy it, truncating file if necessary.
> 
This causes other problems (I vaguely remember).
It means that every NFS request on such a file would cause the dentry
to be created and then destroyed.  If the filesystem is keeping state
in the dentry, this gets lost.  I think some filesystems discard
preallocated space when the dentry is destroyed.  Even if not, there
is a performance hit. 
NeilBrown
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.kernel.org
More majordomo info at  
http://vger.kernel.org/majordomo-info.html
Please read the FAQ at  
http://www.tux.org/lkml/