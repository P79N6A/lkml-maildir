Date: Thu, 29 Dec 2005 15:26:05 -0500
From: Lee Revell <>
Subject: Re: [patch] latency tracer, 2.6.15-rc7
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2005/12/29/168

On Thu, 2005-12-29 at 15:11 -0500, Lee Revell wrote:
> On Thu, 2005-12-29 at 11:17 +0100, Ingo Molnar wrote:
> > * Dave Jones <davej@redhat.com> wrote:
> > 
> > >  > could test it by e.g. trying to reproduce the same VM latency as in the 
> > >  > -rt tree. [the two zlib patches are needed if you are using 4K stacks, 
> > >  > mcount increases stack footprint.]
> > > 
> > > kernel/latency.c: In function 'add_preempt_count_ti':
> > > kernel/latency.c:1703: warning: implicit declaration of function 'preempt_count_ti'
> > > kernel/latency.c:1703: error: invalid lvalue in assignment
> > > kernel/latency.c: In function 'sub_preempt_count_ti':
> > > kernel/latency.c:1764: error: invalid lvalue in assignment
> > 
> > indeed - i have fixed this and have uploaded a new version to:
> > 
> >    
http://redhat.com/~mingo/latency-tracing-patches/
> 
> Still does not quite work for me on i386.  I applied all the patches as
> I'm using 4K stacks.
> 
> LD      .tmp_vmlinux1
> init/built-in.o: In function `start_kernel':
> : undefined reference to `preempt_max_latency'
> make: *** [.tmp_vmlinux1] Error 1
> 
This patch fixes the problem.
Lee
--- linux-2.6.15-rc5-rt2/kernel/latency.c~	2005-12-29 14:04:26.000000000 -0500
+++ linux-2.6.15-rc5-rt2/kernel/latency.c	2005-12-29 15:23:32.000000000 -0500
@@ -71,9 +71,9 @@
  * we clear it after bootup.
  */
 #ifdef CONFIG_LATENCY_HIST
-static cycles_t preempt_max_latency = (cycles_t)0UL;
+cycles_t preempt_max_latency = (cycles_t)0UL;
 #else
-static cycles_t preempt_max_latency = (cycles_t)ULONG_MAX;
+cycles_t preempt_max_latency = (cycles_t)ULONG_MAX;
 #endif
 
 static cycles_t preempt_thresh;
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.kernel.org
More majordomo info at  
http://vger.kernel.org/majordomo-info.html
Please read the FAQ at  
http://www.tux.org/lkml/