Date: 10 Dec 2002 17:06:17 +0000
From: Alan Cox <>
Subject: Re: [BUG]: agpgart for i810 chipsets broken in 2.5.51
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2002/12/10/117

On Tue, 2002-12-10 at 16:23, Dave Jones wrote:
> That's really quite icky. Even putting an..
> 
> #ifdef CONFIG_FRAMEBUFFER_I810
>     dev = pci_find_blah..
>     agp_intel_init(dev);
> #endif
> 
> before console_init() call in init/main.c seems cleaner than that imo,
> (and this is still quite gross).
Given how fragile the AGP code can be I would much rather we had the AGP
continue to initialize late. If the AGP init function is something like
int agp_required(void)
{
	static int agp_inited = 0;
	if(!agp_inited)
	{
		agp_inited = 1;
		agp_do_real_init();
	}
}
module_init(agp_required);
Then the i810 fb driver can do
	agp_required();
and force the order change only if necessary.
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.kernel.org
More majordomo info at  
http://vger.kernel.org/majordomo-info.html
Please read the FAQ at  
http://www.tux.org/lkml/