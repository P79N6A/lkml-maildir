Date: Tue, 16 Mar 2004 16:58:42 -0500
From: Jeremy Katz <>
Subject: [PATCH] Fix blkpg ioctl32 handling
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2004/3/16/302

Simple obvious patch so that all calls to blkpg from the non-native
environment don't get -EINVAL
Jeremy
--- linux-2.6.4/fs/compat_ioctl.c.blkpg	2004-03-16 16:12:17.761705684 -0500
+++ linux-2.6.4/fs/compat_ioctl.c	2004-03-16 16:12:40.186738770 -0500
@@ -1952,6 +1952,7 @@
 		set_fs (KERNEL_DS);
 		err = sys_ioctl(fd, cmd, (unsigned long)&a);
 		set_fs (old_fs);
+                break;
 	default:
 		return -EINVAL;
 	}                                        