Date: Fri, 27 Aug 2004 20:27:48 -0600
From: Shane Hathaway <>
Subject: Re: [PATCH] e1000 rx buffer allocation
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2004/8/27/350

On Friday 27 August 2004 12:36 pm, Chris Leech wrote:
> As for moving the allocations out of the hard interrupt context, e1000
> was one of several drivers that tried that a few years back by using
> tasklets.  What I found is that if you split the allocation from the
> receive processing, it's far to easy to generate an interrupt load
> which starves the skb allocations.  The result is that you
> continuously use all of the buffers then stall while they all get
> replaced, and performance is horrible.  But if the patch works for
> your network load ...
We're getting 6000 interrupts per second, but the box handles it with ease.  
We're getting zero loss now, but I guess with slower hardware or fewer 
buffers, scheduling would be a problem.
> A better approach for improving jumbo frame allocations might be to
> use multiple smaller buffers for each receive, something the PRO/1000
> hardware can do but the e1000 driver has never taken advantage of.
Yes, that would be a far better solution.  I had no idea the card could do 
that.  Are there specs on this hardware somewhere?  Although my patch works, 
I don't want to stick with a temporary solution.
Shane
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.kernel.org
More majordomo info at  
http://vger.kernel.org/majordomo-info.html
Please read the FAQ at  
http://www.tux.org/lkml/