Date: Sat, 14 Sep 2002 13:42:06 +0000 (UTC)
From: "Miquel van Smoorenburg" <>
Subject: Re: Possible bug and question about ide_notify_reboot in drivers/ide/ide.c (2.4.19)
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2002/9/14/35

In article <1032010655.12892.8.camel@irongate.swansea.linux.org.uk>,
Alan Cox  <alan@lxorguk.ukuu.org.uk> wrote:
>> How about this: The FLUSH CACHE command has only recently become a
>> mandatory command for non-PACKET devices, so there may be drives that do
>> implement a write cache, but do NOT implement the FLUSH CACHE -- and
>> still adhere to some older edition of the ATA standard.
>
>Worse than that. There are drives that did implement it - as a no-op.
>They didn't even say "Umm sorry no can do"
Putting the drive in stand-by mode has the side effect of flushing
the cache. So before poweroff, send the FLUSH CACHE command,
then send the standby command, hope that one of them works ..
I put put-the-drive-in-standby-mode stuff in halt.c of sysvinit
after several reports of fs corruption at poweroff and it seems
to have fixed the problems for the people who reported them.
Mike.
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.kernel.org
More majordomo info at  
http://vger.kernel.org/majordomo-info.html
Please read the FAQ at  
http://www.tux.org/lkml/