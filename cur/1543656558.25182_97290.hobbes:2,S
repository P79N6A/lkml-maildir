Date: Wed, 18 Dec 2002 12:35:19 -0800
From: Andrew Morton <>
Subject: Re: [BUG] 2.5.47 - Assertion failed in fs/jbd/journal.c:415
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2002/12/18/261

Robert Macaulay wrote:
> 
> We were performing an IO performance test on 2.5.47. The storage we were
> writing to was a Fibre Channel array(dell 650f) via qlogic 2200 cards
> using the qlogicfc driver in the Linux kernel. There were 8 separate LUNS
> on the FC array, each of which has an ext3 filesystem on them. There are
> no partition tables on the disks(one of the disks would not accept one,
> separate issue). The ext3 filesystem was created directly on the block
> devices, /dev/sdf /dev/sdg etc. The server is a Dell Poweredge 6650, 4
> procs, 8Gig RAM. More detailed system information is appended at the
> bottom.
> 
> For now, the test was 100% writing to all 8 filesystems in parallel. The
> following BUG was reported halfway through the 4th run of this test. I'm
> not sure how reproducible this is.
> 
> The machine is still running. IO in progress at the time of the BUG has
> stopped in D state, New IO is stil possible though to the disks. I will
> leave the system up and running if there is any more info needed for a few
> days.
> 
> I will be trying a more recent version in a few days. 2.5.47 was the
> latest kernel I could compile at the time. I've looked through the
> archives, but could not find any mention of this particular bug, so I do
> not know if it has been addressed or not. Thanks
> 
> Assertion failure in journal_write_metadata_buffer() at fs/jbd/journal.c:415: "buffer_jdirty(jh2bh(jh_in))"
I can't immediately see what would cause this.  There is code in
__journal_file_buffer which could have triggered this, but we should
have exclusion from that via both lock_kernel() and lock_journal().
I'll see if Stephen can spot it.   I shall assume you were using
the data-ordered journalling mode.
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.kernel.org
More majordomo info at  
http://vger.kernel.org/majordomo-info.html
Please read the FAQ at  
http://www.tux.org/lkml/