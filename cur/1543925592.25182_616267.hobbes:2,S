Date: Mon, 12 Nov 2007 00:15:56 -0600
From: Larry Finger <>
Subject: DMA descriptor alignment
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2007/11/12/9

For those variants of BCM43xx cards that use 64-bit DMA, there is a requirement that all descriptor
rings must be aligned on an 8K boundary and must fit within an 8K page. On the x86_64 architecture
where the page size is 4K, I was getting addresses like 0x67AF000 when using dma_alloc_coherent
calls. From the description of the dma_pool_create and dma_pool_allocate routines, I thought they
would fix my problems; however, even with a dma_pool_create(name, dev, 8192, 8192, 8192) call, I'm
still getting 4K rather than 8K alignment, which results in DMA errors.
Is there a bug in these routines, am I using them incorrectly, or do I have a misunderstanding of
what it takes to get this kind of alignment?
Thanks,
Larry
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.kernel.org
More majordomo info at  
http://vger.kernel.org/majordomo-info.html
Please read the FAQ at  
http://www.tux.org/lkml/