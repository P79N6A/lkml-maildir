Date: Sun, 6 Aug 2000 19:59:53 -0300 (BRT)
From: Marcelo Tosatti <>
Subject: Re: 2.2.16 - Crash
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2000/8/6/91

On Mon, 7 Aug 2000, James Stevenson wrote:
> 
> Hi
> 
> no i dont i added more and it has seemed to fix the
> problem
Even if it adding more swap fixed your problem the kernel should not crash
when there is no more swap space available.
Could you please repeat the test with the same amount of swap as before,
but this patch:
--- mm/filemap.c.orig   Fri Jul 21 07:18:21 2000
+++ mm/filemap.c        Fri Jul 21 07:31:31 2000
@@ -179,8 +179,6 @@
                if ((gfp_mask & __GFP_DMA) && !PageDMA(page))
                        continue;
 
-               count--;
-
                /*
                 * Is it a page swap page? If so, we want to
                 * drop it if it is no longer used, even if it
@@ -226,7 +224,7 @@
                        return 1;
                }
 
-       } while (count > 0);
+       } while (--count > 0);
        return 0;
 }
> 
> On Sun, 6 Aug 2000, Marcelo Tosatti wrote:
> 
> > 
> > Do you have any swap space available when the machine crashes? 
> > 
> > 
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.rutgers.edu
Please read the FAQ at 
http://www.tux.org/lkml/