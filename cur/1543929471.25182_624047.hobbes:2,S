Date: Tue, 4 Dec 2007 14:46:51 +0100
From: Bartlomiej Zolnierkiewicz <>
Subject: Re: [PATCH 26/28] blk_end_request: changing ide-cd (take 3)
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2007/12/4/135

Hi,
On Monday 03 December 2007, Kiyoshi Ueda wrote:
[...]
> Thank you for the comments.
> I rebased my patch on top of 2.6.24-rc3-mm2 + the patch to remove
> post_transform_command().
> 
> As a result, one callback function for DMA mode has been removed.
> What do you think about the patch below?
> 
> 
> 
> Subject: [PATCH 26/28] blk_end_request: changing ide-cd (take 3)
> 
> 
> This patch converts ide-cd (cdrom_newpc_intr()) to use blk_end_request
> interfaces.
> 
> In PIO mode, ide-cd (cdrom_newpc_intr()) needs to defer
> end_that_request_last() until the device clears DRQ_STAT and raises
> an interrupt after end_that_request_first().
> So blk_end_request() has to return without completing request
> even if no leftover in the request.
> 
> ide-cd uses blk_end_request_callback() and a dummy callback function,
> which just returns value '1', to tell blk_end_request_callback()
> about that.
> 
> Signed-off-by: Kiyoshi Ueda <k-ueda@ct.jp.nec.com>
> Signed-off-by: Jun'ichi Nomura <j-nomura@ce.jp.nec.com>
Looks good, thanks!
Acked-by: Bartlomiej Zolnierkiewicz <bzolnier@gmail.com>