Date: Mon, 07 Aug 2006 07:46:43 +0800
From: "Antonino A. Daplas" <>
Subject: Re: use persistent allocation for cursor blinking.
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2006/8/6/150

Pavel Machek wrote:
> Hi!
> 
>> Every time the console cursor blinks, we do a kmalloc/kfree pair.
>> This patch turns that into a single allocation.
>>
>> This allocation was the most frequent kmalloc I saw on my test box.
>>
>> Signed-off-by: Dave Jones <davej@redhat.com>
>>
>>
>> --- linux-2.6.14/drivers/video/console/softcursor.c~	2005-12-28 18:40:08.000000000 -0500
>> +++ linux-2.6.14/drivers/video/console/softcursor.c	2005-12-28 18:45:50.000000000 -0500
>> @@ -23,7 +23,9 @@ int soft_cursor(struct fb_info *info, st
>>  	unsigned int buf_align = info->pixmap.buf_align - 1;
>>  	unsigned int i, size, dsize, s_pitch, d_pitch;
>>  	struct fb_image *image;
>> -	u8 *dst, *src;
>> +	u8 *dst;
>> +	static u8 *src=NULL;
>> +	static int allocsize=0;
>> 
> 
> Spaces around = ? And perhaps it does not need to be initialized when
> it is static?
> 
I already sent an updated patch, so your concerns are gone.
Tony
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.kernel.org
More majordomo info at  
http://vger.kernel.org/majordomo-info.html
Please read the FAQ at  
http://www.tux.org/lkml/