Date: Wed, 21 Jan 2009 14:47:22 -0800 (PST)
From: David Miller <>
Subject: Re: [PATCH 3/3] ehea: Improve driver behaviour in low mem conditions
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2009/1/21/321

From: Thomas Klein <tklein@de.ibm.com>
Date: Wed, 21 Jan 2009 15:49:41 +0100
> Reworked receive queue fill policies to make the driver more tolerant
> in low memory conditions.
> 
> Signed-off-by: Thomas Klein <tklein@de.ibm.com>
Applied, but there is an even better way to handle this.
You should be allocating replacement RX skbs at receive time.  And if
the RX allocation fails, you simply give the RX skb back to the chip
and do not pass it up into the stack.
This is what many ethernet drivers do to ensure that the chip never
can reach a situation where the free RX packet queue becomes empty.