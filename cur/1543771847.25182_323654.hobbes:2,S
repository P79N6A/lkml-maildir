Date: Tue, 7 Jun 2005 15:29:23 +0530 (IST)
From: Nagendra Singh Tomar <>
Subject: Re: Zeroed pages returned for heap
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2005/6/7/47

On Tue, 7 Jun 2005, Ulrich Drepper wrote:
> On 6/6/05, Nagendra Singh Tomar <nagendra_tomar@adaptec.com> wrote:
> > Is it OK for an application (a C library implementing malloc/calloc is
> > also an application) to assume that the pages returned by the OS for heap
> > allocation (either directly thru brk() or thru mmap(MAP_ANONYMOUS)) will
> > be zero filled.
> 
> The malloc code is glibc is defined with the assumption that brk
> clears memory.  Since this is what the kernel implements it would be a
> horrible waste of time to reinitialize the memory.  This behavior is
> part of the kernel ABI and cannot be changed without breaking existing
> applications without producing new libc DSOs (set MORECORE_CLEARS
> appropriately) and relinking all statically linked apps.
glibc behaviour is completely justified, but when you are dealing with 
Xscale memory access limitations you wish it was not like that and just 
disabling zeroing brk/anonymous pages in kernel could get you a good bump 
in performance.
Anyway, thanx for the insight.
-- You have moved the mouse. Windows must be restarted for the 
   changes to take effect.
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.kernel.org
More majordomo info at  
http://vger.kernel.org/majordomo-info.html
Please read the FAQ at  
http://www.tux.org/lkml/