Date: Fri, 16 Jun 2006 17:31:12 +0200
From: Zoltan Menyhart <>
Subject: Re: FOR REVIEW: New x86-64 vsyscall vgetcpu()
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2006/6/16/87

Andi Kleen wrote:
> That is not how user space TLS works. It usually has a base a register.
Can you please give me a real life (simplified) example?
> This means it cannot be cache colored (because you would need a static
> offset) and you couldn't share task_structs on a page.
I do not see the problem. Can you explain please?
E.g. the scheduler pulls a task instead of the current one. The CPU
will see "current->thread_info.cpu"-s of all the tasks at the same
offset anyway.
> Also you would make task_struct part of the userland ABI which
> seems like a very very bad idea to me. It means we couldn't change
> it anymore.
We can make some wrapper, e.g.:
	user_per_cpu_var(name, offset)
"vgetcpu()" would also be added to the ABI which we couldn't change
easily either.
Thanks,
Zoltan
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.kernel.org
More majordomo info at  
http://vger.kernel.org/majordomo-info.html
Please read the FAQ at  
http://www.tux.org/lkml/