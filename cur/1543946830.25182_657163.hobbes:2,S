Date: Wed, 20 Feb 2008 21:58:42 +0100
From: Peter Zijlstra <>
Subject: Re: [PATCH] x86: add the debugfs interface for the sysprof tool
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2008/2/20/525

On Wed, 2008-02-20 at 11:26 -0800, Arjan van de Ven wrote:
> feel free to reinvent a whole GUI just to avoid a 200 line kernel module.
> sysprof is here. it works. 
> the gui is REALLY nice.
I guess we have to agree to disagree here. Its plain useless from my
POV.
> I think it's the wrong tradeoff though... oprofile exists for how long?
Dunno, years, and has served me well.
The thing I worry about is the wild-growth of duplicate functionality
and interfaces. You might say, 'its in /debug' so no API crap, but if
enough user-space depends on it people _will_ complain if it breaks.
Hopefully someone will consolidate stuff - soon. I can agree with the
fact that the oprofile user-interface is quite horrible, and perhaps the
kernel code isn't pretty (never looked at it), so if people want to
replace it, feel free, but offer a full replacement so we can deprecate
and remove the old stuff, and not carry everything around.
Currently we have: readprofile, oprofile, perfmon and now sysprof.
Also, sysprof is a misnomer, you cannot be a system wide profiler and
have code like:
+       if (!is_user) {
+               /* kernel */
+               trace->pid = current->pid;
+               trace->truncated = 0;
+               trace->n_addresses = 1;
+
+               /* 0x1 is taken by sysprof to mean "in kernel" */
+               trace->addresses[0] = 0x1;
+	}
The kernel is an integral part of the system, it can often help to know
where in the kernel time is spent - even if you're not directly
interested in 'fixing' the kernel.