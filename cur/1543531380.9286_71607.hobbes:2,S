Date: Thu, 23 Mar 2000 10:18:39 +1100
From: Paul Mackerras <>
Subject: Re: [linux-usb] power management (WAS Re: [linux-usb] OHCI crash)
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2000/3/22/254

On Thu, 23 Mar 2000, Alan Cox wrote:
> > On the PowerBook sleep mecanism, we have a special message "sleep reject"
> > that is sent after stage 1 if the sleep request was canceled. (if it's
> > canceled from state 2 or 3, then the real wakeup commands are sent to
> > resume the driver).
> 
> The main PM interface has a whole pile of other problems too - it doesnt
> lock against parallel messages and it crashes if we unload during a message
> delivery and unregister stuff.
> 
> It needs a chunk of work doing 
Another thing we do in the powerbook sleep stuff is that we order the
sleep/wakeup handlers according to a priority, and the last handler to get
called on a sleep is the first handler to get called on a wakeup.  The
priorities are set so that for instance we restore the screen first on a
wakeup so the user gets an immediate visual indication that the machine is
awake again.
We would like to be able to get the same effect with the new PM code.  I
am aware that having priority numbers that drivers have to know about
isn't a good long-term scalable solution.  It would be nice though for the
PM code to know what kind of device is being registered; at the moment for
PCI devices I think it only gets told the PCI device location.
--
Paul Mackerras, Senior Open Source Researcher, Linuxcare, Inc.
+61 2 6262 8990 tel, +61 2 6262 8991 fax
paulus@linuxcare.com.au, 
http://www.linuxcare.com.au/
Linuxcare.  Support for the revolution.
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.rutgers.edu
Please read the FAQ at 
http://www.tux.org/lkml/