Date: Tue, 06 Jul 1999 11:59:34 +0200
From: Matthias Welwarsky <>
Subject: [PATCH] Rewritten AX.25 for 2.3.9
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/1999/7/6/182

Hello Linus and List,
the attached patch contains a largely rewritten AX.25 implementation.
It's been/being tested presently on several network nodes in Germany and
has proven to be rather stable. Side impacts on other subsystems of the
kernel have not shown up so far. And at least Alexey will be happy to
eliminate some ugly compatibility stuff from the networking code he kept
to make AX.25 happy ;-)
this is the diffstat of the patch, I'll comment what the changes are to
give you a clue.
 drivers/net/hamradio/Config.in        |    3
 drivers/net/hamradio/Makefile         |   16
 drivers/net/hamradio/baycom_epp.c     | 1470
++++++------------------------
 drivers/net/hamradio/baycom_par.c     |    1
 drivers/net/hamradio/baycom_ser_fdx.c |    1
 drivers/net/hamradio/baycom_ser_hdx.c |    1
 drivers/net/hamradio/hdlcdrv.c        |  133 +-
 drivers/net/hamradio/kiss.c           | 1279 ++++++++++++++++++++++++++
 drivers/net/hamradio/kiss.h           |   92 +
 drivers/net/hamradio/mkiss.c          |  207 ++--
 drivers/net/hamradio/mkiss.h          |    2
 drivers/net/hamradio/soundmodem/sm.h  |    1
*this is hamradio stuff only. unfortunately it will nuke Thomas Sailers
EPP modem driver (that never worked for me ;-)
 include/asm-alpha/termios.h           |    3
 include/asm-arm/termios.h             |    3
 include/asm-i386/termios.h            |    3
 include/asm-m68k/termios.h            |    3
 include/asm-mips/termios.h            |    3
 include/asm-ppc/termios.h             |    3
 include/asm-sparc/termios.h           |    3
 include/asm-sparc64/termios.h         |    3
* Line discipline N_AX25 has changed to N_KISS
 include/linux/ax25.h                  |   75 +
 include/linux/hdlcdrv.h               |    4
* AX.25 stuff only
 include/linux/netdevice.h             |    1
* a pointer to private data has been added to struct device
 include/linux/netlink.h               |    1
* AX.25 now needs a netlink channel.
 include/linux/proc_fs.h               |    1
* added /proc/net/ax25_ports
 include/net/ax25.h                    |  367 ++-----
 include/net/ax25_uid.h                |   25
 include/net/ax25dev.h                 |  161 +++
 include/net/netrom.h                  |    3
 include/net/rose.h                    |    3
* AX.25 stuff only
 net/ax25/Config.in                    |    2
 net/ax25/Makefile                     |   13
 net/ax25/af_ax25.c                    | 1634
++++++++++++----------------------
 net/ax25/af_ax25.h                    |   19
 net/ax25/ax25_addr.c                  |  306 ------
 net/ax25/ax25_core.c                  |  508 ++++++++++
 net/ax25/ax25_core.h                  |   21
 net/ax25/ax25_ctl.c                   |  117 ++
 net/ax25/ax25_ctl.h                   |    6
 net/ax25/ax25_ddi.c                   | 1008 ++++++++++++++++++++
 net/ax25/ax25_ddi.h                   |   38
 net/ax25/ax25_dev.c                   |  231 ----
 net/ax25/ax25_ds_in.c                 |  317 ------
 net/ax25/ax25_ds_subr.c               |  219 ----
 net/ax25/ax25_ds_timer.c              |  228 ----
 net/ax25/ax25_iface.c                 |  270 -----
 net/ax25/ax25_in.c                    | 1002 +++++++++++++-------
 net/ax25/ax25_in.h                    |   26
 net/ax25/ax25_ip.c                    |  212 ----
 net/ax25/ax25_ipax.c                  |  691 ++++++++++++++
 net/ax25/ax25_lapb.c                  |  698 ++++++++++++++
 net/ax25/ax25_lapb.h                  |   11
 net/ax25/ax25_netlink.c               |   94 +
 net/ax25/ax25_netlink.h               |   10
 net/ax25/ax25_out.c                   |  349 -------
 net/ax25/ax25_route.c                 |  542 +++++------
 net/ax25/ax25_route.h                 |   29
 net/ax25/ax25_std_in.c                |  471 ---------
 net/ax25/ax25_std_subr.c              |  106 --
 net/ax25/ax25_std_timer.c             |  174 ---
 net/ax25/ax25_subr.c                  |  350 ++-----
 net/ax25/ax25_subr.h                  |   35
 net/ax25/ax25_timer.c                 |  522 +++++++---
 net/ax25/ax25_uid.c                   |  139 --
 net/ax25/ax25_vj.c                    |  720 ++++++++++++++
 net/ax25/ax25_vj.h                    |   73 +
 net/ax25/sysctl_net_ax25.c            |   98 --
* AX.25 stuff only
 net/ipv4/arp.c                        |    2
* this one disables the compatibility stuff Alexey is so unhappy about
 net/netrom/af_netrom.c                |    1
 net/netrom/nr_route.c                 |   87 -
* small corrections due to interface changes
 net/netsyms.c                         |    1
* AX.25 needs ip_options_fragment() 
 net/rose/af_rose.c                    |    1
 net/rose/rose_link.c                  |   16
 net/rose/rose_route.c                 |   75 -
* small corrections due to interface changes
Linus, can you please include this into 2.3.10 (or later)
Gruss,
	Matthias
--
Two OS engineers facing a petri net chart:
	"dead lock in four moves!"[unhandled content-type:application/x-gzip]