Date: Mon, 20 Mar 2000 17:04:44 +0100 (MET)
From: Christian Czezatke <>
Subject: [PATCH] fix symlinks in romfs for 2.3.99pre2
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2000/3/20/146

Hi!
While playing around with 2.3.99pre2 and initrd I've discovered that romfs
does not recognize symlinks in this kernel version.
Here is a patch that fixes the problem:
--------------------
diff -urN linux-2.3.99-pre2/fs/romfs/inode.c linux/fs/romfs/inode.c
--- linux-2.3.99-pre2/fs/romfs/inode.c	Mon Mar 13 21:35:39 2000
+++ linux/fs/romfs/inode.c	Mon Mar 20 16:54:06 2000
@@ -514,7 +514,8 @@
 			break;
 		case 3:
 			i->i_op = &page_symlink_inode_operations;
-			i->i_mode = S_IRWXUGO;
+			i->i_data.a_ops = &romfs_aops;
+			i->i_mode = ino;
 			break;
 		default:
 			/* depending on MBZ for sock/fifos */
--------------------
I hope you'll find that patch useful...
     Christian
--
--------------------------------------------------------------------
\       DI. Christian Czezatke  | email: czezatke@xss.co.at       /    
 \      xS+S Andreas Haumer     | phone: +43-1-6060114-30        /
  \     Karmarschgasse 51/2/20  | fax:   +43-1-6060114-71       /
   \    A-1100 Vienna/Austria   |                              /
    -----------------------------------------------------------
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.rutgers.edu
Please read the FAQ at 
http://www.tux.org/lkml/