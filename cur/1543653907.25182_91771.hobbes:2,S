Date: Fri, 22 Nov 2002 20:19:14 +0100
From: Gunther Mayer <>
Subject: Re: Failover in NFS
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2002/11/22/102

Jesse Pollard wrote:
>On Thursday 21 November 2002 02:58 pm, Bill Davidsen wrote:
> 
>
>>On Mon, 18 Nov 2002, Jesse Pollard wrote:
>> 
>>
>>>It would actually be better to use two floating IP numbers. That way
>>>during normal operation, both servers would be functioning simultaneously
>>>(based on the shared storage on two nodes).
>>>
>>>Then during failover, the floating IP of the failed node is activated on
>>>the remaining node (total of 3 IP numbers now, one real, two floating).
>>>The NFS recovery cycle should then cause the clients to remount the
>>>filesystem from the backup server.
>>>
>>>When the failed node is recovered, the active server should then disable
>>>the floating IP associated with the recovered server, causing only the
>>>mounts using that IP number to fall back to the proper node, balancing
>>>the load again.
>>> 
>>>
>>That works for stateless connections, but for stateful connections like
>>POP, NNTP, SMTP, etc, you will lose all the connections currently
>>actively.
>> 
>>
>
>yes. That is the point. NFS v3/4 CAN use TCP connections. The only way
>I know to force them back to the recovered server IS to kill the connection.
>
NFS over TCP does work very well for such failover configurations with a 
virtual IP address.
To the NFS client a failover is indistinguishable from a server 
crash+reboot which
is guaranteed to work by NFS standard definition.
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.kernel.org
More majordomo info at  
http://vger.kernel.org/majordomo-info.html
Please read the FAQ at  
http://www.tux.org/lkml/