Date: Tue, 13 Sep 2005 15:14:59 +0200
From: Andreas Jellinghaus <>
Subject: Re: [udev/vcs] tons of creating/removing /dev/vcs* during boot
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2005/9/13/126

Greg KH wrote:
>> Best would be of course to generate only a single event at the same
>> time the tty device is create.
> 
> That's what you are seeing.  And then watching as it's being destroyed.
> And then created.  And then destroyed.  And so on (virtual ttys are
> nasty at times..)
wait a second, the kernel code opens /dev/console before running
init. so that should trigger that first hotplug event. and if
init is a process that does not close stdin/out/err, there should
not be any additional hotplug event, right?
I know for sure that some gentoo machine created > 3000 hotplug
events during bootup. I'm note sure if the init closed stdin/out/err,
and that installation was replaced by debian anyway, but it sure
killed the machine, if I hadn't disabled hotplugging (3000 bash
processes need more ram than a normal machine has).
init strarts processes and those sure have stdin/out/err open,
so they can write to the console. so I somehow doubt it closes
and opens those all the time, but I haven't checked the code.
so I wonder: is or was there any bug in the kernel where hundreds
or thousands of hotplug requests are created, simply because
processed are executed? 
it is a fact I saw thousands of hotplug events during a boot sequence.
I'd like to know why that happened, and whether it would happen again.
rm -rf /sbin/hotplug and switching to udevd is once option to solve
the problem, but not an explanation why it happened in the first place.
Regards, Andreas
p.a. I don't use udevd, but my initramfs disables hotplug and
the last initscript enables it again. also works ok.
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.kernel.org
More majordomo info at  
http://vger.kernel.org/majordomo-info.html
Please read the FAQ at  
http://www.tux.org/lkml/