Date: Tue, 14 Mar 2000 11:26:09 -0500 (EST)
From: Alexander Viro <>
Subject: Re: (reiserfs) Re: patch: reiserfs for 2.3.49
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2000/3/15/188

On Tue, 14 Mar 2000, Chris Mason wrote:
> We agree, these fixes have already started.  We'll send them to you as
> they stabilize.  I would much rather have your help getting rid of
> read_inode2 than cleaning up our other messes ;-)
I need to get fhandle_to_dentry() stable on ext2. From the look at your
code there should be no serious problems with that stuff.
> > 	d) could you please convert symlink.c to pagecache? BTW, that
> > would kill ugly REISERFS_KERNEL_MEM/REISERFS_USER_MEM stuff.
> 
> I'll look into this.  I'm not sure it is possible to do it right until we
> convert all metadata into the page cache, which we are looking into as
> well.
Umm... I don't think that it is related. Just define ->readpage() for
symlinks and let it do kmap(), read the body of symlink into the page and
then either SetPageUptodate(),kunmap(),UnlockPage(),return 0 or
SetPageError(), kunmap(), UnlockPage(), return <suitable_error> (if
reading failed, that is). That's it. If your symlink inodes have that in
->i_mapping->a_op->readpage you can just use page_readlink() and
page_follow_link() in inode_operations. And you get caching of the thing
for free.
Where and how you take the data from is completely your business - just
make sure that it _ends_ _up_ in the page. If you have something like
"fast" symlinks (a-la FFS and its kin) - see how ext2 handles that case.
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.rutgers.edu
Please read the FAQ at 
http://www.tux.org/lkml/