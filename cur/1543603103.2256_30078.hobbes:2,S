Date: Mon, 1 Oct 2001 10:03:43 -0400
From: Greg Ward <>
Subject: Re: "hde: timeout waiting for DMA": message gone, same behaviour
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2001/10/1/80

On 21 September 2001, I said:
> Having problems with an ATA/100 drive under Linux 2.4.{2,9}.
[...]
>   Partition check:
>    hda:hda: timeout waiting for DMA
>   ide_dmaproc: chipset supported ide_dma_timeout func only: 14
>   hda: irq timeout: status=0x58 { DriveReady SeekComplete DataRequest }
>   [...repeat 2 times...]
>   hda: DMA disabled
>   ide0: reset: success
>    hda1
After a lengthy thread with many helpful tips from lots of people, I
have resolved this problem.  It was a bad hard drive after all.  I tried
the drive in two separate computers, with four operating systems (Linux,
Windows 98, MS-DOS, and DR-DOS).
  * Linux had the problems described ("DMA timeout" message)
  * Windows 98 didn't complain or have lengthy timeouts, but it
    turned DMA off on the drive in question
  * MS-DOS (version 5.0 and 6.22, booted from a floppy) crashed cold on
    bootup -- probably as soon as it tried to read the MBR of the disk
  * DR-DOS didn't complain or crash
In my humble estimation, Linux 2.4.9 and 2.4.10 deal with this "DMA
timeout" problem about as well as can be expected.  One revision the
kernel IDE folks might consider is that, as soon as a DMA timeout is
detected, turn off DMA on the affected drive.  This is what Linux 2.4.2
did, and it at least avoided repeating the lengthy timeout delays I
experienced with 2.4.2 on bootup.  With 2.4.9/10, the timeout delay
repeated every time I accessed the drive until I explicitly turned DMA
off with "hdparm -d0".
Many thanks to all who had suggestions and ideas.  I love the Linux
community, almost as much as I hate flaky hardware.  ;-)
        Greg
-- 
Greg Ward - programmer-at-large                         gward@python.net
http://starship.python.net/~gward/
Life is too short for ordinary music.
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.kernel.org
More majordomo info at  
http://vger.kernel.org/majordomo-info.html
Please read the FAQ at  
http://www.tux.org/lkml/