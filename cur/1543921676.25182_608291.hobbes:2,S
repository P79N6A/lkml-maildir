Date: Mon, 22 Oct 2007 13:47:14 -0600
From: Matthew Wilcox <>
Subject: Re: [PATCH 1/2] irq_flags_t: intro and core annotations
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2007/10/22/275

On Mon, Oct 22, 2007 at 09:10:34PM +0200, Arnd Bergmann wrote:
> On a related note, should we encourage the use of spin_lock() and
> spin_lock_irq() instead of spin_lock_irqsave() where possible?
spin_lock(), certainly.  On PowerPC, I'm reliably informed it's fewer
instructions to save/restore than it is to disable/enable.  So no clear
advantage there.
> On some architectures, accessing the interrupt flag is a heavyweight
> operation, especially when running under a hypervisor, so a number
> of drivers could benefit from being converted to not save the flags
> at all instead of just changing the type of the flags variable.
We certainly don't want to encourage people to blindly make those
conversions ... and I've seen the results of encouraging kernel janitors
to do things a certain way.
-- 
Intel are signing my paycheques ... these opinions are still mine
"Bill, look, we understand that you're interested in selling us this
operating system, but compare it to ours.  We can't possibly take such
a retrograde step."
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.kernel.org
More majordomo info at  
http://vger.kernel.org/majordomo-info.html
Please read the FAQ at  
http://www.tux.org/lkml/