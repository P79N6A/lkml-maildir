Date: Thu, 6 Jul 2006 11:45:04 +1000
From: Nigel Cunningham <>
Subject: Re: [klibc 30/31] Remove in-kernel resume-from-disk invocation code
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2006/7/5/318

Hi.
On Thursday 06 July 2006 10:54, H. Peter Anvin wrote:
> Nigel Cunningham wrote:
> > Ah. So it's still valid to have resume= and noresume on the commandline,
> > and klibc greps /proc/cmdline?
>
> Correct.
>
> > So, for Suspend2, would I be ok just leaving people to add the echo
> >
> >>/proc/suspend2/do_resume, as we currently do for initrds and initramfses?
>
> Well, presumably you want to adjust kinit so that it invokes
> /proc/suspend2/do_resume, instead of or in addition to
> /sys/power/resume; see usr/kinit/resume.c (the code should be bloody
> obvious, I hope...)
It is.
Is there a klibc howto somewhere? I tried googling for 'klibc howto', reading 
the files in Documentation/ and browsing your klibc mailing list archive 
before asking!
What I'm wondering specifically is: Say a user needs to run some commands to 
set up access to encrypted storage before they can resume. At the moment, 
we'd tell them to put these commands and the echo > do_resume in their 
linuxrc (or init) script prior to mounting their root filesystem. Forgive me 
if I'm asking a stupid question but it's not immediately obvious to me how 
they would now do that. I'd much rather follow a simple howto than spend a 
good amount of time tracing function calls etc. I still see init/initramfs.c, 
and it mentions both CONFIG_BLK_DEV_INITRD and CONFIG_BLK_DEV_RAM. Would I be 
right in surmising that you can still have an initrd or ramfs to do such 
things as the above, after klibc has done its work? If not, is there some 
other way I'm ignorant of?
Regards,
Nigel
-- 
Nigel, Michelle and Alisdair Cunningham
5 Mitchell Street
Cobden 3266
Victoria, Australia
[unhandled content-type:application/pgp-signature]