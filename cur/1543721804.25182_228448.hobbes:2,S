Date: Sat, 19 Jun 2004 00:03:26 +0200
From: Andi Kleen <>
Subject: Re: [PATCH] Add kallsyms_lookup() result cache
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2004/6/18/288

On Fri, 18 Jun 2004 15:03:00 -0500
Brent Casavant <bcasavan@sgi.com> wrote:
> On 2.6 based systems, the top command utilizes /proc/[pid]/wchan to
> determine WCHAN symbol name information.  This information is provided
> by the kernel function kallsyms_lookup(), which expands a stem-compressed
That sounds more like a bug in your top to me. /proc/*/wchan itself
does not access kallsyms, it just outputs a number. 
My top doesn't do that.
Are you saying your top reads /proc/kallsyms on each redisplay? 
That sounds completely wrong - it should only read the file once
and cache it and then look the numbers it is reading from wchan
in the cache.
Doing the cache in the kernel is the wrong place. This should be fixed
in user space.
As an unrelated comment: i would suggest to avoid rwlocks until
absolutely needed. They are a lot slower than regular spinlocks.
-Andi
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.kernel.org
More majordomo info at  
http://vger.kernel.org/majordomo-info.html
Please read the FAQ at  
http://www.tux.org/lkml/