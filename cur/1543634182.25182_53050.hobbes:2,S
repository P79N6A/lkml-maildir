Date: Tue, 18 Jun 2002 05:18:29 -0700
From: "Adam J. Richter" <>
Subject: Various kbuild problems in 2.5.22
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2002/6/18/79

	I would like to note the following problems with the
kernel build process in 2.5.22, after applying the patch that
Kai Germaschewski posted that enabled modversions to work again.
All but the first one are spurious dependencies.
	1. doing make modversions twice results in bad .ver files, with
lines like:
#define __ver_pcmcia_get_mem_page_Rsmp_3d2ded54 smp_ba03375b
#define pcmcia_get_mem_page_Rsmp_3d2ded54       _set_ver(pcmcia_get_mem_page_Rsmp_3d2ded54)
	...which should be:
#define __ver_pcmcia_get_mem_page smp_ba03375b
#define pcmcia_get_mem_page       _set_ver(pcmcia_get_mem_page)
	2. "make bzImage" does not build a bzImage if any module fails
to compile.  Really, it should not attempt to buidl modules or even
descend into directories that contain only modules.  To build a bzImage,
I have to edit the Makefile and comment out "BUILD_MODULES:=1".
	3. make include/linux/modversios.h aborts if any .c file has
a #error or #include's a .h that is not present (for example, because
the .h is built by the process, as is the case with one scsi driver).
	4. "make -k modules" will not build perfectly buildable modules
in a directory that has a subdirectory where a compile error occurs.
	All of this used to work a couple of kernel versions ago.
Adam J. Richter     __     ______________   575 Oroville Road
adam@yggdrasil.com     \ /                  Milpitas, California 95035
+1 408 309-6081         | g g d r a s i l   United States of America
                         "Free Software For The Rest Of Us."
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.kernel.org
More majordomo info at  
http://vger.kernel.org/majordomo-info.html
Please read the FAQ at  
http://www.tux.org/lkml/