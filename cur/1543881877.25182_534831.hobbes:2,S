Date: Wed, 25 Apr 2007 11:18:12 -0700
From: Jeremy Fitzhardinge <>
Subject: Re: [PATCH] i386: For debugging, make the initial page table setup less forgiving.
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2007/4/25/322

Eric W. Biederman wrote:
> "H. Peter Anvin" <hpa@zytor.com> writes:
>
> 
>> Andrew Morton wrote:
>>
>> 
>>> This patch causes oopses after a minute or so running LTP's
>>>
>>> ./testcases/bin/growfiles -W gf16 -b -e 1 -i 0 -L 120 -u -g 4090 -T 100 -t
>>> 
>> 408990 -l -C 10 -c 1000 -S 10 -f Lgf02_
>> 
>>> on everyone's favoutite Vaio, configured with
>>> 
http://userweb.kernel.org/~akpm/config-sony.txt
>>>
>>> 
>> *BLINK*
>>
>> This patch only affects the initial page tables, which should have been
>> thrown out *way* long ago at this point.
>> 
>
> Yes.  I noticed this was happening a few days ago.
> I must not have mentioned it loudly enough.
> 
I might have introduced it as part of the paravirt_ops patches.  When
setting up pagetables under Xen, we need to make sure we preserve the
initial mappings Xen put in place (it starts the VM with paging enabled,
and a sane initial pagetable).  This may have leaked over into native if
it doesn't replace an existing entry.
Hm, but it should be overwriting small mappings with large ones.  Maybe
I overlooked that.
> I'm halfway through putting together a patchset to address a
> bunch of these.
>
> I haven't yet resolved how I want to allocate the pages for the
> identity mapping of the page table yet.  I can't use the bootmem
> allocate as it exists because that assumes the page is mapped
> into the address space already.
> 
Are you going to clash horribly with the paravirt pagetable setup?  We
should probably coordinate if so.
    J
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.kernel.org
More majordomo info at  
http://vger.kernel.org/majordomo-info.html
Please read the FAQ at  
http://www.tux.org/lkml/