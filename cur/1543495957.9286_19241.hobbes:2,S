Date: Sat, 15 May 1999 21:38:23 +0200
From: Pavel Machek <>
Subject: Re: Deletion of big files...
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/1999/5/17/15

Hi!
> I have noticed that when I delete a big file (say 800MB), with a rm
> command, for example, the rm command does not return until the file has
> been deleted (or so it seems). With small files, this is almost
> inmediate, but with files which are say 800 megs in size, this can
> easily be 10 seconds (_seconds_, it's right) till I get the prompt
> again, on a P2-333.
> 
> In other Unices, like IRIX, the rm command returns _inmediately_, no
> matter the size of the file.
> 
> Looks to me like the unlink syscall is somewhat synchronous, and it
> shouldn't, or does it? For this concrete issue, it could be easily
> solved by the unlink syscall starting a thread to unlink the big file,
> while the rest of the system keeps running normally. But I suppose it's
> not only an issue of the unlink syscall, but more...
> 
> I'm probably saying nonsense WRT the solution, but the problem _is_
> there. Any answers/constructive-criticisms?
Well, if you went for completely async unlink...
rm bigfile
<use of lots of disk space>
could fail due to "out of disk space", where sync remove does not have
this problem.
So it is not as easy as it seems.
								Pavel
PS: I could imagine Irix being faster not because asynchrony, but
because their fs is more effective for this concrete issue.
-- 
I'm really pavel@ucw.cz. Look at 
http://195.113.31.123/~pavel.
          Pavel
Hi! I'm a .signature virus! Copy me into your ~/.signature to help me spread!
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.rutgers.edu
Please read the FAQ at 
http://www.tux.org/lkml/