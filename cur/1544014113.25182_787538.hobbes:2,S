Date: Tue, 6 Jan 2009 20:37:09 +0530
From: Vaidyanathan Srinivasan <>
Subject: Re: [PATCH v7 0/8] Tunable sched_mc_power_savings=n
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2009/1/6/169

* Mike Galbraith <efault@gmx.de> [2009-01-06 10:31:37]:
> On Mon, 2009-01-05 at 16:19 +0100, Mike Galbraith wrote:
> > On Mon, 2009-01-05 at 07:37 +0100, Mike Galbraith wrote:
> > 
> > > I'll rummage around.
> > 
> > Seems to be about the only thing it could be, load balancing inflicting
> > injury on very sensitive mysql+oltp pairs.
> 
> BTW, I verified this.  Reverting all load-balancing changes fully
> restored mysql+oltp peak, and brought mid-range throughput to the same
> level as sched_mc=2 except at the log-jam end.  (haven't looked at
> vmark, though I'd expect it to be hurting a bit too, it's affinity
> sensitive as well)
> 
> I expected sched_mc=2 to help an nfs mount kbuild, and it did, quite a
> bit.  I first tried an nfs4 mount, but after a while, the odd ipv6 80%
> idle problem came back, so I reverted to nfs3.  Full built time there
> went from 4m25s to 4m2s.  A nice improvement.
> 
> I haven't noticed anything on the interactivity front.
> 
> Personally, I'd go for sched_mc=2 as default.  I value the fork/exec
> load much more than sensitive benchmarks, though what hurts mysql+oltp
> will certainly hurt others as well.  We have a bit of conflict between
> keeping CPUs busy and affinity cost.  Something to work on.
Hi Mike,
Thanks for the detailed benchmark reports.  Glad to hear that
sched_mc=2 is helping in most scenarios.  Though we would be tempted to
make it default, I would still like to default to zero in order to
provide base line performance.  I would expect end users to flip the
settings to sched_mc=2 if it helps their workload in terms of
performance and/or power savings.
The fact that sched_mc=2 provide performance and/or power saving
benefits is a good justification to include the new code and tunable.
The benefits from the sched_mc=2 settings vary widely based on
workload and system configuration.  Hence in my opinion, I would not
want to change the default to 2 at this time until more wide spread
use of the tunable under various workloads and system configurations.
--Vaidy