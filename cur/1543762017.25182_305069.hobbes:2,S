Date: Tue, 22 Mar 2005 18:32:41 +0100
From: Blaisorblade <>
Subject: Bug with multiple help messages, the last one is shown
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2005/3/22/188

I've verified multiple times that if we have a situation like this
bool A
depends on TRUE
help
  Bla bla1
and
bool A
depends on FALSE
help
  Bla bla2
even if the first option is the displayed one, the help text used is the one 
for the second option (the absence of "prompt" is not relevant here)!
From a very short reading of sources, I guess that the problem is probably 
located in this line (from scripts/kconfig/zconf.y):
help: help_start T_HELPTEXT
{
        current_entry->sym->help = $2;
};
because the various current_entry values (matching the various definitions) 
share the same symbol (since of the sym_lookup call below)
config_entry_start: T_CONFIG T_WORD T_EOL
{
        struct symbol *sym = sym_lookup($2, 0);
        sym->flags |= SYMBOL_OPTIONAL;
        menu_add_entry(sym);
        printd(DEBUG_PARSE, "%s:%d:config %s\n", zconf_curname(), 
zconf_lineno(), $2);
};
Now, Kconfig handles well the same situation when there are multiple different 
prompts, instead of multiple help texts.
This because the "prompt" is added as a property with its own dependency; why 
is not this done for "help", too?
-- 
Paolo Giarrusso, aka Blaisorblade
Linux registered user n. 292729
http://www.user-mode-linux.org/~blaisorblade
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.kernel.org
More majordomo info at  
http://vger.kernel.org/majordomo-info.html
Please read the FAQ at  
http://www.tux.org/lkml/