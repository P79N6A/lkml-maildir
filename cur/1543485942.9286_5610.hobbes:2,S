Date: Tue, 16 Feb 1999 16:45:37 +0900 (JST)
From: Tom Holroyd <>
Subject: Re: The "not quite valentines day release"..
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/1999/2/16/28

Alpha, EV56, type EB164 variation PC164, 128M
no SMP, CONFIG_RTC on, aic7xxx/Adaptec AHA-294X Ultra SCSI +
SCSI drive is micropolis using wide sync at 20 MB/sec. 
Kernel 2.2.2-pre4, egcs-1.1.1 compiled.
Issues (#2 and #3 have obvious workarounds, #1 is more serious):
1. Disk performance seems to have gotten worse since 2.2.1.  If I do
	% time sh -c "dd if=/dev/zero of=/tmp/moo bs=1k count=80k; sync"
2.2.2-pre4 takes 5 or 6 seconds longer (about 40%!) wall clock time
over 2.2.1.  The really significant thing is that when I do this under
2.2.2-pre4 the context switches reported by 'vmstat 1' go through the
roof: over 10,000/sec as compared with < 300 on 2.2.1.
           ^^^^^^^^^^
2. As with the rest of 2.2.x, with CONFIG_RTC on, rebooting fails -- the
machine must be halted and reset, or it hangs in Computing BogoMIPS...
This makes remote admin impossible.
Related to this is that the BogoMIPS is calculated somewhat less
accurately even when reset -- usually about 4 less than it should be.
Additional info: machine is 500 MHz, 1024 Hz timer, BogoMIPS 494.92 at the
moment, usually about 497.03 with CONFIG_RTC off.
3. Modular FS.  I've reported this before, and nobody seems to be able to
reproduce it, but since 2.1.13x or so, and including 2.2.2-pre4, I can
make the machine lock by using (say) vfat as a module.  Now, *once* I got
	CIA machine check: processor detected hard error
	vector=0x670 la_ptr=0xfffffc00002085a0 pc=0xfffffc0000420db0
while doing IO to a vfat mounted floppy, instead of a lockup, but normally
I get a lockup, and I *never* have *any* problems when the FS is not a
module.  Why would that be, if there were a hardware problem?  I'm told
that it's possible for a machine check to be generated by funky kernel IO
operations.
Lately I make it lock up by doing (with vfat as a module)
	# mformat a:
	# mount -t vfat /dev/fd0 /tmp/mnt
	# while true; do
		cp -av /usr/src/linux/arch/ppc /tmp/mnt/ppc
		ls -lR /tmp/mnt
		rm -rf /tmp/mnt/ppc
	done
and then doing something else like running postmark over NFS, or find, or
something.  I never have any problems with this when vfat is not a module,
only when vfat (and fat) are modules.  smbfs as a module also locks the
machine.  postmark (
http://www.netapp.com/technology/freeware/postmark
) is
good for stress testing this (it's just one .c file -- go for it).
Dr. Tom Holroyd
I would dance and be merry,
Life would be a ding-a-derry,
If I only had a brain.
	-- The Scarecrow
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.rutgers.edu
Please read the FAQ at 
http://www.tux.org/lkml/