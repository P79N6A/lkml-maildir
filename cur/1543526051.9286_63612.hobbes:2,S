Date: Wed, 16 Feb 2000 16:59:34 +0300 (MSK)
From:  kuznet@ms2 ...
Subject: Re: 2.3.4x softnet watchdog and (isdn) demand dialing
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2000/2/16/80

Hello!
> dev->watchdog_timeo = new_timeout;
> (is dynamically changing the timeout value officially allowed? Even from
> interrupt context?)
Why not? Only do not set it to zero, please. 8)
> When doing demand-dialing, we could temporarily increase the timeout value
> appropriately, while the watchdog keeps fulfilling its duties and might
> even reveil problems related to failed demand dialing. When the demand
> dial connection is up, we would reset the watchdog timeout to its default
> value before we call netif_wake_queue().
Listen, let's discuss this in more details. I thought about this
yesterday and found that I did not understand the problem probably.
Could you describe control flow, which you expect?
Events are: device open, dial-on-demand, packet sent etc.
The most suspicious moment is period when tbusy is set.
F.e. device should not hold it for very long time. Actually,
if dialing is long, it is better to clear queue instead of tail drop,
otherwise some datagram services, which are not supposed to block
in write(), could block for too long time. Probably, we should
make this engine more clever than it is.
Another moment: do you really understand that now packets
never achieve driver, if tbusy is set? Another difference,
which can be confusing and, seems, not clever, is that
watchdog is called even if no packets are queued. See?
Please, blame 8)
Alexey
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.rutgers.edu
Please read the FAQ at 
http://www.tux.org/lkml/