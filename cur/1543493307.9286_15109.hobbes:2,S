Date: Mon, 19 Apr 1999 10:43:51 -0700
From: Phil Blecker <>
Subject: 2.2.6 and little memory and networking
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/1999/4/19/60

   I replaced everything with 2.2.6 this week-end, and then put one machine
back to 2.0.36. I had already changed most of the computers to 2.2.5.
   One of our computers is an old 386 with 16 MB of RAM. It has been a
terminal server for a long time, and used to be the firewall for a simple
56 Kb PPP connection to an ISP as well.
   I moved the PPP connection to a faster computer with more RAM and put an
Ethernet card into the 386 (which still has an Arcnet card in it) and
installed 2.2.6 on the 386.
   The code that processes the data the dialin callers pick up would no
longer runs due to insufficient memory. I gave it more swap space. It still
didn't have enough memory. This same program runs on 2.0.35/6 without using
all the original swap space. I assume that everything but the processing
program has been swapped out. This normally happens at 3 AM, so I don't
care, except that it won't work with 2.2.6.
   At the same time, I redid the old ipfwadm to use ipchains on a different
computer. This computer is the default gateway for all the other computers.
It runs and older copy of named that has the ISP's name servers as its real
source except for the local networks (which are 192.168.1-and-2). This all
works fine while we're connected to the ISP.
   When the system was not online with the ISP with 2.0, everything was
fine. If a reference to something on the net was made, the gateway called
our ISP.
   Now, when the PPP connection drops, the Ethernet and Arcnet networks
stop working. Ping doesn't. NFS servers disappear. I can only get the
internal networks to work again by calling the ISP.
   What have I done wrong? When PPP drops, I flush all the rules from the
ipchains. ipchains -L says that everything is being accepted. I assumed
that was the problem, but I can't see what else I should be doing to keep
internal routing working when not connected to our ISP.
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.rutgers.edu
Please read the FAQ at 
http://www.tux.org/lkml/