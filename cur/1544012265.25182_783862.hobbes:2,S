Date: Thu, 25 Dec 2008 16:29:05 +0900 (JST)
From: KOSAKI Motohiro <>
Subject: Re: [patch] Performance Counters for Linux, v5
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2008/12/25/11

Hi Ingo,
Currently, -tip tree can't build on my ia64 box.
because..
>  create mode 100644 Documentation/perf-counters.txt
>  delete mode 100644 arch/x86/include/asm/intel_arch_perfmon.h
>  create mode 100644 arch/x86/include/asm/perf_counter.h
>  create mode 100644 arch/x86/kernel/cpu/perf_counter.c
>  rename arch/x86/kernel/{signal_32.c => signal.c} (74%)
>  delete mode 100644 arch/x86/kernel/signal_64.c
>  create mode 100644 include/linux/perf_counter.h
>  create mode 100644 kernel/perf_counter.c
Only x86 has <asm/perf_counter.h>.
> diff --git a/include/linux/perf_counter.h b/include/linux/perf_counter.h
> new file mode 100644
> index 0000000..ec77d16
> --- /dev/null
> +++ b/include/linux/perf_counter.h
> @@ -0,0 +1,254 @@
> +/*
> + *  Performance counters:
> + *
> + *   Copyright(C) 2008, Thomas Gleixner <tglx@linutronix.de>
> + *   Copyright(C) 2008, Red Hat, Inc., Ingo Molnar
> + *
> + *  Data type definitions, declarations, prototypes.
> + *
> + *  Started by: Thomas Gleixner and Ingo Molnar
> + *
> + *  For licencing details see kernel-base/COPYING
> + */
> +#ifndef _LINUX_PERF_COUNTER_H
> +#define _LINUX_PERF_COUNTER_H
> +
> +#include <asm/atomic.h>
> +#include <asm/perf_counter.h>
> +
<linux/perf_counter.h> depend on <asm/perf_counter.h>.
> diff --git a/include/linux/sched.h b/include/linux/sched.h
> index 55e30d1..2e15be8 100644
> --- a/include/linux/sched.h
> +++ b/include/linux/sched.h
> @@ -71,6 +71,7 @@ struct sched_param {
>  #include <linux/fs_struct.h>
>  #include <linux/compiler.h>
>  #include <linux/completion.h>
> +#include <linux/perf_counter.h>
>  #include <linux/pid.h>
>  #include <linux/percpu.h>
>  #include <linux/topology.h>
<linux/sched.h> depend on <linux/perf_counter.h>
Oops, sched.h depend on <asm/perf_counter.h>, but non x86 doesn't have it.