Date: Mon, 27 Aug 2007 22:58:04 +0200
From: 	m.kozlowski@tuxland ...
Subject: [PATCH 14/23] i915_dma.c: drm_alloc + memset to drm_zalloc
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2007/8/27/324

Signed-off-by: Mariusz Kozlowski <m.kozlowski@tuxland.pl>
 drivers/char/drm/i915_dma.c | 22680 -> 22623 (-57 bytes)
 drivers/char/drm/i915_dma.o | 134192 -> 133704 (-488 bytes)
 drivers/char/drm/i915_dma.c |    6 ++----
 1 file changed, 2 insertions(+), 4 deletions(-)
--- linux-2.6.23-rc3-mm1.orig/drivers/char/drm/i915_dma.c
+++ linux-2.6.23-rc3-mm1/drivers/char/drm/i915_dma.c
@@ -130,8 +130,6 @@ static int i915_initialize(struct drm_de
 			   drm_i915_private_t * dev_priv,
 			   drm_i915_init_t * init)
 {
-	memset(dev_priv, 0, sizeof(drm_i915_private_t));
-
 	dev_priv->sarea = drm_getsarea(dev);
 	if (!dev_priv->sarea) {
 		DRM_ERROR("can not find sarea!\n");
@@ -263,9 +261,9 @@ static int i915_dma_init(DRM_IOCTL_ARGS)
 	switch (init.func) {
 	case I915_INIT_DMA:
-		dev_priv = drm_alloc(sizeof(drm_i915_private_t),
+		dev_priv = drm_zalloc(sizeof(drm_i915_private_t),
 				     DRM_MEM_DRIVER);
-		if (dev_priv == NULL)
+		if (!dev_priv)
 			return DRM_ERR(ENOMEM);
 		retcode = i915_initialize(dev, dev_priv, &init);
 		break;
--
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.kernel.org
More majordomo info at  
http://vger.kernel.org/majordomo-info.html
Please read the FAQ at  
http://www.tux.org/lkml/