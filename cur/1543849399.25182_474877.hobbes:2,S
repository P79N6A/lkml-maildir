Date: Fri, 20 Oct 2006 12:15:59 +0900
From: Tejun Heo <>
Subject: Re: 2.6.19-rc2-mm2 AHCI lengthy pause on detection
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2006/10/19/448

Berck E. Nash wrote:
> AHCI pauses heartily on during detection boot, but eventually proceeds. 
>  This problem currently exists with 2.6.19-rc2-mm1, but did not exist in 
> 2.6.17.3.  I realize that's a huge gap, and if you'd like me to narrow 
> it down, I'll be glad to try.
Can you try the attached patch?  And please post the result of hdparm -I 
/dev/sdX.
-- 
tejun
diff --git a/drivers/ata/ahci.c b/drivers/ata/ahci.c
index 2592912..8215139 100644
--- a/drivers/ata/ahci.c
+++ b/drivers/ata/ahci.c
@@ -278,8 +278,7 @@ static const struct ata_port_info ahci_p
 	{
 		.sht		= &ahci_sht,
 		.flags		= ATA_FLAG_SATA | ATA_FLAG_NO_LEGACY |
-				  ATA_FLAG_MMIO | ATA_FLAG_PIO_DMA |
-				  ATA_FLAG_SKIP_D2H_BSY,
+				  ATA_FLAG_MMIO | ATA_FLAG_PIO_DMA,
 		.pio_mask	= 0x1f, /* pio0-4 */
 		.udma_mask	= 0x7f, /* udma0-6 ; FIXME */
 		.port_ops	= &ahci_ops,