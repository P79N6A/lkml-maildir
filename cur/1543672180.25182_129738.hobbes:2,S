Date: Mon, 05 May 2003 21:51:04 +1000
From: Douglas Gilbert <>
Subject: Re: illegal context for sleeping ... rmmod ide-cd + ide-scsi
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2003/5/5/62

Andrew Morton wrote:
> Douglas Gilbert <dougg@torque.net> wrote:
> 
>>In lk 2.5.69 (and in 68) both the ide-cd and ide-scsi
>>modules generate a "sleeping function called from illegal
>>context" stack trace when removed.
>>
>>After "rmmod ide-cd" this appears:
>>  Debug: sleeping function called from illegal context
>>         at include/asm/semaphore.h:119
>>  Call Trace:
>>   [<c011dcec>] __might_sleep+0x5c/0x70
> 
> 
> ide_unregister_subdriver() does spin_lock_irqsave(&ide_lock), then
> calls auto_remove_settings(), which does down(&ide_setting_sem);
> 
> A simple fix might be:
Andrew,
Thanks. That patch clears the reported problem.
Doug Gilbert
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.kernel.org
More majordomo info at  
http://vger.kernel.org/majordomo-info.html
Please read the FAQ at  
http://www.tux.org/lkml/