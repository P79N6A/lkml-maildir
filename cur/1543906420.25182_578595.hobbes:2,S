Date: Thu, 02 Aug 2007 10:40:20 -0600
From: Robert Hancock <>
Subject: Re: serial flow control appears broken
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2007/8/2/249

Mark Lord wrote:
>> I think that PIO transfers only have to be done with interrupts 
>> disabled on really old, evil controllers (without unmask set). I don't 
>> think libata ever disables interrupts during transfers(?)
> 
> That's what "hdparm -u1" (or -u0) controls.
> 
> But it doesn't matter a whit here.  The problem is that the IDE interrupt
> handling can take a long time, regardless of whether it unmasks IRQs or 
> not.
> And if that IDE interrupt interrupts a serial interrupt, then the serial
> stuff won't get handled until the IDE stuff completes.  Thus the problem.
> 
> The "fix" could be to have the serial IRQ handler never unmask interrupts,
> but that's a bit unsociable to others.  The IDE stuff really needs to not
> do so much during the actual IRQ handler.
> 
> Ingo's RT patches would probably fix all of this.
libata also doesn't do the actual PIO transfer from the interrupt 
handler like old IDE does, either, and it only disables interrupts for 
the transfer if it's transferring to/from high memory..
-- 
Robert Hancock      Saskatoon, SK, Canada
To email, remove "nospam" from hancockr@nospamshaw.ca
Home Page: 
http://www.roberthancock.com/
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.kernel.org
More majordomo info at  
http://vger.kernel.org/majordomo-info.html
Please read the FAQ at  
http://www.tux.org/lkml/