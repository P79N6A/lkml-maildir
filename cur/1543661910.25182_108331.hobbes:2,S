Date: Sun, 09 Feb 2003 15:18:46 -0800
From: David Ford <>
Subject: Current NFS issues (2.5.59)
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2003/2/9/113

Ok.  Here goes.  I have two servers that NFS mount from each other and 
provide.
Server 1 exports A, B, and C to server 2.  Server 2 exports D and E back 
to server 1 and exports F and G to two other clients.  Each of these 
(A-G) are distinctly different filesystem paths and not part of each other.
1. If server 1 is restarted, server 2 will invalidate (make all 'df' 
values '1') F and G.  This requires an 'exportfs -vra' or similar on 
server 2 to fix the client 'df' values.  The client doesn't need to do 
anything.
2. Repeated nfs system stops and starts (/etc/init.d/nfs restart) will 
eventually cause a kernel panic on server 2 (haven't tested on server 
1).   The number of restarts is variable.
3. Mount point F (/home/david) infrequently loops.  ls -la /home/david 
will loop forever until all client memory is exhausted and the kernel 
kills it via OOM.  ls -la /home/david/somefile or /home/david/somedir/ 
works just fine as well as any sub directory under /home/david.  
Restarts of both systems refuse to fix things.
4. Mounts infrequently get "permission denied" messages on the client 
with a " rpc.mountd: getfh failed: Operation not permitted" message on 
the server.  This is fixable by restarting the nfs system on the server.
Server1 is UNI, server 2 is SMP.  All servers and clients are stock 
2.5.59[1].  NFS is running on top of Reiserfs filesystems on all client 
and server machines.
I'll be happy to apply test patches to either clients or servers.
David
[1] One client is 2.5.56 but it rarely accesses the NFS mount unlike the 
other machines which use them constantly
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.kernel.org
More majordomo info at  
http://vger.kernel.org/majordomo-info.html
Please read the FAQ at  
http://www.tux.org/lkml/