Date: Fri, 09 Jan 2009 11:17:38 -0800
From: "H. Peter Anvin" <>
Subject: Re: [patch] measurements, numbers about CONFIG_OPTIMIZE_INLINING=y impact
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2009/1/9/265

Richard Guenther wrote:
> On Fri, Jan 9, 2009 at 8:21 PM, Andi Kleen <andi@firstfloor.org> wrote:
>>> GCC 4.3 should be good in compiling the
>>> kernel with default -Os settings.
>> It's unfortunately not. It doesn't inline a lot of simple asm() inlines
>> for example.
> 
> Reading Ingos posting with the actual numbers states the opposite.
> 
Well, Andi's patch forcing inlining of the bitops chops quite a bit of 
size off the kernel, so there is clearly room for improvement.  From my 
post yesterday:
: voreg 64 ; size o.*/vmlinux
    text    data     bss     dec     hex     filename
57590217 24940519 15560504 98091240 5d8c0e8 o.andi/vmlinux
59421552 24912223 15560504 99894279 5f44407 o.noopt/vmlinux
57700527 24950719 15560504 98211750 5da97a6 o.opty/vmlinux
110 KB of code size reduction by force-inlining the small bitops.
	-hpa