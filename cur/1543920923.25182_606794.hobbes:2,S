Date: Thu, 18 Oct 2007 11:04:50 +0200
From: Jiri Slaby <>
Subject: bad reads from pci bars after inserting card [Was: card details]
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2007/10/18/94

On 10/18/2007 10:51 AM, S. Vishnu Priya wrote:
> Thankyou so much for your valuable suggestions.
> 
> I have gone through the link. In the configuration space we will be
> having the total size for each Bar regions. When i insert my card in the
> pci slot i am getting one set of address for the BAR regions. With that
So if I understand correctly, you have a pci hotplug capable mainboard? Or what
do you insert and where?
> address as the base address i did memory mapping and try to access FPGA
> registers i couldn't access. Some junk data's are coming. For this
> problem if i reboot my PC, i am getting the another set of address and
> follow the same procedure. I am able to access all my FPGA registers.
> 
> So for the first time i am not getting address properly. Once reboot i
> can able to retrieve the values. Can you clarify me where the problem
> could be?
Hmm, me no, Cc-ing Greg and lkml.
Maybe outputs from lspci -vvxxx would be good when you plug the card in and
after reboot. I suspect the card is not reset somehow rather than pci layer, so
that the plx bridge doesn't translate the reads/writes correctly.
> On 10/18/2007 10:17 AM, S. Vishnu Priya wrote:
>>    Actually i mean to ask this question. Through the below codings we
>> can retrieve the details through our driver. My doubt is, once our card
>> has been inserted in the PCI slot we can able to see some information of
>> our card in this file /proc/bus/pci/devices.
>>
>>> From where kernel will get these details from the card ie from EEPROM or
>> from some other register?
> 
> see the second link and the line above it...
> 
>> It prints the contents of pci_dev structures:
>> 
http://www.linux-m32r.org/lxr/http/source/drivers/pci/proc.c#L335
>> which is retrieved from pci config space; mostly everything from here:
>> 
http://www.linux-m32r.org/lxr/http/source/drivers/pci/probe.c
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.kernel.org
More majordomo info at  
http://vger.kernel.org/majordomo-info.html
Please read the FAQ at  
http://www.tux.org/lkml/