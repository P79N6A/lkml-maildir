Date: Thu, 3 May 2007 03:33:03 +0800
From: WANG Cong <>
Subject: Re: [RELEASE] Lguest for 2.6.21
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2007/5/2/431

Hi Rusty!
I found you forgot to check the return value of copy_from_user, and here is the fix for drivers/lguest/interrupts_and_traps.c.
Signed-off-by: WANG Cong <xiyou.wangcong@gmail.com>
---
--- linux-2.6.21-rc7-mm2/drivers/lguest/interrupts_and_traps.c.orig	2007-05-03 03:10:44.000000000 +0800
+++ linux-2.6.21-rc7-mm2/drivers/lguest/interrupts_and_traps.c	2007-05-03 03:11:42.000000000 +0800
@@ -75,7 +75,8 @@ void maybe_do_interrupt(struct lguest *l
 		set_bit(0, lg->irqs_pending);
 
 	/* Mask out any interrupts they have blocked. */
-	copy_from_user(&blk, lg->lguest_data->blocked_interrupts, sizeof(blk));
+	if (copy_from_user(&blk, lg->lguest_data->blocked_interrupts, sizeof(blk)))
+		return;
 	bitmap_andnot(blk, lg->irqs_pending, blk, LGUEST_IRQS);
 
 	irq = find_first_bit(blk, LGUEST_IRQS);
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.kernel.org
More majordomo info at  
http://vger.kernel.org/majordomo-info.html
Please read the FAQ at  
http://www.tux.org/lkml/