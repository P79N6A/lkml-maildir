Date: Mon, 15 Sep 2003 00:10:24 +0200
From: Andries Brouwer <>
Subject: Re: Another keyboard woes with 2.6.0...
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2003/9/14/130

On Sun, Sep 14, 2003 at 09:52:16PM +0200, Petr Vandrovec wrote:
> > Hmm. Yes. An F7 that is never released.
> > Is that what you see - an infinitely repeated F7 until
> > you hit the next key?
> 
> Yes. It is what I was trying to tell by "confuses everything".
> 
> > And the 0x41 is generated by this switch?
> 
> Yes.
> 
> > And it also occurs on 2.4 but there nothing bad happens?
> 
> It looks to me like that it does. We get one 0x41 when we
> send ED 00, and second time after enabling keyboard by F4,
> like 2.6.x does... But it is not that serious under 2.4.x...
No - it is sent only once (and, I suppose, gives a little bit of garbage
to whatever process eats it in 2.4) but in 2.6 it is repeated.
A separate micro project might be to find out precisely when this
switch sends this code, and whether it can send other codes.
To save this machine for 2.6 no doubt you can invent something
most suitable for you. Replacing input.c:input_repeat_key()
by a dummy routine kills all key repeat.
The key that is repeated is dev->repeat_key, and we have the
keycode there if I am not mistaken, not the scancode, but they
are equal in this case, so you might also add
	if (dev->repeat_key == 65)
		return;
at the start of input_repeat_key().
In the mean time we must invent a real solution instead of a stopgap.
Andries
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.kernel.org
More majordomo info at  
http://vger.kernel.org/majordomo-info.html
Please read the FAQ at  
http://www.tux.org/lkml/