Date: Fri, 20 May 2005 21:30:05 -0400
From: Lee Revell <>
Subject: Re: [PATCH] Fixes for IPMI use of timers
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2005/5/20/211

On Fri, 2005-05-20 at 18:14 -0700, George Anzinger wrote:
> >  		/* We already have irqsave on, so no need for it
> >                     here. */
> > -		read_lock(&xtime_lock);
> > +		read_lock_irqsave(&xtime_lock, flags);
> 
> I rather hope this fails to compile :)  xtime_lock is a sequence lock in the 2.6 
> kernel.
> 
> >  		jiffies_now = jiffies;
> >  		smi_info->si_timer.expires = jiffies_now;
> >  		smi_info->si_timer.sub_expires = get_arch_cycles(jiffies_now);
> > +		read_unlock_irqrestore(&xtime_lock, flags);
The old code clearly has an unbalanced lock/unlock, maybe it's
sufficient to just fix that?
Lee
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.kernel.org
More majordomo info at  
http://vger.kernel.org/majordomo-info.html
Please read the FAQ at  
http://www.tux.org/lkml/