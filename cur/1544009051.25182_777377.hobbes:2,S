Date: Fri, 5 Dec 2008 13:04:37 +0000 (GMT)
From: Hugh Dickins <>
Subject: Re: [PATCH] shmem: remove unused shmem_get_unmapped_area
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2008/12/5/142

On Thu, 4 Dec 2008, Matt Mackall wrote:
> Signed-off-by: Matt Mackall <mpm@selenic.com>
Acked-by: Hugh Dickins <hugh@veritas.com>
(Really, ramfs_nommu_get_unmapped_area() should be made static
in fs/ramfs/file-nommu.c, and its extern removed from ramfs.h;
but I notice it's used before it's declared, and my current
record at messing up Andrew with build errors is not very good,
so I'd rather leave that to someone who builds with NOMMU.)
> 
> diff -r b4d73844205b -r 8a9f1e9c46e8 include/linux/mm.h
> --- a/include/linux/mm.h	Wed Dec 03 16:45:56 2008 -0800
> +++ b/include/linux/mm.h	Mon Oct 27 17:33:21 2008 -0500
> @@ -717,14 +717,6 @@
> 
>  int shmem_zero_setup(struct vm_area_struct *);
> 
> -#ifndef CONFIG_MMU
> -extern unsigned long shmem_get_unmapped_area(struct file *file,
> -					     unsigned long addr,
> -					     unsigned long len,
> -					     unsigned long pgoff,
> -					     unsigned long flags);
> -#endif
> -
>  extern int can_do_mlock(void);
>  extern int user_shm_lock(size_t, struct user_struct *);
>  extern void user_shm_unlock(size_t, struct user_struct *);
> diff -r b4d73844205b -r 8a9f1e9c46e8 mm/tiny-shmem.c
> --- a/mm/tiny-shmem.c	Wed Dec 03 16:45:56 2008 -0800
> +++ b/mm/tiny-shmem.c	Mon Oct 27 17:33:21 2008 -0500
> @@ -121,14 +121,3 @@
>  {
>  	return 0;
>  }
> -
> -#ifndef CONFIG_MMU
> -unsigned long shmem_get_unmapped_area(struct file *file,
> -				      unsigned long addr,
> -				      unsigned long len,
> -				      unsigned long pgoff,
> -				      unsigned long flags)
> -{
> -	return ramfs_nommu_get_unmapped_area(file, addr, len, pgoff, flags);
> -}
> -#endif
> 
> -- 
> Mathematics is the supreme nostalgia of our time.