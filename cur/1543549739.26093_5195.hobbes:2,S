Date: Mon, 25 Sep 2000 21:55:57 -0400 (EDT)
From: jamal <>
Subject: Re: [PATCH/RFC] (long) network interface changes
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2000/9/25/125

On Mon, 25 Sep 2000, Henner Eisen wrote:
> >>>>> "jamal" == jamal  <hadi@cyberus.ca> writes:
>     jamal> So i would prefer to leave this turned off. Infact i was
>     jamal> hoping to take it off for the final code submission. If you
>     jamal> insist, it could be left there and enabled during
> 
> No, I donÅ½t insist. This was just some brain-storming ;).
> 
I'll just leave it in but disable it. Davem may choose to remove it.
It is the cheapest solution so far that has been experimented with.
Rusty had some interesting ideas on this as well ...
> I think setting CN bits appropriatlely is the task of the upper
> layer protocol anyway. The only thing is that the upper layers need
> to know whether the input queue is congested. Maybe the netif_rx() code
> could set an skb->rx_congested bit when it delivers packets to the
> upper layer while the backlog queue is in congested state. (Maybe not
> really necessary, the upper layer could also query the congestion state
> by atomic_read(&netdev_dropping)).
Interesting and quiet applicable to Frame Relay, for example; what do you
see other apps/protos using it for? Would TCP for example delay ACKs or
delay delivery of data? 
Actually, the more i think about it i realize that the rx_congested mark
might not be an accurate reflection of the situation when the skb gets to
the protocol/app. It will depend on when the rx softirq gets scheduled by
which time the information might not be accurate anymore.
It will probably also not make much sense in SMP (where one congested CPU
might not necessarily mean the rest are congested).
BTW, I checked the return values of the protocols which you had
concerns with and i believe there are not reflective of the
situation and there are a few semantical issues
eg ip_rcv()
on error returns 0. 0 is generally refered to as 'success' in other parts
of the code.
the good news is that no-code cares about/checks these return values.
I'll submit the current patch and maybe later submit another where the
protocols use things like NET_RX_SUCCESS etc
cheers,
jamal
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.kernel.org
Please read the FAQ at 
http://www.tux.org/lkml/