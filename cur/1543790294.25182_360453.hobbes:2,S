Date: Wed, 26 Oct 2005 19:10:38 +0300
From: "andrei.popa" <>
Subject: "arp -s ip mac" doesn't work with newer kernels
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2005/10/26/85

"arp -s ip mac" doesn't work:
I assign a static MAC to an IP, and if that IP changes his MAC, the
connection with the server still works. In previous kernels if the MAC
was different from the MAC assigned in "arp -s IP MAC" the client didn't
see the server, so no traffic was done between the client and the
server.
inoxid ~ # uname -a
Linux inoxid 2.6.13.1-inoxid17 #4 SMP Sun Sep 18 07:37:20 EEST 2005 i686
Pentium III (Coppermine) GenuineIntel GNU/Linux
(static entry done with "arp -s 85.120.33.151 00:11:D8:5F:91:9B" )
inoxid ~ # arp -an 85.120.33.151
? (85.120.33.151) at 00:11:D8:5F:91:9B [ether] PERM on eth1
inoxid ~ # arping -I eth1 85.120.33.151
ARPING 85.120.33.151 from 85.120.33.1 eth1
Unicast reply from 85.120.33.151 [00:11:D8:5F:8A:BD]  1.685ms
Unicast reply from 85.120.33.151 [00:11:D8:5F:8A:BD]  1.893ms
Sent 2 probes (1 broadcast(s))
Received 2 response(s)
inoxid ~ # tcpdump -i eth1 -e src host 85.120.33.151 -n
tcpdump: verbose output suppressed, use -v or -vv for full protocol
decode
listening on eth1, link-type EN10MB (Ethernet), capture size 68 bytes
19:07:59.044205 00:11:d8:5f:8a:bd > 00:b0:d0:49:24:87, ethertype IPv4
(0x0800), length 1514: IP 85.120.33.151.25693 > 81.18.71.253.54062: .
3046778176:3046779636(1460) ack 3121120561 win 65256
19:07:59.044236 00:11:d8:5f:8a:bd > 00:b0:d0:49:24:87, ethertype IPv4
(0x0800), length 1514: IP 85.120.33.151.25693 > 81.18.71.253.54062: .
1460:2920(1460) ack 1 win 65256
19:07:59.048841 00:11:d8:5f:8a:bd > 00:b0:d0:49:24:87, ethertype IPv4
(0x0800), length 1514: IP 85.120.33.151.25693 > 84.234.110.106.3602: .
4280281117:4280282577(1460) ack 113703100 win 64982
19:07:59.048954 00:11:d8:5f:8a:bd > 00:b0:d0:49:24:87, ethertype IPv4
(0x0800), length 1514: IP 85.120.33.151.25693 > 84.234.110.106.3602: .
1460:2920(1460) ack 1 win 64982
19:07:59.052030 00:11:d8:5f:8a:bd > 00:b0:d0:49:24:87, ethertype IPv4
(0x0800), length 1514: IP 85.120.33.151.25693 > 84.234.110.106.3602: .
2920:4380(1460) ack 1 win 64982
19:07:59.052155 00:11:d8:5f:8a:bd > 00:b0:d0:49:24:87, ethertype IPv4
(0x0800), length 1514: IP 85.120.33.151.25693 > 84.234.110.106.3602: .
4380:5840(1460) ack 1 win 64982
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.kernel.org
More majordomo info at  
http://vger.kernel.org/majordomo-info.html
Please read the FAQ at  
http://www.tux.org/lkml/