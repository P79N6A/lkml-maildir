Date: Tue, 30 May 2006 12:53:58 -0700
From: Ashok Raj <>
Subject: Re: [patch 00/61] ANNOUNCE: lock validator -V1
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2006/5/30/298

On Tue, May 30, 2006 at 03:39:47PM -0400, Dave Jones wrote:
> So, that last part pretty highlights that we knew about this problem, and meant to
> come back and fix it later. Surprise surprise, no one came back and fixed it.
> 
There was another iteration after his, and currently we keep track of
the owner in lock_cpu_hotplug()->__lock_cpu_hotplug(). So if we are in 
same thread context we dont acquire locks.
    if (lock_cpu_hotplug_owner != current) {
        if (interruptible)
            ret = down_interruptible(&cpucontrol);
        else
            down(&cpucontrol);
    }
the lock and unlock kept track of the depth as well, so we know when to release
We didnt hear any better suggestions (from cpufreq folks), so we left it in 
that state (atlease the same thread doenst try to take the lock twice) 
that resulted in deadlocks earlier.
-- 
Cheers,
Ashok Raj
- Open Source Technology Center
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.kernel.org
More majordomo info at  
http://vger.kernel.org/majordomo-info.html
Please read the FAQ at  
http://www.tux.org/lkml/