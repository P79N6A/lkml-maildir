Date: Sun, 01 Jan 2006 13:39:09 -0400
From: "1qay beer" <>
Subject: Wish for 2006 to Alan Cox and Jeff Garzik: A functional Driver for PDC202XX
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2006/1/1/50

Hello,
Dear Alan Cox,
Dear Jeff Garzik,
Everyone a happy new year!
We are in stable Kernel 2.6.14.5, year 2006.
Since 1997 people asking on several list for a functional PDC202XX Driver.
Since some years I spend hours and hours finding a solution for a stable driver. 
(PDC20269/Promise Ultra133 TX2)
There seem to be none.
There are two Solution:
-The IDE Driver (pdc202xx_new) has still problems with "DMA Timeout".
-The Libata Driver (pata_pdc2027x) seems to be still somewhat experimental.
Unfortunatly I'am not a kernel developper else there would be probably already
a solution ;-)
So what is the Solution for the PDC20269 Ultra ATA Controller?
I would mark this bold on the wishlist for 2006 ;-)
Thanx
=========================================================
Anyone wants a small summary of the halfworking solutions
Way 1 - IDE pdc202xx_new  --> /dev/hdxx )
------------------------------------------
  Just compile your kernel with a module (or built in):
  $make menuconfig
       -> Device Drivers                                                                                 
         -> ATA/ATAPI/MFM/RLL support                                                                     
           -> ATA/ATAPI/MFM/RLL support (IDE [=y])                                                       
             -> Enhanced IDE/MFM/RLL disk/cdrom/tape/floppy support (BLK_DEV_IDE [=y])                    
               -> PCI IDE chipset support (BLK_DEV_IDEPCI [=y])                                           
                 -> Generic PCI bus-master DMA support (BLK_DEV_IDEDMA_PCI
		   ->PROMISE PDC202{68|69|70|71|75|76|77} support
   $make-kpkg kernel_image
Problems:)
hde: dma_timer_expiry: dma status == 0x60
 hde: DMA timeout retry
 PDC202XX: Primary channel reset.
 hde: timeout waiting for DMA
 hde: status error: status=0x58 { DriveReady SeekComplete DataRequest }
 ide: failed opcode was: unknown
 hde: drive not ready for command
 hde: status error: status=0x50 { DriveReady SeekComplete }
 ide: failed opcode was: unknown
 hde: no DRQ after issuing MULTWRITE_EXT
 hde: status error: status=0x50 { DriveReady SeekComplete }
 ide: failed opcode was: unknown
 hde: no DRQ after issuing MULTWRITE_EXT
 hde: status error: status=0x50 { DriveReady SeekComplete }
 ide: failed opcode was: unknown
 hdf: DMA disabled
 PDC202XX: Primary channel reset.
 hde: no DRQ after issuing MULTWRITE_EXT
 ide2: reset: success
 hde: dma_timer_expiry: dma status == 0x20
 hde: DMA timeout retry
 PDC202XX: Primary channel reset.
 hde: timeout waiting for DMA
or similar
Way 2 - libata  (emulates SCSI device) --> /dev/sdxx  )
-------------------------------------------------------
     Get the latest libata patch/kernel
          
http://www.kernel.org/pub/linux/kernel/people/jgarzik/patchkits/2.6/2.6.15-rc4-libata1.patch.bz2
ftp://ftp.kernel.org/pub/linux/kernel/v2.6/testing/linux-2.6.15-rc5.tar.bz2
       ....(untar)...
       $make menuconfig
        -> Device Drivers                                                                                  
         -> SCSI device support                                                                           
           -> SCSI device support (SCSI [=m])                                                             
             -> SCSI low-level drivers                                                                    
               -> Serial ATA (SATA) support (SCSI_SATA [=m])  
                  ->SCSI_PATA_PDC2027X
  
        Enable PATA as suggested here:
        -
http://lkml.org/lkml/2004/8/1/100
        -
http://seclists.org/lists/linux-kernel/2005/May/0503.html
           In include/linux/libata.h
              #define ATA_ENABLE_ATAPI /* undefine to disable ATAPI support */
              #define ATA_ENABLE_PATA /* define to enable PATA support in some
                                       * low-level drivers */ 
         
        Compile and pray!
        With some harddisk it works without problem (seagate 7200.8)
        With others Maxtor Maxline III it's not working at all:
        Kernel Panics even at boottime:
         ATA1: Abnormal status 0x8 on port 0xD...........
         or Lost Interrupts...
         or the drivers seems to be loaded (lsmod) but there are no
            harddiscs under /prov/scsi/... /dev/sdxx
-- 
_______________________________________________
The coolest e-mail address on the web and itÂ’s FREE!  Sign-up today for Beer Mail @ beer.com.
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.kernel.org
More majordomo info at  
http://vger.kernel.org/majordomo-info.html
Please read the FAQ at  
http://www.tux.org/lkml/