Date: Sat, 31 Jul 1999 09:32:23 +0200
From: "Manfred Spraul" <>
Subject: Re: [RFC] [PATCH] lazy TLB: possible bug, some notes (2.3.12)
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/1999/7/31/5

Linus wrote:
> >Since flush_tlb_current_task() is now identical to
> >flush_tlb_mm(current->mm), I'd remove flush_tlb_current_task()
> >and change the macro for flush_tlb(). [in include/asm/pgtable.h]
> If you have the same code, then you have slow code. There's a
> fundamental difference between "flush current" and "flush an mm that
> may not exist on this CPU at all".
I don't know what you call "slow", but the number of IPI's and
local_flush_tlb() calls seems to be identical. (But all if-clauses
are reordered and different, so it's very confusing)
Btw, currently flush_tlb_mm() is not optimal:
If the function is called multiple times while in lazy-tlb mode, then
local_flush_tlb() is called every time. This is not needed:
while in lazy-tlb mode, no user-space pages are accessed,
i.e. the CPU cache cannot contain user-space entries, so there is
no need to flush it again.
(patch vs stock 2.3.12)
--
    Manfred
[unhandled content-type:application/octet-stream]