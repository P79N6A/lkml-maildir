Date: Fri, 12 Mar 1999 18:25:17 +1100 (EST)
From: Nathan Hand <>
Subject: Kernel Panic reading scsi-cdrom
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/1999/3/12/14

I'm having trouble with a scsi cd-rom on linux 2.2.3-ac1. I'll be trying
linux 2.2.3 without the -ac1 patch later tonight to confirm the official
kernel is at fault. The problem is known to also occur with 2.2.2-ac7: I
can't precisely pinpoint which kernel started causing troubles though (a
lot of hardware has moved into/outof this box recently).
The problem manifests itself as a kernel panic when running
   dd if=/dev/scd0 of=raw.iso
The kernel panic occurs quickly; within the first few megabytes.
The system requires a reset, though sysreq allows me to unmount and sync
the disks first. The kernel panic log is written below. It was copied by
hand onto paper, so I can't guarantee perfection, though some effort was
made to avoid errors. Information from the aha152x modprobe and lspci is
also given. The kernel was compiled with gcc-2.7.2.3.
I've repeated the error twice. The second produced an exact match of the
kernel panic *except* the number 0xc0fdde00 became 0xc031be00. My system
map doesn't have any symbols with addresses this high (my kernel symbols
are all prefixed by 0xc01). The fault occurs with and without X, and I'm
not using a soundcard or tuner card at the same time.
The scsi adapter is an ISA based Adaptec 1505, so there is no BIOS. I've
checked interrupts and IO ports and I can't see a conflict.
The same hardware works fine under Windows 95 (temporarily installed for
the purposes of proving the hardware wasn't broken or misconfigured).
-- begin kernel panic --
sr0: CD-ROM error: Current error sr0b:00: sense key Illegal Request
Additional sense indicates Illegal mode for this track
command was: Request Sense 00 00 00 10 00
aha152x: target left COMMAND
QUEUE STATUS:
issue_SC:
current_SC:
0xc0fdde00: target=6; lun=0; cmnd=(Read (6) 00 02 91 08 00
); residual=2048; buffers=7; phase |send_ident|; in other(COMMAND); next=0x00000
000
disconnected_SC:
on bus: SCSISEQ (); SCSISIG (STATUS); INTSTAT (hi); SSTAT (SELDO PHASEMIS PHASEC
HG REQINIT ); SSTAT (PHASEMIS REGINIT ); SXFRCTL0 (CHI ); SIGNAL (BSYI REQI ); S
ELID (c0), SSTAT2 (SEMPTY); SFCNT (0); SCSICNT (0), OFFCNT (0), SSTAT4 (); DMACN
TRL0 (16BIT PIO READ ); DMASTAT (DFIFOEMP )
enabled interrupts (ENPHASEMIS ENBUSFREE ENREQINIT )
Kernel panic: aha152x panic
In interrupt handler - not syncing
-- end kernel panic --
-- begin lspci -vv --
00:00.0 Host bridge: Silicon Integrated Systems 5571
	Control: I/O+ Mem+ BusMaster+ SpecCycle- MemWINV- VGASnoop- ParErr- Stepping- SERR- FastB2B-
	Status: 66Mhz- UDF- FastB2B- ParErr- DEVSEL=medium >TAbort- <TAbort- <MAbort+ >SERR- <PERR-
	Latency: 255 set
00:01.0 ISA bridge: Silicon Integrated Systems 85C503 (rev 01)
	Control: I/O+ Mem+ BusMaster+ SpecCycle- MemWINV- VGASnoop- ParErr- Stepping- SERR- FastB2B-
	Status: 66Mhz- UDF- FastB2B- ParErr- DEVSEL=medium >TAbort- <TAbort- <MAbort- >SERR- <PERR-
	Latency: 0 set
00:01.1 IDE interface: Silicon Integrated Systems 5513 (rev c0) (prog-if 8a)
	Subsystem: Unknown device 1204:60be
	Control: I/O+ Mem+ BusMaster+ SpecCycle- MemWINV- VGASnoop- ParErr- Stepping- SERR- FastB2B-
	Status: 66Mhz- UDF- FastB2B- ParErr- DEVSEL=fast >TAbort- <TAbort- <MAbort- >SERR- <PERR-
	Latency: 32 set
	Interrupt: pin A routed to IRQ 14
	Region 0: I/O ports at 01f0
	Region 1: I/O ports at 03f4
	Region 2: I/O ports at 0170
	Region 3: I/O ports at 0374
	Region 4: I/O ports at 4000
00:01.2 USB Controller: Silicon Integrated Systems 7001 (rev b0) (prog-if 10)
	Control: I/O+ Mem+ BusMaster+ SpecCycle- MemWINV- VGASnoop- ParErr- Stepping- SERR- FastB2B-
	Status: 66Mhz- UDF- FastB2B- ParErr- DEVSEL=medium >TAbort- <TAbort- <MAbort- >SERR- <PERR-
	Latency: 32 set
	Interrupt: pin A routed to IRQ 12
	Region 0: Memory at e2004000 (32-bit, non-prefetchable)
	Region 1: I/O ports at 6000
00:0d.0 Multimedia video controller: Brooktree Corporation Bt848 (rev 12)
	Control: I/O- Mem+ BusMaster+ SpecCycle- MemWINV- VGASnoop- ParErr- Stepping- SERR- FastB2B-
	Status: 66Mhz- UDF- FastB2B+ ParErr- DEVSEL=medium >TAbort- <TAbort- <MAbort- >SERR- <PERR-
	Latency: 16 min, 40 max, 32 set
	Interrupt: pin A routed to IRQ 10
	Region 0: Memory at e2005000 (32-bit, prefetchable)
00:0e.0 Ethernet controller: Winbond Electronics Corp 89C940
	Control: I/O+ Mem+ BusMaster- SpecCycle- MemWINV- VGASnoop- ParErr- Stepping- SERR- FastB2B-
	Status: 66Mhz- UDF- FastB2B+ ParErr- DEVSEL=medium >TAbort- <TAbort- <MAbort- >SERR- <PERR-
	Interrupt: pin A routed to IRQ 9
	Region 0: I/O ports at 6100
00:0f.0 Multimedia video controller: 3Dfx Interactive, Inc. Voodoo (rev 02)
	Control: I/O- Mem+ BusMaster- SpecCycle- MemWINV- VGASnoop- ParErr- Stepping- SERR- FastB2B-
	Status: 66Mhz- UDF- FastB2B+ ParErr- DEVSEL=fast >TAbort- <TAbort- <MAbort- >SERR- <PERR-
	Region 0: Memory at e0000000 (32-bit, prefetchable)
00:10.0 VGA compatible controller: Matrox Graphics, Inc. MGA 1064SG [Mystique] (rev 03)
	Subsystem: Unknown device 102b:0200
	Control: I/O+ Mem+ BusMaster- SpecCycle- MemWINV- VGASnoop- ParErr- Stepping+ SERR- FastB2B-
	Status: 66Mhz- UDF- FastB2B+ ParErr- DEVSEL=medium >TAbort- <TAbort- <MAbort- >SERR- <PERR-
	Interrupt: pin A routed to IRQ 0
	Region 0: Memory at e1000000 (32-bit, prefetchable)
	Region 1: Memory at e2000000 (32-bit, non-prefetchable)
	Region 2: Memory at e1800000 (32-bit, non-prefetchable)
-- end lspci -vv --
-- begin aha152x module --
aha152x: BIOS test: passed, detected 1 controller(s)
aha152x0: vital data: PORTBASE=0x340, IRQ=11, SCSI ID=7, reconnect=enabled, pari
ty=enabled, synchronous=disabled, delay=100, extended translation=disabled
aha152x: trying software interrupt, ok.
scsi0 : Adaptec 152x SCSI driver; $Revision: 1.7 $
scsi : 1 host.
 Vendor: MATSHITA  Model: CD-R   CW-7502    Rev: 4.17
 Type:   CD-ROM                             ANSI SCSI revision: 02
Detected scsi CD-ROM sr0 at scsi0, channel 0, id 6, lun 0
sr0: scsi3-mmc drive: 8x/8x writer xa/form2 cdda tray
-- end aha152x module --
--
Nathan Hand - Chirp Web Design - 
http://www.chirp.com.au/
 - $e^{i\pi}+1 = 0$
Phone: +61 2 6230 1871   Fax: +61 2 6230 4455   E-mail: nathanh@chirp.com.au
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.rutgers.edu
Please read the FAQ at 
http://www.tux.org/lkml/