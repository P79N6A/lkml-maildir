Date: Tue, 19 Feb 2008 11:29:44 +0100
From: Ingo Molnar <>
Subject: Re: [PATCH] x86_64: fix dma_alloc_pages
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2008/2/19/108

* Yinghai Lu <Yinghai.Lu@Sun.COM> wrote:
> one system with two nodes and two ht links on every node. the bios 
> already have _pxm for two links.
> 
> when no ram installed for node1 will have panic.
> 
> reason: the device on second chain will get node = 1 from 
> dev_to_node...via pci_acpi_scan_root. but node1 doesn't have ram 
> installed. in dma_alloc_pages it will pass check with 
> first_node(node_online_map)... and will have problem with 
> __alloc_pages in alloc_pages_node.
> 
> this patch will check the if the node is online..., if not will get 
> numa_node_id to get one node with ram.
thanks, applied.
	Ingo