Date: Fri, 27 Aug 2004 13:57:07 +0530
From: <>
Subject: CDROMPLAYTRKIND ioctl causing server hang
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2004/8/27/19

Hi,
(1)
Doing CDROMPLAYTRKIND ioctl on bus powered USB CD drive:TEAC CD-ROM 210-PU causes server to hang.
CD drive was connected to USB port directly. Known good audio CD was inserted .
OS is Red Hat Linux AS 3.0, kernel 2.4.21-4.ELsmp.
As soon as this ioctl is called on /dev/scd node, kernel printk's the following messages in /var/log/messages file:
	Aug 24 10:42:15 PE2600-7XP2B1S kernel: sr2: CDROM (ioctl) reports ILLEGAL REQUEST.
	Aug 24 10:42:15 PE2600-7XP2B1S kernel: usb-uhci.c: interrupt, status 3, frame# 1495
	Aug 24 10:42:20 PE2600-7XP2B1S kernel: usb-uhci.c: interrupt, status 3, frame# 312
	Aug 24 10:42:50 PE2600-7XP2B1S kernel: usb_control/bulk_msg: timeout
	Aug 24 10:42:50 PE2600-7XP2B1S kernel: usb-uhci.c: interrupt, status 3, frame# 1685
	Aug 24 10:43:11 PE2600-7XP2B1S kernel: usb_control/bulk_msg: timeout
	Aug 24 10:43:11 PE2600-7XP2B1S kernel: usb.c: USB disconnect on device 00:1d.0-2 address 2
After the last line (USB disconnect..) logged in messages file, server hangs. Even the ssh connection from other server hangs. We have to switch off the server manually by pressing power switch.
(2)
I read on some Linux related posts on internet that CDROMPLAYTRKIND ioctl is not supported by SCSI drivers (ide-scsi, usb-scsi, etc.).
I used CDROMPLAYMSF for playing the CD and above problem did not occur. ioctl passed.
(3)
Also, when I connected this USB CD drive to an external hub (self-powered), ioctl failed but the server did not hang. However, the drive got disconnected.
(4)
Is there a known issue in 2.4.21-4 kernel related to CDROMPLAYTRKIND ioctl or usb driver? If yes, what is Bugzilla id for it?
Please guide.
Thanks,
Ganesh
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.kernel.org
More majordomo info at  
http://vger.kernel.org/majordomo-info.html
Please read the FAQ at  
http://www.tux.org/lkml/