Date: Wed, 10 Nov 1999 21:51:22 -0800 (PST)
From: Andre Hedrick <>
Subject: Re: disk corruptions on "tuned" disks Was: APM killing low-latency performance on BX mainboard
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/1999/11/11/4

On Thu, 11 Nov 1999, Benno Senoner wrote:
> On Thu, 11 Nov 1999, Dan Hollis wrote:
> > On Thu, 11 Nov 1999, Benno Senoner wrote:
> > > It would be nice if we could collect some data about problematic
> > > drives / mainboards.
> > > Alan any know drives ?
> > > ( If I get some data I will write a little tool which automates this)
Well when you write the tool, be sure to write the kernel code for the
tool to interface to.........
> > VIA VP3/MVP3/MVP4 chipets.
For the record, my fine friends at Quantum are up-ended over the detection
issue of the VIA chipset ............. since I do not have any other their
product line, and then are unwilling to donate, discount, or help with
anything ............. you now know why the driver is "STALE"....
> thanks, but what is the exact problem source , DMA or unmask IRQ ?
IMHO, do not "unmask IRQ" if you have are using my chipset tuning code.
I have not accounted for the side effects.........like corruption that
can/has/will happen..........YEAH, I reinstalled several times on one box
to see if I could make better use of "unmasking IRQs".  Not TODAY!!
> > Put any CDROM/DVD in DMA mode and it will work
> > for a while and then eventually lock the PC up. This is a hardware flaw.
Maybe the kernel is not up to clean DVD support with DMAing, I need to get
a DVD drive to do fixes and kludges per chipset......
> Doh !  really bad news :-(  
> What about watching DVDs ?
> I'm watching DVDs on windoze using a software-only player,
> and without DMA you get nast frameskips ,because the PIO
> transfer uses too much CPU.
> I'm watching DVDs for hours ( DMA enabled) without any lockups.
Maybe in a day or two, Jens and I will sync our work and then you will be
allowed to rag on us on the problem......but until that happens....you
have kernels that can not talk to the hardware in the best possible
solution.
> How is this handled my other OSes ?
M$ clobbers the CPU for PIOing....
As for the commerical ones........have not asked.
> > Promise Ultra66. No DMA on CDROM/DVDs. It just wont work. At all.
> > 
> > -Dan
I am finding out that only "ON BOARD" chipsets handle CDROM DMAing fine,
but all others generally have problems.
> PS: why should recent ATAPI CDROM let you set the DMA mode, when they
> know that it could lead to problems ?
Many of them work, all three of mine do.
Linux-IDE:/usr/bin # hdparm -i /dev/hde
/dev/hde:
 HDIO_GET_MULTCOUNT failed: Invalid argument
 Model=CD-ROM CDU611, FwRev=2.0a, SerialNo=
 Config={ Fixed Removeable DTR<=5Mbs DTR>10Mbs nonMagnetic }
 RawCHS=0/0/0, TrkSize=0, SectSize=0, ECCbytes=0
 BuffType=0(?), BuffSize=0kB, MaxMultSect=0
 DblWordIO=no, maxPIO=3(eide), DMA=yes, maxDMA=2(fast)
 (maybe): CurCHS=0/0/0, CurSects=0, LBA=yes, LBAsects=0
 tDMA={min:120,rec:120}, DMA modes: sword0 sword1 sword2 mword0 mword1 *mword2
 IORDY=on/off, tPIO={min:180,w/IORDY:120}, PIO modes: mode3 mode4
root@bp6% hdparm -i /dev/hde
/dev/hde:
 Model=ATAPI 44X CDROM, FwRev=VER-3.40, SerialNo=44XCDROM Ver3.40
 Config={ Fixed Removeable DTR<=5Mbs DTR>10Mbs nonMagnetic }
 RawCHS=0/0/0, TrkSize=0, SectSize=0, ECCbytes=0
 BuffType=0(?), BuffSize=0kB, MaxMultSect=0
 DblWordIO=no, maxPIO=4(ata), DMA=yes, maxDMA=2(fast)
 (maybe): CurCHS=0/0/0, CurSects=0, LBA=yes, LBAsects=0
 tDMA={min:120,rec:150}, DMA modes: mword0 mword1 mword2
 IORDY=yes, tPIO={min:227,w/IORDY:120}, PIO modes: mode3 mode4
 UDMA modes: mode0 mode1 *mode2
 TAisAisAkoAkyA bAt oAheA aAteAptA hAveAfailed, buB iA mAy be better in
the near future.
Andre Hedrick
The Linux IDE guy
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.rutgers.edu
Please read the FAQ at 
http://www.tux.org/lkml/