Date: Wed, 15 Mar 2006 20:56:16 +0200
From: Linas Å½virblis <>
Subject: PROBLEM: "irq 7: nobody cared" with 2.6.16-rc6
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2006/3/15/175

With 2.6.16-rc6[-git1] I get "irq 7: nobody cared" error followed by
"Disabling IRQ #7". I could not identify a way of reproducing it, it
just happens at any given time after boot. As suggested by error, I
booted with "irqpoll" option, but that did not solve the problem. Worse
yet, it managed to take my system down while spitting "hdc:
cdrom_pc_intr: The drive appears confused (ireason = 0x01)" errors.
IRQ 7 belongs to two USB ports. When I initially noticed the error with
2.6.16-rc6, there were no devices connected and "usblp" module was not
built. With 2.6.16-rc6-git1, which had "usblp" built, the behavior is
identical.
The last kernel, before these, on this machine was 2.6.16-rc5-git1 which
did not seem to exhibit such errors, but 2.6.16-rc5, it currently runs,
does.
I have been using dyn-ticks for some time and strangely enough, the
error appeared after I stopped using it. This might also be only a
coincidence.
I did not try any version above 2.6.16-rc6-git1, so I cannot claim this
is not fixed, but I will probably only be able to do it some time next week.
I am not experienced in kernel debugging, but I tried to gather as much
useful information as I could. If there is something obvious I have
missed, please say so. I am very confused about all of this, and my only
hope is that this is not a hardware failure.
This is my first mail to LKML. I am not subscribed, please CC me.
Regards,
Linas
--- Linux version ---
Linux version 2.6.16-rc6-git1.custom.0 (root@box) (gcc version 4.0.3
(Debian 4.0.3-1)) #1 PREEMPT Mon Mar 13 23:08:28 EET 2006
--- error with "irqpoll" ---
irq 7: nobody cared (try booting with the "irqpoll" option)
 [<c013bfc4>] __report_bad_irq+0x24/0x80
 [<c013c09c>] note_interrupt+0x7c/0x250
 [<c013ba86>] __do_IRQ+0xc6/0xf0
 [<c010547e>] do_IRQ+0x3e/0x60
 =======================
 [<c01038ae>] common_interrupt+0x1a/0x20
 [<c0121110>] __do_softirq+0x30/0x90
 [<c01054ee>] do_softirq+0x4e/0x60
 =======================
 [<c0121015>] irq_exit+0x35/0x40
 [<c0105485>] do_IRQ+0x45/0x60
 [<c01038ae>] common_interrupt+0x1a/0x20
 [<c022796f>] acpi_processor_idle+0x154/0x319
 [<c0101ca1>] cpu_idle+0x41/0x60
 [<c036645a>] start_kernel+0x23a/0x2c0
 [<c03664e0>] unknown_bootoption+0x0/0x240
handlers:
[<e883bb10>] (usb_hcd_irq+0x0/0x60 [usbcore])
[<e883bb10>] (usb_hcd_irq+0x0/0x60 [usbcore])
Disabling IRQ #7
--- error without "irqpoll" ---
irq 7: nobody cared (try booting with the "irqpoll" option)
 [<c013bfc4>] __report_bad_irq+0x24/0x80
 [<c013c09c>] note_interrupt+0x7c/0x250
 [<c013b993>] handle_IRQ_event+0x33/0x60
 [<c013ba86>] __do_IRQ+0xc6/0xf0
 [<c010547e>] do_IRQ+0x3e/0x60
 =======================
 [<c01038ae>] common_interrupt+0x1a/0x20
 [<c0121110>] __do_softirq+0x30/0x90
 [<c01054ee>] do_softirq+0x4e/0x60
 =======================
 [<c0121015>] irq_exit+0x35/0x40
 [<c0105485>] do_IRQ+0x45/0x60
 [<c01038ae>] common_interrupt+0x1a/0x20
 [<c022796f>] acpi_processor_idle+0x154/0x319
 [<c0101ca1>] cpu_idle+0x41/0x60
 [<c036645a>] start_kernel+0x23a/0x2c0
 [<c03664e0>] unknown_bootoption+0x0/0x240
handlers:
[<e8864b10>] (usb_hcd_irq+0x0/0x60 [usbcore])
[<e8864b10>] (usb_hcd_irq+0x0/0x60 [usbcore])
Disabling IRQ #7
--- ver_linux ---
Gnu C                  4.0.3
Gnu make               3.81rc1
binutils               2.16.91
util-linux             2.12r
mount                  2.12r
module-init-tools      3.2.2
e2fsprogs              1.39-WIP
reiserfsprogs          line
reiser4progs           line
Linux C Library        2.3.6
Dynamic linker (ldd)   2.3.6
Procps                 3.2.6
Net-tools              1.60
Kbd                    1.12
Sh-utils               5.94
udev                   087
Modules Loaded
usblp binfmt_misc ipt_ECN xt_helper ipt_REJECT xt_state xt_tcpudp xt_pkttype
ipt_LOG iptable_mangle iptable_filter ip_tables arptable_filter arp_tables
x_tables ip_conntrack_ftp ip_conntrack nfnetlink i2c_dev w83627hf hwmon_vid
hwmon i2c_isa nvidia snd_rtctimer snd_seq_oss snd_seq_midi snd_seq_midi_event
snd_seq snd_via82xx snd_ac97_codec snd_ac97_bus snd_pcm_oss snd_mixer_oss
snd_pcm snd_timer snd_page_alloc snd_mpu401_uart snd_rawmidi snd_seq_device snd
i2c_viapro uhci_hcd soundcore 8139too mii 8250_pnp i2c_core 8250 serial_core
usbcore pcspkr
--- /proc/cpuinfo ---
processor     : 0
vendor_id     : AuthenticAMD
cpu family    : 6
model         : 4
model name    : AMD Athlon(tm) Processor
stepping      : 4
cpu MHz       : 978.746
cache size    : 256 KB
fdiv_bug      : no
hlt_bug       : no
f00f_bug      : no
coma_bug      : no
fpu           : yes
fpu_exception : yes
cpuid level   : 1
wp            : yes
flags         : fpu vme de pse tsc msr pae mce cx8 apic sep mtrr pge mca cmov
                pat pse36 mmx fxsr syscall mmxext 3dnowext 3dnow
bogomips      : 1960.80
--- /proc/ioports ---
0000-001f : dma1
0020-0021 : pic1
0040-0043 : timer0
0050-0053 : timer1
0060-006f : keyboard
0070-0077 : rtc
0080-008f : dma page reg
00a0-00a1 : pic2
00c0-00df : dma2
00f0-00ff : fpu
0170-0177 : ide1
01f0-01f7 : ide0
0295-0296 : w83627hf
02f8-02ff : serial
0376-0376 : ide1
03c0-03df : vesafb
03f6-03f6 : ide0
03f8-03ff : serial
0cf8-0cff : PCI conf1
4000-4003 : PM1a_EVT_BLK
4008-400b : PM_TMR
4010-4015 : ACPI CPU throttle
4020-4023 : GPE0_BLK
40f0-40f1 : PM1a_CNT_BLK
5000-5007 : vt596_smbus
d000-d0ff : 0000:00:0e.0
  d000-d0ff : 8139too
d400-d40f : 0000:00:11.1
  d400-d407 : ide0
  d408-d40f : ide1
d800-d81f : 0000:00:11.2
  d800-d81f : uhci_hcd
dc00-dc1f : 0000:00:11.3
  dc00-dc1f : uhci_hcd
e400-e4ff : 0000:00:11.5
  e400-e4ff : VIA8233
--- /proc/iomem ---
00000000-0009fbff : System RAM
  00000000-00000000 : Crash kernel
0009fc00-0009ffff : reserved
000a0000-000bffff : Video RAM area
000c0000-000cc3ff : Video ROM
000f0000-000fffff : System ROM
00100000-27feffff : System RAM
  00100000-002d8842 : Kernel code
  002d8843-00364af3 : Kernel data
27ff0000-27ff2fff : ACPI Non-volatile Storage
27ff3000-27ffffff : ACPI Tables
d0000000-d7ffffff : 0000:00:00.0
d8000000-dfffffff : PCI Bus #01
  d8000000-dfffffff : 0000:01:00.0
    d8000000-d9ffffff : vesafb
e0000000-e1ffffff : PCI Bus #01
  e0000000-e0ffffff : 0000:01:00.0
    e0000000-e0ffffff : nvidia
  e1000000-e100ffff : 0000:01:00.0
e2000000-e20000ff : 0000:00:0e.0
  e2000000-e20000ff : 8139too
ffff0000-ffffffff : reserved
--- /proc/interrupts ---
           CPU0       
  0:    3492690          XT-PIC  timer
  1:       6987          XT-PIC  i8042
  2:          0          XT-PIC  cascade
  3:      13343          XT-PIC  serial
  5:          0          XT-PIC  VIA8233
  7:     573144          XT-PIC  uhci_hcd:usb1, uhci_hcd:usb2
  8:          4          XT-PIC  rtc
  9:          1          XT-PIC  acpi
 10:     217096          XT-PIC  nvidia
 11:      30041          XT-PIC  eth0
 12:     174136          XT-PIC  i8042
 14:      17716          XT-PIC  ide0
 15:      31049          XT-PIC  ide1
NMI:          0 
LOC:    3487977 
ERR:     182332
MIS:          0
--- lspci -vvv ---
0000:00:00.0 Host bridge: VIA Technologies, Inc. VT8366/A/7 [Apollo KT266/A/333]
        Control: I/O- Mem+ BusMaster+ SpecCycle- MemWINV- VGASnoop- ParErr- Stepping- SERR- Fa
        Status: Cap+ 66MHz- UDF- FastB2B- ParErr- DEVSEL=medium >TAbort- <TAbort- <MAbort+ >SE
        Latency: 0
        Region 0: Memory at d0000000 (32-bit, prefetchable) [size=128M]
        Capabilities: [a0] AGP version 2.0
                Status: RQ=32 Iso- ArqSz=0 Cal=0 SBA+ ITACoh- GART64- HTrans- 64bit- FW+ AGP3-
                Command: RQ=1 ArqSz=0 Cal=0 SBA- AGP+ GART64- 64bit- FW- Rate=x4
        Capabilities: [c0] Power Management version 2
                Flags: PMEClk- DSI- D1- D2- AuxCurrent=0mA PME(D0-,D1-,D2-,D3hot-,D3cold-)
                Status: D0 PME-Enable- DSel=0 DScale=0 PME-
0000:00:01.0 PCI bridge: VIA Technologies, Inc. VT8366/A/7 [Apollo KT266/A/333 AGP] (prog-if 0
        Control: I/O+ Mem+ BusMaster+ SpecCycle- MemWINV- VGASnoop- ParErr- Stepping- SERR- Fa
        Status: Cap+ 66MHz+ UDF- FastB2B- ParErr- DEVSEL=medium >TAbort- <TAbort- <MAbort+ >SE
        Latency: 0
        Bus: primary=00, secondary=01, subordinate=01, sec-latency=0
        I/O behind bridge: 0000f000-00000fff
        Memory behind bridge: e0000000-e1ffffff
        Prefetchable memory behind bridge: d8000000-dfffffff
        BridgeCtl: Parity- SERR- NoISA+ VGA+ MAbort- >Reset- FastB2B-
        Capabilities: [80] Power Management version 2
                Flags: PMEClk- DSI- D1+ D2- AuxCurrent=0mA PME(D0-,D1-,D2-,D3hot-,D3cold-)
                Status: D0 PME-Enable- DSel=0 DScale=0 PME-
0000:00:0e.0 Ethernet controller: Realtek Semiconductor Co., Ltd. RTL-8139/8139C/8139C+ (rev 1
        Subsystem: Realtek Semiconductor Co., Ltd. RT8139
        Control: I/O+ Mem+ BusMaster+ SpecCycle- MemWINV- VGASnoop- ParErr- Stepping- SERR- Fa
        Status: Cap+ 66MHz- UDF- FastB2B+ ParErr- DEVSEL=medium >TAbort- <TAbort- <MAbort- >SE
        Latency: 32 (8000ns min, 16000ns max)
        Interrupt: pin A routed to IRQ 11
        Region 0: I/O ports at d000 [size=256]
        Region 1: Memory at e2000000 (32-bit, non-prefetchable) [size=256]
        Capabilities: [50] Power Management version 2
                Flags: PMEClk- DSI- D1+ D2+ AuxCurrent=375mA PME(D0-,D1-,D2-,D3hot-,D3cold-)
                Status: D0 PME-Enable- DSel=0 DScale=0 PME-
0000:00:11.0 ISA bridge: VIA Technologies, Inc. VT8233 PCI to ISA Bridge
        Subsystem: VIA Technologies, Inc.: Unknown device 0000
        Control: I/O+ Mem+ BusMaster+ SpecCycle- MemWINV- VGASnoop- ParErr- Stepping+ SERR- Fa
        Status: Cap+ 66MHz- UDF- FastB2B- ParErr- DEVSEL=medium >TAbort- <TAbort- <MAbort- >SE
        Latency: 0
        Capabilities: [c0] Power Management version 2
                Flags: PMEClk- DSI- D1- D2- AuxCurrent=0mA PME(D0-,D1-,D2-,D3hot-,D3cold-)
                Status: D0 PME-Enable- DSel=0 DScale=0 PME-
0000:00:11.1 IDE interface: VIA Technologies, Inc. VT82C586A/B/VT82C686/A/B/VT823x/A/C PIPC Bu
        Subsystem: VIA Technologies, Inc. VT82C586/B/VT82C686/A/B/VT8233/A/C/VT8235 PIPC Bus M
        Control: I/O+ Mem+ BusMaster+ SpecCycle- MemWINV- VGASnoop- ParErr- Stepping- SERR- Fa
        Status: Cap+ 66MHz- UDF- FastB2B+ ParErr- DEVSEL=medium >TAbort- <TAbort- <MAbort- >SE
        Latency: 32
        Region 4: I/O ports at d400 [size=16]
        Capabilities: [c0] Power Management version 2
                Flags: PMEClk- DSI- D1- D2- AuxCurrent=0mA PME(D0-,D1-,D2-,D3hot-,D3cold-)
                Status: D0 PME-Enable- DSel=0 DScale=0 PME-
0000:00:11.2 USB Controller: VIA Technologies, Inc. VT82xxxxx UHCI USB 1.1 Controller (rev 18)
        Subsystem: VIA Technologies, Inc. (Wrong ID) USB Controller
        Control: I/O+ Mem+ BusMaster+ SpecCycle- MemWINV- VGASnoop- ParErr- Stepping- SERR- Fa
        Status: Cap+ 66MHz- UDF- FastB2B- ParErr- DEVSEL=medium >TAbort- <TAbort- <MAbort- >SE
        Latency: 32, Cache Line Size: 0x08 (32 bytes)
        Interrupt: pin D routed to IRQ 7
        Region 4: I/O ports at d800 [size=32]
        Capabilities: [80] Power Management version 2
                Flags: PMEClk- DSI- D1- D2- AuxCurrent=0mA PME(D0-,D1-,D2-,D3hot-,D3cold-)
                Status: D0 PME-Enable- DSel=0 DScale=0 PME-
0000:00:11.3 USB Controller: VIA Technologies, Inc. VT82xxxxx UHCI USB 1.1 Controller (rev 18)
        Subsystem: VIA Technologies, Inc. (Wrong ID) USB Controller
        Control: I/O+ Mem+ BusMaster+ SpecCycle- MemWINV- VGASnoop- ParErr- Stepping- SERR- Fa
        Status: Cap+ 66MHz- UDF- FastB2B- ParErr- DEVSEL=medium >TAbort- <TAbort- <MAbort- >SE
        Latency: 32, Cache Line Size: 0x08 (32 bytes)
        Interrupt: pin D routed to IRQ 7
        Region 4: I/O ports at dc00 [size=32]
        Capabilities: [80] Power Management version 2
                Flags: PMEClk- DSI- D1- D2- AuxCurrent=0mA PME(D0-,D1-,D2-,D3hot-,D3cold-)
                Status: D0 PME-Enable- DSel=0 DScale=0 PME-
0000:00:11.5 Multimedia audio controller: VIA Technologies, Inc. VT8233/A/8235/8237 AC97 Audio
        Subsystem: VIA Technologies, Inc.: Unknown device 4511
        Control: I/O+ Mem- BusMaster- SpecCycle- MemWINV- VGASnoop- ParErr- Stepping- SERR- Fa
        Status: Cap+ 66MHz- UDF- FastB2B- ParErr- DEVSEL=medium >TAbort- <TAbort- <MAbort- >SE
        Interrupt: pin C routed to IRQ 5
        Region 0: I/O ports at e400 [size=256]
        Capabilities: [c0] Power Management version 2
                Flags: PMEClk- DSI- D1- D2- AuxCurrent=0mA PME(D0-,D1-,D2-,D3hot-,D3cold-)
                Status: D0 PME-Enable- DSel=0 DScale=0 PME-
0000:01:00.0 VGA compatible controller: nVidia Corporation NV11DDR [GeForce2 MX 100 DDR/200 DD
        Control: I/O+ Mem+ BusMaster+ SpecCycle- MemWINV- VGASnoop- ParErr- Stepping- SERR- Fa
        Status: Cap+ 66MHz+ UDF- FastB2B+ ParErr- DEVSEL=medium >TAbort- <TAbort- <MAbort- >SE
        Latency: 248 (1250ns min, 250ns max)
        Interrupt: pin A routed to IRQ 10
        Region 0: Memory at e0000000 (32-bit, non-prefetchable) [size=16M]
        Region 1: Memory at d8000000 (32-bit, prefetchable) [size=128M]
        Expansion ROM at e1000000 [disabled] [size=64K]
        Capabilities: [60] Power Management version 2
                Flags: PMEClk- DSI- D1- D2- AuxCurrent=0mA PME(D0-,D1-,D2-,D3hot-,D3cold-)
                Status: D0 PME-Enable- DSel=0 DScale=0 PME-
        Capabilities: [44] AGP version 2.0
                Status: RQ=32 Iso- ArqSz=0 Cal=0 SBA- ITACoh- GART64- HTrans- 64bit- FW+ AGP3-
                Command: RQ=32 ArqSz=0 Cal=0 SBA- AGP+ GART64- 64bit- FW- Rate=x4