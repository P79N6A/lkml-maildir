Date: Mon, 6 Dec 1999 09:49:24 -0600
From: Tim Walberg <>
Subject: Re: "Can't update..."
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/1999/12/6/77

Let me guess... you're running xntpd and VMWare?
Even if not, I've seen these messages on my dual PentiumPro
box as well. To the best of my understanding, this is what
happens:
The message is generated by a piece of code in arch/i386/time.c
that is responsible for setting the RTC from the kernel clock
when the kernel PLL has settled down to "11-minute mode" -
every 11 minutes, the CMOS clock is updated to agree with the
kernel clock. If the CMOS clock appears to be more than 30
minutes off from the kernel clock (although the code is
wrong, at least in 2.2.13, in that it doesn't handle hour
wraparound - i.e. it thinks 12:05 is more than 30 minutes
off from 11:58 because abs(5 - 58) > 30), this message is
printed, and the update is not done).
I start getting these messages after a while running VMWare
with access to /dev/rtc enabled and xntpd also running. My
guess (unconfirmed) is that eventually VMWare and the kernel
both end up trying to update the RTC at the same time, which
confuses the clock - I've seen the RTC actually stop running
and require a power cycle to recover at this point. Once
the RTC gets corrupted, there will be a period every hour
where you will get a couple of these messages, because the
test mentioned above fails.
Hope that helps some...
				tw
On 12/04/1999 07:57 +0000, Jeffrey B. Siegal wrote:
>>	I'm getting these messages on a dual Pentium-II 400 with the Red Hat-built
>>	2.2.12 SMP
>>	
>>	set_rtc_mmss: can't update from 159 to 41
>>	set_rtc_mmss: can't update from 58 to 12
>>	set_rtc_mmss: can't update from 54 to 5
>>	set_rtc_mmss: can't update from 54 to 6
>>	set_rtc_mmss: can't update from 54 to 7
>>	set_rtc_mmss: can't update from 54 to 8
>>	set_rtc_mmss: can't update from 159 to 39
>>	set_rtc_mmss: can't update from 159 to 33
>>	set_rtc_mmss: can't update from 159 to 34
>>	set_rtc_mmss: can't update from 52 to 5
>>	set_rtc_mmss: can't update from 52 to 6
>>	set_rtc_mmss: can't update from 159 to 37
>>	set_rtc_mmss: can't update from 49 to 0
>>	set_rtc_mmss: can't update from 49 to 1
>>	set_rtc_mmss: can't update from 49 to 2
>>	set_rtc_mmss: can't update from 49 to 3
>>	set_rtc_mmss: can't update from 56 to 7
>>	set_rtc_mmss: can't update from 159 to 38
>>	set_rtc_mmss: can't update from 56 to 9
>>	set_rtc_mmss: can't update from 56 to 10
>>	set_rtc_mmss: can't update from 159 to 52
>>	
>>	What does this mean?
>>	
>>	-
>>	To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
>>	the body of a message to majordomo@vger.rutgers.edu
>>	Please read the FAQ at 
http://www.tux.org/lkml/
End of included message
-- 
+------------------------------+--------------------------+
| Tim Walberg                  | Phone: 847-782-2472      |
| TERAbridge Technologies Corp | FAX:   847-623-1717      |
| 1375 Tri-State Parkway       | twalberg@terabridge.com  |
| Gurnee, IL 60031             | 800-SKY-TEL2 PIN 9353299 |
+------------------------------+--------------------------+
[unhandled content-type:application/pgp-signature]