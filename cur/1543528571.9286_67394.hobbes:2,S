Date: 04 Mar 2000 16:20:46 +0100
From: Andreas Muck <>
Subject: Re: 2.2.15pre13 bttv: CONFIG_VIDEO_MSP3400 still in the sound section
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2000/3/4/54

arjan@fenrus.demon.nl (Arjan van de Ven) writes:
>The MSP3400 does depend on sound, at least for some combinations (like the
>one above). 
Yes I've seen that now. But I'd still rather call it a bug in the
msp3400 code. The obvious fix would be this:
diff -u --recursive --new-file linux-2.2.15pre13/drivers/char/msp3400.c linux/dr
ivers/char/msp3400.c
--- linux-2.2.15pre13/drivers/char/msp3400.c    Wed Oct 20 02:14:00 1999
+++ linux/drivers/char/msp3400.c        Sat Mar  4 15:44:52 2000
@@ -61,7 +61,8 @@
 #include <linux/config.h>
 
 #if LINUX_VERSION_CODE > 0x020140 /* need modular sound driver */
-# if defined(CONFIG_SOUND) || defined(CONFIG_SOUND_MODULE)
+# if defined(CONFIG_SOUND) || \
+     (defined(CONFIG_SOUND_MODULE) && defined(CONFIG_VIDEO_MSP3400_MODULE))
 #  define REGISTER_MIXER 1
 # endif
 #endif
>What would be a greater pain: People who buy OSS-commercial have to change
>their conf.modules to use OSS-commercial, or people without OSS-commercial
>have a working kernel without all kinds of explicit rules and hidden
>dependencies.
It's not only changing conf.modules, that wouldn't hurt anybody. The
problem is that you can't load OSS on top of soundcore. But that seems
like an OSS problem now.
Anyway, I thought: why not make everybody happy and make it work
either way? The change above would fix the dependencies and allow you
to use the msp3400 code without sound support again. No good? :)
Btw, if msp3400 is going to remain in the sound section for good, then
the ifdefs above are useless and could be removed completely.
Andi
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.rutgers.edu
Please read the FAQ at 
http://www.tux.org/lkml/