Date: Sun, 29 Jul 2007 08:19:04 -0400
From: Neil Horman <>
Subject: Re: [PATCH 2/3] core_pattern: allow passing of arguments to user mode helper when core_pattern is a pipe
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2007/7/29/67

On Sun, Jul 29, 2007 at 11:34:18AM +0200, Martin Pitt wrote:
> Hi Neil,
> 
> Neil Horman [2007-07-28 13:21 -0400]:
> > Jeremy asked that I make a patch next week to address split_argv's requirement
> > that the argc parameter be non-NULL.  I'll be fixing that next week, and what I
> > can do is further enhance it such that it ignores spaces in quoted strings,
> > which should address the case that concerns you.  I.E I can make split_argv
> > behave such that:
> > echo "|\"foo bar\" --pid %p" > /proc/sys/kernel/core_pattern
> > results in the following argv:
> > {{"foo bar"}, {"--pid"}, {"1234"}}
> > 
> > Which I think handles what you are looking for.
> 
> Oh, handling escaping and quoting is going to make it fairly
> complicated, but sure, if you need that for other things, too, that
> would solve the remaining case. I just wonder if, instead of
> implementing escaping, it wouldn't be easier to first split on spaces
> and then escape macros?
> 
If it were just this case, then yes.  But we also need to make this work
properly for when core_pattern is not a pipe.  So the macro expansion routine
needs to be generalized somewhat.  Certainly doable, it just takes a bit more
testing and care in coding.  I'll start looking into it in the upcomming week.
> > Thank you for clearing me up on this.  So it would seem we're ok with what we
> > have now, correct?  
> 
> Absolutely, yes.
> 
> > We just have a potential corner case to address, which I can
> > reasonably handle with a modification to split_argv, that I have a
> > todo on next week.
> 
> Right, it's really just for perfectionism. Spaces in executable names
> are EBW anyway, and readlink()ing /proc/<pid>/exe is much more robust
> anyway in terms of a small and orthogonal interface.
> 
Understood.
> If the upstream kernel guys don't worry about it and consider it a
> blocker for merging, I don't either. :-)
> 
Copy that
Thanks & Regards
Neil
> Thanks a lot,
> 
> Martin
> 
> -- 
> Martin Pitt        
http://www.piware.de
> Ubuntu Developer   
http://www.ubuntu.com
> Debian Developer   
http://www.debian.org
-- 
/***************************************************
 *Neil Horman
 *Software Engineer
 *Red Hat, Inc.
 *nhorman@tuxdriver.com
 *gpg keyid: 1024D / 0x92A74FA1
 *
http://pgp.mit.edu
 ***************************************************/
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.kernel.org
More majordomo info at  
http://vger.kernel.org/majordomo-info.html
Please read the FAQ at  
http://www.tux.org/lkml/