Date: Sat, 31 Jan 2009 19:57:17 +0300
From: Sergei Shtylyov <>
Subject: Re: 2.6.29-rc libata sff 32bit PIO regression
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2009/1/31/114

Hello.
Alan Cox wrote:
>>> +	if (pdev->device == PCI_DEVICE_ID_AMD_VIPER_7411) /* FIFO is broken */
>>> +		fifo = 0;
>>> +
>>> +	/* On the later chips the read prefetch bits become no-op bits */
>>> +	pci_read_config_byte(pdev, 0x41, &r);
>>> +	r &= ~fifobit[ap->port_no];
>>> 
>>> 
>>   Why not:
>>
>>        r &= ~fifo;
>> 
>
> Because then it wouldn't clear the bits if they were set already and we
> wanted them off!
> 
   Ah, missed the modification of 'fifo'... :-<
MBR, Sergei