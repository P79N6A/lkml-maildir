Date: Tue, 14 Nov 2006 23:56:02 -0500
From: Jeff Garzik <>
Subject: Re: [PATCH] ALSA: hda-intel - Disable MSI support by default
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2006/11/14/379

Roland Dreier wrote:
>  > That reminds me of a potential driver bug -- MSI-aware drivers need to
>  > call pci_intx(pdev,0) to turn off the legacy PCI interrupt, before
>  > enabling MSI interrupts.
> 
> Huh?  The device can't generate any legacy interrupts once MSI is
> enabled.  As the PCI spec says:
> 
>     "While enabled for MSI or MSI-X operation, a function is prohibited
>     from using its INTx# pin (if implemented) to request service (MSI,
>     MSI-X, and INTx# are mutually exclusive)."
> 
> Although the MSI core does do pci_intx() for PCIe devices only, for
> some reason I can't grok.
Probably the same reason I just mentioned in a reply to DaveM.  Wildly 
speculating, some chips may depend on software to disable INTX -- i.e. 
depend on software to provide this aspect of PCI spec compliance.
>  > The only thing that has changed recently is that people are trying to
>  > get it working on AMD/NV as well.  (Brice Goglin's stuff starting at
>  > 6397c75cbc4d7dbc3d07278b57c82a47dafb21b5 in 'git log')
> 
> Actually NVidia/AMD was working on some systems long before that -- I
> had it working at least 2 years ago.
Well, just noting that AMD/NV seems to be a common pattern in the 
referenced bug reports, and the set of Linux platforms which claim to 
support MSI had recent churn.
	Jeff
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.kernel.org
More majordomo info at  
http://vger.kernel.org/majordomo-info.html
Please read the FAQ at  
http://www.tux.org/lkml/