Date: Wed, 9 Jan 2002 18:22:24 +0000
From: Athanasius <>
Subject: [PATCH] Athlon XP 1600+ and _mmx_memcpy symbol in modules
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2002/1/9/195

Hi,
  I've just upraded from my old PII-400 system to an Athlon XP 1600+
based system so changed from "Pentium-Pro/Celeron/Pentium-II"
(CONFIG_M686) to "Athlon/Duron/K7" (CONFIG_MK7).  In doing so I suddenly
saw a LOT of problems with modules and the symbol _mmx_memcpy being
undefined.
  I finally kludged/fixed this by changing line 121 of
arch/i386/kernel/i386_ksyms.c from:
EXPORT_SYMBOL(_mmx_memcpy);
into:
EXPORT_SYMBOL_NOVERS(_mmx_memcpy);
That's on a vanilla 2.4.17 source tree.
Patch:
--- linux-2.4.17/arch/i386/kernel/i386_ksyms.c  Tue Nov 13 17:13:20 2001
+++ linux-2.4.17-athlon/arch/i386/kernel/i386_ksyms.c   Wed Jan  9 17:32:19 2002
@@ -118,7 +118,7 @@
 #endif
 
 #ifdef CONFIG_X86_USE_3DNOW
-EXPORT_SYMBOL(_mmx_memcpy);
+EXPORT_SYMBOL_NOVERS(_mmx_memcpy);
 EXPORT_SYMBOL(mmx_clear_page);
 EXPORT_SYMBOL(mmx_copy_page);
 #endif
-- 
- Athanasius = Athanasius(at)gurus.tf / 
http://www.clan-lovely.org/~athan/
                  Finger athan(at)fysh.org for PGP key
	   "And it's me who is my enemy. Me who beats me up.
Me who makes the monsters. Me who strips my confidence." Paula Cole - ME
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.kernel.org
More majordomo info at  
http://vger.kernel.org/majordomo-info.html
Please read the FAQ at  
http://www.tux.org/lkml/