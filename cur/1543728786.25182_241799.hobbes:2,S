Date: Fri, 13 Aug 2004 15:54:57 -0700
From: Jesse Barnes <>
Subject: [PATCH] fix sn_console for CONFIG_SMP=n
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2004/8/13/276

I found that sn_console was missing an include and a fix if CONFIG_SMP=n.  
This patch fixes up the two small problems I found.
Signed-off-by: Jesse Barnes <jbarnes@sgi.com>
Jesse
diff -Nru a/drivers/serial/sn_console.c b/drivers/serial/sn_console.c
--- a/drivers/serial/sn_console.c	2004-08-13 15:50:37 -07:00
+++ b/drivers/serial/sn_console.c	2004-08-13 15:50:37 -07:00
@@ -50,6 +50,7 @@
 #include <linux/miscdevice.h>
 #include <linux/serial_core.h>
 
+#include <asm/io.h>
 #include <asm/sn/simulator.h>
 #include <asm/sn/sn2/sn_private.h>
 #include <asm/sn/sn_sal.h>
@@ -1085,7 +1086,9 @@
 			spin_unlock_irqrestore(&port->sc_port.lock, flags);
 
 			puts_raw_fixed(port->sc_ops->sal_puts_raw, s, count);
+#if defined(CONFIG_SMP) || defined(CONFIG_PREEMPT)
 		}
+#endif
 	}
 	else {
 		/* Not yet registered with serial core - simple case */