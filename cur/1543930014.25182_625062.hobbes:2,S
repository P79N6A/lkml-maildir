Date: Thu, 6 Dec 2007 20:22:15 +0200
From: "Ramagudi Naziir" <>
Subject: a problem with NETPOLL/KGDBoE
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2007/12/6/211

Hi all,
It's probably only me, but I can't connect to a kgdb host because
of bouncing ICMP unreachables. I'll be glad if you could take a look
to see if it's a bug or not.
Details:
- running a cloned  version of kgdb_2.6.23 branch of Jason's
git://git.kernel.org/pub/scm/linux/kernel/git/jwessel/linux-2.6-kgdb.git
- "modprobe kgdboe kgdboe='@10.0.0.28/,@10.0.0.11/'" works fine,
and var/log/messages get filled with six kgdboe network configuration
messages (local port 6443, local ip 10.0.0.28, interface eth0,
remote port 6442, remote ip 10.0.0.11, remote mac ff:ff:ff:ff:ff:ff).
- "netstat -aun" does not show an open 6643 UDP port (should it ?)
- When trying to connect via remote gdb, I get a connection refused:
(gdb) target remote udp:10.0.0.28:6433
warning: The remote protocol may be unreliable over UDP.
Some events may be lost, rendering further debugging impossible.
Remote debugging using udp:10.0.0.28:6433
Remote communication error: Connection refused.
- tcpdump ouput shows two UDP messages traveling to the kgdb host
only to immediately invoke ICMP unreachables:
19:30:53.424248 IP 10.0.0.11.32785 > 10.0.0.28.6433: UDP, length 5
19:30:53.424323 IP 10.0.0.11.32785 > 10.0.0.28.6433: UDP, length 14
19:30:53.426292 IP 10.0.0.28 > 10.0.0.11: ICMP 10.0.0.28 udp port 6433
unreachable, length 41
19:30:53.427542 IP 10.0.0.28 > 10.0.0.11: ICMP 10.0.0.28 udp port 6433
unreachable, length 50
- Network between 10.0.0.28 and 10.0.0.11 is just fine; I successfully work
on NFS mounts (with 10.0.0.28 as a client)
- the kgdb host has selinux=0 and  iptables with accept-all policies
- i386 (running inside a bridged qemu/vmplayer host)
- config attached
If you have any idea how to further debug this problem,
or maybe if you know if I did something wrong,
please share !
Thanks,
naziir.
[unhandled content-type:application/x-gzip]