Date: Thu, 22 May 2003 19:02:43 +0900 (JST)
From: YOSHIFUJI Hideaki / 吉藤英明 <>
Subject: Re: bk15 build fails with modular apm (undefined reference to MODULE_OWNER)
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2003/5/22/45

In article <1053592419.b2fa6d60kde@myrealbox.com> (at Thu, 22 May 2003 02:33:39 -0600), "ismail donmez" <kde@myrealbox.com> says:
> Adding 
> #define SET_MODULE_OWNER(apm_proc) do { } while (0) 
> to arch/i386/kernel/apm.c fixes this.
:
> > arch/i386/kernel/built-in.o(.init.text+0x5744): In function `apm_init':
> > : undefined reference to `SET_MODULE_OWNER'
> > make: *** [.tmp_vmlinux1] Error 1
> > :
> > 
> > Is SET_MODULE_OWNER needed or not?
I believe we should set apm_proc->owner here.
Index: linux25-LINUS/arch/i386/kernel/apm.c
===================================================================
RCS file: /cvsroot/usagi/usagi-backport/linux25/arch/i386/kernel/apm.c,v
retrieving revision 1.1.1.12
diff -u -r1.1.1.12 apm.c
--- linux25-LINUS/arch/i386/kernel/apm.c	15 May 2003 07:52:06 -0000	1.1.1.12
+++ linux25-LINUS/arch/i386/kernel/apm.c	22 May 2003 09:22:04 -0000
@@ -2013,7 +2013,7 @@
 
 	apm_proc = create_proc_info_entry("apm", 0, NULL, apm_get_info);
 	if (apm_proc)
-		SET_MODULE_OWNER(apm_proc);
+		apm_proc->owner = THIS_MODULE;
 
 	kernel_thread(apm, NULL, CLONE_FS | CLONE_FILES | CLONE_SIGHAND | SIGCHLD);
 
-- 
Hideaki YOSHIFUJI @ USAGI Project <yoshfuji@linux-ipv6.org>
GPG FP: 9022 65EB 1ECF 3AD1 0BDF  80D8 4807 F894 E062 0EEA
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.kernel.org
More majordomo info at  
http://vger.kernel.org/majordomo-info.html
Please read the FAQ at  
http://www.tux.org/lkml/