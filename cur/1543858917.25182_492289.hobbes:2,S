Date: Sun, 17 Dec 2006 12:05:30 +0000
From: "Catalin Marinas" <>
Subject: Re: [PATCH 2.6.20-rc1 00/10] Kernel memory leak detector 0.13
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2006/12/17/30

On 17/12/06, Ingo Molnar <mingo@elte.hu> wrote:
>
> it would also be nice to have more information than this:
>
>  unreferenced object 0xf76f5af8 (size 512):
>   [<c0191f23>] memleak_alloc
>   [<c018eeaa>] kmem_cache_zalloc
>   [<c03277a7>] probe_hwif
>   [<c032870c>] probe_hwif_init_with_fixup
>   [<c032aea1>] ide_setup_pci_device
>   [<c0312564>] amd74xx_probe
>   [<c069c4b4>] ide_scan_pcidev
>   [<c069c505>] ide_scan_pcibus
>   [<c069bdca>] ide_init
>   [<c0100532>] init
>   [<c0105da3>] kernel_thread_helper
>   [<ffffffff>]
BTW, I think there is a call to kzalloc in probe_hwif and it is
optimised to do a kmem_cache_zalloc in include/linux/slab_def.h. The
latest kmemleak-0.13 ifdef's out this optimisation because the size
information gets lost otherwise. The slab.h file was already patched
for this in 2.6.19 but its content was moved to slab_def.h in
2.6.20-rc1.
> it would be nice to record 1) the jiffies value at the time of
> allocation, 2) the PID and the comm of the task that did the allocation.
> The jiffies timestamp would be useful to see the age of the allocation,
> and the PID/comm is useful for context.
I'll add them. Thanks.
-- 
Catalin
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.kernel.org
More majordomo info at  
http://vger.kernel.org/majordomo-info.html
Please read the FAQ at  
http://www.tux.org/lkml/