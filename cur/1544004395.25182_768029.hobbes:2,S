Date: Wed, 12 Nov 2008 06:23:27 -0600
From: Rusty Russell <>
Subject: [PATCH 7/7] lguest: change virtio ring alignment.
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2008/11/12/117

This is just to test that the constant is wired through correctly.
lguest has no ABI so I could apply this patch, but it breaks the
"don't be an asshole" rule.
diff -r 19e5f3f3a4be Documentation/lguest/Makefile
--- a/Documentation/lguest/Makefile	Wed Nov 12 22:27:50 2008 +1030
+++ b/Documentation/lguest/Makefile	Wed Nov 12 22:38:52 2008 +1030
@@ -4,5 +4,7 @@
 
 all: lguest
 
+lguest: ../../include/linux/lguest_launcher.h
+
 clean:
 	rm -f lguest
diff -r 19e5f3f3a4be include/linux/lguest_launcher.h
--- a/include/linux/lguest_launcher.h	Wed Nov 12 22:27:50 2008 +1030
+++ b/include/linux/lguest_launcher.h	Wed Nov 12 22:38:52 2008 +1030
@@ -60,5 +60,6 @@
 	LHREQ_BREAK, /* + on/off flag (on blocks until someone does off) */
 };
 
-#define LGUEST_VRING_ALIGN	4096
+/* A cacheline is enough separation between producer and consumer. */
+#define LGUEST_VRING_ALIGN	128
 #endif /* _LINUX_LGUEST_LAUNCHER */