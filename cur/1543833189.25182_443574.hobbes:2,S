Date: Wed, 12 Jul 2006 16:03:28 +0200
From: Olivier Galibert <>
Subject: Re: PATCH: Fix Jmicron support
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2006/7/12/139

On Wed, Jul 12, 2006 at 03:05:41PM +0100, Alan Cox wrote:
> + *	If we are using libata we can drive this chip proeprly but must
> + *	do this early on to make the additional device appear during
> + *	the PCI scanning.
"properly"
> +static void __devinit quirk_jmicron_dualfn(struct pci_dev *pdev)
> +{
> +	u32 conf;
> +	u8 hdr;
> +
> +	/* Only poke fn 0 */	
> +	if (PCI_FUNC(pdev->devfn))
> +		return;
> +		
> +	switch(pdev->device) {
> +		case PCI_DEVICE_ID_JMICRON_JMB365:
> +		case PCI_DEVICE_ID_JMICRON_JMB366:
> +			/* Redirect IDE second PATA port to the right spot */
> +			pci_read_config_dword(pdev, 0x80, &conf);
> +			conf |= (1 << 24);
> +			/* Fall through */
> +			pci_write_config_dword(pdev, 0x80, conf);
> +		case PCI_DEVICE_ID_JMICRON_JMB361:
> +		case PCI_DEVICE_ID_JMICRON_JMB363:
Wouldn't you want to put the fall throught comment after the
pci_write?  Took me a moment to parse it given its position
  OG.
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.kernel.org
More majordomo info at  
http://vger.kernel.org/majordomo-info.html
Please read the FAQ at  
http://www.tux.org/lkml/