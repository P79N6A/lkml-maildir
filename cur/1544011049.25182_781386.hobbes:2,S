Date: Wed, 17 Dec 2008 02:51:54 +0100
From: Andi Kleen <>
Subject: Re: [Perfctr-devel] [patch] Performance Counters for Linux, v4
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2008/12/16/523

William Cohen <wcohen@redhat.com> writes:
>
> PERF_COUNT_CACHE_REFERENCES and PERF_COUNT_CACHE_MISSES are not single
> monolitic events on many processors. There are multiple cache
> levels. The L1 cache most processors have separate instruction and
> data caches and require multiple counters to implement. Would these
> refer to the last level of cache before memory and just be used to
> compute the hit/miss rate for that last level? Some processors in the
> same family have L2 and some processors have L3 cache. The setup code
> would need to distinguish between these processor variants.
The difference between L1 and L3 caches can be huge (in some cases
two orders of magnitude). With that I'm not sure a single cache
miss/hit event even makes any sense. 
On a modern CPU with L2 and L3 caches as soon as you fall out 
of the L2 you're going to perform more poorly on parallel workloads.
With that you really have to distingush some levels.
-Andi
-- 
ak@linux.intel.com