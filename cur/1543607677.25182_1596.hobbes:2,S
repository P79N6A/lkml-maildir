Date: Sun, 28 Oct 2001 17:32:30 +0100
From: Alexander Schulz <>
Subject: [RFC] RTC policy questions
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2001/10/28/60

Hello,
I am currently working on porting the linux kernel to
the Shark, a StrongARM based computer (DNARD from digital)
that contains many parts known from PCs.
On the Shark I have to use the (PC-like) RealTimeClock as a
heartbeat source. This has two consequences:
1) No user may be allowed to alter the frequency of
   the RTC interrupt or even turn it off.
   AFAIK the alarm cannot be used, because it uses
   the same irq.
2) I would like to use the set_rtc_irq_bit and
   get_rtc_time functions from drivers/char/rtc.c in
   include/asm-arm/arch-shark/time.h to setup the
   rtc at bootup. That means that they cannot be
   static in rtc.c.
a) I could avoid 2) by duplicating the functions in time.h
   (it seems arch-ebsa285/time.h implements its own setup),
   but I hate duplicating code.
b) I solved 1) by patching rtc.c to exclude the offending
   code if CONFIG_ARCH_SHARK is defined. The only other way
   I can think of would be to have a complete rtc driver
   for the shark but that again would mean duplicating code.
What do you think? Is it ok to patch the rtc.c or would it be
better to duplicate the code? Are there more possible solutions
that I cannot think of?
I am using 2.4.12-ac6-rmk2 at the moment but the problem is
mostly version independent.
Thanks for all comments
   Alexander
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.kernel.org
More majordomo info at  
http://vger.kernel.org/majordomo-info.html
Please read the FAQ at  
http://www.tux.org/lkml/