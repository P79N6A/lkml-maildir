Date: Mon, 31 Jul 2000 15:20:33 -0600
From: Christopher Thompson <>
Subject: Re: gettimeofday() non-monotonic on SMP kernel version 2.2.10
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2000/7/31/150

On Mon, 31 Jul 2000, you wrote:
> Hi,
> 
> I work for a neuroscience lab at Caltech 
> (
http://broccoli.caltech.edu/~pinelab/PotterGroup.htm
), and we are trying
> to gather data using a quad-processor SGI Visual Workstation 540. However,
> we are having trouble that we have diagnosed as a timing issue.
> gettimeofday() is non-monotonic, which is causing problems with some of
> the software we use, problems we can't really work around. We are using
> the 2.2.10 kernel, and we really have no choice as all of the hacks to
> make linux run on the Visual Workstation 540 are only available in a patch
> for kernel version 2.2.10 and none of us are very skilled kernel hackers.
> 
> Can anyone point me to a patchfor 2.2.10 or a way to quickly modify the
> 2.2.10 code to fix this problem. Something somewhat odd is that the
> gettimeofday()  seems to pretty consistently jump back about 3-4 seconds.
> It's also only present  when running Xwindows and is highly correlated
> with changes in window focus.
This sounds almost exactly like the problems I was having when I
used to have an SMP machine with different speed CPUs.  Is this
true here?  Or are all of your processors running at the same
speed?
I wrote a couple of patches which are available at
http://hypocrite.org/linux/
  (the ...new... patch is most likely
to help).  These are against 2.3.99-pre if memory serves but
should port easily to earlier kernels.
Alternatively, try compiling and telling the kernel that you are
using a 586-possibly-without-TSC which *may* help.
I am most interested in hearing the results...
-- 
Christopher Thompson  
http://hypocrite.org/
  All spam is reported
- The average chocolate bar has 8 insects' legs in it.
- The average human eats 8 spiders in their lifetime at night. 
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.rutgers.edu
Please read the FAQ at 
http://www.tux.org/lkml/