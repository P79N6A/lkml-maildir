Date: Fri, 23 Jan 2009 19:58:16 +0900
From: Magnus Damm <>
Subject: [PATCH 004/011] sh: plat_early_device_setup() for sh2a
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2009/1/23/133

From: Magnus Damm <damm@igel.co.jp>
This patch adds sh2a code to register early platform devices
using plat_early_device_setup().
Signed-off-by: Magnus Damm <damm@igel.co.jp>
---
 arch/sh/kernel/cpu/sh2a/setup-mxg.c    |    5 +++++
 arch/sh/kernel/cpu/sh2a/setup-sh7201.c |    5 +++++
 arch/sh/kernel/cpu/sh2a/setup-sh7203.c |    5 +++++
 arch/sh/kernel/cpu/sh2a/setup-sh7206.c |    5 +++++
 4 files changed, 20 insertions(+)
--- 0014/arch/sh/kernel/cpu/sh2a/setup-mxg.c
+++ work/arch/sh/kernel/cpu/sh2a/setup-mxg.c	2009-01-23 17:30:02.000000000 +0900
@@ -158,6 +158,11 @@ static int __init mxg_devices_setup(void
 }
 __initcall(mxg_devices_setup);
 
+void __init plat_early_device_setup(void)
+{
+	early_platform_add_devices(mxg_devices, ARRAY_SIZE(mxg_devices));
+}
+
 void __init plat_irq_setup(void)
 {
 	register_intc_controller(&intc_desc);
--- 0014/arch/sh/kernel/cpu/sh2a/setup-sh7201.c
+++ work/arch/sh/kernel/cpu/sh2a/setup-sh7201.c	2009-01-23 17:28:28.000000000 +0900
@@ -397,6 +397,11 @@ static int __init sh7201_devices_setup(v
 }
 __initcall(sh7201_devices_setup);
 
+void __init plat_early_device_setup(void)
+{
+	early_platform_add_devices(sh7201_devices, ARRAY_SIZE(sh7201_devices));
+}
+
 void __init plat_irq_setup(void)
 {
 	register_intc_controller(&intc_desc);
--- 0014/arch/sh/kernel/cpu/sh2a/setup-sh7203.c
+++ work/arch/sh/kernel/cpu/sh2a/setup-sh7203.c	2009-01-23 17:28:47.000000000 +0900
@@ -342,6 +342,11 @@ static int __init sh7203_devices_setup(v
 }
 __initcall(sh7203_devices_setup);
 
+void __init plat_early_device_setup(void)
+{
+	early_platform_add_devices(sh7203_devices, ARRAY_SIZE(sh7203_devices));
+}
+
 void __init plat_irq_setup(void)
 {
 	register_intc_controller(&intc_desc);
--- 0014/arch/sh/kernel/cpu/sh2a/setup-sh7206.c
+++ work/arch/sh/kernel/cpu/sh2a/setup-sh7206.c	2009-01-23 17:29:43.000000000 +0900
@@ -243,6 +243,11 @@ static int __init sh7206_devices_setup(v
 }
 __initcall(sh7206_devices_setup);
 
+void __init plat_early_device_setup(void)
+{
+	early_platform_add_devices(sh7206_devices, ARRAY_SIZE(sh7206_devices));
+}
+
 void __init plat_irq_setup(void)
 {
 	register_intc_controller(&intc_desc);