Date: Thu, 26 Oct 2000 11:00:29 +0100
From: "Stephen C. Tweedie" <>
Subject: Re: Quota mods needed for journaled quota
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2000/10/26/99

Hi,
On Thu, Oct 26, 2000 at 12:53:00PM -0400, Nathan Scott wrote:
> > The addition of an "init_quota" method to the super_operations struct,
> > with quota_on calling this and defaulting to installing the default
> > quota_ops if the method is NULL, ought to be sufficient to let ext3
> > get quotas right in all cases as far as I can see.
> 
> It might also/alternatively be generally useful to allow a
> filesystem-specific implementation of quotactl itself - through
> an additional member in the dquot_operations set of functions?
I'm not sure how useful that addition would be --- for quota_on and
quota_off, at least, the setting up of the dquot structures around the
superblock or their destruction after quota_off can probably stay as
common code, with calls into the filesystem for init_quota (and
perhaps destroy_quota?) at the appropriate places.
> This would allow ext3 to do that which it needs to do differently
> at Q_QUOTAON and would also allow Jan's changes to work in such
> a way that both the current form of dquot structure and his new
> version of dquots could be used together
Adding the init_quota hook would do that, as the filesystem will be
able to install its own dq_ops methods during the init so we get the
flexibility you are asking for anyway.
Cheers,
 Stephen
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.kernel.org
Please read the FAQ at 
http://www.tux.org/lkml/