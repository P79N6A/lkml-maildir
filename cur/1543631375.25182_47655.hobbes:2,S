Date: Thu, 23 May 2002 09:30:10 +1000
From: Nathan Scott <>
Subject: Re: Quota patches
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2002/5/22/328

hi there,
On Thu, May 23, 2002 at 04:46:28AM +0900, OGAWA Hirofumi wrote:
> What do you think of the following patches for kernel without
> quota support? We already have weak symbol for sys_quotactl(). 
> 
> --- linux-bk/fs/Makefile        Wed May 22 01:17:48 2002
> +++ linux-2.5.17/fs/Makefile    Thu May 23 03:23:30 2002
> @@ -15,7 +15,7 @@
>                 namei.o fcntl.o ioctl.o readdir.o select.o fifo.o locks.o \
>                 dcache.o inode.o attr.o bad_inode.o file.o iobuf.o dnotify.o \
>                 filesystems.o namespace.o seq_file.o xattr.o libfs.o \
> -               fs-writeback.o quota.o
> +               fs-writeback.o
> 
>  ifneq ($(CONFIG_NFSD),n)
>  ifneq ($(CONFIG_NFSD),)
> @@ -81,7 +81,7 @@
> 
>  obj-$(CONFIG_BINFMT_ELF)       += binfmt_elf.o
> 
> -obj-$(CONFIG_QUOTA) += dquot.o
> +obj-$(CONFIG_QUOTA) += dquot.o quota.o
>  obj-$(CONFIG_QFMT_V1) += quota_v1.o
>  obj-$(CONFIG_QFMT_V2) += quota_v2.o
> 
On Wed, May 22, 2002 at 09:57:00PM +0200, Jan Kara wrote:
>   I know this but this file is also needed by XFS people so it isn't
> so easy.  But as XFS stuff is not currently in kernel the change is
A change to the patch like this would make this work for us too:
replacing:
-obj-$(CONFIG_QUOTA) += dquot.o
+obj-$(CONFIG_QUOTA) += dquot.o quota.o
with just:
+obj-$(CONFIG_QUOTACTL) += quota.o
Needs to be fleshed out a little bit, of course - both CONFIG_QUOTA
and CONFIG_XFS_QUOTA (from the XFS patches) would need fs/Config.in
changes to add the new $CONFIG_QUOTACTL dependency, but that should
just about do the trick I think.
cheers.
-- 
Nathan
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.kernel.org
More majordomo info at  
http://vger.kernel.org/majordomo-info.html
Please read the FAQ at  
http://www.tux.org/lkml/