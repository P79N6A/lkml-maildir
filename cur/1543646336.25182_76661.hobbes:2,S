Date: Fri, 04 Oct 2002 17:40:07 -0400
From: Jeff Garzik <>
Subject: Re: [BK PATCH] pcibios_* removals for 2.5.40
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2002/10/4/318

Greg KH wrote:
> # This is a BitKeeper generated patch for the following project:
> # Project Name: Linux kernel tree
> # This patch format is intended for GNU patch command version 2.5 or higher.
> # This patch includes the following deltas:
> #	           ChangeSet	1.674.3.3 -> 1.674.3.4
> #	drivers/char/rocket.c	1.12    -> 1.13   
> #	drivers/scsi/inia100.c	1.10    -> 1.11   
> #	 drivers/sbus/sbus.c	1.15    -> 1.16   
> #
> # The following is the BitKeeper ChangeSet Log
> # --------------------------------------------
> # 02/10/04	greg@kroah.com	1.674.3.4
> # PCI: fixed remaining usages of pcibios_present() that I missed previously.
> # --------------------------------------------
> #
> diff -Nru a/drivers/char/rocket.c b/drivers/char/rocket.c
> --- a/drivers/char/rocket.c	Fri Oct  4 13:47:29 2002
> +++ b/drivers/char/rocket.c	Fri Oct  4 13:47:29 2002
> @@ -1993,7 +1993,7 @@
>  			isa_boards_found++;
>  	}
>  #ifdef CONFIG_PCI
> -	if (pcibios_present()) {
> +	if (pci_present()) {
>  		if(isa_boards_found < NUM_BOARDS)
>  			pci_boards_found = init_PCI(isa_boards_found);
>  	} else {
can be greatly simplified -- just simply all the code in the ifdef to 
"if (isa_boards_found...) ...init_PCI..."
> diff -Nru a/drivers/sbus/sbus.c b/drivers/sbus/sbus.c
> --- a/drivers/sbus/sbus.c	Fri Oct  4 13:47:29 2002
> +++ b/drivers/sbus/sbus.c	Fri Oct  4 13:47:29 2002
> @@ -312,7 +312,7 @@
>  		nd = prom_searchsiblings(topnd, "sbus");
>  		if(nd == 0) {
>  #ifdef CONFIG_PCI
> -			if (!pcibios_present()) {	
> +			if (!pci_present()) {
>  				prom_printf("Neither SBUS nor PCI found.\n");
>  				prom_halt();
>  			} else {
I wonder if this is intentional arch code should not be changed...  David?
> diff -Nru a/drivers/scsi/inia100.c b/drivers/scsi/inia100.c
> --- a/drivers/scsi/inia100.c	Fri Oct  4 13:47:29 2002
> +++ b/drivers/scsi/inia100.c	Fri Oct  4 13:47:29 2002
> @@ -208,7 +208,7 @@
>  	/*
>  	 * PCI-bus probe.
>  	 */
> -	if (pcibios_present()) {
> +	if (pci_present()) {
test looks like it can be eliminated completely
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.kernel.org
More majordomo info at  
http://vger.kernel.org/majordomo-info.html
Please read the FAQ at  
http://www.tux.org/lkml/