Date: Mon, 14 Jan 2008 15:09:10 +0100
From: Sam Ravnborg <>
Subject: Re: [PATCH x86] [15/16] Force __cpuinit on for CONFIG_PM without HOTPLUG_CPU
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2008/1/14/159

On Mon, Jan 14, 2008 at 02:52:40PM +0100, Ingo Molnar wrote:
> 
> * Adrian Bunk <bunk@kernel.org> wrote:
> 
> > On Thu, Jan 10, 2008 at 02:12:59PM +0100, Andi Kleen wrote:
> > > Adrian Bunk <bunk@kernel.org> writes:
> > > >
> > > > Technically you are the one who has to deal with problems in your 
> > > > patches, not the people pointing at the problems.
> > > 
> > > If you believe that my patch adds a new problem then please describe
> > > it clearly so that I can understand it.
> > 
> > Description:
> > - there are already __cpuinit* annotations in the kernel
> > - on UP kernels supporting suspend/resume, such annotated code
> >   currently gets freed after booting (and this works)
> > - with your patch applied, this code no longer gets freed
> 
> ok, i've dropped this patch from x86.git for now:
> 
>  Subject: x86: force __cpuinit on for CONFIG_PM without HOTPLUG_CPU
>  From: Andi Kleen <ak@suse.de>
> 
> but longer-term, shouldnt these annotations be automated? We'll see a 
> constant stream of them, all around the clock as people regularly get it 
> wrong (because it's not intuitive).
Would be great to have them automated - just dunno how to do it.
Do you see a feasible way to do it?
Short term modpost etc. will be enhanced to be less dependent on the actual
configuration when performing the checks.
It should not matter if CONFIG_HOTPLUG_CPU is enabled or not when we check
the __cpuint annotations but this is how we see it today so far
too many faults slip through.
	Sam