Date: Thu, 10 Feb 2000 10:15:24 -0000 (GMT)
From: Anton Ivanov <>
Subject: RE: Trunking (was: Gigabit Linux Server Bottlenecks)
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2000/2/10/26

-----BEGIN PGP SIGNED MESSAGE-----
On 08-Feb-2000 Robert Johannes wrote:
> eh, not sure.
> 
> I was just thinking of lumping a bunch of interfaces together ( I suppose
> sun-style) and creating one gigantic pipe from them.
The following is "as far as I know of" and "supposed to assuming multipath
forwarding works peroperly". Please correct me if I am wrong. 
All 
        #include "stdisclaimer.h" 
apply ;-)
> 
> Does this need to be supported by the switch or hub for it to work?  Can
Yes, by both switch and host.
> it also work with a plain-old dual speed hub?
No, besides one case, see below
> 
> robert
> 
There is a piece of junk usually referred as Ethernet stripping. It is what
MindC**p actually used to win the NT vs Linux benchmark. At least this the way
I see the data in German's C'T article on a the becnhmark rerun.
Basically it boils down to the following:
If connected to a network with more than one interface NT (at least under some
conditions) does round robin on the Ethers for emitting packets. The Actual IP
address of the interfaces does not matter. As a result you can get a pretty full
concatenated pipe if your traffic is:
A) disbalanced like web or lots of clients pulling stuff off a file server
B) server is being hit randomly due to DNS round/robin or other load balancing
technique.
Note on this one: If you have a look at instructions on using concatenated
Ethers on NT you will see that "all trunking functions must be turned off".
In order to get the same result with linux you have to use the following setup:
1. The service (web, whatever) hanging off a loopback alias on the linux host.
2. A switch with multipath routing capabilities having a route per each Ether
to the linux host. 
3. The linux host having multipath enabled (2.2+) and multipath routes back.
If it does not balance properly in this case there has to be some problem with
multipath (this is forwarding, so it should work).
Otherwise it will answer strictly from the interface that has been hit as per
Mindcraft and C'T benchmarks.
Brgds,
- ----------------------------------
Anton R. Ivanov
IP Engineer Level3 Communications
RIPE: ARI2-RIPE      E-Mail: Anton Ivanov <aivanov@eu.level3.net>
@*** Vonnegut's Corollary ***
      Beauty may be only skin deep, but ugliness goes
      right to the core.
- ----------------------------------
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.0.0 (GNU/Linux)
Comment: For info see 
http://www.gnupg.org
iQEVAwUBOKKPuylWAw/bM84zAQHocwf+MK2f9evPosfxvBKnWsykuyVeVw2I+8qx
94cHtFt6+ByYOY1E9EiRpUn8W6vpVgIjvkJA9pRB+P+VkZMq85hcXZZKhb0NqWdf
OyR/i+gPaeScodjjN99IUpINhD8nwbWK0maRphkQ03UEENILxTEPD4S+SgQDPnwL
SrjYyEURp33lCKfZP58gB7SQXftaxYReg8IYhIsO6DIa4ujkgZJvTDg/MpPQX7K4
5imRN8lWHpKdEbQM6ojO+fkxijQGtr0S0oMb1jWCwztXoPSwRN9bhYBxkp+ee39b
JqJm3Tqr1mUb0bijQyn9oFFwqy58or/P2d+FxqDPS8CePZtkwwCHEg==
=e3RX
-----END PGP SIGNATURE-----
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.rutgers.edu
Please read the FAQ at 
http://www.tux.org/lkml/