Date: Wed, 14 Jan 2009 15:45:35 +0900
From: "MinChan Kim" <>
Subject: Re: lowmemory android driver not needed?
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2009/1/14/25

Hi, Arve.
On Wed, Jan 14, 2009 at 11:30 AM, Arve Hjønnevåg <arve@android.com> wrote:
> The oom killer does not kick in until all caches are emptied. Our user
> space code changes the oom_adj value of processes that are no longer
> in the foreground so that they killed first (the process saves its
> state but does not exit). To avoid excessive demand paging, the low
> memory killer will kill these processes when the memory available
> drops below a threshold.
It have some problems. (drivers/staging/android/lwmemorykiller.c)
1. lowmem_shrink function have to answer about vm's query the cache size fast.
2. it don't consider page size and memory size when it make
lowmem_minfree's values.
3. If system have many processes, for_each_process take a long time.
it may result system latency although lowmemkiller intend to avoid
latency.
4. Most important thing. Could we use memory controller instead of
lowmemkiller ? I am not sure since I don't follow up memory controller
in these days.
I think we have to use existing facility if possible.
Previously, There are similar kinds of patches. but It can't merge
mainline due to some issue.  They can comment about lowmemkiller. I
will CC them.
> --
> Arve Hjønnevåg
>
>
> On Tue, Jan 13, 2009 at 6:18 PM, Brian Swetland <swetland@google.com> wrote:
>>
>> Looping in Arve who wrote the low memory killer and can explain things
>> in more detail.
>>
>> Brian
>>
>> [Greg KH <greg@kroah.com>]
>>> Hi San,
>>>
>>> Alan Cox pointed me at the /proc/<pid>/oom_adj file that controls the
>>> oom-killer score for any process as being more than sufficent to control
>>> the oom killer.
>>>
>>> This makes me wonder why you wrote the android lowmemlorykiller driver?
>>>
>>> What is that driver for that is not already present in the existing
>>> oom_* values for every process?
>>>
>>> thanks,
>>>
>>> greg k-h
>> --
>> To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
>> the body of a message to majordomo@vger.kernel.org
>> More majordomo info at  
http://vger.kernel.org/majordomo-info.html
>> Please read the FAQ at  
http://www.tux.org/lkml/
>>
> --
> To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
> the body of a message to majordomo@vger.kernel.org
> More majordomo info at  
http://vger.kernel.org/majordomo-info.html
> Please read the FAQ at  
http://www.tux.org/lkml/
>
-- 
Kinds regards,
MinChan Kim