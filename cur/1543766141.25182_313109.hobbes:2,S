Date: Thu, 21 Apr 2005 08:05:22 -0700
From: David Mosberger <>
Subject: Re: [Gelato-technical] Re: Serious performance degradation on a RAID with kernel 2.6.10-bk7 and later
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2005/4/21/125

Tony and Andrew,
I just checked 2.6.12-rc3 and the fls() fix is indeed missing.  Do you
know what happened?
	--david
>>>>> On Thu, 21 Apr 2005 13:30:50 +0200, Andreas Hirstius <Andreas.Hirstius@cern.ch> said:
  Andreas> Hi, The fls() patch from David solves the problem :-))
  Andreas> Do you have an idea, when it will be in the mainline
  Andreas> kernel??
  Andreas> Andreas
  Andreas> Bartlomiej ZOLNIERKIEWICZ wrote:
  >>  Hi!
  >> 
  >>> A small update.
  >>> 
  >>> Patching mm/filemap.c is not necessary in order to get the
  >>> improved performance!  It's sufficient to remove
  >>> roundup_pow_of_two from |get_init_ra_size ...
  >>> 
  >>> So a simple one-liner changes to picture dramatically.  But why
  >>> ?!?!?
  >> 
  >> 
  >> roundup_pow_of_two() uses fls() and ia64 has buggy fls()
  >> implementation [ seems that David fixed it but patch is not in
  >> the mainline yet]:
  >> 
  >> 
http://www.mail-archive.com/linux-ia64@vger.kernel.org/msg01196.html
  >> 
  >> That would also explain why you couldn't reproduce the problem on
  >> ia32 Xeon machines.
  >> 
  >> Bartlomiej
  >> 
  Andreas> _______________________________________________
  Andreas> Gelato-technical mailing list
  Andreas> Gelato-technical@gelato.unsw.edu.au
  Andreas> 
https://www.gelato.unsw.edu.au/mailman/listinfo/gelato-technical
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.kernel.org
More majordomo info at  
http://vger.kernel.org/majordomo-info.html
Please read the FAQ at  
http://www.tux.org/lkml/