Date: Tue, 3 Aug 2004 23:13:39 +0200
From: Arjan van de Ven <>
Subject: Re: [patch] mlock-as-nonroot revisted
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2004/8/3/167

On Tue, Aug 03, 2004 at 11:07:37PM +0200, Andrea Arcangeli wrote:
> On Tue, Aug 03, 2004 at 04:55:49PM -0400, Rik van Riel wrote:
> > @@ -198,9 +201,11 @@
> >  		return error;
> >  	}
> > 
> > -	if (shmflg & SHM_HUGETLB)
> > +	if (shmflg & SHM_HUGETLB) {
> > +		/* hugetlb_zero_setup takes care of mlock user accounting */
> >  		file = hugetlb_zero_setup(size);
> > -	else {
> > +		shp->mlock_user = current->user;
> > +	} else {
> >  		sprintf (name, "SYSV%08x", key);
> >  		file = shmem_file_setup(name, size, VM_ACCOUNT);
> >  	}
> 
> where do you change mlock_user in chown?
ok silly question maybe, but why would you?
The user that mlock'd gets to pay for it, and gets his credits back at
munlock. Chown doesn't really matter in that regard..... The thing that does
matter of course is that the user who "paid" in credits gets them back in
the end.. and that this does.
But maybe you see a useful use pattern that I'm missing? Please convince me :)
[unhandled content-type:application/pgp-signature]