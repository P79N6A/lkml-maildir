Date: Tue, 26 Feb 2002 20:16:26 +0100
From: Florian Lohoff <>
Subject: Re: [CRASH] gdth / __block_prepare_write: zeroing uptodate buffer! / NMI Watchdog detected LOCKUP
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2002/2/26/227

On Tue, Feb 26, 2002 at 11:04:55AM -0800, Andrew Morton wrote:
> > __block_prepare_write: zeroing uptodate buffer!
> 
> Yup.   This happens when the disk fills up.  Andrea and I were
> discussing it over the weekend.   There's a new patch in the -aa
> kernels which doesn't quite fix it :(
> 
> We'll fix it in 2.4.19-pre somehow.  It's possible that this problem
> causes a chnuk of zeroes to be written into the file when you hit
> ENOSPC, which is rather rude.  But your file was truncated anyway.
I dont think the machine had full filesystems at all.
> SCSI error recovery deadlocked.
> 
> Now it's *just* conceivable that the __block_prepare_write() problem
> caused a junk request to be sent down to the driver, which caused
> the driver to enter recovery, which it then screwed up.   But I
> doubt it.
> 
> It's also conceivable that the NMI watchdog code itself caused
> problems also.   Back in the days when it was permanently enabled,
> some machines kept going silly until nmi watchdog was enabled.
I have seen a lot of deadlocks on these machines for the last months - I
never got ANY output - Nothing in the syslog, no oops. I am running
now with the nmi_watchdog for 4 weeks and have seen 10-15 crashes on 2
machines with no output. This was the first deadlock with some output 
at all which is very frustrating.
Flo
-- 
Florian Lohoff                  flo@rfc822.org             +49-5201-669912
Nine nineth on september the 9th              Welcome to the new billenium
[unhandled content-type:application/pgp-signature]