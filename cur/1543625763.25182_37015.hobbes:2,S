Date: Sun, 24 Mar 2002 13:50:16 -0800
From: Andrew Morton <>
Subject: [patch] speed up ext3 synchronous mounts
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2002/3/24/129

Again, we don't need to sync indirects as we dirty them because
we run a commit if IS_SYNC(inode) prior to returning to the
caller of write(2).
Writing a 10 meg file in 0.1 meg chunks is sped up by, err,
a factor of fifty.  That's a best case.
--- linux-2.4.18-pre8/fs/ext3/inode.c	Tue Feb  5 00:33:05 2002
+++ linux-akpm/fs/ext3/inode.c	Wed Feb  6 23:40:48 2002
@@ -581,8 +581,6 @@ static int ext3_alloc_branch(handle_t *h
 			
 			parent = nr;
 		}
-		if (IS_SYNC(inode))
-			handle->h_sync = 1;
 	}
 	if (n == num)
 		return 0;
-
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.kernel.org
More majordomo info at  
http://vger.kernel.org/majordomo-info.html
Please read the FAQ at  
http://www.tux.org/lkml/