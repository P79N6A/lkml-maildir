Date: Tue, 01 Aug 2006 01:00:08 +0900
From: Tejun Heo <>
Subject: Re: [2.6.18-rc2-mm1] libata ate one PATA channel
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2006/7/31/172

J.A. MagallÃ³n wrote:
> werewolf:~> lspci
> 00:1f.1 IDE interface: Intel Corporation 82801EB/ER (ICH5/ICH5R) IDE Controller (rev 02)
> 00:1f.2 IDE interface: Intel Corporation 82801EB (ICH5) SATA Controller (rev 02)
> werewolf:~> lspci -n
> 00:1f.1 0101: 8086:24db (rev 02)
> 00:1f.2 0101: 8086:24d1 (rev 02)
You compiled w/ ATA_ENABLE_PATA, right?
>> Also, can you report what the kernel says with the 
>> attached patch applied?
>>
> 
> I reworked it to look like this:
> 
>     if (legacy_mode) {
>         probe_ent = ata_pci_init_legacy_port(pdev, port, legacy_mode);
>         dev_printk(KERN_INFO, &pdev->dev,
>            "XXX: legacy_mode probe_ent=%p\n", probe_ent);
This is where the problem is.  Ah.. I see.  Alan's 
rework-legacy-handling patch got into mm.
=====
rework-legacy-handling-to-remove-much-of-the-cruft.patch
From: Alan Cox <alan@lxorguk.ukuu.org.uk>
Kill host_set->next
Fix simplex support
Allow per platform setting of IDE legacy bases
Turn per device tuning on so that PATA timings are fully enabled
Some of this can be tidied further later on, in particular all the
legacy port gunge belongs as a PCI quirk/PCI header decode to understand
the special legacy IDE rules in the PCI spec.
Longer term Jeff also wants to move the request_irq/free_irq out of core
which will make this even cleaner.
=====
These are patches #110-112.  Andrew, can you drop those patches for the 
time being?  I'm working on integrating those into libata #upstream now. 
  Also, please drop #113 libata_resume_fix.patch.  This shouldn't be 
necessary anymore.
Thanks.
-- 
tejun
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.kernel.org
More majordomo info at  
http://vger.kernel.org/majordomo-info.html
Please read the FAQ at  
http://www.tux.org/lkml/