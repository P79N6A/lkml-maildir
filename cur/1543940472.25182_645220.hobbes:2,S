Date: Tue, 29 Jan 2008 12:00:57 -0800
From: Mike Travis <>
Subject: Re: [PATCH 0/3] percpu: Optimize percpu accesses
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2008/1/29/361

Ingo Molnar wrote:
...
> 
> tried it on x86.git and 1/3 did not build and 2/3 causes a boot hang 
> with the attached .config.
> 
> 	Ingo
> 
I've tracked down the failure to an early printk that when CONFIG_PRINTK_TIME
is enabled, any early printks cause cpu_clock to be called, which accesses
cpu_rq which is defined as:
 595 #define cpu_rq(cpu)             (&per_cpu(runqueues, (cpu)))
Since the zero-based patch is changing the offset from one based on
__per_cpu_start to zero, it's causing the function to access a
different area.
I'm working on a fix now.
Thanks,
Mike