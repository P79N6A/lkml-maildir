Date: Tue, 14 Sep 2004 12:02:22 +1000
From: Nick Piggin <>
Subject: Re: 2.6.9-rc1-mm5
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2004/9/13/325

Jesse Barnes wrote:
> On Monday, September 13, 2004 11:10 am, Jesse Barnes wrote:
> 
>>On Monday, September 13, 2004 11:06 am, Paul Jackson wrote:
>>
>>>Jesse wrote:
>>>
>>>>I'll send out a more complete one later (unless
>>>>Paul beat me to it,
Sorry, I actually did read your mail about the SD_NODE_INIT thing. It
slipped my mind :(
>>>
>>>See my patch posted a few hours ago:
>>>
>>>  [Patch] Fix sched make domain setup overridable
>>
>>Yeah, I saw that, thanks.  I meant a more complete dmesg (i.e. one for a
>>bigger system).  I've got a 32p reserved for later today.
> 
> 
> Here's one from a 32p, 16 node machine (captured while scsi was still coming 
> up, but you probably don't care about that).
> 
OK, in that case you'll also need the attached patch.
Sigh. We'll get there one day.
---
 linux-2.6-npiggin/include/asm-ia64/processor.h |    3 ++-
 1 files changed, 2 insertions(+), 1 deletion(-)
diff -puN include/asm-ia64/processor.h~ia64-make-node-balance include/asm-ia64/processor.h
--- linux-2.6/include/asm-ia64/processor.h~ia64-make-node-balance	2004-09-14 11:57:05.000000000 +1000
+++ linux-2.6-npiggin/include/asm-ia64/processor.h	2004-09-14 11:57:38.000000000 +1000
@@ -349,7 +349,8 @@ struct task_struct;
 	.cache_hot_time		= (10*1000000),		\
 	.cache_nice_tries	= 1,			\
 	.per_cpu_gain		= 100,			\
-	.flags			= SD_BALANCE_EXEC	\
+	.flags			= SD_LOAD_BALANCE	\
+				| SD_BALANCE_EXEC	\
 				| SD_WAKE_BALANCE,	\
 	.last_balance		= jiffies,		\
 	.balance_interval	= 10,			\
_