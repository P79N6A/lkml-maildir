Date: Wed, 7 Apr 1999 23:18:27 +0000 (   )
From: David Frana <>
Subject: Oops in Zftape Driver (kernel 2.2.5)
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/1999/4/8/3

Hello, i have found this bug in (z)ftape under Linux-2.2.5,
i hope the attached Files provide Enough information,
if they do not, let me know (fhopge@cin.net)
thank you.
Kernel Driver
version       : ftape v3.04d 25/11/97
used data rate: 500 kbit/sec
dma memory    : 96 kb
debug messages: informational
Tape Drive
vendor id : 0x0047
drive name: Colorado DJ-10/DJ-20
wind speed: 90 ips
wakeup    : Colorado
max. rate : 500 kbit/sec
FDC Controller
FDC type  : i82077AA
FDC base  : 0x3f0
FDC irq   : 6
FDC dma   : 2
FDC thr.  : 8
max. rate : 1000 kbit/sec
Tape Cartridge
segments  :   102
tracks    :    20
length    :   307ft
formatted : yes
writable  : yes
QIC spec. : QIC-40
fmt-code  : 2
History Record
FDC isr statistics
 id_am_errors     :   0
 id_crc_errors    :   0
 data_am_errors   :   0
 data_crc_errors  :   0
 overrun_errors   :   0
 no_data_errors   :   0
 retries          :   0
ECC statistics
 crc_errors       :   0
 crc_failures     :   0
 ecc_failures     :   0
 sectors corrected:   0
tape quality statistics
 media defects    :   0
tape motion statistics
 repositions      :   0
int-21h:~# mt tell
Unable to handle kernel NULL pointer dereference at virtual address
00000010
current->tss.cr3 = 00baa000, %cr3 = 00baa000
*pde = 00000000
Oops: 0000
CPU:    0
EIP:    0010:[<c2060c0f>]
EFLAGS: 00010213
eax: c2065888   ebx: 00000005   ecx: c20615fc   edx: 00000000
esi: 00000005   edi: 00000005   ebp: ffffffff   esp: c0badeec
ds: 0018   es: 0018   ss: 0018
Process mt (pid: 100, process nr: 24, stackpage=c0bad000)
Stack: 00000005 00000002 00000000 00076000 00076000 c0101c24 00003063
c2076000
       c0101c24 c011cf1f c2400000 00008000 00007400 c205a02a ffffffff
00000004
       c205bc66 c0badf58 80046d03 00000004 c205c90b c0badf58 00000004
c0bac000
Call Trace: [<c0101c24>] [<c2076000>] [<c0101c24>] [<c011cf1f>]
[<c2400000>] [<c205a02a>] [<c205bc66>]
       [<c205c90b>] [<c2061425>] [<c012259b>] [<c20616d6>] [<c0129ff0>]
[<c0107a04>]
Code: 39 6a 10 72 bc eb 3c 89 f6 8b 42 04 a3 d8 58 06 c2 83 3d ec
Segmentation fault
Options used: -V (default)
              -o /lib/modules/2.2.5/ (default)
              -k /proc/ksyms (default)
              -l /proc/modules (default)
              -m /boot/System.map (specified)
              -c 1 (default)
Unable to handle kernel NULL pointer dereference at virtual address
00000010
current->tss.cr3 = 00baa000, %cr3 = 00baa000
*pde = 00000000
Oops: 0000
CPU:    0
EIP:    0010:[<c2060c0f>]
EFLAGS: 00010213
eax: c2065888   ebx: 00000005   ecx: c20615fc   edx: 00000000
esi: 00000005   edi: 00000005   ebp: ffffffff   esp: c0badeec
ds: 0018   es: 0018   ss: 0018
Process mt (pid: 100, process nr: 24, stackpage=c0bad000)
Stack: 00000005 00000002 00000000 00076000 00076000 c0101c24 00003063
c2076000
       c0101c24 c011cf1f c2400000 00008000 00007400 c205a02a ffffffff
00000004
       c205bc66 c0badf58 80046d03 00000004 c205c90b c0badf58 00000004
c0bac000
Call Trace: [<c0101c24>] [<c2076000>] [<c0101c24>] [<c011cf1f>]
[<c2400000>] [<c205a02a>] [<c205bc66>]
       [<c205c90b>] [<c2061425>] [<c012259b>] [<c20616d6>] [<c0129ff0>]
[<c0107a04>]
Code: 39 6a 10 72 bc eb 3c 89 f6 8b 42 04 a3 d8 58 06 c2 83 3d ec
>>EIP: c2060c0f <zft_find_volume+12b/2b8>
Trace: c0101c24 <swapper_pg_dir+c24/1000>
Trace: c2076000 <END_OF_CODE+13e0c/????>
Trace: c0101c24 <swapper_pg_dir+c24/1000>
Trace: c011cf1f <vmalloc+3f/5c>
Trace: c2400000 <END_OF_CODE+39de0c/????>
Trace: c205c90b <_zft_ioctl+19f/29c>
Trace: c0107a04 <system_call+34/40>
Code:  c2060c0f <zft_find_volume+12b/2b8>      00000000 <_EIP>: <===
Code:  c2060c0f <zft_find_volume+12b/2b8>         0:	39 6a 10       	cmpl   %ebp,0x10(%edx) <===
Code:  c2060c12 <zft_find_volume+12e/2b8>         3:	72 bc          	jb      c2060bd0 <zft_find_volume+ec/2b8>
Code:  c2060c14 <zft_find_volume+130/2b8>         5:	eb 3c          	jmp     c2060c52 <zft_find_volume+16e/2b8>
Code:  c2060c16 <zft_find_volume+132/2b8>         7:	89 f6          	movl   %esi,%esi
Code:  c2060c18 <zft_find_volume+134/2b8>         9:	8b 42 04       	movl   0x4(%edx),%eax
Code:  c2060c1b <zft_find_volume+137/2b8>         c:	a3 d8 58 06 c2 	movl   %eax,0xc20658d8
Code:  c2060c20 <zft_find_volume+13c/2b8>        11:	83 3d ec 00 00 	cmpl   $0x0,0xec
Code:  c2060c25 <zft_find_volume+141/2b8>        16:	00 00 