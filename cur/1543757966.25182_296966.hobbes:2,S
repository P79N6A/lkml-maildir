Date: Thu, 24 Feb 2005 18:20:49 +1100
From: Nick Piggin <>
Subject: [PATCH 5/13] find_busiest_group cleanup
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2005/2/24/31

5/13
Cleanup find_busiest_group a bit. New sched-domains code
means we can't have groups without a CPU.
Signed-off-by: Nick Piggin <nickpiggin@yahoo.com.au>
Index: linux-2.6/kernel/sched.c
===================================================================
--- linux-2.6.orig/kernel/sched.c	2005-02-24 17:31:29.298502546 +1100
+++ linux-2.6/kernel/sched.c	2005-02-24 17:43:38.629469074 +1100
@@ -1771,7 +1771,7 @@
 	do {
 		unsigned long load;
 		int local_group;
-		int i, nr_cpus = 0;
+		int i;
 
 		local_group = cpu_isset(this_cpu, group->cpumask);
 
@@ -1785,13 +1785,9 @@
 			else
 				load = source_load(i);
 
-			nr_cpus++;
 			avg_load += load;
 		}
 
-		if (!nr_cpus)
-			goto nextgroup;
-
 		total_load += avg_load;
 		total_pwr += group->cpu_power;
 