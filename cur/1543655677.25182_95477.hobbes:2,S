Date: Wed, 11 Dec 2002 03:16:39 -0800
From: William Lee Irwin III <>
Subject: Re: [PATCH] Notifier for significant events on i386
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2002/12/11/74

On Wed, Dec 11, 2002 at 04:51:53PM +0530, Vamsi Krishna S . wrote:
> I support this, it makes all kernel-space debug tools less intrusive. 
> It may be out of scope for this work but there are a couple of
> other issues to consider here:
> - turn trap1/trap3 to interrupt gates: kprobes does this, kgdb turns
>   off interrupts in its own handler, I suppose other tools too need
>   this.
> - notifier lists are racy on SMP, IFAICT, read_lock(&notifier_lock)
>   needs to be taken in notifier_call_chain(), but that too is 
>   deadlock prone.
> Andi,
> Isn't this a problem on x86_64 too? What is there to prevent a
> handler from being removed from the notifier list while it
> is being used to call the handler on another CPU?
> I am considering using a RCU-based list for notifier chains.
> Corey has done some work on these lines to add NMI notifier
> chain, I think it should be generalised on for all notifiers.
A coherent explanation of how notifier locking is supposed to work
would be wonderful to have. I'd like to register notifiers but am
pig ignorant of how to lock my structures down to work with it.
Bill
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.kernel.org
More majordomo info at  
http://vger.kernel.org/majordomo-info.html
Please read the FAQ at  
http://www.tux.org/lkml/