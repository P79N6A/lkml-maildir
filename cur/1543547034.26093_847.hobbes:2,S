Date: Tue, 29 Aug 2000 12:45:57 -0700 (PDT)
From: Dimitris Michailidis <>
Subject: RE: [patch] scheduler bugfix, SMP, 2.4.0-test7
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2000/8/29/121

On 29-Aug-2000 Ingo Molnar wrote:
> i agree fully. The attached patch against test8-pre1 changes
> schedule_idle() from inline to FASTCALL - things look much nicer with this
> one applied.
>
> -static inline void reschedule_idle(struct task_struct * p, unsigned long
flags)
> +static FASTCALL(void reschedule_idle(struct task_struct *, unsigned long));
You can't do this.  SPARC requires you to restore the flags in the same
function where you saved them because they contain register window status. 
You *have* to inline the part that drops the run queue lock.  The bulk of the
function though doesn't need to be inlined.  See how it is done in my
scheduler patch.
-- 
Dimitris Michailidis                    dimitris@engr.sgi.com
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.kernel.org
Please read the FAQ at 
http://www.tux.org/lkml/