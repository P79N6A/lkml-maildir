Date: Fri, 21 Nov 2003 12:38:12 -0500
From: Jeff Moyer <>
Subject: [PATCH 2.4.22] PG_error is not cleared after I/O errors
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2003/11/21/74

Hello,
Currently, if a device returns an I/O error, the PG_error bit is set in the
page struct, but never cleared.  This patch clears the bit when the page is
not uptodate (and about to be read).  You'll find the same fix in the
2.6 stream of the kernel.
Regards,
Jeff
--- linux-2.4.22/mm/filemap.c.orig	2003-11-21 12:29:26.000000000 -0500
+++ linux-2.4.22/mm/filemap.c	2003-11-21 12:30:16.000000000 -0500
@@ -1491,6 +1491,8 @@
 			UnlockPage(page);
 			goto page_ok;
 		}
+		/* Clear any stale I/O errors */
+		ClearPageError(page);
 
 readpage:
 		/* ... and start the actual read. The read will unlock the page. */
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.kernel.org
More majordomo info at  
http://vger.kernel.org/majordomo-info.html
Please read the FAQ at  
http://www.tux.org/lkml/