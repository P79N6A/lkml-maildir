Date: Mon, 26 Feb 2007 07:51:19 -0800 (PST)
From: Linus Torvalds <>
Subject: Re: bug in kernel 2.6.21-rc1-git1: conventional floppy drive cannot be mounted without hanging up the whole system
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2007/2/26/138

On Mon, 26 Feb 2007, Jiri Slaby wrote:
> 
> Ok, this commit is the culprit:
> Commit: 2ff2d3d74705d34ab71b21f54634fcf50d57bdd5
> Author: Stephane Eranian <eranian@hpl.hp.com> Tue, 13 Feb 2007 13:26:22 +0100
> 
>     [PATCH] i386: add idle notifier
Interesting. It doesn't touch floppy at all, but it *does* seem to play 
around with irq state. 
In particular, the floppy uses IRQF_DISABLED (which means that it doesn't 
want interrupts enabled when in the irq handler), and I get the feeling 
that the poll_idle() stuff made that not work.
That said, the only thing that *really* seems to change (as far as a 
floopy driver could notice) is the added "exit_idle()" in the do_IRQ() 
sequence, and I'm not seeing that one enabling interrupts. 
But the idle sequence definitely does (ie now we disable/enable interrupts 
in cpu_idle(). I'm not seeing why that should matter, though.
Stephane, any ideas?
		Linus
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.kernel.org
More majordomo info at  
http://vger.kernel.org/majordomo-info.html
Please read the FAQ at  
http://www.tux.org/lkml/