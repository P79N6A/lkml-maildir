Date: Fri, 1 Dec 2006 13:41:18 +0100 (CET)
From: Tim Schmielau <>
Subject: Re: please pull from the trivial tree
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2006/12/1/96

> Chase Venters (1):
>       Fix jiffies.h comment
This one actually obscures the comment rather than fixing it.
From jiffies.h:
> 76 /*
> 77  * The 64-bit value is not volatile - you MUST NOT read it
> 78  * without sampling the sequence number in xtime_lock.
> 79  * get_jiffies_64() will do this for you as appropriate.
> 80  */
> 81  extern u64 __jiffy_data jiffies_64;
> 82  extern unsigned long volatile __jiffy_data jiffies;
Note that jiffies is volatile, while jiffies_64 is not; the comment 
currently explains that. The proposed patch
> Fix jiffies.h comment
> jiffies.h includes a comment informing that jiffies_64 must be read with the
> assistance of the xtime_lock seqlock. The comment text, however, calls
> jiffies_64 "not volatile", which should probably read "not atomic".
> 
> --- a/include/linux/jiffies.h
> +++ b/include/linux/jiffies.h
> @@ -74,7 +74,7 @@
> #define __jiffy_data __attribute__((section(".data")))
> /*
> - * The 64-bit value is not volatile - you MUST NOT read it
> + * The 64-bit value is not atomic - you MUST NOT read it
> * without sampling the sequence number in xtime_lock.
> * get_jiffies_64() will do this for you as appropriate.
> */
would leave a comment that is correct, but less useful (I'd expect any 
kernel hacker to know that u64 is non-atomic on many platforms).
Tim
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.kernel.org
More majordomo info at  
http://vger.kernel.org/majordomo-info.html
Please read the FAQ at  
http://www.tux.org/lkml/