Date: Sun, 18 Apr 2004 11:40:07 +0200
From: Christoph Hellwig <>
Subject: Re: [PATCH 3/3] lockfs - dm bits
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2004/4/18/32

On Sun, Apr 18, 2004 at 12:06:47AM +0200, Christoph Hellwig wrote:
> This patch makes the device mapper use the new freeze_bdev/thaw_bdev
> interface.  Extracted from Chris Mason's patch.
With the DM updates that went into Linus' tree today you'll need this
additional hunk ontop:
--- linux/drivers/md/dm.c~	2004-04-01 13:29:22.000000000 -0500
+++ linux/drivers/md/dm.c	2004-04-01 14:54:57.911207304 -0500
@@ -1014,6 +1014,7 @@ int dm_suspend(struct mapped_device *md)
 
 	/* were we interrupted ? */
 	if (atomic_read(&md->pending)) {
+		__unlock_fs(md);
 		clear_bit(DMF_BLOCK_IO, &md->flags);
 		up_write(&md->lock);
 		return -EINTR;
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.kernel.org
More majordomo info at  
http://vger.kernel.org/majordomo-info.html
Please read the FAQ at  
http://www.tux.org/lkml/