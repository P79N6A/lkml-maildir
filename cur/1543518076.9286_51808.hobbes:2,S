Date: Mon, 6 Dec 1999 21:22:12 +0100 (CET)
From: Andrea Arcangeli <>
Subject: Re: [patch] Re: setitimer lowlatency-2.2.13-A1 questions
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/1999/12/6/139

On Mon, 6 Dec 1999, Manfred Spraul wrote:
>Andrea Arcangeli wrote:
>> 
>> It's not safe as do_bottom_half can return with irq disabled and it's not
>> safe to reenable the irqs inside enable_bh if enable_bh is be called with
>> irq disabled. I fixed both problems in this alternate patch (not compiled
>> too ;):
>
>Is there a special reason why do_bottom_half() calls __sti() and __cli()
>directly? This seems wrong, what about using the normal
>__save_flags()/__sti()/__restore_flags()?
The irq handler case by design doesn't need it. You must enter there with
irq disabled and you must exit with irq disabled (so you must enabled
and disable by hand before and after running the bhs).
For the ret to userspace case it could decrease a bit the bh latency but
it seems not a big issue, as right now a ret from syscall will act like
while returning from an irq after the bottom half path.
Andrea
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.rutgers.edu
Please read the FAQ at 
http://www.tux.org/lkml/