Date: Tue, 9 Dec 2008 09:26:08 +0100
From: Joerg Dorchain <>
Subject: Re: [PATCH] amiflop: get rid of sleep_on calls
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2008/12/9/28

On Mon, Dec 08, 2008 at 04:59:38PM +0000, Andreas Bombe wrote:
> The replacement for the unconditional sleep_on() in fd_motor_on() is a
> complete_all() together with a INIT_COMPLETION() before the mod_timer()
> call.  It appears to me that fd_motor_on() might be called concurrently
> and fd_select() does not guarantee mutual exclusivity in the case the
> same drive gets selected again.
Selecting the same drive repeatly does not matter. The selected
drive is the one the next command or transfer applies to.
It is possible to select one drive, start the motor, select the
next one, start the motor, as long as as trasnfer is tried until
the drive is up to speed (either by signal or the timeout)
At first glance, the patch looks ok.
Bye,
Joerg
[unhandled content-type:application/pgp-signature]