Date: Fri, 9 May 2008 20:07:48 +0200
From: "Vegard Nossum" <>
Subject: Re: [PATCH 1/3] kmemcheck: prepare for SLAB hooks
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2008/5/9/272

On Thu, May 8, 2008 at 11:02 PM, Pekka J Enberg <penberg@cs.helsinki.fi> wrote:
> From: Pekka Enberg <penberg@cs.helsinki.fi>
>
> Make mm/slub_kmemcheck.c more generic in preparation for adding kmemcheck hooks
> to SLAB which does not use compound pages by default and has slightly different
> way for keeping track of object size than SLUB.
>
> Cc: Ingo Molnar <mingo@elte.hu>
> Cc: Christoph Lameter <clameter@sgi.com>
> Cc: Andrew Morton <akpm@linux-foundation.org>
> Cc: Vegard Nossum <vegard.nossum@gmail.com>
> Signed-off-by: Pekka Enberg <penberg@cs.helsinki.fi>
> ---
>  include/linux/slub_kmemcheck.h |   19 +++++++++++--------
>  mm/slub.c                      |    8 ++++----
>  mm/slub_kmemcheck.c            |   23 ++++++++++-------------
>  3 files changed, 25 insertions(+), 25 deletions(-)
[sniip]
> @@ -1757,7 +1757,7 @@
>        struct kmem_cache_cpu *c;
>        unsigned long flags;
>
> -       kmemcheck_slab_free(s, object);
> +       kmemcheck_slab_free(s, object, c->objsize);
Hm, "'c' is used uninitialized in this function". I guess it should be
moved a bit downwards. Can you fix it?
Vegard
-- 
"The animistic metaphor of the bug that maliciously sneaked in while
the programmer was not looking is intellectually dishonest as it
disguises that the error is the programmer's own creation."
	-- E. W. Dijkstra, EWD1036