Date: Sun, 12 Feb 2006 19:50:02 +0000 (GMT)
From: Hugh Dickins <>
Subject: [PATCH 3/3] compound page: no access_process_vm check
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2006/2/12/125

The PageCompound check before access_process_vm's set_page_dirty_lock is
no longer necessary, so remove it.  But leave the PageCompound checks in
bio_set_pages_dirty, dio_bio_complete and nfs_free_user_pages: at least
some of those were introduced as a little optimization on hugetlb pages.
Signed-off-by: Hugh Dickins <hugh@veritas.com>
---
 kernel/ptrace.c |    3 +--
 1 files changed, 1 insertion(+), 2 deletions(-)
--- 2.6.16-rc2-git11/kernel/ptrace.c	2006-02-03 09:32:51.000000000 +0000
+++ 2.6.16-rc2-git11+/kernel/ptrace.c	2006-02-10 20:07:05.000000000 +0000
@@ -242,8 +242,7 @@ int access_process_vm(struct task_struct
 		if (write) {
 			copy_to_user_page(vma, page, addr,
 					  maddr + offset, buf, bytes);
-			if (!PageCompound(page))
-				set_page_dirty_lock(page);
+			set_page_dirty_lock(page);
 		} else {
 			copy_from_user_page(vma, page, addr,
 					    buf, maddr + offset, bytes);
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.kernel.org
More majordomo info at  
http://vger.kernel.org/majordomo-info.html
Please read the FAQ at  
http://www.tux.org/lkml/