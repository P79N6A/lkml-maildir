Date: Wed, 6 Jun 2007 02:35:39 +0530
From: "Satyam Sharma" <>
Subject: Re: [PATCH] S390: Replace calls to __get_free_pages() with __get_dma_pages().
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2007/6/5/304

Hi,
On 6/6/07, Robert P. J. Day <rpjday@mindspring.com> wrote:
>
> Replace a number of calls to __get_free_pages() with the corresponding
> calls to __get_dma_pages().
> [...]
>   once the __GFP_DMA argument is removed, it does look weird to see
> the first argument of just 0.  should that be filled in with
> GFP_ATOMIC as christopher lameter suggested?
Yes, I suppose so ... GFP_ATOMIC can dip into the emergency
pools so would also make this code a bit more "robust" than using
"0" (== GFP_NOWAIT) and it's not that GFP_ATOMIC "waits" on
anything either ...
> -                       (void *)__get_free_pages(__GFP_DMA,
> +                       (void *)__get_dma_pages(0,
GFP_NOWAIT == 0, so the macro GFP_NOWAIT is the one to
use if you really don't want any change in behaviour (and as the
comment above GFP_NOWAIT says, it's much better to use that
name than simply specify "0").
Off-topic, but I wonder what are the valid usage cases / scenarios
for GFP_NOWAIT? The obvious answer is somebody might want to
be a way-too-polite citizen and stay off the emergency pools even
from atomic context, but why would anybody want to do /that/ ...
[ BTW there are 3 users of GFP_NOWAIT in kernel code, but there
could be more that simply specify "0" to get same behaviour. ]
Satyam
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.kernel.org
More majordomo info at  
http://vger.kernel.org/majordomo-info.html
Please read the FAQ at  
http://www.tux.org/lkml/