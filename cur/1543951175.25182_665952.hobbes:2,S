Date: Mon, 10 Mar 2008 16:42:32 -0600
From: Andreas Dilger <>
Subject: Re: [PATCH 0/3] enhanced ESTALE error handling (v3)
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2008/3/10/351

On Mar 10, 2008  16:23 -0400, Peter Staubach wrote:
> Here is version 3 of a patch set which modifies the system to
> enhance the ESTALE error handling for system calls which take
> pathnames as arguments.  This patch set is essentially the
> same as the v2 patches, but updated to reflect the current
> state of the code around them.
[snip long discussion of ESTALE causes]
> This support was tested using the attached programs and
> running multiple copies on mounted file systems which do not
> share superblocks.  When two or more copies of this program
> are running, many ESTALE errors can be seen over the network.
> Without these patches, the test program errors out almost
> immediately.  With these patches, the test program runs
> for as long one desires.
Have you tried "racer.sh"?  That is a very stressful metadata tester
that does random operations on a handful of file and directory names.
It can be run on a single client, or on multiple clients and needs no
coordination between the clients.  I guess it won't tell you if you
are getting ESTALE back correctly or not, but it can quickly find if
there are any problems with the retrying code.
I've attached an updated tarball of the original scripts here.
Cheers, Andreas
--
Andreas Dilger
Sr. Staff Engineer, Lustre Group
Sun Microsystems of Canada, Inc.
[unhandled content-type:application/x-gzip]