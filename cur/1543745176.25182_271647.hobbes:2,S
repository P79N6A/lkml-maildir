Date: Wed, 17 Nov 2004 17:09:22 +1100
From: Benjamin Herrenschmidt <>
Subject: Re: 2.6.10-rc2 pbook oops on resume
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2004/11/17/7

On Tue, 2004-11-16 at 21:49 -0800, Andrew Morton wrote:
> Soeren Sonnenburg <kernel@nn7.de> wrote:
> >
> > machine comes up ok, but I see this oops in dmesg... Any ideas ?
> 
> That would be due to this code in ohci_pci_resume():
> 
> #ifdef CONFIG_PMAC_PBOOK
> 		if (_machine == _MACH_Pmac)
> 			enable_irq (to_pci_dev(hcd->self.controller)->irq);
> #endif
> 
> enabling an already-enabled IRQ.
> 
> I think Ben plays in this area?
Yes. It's not an oops tho, and is harmless for now... The pmac code used
to disable/enable irq around sleep, but that caused this problem when
David added code to unregister/re-register the irq during sleep as well
to the generic HCD stuff.
I have some pending patches, haven't had time to finish them tho... I
have a lot of sleep-related pmac update that are waiting for me to
finish getting the stuff working on the iBook G4, and it's part of that
pile... I'll let you know tomorrow.
Ben.
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.kernel.org
More majordomo info at  
http://vger.kernel.org/majordomo-info.html
Please read the FAQ at  
http://www.tux.org/lkml/