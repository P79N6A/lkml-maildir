Date: Sun, 8 Sep 2002 19:04:21 +0200
From: Daniel Phillips <>
Subject: Re: [BK-PATCH 1/3] Introduce fs/inode.c::ilookup().
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2002/9/9/45

On Saturday 07 September 2002 16:27, Anton Altaparmakov wrote:
> The second and third patch have the small disadvantage to the previous
> code in that in the case that ilookup() fails in iget_locked() and
> get_new_inode_fast() is called the inode hash is calculated twice.
> But that is the slow path so I don't think it is a problem.
It doesn't make sense to introduce even this small inefficiency when
all you need to do is wrap an __ilookup inline that takes the hash
list, and is called both from ilookup and iget.  The inline costs
nothing, the hidden inefficiency costs cycles, however few.
Thanks for actually documenting what the functions do in the inline
documentation, it's nice to see such a break from tradition.  One
nano point: it would read better with the functional description
before the ancilliary notes, i.e.:
+ * The inode specified by @ino is looked up in the inode cache and if present
+ * it is returned with an increased reference count.
+ *
+ * This is a fast version of iget5_locked() for file systems where the inode
+ * number is sufficient for unique identification of an inode.
While I'm picking nits, it's more accurate to say that iget5_locked is
a generalized version of iget_locked than that the latter is a fast
version of the former.
And I still like ifind* more than ilookup*.  It's shorter and is a
better match with the existing page cache terminology.  Why add
entropy when you don't have to?
-- 
Daniel
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.kernel.org
More majordomo info at  
http://vger.kernel.org/majordomo-info.html
Please read the FAQ at  
http://www.tux.org/lkml/