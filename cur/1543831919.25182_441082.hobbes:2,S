Date: Thu, 06 Jul 2006 13:28:58 +0200
From: "Niels Kristian Bech Jensen" <>
Subject: [PATCH 2.6.18-rc1] Compile fix for 2.6.18-rc1 on Ubuntu Edgy (-fstack-protector)
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2006/7/6/88

This patch makes it possible to build the 2.6.18-rc1 kernel on Ubuntu Edgy 
(powerpc architecture).
_________________________________________________________________
VÃ¦lg selv hvordan du vil kommunikere - skrift, tale, video eller billeder 
med MSN Messenger:  
http://messenger.msn.dk
diff -uprN linux-2.6.18-rc1.orig/arch/powerpc/boot/Makefile linux-2.6.18-rc1/arch/powerpc/boot/Makefile
--- linux-2.6.18-rc1.orig/arch/powerpc/boot/Makefile	2006-07-06 12:26:57.000000000 +0200
+++ linux-2.6.18-rc1/arch/powerpc/boot/Makefile	2006-07-06 11:31:22.000000000 +0200
@@ -41,6 +41,10 @@ src-boot += $(zlib)
 src-boot := $(addprefix $(obj)/, $(src-boot))
 obj-boot := $(addsuffix .o, $(basename $(src-boot)))
 
+# Force gcc to behave correct even for buggy distributions
+BOOTCFLAGS	+= $(call cc-option, -fno-stack-protector,) \
+		   $(call cc-option, -fno-stack-protector-all,)
+
 BOOTCFLAGS	+= -I$(obj) -I$(srctree)/$(obj)
 
 quiet_cmd_copy_zlib = COPY    $@
diff -uprN linux-2.6.18-rc1.orig/Makefile linux-2.6.18-rc1/Makefile
--- linux-2.6.18-rc1.orig/Makefile	2006-07-06 12:26:49.000000000 +0200
+++ linux-2.6.18-rc1/Makefile	2006-07-06 11:30:09.000000000 +0200
@@ -310,8 +310,8 @@ CPPFLAGS        := -D__KERNEL__ $(LINUXI
 CFLAGS          := -Wall -Wundef -Wstrict-prototypes -Wno-trigraphs \
                    -fno-strict-aliasing -fno-common
 # Force gcc to behave correct even for buggy distributions
-CFLAGS          += $(call cc-option, -fno-stack-protector-all \
-                                     -fno-stack-protector)
+CFLAGS          += $(call cc-option, -fno-stack-protector,) \
+                   $(call cc-option, -fno-stack-protector-all,)
 AFLAGS          := -D__ASSEMBLY__
 
 # Read KERNELRELEASE from include/config/kernel.release (if it exists)