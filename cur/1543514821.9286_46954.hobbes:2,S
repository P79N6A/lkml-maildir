Date: Tue, 02 Nov 1999 22:19:22 +1100
From: Keith Owens <>
Subject: 2.3.24 loops when swap is full
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/1999/11/2/53

Stock 2.3.24, gcc version egcs-2.91.66 19990314/Linux (egcs-1.1.2
release), glibc 2.1.2, binutils 2.9.1.0.23.  UP, 64Mb RAM, 18Mb swap.
Edit a 23Mb file with vi, delete a large chunk of lines, swap steadily
climbs to 100% used then the system hangs.  SysRQ-M at hang shows
SysRq: Show Memory
Mem-info:
Free pages:        1380kB (     0kB HighMem)
( Free: 345, lru_cache: 354 (120 240 360) )
  DMA: 32*4kB 6*8kB 5*16kB 1*32kB 1*64kB 1*128kB 1*256kB 0*512kB 0*1024kB 0*2048kB = 736kB)
  Normal: 97*4kB 30*8kB 1*16kB 0*32kB 0*64kB 0*128kB 0*256kB 0*512kB 0*1024kB 0*2048kB = 644kB)
Swap cache: add 4397, delete 4397, find 11/110
Free swap:            0kB
15360 pages of RAM
0 pages of HIGHMEM
731 reserved pages
751 pages shared
0 pages swap cached
0 pages in page table cache
Buffer memory:      188kB
Networking buffers in use          : 1
Total network buffer allocations   : 4007
Total failed network buffer allocs : 0
IP fragment buffer size            : 0
SysRQ-P captured via serial console and run through ksymoops.  It is
looping in swap out code.
EIP: 0010:[<c0123d43>] EFLAGS: 00000246
EAX: 00000000 EBX: c2ea9720 ECX: 401c7000 EDX: c10b1468
ESI: 401c7000 EDI: c2ea9720 EBP: 00000013 DS: 0018 ES: 0018
EIP: 0010:[<c0123e55>] EFLAGS: 00000287
EAX: c2ea1be0 EBX: 0b173000 ECX: 0b172000 EDX: c1091d70
ESI: c2c945c8 EDI: c1a921c0 EBP: 0b400000 DS: 0018 ES: 0018
EIP: 0010:[<c0123b5f>] EFLAGS: 00000216
EAX: c11b9650 EBX: 039eb047 ECX: 40012000 EDX: 000039eb
ESI: c38e5048 EDI: c38e5048 EBP: c38d1de0 DS: 0018 ES: 0018
EIP: 0010:[<c0123cb5>] EFLAGS: 00000246
EAX: c3bb3de8 EBX: 03829047 ECX: 00000013 EDX: 1f5c0000
ESI: c10d299c EDI: c220930c EBP: c1a921c0 DS: 0018 ES: 0018
EIP: 0010:[<c0123bbf>] EFLAGS: 00000202
EAX: 0000008c EBX: 00c22047 ECX: 0002d7f8 EDX: cf780000
ESI: c102d7f8 EDI: c1672dd0 EBP: c1a921c0 DS: 0018 ES: 0018
EIP: 0010:[<c0123bb4>] EFLAGS: 00000246
EAX: 0000000c EBX: 02e64047 ECX: 000adf70 EDX: 46700000
ESI: c10adf70 EDI: c2ab4298 EBP: c1a921c0 DS: 0018 ES: 0018
EIP: 0010:[<c0123c40>] EFLAGS: 00000202
EAX: 00000000 EBX: 0397b047 ECX: 00000013 EDX: 1a140000
ESI: c10d78d4 EDI: c39d4060 EBP: c38d1c20 DS: 0018 ES: 0018
EIP: 0010:[<c0123b51>] EFLAGS: 00000286
EAX: c2ea16d0 EBX: 00000000 ECX: 40070000 EDX: 0202c000
ESI: c202c1c0 EDI: c202c1c0 EBP: c2136800 DS: 0018 ES: 0018
EIP: 0010:[<c0123e49>] EFLAGS: 00000287
EAX: 40400000 EBX: 40400000 ECX: 40000000 EDX: 03203000
ESI: c3203000 EDI: c3208400 EBP: 40012000 DS: 0018 ES: 0018
EIP: 0010:[<c0123bdf>] EFLAGS: 00000246
EAX: 0000008c EBX: 00fa1047 ECX: 0003a9bc EDX: c17c0000
ESI: c103a9bc EDI: c3af2c94 EBP: c1a921c0 DS: 0018 ES: 0018
EIP: 0010:[<c0123d26>] EFLAGS: 00000246
EAX: 00000000 EBX: 401e1000 ECX: 401e0000 EDX: 02f8a000
ESI: c2f8a780 EDI: c308b260 EBP: c308b260 DS: 0018 ES: 0018
EIP: 0010:[<c0123bb4>] EFLAGS: 00000246
EAX: 0000008c EBX: 0069a047 ECX: 00018c18 EDX: e5980000
ESI: c1018c18 EDI: c160d7a8 EBP: c1a921c0 DS: 0018 ES: 0018
EIP: 0010:[<c0123f97>] EFLAGS: 00000202
EAX: c2ea1910 EBX: c11b91d0 ECX: c1ad8000 EDX: 0000001e
ESI: 00000000 EDI: 00000015 EBP: 0000000c DS: 0018 ES: 0018
EIP: 0010:[<c0123f97>] EFLAGS: 00000202
EAX: c11b91d0 EBX: c11b9650 ECX: c3900000 EDX: 00000017
ESI: 00000000 EDI: 00000021 EBP: 00000009 DS: 0018 ES: 0018
EIP: 0010:[<c012531a>] EFLAGS: 00000286
EAX: c3bb3dc8 EBX: 00b1f047 ECX: 00000013 EDX: c1029b44
ESI: c3bb3de8 EDI: c09af234 EBP: c1a921c0 DS: 0018 ES: 0018
EIP: 0010:[<c0123bb4>] EFLAGS: 00000246
EAX: 0000008c EBX: 00bd3047 ECX: 0002c574 EDX: d0b40000
ESI: c102c574 EDI: c3af2e9c EBP: c1a921c0 DS: 0018 ES: 0018
EIP: 0010:[<c0123c40>] EFLAGS: 00000202
EAX: 00000000 EBX: 0318f047 ECX: 00000013 EDX: 39c40000
ESI: c10b9d84 EDI: c31a4ff8 EBP: c3870280 DS: 0018 ES: 0018
EIP: 0010:[<c0124fcd>] EFLAGS: 00000286
EAX: c3bb3dc8 EBX: 03b70047 ECX: 00000013 EDX: c10dee40
ESI: c3bb3de8 EDI: 00000000 EBP: c1a921c0 DS: 0018 ES: 0018
EIP: 0010:[<c0123bb4>] EFLAGS: 00000246
EAX: 0000000c EBX: 01295047 ECX: 00045aec EDX: b5ac0000
ESI: c1045aec EDI: c2ab490c EBP: c1a921c0 DS: 0018 ES: 0018
EIP: 0010:[<c0123ef4>] EFLAGS: 00000282
EAX: 00000000 EBX: c2b841d0 ECX: 082f2000 EDX: c10970e0
ESI: 082f2000 EDI: c2ea1520 EBP: 00000013 DS: 0018 ES: 0018
EIP: 0010:[<c0123b75>] EFLAGS: 00000206
EAX: 00064e24 EBX: 01ae7047 ECX: 00064e24 EDX: c1000000
ESI: c1064e24 EDI: c36f4f4c EBP: c1a92000 DS: 0018 ES: 0018
EIP: 0010:[<c0123fce>] EFLAGS: 00000297
EAX: 00000010 EBX: c11b9020 ECX: c3280000 EDX: 00000010
ESI: 00000000 EDI: 00000014 EBP: 00000001 DS: 0018 ES: 0018
EIP: 0010:[<c0123b51>] EFLAGS: 00000286
EAX: c2ea1be0 EBX: 0043b047 ECX: 0a4a8000 EDX: c100fd5c
ESI: c16722a0 EDI: c16722a0 EBP: c1a921c0 DS: 0018 ES: 0018
EIP: 0010:[<c0123b51>] EFLAGS: 00000286
EAX: c11b9890 EBX: 00000000 ECX: 40058000 EDX: 031cd000
ESI: c31cd160 EDI: c31cd160 EBP: c398e790 DS: 0018 ES: 0018
EIP: 0010:[<c0123bb4>] EFLAGS: 00000246
EAX: 0000008c EBX: 00f78047 ECX: 0003a020 EDX: c2200000
ESI: c103a020 EDI: c2ab4ecc EBP: c1a921c0 DS: 0018 ES: 0018
EIP: 0010:[<c0123b51>] EFLAGS: 00000286
EAX: c11b9ec0 EBX: 00000000 ECX: 40090000 EDX: 030d5000
ESI: c30d5240 EDI: c30d5240 EBP: c30d42e0 DS: 0018 ES: 0018
EIP: 0010:[<c0123c40>] EFLAGS: 00000202
EAX: 00000000 EBX: 02b69047 ECX: 00000013 EDX: 525c0000
ESI: c10a2c9c EDI: c160de04 EBP: c1a921c0 DS: 0018 ES: 0018
EIP: 0010:[<c0123f8c>] EFLAGS: 00000206
EAX: c2ea19a0 EBX: c11b9da0 ECX: c1bf6000 EDX: 00000025
ESI: 00000000 EDI: 00000049 EBP: 0000000b DS: 0018 ES: 0018
EIP: 0010:[<c0123e6c>] EFLAGS: 00000246
EAX: 00000000 EBX: 095b0000 ECX: 00000000 EDX: c1030714
ESI: c041b6bc EDI: c1a921c0 EBP: 09800000 DS: 0018 ES: 0018
EIP: 0010:[<c0123f97>] EFLAGS: 00000202
EAX: c11b9bf0 EBX: c11b9ad0 ECX: c3110000 EDX: 00000049
ESI: 00000000 EDI: 00000043 EBP: 00000034 DS: 0018 ES: 0018
EIP: 0010:[<c0123b64>] EFLAGS: 00000216
EAX: 00028790 EBX: 02879047 ECX: 096d1000 EDX: 00002879
ESI: c041bb44 EDI: c041bb44 EBP: c1a921c0 DS: 0018 ES: 0018
EIP: 0010:[<c0124fc3>] EFLAGS: 00000286
EAX: c3bb3dc8 EBX: 00b9d047 ECX: 00000013 EDX: c102b8cc
ESI: c3bb3de8 EDI: c16725cc EBP: c1a921c0 DS: 0018 ES: 0018
>>EIP; c0123d43 <swap_out_vma+13/190>
>>EIP; c0123e55 <swap_out_vma+125/190>
>>EIP; c0123b5f <try_to_swap_out+1f/1f0>
>>EIP; c0123cb5 <try_to_swap_out+175/1f0>
>>EIP; c0123bbf <try_to_swap_out+7f/1f0>
>>EIP; c0123bb4 <try_to_swap_out+74/1f0>
>>EIP; c0123c40 <try_to_swap_out+100/1f0>
>>EIP; c0123b51 <try_to_swap_out+11/1f0>
>>EIP; c0123e49 <swap_out_vma+119/190>
>>EIP; c0123bdf <try_to_swap_out+9f/1f0>
>>EIP; c0123d26 <try_to_swap_out+1e6/1f0>
>>EIP; c0123bb4 <try_to_swap_out+74/1f0>
>>EIP; c0123f97 <swap_out+67/130>
>>EIP; c0123f97 <swap_out+67/130>
>>EIP; c012531a <acquire_swap_entry+7a/90>
>>EIP; c0123bb4 <try_to_swap_out+74/1f0>
>>EIP; c0123c40 <try_to_swap_out+100/1f0>
>>EIP; c0124fcd <get_swap_page+d/1e0>
>>EIP; c0123bb4 <try_to_swap_out+74/1f0>
>>EIP; c0123ef4 <swap_out_mm+34/70>
>>EIP; c0123b75 <try_to_swap_out+35/1f0>
>>EIP; c0123fce <swap_out+9e/130>
>>EIP; c0123b51 <try_to_swap_out+11/1f0>
>>EIP; c0123b51 <try_to_swap_out+11/1f0>
>>EIP; c0123bb4 <try_to_swap_out+74/1f0>
>>EIP; c0123b51 <try_to_swap_out+11/1f0>
>>EIP; c0123c40 <try_to_swap_out+100/1f0>
>>EIP; c0123f8c <swap_out+5c/130>
>>EIP; c0123e6c <swap_out_vma+13c/190>
>>EIP; c0123f97 <swap_out+67/130>
>>EIP; c0123b64 <try_to_swap_out+24/1f0>
>>EIP; c0124fc3 <get_swap_page+3/1e0>
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.rutgers.edu
Please read the FAQ at 
http://www.tux.org/lkml/