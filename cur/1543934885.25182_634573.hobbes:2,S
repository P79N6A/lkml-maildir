Date: Sat, 05 Jan 2008 18:02:39 +0100
From: Jiri Slaby <>
Subject: Re: strace, accept(), ERESTARTSYS and EINTR
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2008/1/5/100

On 01/05/2008 04:03 PM, Andi Kleen wrote:
>    if (!strcmp(current->comm, "yourprogramwithoutpath"))
>             printk("%s:%d ERESTART\n", __FILE__, __LINE__);
> 
> [the later two might need adding linux/string.h and/or linux/sched.h includes
> to the files if they don't compile]
> 
> to all of them. Then recompile and boot that kernel.
If I'm not completely blind, there is no suspicous ERESTARTSYS in
PF_INET:SOCK_STREAM path.
Anyway even if it was returned by kernel syscall, glibc should put it in errno
and return -1 (since it is >= -4095 and < 0). He sees it in the accept retval.
Something rotten, probably broken/racy ?ntpl? implementation of syscalls or
somewhat?
regards,
-- 
Jiri Slaby
Faculty of Informatics, Masaryk University
Suse Labs