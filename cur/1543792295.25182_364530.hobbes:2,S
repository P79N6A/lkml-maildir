Date: Mon, 07 Nov 2005 15:40:32 -0600
From: Brian King <>
Subject: Re: [PATCH 2/7]: Revised [PATCH 27/42]: SCSI: add PCI error recovery to IPR dev driver
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2005/11/7/349

linas wrote:
> +/** ipr_eeh_slot_reset - called when pci slot has been reset.
> + *
> + * This routine is called by the pci error recovery recovery
> + * code after the PCI slot has been reset, just before we
> + * should resume normal operations.
> + */
> +static pers_result_t ipr_eeh_slot_reset(struct pci_dev *pdev)
> +{
> +	unsigned long flags = 0;
> +	struct ipr_ioa_cfg *ioa_cfg = pci_get_drvdata(pdev);
> +
> +	// pci_enable_device(pdev);
> +	// pci_set_master(pdev);
I assume you want remove these two lines... The pci config space
restore in ipr's reset handling should cover them.
> +	spin_lock_irqsave(ioa_cfg->host->host_lock, flags);
> +	_ipr_initiate_ioa_reset(ioa_cfg, ipr_reset_restore_cfg_space,
> +	                                 IPR_SHUTDOWN_NONE);
> +	spin_unlock_irqrestore(ioa_cfg->host->host_lock, flags);
> +
> +	return PERS_RESULT_RECOVERED;
> +}
-- 
Brian King
eServer Storage I/O
IBM Linux Technology Center
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.kernel.org
More majordomo info at  
http://vger.kernel.org/majordomo-info.html
Please read the FAQ at  
http://www.tux.org/lkml/