Date: Fri, 6 Dec 2002 10:29:30 -0500 (EST)
From: Burton Windle <>
Subject: [PATCH] fix problem with ver_linux script and procps version
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2002/12/6/85

With the current 2.5 Linux kernel, the ver_linux script prints bad version
info in the Procps line:
Procps                 100.
This is because
razor:/giant/linux/scripts# ps --version
Unknown HZ value! (85) Assume 100.
procps version 2.0.7
razor:/giant/linux/scripts# ps --version 2>&1 | awk 'NR==1{print "Procps         , $NF}'
Procps                 100.
This patch fixes this.
--- linux/scripts/ver_linux.orig        2002-12-06 10:18:05.000000000 -0500
+++ linux/scripts/ver_linux     2002-12-06 10:18:19.000000000 -0500
@@ -61,7 +61,7 @@
 ls -l /usr/lib/lib{g,stdc}++.so  2>/dev/null | awk -F. \
        '{print "Linux C++ Library      " $4"."$5"."$6}'
-ps --version 2>&1 | awk 'NR==1{print "Procps                ", $NF}'
+ps --version 2>&1 | grep version | awk 'NR==1{print "Procps
", $NF}'
 ifconfig --version 2>&1 | grep tools | awk \
 'NR==1{print "Net-tools             ", $NF}'
With the patch, ver_linux looks sane again.
Linux razor 2.5.50bk5 #1 Thu Dec 5 17:28:23 EST 2002 i686 Pentium II (Klamath) GenuineIntel GNU/Linux
Gnu C                  2.95.4
Gnu make               3.79.1
util-linux             2.11n
mount                  2.11n
modutils               2.4.19
e2fsprogs              1.30-WIP
Linux C Library        2.2.5
Dynamic linker (ldd)   2.2.5
Procps                 2.0.7
Net-tools              1.60
Console-tools          0.2.3
Sh-utils               4.5.2
Modules Loaded
--
Burton Windle                           burton@fint.org
Linux: the "grim reaper of innocent orphaned children."
          from /usr/src/linux-2.4.18/init/main.c:461
--- linux/scripts/ver_linux.orig	2002-12-06 10:18:05.000000000 -0500
+++ linux/scripts/ver_linux	2002-12-06 10:18:19.000000000 -0500
@@ -61,7 +61,7 @@
 ls -l /usr/lib/lib{g,stdc}++.so  2>/dev/null | awk -F. \
        '{print "Linux C++ Library      " $4"."$5"."$6}'
 
-ps --version 2>&1 | awk 'NR==1{print "Procps                ", $NF}'
+ps --version 2>&1 | grep version | awk 'NR==1{print "Procps                ", $NF}'
 
 ifconfig --version 2>&1 | grep tools | awk \
 'NR==1{print "Net-tools             ", $NF}'