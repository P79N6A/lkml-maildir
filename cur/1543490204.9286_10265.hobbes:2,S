Date: Wed, 17 Mar 1999 11:21:23 +0000
From: Daniel SILVERSTONE <>
Subject: SCSI problems with Kernel 2.2.3
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/1999/3/17/81

Hi
I am having problems with kernel 2.2.3 and my SCSI chain.
I am fairly certain that there is nothing wrong with the hardware
as windoze :( is capable of using it error free.
I have a plain vanilla 2.2.3 as downloaded from ftp.kernel.org and
I have been unable to use the SCSI chain for a while now :(
I have included all the relevant data below from a simple test which
shouldn't have failed by rights.
----
What I did...
1. Inserted a data CD (M$ Visual studio iirc)
2. ran dd if=/dev/sr1 of=/otherdrive/cdimage.large
----
What happened...
1. dd ran for about 600Mb
2. dd gave "Input Output Error"
3. dd terminated
4. SCSI bus reset
----
Here is the all the information which I consider may be at all helpful...
----
Extracts from /var/log/boot.msg
<4>Linux version 2.2.3 (root@lang-lgb6) (gcc version 2.7.2.3) #2 Sun Mar 14 17:2
7:27 GMT 1999<6>ncr53c8xx: at PCI bus 0, device 19, function 0
<6>ncr53c8xx: 53c875 detected 
<6>ncr53c875-0: rev=0x03, base=0xeb001000, io_port=0xec00, irq=12
<6>ncr53c875-0: ID 7, Fast-20, Parity Checking
<6>ncr53c875-0: on-chip RAM at 0xeb000000
<6>ncr53c875-0: restart (scsi reset).
<4>ncr53c875-0: Downloading SCSI SCRIPTS.
<4>ppa: Version 2.03 (for Linux 2.2.x)
<4>ppa: Found device at ID 6, Attempting to use EPP 32 bit
<4>ppa: Found device at ID 6, Attempting to use PS/2
<4>ppa: Communication established with ID 6 using PS/2
<4>imm: Version 2.03 (for Linux 2.0.0)
<4>scsi0 : ncr53c8xx - revision 3.1h
<4>scsi1 : Iomega VPI0 (ppa) interface
<4>scsi : 2 hosts.
<4>  Vendor: TOSHIBA   Model: CD-ROM XM-5701TA  Rev: 1557
<4>  Type:   CD-ROM                             ANSI SCSI revision: 02
<4>Detected scsi CD-ROM sr0 at scsi0, channel 0, id 2, lun 0
<4>  Vendor: YAMAHA    Model: CRW4416S          Rev: 1.0e
<4>  Type:   CD-ROM                             ANSI SCSI revision: 02
<4>Detected scsi CD-ROM sr1 at scsi0, channel 0, id 3, lun 0
<4>  Vendor: IOMEGA    Model: ZIP 100           Rev: J.03
<4>  Type:   Direct-Access                      ANSI SCSI revision: 02
<4>Detected scsi removable disk sda at scsi1, channel 0, id 6, lun 0
<4>scsi : detected 2 SCSI cdroms 1 SCSI disk total.
<6>ncr53c875-0-<2,*>: FAST-10 SCSI 10.0 MB/s (100 ns, offset 8)
<6>Uniform CDROM driver Revision: 2.52
<6>ncr53c875-0-<3,*>: FAST-10 SCSI 8.0 MB/s (125 ns, offset 16)
<4>sr1: scsi3-mmc drive: 16x/16x writer cd/rw xa/form2 cdda tray
<4>SCSI device sda: hdwr sector= 512 bytes. Sectors= 196608 [96 MB] [0.1 GB]
<4>sda: Write Protect is off
----
What is in /var/log/messages
Mar 17 09:33:50 lang-lgb6 kernel: scsi0 channel 0 : resetting for second half of retries.
Mar 17 09:33:50 lang-lgb6 kernel: SCSI bus is being reset for host 0 channel 0.
Mar 17 09:33:50 lang-lgb6 kernel: ncr53c8xx_reset: pid=37710 reset_flags=1 serial_number=0 serial_number_at_timeout=0
Mar 17 09:33:50 lang-lgb6 kernel: scsi0: device driver called scsi_done() for a syncronous reset.
Mar 17 09:33:50 lang-lgb6 kernel: ncr53c875-0: restart (scsi reset).
Mar 17 09:33:50 lang-lgb6 kernel: ncr53c875-0: Downloading SCSI SCRIPTS.
Mar 17 09:33:52 lang-lgb6 kernel: SCSI CD error : host 0 id 3 lun 0 return code = 2603007f
Mar 17 09:33:52 lang-lgb6 kernel: CD-ROM I/O error: dev 0b:01, sector 1204612
Mar 17 09:33:55 lang-lgb6 kernel: scsi0 channel 0 : resetting for second half of retries.
Mar 17 09:33:55 lang-lgb6 kernel: SCSI bus is being reset for host 0 channel 0.
Mar 17 09:33:55 lang-lgb6 kernel: ncr53c8xx_reset: pid=37711 reset_flags=1 serial_number=0 serial_number_at_timeout=0
Mar 17 09:33:55 lang-lgb6 kernel: scsi0: device driver called scsi_done() for a syncronous reset.
Mar 17 09:33:55 lang-lgb6 kernel: ncr53c875-0: restart (scsi reset).
Mar 17 09:33:55 lang-lgb6 kernel: ncr53c875-0: Downloading SCSI SCRIPTS.
Mar 17 09:33:56 lang-lgb6 kernel: SCSI CD error : host 0 id 3 lun 0 return code = 2603007f
Mar 17 09:33:56 lang-lgb6 kernel: CD-ROM I/O error: dev 0b:01, sector 1204616
Mar 17 09:33:58 lang-lgb6 kernel: scsi0 channel 0 : resetting for second half of retries.
Mar 17 09:33:58 lang-lgb6 kernel: SCSI bus is being reset for host 0 channel 0.
Mar 17 09:33:58 lang-lgb6 kernel: ncr53c8xx_reset: pid=37713 reset_flags=1 serial_number=0 serial_number_at_timeout=0
Mar 17 09:33:58 lang-lgb6 kernel: scsi0: device driver called scsi_done() for a syncronous reset.
Mar 17 09:33:58 lang-lgb6 kernel: ncr53c875-0: restart (scsi reset).
Mar 17 09:33:58 lang-lgb6 kernel: ncr53c875-0: Downloading SCSI SCRIPTS.
Mar 17 09:33:59 lang-lgb6 kernel: SCSI error: host 0 id 3 lun 0 return code = 2603007f
Mar 17 09:33:59 lang-lgb6 kernel: ^ISense class 0, sense error 0, extended sense 0
Mar 17 09:34:00 lang-lgb6 kernel: SCSI CD error : host 0 id 3 lun 0 return code = 2603007f
Mar 17 09:34:00 lang-lgb6 kernel: CD-ROM I/O error: dev 0b:01, sector 1204620
Mar 17 09:34:01 lang-lgb6 kernel: scsi0 channel 0 : resetting for second half of retries.
Mar 17 09:34:01 lang-lgb6 kernel: SCSI bus is being reset for host 0 channel 0.
Mar 17 09:34:01 lang-lgb6 kernel: ncr53c8xx_reset: pid=37714 reset_flags=1 serial_number=0 serial_number_at_timeout=0
Mar 17 09:34:01 lang-lgb6 kernel: scsi0: device driver called scsi_done() for a syncronous reset.
Mar 17 09:34:01 lang-lgb6 kernel: ncr53c875-0: restart (scsi reset).
Mar 17 09:34:01 lang-lgb6 kernel: ncr53c875-0: Downloading SCSI SCRIPTS.
Mar 17 09:34:03 lang-lgb6 kernel: SCSI CD error : host 0 id 3 lun 0 return code = 2603007f
Mar 17 09:34:03 lang-lgb6 kernel: CD-ROM I/O error: dev 0b:01, sector 1204624
Mar 17 09:34:05 lang-lgb6 kernel: scsi0 channel 0 : resetting for second half of retries.
Mar 17 09:34:05 lang-lgb6 kernel: SCSI bus is being reset for host 0 channel 0.
Mar 17 09:34:05 lang-lgb6 kernel: ncr53c8xx_reset: pid=37715 reset_flags=1 serial_number=0 serial_number_at_timeout=0
Mar 17 09:34:05 lang-lgb6 kernel: scsi0: device driver called scsi_done() for a syncronous reset.
Mar 17 09:34:05 lang-lgb6 kernel: ncr53c875-0: restart (scsi reset).
Mar 17 09:34:05 lang-lgb6 kernel: ncr53c875-0: Downloading SCSI SCRIPTS.
Mar 17 09:34:06 lang-lgb6 kernel: SCSI CD error : host 0 id 3 lun 0 return code = 2603007f
Mar 17 09:34:06 lang-lgb6 kernel: CD-ROM I/O error: dev 0b:01, sector 1204628
Mar 17 09:34:08 lang-lgb6 kernel: scsi0 channel 0 : resetting for second half of retries.
Mar 17 09:34:08 lang-lgb6 kernel: SCSI bus is being reset for host 0 channel 0.
Mar 17 09:34:08 lang-lgb6 kernel: ncr53c8xx_reset: pid=37716 reset_flags=1 serial_number=0 serial_number_at_timeout=0
Mar 17 09:34:08 lang-lgb6 kernel: scsi0: device driver called scsi_done() for a syncronous reset.
Mar 17 09:34:08 lang-lgb6 kernel: ncr53c875-0: restart (scsi reset).
Mar 17 09:34:08 lang-lgb6 kernel: ncr53c875-0: Downloading SCSI SCRIPTS.
Mar 17 09:34:10 lang-lgb6 kernel: SCSI CD error : host 0 id 3 lun 0 return code = 2603007f
Mar 17 09:34:10 lang-lgb6 kernel: CD-ROM I/O error: dev 0b:01, sector 1204632
Mar 17 09:34:11 lang-lgb6 kernel: scsi0 channel 0 : resetting for second half of retries.
Mar 17 09:34:11 lang-lgb6 kernel: SCSI bus is being reset for host 0 channel 0.
Mar 17 09:34:11 lang-lgb6 kernel: ncr53c8xx_reset: pid=37717 reset_flags=1 serial_number=0 serial_number_at_timeout=0
Mar 17 09:34:11 lang-lgb6 kernel: scsi0: device driver called scsi_done() for a syncronous reset.
Mar 17 09:34:11 lang-lgb6 kernel: ncr53c875-0: restart (scsi reset).
Mar 17 09:34:11 lang-lgb6 kernel: ncr53c875-0: Downloading SCSI SCRIPTS.
Mar 17 09:34:13 lang-lgb6 kernel: SCSI CD error : host 0 id 3 lun 0 return code = 2603007f
Mar 17 09:34:13 lang-lgb6 kernel: CD-ROM I/O error: dev 0b:01, sector 1204636
Mar 17 09:34:14 lang-lgb6 kernel: scsi0 channel 0 : resetting for second half of retries.
Mar 17 09:34:14 lang-lgb6 kernel: SCSI bus is being reset for host 0 channel 0.
Mar 17 09:34:14 lang-lgb6 kernel: ncr53c8xx_reset: pid=37718 reset_flags=1 serial_number=0 serial_number_at_timeout=0
Mar 17 09:34:14 lang-lgb6 kernel: scsi0: device driver called scsi_done() for a syncronous reset.
Mar 17 09:34:14 lang-lgb6 kernel: ncr53c875-0: restart (scsi reset).
Mar 17 09:34:14 lang-lgb6 kernel: ncr53c875-0: Downloading SCSI SCRIPTS.
Mar 17 09:34:16 lang-lgb6 kernel: ncr53c875-0:3: ERROR (0:4) (8-0-0) (0/5) @ (script 6c:1e000000).
Mar 17 09:34:16 lang-lgb6 kernel: ncr53c875-0: script cmd = 860b0000
Mar 17 09:34:16 lang-lgb6 kernel: ncr53c875-0: regdump: da 00 80 05 47 00 03 0f 71 08 00 00 00 20 0e 02.
Mar 17 09:34:16 lang-lgb6 kernel: ncr53c875-0: have to clear fifos.
Mar 17 09:34:16 lang-lgb6 kernel: ncr53c875-0: unexpected disconnect
Mar 17 09:34:16 lang-lgb6 kernel: ncr53c875-0-<3,0>: COMMAND FAILED (8a 0) @c0004820.
Mar 17 09:34:16 lang-lgb6 kernel: SCSI CD error : host 0 id 3 lun 0 return code = 2603007f
Mar 17 09:34:16 lang-lgb6 kernel: CD-ROM I/O error: dev 0b:01, sector 1204640
----
Extract from /proc/pci
  Bus  0, device  19, function  0:
    SCSI storage controller: NCR 53c875 (rev 3).
      Medium devsel.  IRQ 12.  Master Capable.  Latency=64.  Min Gnt=17.Max Lat=64.
      I/O at 0xec00 [0xec01].
      Non-prefetchable 32 bit memory at 0xeb001000 [0xeb001000].
      Non-prefetchable 32 bit memory at 0xeb000000 [0xeb000000].
----
/proc/cpuinfo (Not that I think it will help)
processor       : 0
vendor_id       : AuthenticAMD
cpu family      : 5
model           : 8
model name      : AMD-K6(tm) 3D processor
stepping        : 12
cpu MHz         : 350.806570
fdiv_bug        : no
hlt_bug         : no
sep_bug         : no
f00f_bug        : no
fpu             : yes
fpu_exception   : yes
cpuid level     : 1
wp              : yes
flags           : fpu vme de pse tsc msr mce cx8 sep pge mmx 3dnow
bogomips        : 699.60
----
/proc/version
Linux version 2.2.3 (root@lang-lgb6) (gcc version 2.7.2.3) #2 Sun Mar 14 17:27:27 GMT 1999
----
/proc/slabinfo (If it helps at all)
slabinfo - version: 1.0
kmem_cache            29     42
pio_request            0      0
tcp_tw_bucket          0      0
tcp_bind_bucket       22    127
tcp_open_request       0      0
skbuff_head_cache      2     50
sock                  54     55
dquot                  0      0
filp                 320    336
signal_queue           0      0
buffer_head        30258  35322
mm_struct             33     62
vm_area_struct       975   1008
dentry_cache        3281   3286
files_cache           32     42
uid_cache              4    127
size-131072            0      0
size-65536             0      0
size-32768             8      8
size-16384             2      2
size-8192              0      0
size-4096              1      2
size-2048             42     84
size-1024             13     16
size-512              34     40
size-256              14     28
size-128             380    400
size-64               89    126
size-32              464    504
slab_cache            39     63
----
/proc/scsi/ncr53c8xx/0
General information:
  Chip NCR53C875, device id 0xf, revision id 0x3
  IO port address 0xec00, IRQ number 12
  Using memory mapped IO at virtual address 0xc5801000
  Synchronous period factor 12, max commands per lun 32
----
Output from cdrecord dev=0,3,0 -inq (On the drive tested)
Cdrecord release 1.6.1 Copyright (C) 1995-1998 JÃ¶rg Schilling
scsidev: '0,3,0'
scsibus: 0 target: 3 lun: 0
Device type    : Removable CD-ROM
Version        : 2
Response Format: 2
Capabilities   : SYNC 
Vendor_info    : 'YAMAHA  '
Identifikation : 'CRW4416S        '
Revision       : '1.0e'
Device seems to be: Generic mmc CD-RW.
----
I'm not sure if anything else will help. If so, then I will supply it on demand.
Many many thanks for any light you could shed on this problem.
Daniel Silverstone
-- 
Daniel Silverstone
D.Silverstone@cs.ucl.ac.uk
 0795 760 3552
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.rutgers.edu
Please read the FAQ at 
http://www.tux.org/lkml/