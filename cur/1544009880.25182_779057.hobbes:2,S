Date: Wed, 10 Dec 2008 09:39:10 -0800 (PST)
From: Linus Torvalds <>
Subject: Re: [PATCH] lib/idr.c: Fix bug introduced by RCU fix
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2008/12/10/219

On Wed, 10 Dec 2008, Manfred Spraul wrote:
>
> The last patch to lib/idr.c caused a bug if idr_get_new_above() was
> called on an empty idr:
> Usually, nodes stay on the same layer. New layers are added to the top
> of the tree.
> The exception is idr_get_new_above() on an empty tree: In this case,
> the new root node is first added on layer 0, then moved upwards.
> p->layer was not updated.
> 
> As usual: You shall never rely on the source code comments, they
> will only mislead you.
> 
> Signed-off-by: Manfred Spraul <manfred@colorfullife.com>
Dave Airlie - can you get this tested and acked with the people who saw 
this problem with DRI?
		Linus