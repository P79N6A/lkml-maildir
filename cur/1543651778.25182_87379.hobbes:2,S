Date: Wed, 6 Nov 2002 14:11:24 +0100 (CET)
From: Roman Zippel <>
Subject: Re: [PATCH] [kconfig] Single-menu mode support for make menuconfig
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2002/11/6/68

Hi,
On Sun, 3 Nov 2002, Petr Baudis wrote:
>   With this mode, when you enter a category, no new menu is open, but the
> category is unrolled to the current menu, thus the whole configuration is
> forming one single tree. Some users prefer this as a form of configuration, as
> they consider it easier to take in than the classical behaviour.
It looks mostly ok.
> diff -ru linux/scripts/kconfig/expr.h linux+pasky/scripts/kconfig/expr.h
> --- linux/scripts/kconfig/expr.h	Sun Nov  3 15:24:01 2002
> +++ linux+pasky/scripts/kconfig/expr.h	Sun Nov  3 15:00:17 2002
> @@ -169,6 +169,7 @@
>  	//char *help;
>  	struct file *file;
>  	int lineno;
> +	int expanded; /* solely for frontend use */
>  	//void *data;
>  };
The menu structure is mostly readonly, if front ends need to store 
something there, I'd rather reactivate the data field (which was meant for 
this, but it's currently not used).
> @@ -682,6 +699,9 @@
>  int main(int ac, char **av)
>  {
>  	int stat;
> +
> +	single_menu_mode = !!getenv("SINGLE_MENU");
> +
>  	conf_parse(av[1]);
>  	conf_read(NULL);
> 
Could you give it a different name (MENUCONFIG_MODE?) and check it 
contents instead of just testing for existence?
> diff -ru linux/scripts/lxdialog/util.c linux+pasky/scripts/lxdialog/util.c
> --- linux/scripts/lxdialog/util.c	Sun Nov  3 15:24:21 2002
> +++ linux+pasky/scripts/lxdialog/util.c	Sun Nov  3 15:11:44 2002
> @@ -348,7 +348,7 @@
>  		c = tolower(string[i]);
> 
>  		if (strchr("<[(", c)) ++in_paren;
> -		if (strchr(">])", c)) --in_paren;
> +		if (strchr(">])", c) && in_paren > 0) --in_paren;
> 
>  		if ((! in_paren) && isalpha(c) && 
>  		     strchr(exempt, c) == 0)
What's this needed for?
bye, Roman
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.kernel.org
More majordomo info at  
http://vger.kernel.org/majordomo-info.html
Please read the FAQ at  
http://www.tux.org/lkml/