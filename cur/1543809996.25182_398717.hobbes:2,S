Date: Sun, 19 Feb 2006 13:50:37 +0100
From: Mattia Dongili <>
Subject: [kbuild,-mm] [PATCH] workaround a cscope bug (make cscope segfaults)
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2006/2/19/35

Workaround a cscope bug where a trailing ':' in VPATH makes it segfault
and let it build the cross-reference succesfully.
VPATH=/home/mattia/devel/kernel/git/linux-2.6: cscope -b
[1]    17555 segmentation fault VPATH=/home/mattia/devel/kernel/git/linux-2.6: cscope -b
Signed-off-by: Mattia Dongili <malattia@linux.it>
---
'make cscope' segfaults with current kbuild.git (I'm using -rc3-mm1 actually
and the same problem appears in some previous versions too).
I'm running Debian's cscope-15.5+cvs20050816-1 (cscope --version says
16.0a).
I think it would be nice to have this workaround as cscope CVS doesn't
show much activity and its latest release dates somewhen in 2003.
As shown above, to reproduce the segfault here I just need to run
VPATH=/home/mattia/devel/kernel/git/linux-2.6: cscope -b
in the kernel source tree with the previously generated cscope.files,
the trailing ':' is what makes cscope die.
 Makefile |    4 ++++
 1 files changed, 4 insertions(+), 0 deletions(-)
77d1a8a386df409709ad0b4f48a8b09ce08d990d
diff --git a/Makefile b/Makefile
index 111a699..e0f9108 100644
--- a/Makefile
+++ b/Makefile
@@ -138,7 +138,11 @@ objtree		:= $(CURDIR)
 src		:= $(srctree)
 obj		:= $(objtree)
 
+ifeq ($(KBUILD_EXTMOD),)
+VPATH		:= $(srctree)
+else
 VPATH		:= $(srctree):$(KBUILD_EXTMOD)
+endif
 
 export srctree objtree VPATH TOPDIR
 
-- 
1.2.1-dirty
-- 
mattia
:wq!
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.kernel.org
More majordomo info at  
http://vger.kernel.org/majordomo-info.html
Please read the FAQ at  
http://www.tux.org/lkml/