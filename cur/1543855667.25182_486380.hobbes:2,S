Date: Wed, 29 Nov 2006 11:37:37 +0900
From: Akinobu Mita <>
Subject: Re: [PATCH 2/2 -mm] fault-injection: lightweight code-coverage maximizer
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2006/11/28/267

On Tue, Nov 28, 2006 at 12:14:36PM -0800, Don Mullis wrote:
> First, waiting a few seconds for the standard FC-6 daemons to wake up.
> Then, Xemacs and Firefox.  Not tested on SMP.
Is it failslab or fail_page_alloc ?
> > This doesn't maximize code coverage. It makes fault-injector reject
> > any failures which have same stacktrace before.
> 
> Since the volume of (repeated) dumps is greatly reduced, 
> interval/probability can be set more aggressively without crippling
> interaction.  This increases the number of error recovery paths covered
> per unit of wall clock time.
> 
It seems artificial. Injecting failures into slab or page allocator causes
vastly greater range of errors and it should be. I feel what you really
want is new fault capability.
Fault injection is designed be extensible. It's not only for failslab,
fail_page_alloc, and fail_make_request.
If we want to inject errors into try_something() and have own tuning or
setting, we just need to extend fault attribute and define own judging
function,
struct fail_try_something_attr {
	struct gorgeous_tuning tuning;
	struct fail_attr attr;
} = fail_try_something = {
	.attr = FAULT_ATTR_INITIALIZER,
};
static int should_fail_try_something(void *data)
{
	if (tuning_did_clever_decision(&fail_try_something.tuning, data))
		return 0;
	return should_fail(&fail_try_something.attr);
}
Then insert it into try_something()
int try_something(void *data)
{
	if (should_fail_try_something(data))
		return 0;
...
	return 1;
}
Common debugfs entries for fault capabilities will be complicated
soon by pushing new entries for every fault case or pattern.
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.kernel.org
More majordomo info at  
http://vger.kernel.org/majordomo-info.html
Please read the FAQ at  
http://www.tux.org/lkml/