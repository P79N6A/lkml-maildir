Date: Thu, 16 Nov 2006 11:21:15 +0100
From: Ingo Molnar <>
Subject: [patch, -rc6] x86_64: UP build fix, arch/x86_64/kernel/mce_amd.c
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2006/11/16/52

Subject: [patch] x86_64: UP build fix, arch/x86_64/kernel/mce_amd.c
From: Ingo Molnar <mingo@elte.hu>
fix x86_64/kernel/mce_amd.c build bug:
 arch/x86_64/kernel/mce_amd.c: In function ‘threshold_remove_bank’:
 arch/x86_64/kernel/mce_amd.c:597: error: ‘shared_bank’ undeclared (first use in this function)
 arch/x86_64/kernel/mce_amd.c:597: error: (Each undeclared identifier is reported only once
 arch/x86_64/kernel/mce_amd.c:597: error: for each function it appears in.)
 make[1]: *** [arch/x86_64/kernel/mce_amd.o] Error 1
 make: *** [arch/x86_64/kernel/mce_amd.o] Error 2
Signed-off-by: Ingo Molnar <mingo@elte.hu>
---
 arch/x86_64/kernel/mce_amd.c |    2 ++
 1 file changed, 2 insertions(+)
Index: linux/arch/x86_64/kernel/mce_amd.c
===================================================================
--- linux.orig/arch/x86_64/kernel/mce_amd.c
+++ linux/arch/x86_64/kernel/mce_amd.c
@@ -593,12 +593,14 @@ static void threshold_remove_bank(unsign
 
 	sprintf(name, "threshold_bank%i", bank);
 
+#ifdef CONFIG_SMP
 	/* sibling symlink */
 	if (shared_bank[bank] && b->blocks->cpu != cpu) {
 		sysfs_remove_link(&per_cpu(device_mce, cpu).kobj, name);
 		per_cpu(threshold_banks, cpu)[bank] = NULL;
 		return;
 	}
+#endif
 
 	/* remove all sibling symlinks before unregistering */
 	for_each_cpu_mask(i, b->cpus) {
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.kernel.org
More majordomo info at  
http://vger.kernel.org/majordomo-info.html
Please read the FAQ at  
http://www.tux.org/lkml/