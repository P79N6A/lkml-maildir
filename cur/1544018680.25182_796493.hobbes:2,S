Date: Fri, 23 Jan 2009 20:39:47 -0800
From: "H. Peter Anvin" <>
Subject: Re: [RFC v2 -tip 0/3] x86: reduce fixup of uaccess
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2009/1/23/370

Hiroshi Shimamoto wrote:
> This patch series redues fixup code for exceptions of uaccess in signal.
> 
> There is a lot of fixup code which is generated by using __{get|put}_user.
> I think that code can be reduced. The concept is that to add uaccess_err in
> thread_info and set it to -EFAULT on exception, finally check this value on
> the last of function.
> 
> The code size reductions are below;
> $ size *signal*.o.*
>    text	   data	    bss	    dec	    hex	filename
>    4596	      0	      0	   4596	   11f4	ia32_signal.o.new
>    6006	      0	      0	   6006	   1776	ia32_signal.o.old
>    3583	      0	      0	   3583	    dff	signal.o.new
>    4540	      0	      0	   4540	   11bc	signal.o.old
>    3863	      0	      0	   3863	    f17	signal32.o.new
>    4876	      0	      0	   4876	   130c	signal32.o.old
> [ signal32.o means signal.o on 32-bit. ]
> 
Applied to tip:x86/uaccess.  I haven't tested it much yet, but at least
a visual lookover looks good.
Thanks!
	-hpa
-- 
H. Peter Anvin, Intel Open Source Technology Center
I work for Intel.  I don't speak on their behalf.