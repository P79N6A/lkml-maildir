Date: Thu, 20 Jan 2000 10:19:58 +0100
From: Martin Mares <>
Subject: Re: PCI in docking station
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2000/1/20/145

Hello,
> But then when I ifconfig it the log says:
> Jan 20 09:02:42 localhost kernel: TLAN:  Cannot open eth1 because IRQ 11
> is already in use.
> 
> I have looked at the code for all of the drivers that I can see and they
> all seem to try to open the device with IRQ shared if it is a PCI device
> so why am I getting an "IRQ11 already in use" message?
   A bug in the TLAN driver. Please try applying this patch.
				Have a nice fortnight
-- 
Martin `MJ' Mares <mj@ucw.cz> <mj@suse.cz> 
http://atrey.karlin.mff.cuni.cz/~mj/
"All computers run at the same speed... with the power off."
--- drivers/net/tlan.c.mj	Thu Jan 20 10:18:57 2000
+++ drivers/net/tlan.c	Thu Jan 20 10:18:57 2000
@@ -72,12 +72,10 @@
 static	int		TLanDevicesInstalled = 0;
 
 static	int		aui = 0;
-static	int		sa_int = 0;
 static	int		duplex = 0;
 static	int		speed = 0;
 
 MODULE_PARM(aui, "i");
-MODULE_PARM(sa_int, "i");
 MODULE_PARM(duplex, "i");
 MODULE_PARM(speed, "i");
 MODULE_PARM(debug, "i");
@@ -354,7 +352,6 @@
 			speed = 0;
 		}
 		priv->speed =      speed;
-		priv->sa_int =     sa_int;
 		priv->debug =      debug;
 		
 		spin_lock_init(&priv->lock);
@@ -502,7 +499,6 @@
 	} else if ( priv->speed == 0x2 ) {
 		priv->speed = TLAN_SPEED_100;
 	}
-	priv->sa_int =     dev->mem_start & 0x02;
 	priv->debug =      dev->mem_end;
 	spin_lock_init(&priv->lock);
 
@@ -729,12 +725,7 @@
 	int		err;
 
 	priv->tlanRev = TLan_DioRead8( dev->base_addr, TLAN_DEF_REVISION );
-	if ( priv->sa_int ) {
-		TLAN_DBG( TLAN_DEBUG_GNRL, "TLAN:   Using SA_INTERRUPT\n" ); 
-		err = request_irq( dev->irq, TLan_HandleInterrupt, SA_SHIRQ | SA_INTERRUPT, TLanSignature, dev );
-	} else {
-		err = request_irq( dev->irq, TLan_HandleInterrupt, SA_SHIRQ, TLanSignature, dev );
-	}
+	err = request_irq( dev->irq, TLan_HandleInterrupt, SA_SHIRQ | SA_INTERRUPT, TLanSignature, dev );
 	if ( err ) {
 		printk( "TLAN:  Cannot open %s because IRQ %d is already in use.\n", dev->name, dev->irq );
 		return -EAGAIN;
--- drivers/net/tlan.h.mj	Thu Jan 20 10:19:02 2000
+++ drivers/net/tlan.h	Thu Jan 20 10:19:02 2000
@@ -182,7 +182,6 @@
 	u32			duplex;
 	u32			phy[2];
 	u32			phyNum;
-	u32			sa_int;
 	u32			speed;
 	u8			tlanRev;
 	u8			tlanFullDuplex;
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.rutgers.edu
Please read the FAQ at 
http://www.tux.org/lkml/