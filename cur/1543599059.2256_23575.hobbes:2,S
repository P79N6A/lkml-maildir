Date: Sat, 25 Aug 2001 10:03:38 -0400 (EDT)
From: Kernel Related Emails <>
Subject: [PATCH] Support for new chipsets in AGPGART
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2001/8/25/22

Attached is a patch to identify two new chipsets in the AGP kernel
module.  It adds support for a newer version of the AMD Irongate and the
new VIA KT266 chipset.  I have tested both of these.  The AMD patch was
needed on the MSI K7 Master-S and the VIA was needed on the SOYO
K7VDRAGON.
Enjoy,
Kris Kersey
LinuxHardware.org Site Manager
augustus@linuxhardware.org
diff -urN linux/drivers/char/agp/agp.h linux-kk/drivers/char/agp/agp.h
--- linux/drivers/char/agp/agp.h	Wed Aug 15 04:22:15 2001
+++ linux-kk/drivers/char/agp/agp.h	Sat Aug 25 09:56:42 2001
@@ -156,6 +156,9 @@
 #ifndef PCI_DEVICE_ID_VIA_8363_0
 #define PCI_DEVICE_ID_VIA_8363_0      0x0305
 #endif
+#ifndef PCI_DEVICE_ID_VIA_8366_0
+#define PCI_DEVICE_ID_VIA_8366_0      0x3099
+#endif
 #ifndef PCI_DEVICE_ID_INTEL_810_0
 #define PCI_DEVICE_ID_INTEL_810_0       0x7120
 #endif
@@ -194,6 +197,9 @@
 #endif
 #ifndef PCI_DEVICE_ID_AMD_IRONGATE_0
 #define PCI_DEVICE_ID_AMD_IRONGATE_0    0x7006
+#endif
+#ifndef PCI_DEVICE_ID_AMD_IRONGATE_1
+#define PCI_DEVICE_ID_AMD_IRONGATE_1    0x700e
 #endif
 #ifndef PCI_VENDOR_ID_AL
 #define PCI_VENDOR_ID_AL		0x10b9
diff -urN linux/drivers/char/agp/agpgart_be.c linux-kk/drivers/char/agp/agpgart_be.c
--- linux/drivers/char/agp/agpgart_be.c	Wed Aug 15 04:22:15 2001
+++ linux-kk/drivers/char/agp/agpgart_be.c	Sat Aug 25 09:56:42 2001
@@ -2877,6 +2877,12 @@
 		"AMD",
 		"Irongate",
 		amd_irongate_setup },
+	{ PCI_DEVICE_ID_AMD_IRONGATE_1,
+		PCI_VENDOR_ID_AMD,
+		AMD_IRONGATE,
+		"AMD",
+		"Irongate",
+		amd_irongate_setup },
 	{ 0,
 		PCI_VENDOR_ID_AMD,
 		AMD_GENERIC,
@@ -3024,6 +3030,12 @@
 		VIA_APOLLO_KT133,
 		"Via",
 		"Apollo Pro KT133",
+		via_generic_setup },
+	{ PCI_DEVICE_ID_VIA_8366_0,
+		PCI_VENDOR_ID_VIA,
+		VIA_APOLLO_KT133,
+		"Via",
+		"Apollo Pro KT266",
 		via_generic_setup },
 	{ 0,
 		PCI_VENDOR_ID_VIA,