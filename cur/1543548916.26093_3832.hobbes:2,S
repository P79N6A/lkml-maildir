Date: Fri, 15 Sep 2000 14:09:53 +0200
From: "Andi Kleen" <>
Subject: Re: [PATCH] Useless inode semaphore locking in 2.4.0-test8
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2000/9/15/74

On Fri, Sep 15, 2000 at 02:00:38PM +0200, Eric PAIRE wrote:
> Hi,
> 
> In open.c:do_truncate(), the call to notify_change() is protected by
> the inode->i_sem, which seems to me useless, and thus can be removed.
> BTW, I also removed the useless inode pointer and error local variables.
Please don't. You opened race country with writes in most file systemsnow. 
In reiserfs it is also needed to lock against tail merging.
Also truncate inode locking is needed to get a halfway reliable loopback
device (unlike the current one)
-Andi
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.kernel.org
Please read the FAQ at 
http://www.tux.org/lkml/