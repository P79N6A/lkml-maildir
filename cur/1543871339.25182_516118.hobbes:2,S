Date: Tue, 6 Mar 2007 11:56:24 +0100
From: Jean Delvare <>
Subject: Re: i2c vs nVidia [Re: 2.6.21-rc2-mm1]
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2007/3/6/114

Hi All,
On Tue, 6 Mar 2007 09:45:43 +0100, Jean Delvare wrote:
> > > I guess we need to wait and see if someone hits the same problems
> > > with an in-kernel driver.
> 
> I just did, with i2c-nforce2. The key to trigger it seems to be to load
> an i2c bus driver _after_ loading i2c-isa and a suitable i2c-isa-based
> hardware monitoring driver (w83791d, w83627hf, w83627ehf, it87, lm78,
> pc87360, sis5595, smsc47m1, smsc47b397, via686a or vt8231.) I have no
> idea why, though. Given that I was able to trigger the problem with
> only my own patches on top of Linus' tree, it means that the bug was
> clearly introduced by one of my patches. I'll bisect my stack now to
> find out which one. There aren't that many patches so it should be
> relatively quick.
Faulty patch is i2c-06-remove-duplicate-i2c-drivers-list.patch. The
oops is the result of the combination of two factors:
1* I'm too optimistic trying to remove the duplicate i2c drivers list
now. i2c-isa drivers are listed in the list managed by the driver
model, but not in the list managed by i2c-core. This difference between
both lists caused new errors to be returned, triggering the second
problem.
2* We do not want i2c_add_adapter to fail just because one
attach_adapter callback returned an error. The patch improperly caused
this to happen, while i2c_add_adapter is not designed to handle these
errors.
The bottom line is that I really need to kill i2c-isa before I can
apply this patch. So I'll drop it out for now, sorry for the noise.
-- 
Jean Delvare
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.kernel.org
More majordomo info at  
http://vger.kernel.org/majordomo-info.html
Please read the FAQ at  
http://www.tux.org/lkml/