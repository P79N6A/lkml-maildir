Date: Thu, 18 Mar 1999 12:35:25 -0600 (CST)
From: "Andre M. Hedrick" <>
Subject: Re: Maybe Disk Problem.
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/1999/3/18/153

Sorry,
I have not forgotten you; however,..........
Someone left my telescope on while I was out with the flu.
It went round and round and round and round........
My 125 lbs mirror is out of alignment and people have been making noise to
get it working, and I have a public open house tonight........
By monday I should be able to review all that you sent me again and offer
something.  Again, I apologize for not replying earlier.
On Thu, 18 Mar 1999, Pavel Ravits wrote:
> Vladimir Dergachev wrote:
> 
> > mc is just a program. It should not affect the hardware so much as to
> > cause a distortion. What probably happens it accesses disk and/or paints
> > something on the screen that makes your monitor unstable.
> 
> I discovered that the distortion was because I put setfont into ~/.bashrc so it
> loaded every login and mc execution of course. sorry to bother you with this. 
> 
> > > ide 5.1 Quantum disk,
> > What is the output of hdparm -I ?
> 
> I include hdparm -i in the end.
>  
> > > P2 processor and Motherboard,
> > What motheboard ? (are they any markers on it ? , can you find the
> > manufacturer (it may have new bios or at least notes about bugs)
> 
> another stuff from boot and from /proc in the end.
>  
> > > *DMA makes problems so I work without it (~4 times slower).
> > > *Mouse in gpm is ok, but inside X middle button doesn't work - and I tryed everything,
> > >  now I work with the middle emulation.
> > >
> > This one I can cure for you :) Do this :
> > put -R in gpm argument (it will pipe it output thru /dev/gpmdata)
> > and configure Xserver to use /dev/gpmdata as mouse device with type
> > "MouseSystems". I have found that gpm understands (generally) more mice
> > than Xfree. Gpm also behaves better when you disconnect and connect it.
> 
> Cool!! it works; haaaaaalleluya!!!!!!!
> now left to set copy past from console to X :)))
> It's my fault actually because this stuff exists in the 3-buttons howto,
> I read it a long time ago, but probably as I was then very new to linux,
> did something wrong and it didn't worked. 
> 
> 
> So my almost last but not least problem is the DMA thing - I able to exchange
> my motherboard and/or disk I just need to know whether they are really wrong
> and which one. If wrong then what is good?
> I need understand that the motherboard is supposed to support p2 so maybe
> it should be relied on, on the other side the Quantum 5.1 is well known model,
> manufacturer and known to work well:
> "The Quantum SE, ST, EL, and EX series are all fully compliant with Linux
> and UDMA, provide the mainboard or host adapter is okay."
> what is host adapter anyway?
> 
> I really appreciate your help,
> 
> I sent couple of times the bellow data to
> 
> Andre Hedrick
> The Linux IDE guy
> 
> but he didn't returned me a message. 
> I attach his message sent to me and Steve Dodd.
> And my answer.
> 
> /dev/hda:
> 
>  Model=QUANTUM FIREBALL EL5.1A, FwRev=A08.1100, SerialNo=345816717385
>  Config={ HardSect NotMFM HdSw>15uSec Fixed DTR>10Mbs }
>  RawCHS=10602/15/63, TrkSize=32256, SectSize=21298, ECCbytes=4
>  BuffType=3(DualPortCache), BuffSize=418kB, MaxMultSect=16, MultSect=off
>  DblWordIO=no, maxPIO=2(fast), DMA=yes, maxDMA=2(fast)
>  LBA CHS=623/255/63 Native, LBAsects=10018890
>  tDMA={min:120,rec:120}, DMA modes: sword0 sword1 sword2 mword0 mword1 mword2 
>  IORDY=on/off, tPIO={min:120,w/IORDY:120}, PIO modes: mode3 mode4 
>  UDMA modes: mode0 mode1 *mode2
>  Drive Supports : ATA/ATAPI-4 T13 1153D revision 15 : ATA-1 ATA-2 ATA-3 ATA-4
> 
> 
> 
> cat /proc/pci | grep IDE:
>     IDE interface: Intel 82371AB PIIX4 IDE (rev 1).
> 
> 
> 
> Linux version 2.2.2 (root@darkcastle.org) (gcc version 2.7.2.3) #2 Tue Mar 2 12:41:10 IST 1999
> Detected 267279854 Hz processor.
> Console: colour VGA+ 80x25
> Calibrating delay loop... 266.24 BogoMIPS
> Memory: 63352k/65536k available (876k kernel code, 412k reserved, 856k data, 40k init)
> CPU: Intel Pentium II (Deschutes) stepping 02
> Checking 386/387 coupling... OK, FPU using exception 16 error reporting.
> Checking 'hlt' instruction... OK.
> POSIX conformance testing by UNIFIX
> PCI: PCI BIOS revision 2.10 entry at 0xfb330
> PCI: Using configuration type 1
> PCI: Probing PCI hardware
> Linux NET4.0 for Linux 2.2
> Based upon Swansea University Computer Society NET3.039
> NET4: Unix domain sockets 1.0 for Linux NET4.0.
> NET4: Linux TCP/IP 1.0 for NET4.0
> IP Protocols: ICMP, UDP, TCP
> Starting kswapd v 1.5 
> Detected PS/2 Mouse Port.
> Serial driver version 4.27 with no serial options enabled
> ttyS00 at 0x03f8 (irq = 4) is a 16550A
> ttyS01 at 0x02f8 (irq = 3) is a 16550A
> pty: 256 Unix98 ptys configured
> apm: BIOS version 1.2 Flags 0x07 (Driver version 1.9)
> es1370: version v0.17 time 12:42:42 Mar  2 1999
> es1370: found adapter at io 0xe400 irq 10
> es1370: features: joystick off, line in, mic impedance 0
> PIIX4: IDE controller on PCI bus 00 dev 39
> PIIX4: not 100% native mode: will probe irqs later
>     ide0: BM-DMA at 0xf000-0xf007, BIOS settings: hda:pio, hdb:pio
>     ide1: BM-DMA at 0xf008-0xf00f, BIOS settings: hdc:pio, hdd:pio
> hda: QUANTUM FIREBALL EL5.1A, ATA DISK drive
> hdc: SAMSUNG SHD-3212A (APOLLO-4) AD, ATA DISK drive
> hdd: ATAPI CD-ROM DRIVE 32X MAXIMUM, ATAPI CDROM drive
> ide0 at 0x1f0-0x1f7,0x3f6 on irq 14
> ide1 at 0x170-0x177,0x376 on irq 15
> hda: QUANTUM FIREBALL EL5.1A, 4892MB w/418kB Cache, CHS=623/255/63
> hdc: SAMSUNG SHD-3212A (APOLLO-4) AD, 407MB w/128kB Cache, CHS=1002/16/52
> hdd: ATAPI 27X CD-ROM drive, 120kB Cache
> Uniform CDROM driver Revision: 2.52
> Floppy drive(s): fd0 is 1.44M
> FDC 0 is a post-1991 82077
> PPP: version 2.3.3 (demand dialling)
> TCP compression code copyright 1989 Regents of the University of California
> PPP line discipline registered.
> SLIP: version 0.8.4-NET3.019-NEWTTY (dynamic channels, max=256) (6 bit encapsulation enabled).
> CSLIP: code copyright 1989 Regents of the University of California.
> SLIP linefill/keepalive option.
> Partition check:
>  hda: hda1 hda2 < hda5 hda6 hda7 hda8 hda9 >
>  hdc: hdc1
> VFS: Mounted root (ext2 filesystem) readonly.
> Freeing unused kernel memory: 40k freed
> TIOCSER?WILD ioctl obsolete, ignored.
> TIOCSER?WILD ioctl obsolete, ignored.
> 
> 
> -----------------------------------------------------------
> 
> 
> Subject: 
>        Re: (U)DMA issues - another for the blacklist? (was Re: Maybe Disk Problem.)
>    Date: 
>        Tue, 2 Mar 1999 23:20:32 -0600 (CST)
>    From: 
>        "Andre M. Hedrick" <hedrick@Astro.Dyer.Vanderbilt.Edu>
>     To: 
>        Steve Dodd <dirk@loth.demon.co.uk>
>     CC: 
>        Pavel Ravits <br2@netvision.net.il>, linux-kernel@vger.rutgers.edu
> 
> 
> 
> 
> I'm semi-back from the FLU..............
> 
> You two will need to clue me in some.
> 
> On Tue, 2 Mar 1999, Steve Dodd wrote:
> 
> > > I'm not forcing DMA with hdparm and I don't know how to do it, but as
> > > you said here
> > > I indeed found option in 2.2.1 to turn off DMA ( but not UDMA ; What
> 
> UDMA is a superset of DMA, and if you turn off DMA so goes UDMA.
> Note the converse does not happen.
> 
> > > mode
> > > is it working
> > > now anyway :)) I turned it off, compiled the kernel 80 times with no
> > > problems.
> 
> Recompile with the CONFIG_AUTODMA option disabled.
> Next, turn on DMA/UDMA support in the BIOS.
> Then boot new kernel.
> 
> Get hdparm-3.5 plus hdparm-3.5f.patch from URL at bottom.
> patch -p0 < hdparm-3.5f.patch inside hdparm-3.5/ directory.
> 
> > > My configuration is:
> > > P2 266 + 64MB + 5.1 Quantum
> > > Motherboard: SP-P2LXC ( i don't have the company name).
> 
> PIIX4: IDE controller on PCI bus 00 dev 39
> PIIX4: not 100% native mode: will probe irqs later
>     ide0: BM-DMA at 0xf000-0xf007, BIOS settings: hda:pio, hdb:pio
>     ide1: BM-DMA at 0xf008-0xf00f, BIOS settings: hdc:pio, hdd:pio
> hda: QUANTUM FIREBALL EL5.1A, ATA DISK drive
> hdc: SAMSUNG SHD-3212A (APOLLO-4) AD, ATA DISK drive
> hdd: ATAPI CD-ROM DRIVE 32X MAXIMUM, ATAPI CDROM drive
> ide0 at 0x1f0-0x1f7,0x3f6 on irq 14
> ide1 at 0x170-0x177,0x376 on irq 15
> hda: QUANTUM FIREBALL EL5.1A, 4892MB w/418kB Cache, CHS=623/255/63
> hdc: SAMSUNG SHD-3212A (APOLLO-4) AD, 407MB w/128kB Cache, CHS=1002/16/52
> hdd: ATAPI 27X CD-ROM drive, 120kB Cache
> 
> > Umm, if (U)DMA is broken for your particular drive/motherboard combination,
> 
> Now do you get UDMA or (U)DMA, there is a difference.
> The latter states that the BIOS failed to be enabled or setup UDMA support
> correctly, and the former is obvious that everthing is fine.
> 
> > you're basically stuck. You can try winging at the manufacturers or retailers,
> > but I don't know how far that'll get you. But not having DMA shouldn't make
> > your system unusably slow, anyway?
> 
> No, unless you are doing heavy disk IO; however, program start times will
> be longer.
> 
> The Quantum SE, ST, EL, and EX series are all fully compliant with Linux
> and UDMA, provide the mainboard or host adapter is okay.
> 
> > >  Model=QUANTUM FIREBALL EL5.1A, FwRev=A08.1100, SerialNo=34581671
> 
> I need more info, but do it off the list for now.
> 
> Andre Hedrick
> The Linux IDE guy  --  
http://www.dyer.vanderbilt.edu/server/udma/
> 
> 
> 
> -----------------------------------------------------------
> 
> Subject: 
>        Re: (U)DMA issues - another for the blacklist? (was Re: Maybe Disk Problem.)
>    Date: 
>        Sun, 07 Mar 1999 21:49:18 +0200
>    From: 
>        Pavel Ravits <br2@netvision.net.il>
>     To: 
>        "Andre M. Hedrick" <hedrick@Astro.Dyer.Vanderbilt.Edu>
>     CC: 
>        "linux-kernel@vger.rutgers.edu" <linux-kernel@vger.rutgers.edu>, Steve Dodd <dirk@loth.demon.co.uk>,
>        Pavel Ravits <br2@netvision.net.il>
> 
> 
> 
> 
> Hi,
> 
> 
> (2nd message)
> 
> Andre M. Hedrick wrote:
> 
> > Recompile with the CONFIG_AUTODMA option disabled.
> > Next, turn on DMA/UDMA support in the BIOS.
> > Then boot new kernel.
> 
> Yes, as I said the option now disabled.
> About the BIOS support for the DMA/UDMA - this is that I found:
> *there is a place to switch UDMA for the master/slave, but the switch
>  is whether UDMA will be auto or disabled so of course it was and is auto.
> *In the autodetecting the possible modes to set are LBA/NORMAL/LARGE.
>  it was LBA, I tryed NORMAL -> destroyed the MBR and something more and
>  then returned it to previous LBA.
> Anyway on boot of the computer(not linux) there is this table and it shows me
> that the disk mode is LBA,UDMA2.
> 
> > Get hdparm-3.5 plus hdparm-3.5f.patch from URL at bottom.
> > patch -p0 < hdparm-3.5f.patch inside hdparm-3.5/ directory.
> 
> the new hdparm is now attached.
> 
> > The Quantum SE, ST, EL, and EX series are all fully compliant with Linux
> > and UDMA, provide the mainboard or host adapter is okay.
> 
> what is host adapter? - isn't it on the motherboard?
>  
> > > >  Model=QUANTUM FIREBALL EL5.1A, FwRev=A08.1100, SerialNo=34581671
>  
> > I need more info, but do it off the list for now.
> 
> info on the disk -> then hdparm has it,
> otherwise info on what ?, or it doesn't relates to me.
> 
> 
> Thanks,
> Pavel.
> 
> -
> To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
> the body of a message to majordomo@vger.rutgers.edu
> Please read the FAQ at 
http://www.tux.org/lkml/
> 
Andre Hedrick
The Linux IDE guy  --  
http://www.dyer.vanderbilt.edu/server/udma/
APC UPS Daemon Support Center.
			
http://www.brisse.dk/site/apcupsd/
Going FSF/GNU or GPL2 source soon.
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.rutgers.edu
Please read the FAQ at 
http://www.tux.org/lkml/