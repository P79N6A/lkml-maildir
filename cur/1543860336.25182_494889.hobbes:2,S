Date: Fri, 29 Dec 2006 13:45:05 +0100
From: Laurent Riffard <>
Subject: Re: [BUG 2.6.20-rc2] atkbd.c: Spurious ACK
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2006/12/29/64

Le 29.12.2006 06:54, Rene Herman a Ã©crit :
> Dmitry Torokhov wrote:
> 
>> On Friday 29 December 2006 00:17, Rene Herman wrote:
> 
>>> Yes, I do have that in my tree. From the looks of it it's probably 
>>> not surprising, but the following gets me blinking leds without the 
>>> spurious ACK messages. Maybe still useful to know?
>>>
>>> diff --git a/drivers/input/serio/i8042.c b/drivers/input/serio/i8042.c
>>> index debe944..9c70d34 100644
>>> --- a/drivers/input/serio/i8042.c
>>> +++ b/drivers/input/serio/i8042.c
>>> @@ -371,7 +371,7 @@ static irqreturn_t i8042_interrupt(int i
>>>       if (unlikely(i8042_suppress_kbd_ack))
>>>           if (port_no == I8042_KBD_PORT_NO &&
>>>               (data == 0xfa || data == 0xfe)) {
>>> -            i8042_suppress_kbd_ack = 0;
>>> +            /* i8042_suppress_kbd_ack = 0; */
>>>               goto out;
>>
>> That would indicate that your keyboard generates multiple acks... I 
>> wonder
>> if you could boot with i8042.debug=1 and somehow capture the data flow
>> during panic (do you have a digital camera?).
> 
> Not even an analog camera, but with or without the above, I get a single:
> 
> " <7>drivers/input/serio/i8042.c: fa <- i8042 (interrupt, 0, 1) [ 902]"
> 
> when it panics. During a full boot, I get:
> 
> ===
[snip]
> ===
> 
> Rene.
> 
Dmitry, 
How about this output? (got this after a kernel panic)
====
drivers/input/serio/i8042.c: fa <- i8042 (interrupt, 0, 1) [35172]
drivers/input/serio/i8042.c: fa <- i8042 (interrupt, 0, 1) [35172]
atkbd.c: Spurious ACK on isa0060/serio0. Some program might be trying access hardware directly.
drivers/input/serio/i8042.c: fa <- i8042 (interrupt, 0, 1) [35296]
drivers/input/serio/i8042.c: fa <- i8042 (interrupt, 0, 1) [35297]
atkbd.c: Spurious ACK on isa0060/serio0. Some program might be trying access hardware directly.
drivers/input/serio/i8042.c: fa <- i8042 (interrupt, 0, 1) [35420]
drivers/input/serio/i8042.c: fa <- i8042 (interrupt, 0, 1) [35421]
atkbd.c: Spurious ACK on isa0060/serio0. Some program might be trying access hardware directly.
drivers/input/serio/i8042.c: fa <- i8042 (interrupt, 0, 1) [35544]
drivers/input/serio/i8042.c: fa <- i8042 (interrupt, 0, 1) [35545]
atkbd.c: Spurious ACK on isa0060/serio0. Some program might be trying access hardware directly.
===
~~
laurent
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.kernel.org
More majordomo info at  
http://vger.kernel.org/majordomo-info.html
Please read the FAQ at  
http://www.tux.org/lkml/