Date: Sun, 14 Mar 2004 14:30:51 +1100
From: Nick Piggin <>
Subject: Re: [RFC] kref, a tiny, sane, reference count object
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2004/3/13/157

Andrew Morton wrote:
>Greg KH <greg@kroah.com> wrote:
>
>>For all of those people, this patch is for you.
>>
>
>It does rather neatly capture a common idiom.
>
But as Andi said - look at all the crap involved when:
atomic_inc();
if (atomic_dec_and_test())
    release();
Also neatly captures that idiom.
And you get more flexibility by being able to use atomic_set
directly too.
But if you really like it, I agree it shouldn't allow NULL
pointers and probably get, put and cleanup should be inline.
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.kernel.org
More majordomo info at  
http://vger.kernel.org/majordomo-info.html
Please read the FAQ at  
http://www.tux.org/lkml/