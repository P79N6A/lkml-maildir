Date: Mon, 5 May 2008 13:02:34 +0100
From: Al Viro <>
Subject: Re: linux-2.6.25: 'mkdir -p' does not work with rootdir as mount point inside a read only filesystem
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2008/5/5/181

On Mon, May 05, 2008 at 09:38:57AM +0200, Lothar Wa?mann wrote:
> Hi,
> 
> Willy Tarreau writes:
> > > Interestingly your strace output showed a return value of EEXIST where
> > > mine had EROFS.
> > 
> > Oh you're right! I did not notice. There's something odd here.
> > And I can reproduce it right now (2.6.25.1). I really have
> > EEXIST.
> > 
> As I noted in my first message I have this problem with the kernel
> from git://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux-2.6
> which is currently 2.6.26-rc1 and still exhibits this behaviour.
> 
> So, this problem obviously does not exist in the 2.6.25 release kernel
> but would probably hit mainline in the 2.6.26 release.
Aye.  That's ro-bind fallout we'd not noticed; will fix...
And a fine example of the reasons why
	* relying on which particular errno value you get when several
are applicable is a Bad Idea(tm) and
	* changing the choice of the errno value in such situation might
be legal, but is to be done with care; sometimes it really has impact...