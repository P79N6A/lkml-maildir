Date: Thu, 18 Dec 2008 11:53:00 +0100
From: Ingo Molnar <>
Subject: Re: Pull request: merge-x86-12-16
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2008/12/18/96

* Mike Travis <travis@sgi.com> wrote:
> Hi Ingo,
> 
> Would you pull the following?
> 
> Thanks!
> Mike
> --- 
> The following changes since commit b77f911294aa099e53af754b9277b34783f629b4:
>   Rusty Russell (1):
>         x86: Introduce topology_core_cpumask()/topology_thread_cpumask()
> 
> are available in the git repository at:
> 
>   git://git.kernel.org/pub/scm/linux/kernel/git/travis/linux-2.6-cpus4096-for-ingo.git merge-x86-12-16
> 
> Mike Travis (2):
>       x86: fix cpu_mask_to_apicid_and to include cpu_online_mask
>       x86: use possible_cpus=NUM to extend the possible cpus allowed
> 
>  Documentation/cpu-hotplug.txt                 |   17 +++++-----
>  arch/x86/include/asm/bigsmp/apic.h            |    4 ++-
>  arch/x86/include/asm/es7000/apic.h            |   40 +++++++++++-------------
>  arch/x86/include/asm/mach-default/mach_apic.h |    3 +-
>  arch/x86/include/asm/summit/apic.h            |   30 ++++++++++--------
>  arch/x86/kernel/apic.c                        |   16 ++++++----
>  arch/x86/kernel/genapic_flat_64.c             |    4 ++-
>  arch/x86/kernel/genx2apic_cluster.c           |    4 ++-
>  arch/x86/kernel/genx2apic_phys.c              |    4 ++-
>  arch/x86/kernel/genx2apic_uv_x.c              |    4 ++-
>  arch/x86/kernel/smpboot.c                     |   25 +++++++++++++--
>  11 files changed, 92 insertions(+), 59 deletions(-)
pulled, thanks Travis!
Note, your patches from yesterday worked fine in -tip testing. There was 
one trivial build issue that needed to be addressed, see it below. (your 
change crossed with another change from the sparseirq tree - that is what 
caused this complication)
	Ingo
----------------->
From d733e00d7c10cc68333fbb88108bb15bb044f61b Mon Sep 17 00:00:00 2001
From: Ingo Molnar <mingo@elte.hu>
Date: Wed, 17 Dec 2008 13:35:51 +0100
Subject: [PATCH] x86: update io_apic.c to the new cpumask code
Impact: build fix
The sparseirq tree crossed with the cpumask changes, fix the fallout.
Signed-off-by: Ingo Molnar <mingo@elte.hu>
---
 arch/x86/kernel/io_apic.c |    5 +++--
 1 files changed, 3 insertions(+), 2 deletions(-)
diff --git a/arch/x86/kernel/io_apic.c b/arch/x86/kernel/io_apic.c
index 6bd51ce..58938cc 100644
--- a/arch/x86/kernel/io_apic.c
+++ b/arch/x86/kernel/io_apic.c
@@ -347,13 +347,14 @@ void arch_free_chip_data(struct irq_desc *old_desc, struct irq_desc *desc)
 	}
 }
 
-static void set_extra_move_desc(struct irq_desc *desc, cpumask_t mask)
+static void
+set_extra_move_desc(struct irq_desc *desc, const struct cpumask *mask)
 {
 	struct irq_cfg *cfg = desc->chip_data;
 
 	if (!cfg->move_in_progress) {
 		/* it means that domain is not changed */
-		if (!cpus_intersects(desc->affinity, mask))
+		if (!cpumask_intersects(&desc->affinity, mask))
 			cfg->move_desc_pending = 1;
 	}
 }