Date: 27 Mar 2000 04:14:09 -0000
From: Brian Warner <>
Subject: Re: trident.c vs. XMMS: 100% CPU usage
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2000/3/26/188

> Could you please try the driver on xmms 0.9.5 ?? xmms 1.0 seems have some
> problem with the driver. I don't know what's wrong but I am working hard
> to identify it.
0.9.5 acts normally (perhaps 0.3% CPU). 1.0.0 consumes 99%.
I'm looking at the diffs between Output/OSS/audio.c from 0.9.5 to 1.0.0, and
to be honest I can't figure out what's going on. My best guess at the relevant
changes:
 1.0.0 does a select() on the audio device, waiting for it to become writable.
 0.9.5 didn't.
 0.9.5 would poll for ioctl(SNDCTL_DSP_GETOSPACE) to report enough free space
 before doing a write(). 1.0.0 only does the ioctl() if we're using realtime
 priorities, so in general it just goes straight to the write().
I'll poke at it some more and see if maybe write() isn't blocking properly.
cheers,
 -Brian
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.rutgers.edu
Please read the FAQ at 
http://www.tux.org/lkml/