Date: Tue, 26 Aug 2003 16:38:50 +1200
From: Adam Warner <>
Subject: 2.4.22: ymfpci module segfaults
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2003/8/26/8

Hello LKML,
It is extremely likely that you missed this reported segmentation fault as
the original poster tried to inform the LKML via Google Groups:
<
http://groups.google.com/groups?selm=3084ded.0307120145.7977806a
%40posting.google.com>
2.4.22 has been a wonderful success--up to the point that my last box to
be upgraded hung when booting. I isolated it to the loading of the ymfpci
module. In a subsequent web search I was fortunate to come across the
above reply.
So I reverted the change:
--- drivers/sound/ymfpci.c.original     2003-08-26 15:41:11.000000000 +1200
+++ drivers/sound/ymfpci.c      2003-08-26 15:52:36.000000000 +1200
@@ -2472,7 +2472,7 @@
        }
 
        eid = ymfpci_codec_read(codec, AC97_EXTENDED_ID);
-       if (eid==0xFFFF) {
+       if (eid==0xFFFFFF) {
                printk(KERN_WARNING "ymfpci: no codec attached ?\n");
                goto out_kfree;
        }
Now I can load the ymfpci, soundcore and ac97_codec modules as before and
sound works fine. The kernel messages are:
ymfpci: YMF724F at 0xda000000 IRQ 19
ac97_codec: AC97 Audio codec, id: 0x8384:0x7605 (SigmaTel STAC9704)
lspci lists the sound card as:
00:09.0 Multimedia audio controller: Yamaha Corporation YMF-724F [DS-1Audio Controller] (rev 03)
I'd suggest Pete Zaitcev's advice is sound for 2.4:
<
http://groups.google.com/groups?selm=fa.mdqtrfv.j44t8t
%40ifi.uio.no>
"...for 2.4 I just removed the check. Consider that it was not working for
the whole life time of the driver, and not a single soul complained."
Regards,
Adam
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.kernel.org
More majordomo info at  
http://vger.kernel.org/majordomo-info.html
Please read the FAQ at  
http://www.tux.org/lkml/