Date: Wed, 8 Sep 2004 16:58:37 +0200
From: Andi Kleen <>
Subject: Re: [patch]   Re: [discuss] f_ops flag to speed up compatible ioctls in linux kernel
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2004/9/8/196

> So I wander what goes on here- the syscall returns a long but
> libc cuts the high 32 bit?
System calls are always long, otherwise the syscall exit code cannot
check properly for signal restarts. 
glibc seems to indeed truncate. 
> 
> Now that I think about it,for compat if you start returning 0 in low
> 32 bits you are unlike to get the effect you wanted ...
> The ioctl_native could be changed but that would make it impossible
> for compatible ioctls to just use the same pointer in both.
> 
> So what do you think - should I make just the native ioctl a long,
> or both, and document that the high 32 bit are cut in the compat call?
both + document. 
> 
> > The main thing missing is documentation. You need clear comments what
> > the locking rules are and what compat is good for.
> 
> Would these be best fit in the header file itself, or in a new
> Documentation/ file?
Header file should be enough.
> > And you should change the code style to follow Documentation/CodingStyle
> I'll go over it again. Something specific that I missed?
e.g. your use of white space.
-Andi
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.kernel.org
More majordomo info at  
http://vger.kernel.org/majordomo-info.html
Please read the FAQ at  
http://www.tux.org/lkml/