Date: Thu, 20 Dec 2001 09:40:25 -0800
From: William Lee Irwin III <>
Subject: Re: Poor performance during disk writes
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2001/12/20/125

On Thu, Dec 20, 2001 at 02:27:17PM +0100, Dieter N?tzel wrote:
> Amen..
> Sorry, Helge sure you are right in theory but try dbench 32 (maybe 
> bonnie/bonnie++) and playing an MP3/Ogg-Vorbis in parallel...
> That's my first test on any "new" kernel version.
> 
> Even with an 1 GHz Athlon II, 640 MB, U160 DDYS 18 GB, 10k IBM disk (on an 
> AHA-2940UW) it stutters like mad. I am running all my kernel _with_ Robert 
> Love's preempt + lock-break patches and it doesn't solve the problem.
> CPU load is (very) low but it do not work like it should.
I tried this on my 600MHz Athlon with 768MB of RAM and U160 DDYS 36GB
10Krpm IBM disk on a Adaptect 39160 I managed to get it not to stutter
at all. I was also using preempt + lockbreak and a few others. The
crucial patch appeared to be from Andrew Morton and it involved tuning
the elevator to avoid read starvation. A significantly helpful hardware
suggestion regarding the sound card and drivers came from Linus himself,
though.
Linus and others pointed out that applications are able to cause some
drivers to generate a large number of interrupts by using small buffers
and unfriendly ioctl's, especially esd. My workaround was to change out
sound hardware and disable esd. If this is happening to you, /proc/profile
should show handle_IRQ_event() and schedule() very high up. On the other
hand, this shows up as a steady drain on system resources and excessive
system time, not stuttering or skipping.
Andrew, I don't have the URL for that still floating around. Can you
point Dieter to it?
Cheers,
Bill
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.kernel.org
More majordomo info at  
http://vger.kernel.org/majordomo-info.html
Please read the FAQ at  
http://www.tux.org/lkml/