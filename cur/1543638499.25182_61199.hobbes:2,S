Date: Sat, 03 Aug 2002 19:16:18 +0100
From: Russell King <>
Subject: [PATCH] 8: 2.5.29-rd
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2002/8/3/12

This patch has been verified to apply cleanly to 2.5.30
This patch adds support for "initrd=start,size" on the kernel command
line.  This allows us (the ARM folk) to give details of the initrd
on the (default) command line rather than hard-coding such stuff
into the kernel proper.
 drivers/block/rd.c |   19 +++++++++++++++++++
 1 files changed, 19 insertions
diff -urN orig/drivers/block/rd.c linux/drivers/block/rd.c
--- orig/drivers/block/rd.c	Thu Jul 25 20:13:26 2002
+++ linux/drivers/block/rd.c	Fri Aug  2 17:34:53 2002
@@ -349,6 +349,25 @@
 	release:	initrd_release,
 };
 
+/*
+ * Add function to specify initrd address as initrd=start,size
+ *   start is a phyical address
+ *   size is the size of the initrd ramdisk
+ */
+
+static int __init setup_initrd(char *str)
+{
+	unsigned long start = memparse(str, &str);
+
+	if (str && *str == ',') {
+		initrd_start = (unsigned long)phys_to_virt(start);
+		initrd_end = initrd_start + memparse(str + 1, &str);
+	}
+	return 1;
+}
+
+__setup("initrd=", setup_initrd);
+
 #endif
 
 
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.kernel.org
More majordomo info at  
http://vger.kernel.org/majordomo-info.html
Please read the FAQ at  
http://www.tux.org/lkml/