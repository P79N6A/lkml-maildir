Date: Sun, 06 Feb 2005 04:25:42 +0000
From: Nuno Silva <>
Subject: Re: Drive performance bottleneck
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2005/2/5/222

Andrew Morton wrote:
> Lincoln Dale <ltd@cisco.com> wrote:
> 
>>sg_dd uses a window into a kernel DMA window.  as such, two of the four 
>>memory acccesses are cut out (1. DMA from HBA to RAM, 2. userspace 
>>accessing data).
>>1.6Gbps / 2 = 800MB/s -- or roughly what Ian was seeing with sg_dd.
> 
> 
> Right.  That's a fancy way of saying "cheating" ;)
> 
> But from the oprofile output it appears to me that there is plenty of CPU
> capacity left over.  Maybe I'm misreading it due to oprofile adding in the
> SMP factor (25% CPU on a 4-way means we've exhausted CPU capacity).
sg_dd is lying or /dev/sg* is broken. Try to do that sg_dd test in any 
single drive and you'll get 20 times the performance you're supposed to 
achieve:
puma:/tmp/dd# time sg_dd if=/dev/sg1 of=/dev/null bs=64k count=1000000 
time=1
Reducing read to 64 blocks per loop
time to transfer data was 69.784784 secs, 939.12 MB/sec
1000000+0 records in
1000000+0 records out
This is a single sata drive. I'm lucky, am I not?  ;-)
Regards,
Nuno Silva
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.kernel.org
More majordomo info at  
http://vger.kernel.org/majordomo-info.html
Please read the FAQ at  
http://www.tux.org/lkml/