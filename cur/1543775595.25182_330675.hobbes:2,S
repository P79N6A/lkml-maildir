Date: Sat, 02 Jul 2005 16:14:02 +0200
From: matthieu castet <>
Subject: ide-cd and bad sectors
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2005/7/2/44

Hi,
I use 2.6.12 vanilla kernel.
Since some time when a disk has bad sector because it is damaged or 
overburned, the Linux kernel seem too hang for this device :
the process reading is unkillable (even with SIGKILL).
the kernel seem to try to read the next sectors, but always failed.
The only way to stop the kernel trying to read the disc is to reboot or 
don't lock the drive and eject it, with the button on the device.
When hard-ejecting it, there are something strange in the log : the 
kernel failed for 508 sector (is there a so big cache for disk request ? 
If this is the case that explain why the kernel seem too hang as it need 
1-2s per bad sector).
Also at the end of the log [1] you could see that the 2 last message 
report error for the first sectors that produce the error. Is that 
normal : I thought this sector already produced an "media error (bad 
sector)" and should be skipped ?
Also I was wondering if all the sector that ide-cd failed to read are 
bad sector, or if ide-cd failed to put the drive in a consistent state 
for reading the next sector after corrupted one.
IIRC on 2.4 kernel there wasn't such problem, I even managed to recover 
some damaged disk...
thanks
Matthieu
[1]
Jul  2 15:10:13 localhost kernel: hdc: media error (bad sector): 
status=0x51 { D
riveReady SeekComplete Error }
Jul  2 15:10:13 localhost kernel: hdc: media error (bad sector): 
error=0x30 { La
stFailedSense=0x03 }
Jul  2 15:10:13 localhost kernel: ide: failed opcode was: unknown
Jul  2 15:10:13 localhost kernel: end_request: I/O error, dev hdc, 
sector 119095
12
Jul  2 15:10:13 localhost kernel: printk: 105 messages suppressed.
Jul  2 15:10:13 localhost kernel: Buffer I/O error on device hdc, 
logical block
2977378
Jul  2 15:10:17 localhost kernel: hdc: media error (bad sector): 
status=0x51 { D
riveReady SeekComplete Error }
Jul  2 15:10:17 localhost kernel: hdc: media error (bad sector): 
error=0x30 { La
stFailedSense=0x03 }
Jul  2 15:10:17 localhost kernel: ide: failed opcode was: unknown
Jul  2 15:10:17 localhost kernel: end_request: I/O error, dev hdc, 
sector 119095
16
[...]
Jul  2 15:12:03 localhost kernel: hdc: tray open
Jul  2 15:12:03 localhost kernel: end_request: I/O error, dev hdc, 
sector 119100
16
Jul  2 15:12:03 localhost kernel: hdc: tray open
Jul  2 15:12:03 localhost kernel: end_request: I/O error, dev hdc, 
sector 119100
20
Jul  2 15:12:03 localhost kernel: hdc: tray open
Jul  2 15:12:03 localhost kernel: end_request: I/O error, dev hdc, 
sector 119095
12
Jul  2 15:12:03 localhost kernel: hdc: tray open
Jul  2 15:12:03 localhost kernel: end_request: I/O error, dev hdc, 
sector 119095
16
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.kernel.org
More majordomo info at  
http://vger.kernel.org/majordomo-info.html
Please read the FAQ at  
http://www.tux.org/lkml/