Date: Wed, 26 May 1999 15:15:09 +0200
From: Thierry Danis <>
Subject: Bad NFS performance with client 2.2.9
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/1999/5/28/43

Hello,
Back again with my NFS testings.
I give a try to kernel 2.2.9 today to see how much improvement it brings.
The results against a 2.2.6-ac1 (or 2.2.9) knfsd 1.3 server are quite
bad (using iozone) :
> /mnt/tmp > ~/iozone/iozone-2.2.9 200 8192 zz
> 
>         IOZONE: Performance Test of Sequential File I/O  --  V2.01 (10/21/94)
>                 By Bill Norcott
> 
>         Operating System: POSIX 1003.1-1990
> 
>         Send comments to:       b_norcott@xway.com
> 
>         IOZONE writes a 200 Megabyte sequential file consisting of
>         25600 records which are each 8192 bytes in length.
>         It then reads the file.  It prints the bytes-per-second
>         rate at which the computer can read and write files.
> 
> 
> Writing the 200 Megabyte file, 'zz'...33.510000 seconds
> Reading the file...203.620000 seconds
> 
> IOZONE performance measurements:
>         6258287 bytes/second for writing the file
>         1029934 bytes/second for reading the file (2.2.9 client)
	  4298323 bytes/second for reading the file (2.2.6 client)
> /mnt/tmp > 
With 2.2.9 client, the load of the server climbs up to 3 during reading
(we have the same with many 2.2.6[-ac?] readers). It used to have a much more
reasonnable load with one 2.2.6 client (around 0,5) during reading.
One more thing : server 2.2.9 seems to give a boost to FreeBSD clients :
> /mnt/tmp > ~/iozone/iozone.freebsd 200 8192 zz
> 
>         IOZONE: Performance Test of Sequential File I/O  --  V2.01 (10/21/94)
>                 By Bill Norcott
> 
>         Operating System: POSIX 1003.1-1990
> 
>         Send comments to:       b_norcott@xway.com
> 
>         IOZONE writes a 200 Megabyte sequential file consisting of
>         25600 records which are each 8192 bytes in length.
>         It then reads the file.  It prints the bytes-per-second
>         rate at which the computer can read and write files.
> 
> 
> Writing the 200 Megabyte file, 'zz'...24.476562 seconds
> Reading the file...36.835938 seconds
> 
> IOZONE performance measurements:
>         8568000 bytes/second for writing the file
>         5693222 bytes/second for reading the file
> /mnt/tmp > 
I think it can be easily reproduced.
A+,
-- 
	Thierry Danis
	Poste : 53 53	danis@spmo.sagem.fr
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.rutgers.edu
Please read the FAQ at 
http://www.tux.org/lkml/