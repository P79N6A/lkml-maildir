Date: Sat, 7 Jan 2006 17:01:31 -0500
From: Chuck Ebbert <>
Subject: Re: 2.6.15-mm2
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2006/1/7/224

printk-levels-for-i386-oops-code.patch has two minor problems:
> @@ -178,14 +178,15 @@ void show_stack(struct task_struct *task
>         }
> 
>         stack = esp;
> +       printk(KERN_EMERG);
>         for(i = 0; i < kstack_depth_to_print; i++) {
>                 if (kstack_end(stack))
>                         break;
>                 if (i && ((i % 8) == 0))
> -                       printk("\n       ");
> +                       printk("\n       " KERN_EMERG);
Should be:
+                       printk("\n" KERN_EMERG "       ");
>                 printk("%08lx ", *stack++);
>         }
> -       printk("\nCall Trace:\n");
> +       printk("\n" KERN_EMERG "Call Trace:\n");
>         show_trace(task, esp);
>  }
And:
> @@ -236,17 +237,17 @@ void show_registers(struct pt_regs *regs
>         if (in_kernel) {
>                 u8 __user *eip;
> 
> -               printk("\nStack: ");
> +               printk("\n" KERN_EMERG "Stack: ");
>                 show_stack(NULL, (unsigned long*)esp);
> 
> -               printk("Code: ");
> +               printk(KERN_EMERG "Code: ");
> 
>                 eip = (u8 __user *)regs->eip - 43;
>                 for (i = 0; i < 64; i++, eip++) {
>                         unsigned char c;
> 
>                         if (eip < (u8 __user *)PAGE_OFFSET || __get_user(c, eip)) {
> -                               printk(" Bad EIP value.");
> +                               printk(KERN_EMERG " Bad EIP value.");
The above one-line change should not be made -- it's in the middle of a line.
>                                 break;
>                         }
>                         if (eip == (u8 __user *)regs->eip)
-- 
Chuck
Currently reading: _Sleepside: The Collected Fantasies Of Greg Bear_
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.kernel.org
More majordomo info at  
http://vger.kernel.org/majordomo-info.html
Please read the FAQ at  
http://www.tux.org/lkml/