Date: Thu, 27 Nov 2003 13:56:09 +0100
From: Jan Kara <>
Subject: Re: 2.4.23pre6aa3 - possible ext3 deadlock
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2003/11/27/59

  Hi,
> Followup to last test with 2.4.23pre6aa3. same config as before (ext3 
> /ql2300 / bonnie++) I forgot to mention that I have quotas enabled on 
> the partition under test.
> 
> There have been a few 2.4 / quota / ext3 deadlock-type  mails on the 
> list recently so I'm sot sure if this is related. I can see an atime 
> update in the call trace of one of the bonnies but no dquot_ calls 
> anywhere.  I haven't applied Jan's patch as it came out before I could 
> reliably reproduce this problem.
  Yes, actually there's still a deadlock there for ext3+quotas (patch is
already written but not yet included in mainline I think) but as I've
looked through the trace it doesn't seem to be the case. About a week
ago I saw a report on deadlock of 2.4.22 with just plain ext3 without
quotas - so can you try to reproduce the problem with quotas not
compiled into the kernel (or just turning them off should be enough)?
> In the meantime I'll restart testing with noatime - which is how I'd 
> usually mount such a fs anyhow.
> 
> The box seems to deadlock after 3-6 days of filesystem exercise. I have 
> repeated this 3 times. The last run was 6 days and and then I see all 
> disk I/O has ceased. The system remains pingable and sshd connects at 
> the TCP layer but nothing happens after that. The root filesystem is 
> ext3 but is a completely separate device (motherboard scsi) to the 
> filesystems running bonnie (external FC RAID). It seems that all 
> filesystem activity ceases.
> 
> I have run the alt-sysrq-t ouput through ksymoops and attached.  Hope 
> this is useful to someone who knows.
						Thanks for report
								Honza
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.kernel.org
More majordomo info at  
http://vger.kernel.org/majordomo-info.html
Please read the FAQ at  
http://www.tux.org/lkml/