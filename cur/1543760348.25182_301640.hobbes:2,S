Date: Thu, 10 Mar 2005 17:13:30 +0300
From: Leo Yuriev <>
Subject: Re[2]: [: [PATCH] ethernet-bridge: update skb->priority in case forwarded frame has VLAN-header]
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2005/3/10/100

>>From looking at the patch:
j> ------
j> +               /*
j> +                *   We map VLAN_TCI priority (0..7) to skb->priority (0..15)
j> +                *   most similarly e.g. 0->0, 1->1, .., 7->7
j> +                */
j> +               skb->priority = (vlan_TCI >> 13) & 7;
j> ------
j> This is wrong. IEEE priorities are opposite of IETF priorities (as used by
skb->>prio).
j> Unless you install a prio qdisc and rewrite the priomap, you are screwed.
j> So you should do opposite mapping, i.e something along the lines of
j> VLAN_TCI priority (0..7) to skb->priority (15..8) i,e skb->priority = 15 - vlan_TCI;
j> cheers,
j> jamal
Jamal, you are wrong!
802.1p defines priority as "linear" from 0 to 7,
the 0 is lowest priority and 7 is highest.
couple FoC links:
http://www.linktionary.com/q/qos.html
http://www.nwfusion.com/details/475.html
-- 
С уважением,
 Leo                          mailto:leo@yuriev.ru
-----BEGIN PGP PUBLIC KEY BLOCK-----
Version: 2.6
mQCPA0HMImkBbQEEALnWXpnchl1dHaCfwnXe2RO8ft9e7K5IGRW1lE9RERMy6R3L
JnMXMPiuWm/4tx6H/yTRUML8LbuACzf2Np9oHTxbDWxP40wGxQKrPDlzv/9gLEp6
ZwGF8mSfvZrPHux1LwIbryQxjlmwfNCkE+qiVOBWMsD7yAFCWrZztbWTWJ6pABEB
AAG0GkxlbyBZdXJpZXYgPGxlb0B5dXJpZXYucnU+iQCVAwUQQcwiabZztbWTWJ6p
AQG6cAP9H0O+MMa0WDlGE2JGG+SWuu9Iuqg76Hp6tjtrz2pLWEzbq8oqCkE0THff
/YUUaKqnrLELwEaptE+MrWSv9Zt1K/PauMpKUWXhlYqGcGB2NqJL69AONQte0M4B
rPSSts4CU7gK2Zuds1DOLiON7e9Sbpjc5T+4D7Jw5XGKMz66nhY=
=qGIk
-----END PGP PUBLIC KEY BLOCK-----
[unhandled content-type:application/pgp-signature]