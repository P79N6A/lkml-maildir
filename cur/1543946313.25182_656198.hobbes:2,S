Date: Tue, 19 Feb 2008 15:40:05 +0100
From: Ingo Molnar <>
Subject: Re: [patch] suspend/resume self-test
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2008/2/19/208

* David Brownell <david-b@pacbell.net> wrote:
> > And, at least to me, there seems to be a rather apparent correlation 
> > between "suspend/resume regressions caught as early as possible" and 
> > the future, desired state of: "STR working sanely on x86" ;-)
> 
> Thing is, this will catch not just regressions ... but cases where STR 
> never worked in the first place.  Video problems, etc.  Also various 
> system startup races, as in the PCMCIA and MMC/SD/SDIO cases I noted.
yes, but that's not your problem, that's the STR folks' problem.
> Right, and the best way to ensure that it's only *regressions* that 
> break things is to expect someone to have configured the kernel 
> command line appropriately (in grub or whatever).
a simple .config flag is perfectly fine for that, as long as it's 
default disabled and properly demarked. We have literally _dozens_ of 
"dangerous" test options and _nobody_ complains about them being 
dangerous ... They do their primary job of triggering bugs sooner, 
faster and harder, resulting in bugs getting fixed sooner, faster and 
harder.
> Another way to achieve that is to include the test code based on one 
> config option, and change the test *mode* based on another one.  That 
> way a distro could include that in standard kernels with "no test" 
> mode as the default, but it would be easy to enable only for oneshot 
> tests or field troubleshooting ... while developers could turn on the 
> more dangerous "always test STR" (or standby, or hibernate) mode, if 
> they were helping to find and fix problems surfaced by such tests.
no distro would enable this option, it just adds a needless 5-6 seconds 
delay to the bootup, and a needless "s2ram blows up sooner than it 
should" risk. _I_ want to enable this option, and want to see it trigger 
more often than just once out of a hundred randconfig setups.
really, you are making rookie mistakes in this area and you are doing 
injustice to the code you wrote and maintain :-) As i said it before, 
externally it looks like as if you intentionally avoided your code from 
being used, from people who _want_ to use your code. _I_ had to fight 
for almost an hour (!) until i figured out the zillions of .config 
variants that were finally able to get my test-system to boot-time 
suspend and resume all by itself. It's totally non-obvious. As far as 
the general Linux community goes, it's almost as if your code did not 
even exist, so well hidden and obscured it is.
	Ingo