Date: 17 Sep 2003 18:38:25 -0400
From: Trond Myklebust <>
Subject: Re: 2.4.20 NFS / EJUKEBOX problem
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2003/9/17/174

>>>>> " " == Paul N <Paul> writes:
     > Hi, I'm seeing a weird problem with NFSv3's EJUKEBOX when
     > mounting a irix machine running DMF (software for managing
     > offline/tape copies of files).  When an NFS read request is
     > made for an 'offline' file it causes other write requests to
     > stall until the 'offline' file is unmigrated to
     > disk and the read can resume. From looking at tcpdump it seems
     > that the write requests proceed until
     > an EJUKEBOX msg from the read is returned from the server.  At
     > that point all write requests are stuck behind the jukeboxed
     > read. Could someone please give me some information on this?
The writes are probably waiting in 'nfs_try_to_free_pages()' because
you are hitting the hard limit on outstanding read/write requests.
The NFS code is not allowed to allocate more than MAX_REQUEST_HARD
requests per mountpoint at any time since there is otherwise no way
for the VM to notify us in case of resource starvation.
Cheers,
  Trond
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.kernel.org
More majordomo info at  
http://vger.kernel.org/majordomo-info.html
Please read the FAQ at  
http://www.tux.org/lkml/