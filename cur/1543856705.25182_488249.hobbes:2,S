Date: Mon, 4 Dec 2006 12:17:26 -0800 (PST)
From: Christoph Lameter <>
Subject: Re: [PATCH] Add __GFP_MOVABLE for callers to flag allocations that may be migrated
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2006/12/4/293

On Mon, 4 Dec 2006, Andrew Morton wrote:
> > The multi zone approach does not work with NUMA. NUMA only supports a 
> > single zone for memory policy control etc.
> 
> Wot?  memory policies are a per-vma thing?
They only apply to "policy_zone" of a node. policy_zone can only take a 
single type of zone (has been like it forever). Multiple zones could 
become a nightmare with an exploding number of zones on zonelists. I.e. 
instead of 1k zones on a nodelist we now have 2k for two or even 4k if you 
want to have support for memory policies for 4 zones per node. We will 
then increase the search time through zonelists and have to manage all the 
memory in the different zones. Balancing is going to be difficult.
> I suspect you'll have to live with that.  I've yet to see a vaguely sane
> proposal to otherwise prevent unreclaimable, unmoveable kernel allocations
> from landing in a hot-unpluggable physical memory region.
Mel's approach already mananges memory in a chunks of MAX_ORDER. It is 
easy to just restrict the unmovable types of allocation to a section of 
the zone.
Then we should be doing some work to cut down the number of unmovable 
allocations.
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.kernel.org
More majordomo info at  
http://vger.kernel.org/majordomo-info.html
Please read the FAQ at  
http://www.tux.org/lkml/