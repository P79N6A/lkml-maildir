Date: Wed, 19 Mar 2008 14:25:04 -0300
From: Glauber de Oliveira Costa <>
Subject: [PATCH 09/79] [PATCH] call identify_secondary_cpu in smp_store_cpu_info
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2008/3/19/33

From: Glauber Costa <gcosta@redhat.com>
Call it conditionally for secondary cpus. This behaviour
matches i386
Signed-off-by: Glauber Costa <gcosta@redhat.com>
---
 arch/x86/kernel/smpboot_64.c |    3 ++-
 1 files changed, 2 insertions(+), 1 deletions(-)
diff --git a/arch/x86/kernel/smpboot_64.c b/arch/x86/kernel/smpboot_64.c
index 1da28c6..f84e30d 100644
--- a/arch/x86/kernel/smpboot_64.c
+++ b/arch/x86/kernel/smpboot_64.c
@@ -96,7 +96,8 @@ static void __cpuinit smp_store_cpu_info(int id)
 
 	*c = boot_cpu_data;
 	c->cpu_index = id;
-	identify_cpu(c);
+	if (id != 0)
+		identify_secondary_cpu(c);
 }
 
 static inline void wait_for_init_deassert(atomic_t *deassert)
-- 
1.5.0.6