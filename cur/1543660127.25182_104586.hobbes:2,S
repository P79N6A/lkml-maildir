Date: Sun, 19 Jan 2003 18:21:59 -0800
From: William Lee Irwin III <>
Subject: Re: setup_ioapic_ids_from_mpc()
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2003/1/19/149

At some point in the past, I wrote:
>> Use NUMA-Q specific MP OEM tables to program the physical APIC ID's of
>> the IO-APIC's. This fixes boot-time panic()'s on NUMA-Q's in the stock
>> version of setup_ioapic_ids_from_mpc().
On Sun, Jan 19, 2003 at 06:17:48PM -0800, Martin J. Bligh wrote:
> I think you can just skip this whole routine altogether on NUMA-Q,
> it's all pre-programmed for us by firmware. Much smaller patch ;-)
Don't touch IO-APIC physid's on NUMA-Q. The BIOS pre-programs them.
 io_apic.c |    6 +++++-
 1 files changed, 5 insertions(+), 1 deletion(-)
--- mm1-2.5.59/arch/i386/kernel/io_apic.c	2003-01-17 01:04:43.000000000 -0800
+++ mpc-2.5.59-1/arch/i386/kernel/io_apic.c	2003-01-19 18:19:13.000000000 -0800
@@ -1438,7 +1438,8 @@ void disable_IO_APIC(void)
  * by Matt Domsch <Matt_Domsch@dell.com>  Tue Dec 21 12:25:05 CST 1999
  */
 
-static void __init setup_ioapic_ids_from_mpc (void)
+#ifndef CONFIG_X86_NUMAQ
+static void __init setup_ioapic_ids_from_mpc(void)
 {
 	struct IO_APIC_reg_00 reg_00;
 	unsigned long phys_id_present_map;
@@ -1531,6 +1532,9 @@ static void __init setup_ioapic_ids_from
 			printk(" ok.\n");
 	}
 }
+#else
+static void __init setup_ioapic_ids_from_mpc(void) { }
+#endif
 
 /*
  * There is a nasty bug in some older SMP boards, their mptable lies
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.kernel.org
More majordomo info at  
http://vger.kernel.org/majordomo-info.html
Please read the FAQ at  
http://www.tux.org/lkml/