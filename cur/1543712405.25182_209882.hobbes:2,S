Date: Sun, 28 Mar 2004 18:36:23 +0100
From: Jamie Lokier <>
Subject: Re: [PATCH] speed up SATA
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2004/3/28/87

Jeff Garzik wrote:
> >Does TCQ-on-write allow you to do ordered write commits, as with barriers,
> >but without needing full cache flushes, and still get good performance?
> 
> Nope, TCQ is just a bunch of commands rather than one.  There are no 
> special barrier indicators you can pass down with a command.
I meant without barrier indicators (although that would've been nice).
This is what I mean: turn off write cacheing, and performance on PATA
drops because of the serialisation and lost inter-command time.
With TCQ-on-write, you can turn off write cacheing and in theory
performance doesn't have to drop, is that right?
In addition, you can implement ordered writes by waiting until
"before" writes in a partial order are completed prior to sending
"after" writes to the drive.  Meanwhile, because of the TCQ, other
read and write transactions can continue to take place, even if the
disk takes a long time to commit those writes that you're waiting on.
I'm wondering if that sort of strategy gives good performance with
TCQ-on-write drives, so that full-cache-flush barrier commands aren't
useful.
-- Jamie
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.kernel.org
More majordomo info at  
http://vger.kernel.org/majordomo-info.html
Please read the FAQ at  
http://www.tux.org/lkml/