Date: Wed, 25 Apr 2001 11:57:37 +0200
From: "Mulder, Tjeerd" <>
Subject: Re: Problem with DHCP when using tokenring on 2.4.x
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2001/4/25/139

The problem is probably caused by a change that was made around
kernel 2.3.29. The hardware type of a tokenring adapter was changed
from ARPHRD_IEEE802 to ARPHRD_IEEE802_TR. That breaks pump and the
ISC dhcp package. So pump from RH6.2 certainly won't work.
Fixing the ISC dhcp package is easy. Maybe it has been fixed
on the ISC site by now. Don't know about pump. 
Patch for the ISC package:
--- dhcp-3.0b2pl11/common/discover.c.org	Mon Jan  8 17:38:18 2001
+++ dhcp-3.0b2pl11/common/discover.c	Mon Jan  8 17:23:56 2001
@@ -407,7 +407,11 @@
 #ifndef HAVE_ARPHRD_IEEE802
 # define ARPHRD_IEEE802 HTYPE_IEEE802
 #endif
+#ifdef ARPHRD_IEEE802_TR
+		      case ARPHRD_IEEE802_TR:
+#else
 		      case ARPHRD_IEEE802:
+#endif
 			tmp -> hw_address.hlen = 7;
 			tmp -> hw_address.hbuf [0] = ARPHRD_IEEE802;
 			memcpy (&tmp -> hw_address.hbuf [1], sa.sa_data, 6);
--
======================================================================
Tjeerd Mulder                ! mailto:tjeerd.mulder@fujitsu-siemens.com
Fujitsu Siemens Computers    !
FSC PO PC RD MDE             !
Buergermeister Ulrichstr 100 ! Phone: +49 821 804 3549
86199 Augsburg               ! Fax  : +49 821 804 3934
======================================================================
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.kernel.org
More majordomo info at  
http://vger.kernel.org/majordomo-info.html
Please read the FAQ at  
http://www.tux.org/lkml/