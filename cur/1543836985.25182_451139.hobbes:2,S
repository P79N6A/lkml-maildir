Date: Tue, 8 Aug 2006 07:38:36 +0200
From: "Beschorner Daniel" <>
Subject: fctnl(F_SETSIG) no longer works in 2.6.17, does in 2.6.16.
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2006/8/8/18

>>> static void lease_release_private_callback(struct file_lock *fl) 
>>> { 
>>>         if (!fl->fl_file) 
>>>                 return; 
>>>         f_delown(fl->fl_file); 
>>> =>      fl->fl_file->f_owner.signum = 0; 
>>> } 
>> Why should the lease cleanup code be resetting f_owner.signum? That 
>> looks wrong. 
>> Stephen, I think this line of code predates the CITI changes. Do you 
>> know who added it and why? 
>Because when the original code was written, it was only called when we
got 
>a fcntl(F_SETLEASE, F_UNLCK) call.  The code got moved incorrectly and 
>noone noticed.
Does somebody have a patch for this issue? It breaks one important
application (Samba) in its default configuration.
Daniel
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.kernel.org
More majordomo info at  
http://vger.kernel.org/majordomo-info.html
Please read the FAQ at  
http://www.tux.org/lkml/