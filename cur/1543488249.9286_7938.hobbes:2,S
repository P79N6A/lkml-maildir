Date: Wed, 3 Mar 1999 08:46:10 -0500 (EST)
From: Alexander Viro <>
Subject: Re: [patch] af_unix fix for a panic a DoS and a memory leak [Re:
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/1999/3/3/52

	Folks, I tried to summarize those threads and here's the result:
1. garbage collector didn't notice that receive queues of still-not-accepted
	connections are worth scanning. That was fixed in 2.1.126. Fix broke
	the stack allocation code in GC. See panics observed by folks actively
	using AF_UNIX. That was fixed in my second patch.
2. There is a DoS (memory exhaustion) that had been fixed by Andrea's patch.
	Fix is not ideal and leaves open a related DoS with datagram sockets.
	Proper fixing involves too serious rewrite to do it in 2.2. Proposed
	variant (reap the unaccepted connection on close) leaves a nasty
	race to userland ;-/
3. BSD implementation suffers from the same problems (and from several problems
	we avoided).
4. On one of the boxen that used to panic combination of my patch to GC and
	Andrea's patch to connect() seems to solve the problem. Another one
	still demonstrates memory corruption with SMP enabled and works fine
	with SMP disabled, even with unpatched 2.2.2. It may be something
	we've missed, it may be an unrelated bug and it may be a faulty RAM.
5. Latest Andrea's patch includes both my fix to GC and his fix to connect().
	Missing part: SOCK_DGRAM-related DoS.
Question: Tomasz, are you running UP or SMP? 
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.rutgers.edu
Please read the FAQ at 
http://www.tux.org/lkml/