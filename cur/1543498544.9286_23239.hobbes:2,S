Date: Thu, 10 Jun 1999 09:37:41 -0400 (EDT)
From: Jeff Garzik <>
Subject: Re: [2.2.10pre3] fs/Config.in fix and cleanup
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/1999/6/10/81

On Thu, 10 Jun 1999, Andrzej Krzysztofowicz wrote:
> Hi
>   This part of your patch is incorrect:
> 
> > @@ -69,20 +69,20 @@
> >    fi
> >    if [ "$CONFIG_EXPERIMENTAL" = "y" ]; then
> >      tristate 'NFS server support' CONFIG_NFSD
> > -    if [ "$CONFIG_NFSD" != "n" ]; then
> > -      bool '   Emulate SUN NFS server' CONFIG_NFSD_SUN
> > -    fi
> > +  fi
> > +  if [ "$CONFIG_NFSD" != "n" ]; then
> > +    bool '   Emulate SUN NFS server' CONFIG_NFSD_SUN
> >    fi
> 
> Notice, that if CONFIG_EXPERIMENTAL is set to "n" the CONFIG_NFSD question
> does not appear. In effect you have CONFIG_NFSD not defined.
> It obviously means that $CONFIG_NFSD is not equal to "n".
> This part of your patch should be replaced by something like:
> 
> +  if [ "$CONFIG_NFSD" = "y" -o  "$CONFIG_NFSD" = "m" ]; then
> +    bool '   Emulate SUN NFS server' CONFIG_NFSD_SUN
The patch is reversed, which may lead to some of your confusion.
When the patch is correct (see below), it moves the question into the
CONFIG_EXPERIMENTAL scoping, satisfying the conditions necessary for the
'CONFIG_NFSD != "n"' test -- namely that CONFIG_NFSD must be defined.
I had already re-sent a better patch privately, but figured the
patch reversal would be obvious so didn't copy the update to the list.
	Jeff
Index: Config.in
===================================================================
RCS file: /usr/local/cvsroot/linux_2_2/fs/Config.in,v
retrieving revision 1.1.1.1
diff -u -r1.1.1.1 Config.in
--- Config.in	1999/05/15 01:22:31	1.1.1.1
+++ Config.in	1999/06/10 01:07:30
@@ -69,9 +69,9 @@
   fi
   if [ "$CONFIG_EXPERIMENTAL" = "y" ]; then
     tristate 'NFS server support' CONFIG_NFSD
-  fi
-  if [ "$CONFIG_NFSD" != "n" ]; then
-    bool '   Emulate SUN NFS server' CONFIG_NFSD_SUN
+    if [ "$CONFIG_NFSD" != "n" ]; then
+      bool '   Emulate SUN NFS server' CONFIG_NFSD_SUN
+    fi
   fi
   if [ "$CONFIG_NFS_FS" = "y" -o "$CONFIG_NFSD" = "y" ]; then
     define_bool CONFIG_SUNRPC y
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.rutgers.edu
Please read the FAQ at 
http://www.tux.org/lkml/