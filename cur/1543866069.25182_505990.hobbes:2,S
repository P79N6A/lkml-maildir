Date: Tue, 6 Feb 2007 19:57:57 -0800
From: Stephen Hemminger <>
Subject: Re: [PATCH] sky2: flow control off
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2007/2/6/481

On Tue, 06 Feb 2007 19:18:07 -0500
Jeff Garzik <jgarzik@pobox.com> wrote:
> Stephen Hemminger wrote:
> > Turn flow control off for sky2. When flow control is on, the transmitter
> > may get randomly stuck. Perhaps there is hardware problem, but until
> > Marvell provides errata information for workaround, it should default to off.
> > 
> > Signed-off-by: Stephen Hemminger <shemminger@linux-foundation.org>
> > ---
> >  drivers/net/sky2.c |    2 +-
> >  1 files changed, 1 insertions(+), 1 deletions(-)
> > 
> > diff --git a/drivers/net/sky2.c b/drivers/net/sky2.c
> > index 822dd0b..a31dea5 100644
> > --- a/drivers/net/sky2.c
> > +++ b/drivers/net/sky2.c
> > @@ -3263,7 +3263,7 @@ #endif
> > 
> >  	/* Auto speed and flow control */
> >  	sky2->autoneg = AUTONEG_ENABLE;
> > -	sky2->flow_mode = FC_BOTH;
> > +	sky2->flow_mode = FC_NONE;
> 
> I ACK the patch... conditional on some -mm style testing and user ACKs.
> 
> Logic:  if there were no downsides to disabling flow control globally, 
> the world's networks would have already done so.  Flow control can be 
> quite helpful, so I while I understand the errata argument, I also want 
> to understand the full effect of this tiny patch.
> 
Actually, the E1000 had it off until recently. The downside is that if 
a system is connected on a switch with a gigabit to 100mbit port
and using a stupid protocol like NFS over UDP, then the packet
burst is sure to get truncated so the 8K fragmented UDP
never gets through.
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.kernel.org
More majordomo info at  
http://vger.kernel.org/majordomo-info.html
Please read the FAQ at  
http://www.tux.org/lkml/