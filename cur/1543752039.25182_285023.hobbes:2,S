Date: Mon, 10 Jan 2005 12:12:33 -0800 (PST)
From: Michael Werner <>
Subject: [patch 2.6.10-mm2] agpgart: Add agp_find_bridge function
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2005/1/10/236

This patch gives non-generic platforms a method for using
platform specific agp_find_bridge functions.
Signed-off-by: Mike Werner <werner@sgi.com>
---
 drivers/char/agp/backend.c  |    5 ++++-
 include/linux/agp_backend.h |    2 ++
 2 files changed, 6 insertions(+), 1 deletion(-)
# This is a BitKeeper generated diff -Nru style patch.
#
#   Add agp_find_bridge
# 
diff -Nru a/drivers/char/agp/backend.c b/drivers/char/agp/backend.c
--- a/drivers/char/agp/backend.c	2005-01-10 09:21:20 -08:00
+++ b/drivers/char/agp/backend.c	2005-01-10 09:21:20 -08:00
@@ -50,6 +50,9 @@
 	.minor = AGPGART_VERSION_MINOR,
 };
 
+struct agp_bridge_data *(*agp_find_bridge)(struct pci_dev *) =
+	&agp_generic_find_bridge;
+
 struct agp_bridge_data *agp_bridge;
 LIST_HEAD(agp_bridges);
 EXPORT_SYMBOL(agp_bridge);
@@ -63,7 +66,7 @@
 {
 	struct agp_bridge_data *bridge;
 
-	bridge = agp_generic_find_bridge(pdev);
+	bridge = agp_find_bridge(pdev);
 
 	if (!bridge)
 		return NULL;
diff -Nru a/include/linux/agp_backend.h b/include/linux/agp_backend.h
--- a/include/linux/agp_backend.h	2005-01-10 09:21:20 -08:00
+++ b/include/linux/agp_backend.h	2005-01-10 09:21:20 -08:00
@@ -94,6 +94,8 @@
 extern struct agp_bridge_data *agp_bridge;
 extern struct list_head agp_bridges;
 
+extern struct agp_bridge_data *(*agp_find_bridge)(struct pci_dev *);
+
 extern void agp_free_memory(struct agp_memory *);
 extern struct agp_memory *agp_allocate_memory(struct agp_bridge_data *, size_t, u32);
 extern int agp_copy_info(struct agp_bridge_data *, struct agp_kern_info *);
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.kernel.org
More majordomo info at  
http://vger.kernel.org/majordomo-info.html
Please read the FAQ at  
http://www.tux.org/lkml/