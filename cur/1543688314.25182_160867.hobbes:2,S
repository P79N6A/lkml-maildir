Date: Thu, 28 Aug 2003 03:38:22 +0200
From: Dennis Jørgensen <>
Subject: [Patch] Wrong warning of invalid icmp to broadcast
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2003/8/27/240

Hello
On 2.6.0-test4 I see this warning in my logs:
192.38.215.157 sent an invalid ICMP type 11, code 0 error to a 
broadcast: 192.38.215.255 on eth0
The ip is wrong, since it's the ip of my own machine. The following 
patch fixes it (so the ip reported is the same as 2.4.20 reports).
If I should send this somewhere else, please tell me.
Regards
  Dennis Jørgensen
  I'm not on the list, please CC: me.
--- linux-2.6.0-test4.org/net/ipv4/icmp.c       2003-08-28 
01:13:59.000000000 +0200
+++ linux-2.6.0-test4/net/ipv4/icmp.c   2003-08-28 02:12:56.000000000 +0200
@@ -661,7 +661,7 @@
                        printk(KERN_WARNING "%u.%u.%u.%u sent an invalid 
ICMP "
                                            "type %u, code %u "
                                            "error to a broadcast: 
%u.%u.%u.%u on %s\n",
-                              NIPQUAD(iph->saddr),
+                              NIPQUAD(skb->nh.iph->saddr),
                               icmph->type, icmph->code,
                               NIPQUAD(iph->daddr),
                               skb->dev->name);
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.kernel.org
More majordomo info at  
http://vger.kernel.org/majordomo-info.html
Please read the FAQ at  
http://www.tux.org/lkml/