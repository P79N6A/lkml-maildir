Date: Sat, 11 Dec 2004 15:02:48 -0500
From: Jim Paris <>
Subject: Re: PCI IRQ problems -- update
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2004/12/11/81

> The PIIX should be in legacy mode by default in which case it would be
> on IRQ 14/15 only. Can you post boot messages ?
Sure.  This is with the PIIX interrupt rerouted to IRQ 5:
  
https://jim.sh/svn/jim/devl/toughbook/log/irq5
Portions of note:
Linux version 2.6.10-rc3 (jim@hypnosis) (gcc version 3.3.4 (Debian 1:3.3.4-13)) #6 Sat Dec 11 11:33:57 EST 2004
...
PCI: Probing PCI hardware (bus 00)
PCI: Ignoring BAR0-1 of IDE controller 0000:00:1f.1
...
Uniform Multi-Platform E-IDE driver Revision: 7.00alpha2
ide: Assuming 33MHz system bus speed for PIO modes; override with idebus=xx
ICH3M: IDE controller at PCI slot 0000:00:1f.1
PCI: Enabling device 0000:00:1f.1 (0005 -> 0007)
ACPI: PCI Interrupt Link [LNKC] enabled at IRQ 5
PCI: setting IRQ 5 as level-triggered
ACPI: PCI interrupt 0000:00:1f.1[A] -> GSI 5 (level, low) -> IRQ 5
ICH3M: chipset revision 2
ICH3M: not 100% native mode: will probe irqs later
    ide0: BM-DMA at 0x1840-0x1847, BIOS settings: hda:DMA, hdb:pio
Probing IDE interface ide0...
> > I'm not sure how to get to the root cause of the problem, though.  For
> > starters: where _should_ the INTA of the IDE card go, if anywhere?  If
> 
> Quite possibly nowhere. IDE controllers have two modes one in which they
> are normal PCI devices (and use INTA) and one in which they are "legacy"
> compatible and use IRQ14/15 directly so they work with pre-PCI operating
> systems.
OK, I see.  Does Linux leave it in legacy mode even when using a
specific driver like piix?  Do you know how I can get more information
on the state of it at boot, to see if BIOS did leave it in legacy
mode? 
-jim
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.kernel.org
More majordomo info at  
http://vger.kernel.org/majordomo-info.html
Please read the FAQ at  
http://www.tux.org/lkml/