Date: Thu, 15 Jan 2009 14:39:16 +0100
From: Ingo Molnar <>
Subject: Re: [patch] add optimized generic percpu accessors
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2009/1/15/263

* Ingo Molnar <mingo@elte.hu> wrote:
> FYI, -tip testing found the following bug with your percpu stuff:
> 
> There's an early exception during bootup, on 64-bit x86:
> 
>   PANIC: early exception 0e rip 10:ffffffff80276855: error ? cr2 6688
> 
>  - gcc version 4.3.2 20081007 (Red Hat 4.3.2-6) (GCC) 
>  - binutils-2.18.50.0.6-2.x86_64
> 
> config attached. You can find the disassembly of lock_release_holdtime() 
> below - that's where it crashed:
Gut feeling: we must have gotten a window where the PDA is not right. Note 
how it crashes in lock_release_holdtime() - that is CONFIG_LOCK_STAT 
instrumentation - very lowlevel and pervasive. Function tracing is also 
enabled although it should be inactive at the early stages.
So i'd take a good look at the PDA setup portion of the boot code, and see 
whether some spinlock acquire/release can slip in while the 
PDA/percpu-area is not reliable.
	Ingo