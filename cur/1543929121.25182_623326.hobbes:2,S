Date: Sat, 01 Dec 2007 13:13:46 -0700
From: (Eric W. Biederman)
Subject: Re: namespace support requires network modules to say "GPL"
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2007/12/1/102

Stephen Hemminger <shemminger@linux-foundation.org> writes:
> Actually, the whole mess would go away if the api for dev_get_by_XXXX hadn't
> been changed in the namespace transition. IMHO the interface to
> dev_get_by_name()
> should not have added a namespace parameter, of the callers in the tree, only
> two use a different namespace. So it would have been better to to introduce
> dev_get_by_name_ns() with the extra parameter.
As a general rule if you are calling dev_get_by_name and taking an &init_net
parameter that means you code has not yet been converted to actually support
network namespaces.
Not everything can be safely changed at once so we take it by steps.  When
the code fully supports network namespaces practically nothing will take
an &init_net parameter.  The network namespace parameter will come in
some form from userspace.  Either from current or from the network
socket.
Except for boot time initialization I don't know of any cases using
dev_get_by_XXXX that won't need to be modified before the network
namespace work is complete.
I believe I mentioned that this getting the fully network namespace
support was going to take a while and a bunch of patches at the
outset.
> Can we get this resolved before 2.6.24 is released? Going back and forth
> on API's is just needless frottage.
Sure.  We keep the updated dev_get_by_XXXX that takes a network
namespace parameter.
Or is their some legitimate usage of it by out of tree code that
I'm not aware of?
Eric