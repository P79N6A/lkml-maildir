Date: Fri, 27 Aug 1999 20:45:47 +0100
From: Simon Huggins <>
Subject: Oops 2.3.15 in piix_config_drive_for_dma
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/1999/8/27/114

I imagine this is cos I enabled CONFIG_BLK_DEV_PIIX_TUNING and I
shouldn't have but anyway just in case it isn't my fault...
This happened as I booted 2.3.15 (unsurprisingly it happened just after
hda: QUANTUM FIREBALL EL7.6A, ATA DISK drive
line of boot.
Attached is the output of ksymoops and cat /proc/pci
Here is (the hopefully relevant bit of) my normal boot messages in
2.2.12:
Aug 27 20:26:37 skinner kernel: PIIX3: IDE controller on PCI bus 00 dev 39
Aug 27 20:26:37 skinner kernel: PIIX3: not 100% native mode: will probe irqs later
Aug 27 20:26:37 skinner kernel:     ide0: BM-DMA at 0xffa0-0xffa7, BIOS settings: hda:pio, hdb:pio
Aug 27 20:26:37 skinner kernel:     ide1: BM-DMA at 0xffa8-0xffaf, BIOS settings: hdc:pio, hdd:pio
Aug 27 20:26:37 skinner kernel: hda: QUANTUM FIREBALL EL7.6A, ATA DISK drive
Aug 27 20:26:37 skinner kernel: hdb: non-IDE drive, CHS=621/128/63
Aug 27 20:26:37 skinner kernel: hdc: QUANTUM SIROCCO2550A, ATA DISK drive
Aug 27 20:26:37 skinner kernel: ide0 at 0x1f0-0x1f7,0x3f6 on irq 14
Aug 27 20:26:37 skinner kernel: ide1 at 0x170-0x177,0x376 on irq 15
Aug 27 20:26:37 skinner kernel: hda: QUANTUM FIREBALL EL7.6A, 7339MB w/418kB Cache, CHS=935/255/63, (U)DMA
Aug 27 20:26:37 skinner kernel: hdb: INVALID GEOMETRY: 128 PHYSICAL HEADS?
Aug 27 20:26:37 skinner kernel: hdc: QUANTUM SIROCCO2550A, 2445MB w/75kB Cache, CHS=4969/16/63, DMA
Aug 27 20:26:37 skinner kernel: Partition check:
Goes off to disable tuning and try again...
-- 
Simon                           oOoOo   "Hey, don't call my brother a   oOoOo
huggie@earth.li                  oOoOo         dildo!" - Kyle          oOoOo
http://ds.dial.pipex.com/huggie/
  oOoOo                               oOoOo
Warning (multi_opt): you specified both -m and -M.  Using '-m /usr/src/linux-2.3.15/System.map'
ksymoops 0.7 on i586 2.2.12.  Options used
     -V (specified)
     -K (specified)
     -L (specified)
     -o /lib/modules/2.3.15/ (specified)
     -m /usr/src/linux-2.3.15/System.map (specified)
No modules in ksyms, skipping objects
EIP:    0010:[<c018b9a5>]
Using defaults from ksymoops -t elf32-i386 -a i386
EFLAGS: 00010292
eax: 00000004   ebx: 00000002   ecx: 00000cf8   edx: 00000000
esi: c029d400   edi: c0224600   ebp: 00000000   esp: c009df4f
ds: 0018 es: 0018 ss: 0018
Stack: c01f2300 00009000 00000001 00000004 00000004 00000020 40083e00 00000000
       00000000 a3070000 c018bd58 c0224600 c0224600 c0189ee9 00000004 c0224600
       c0224600 00000001 c01f2300 c018e151 c0224600 c01f2300 00000001 c01f1680
Call trace: [<c018b58>] [<c0189ee9>] [<c018e151>] [<c0106097>] [<c0107758>]
Code: 66 83 ba b0 00 00 00 00 74 16 85 ed 74 12 0f bf 44 24 2a 85
>>EIP; c018b9a5 <piix_config_drive_for_dma+c9/468>   <=====
Trace; 0c018b58 Before first symbol
Trace; c0189ee9 <ide_register_subdriver+71/b4>
Trace; c018e151 <idedisk_init+15/a4>
Trace; c0106097 <init+7/110>
Trace; c0107758 <kernel_thread+28/38>
Code;  c018b9a5 <piix_config_drive_for_dma+c9/468>
00000000 <_EIP>:
Code;  c018b9a5 <piix_config_drive_for_dma+c9/468>   <=====
   0:   66 83 ba b0 00    cmpw   $0x0,0xb0(%edx)   <=====
Code;  c018b9aa <piix_config_drive_for_dma+ce/468>
   5:   00 00 00 
Code;  c018b9ad <piix_config_drive_for_dma+d1/468>
   8:   74 16             je     20 <_EIP+0x20> c018b9c5 <piix_config_drive_for_dma+e9/468>
Code;  c018b9af <piix_config_drive_for_dma+d3/468>
   a:   85 ed             testl  %ebp,%ebp
Code;  c018b9b1 <piix_config_drive_for_dma+d5/468>
   c:   74 12             je     20 <_EIP+0x20> c018b9c5 <piix_config_drive_for_dma+e9/468>
Code;  c018b9b3 <piix_config_drive_for_dma+d7/468>
   e:   0f bf 44 24 2a    movswl 0x2a(%esp,1),%eax
Code;  c018b9b8 <piix_config_drive_for_dma+dc/468>
  13:   85 00             testl  %eax,(%eax)
1 warning issued.  Results may not be reliable.
PCI devices found:
  Bus  0, device   0, function  0:
    Host bridge: Intel 82437VX Triton II (rev 1).
      Medium devsel.  Master Capable.  Latency=32.  
  Bus  0, device   7, function  0:
    ISA bridge: Intel 82371SB PIIX3 ISA (rev 0).
      Medium devsel.  Fast back-to-back capable.  Master Capable.  No bursts.  
  Bus  0, device   7, function  1:
    IDE interface: Intel 82371SB PIIX3 IDE (rev 0).
      Medium devsel.  Fast back-to-back capable.  Master Capable.  Latency=32.  
      I/O at 0xffa0 [0xffa1].
  Bus  0, device  13, function  0:
    SCSI storage controller: Adaptec AIC-7881U (rev 1).
      Medium devsel.  Fast back-to-back capable.  IRQ 9.  Master Capable.  Latency=72.  Min Gnt=8.Max Lat=8.
      I/O at 0xfc00 [0xfc01].
      Non-prefetchable 32 bit memory at 0xffbeb000 [0xffbeb000].
  Bus  0, device  14, function  0:
    VGA compatible controller: Matrox Millennium (rev 1).
      Medium devsel.  Fast back-to-back capable.  IRQ 11.  
      Non-prefetchable 32 bit memory at 0xffbec000 [0xffbec000].
      Prefetchable 32 bit memory at 0xff000000 [0xff000008].