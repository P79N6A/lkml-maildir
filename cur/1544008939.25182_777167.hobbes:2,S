Date: Fri, 5 Dec 2008 00:02:13 +0100
From: Luca Santarelli <>
Subject: [PATCH] bluetooth usb hci: ISSC usb dongle with buggy SCO support
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2008/12/4/399

From: Luca Santarelli <hrk <t> users.sourceforge.net>
As reported at:
http://bugs.gentoo.org/show_bug.cgi?id=249523
and in reference of similar patches such as:
http://thread.gmane.org/gmane.linux.bluez.devel/15067
This patch changes the blacklist entry for the ISSC bluetooth USB
dongle fixing the issue of the repeatedly appearing message
  hci_scodata_packet: hci0 SCO packet for unknown connection handle 92
in the kernel logs.
Sighed-off-by: Luca Santarelli <hrk <at> users.sourceforge.net>
---
This is my first kernel patch ever, I read the docs, but please notify
me if I made any mistake. Thank you all for your work, I'm happy to have
been able to contribute to this!
The patch has been run against 2.6.27.7 and has been tested on three x86
machines, showing no issues. In my own tests, the dongle has been then
used to connect to devices and everything worked fine.
--- linux-2.6.27.7/drivers/bluetooth/hci_usb.c.orig	2008-12-04 20:18:38.000000000 +0100
+++ linux-2.6.27.7/drivers/bluetooth/hci_usb.c	2008-12-04 20:19:37.000000000 +0100
@@ -148,8 +148,8 @@ static struct usb_device_id blacklist_id
 	{ USB_DEVICE(0x047d, 0x105d), .driver_info = HCI_RESET },
 	{ USB_DEVICE(0x047d, 0x105e), .driver_info = HCI_RESET | HCI_WRONG_SCO_MTU },
 
-	/* ISSC Bluetooth Adapter v3.1 */
-	{ USB_DEVICE(0x1131, 0x1001), .driver_info = HCI_RESET },
+	/* ISSC Bluetooth Adapter v3.1 with buggy SCO support */
+	{ USB_DEVICE(0x1131, 0x1001), .driver_info = HCI_RESET | HCI_BROKEN_ISOC },
 
 	/* RTX Telecom based adapters with buggy SCO support */
 	{ USB_DEVICE(0x0400, 0x0807), .driver_info = HCI_BROKEN_ISOC },