Date: Fri, 26 Jul 2002 07:33:59 +0200
From: Daniel Phillips <>
Subject: Re: Linux-2.4.18-rc3-ac3: bug with using whole disks as filesystems
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2002/7/26/9

On Thursday 25 July 2002 11:03, David Luyer wrote:
> Followup to my own post:
> > I attempted to mkfs and use a whole disk rather than a partition
> > with reiserfs.  It failed (not a major problem, I'll just make a
> > partition), but it failed with a "kernel BUG" message, so here 'tis.
It was this BUG no doubt (buffer.c):
2398         /* Size must be within 512 bytes and PAGE_SIZE */
2399         if (size < 512 || size > PAGE_SIZE)
2400                 BUG();
> > Original commands to cause failure:
> >   mkfs -b 8192 /dev/sdb -f
> >   mount /dev/sdb /cache
> 
> Actually looks like the -b 8192 was the problem, the same happened
> on /dev/sdb1.  Had to reboot again after that as mount was hanging
> in the same way as cfdisk had previously.  Similar 'kernel BUG'
> message resulted.
It's Reiserfs's fault all right, for not recognizing the fact that
the kernel can't handle blocksize larger than the hard PAGE_SIZE.
Good thing the BUG is there now, it used to fail silently.
There is no fundamental reason why we can't handled the larger
blocksizes.  It just didn't make it to the top of the list of things
to do for this cycle.  For now, all the mkfs's have to accomodate
this shortcoming.
-- 
Daniel
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.kernel.org
More majordomo info at  
http://vger.kernel.org/majordomo-info.html
Please read the FAQ at  
http://www.tux.org/lkml/