Date: Wed, 6 Nov 2002 14:02:22 +0200
From: Abraham vd Merwe <>
Subject: Re: A hole in kernel space!
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2002/11/6/57

Hi Pannaga!
Use the mem= parameter on the kernel command-line to specify less memory
than what is available. Then you can use the last unused chunk of memory,
e.g. if you have 256M memory and you want to "steal" a 40M chunk at the end:
mem=216M
> Hi all,
>         I am looking for a setup where I need to have a certain amount
> of data always available to the kernel. The size of data I am looking at
> is abt
> 40MB(preferably, but I will settle for 20MB too) . So the normal kmalloc
> will not help me. So what I did was, I created a hole in kernel space by
> putting
> the following line in vmlinux.lds
> 
>     ALIGN(4096);
>  __hole_start = .;
>     . = . + 0xmy_size;
>  __hole_end = .;
> 
> First, I put these lines in code segment and found that  'my_size'
> cannot go beyond 0x500000(5MB) . Any larger value , the kernel image
> refuses to
> boot up. I found the same problem with these lines being in data segment
> or in the bss segment.
> 
> But putting these line after
> 
> _end = .;
> 
> line in vmlinux.lds, I am able to give 0x1700000(17MB) to my_size and
> still boot with that kernel image.
> 
> My questions are :
> 
> 1.   Is there any other way I can get to keep 40MB(or even 20MB) of
> contiguous kernel memory space ?
> 
> 2.    Abt the 17MB hole, I am able to use after the   _end = .;
> ....     is this 17MB really there in kernel image?('cos it isn't in any
> segment and also it
> appears after _end).
>         if yes, are the pages corresponding to this region swappable or
> is it that since this hole appears in kernel image, it is locked to a
> physical space
> and this is never swapped. (basically, i want by data in kernel space
> always available to kernel without having to bother abt swapping the
> pages back)
> 
> Thanx in advance,
> Pannaga Bhushan
> 
> -
> To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
> the body of a message to majordomo@vger.kernel.org
> More majordomo info at  
http://vger.kernel.org/majordomo-info.html
> Please read the FAQ at  
http://www.tux.org/lkml/
-- 
Regards
 Abraham
UNIX enhancements aren't.
__________________________________________________________
 Abraham vd Merwe - 2d3D, Inc.
 Device Driver Development, Outsourcing, Embedded Systems
  Cell: +27 82 565 4451         Snailmail:
   Tel: +27 21 761 7549            Block C, Aintree Park
   Fax: +27 21 761 7648            Doncaster Road
 Email: abraham@2d3d.co.za         Kenilworth, 7700
  Http: 
http://www.2d3d.com
        South Africa
[unhandled content-type:application/pgp-signature]