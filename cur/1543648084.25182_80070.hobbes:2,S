Date: Tue, 15 Oct 2002 10:04:17 -0600
From: Andreas Dilger <>
Subject: Re: [PATCH 1/4] Add extended attributes to ext2/3
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2002/10/15/139

On Oct 15, 2002  16:31 +0100, Christoph Hellwig wrote:
> Patch 2: mbcache (all against 2.5.42-mm3):
> 
> --- linux-2.5.42-mm3-plain/fs/mbcache.c	Tue Oct 15 17:05:09 2002
> +++ linux-2.5.42-mm3/fs/mbcache.c	Tue Oct 15 17:26:53 2002
> @@ -247,20 +228,20 @@
>  	}
>  	while (nr_to_scan && !list_empty(&mb_cache_lru_list)) {
>  		struct mb_cache_entry *ce =
>  			list_entry(mb_cache_lru_list.prev,
>  				   struct mb_cache_entry, e_lru_list);
> @@ -382,20 +361,19 @@
>  	LIST_HEAD(free_list);
>  	struct list_head *l;
> 
> -	mb_cache_lock();
> +	spin_lock(&mb_cache_spinlock);
>  	l = mb_cache_lru_list.prev;
>  	while (l != &mb_cache_lru_list) {
>  		struct mb_cache_entry *ce =
>  			list_entry(l, struct mb_cache_entry, e_lru_list);
> @@ -420,15 +398,14 @@
>  	struct list_head *l;
>  	int n;
> 
> -	mb_cache_lock();
> +	spin_lock(&mb_cache_spinlock);
>  	l = mb_cache_lru_list.prev;
>  	while (l != &mb_cache_lru_list) {
>  		struct mb_cache_entry *ce =
>  			list_entry(l, struct mb_cache_entry, e_lru_list);
Couldn't these all be "list_for_each{_safe}"?
Cheers, Andreas
--
Andreas Dilger
http://www-mddsp.enel.ucalgary.ca/People/adilger/
http://sourceforge.net/projects/ext2resize/
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.kernel.org
More majordomo info at  
http://vger.kernel.org/majordomo-info.html
Please read the FAQ at  
http://www.tux.org/lkml/