Date: Thu, 8 Jan 2009 14:01:49 -0500
From: "Mike Frysinger" <>
Subject: Re: [PATCH 2/2] netdev: bfin_mac: enable VLAN support in Blackfin MAC driver
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2009/1/8/289

On Thu, Jan 8, 2009 at 13:55, David Miller <davem@davemloft.net> wrote:
> From: Bryan Wu <cooloney@kernel.org>
>> +#define VLAN_ETHER_TYPE 0x8100
>
> Please use ETH_P_8021Q from linux/if_ether.h instead of inventing
> your own definition.
was a copy & paste due to not finding a better definition (3c59x.c)
>> +     /* The legal length of the frame is increased to 1538 bytes */
>> +     /*bfin_write_EMAC_VLAN2(VLAN_ETHER_TYPE);*/
>
> Please do not add code that is just going to be commented
> out and not used.
>
> Also, I disagree with the:
>
> +#if defined(CONFIG_VLAN_8021Q) || defined(CONFIG_VLAN_8021Q_MODULE)
>
> conditional.  Probably this part of the chip should be programmed
> unconditionally.
again, more of a copy & paste ... this is how a bunch of drivers are
doing it now ...
> We can get VLAN packets received and sent, using AF_PACKET
> sockets, for example.  The chip should still respect those
> even if VLAN proper is not being utilized.
any tips on doing that ?
thanks for reviewing!
-mike