Date: Wed, 24 Mar 1999 12:04:33 +0100
From: Remco van de Meent <>
Subject: Re: Linux-2.2.4..
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/1999/3/24/39

Richard Gooch wrote:
> > cls_fw.c: In function `fw_dump':
> > cls_fw.c:306: structure has no member named `police'
> > make[3]: *** [cls_fw.o] Error 1
> 
> OK, write a patch, test it and send it to the list. Cc me and I'll add it
> to the kernel newsflash page. Also mention which config option is required
> to expose this problem.
Okay, the patch below seems to work fine and eliminates the problem as far
as I can see:
--- linux/net/sched/cls_fw.c.orig	Wed Mar 24 11:43:31 1999
+++ linux/net/sched/cls_fw.c	Wed Mar 24 11:45:18 1999
@@ -303,7 +303,11 @@
 
 	t->tcm_handle = f->id;
 
-	if (!f->res.classid && !f->police)
+	if (!f->res.classid 
+#ifdef CONFIG_NET_CLS_POLICE			
+	    && !f->police
+#endif
+	   )
 		return skb->len;
 
 	rta = (struct rtattr*)b;
You'll notice the problem when you enable these things...
  . Kernel/User netlink socket
  . Routing messages
  . Netlink device emulation
...but don't enable Ingres traffic policing.
I think someone else should try this out too, I'm not that experienced in
using the /dev/route device.
Regards,
 -Remco
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.rutgers.edu
Please read the FAQ at 
http://www.tux.org/lkml/