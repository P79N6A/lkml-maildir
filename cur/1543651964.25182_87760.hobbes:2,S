Date: Thu, 07 Nov 2002 09:16:50 -0500
From: Akira Tsukamoto <>
Subject: Re: [PATCH] 2.5.46 add original copy_ro/from_user for i386 and support PenPro PenII
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2002/11/7/87

On Tue, 05 Nov 2002 09:36:48 -0500
Akira Tsukamoto <at541@columbia.edu> mentioned:
> 
> This is revised version from my previous patch, adding original copy_user.
> 
> In addition, I changed one line in Kconfig, remove M585MMX and add M686
> because I run new copy-user on my PentiumMMX but had no improvement,
> however PenII/PenPro likely to have improvement from new copy_user function.
I gathered benchmark results for PentiumMMX. 
They confirm that my patch improves the speed.
I run the Taka's socket benchmark program on PentiumMMX with CONFIG-M586MMX.
http://www.suna-asobi.com/~akira-t/linux/cleanup-copy-user-1/netio586mmx.c
Without my patch on 2.5.46:
(off:0, size:0x100000) 
send/recv: copied 5.0 Mbytes in 0.381 seconds at 13.1 Mbytes/sec
(off:1, size:0x100000) 
send/recv: copied 5.0 Mbytes in 0.488 seconds at 10.2 Mbytes/sec
(off:2, size:0x100000) 
send/recv: copied 5.0 Mbytes in 0.493 seconds at 10.1 Mbytes/sec
(off:3, size:0x100000) 
send/recv: copied 5.0 Mbytes in 0.489 seconds at 10.2 Mbytes/sec
(off:4, size:0x100000) 
send/recv: copied 5.0 Mbytes in 0.381 seconds at 13.1 Mbytes/sec
(Entire log is here, 
http://www.suna-asobi.com/~akira-t/linux/cleanup-copy-user-1/586MMX-PenMMX-no-patch.log
)
With my patch on 2.5.46:
(off:0, size:0x100000) 
send/recv: copied 5.0 Mbytes in 0.380 seconds at 13.2 Mbytes/sec
(off:1, size:0x100000) 
send/recv: copied 5.0 Mbytes in 0.385 seconds at 13.0 Mbytes/sec
(off:2, size:0x100000) 
send/recv: copied 5.0 Mbytes in 0.385 seconds at 13.0 Mbytes/sec
(off:3, size:0x100000) 
send/recv: copied 5.0 Mbytes in 0.384 seconds at 13.0 Mbytes/sec
(off:4, size:0x100000) 
send/recv: copied 5.0 Mbytes in 0.381 seconds at 13.1 Mbytes/sec
(Entire log is here, 
http://www.suna-asobi.com/~akira-t/linux/cleanup-copy-user-1/586MMX-PenMMX-with-patch.log
)
I appreciate if somebody could try on 386 or 486.
I don't have them right now.
Cheers,
Akira 
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.kernel.org
More majordomo info at  
http://vger.kernel.org/majordomo-info.html
Please read the FAQ at  
http://www.tux.org/lkml/