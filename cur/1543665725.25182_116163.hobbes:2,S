Date: Mon, 10 Mar 2003 14:59:53 -0500
From: Chris Friesen <>
Subject: Re: [BK-2.5] Move "used FPU status" into new non-atomic thread_info->status field.
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2003/3/10/153

Linus Torvalds wrote:
> On Mon, 10 Mar 2003, David S. Miller wrote:
> 
>> 
>>At least on sparc{32,64}, we consider FPU state to be clobbered coming
>>into system calls, this eliminates a lot of hair wrt. FPU state
>>restoring in cases such as fork().
>>
> 
> We could _probably_ do it on x86 too. The standard C calling convention on 
> x86 says FPU register state is clobbered, if I remember correctly. 
> However, some of the state is "long-term", like rounding modes, exception 
> masking etc, and even if we didn't save the register state we would have 
> to save that part.
> 
> And once you save that part, you're better off saving the registers too, 
> since it's all loaded and saved with the same fxsave/fxrestor instruction 
> (ie we'd actually have to do _more_ work to save only part of the FP 
> state).
Does this open the door for using FP in the kernel?
Chris
-- 
Chris Friesen                    | MailStop: 043/33/F10
Nortel Networks                  | work: (613) 765-0557
3500 Carling Avenue              | fax:  (613) 765-2986
Nepean, ON K2H 8E9 Canada        | email: cfriesen@nortelnetworks.com
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.kernel.org
More majordomo info at  
http://vger.kernel.org/majordomo-info.html
Please read the FAQ at  
http://www.tux.org/lkml/