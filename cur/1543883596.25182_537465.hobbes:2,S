Date: Mon, 30 Apr 2007 11:32:38 +0100
From: Christoph Hellwig <>
Subject: Re: utrace comments
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2007/4/30/103

On Mon, Apr 30, 2007 at 10:45:10AM +0100, Russell King wrote:
> For the sake of avoiding too much rehash, here's Roland's reply to my
> initial forrey into utrace:
> 
> 
http://marc.info/?l=linux-kernel&m=117309251916053&w=2
In that mail Roland suggests keeping the singlestep code entirely
in the arm ptrace code.  After a brief look at the arm code this
looks easily possible.  From a brief look the arm software singlestep
consist of the following pieces:
 - PTRACE_SINGLESTEP implementation.  Sets the PT_SINGLESTEP flag,
   clears TIF_SYSCALL_TRACE, sets ->exit_code in the traced code
   to the singlestepping signal and wakes the traced process up.
   This can easily be implemented by putting alsmost equivalent code
   into arch_ptrace.
 - clearing PT_SINGLESTEP and cancelling the breakpoint in ptrace_disable.
   Equivalent code can go into tracehook_disable_single_step.
 - Various places in signal.c that check PT_SINGLESTEP to set/clear
   the special singlestep breakpoint.  This can stay, it just needs
   a different place to store the singlestep flag.
Do I miss something?
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.kernel.org
More majordomo info at  
http://vger.kernel.org/majordomo-info.html
Please read the FAQ at  
http://www.tux.org/lkml/