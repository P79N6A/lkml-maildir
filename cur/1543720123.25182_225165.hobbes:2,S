Date: Fri, 04 Jun 2004 17:34:41 +0100
From: Ian Abbott <>
Subject: Re: [PATCH] Memory leak in visor.c and ftdi_sio.c
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2004/6/4/159

On 04/06/2004 15:59, nardelli wrote:
> Note that I have not verified any of the below on
> hardware associated with drivers/usb/serial/ftdi_sio.c,
> only with drivers/usb/serial/visor.c.  If anyone has
> hardware for this device, I would appreciate your comments.
> 
> A memory leak occurs in both drivers/usb/serial/ftdi_sio.c
> and drivers/usb/serial/visor.c when the usb device is
> unplugged while data is being written to the device.  This
> patch should clear that up.
The change to ftdi_sio.c looks correct to me.
I made the original change to ftdi_sio.c to allocate the write urbs 
and their transfer buffers dynamically (instead of using a 
preallocated pool) and I copied that technique from visor.c!
A related problem with the current implementation is that is easy to 
run out of memory by running something similar to this:
  # cat /dev/zero > /dev/ttyUSB0
That affects both the ftdi_sio and visor drivers.
-- 
-=( Ian Abbott @ MEV Ltd.    E-mail: <abbotti@mev.co.uk>        )=-
-=( Tel: +44 (0)161 477 1898   FAX: +44 (0)161 718 3587         )=-
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.kernel.org
More majordomo info at  
http://vger.kernel.org/majordomo-info.html
Please read the FAQ at  
http://www.tux.org/lkml/