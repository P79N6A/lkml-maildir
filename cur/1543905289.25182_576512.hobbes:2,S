Date: Sun, 29 Jul 2007 23:44:51 +0200 (CEST)
From: Jan Engelhardt <>
Subject: Re: nvidia installer DIW with 2.6.23-rc1
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2007/7/29/298

On Jul 29 2007 14:12, Mike Houston wrote:
>I know it's off topic here, but this will help people.
>
>When that happens, check their forum. Chances are someone has
>posted, and the nvidia developers have answered with a patch, code
>snippet, quick instructions to get it to compile or advice to try a
>beta driver if applicable.
At least for solidarity for those stuck with it, patch below.
>To build nvidia kernel module failed in
>kernel-2.6.23-0.41.rc0.git14.fc8
>
http://www.nvnews.net/vbulletin/showthread.php?t=95296
	Jan
===
---
 nv-linux.h |    2 +-
 nv.c       |    6 ++----
 2 files changed, 3 insertions(+), 5 deletions(-)
Index: nv_kernel-100.14.11/nv-linux.h
===================================================================
--- nv_kernel-100.14.11.orig/nv-linux.h
+++ nv_kernel-100.14.11/nv-linux.h
@@ -533,7 +533,7 @@ static inline unsigned long nv_virt_to_p
 #define NV_KMEM_CACHE_CREATE(kmem_cache, name, type)            \
     {                                                           \
         kmem_cache = kmem_cache_create(name, sizeof(type),      \
-                        0, 0, NULL, NULL);                      \
+                        0, 0, NULL);                      \
     } 
 
 #define NV_KMEM_CACHE_DESTROY(kmem_cache)                       \
Index: nv_kernel-100.14.11/nv.c
===================================================================
--- nv_kernel-100.14.11.orig/nv.c
+++ nv_kernel-100.14.11/nv.c
@@ -1566,8 +1566,7 @@ failed:
         if (apm_nv_dev[i] != NULL) pm_unregister(apm_nv_dev[i]);
 #endif
 
-    if (unregister_chrdev(nv_major, "nvidia") < 0)
-        nv_printf(NV_DBG_ERRORS, "NVRM: unregister nv chrdev failed\n");
+    unregister_chrdev(nv_major, "nvidia");
 
     for (i = 0; i < num_nv_devices; i++)
     {
@@ -1598,8 +1597,7 @@ static void __exit nvidia_exit_module(vo
 
     nv_printf(NV_DBG_INFO, "NVRM: nvidia_exit_module\n");
 
-    if (unregister_chrdev(nv_major, "nvidia") < 0)
-        nv_printf(NV_DBG_ERRORS, "NVRM: unregister nv chrdev failed\n");
+    unregister_chrdev(nv_major, "nvidia");
 
     for (i = 0; i < num_nv_devices; i++)
     {
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.kernel.org
More majordomo info at  
http://vger.kernel.org/majordomo-info.html
Please read the FAQ at  
http://www.tux.org/lkml/