Date: Wed, 23 May 2007 14:38:40 -0400
From: Chuck Ebbert <>
Subject: Re: [BUG] local_softirq_pending storm
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2007/5/23/292

Chuck Ebbert wrote:
> 
> 
https://bugzilla.redhat.com/bugzilla/show_bug.cgi?id=240982
Another; these started to appear after the below patch was merged:
> Index: linux/kernel/sched.c
> > ===================================================================
> > --- linux.orig/kernel/sched.c
> > +++ linux/kernel/sched.c
> > @@ -4212,9 +4212,7 @@ int __sched cond_resched_softirq(void)
> >  	BUG_ON(!in_softirq());
> > 
> >  	if (need_resched() && system_state == SYSTEM_RUNNING) {
> > -		raw_local_irq_disable();
> > -		_local_bh_enable();
> > -		raw_local_irq_enable();
> > +		local_bh_enable();
> >  		__cond_resched();
> >  		local_bh_disable();
> >  		return 1;
May 23 19:26:26 localhost kernel: BUG: warning at kernel/softirq.c:138/local_bh_enable() (Not tainted)
May 23 19:26:26 localhost kernel:  [<c042b2ef>] local_bh_enable+0x45/0x92
May 23 19:26:26 localhost kernel:  [<c06036b7>] cond_resched_softirq+0x2c/0x42
May 23 19:26:26 localhost kernel:  [<c059d5d0>] release_sock+0x54/0xa3
May 23 19:26:26 localhost kernel:  [<c04373af>] prepare_to_wait+0x24/0x3f
May 23 19:26:26 localhost kernel:  [<c05e267f>] inet_stream_connect+0x116/0x1ff
May 23 19:26:26 localhost kernel:  [<c0437265>] autoremove_wake_function+0x0/0x35
May 23 19:26:26 localhost kernel:  [<c059c339>] sys_connect+0x82/0xad
May 23 19:26:26 localhost kernel:  [<c059d58f>] release_sock+0x13/0xa3
May 23 19:26:26 localhost kernel:  [<c0604ad5>] _spin_unlock_bh+0x5/0xd
May 23 19:26:26 localhost kernel:  [<c059e714>] sock_setsockopt+0x4a8/0x4b2
May 23 19:26:26 localhost kernel:  [<c059b6b6>] sock_attach_fd+0x70/0xd2
May 23 19:26:26 localhost kernel:  [<c04774a0>] get_empty_filp+0xfc/0x170
May 23 19:26:26 localhost kernel:  [<c059b54f>] sys_setsockopt+0x9b/0xa7
May 23 19:26:26 localhost kernel:  [<c059cb83>] sys_socketcall+0xac/0x261
May 23 19:26:26 localhost kernel:  [<c0404f70>] syscall_call+0x7/0xb
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.kernel.org
More majordomo info at  
http://vger.kernel.org/majordomo-info.html
Please read the FAQ at  
http://www.tux.org/lkml/