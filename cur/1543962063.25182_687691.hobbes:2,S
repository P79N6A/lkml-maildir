Date: Wed, 30 Apr 2008 21:32:59 -0700
From: Tim Pepper <>
Subject: Re: [PATCH 09/10] Integrate the ridr code into IPC code
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2008/5/1/12

On Tue 29 Apr at 16:33:13 +0200 Nadia.Derbey@bull.net said:
> [PATCH 09/10]
> 
> This patche makes the ipc ode use the ridr API.
Superfluous except...
> @@ -699,18 +695,13 @@ struct kern_ipc_perm *ipc_lock(struct ip
>  	struct kern_ipc_perm *out;
>  	int lid = ipcid_to_idx(id);
> 
> -	down_read(&ids->rw_mutex);
> -
>  	rcu_read_lock();
> -	out = idr_find(&ids->ipcs_idr, lid);
> +	out = ridr_find(&ids->ipcs_ridr, lid);
>  	if (out == NULL) {
>  		rcu_read_unlock();
> -		up_read(&ids->rw_mutex);
>  		return ERR_PTR(-EINVAL);
>  	}
> 
> -	up_read(&ids->rw_mutex);
> -
...the removal of the rw_mutex down/up_read().
-- 
Tim Pepper  <lnxninja@linux.vnet.ibm.com>
IBM Linux Technology Center