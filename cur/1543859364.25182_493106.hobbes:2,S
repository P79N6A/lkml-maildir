Date: Wed, 20 Dec 2006 01:11:35 -0800
From: "Yinghai Lu" <>
Subject: Re: [Bug 7505] Linux-2.6.18 fails to boot on AMD64 machine
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2006/12/20/30

On 12/19/06, Chuck Ebbert <76306.1226@compuserve.com> wrote:
> So an external interrupt occurred, the system tried to use interrupt
> descriptor #39 decimal (irq 7), but the descriptor was invalid.
but the irq is disabled at that time.
can you use attached diff to verify if the irq is enable somehow?
YH
diff --git a/arch/x86_64/kernel/i8259.c b/arch/x86_64/kernel/i8259.c
index d73c79e..fedde34 100644
--- a/arch/x86_64/kernel/i8259.c
+++ b/arch/x86_64/kernel/i8259.c
@@ -421,7 +421,11 @@ void __init init_ISA_irqs (void)
 {
 	int i;
 
+	if (!irqs_disabled())
+		printk("init_ISA_irqs(): -1  bug: interrupts were enabled early\n");
 	init_bsp_APIC();
+	if (!irqs_disabled())
+		printk("init_ISA_irqs(): -2  bug: interrupts were enabled early\n");
 	init_8259A(0);
 
 	for (i = 0; i < NR_IRQS; i++) {