Date: Tue, 05 Sep 2006 14:58:33 +0100
From: Steven Whitehouse <>
Subject: Re: [PATCH 10/16] GFS2: Logging and recovery
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2006/9/5/104

Hi,
On Mon, 2006-09-04 at 19:44 +0200, Jan Engelhardt wrote:
> >+		a = (old_tail <= ai->ai_first);
> >+		b = (ai->ai_first < new_tail);
> 
> >+	if (!(!error && dbn)) {
> >+		printk(KERN_INFO "error=%d, dbn=%llu lbn=%u", error, (unsigned long long)dbn, lbn);
> >+	}
> 
> error || dbn
> -{}
> 
ok. error || !dbn though
> >+#if 0
> >+	unsigned int d;
> >+
> >+	d = log_distance(sdp, sdp->sd_log_flush_head, sdp->sd_log_head);
> >+
> >+	gfs2_assert_withdraw(sdp, d + 1 == sdp->sd_log_blks_reserved);
> >+#endif
> 
now removed.
> >+		if (lb->lb_real) {
> >+			while (atomic_read(&bh->b_count) != 1)  /* Grrrr... */
> >+				schedule();
> 
> Grrr? Someone stole us the b_count?
> 
I guess. I think I'll add that to the list to look at more closely as
its not immediately clear to me when this might happen.
> >+	unsigned int offset = sizeof(struct gfs2_log_descriptor);
> >+	offset += (sizeof(__be64)-1);
> >+	offset &= ~(sizeof(__be64)-1);
> ()
> 
> 
> Jan Engelhardt
ok, plus one or two others I spotted at the same time:
http://www.kernel.org/git/?p=linux/kernel/git/steve/gfs2-2.6.git;a=commitdiff;h=a67cdbd4579c387c021a17c7447da8b88f2a94f4
Steve.
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.kernel.org
More majordomo info at  
http://vger.kernel.org/majordomo-info.html
Please read the FAQ at  
http://www.tux.org/lkml/