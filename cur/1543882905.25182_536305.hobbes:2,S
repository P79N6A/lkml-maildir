Date: Fri, 27 Apr 2007 14:37:26 -0700
From: Randy Dunlap <>
Subject: Re: [PATCH] Move LOG_BUF_SHIFT to a more sensible place
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2007/4/27/510

On Fri, 27 Apr 2007 20:53:32 +0100 Alistair John Strachan wrote:
> Several people have observed that perhaps LOG_BUF_SHIFT should be in a more 
> obvious place than under DEBUG_KERNEL. Under some circumstances (such as the 
> PARISC architecture), DEBUG_KERNEL can increase kernel size, which is an 
> undesirable trade off for something as trivial as increasing the kernel log 
> buffer size.
> 
> Instead, move LOG_BUF_SHIFT into "General Setup", so that people are more 
> likely to be able to change it such a circumstance that the default buffer 
> size is insufficient.
> 
> Signed-off-by: Alistair John Strachan <s0348365@sms.ed.ac.uk>
Acked-by: Randy Dunlap <randy.dunlap@oracle.com>
> ---
> 
> diff --git a/init/Kconfig b/init/Kconfig
> index b170aa1..cc9eb35 100644
> --- a/init/Kconfig
> +++ b/init/Kconfig
> @@ -262,6 +262,23 @@ config IKCONFIG_PROC
>  	  This option enables access to the kernel configuration file
>  	  through /proc/config.gz.
> 
> +config LOG_BUF_SHIFT
> +	int "Kernel log buffer size (16 => 64KB, 17 => 128KB)"
> +	range 12 21
> +	default 17 if S390 || LOCKDEP
> +	default 16 if X86_NUMAQ || IA64
> +	default 15 if SMP
> +	default 14
> +	help
> +	  Select kernel log buffer size as a power of 2.
> +	  Defaults and Examples:
> +	  	     17 => 128 KB for S/390
> +		     16 => 64 KB for x86 NUMAQ or IA-64
> +	             15 => 32 KB for SMP
> +	             14 => 16 KB for uniprocessor
> +		     13 =>  8 KB
> +		     12 =>  4 KB
> +
>  config CPUSETS
>  	bool "Cpuset support"
>  	depends on SMP
> diff --git a/lib/Kconfig.debug b/lib/Kconfig.debug
> index 3f3e740..de82401 100644
> --- a/lib/Kconfig.debug
> +++ b/lib/Kconfig.debug
> @@ -86,23 +86,6 @@ config DEBUG_SHIRQ
>  	  Drivers ought to be able to handle interrupts coming in at those
>  	  points; some don't and need to be caught.
> 
> -config LOG_BUF_SHIFT
> -	int "Kernel log buffer size (16 => 64KB, 17 => 128KB)" if DEBUG_KERNEL
> -	range 12 21
> -	default 17 if S390 || LOCKDEP
> -	default 16 if X86_NUMAQ || IA64
> -	default 15 if SMP
> -	default 14
> -	help
> -	  Select kernel log buffer size as a power of 2.
> -	  Defaults and Examples:
> -	  	     17 => 128 KB for S/390
> -		     16 => 64 KB for x86 NUMAQ or IA-64
> -	             15 => 32 KB for SMP
> -	             14 => 16 KB for uniprocessor
> -		     13 =>  8 KB
> -		     12 =>  4 KB
> -
>  config DETECT_SOFTLOCKUP
>  	bool "Detect Soft Lockups"
>  	depends on DEBUG_KERNEL && !S390
> 
> -- 
---
~Randy
*** Remember to use Documentation/SubmitChecklist when testing your code ***
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.kernel.org
More majordomo info at  
http://vger.kernel.org/majordomo-info.html
Please read the FAQ at  
http://www.tux.org/lkml/