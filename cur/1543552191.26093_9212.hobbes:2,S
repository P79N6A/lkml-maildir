Date: Sat, 21 Oct 2000 21:35:02 +0100 (BST)
From: Chris Evans <>
Subject: Re: [patch(?)] question wrt context switching during disk i/o
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2000/10/21/29

On Sat, 21 Oct 2000, Bill Wendling wrote:
> } > bdflush is broken in current kernels.  I posted to linux-mm about this,
> } > but Rik et al haven't shown any interest.  I normally see bursts of 
> } > up to around 40K cs/second when doing writes; I hacked a little 
> } > premption counter into the kernel and verified that they're practially
> } > all bdflush...
> } 
> There's some strangness in bdflush(). The comment says:
> 
>                 /*
>                  * If there are still a lot of dirty buffers around,
>                  * skip the sleep and flush some more. Otherwise, we
>                  * go to sleep waiting a wakeup.
>                  */
>                 if (!flushed || balance_dirty_state(NODEV) < 0) {
>                         run_task_queue(&tq_disk);
>                         schedule();
>                 }
Speaking of bdflush brokenness, I was trying to tune it using
/proc/sys/vm/bdflush. I was trying to eliminate the bursty write behaviour
Linux always seems to have had (exhibited by e.g. find /).
Unfortunately, different /proc/sys/vm/bdflush settings didn't seem to have
much (if any) effect. Is this another case of /proc/sys/vm/* settings
being ignored? If so they should be removed.
I was hoping to get a steady trickle of writes instead of the occasional
mammoth burst.
Cheers
Chris
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.kernel.org
Please read the FAQ at 
http://www.tux.org/lkml/