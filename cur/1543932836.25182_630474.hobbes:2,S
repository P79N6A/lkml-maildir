Date: Thu, 20 Dec 2007 16:19:55 +0100
From: Martin Schwidefsky <>
Subject: [patch 30/47] dasd: fix return value of dasd_generic_probe()
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2007/12/20/292

From: Stefan Haberland <stefan.haberland@de.ibm.com>
Using the return value of ccw_device_set_online as return value for 
dasd_generic_probe() causes the DASD to fail setting online
Signed-off-by: Stefan Haberland <stefan.haberland@de.ibm.com>
Signed-off-by: Martin Schwidefsky <schwidefsky@de.ibm.com>
---
 drivers/s390/block/dasd.c |    7 ++++---
 1 file changed, 4 insertions(+), 3 deletions(-)
Index: quilt-2.6/drivers/s390/block/dasd.c
===================================================================
--- quilt-2.6.orig/drivers/s390/block/dasd.c
+++ quilt-2.6/drivers/s390/block/dasd.c
@@ -1969,9 +1969,10 @@ dasd_generic_probe (struct ccw_device *c
 		ret = ccw_device_set_online(cdev);
 	if (ret)
 		printk(KERN_WARNING
-		       "dasd_generic_probe: could not initially online "
-		       "ccw-device %s\n", cdev->dev.bus_id);
-	return ret;
+		       "dasd_generic_probe: could not initially "
+		       "online ccw-device %s; return code: %d\n",
+		       cdev->dev.bus_id, ret);
+	return 0;
 }
 
 /*
-- 
blue skies,
   Martin.
"Reality continues to ruin my life." - Calvin.