Date: Mon, 13 Mar 2006 07:56:56 +0100
From: Jan Altenberg <>
Subject: [PATCH] 2.6.16-rc6-rt1: Fix redefinition and unknown symbol
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2006/3/13/18

Hi,
this patch should fix some simple issues with 2.6.16-rc6-rt1:
- Remove redefinition of rt_mutex_debug_check_no_locks_held
- Add EXPORT_SYMBOL for rt_read_lock and rt_rw_unlock
Signed-off-by: Jan Altenberg <tb10alj@tglx.de>
----------------------
--- linux-2.6.16-rc6-rt1/include/linux/rtmutex.h        2006-03-13 07:21:56.000000000 +0100
+++ linux-2.6.16-rc6-rt1-hacked/include/linux/rtmutex.h 2006-03-13 07:18:55.000000000 +0100
@@ -79,12 +79,10 @@ struct rt_mutex_waiter {
        , .name = #mutexname, .file = __FILE__, .line = __LINE__
 # define rt_mutex_init(mutex)                  __rt_mutex_init(mutex, __FUNCTION__)
  extern void rt_mutex_debug_task_free(struct task_struct *tsk);
- extern void rt_mutex_debug_check_no_locks_held(struct task_struct *tsk);
 #else
 # define __DEBUG_RT_MUTEX_INITIALIZER(mutexname)
 # define rt_mutex_init(mutex)                  __rt_mutex_init(mutex, NULL)
 # define rt_mutex_debug_task_free(t)                   do { } while (0)
-# define rt_mutex_debug_check_no_locks_held(tsk)       do { } while (0)
 #endif
 #define __RT_MUTEX_INITIALIZER(mutexname) \
diff -uprN -X linux-2.6.16-rc6-rt1/Documentation/dontdiff linux-2.6.16-rc6-rt1/kernel/rt.c linux-2.6.16-rc6-rt1-hacked/kernel/rt.c
--- linux-2.6.16-rc6-rt1/kernel/rt.c    2006-03-13 07:21:56.000000000 +0100
+++ linux-2.6.16-rc6-rt1-hacked/kernel/rt.c     2006-03-13 07:34:09.000000000 +0100
@@ -191,6 +191,7 @@ void __lockfunc rt_read_lock(rwlock_t *r
        _raw_spin_unlock_irqrestore(&rwsem->lock.wait_lock, flags);
        rt_rw_lock(rwsem __RET_IP__);
 }
+EXPORT_SYMBOL(rt_read_lock);
 static inline void rt_rw_unlock(struct rw_semaphore *rwsem __IP_DECL__)
 {
@@ -201,6 +202,7 @@ static inline void rt_rw_unlock(struct r
 */
        rt_unlock(&rwsem->lock);
 }
+EXPORT_SYMBOL(rt_rw_unlock);
 void __lockfunc rt_write_unlock(rwlock_t *rwlock)
 {
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.kernel.org
More majordomo info at  
http://vger.kernel.org/majordomo-info.html
Please read the FAQ at  
http://www.tux.org/lkml/