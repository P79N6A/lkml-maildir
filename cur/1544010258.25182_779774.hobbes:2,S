Date: Fri, 12 Dec 2008 00:36:50 -0500 (EST)
From: Len Brown <>
Subject: Re: [PATCH]  ACPI: Check _PSS invalidation when BIOS report _PSS with all 0x80000000
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2008/12/12/18

On Mon, 24 Nov 2008, Youquan,Song wrote:
> On Fri, Nov 21, 2008 at 03:08:39PM -0800, Andrew Morton wrote:
> > On Thu, 20 Nov 2008 19:08:36 -0800 (PST)
> > youquan_song@linux.intel.com wrote:
> > 
> > > Subject: Check _PSS invalidation when BIOS report _PSS with 0x80000000
> > > 
> > > When cpu frequencey scaling disable,some BIOS report _PSS with all
> > > 0x80000000.
> > > If kernel treat this case as valid, the kernel will boot crash when load
> > > cpufreq govenors.
> > > 
> > > So in order to cover more buggy BIOSs, the patch just check _PSS core
> > > frequencey invalidtion.
> > > 
> > 
> > It's unclear how many machines this will affect, and what the effects
> > of not having the patch are upon those machines.  That is useful
> > information for people who are deciding whcih kernel versions this
> > patch should be merged into.
> 
> I meet 2 machines that if the P-states is disabled in BIOS, the kernel
> will boot crash at loading cpufreq_userspace governor because kernel
> consider that P-states validate. I know there are some other machines
> also exist this bug.
What does _PPC say when P-states are disabled on these machines?
If it is disabling the _PSS, maybe we should not be looking at the _PSS?
This would be a good patch if 0x80000000 were actually documented
in the ACPI spec as disabling P-states, but it isn't.
Can you open a bugzilla and attach the acpidump output for
the two failing machines?  Are those machines shipped with
P-states enabled by default, or disabled by default?
Also, how, exactly, do we crash when we see these values?
> > Do you think this fix is needed in 2.6.28?  2.6.27.x?  2.6.26.x?  etc?
> > 
> 
> I know that the bug exists in kernel as old as 2.6.18 and also exits on
> 2.6.28, 2.6.27 etc. 
So we've been exposed to this BIOS bug for more than 10 releases
and the world has not ended.  Unless we're about to be exposed to
a raft of new machines with this BIOS issue, and they have P-states
disabled by default, I'd say this workaround in not urgent.
-- 
Len Brown, Intel Open Source Technology Center