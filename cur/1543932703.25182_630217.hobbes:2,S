Date: Thu, 20 Dec 2007 00:02:59 -0800
From: Greg KH <>
Subject: Re: [RFC] kobject/kset/ktype documentation and example code updated
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2007/12/20/35

On Thu, Dec 20, 2007 at 03:54:40PM +0800, Dave Young wrote:
> On Dec 20, 2007 8:30 AM, Greg KH <greg@kroah.com> wrote:
> > Thanks to everyone for your last round of review comments and changes to
> > the kobject documentation.
> >
> > I now have over 130 patches reworking the kset/ktype and kobject apis in
> > the kernel tree, and here is the updated documentation and example code
> > that shows how things work now.
> >
> > Things different from the last time around are the kobject_add() and
> > kobject_init() functions now take a bunch of required parameters, and
> > the kobject cleanup code is much more forgiving.
> >
> > I want to drop kobject_unregister() but as this patch series is so big
> > already, I think it's time to let it bake in -mm and push into 2.6.25
> > before attempting it.
> [--snip--]
> 
> Hi, greg
> 
> How about add a kobject_remove function and temporarily keep the
> kobject_unregister as below until the 2.6.25:
> 
> kobject_unregister(...)
> {
>        ...
>         kobject_remove();
>         kobject_uevent();
>         ...
> }
Actually, it's not needed at all.  Thanks to Kay's recent changes in the
tree, a simple kobject_put() is all that is needed.  The proper sysfs
cleanup and uevent will happen if necessary, no housekeeping by the
caller required.
So I'll just nuke kobject_unregister() as it's a simple replacement with
kobject_put() which will clean up the api even more :)
And I'll go update the documentation...
thanks,
greg k-h