Date: Tue, 27 Nov 2001 00:49:34 -0800 (PST)
From: Alex Davis <>
Subject: Re: 2.4.16 alsa 0.5.12 mixer ioctl problem
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2001/11/27/73

Yeah, they changed/broke (depending on your point of view) the file fs/proc/inode.c in the kernel
source.
You're the third person to post about this problem.
There's a work-around for the problem. (I'm currently running ALSA 0.9beta9, so the file contents
may not exactly match up): in the ALSA driver source, edit the file kernel/info.c. Look for the
following lines
if (p) {
	snd_info_device_entry_prepare(p,entry);
#ifdef LINUX_2_3
	p->proc_fops = &snd_fops;
#else
	p->ops = &snd_info_device_inode_operations;
#endif
	} else {
		up(&info_mutex);
		snd_info_free_entry(entry);
		return NULL;
	}
}
they should be near line 890 or so.
Next, comment out the line 
	p->proc_fops = &snd_fops;
Rebuild. Everything should work now.
Hope this helps.
-Alex
Alex Reisen wrote
Hi, all
just tried to compile the mentioned alsa drivers under 2.4.16. Mixer doesnt work, yes. It
compiles, installs, loads. And
any program trying to open mixer (through libasound) get EINVAL.
All is compiled with gcc-2.95.3,
single CPU, with APIC (is any sense to enable it on
uniprocessors?).
Does anybody know what to do about it?
-alex
__________________________________________________
Do You Yahoo!?
Yahoo! GeoCities - quick and easy web site hosting, just $8.95/month.
http://geocities.yahoo.com/ps/info1
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.kernel.org
More majordomo info at  
http://vger.kernel.org/majordomo-info.html
Please read the FAQ at  
http://www.tux.org/lkml/