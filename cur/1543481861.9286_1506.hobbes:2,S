Date: Sun, 24 Jan 1999 13:12:00 +0100 (MET)
From: Andrzej Krzysztofowicz <>
Subject: Re: pre9: PATCH for drivers/video/Config.in
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/1999/1/24/47

Hi,
   This patch is incorrect as CONFIG_PCI is an architecture dependent
option and for some architectures is not defined. You can't use
CONFIG_PCI if it is not associated with one ore more architecture checks
("$ARCH" = ...).
> I found this patch made "make xconfig" work for me w.r.t. "ATI Mach64
> display support" and "IGA 168x display support" (under "Console
> drivers").
> 
> It seems that make xconfig doesn't like the same option appearing
> several times.
> 
> But I didn't test what effect this patch has on make config and make
> menuconfig ...
> 
> 
> --- v2.2.0-pre9/linux/drivers/video/Config.in	Fri Jan 22 20:44:09 1999
> +++ linux/drivers/video/Config.in	Fri Jan 22 20:58:45 1999
[...]
> @@ -91,22 +88,20 @@
>        fi
>        bool '  Leo (ZX) support' CONFIG_FB_LEO
>      fi
> -  fi
> -  if [ "$ARCH" = "sparc" ]; then
>      if [ "$CONFIG_PCI" != "n" ]; then
>        bool 'PCI framebuffers' CONFIG_FB_PCI
You turned on the option above for *ALL* architectures which do not have
CONFIG_PCI defined as they do not have PCI bus at all (eg. Amigas)...
I believe it was not your intention...
>        if [ "$CONFIG_FB_PCI" != "n" ]; then
> -        bool '  IGA 168x display support' CONFIG_FB_IGA
> +	if [ "$ARCH" = "sparc" ]; then
> +	  bool '  IGA 168x display support' CONFIG_FB_IGA
> +        fi
>        fi
>      fi
>    fi
> -  if [ "$ARCH" = "sparc64" ]; then
> -    if [ "$CONFIG_PCI" != "n" ]; then
> -      bool 'PCI framebuffers' CONFIG_FB_PCI
> -      if [ "$CONFIG_FB_PCI" != "n" ]; then
> -        bool '  ATI Mach64 display support' CONFIG_FB_ATY
> -      fi
> -    fi
> +  if [ "$CONFIG_ATARI" = "y" -o \
> +       "$CONFIG_PPC" = "y" -a "$CONFIG_FB_OF" = "y" -o \
> +       "$CONFIG_EXPERIMENTAL" = "y" -a "$CONFIG_PCI" != "n" -o \
> +       "$ARCH" = "sparc64" -a "$CONFIG_PCI" != "n" -a "$CONFIG_FB_PCI" != "n" ]; then
> +    bool 'ATI Mach64 display support' CONFIG_FB_ATY
>    fi
>    tristate 'Virtual Frame Buffer support (ONLY FOR TESTING!)' CONFIG_FB_VIRTUAL
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.rutgers.edu
Please read the FAQ at 
http://www.tux.org/lkml/