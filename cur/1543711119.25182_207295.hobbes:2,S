Date: Thu, 18 Mar 2004 10:36:57 +1100
From: Anton Blanchard <>
Subject: Re: status of PREEMPT and SMP together?
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2004/3/17/161

> Hrm, I thought I sent Anton a patch to fix that.
Sorry, I had planned to send it once Linus got over his deep freeze mode
but forgot. Here it is.
Now that the option is selectable I marked it BROKEN for the moment
since we havent got around to doing the low level exception bits yet...
Do you have a G5 yet? :)
> The comment is out of date.  Technically speaking, the potential
> SMP+PREEMPT races exist on UP+PREEMPT, too.
> 
> Running SMP+PREEMPT on a 4-way here :-)
--
From: Robert Love <rml@ximian.com>
arch/ppc64/Kconfig's entry for CONFIG_PREEMPT is missing the description
after the "bool" statement, so the entry does not show up.
Also, the help description mentions a restriction that is not [any
longer] true.
===== arch/ppc64/Kconfig 1.50 vs edited =====
--- 1.50/arch/ppc64/Kconfig	Sun Mar  7 18:05:28 2004
+++ edited/arch/ppc64/Kconfig	Thu Mar 18 10:33:17 2004
@@ -174,14 +179,12 @@
 	depends on DISCONTIGMEM
 
 config PREEMPT
-	bool
+	bool "Preemptible Kernel"
+	depends on BROKEN
 	help
 	  This option reduces the latency of the kernel when reacting to
 	  real-time or interactive events by allowing a low priority process to
 	  be preempted even if it is in kernel mode executing a system call.
-	  Unfortunately the kernel code has some race conditions if both
-	  CONFIG_SMP and CONFIG_PREEMPT are enabled, so this option is
-	  currently disabled if you are building an SMP kernel.
 
 	  Say Y here if you are building a kernel for a desktop, embedded
 	  or real-time system.  Say N if you are unsure.
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.kernel.org
More majordomo info at  
http://vger.kernel.org/majordomo-info.html
Please read the FAQ at  
http://www.tux.org/lkml/