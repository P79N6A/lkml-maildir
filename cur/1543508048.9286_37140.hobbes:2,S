Date: Thu, 02 Sep 1999 21:51:01 -0700
From: Luke Miller <>
Subject: nfs locking problems under Redhat 6.0/ 2.2.11..
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/1999/9/2/211

I am using Redhat 6.0 with kernel version 2.2.11 with the knfsd-1.2.2-4
RPM installed and the knfs server compiled in to the kernel.  My goal is
to have this linux system server nfs for some other systems (mainly linux
and a Sunos and netbsd machine in the transition, however linux is the
most important). It has been working fairly good with the execption of nfs
locking.  
I want to nfs mount a mail spool directory as part of this.  The client I
am using is also another linux system, Redhat 6.0 running the default
2.2.5-15 kernel and with the knfsd-clients-1.2.2-4 RPM installed.  I
mount the mail spool and try to check mail with mh and get the following:
spock 133> inc
inc: unable to lock and fopen /var/spool/mail/millerlu
using pine I get:
[Can't open inbox (file /var/spool/mail/millerlu): not in valid mailbox format]
using elm I get:
spock 135> elm
Cannot flock folder "/var/spool/mail/millerlu"! [No locks available]
So, it is pretty clear there is a locking issue here.
Another thing I tried was to apply the following patches to a 2.2.11
kernel:
linux-2.2.7-sunrpc.patch
nfsd-2.2.7-2.lockd.patch
nfsd-2.2.7-3.patch
nfsd-2.2.7-nfsfh.patch
And compile and install the knfsd-1.4.7 user programs and try doing nfs
servering with that with the same resaults.  
Any ideas would be greatly apprecated.
Thanks,
Luke
      ***********************************************************
      *      Luke Miller              System Administrator      *
      *   millerlu@peak.org               541-754-7325          *
      ***********************************************************
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.rutgers.edu
Please read the FAQ at 
http://www.tux.org/lkml/