Date: Sat, 18 Mar 2000 11:40:54 +1300
From: Chris Wedgwood <>
Subject: Re: Linux Jobs: Update
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2000/3/18/117

On Fri, Mar 17, 2000 at 10:13:29AM -0800, David S. Miller wrote:
> Ok, the difference is that they are doing half as many memcpy's as
> us for large pipe writes.  This should make Linux push bulk pipe
> data as fast as FreeBSD.  Give it a try, let me know how things
> look now ok?
I'll let the results speak for themselves (remember, before this
patch linux was getting 107MB/s at most vs BSD's nearly double that):
FreeBSD-3.4:
------------
noc2% uname -r
3.4-STABLE
noc2% ./mhz
$Id: mhz.c,v 1.1 1994/11/18 08:51:55 lm Exp $
199.49 Mhz, 5 nanosec clock
noc2% ./mhz
$Id: mhz.c,v 1.1 1994/11/18 08:51:55 lm Exp $
199.51 Mhz, 5 nanosec clock
noc2% ./mhz
noc2% ./bw_pipe
$Id: bw_pipe.c,v 1.1 1994/11/18 08:49:48 lm Exp $
Pipe bandwidth: 202.34 MB/sec
noc2% ./bw_pipe
$Id: bw_pipe.c,v 1.1 1994/11/18 08:49:48 lm Exp $
Pipe bandwidth: 201.28 MB/sec
noc2% ./bw_pipe
$Id: bw_pipe.c,v 1.1 1994/11/18 08:49:48 lm Exp $
Pipe bandwidth: 201.23 MB/sec
Linux-2.3.99-pre2-3-cw1:
-----------------------
[cw:2] metastasis:~/wk/lmbench/bin/linux$ uname -r
2.3.99-pre2-cw1
$Id: mhz.c,v 1.1 1994/11/18 08:51:55 lm Exp $
199.94 Mhz, 5 nanosec clock
[cw:2] metastasis:~/wk/lmbench/bin/linux$ ./mhz
$Id: mhz.c,v 1.1 1994/11/18 08:51:55 lm Exp $
199.95 Mhz, 5 nanosec clock
$Id: bw_pipe.c,v 1.1 1994/11/18 08:49:48 lm Exp cw $
Pipe bandwidth: 267.82 MB/sec
[cw:2] metastasis:~/wk/lmbench/bin/linux$ ./bw_pipe
$Id: bw_pipe.c,v 1.1 1994/11/18 08:49:48 lm Exp cw $
Pipe bandwidth: 267.93 MB/sec
[cw:2] metastasis:~/wk/lmbench/bin/linux$ ./bw_pipe
$Id: bw_pipe.c,v 1.1 1994/11/18 08:49:48 lm Exp cw $
Pipe bandwidth: 268.18 MB/sec
[cw:2] metastasis:~/wk/lmbench/bin/linux$ ./bw_pipe
Freeeeooooowwww!
I must say Dave, when I saw your patch I though it would help but I
didn't expect a better than 2x increase. Impressive[1].
I'd still like to try page colouring for the funny memcpy results I
was getting if someone has (even very old) patches to implement this.
-cw
[1] Done in my best 'q3 voice'.
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.rutgers.edu
Please read the FAQ at 
http://www.tux.org/lkml/