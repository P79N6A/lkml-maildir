Date: Fri, 31 Jan 2003 17:11:02 +0100
From: Andrea Arcangeli <>
Subject: Re: 2.4.21pre4aa1
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2003/1/31/81

On Fri, Jan 31, 2003 at 10:56:43AM +0000, Christoph Hellwig wrote:
> On Fri, Jan 31, 2003 at 02:40:20AM +0100, Andrea Arcangeli wrote:
> > Only in 2.4.21pre3aa1: 00_getcwd-err-1
> > Only in 2.4.21pre4aa1: 00_getcwd-err-2
> > 
> > 	Part of it merged in mainline.
> 
> A different, cleaner version has been merged in mainline.  00_getcwd-err-2
> just adds unreachable code.
Ok agreed, it's a noop, I'll drop it. It won't hurt in the meantime.
> 
> > Only in 2.4.21pre4aa1: 9996_kiobuf-slab-1
> > 
> > 	Keep the kiobuf + bhs cache in the slab rather than in the file
> > 	structure, so it scales also while sharing the same file from two
> > 	different filedescriptors at the same time (like with threads or
> > 	after forks). From Jun Nakajima.
> 
> The patch is ugly as hell.  I'll dig up the patch I did with similar
I don't think it's so ugly, infact it's very clever compared to the
previous code, the big hit for the kiobuf is the bh allocation and this
solves it moving the bh into the slab too.
> functionality but a much nicer style and a sysctl-controllable cut-off
sysctl-controllable? I don't like it. This one should perform well
always.
> point for keeping the bhs around in the constructed kiobuf objects.
Feel free to provide a replacement but I don't see how you can make it
that much better as you claim.
The only unclean bit is the initialized field probably, but that's not a
significant cost and it's probably the simpler way to deal with the
ctor failures.
Andrea
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.kernel.org
More majordomo info at  
http://vger.kernel.org/majordomo-info.html
Please read the FAQ at  
http://www.tux.org/lkml/