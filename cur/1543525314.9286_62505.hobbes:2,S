Date: Thu, 10 Feb 2000 19:44:05 -0500
From: Simon Kirby <>
Subject: [Oops] proftpd/sys_sendfile in 2.3.43 final
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2000/2/11/65

2.3.43 final Oopses when proftpd starts at bootup on my system.  pre8 did
not do this.  Oops as follows:
Unable to handle kernel NULL pointer dereference at virtual address 00000004
c012e6d4
*pde = 00000000
Oops: 0000
CPU:    1
EIP:    0010:[<c012e6d4>]
Using defaults from ksymoops -t elf32-i386 -a i386
EFLAGS: 00010282
eax: c7f851e0   ebx: c782c1c0   ecx: c7fe66e0   edx: 00000000
esi: ffffffea   edi: c7f832c0   ebp: c75de000   esp: c75dff8c
ds: 0018   es: 0018   ss: 0018
Process proftpd (pid: 225, stackpage=c75df000)
Stack: c75de000 00000000 0000005a bffffccc c7f6f260 c782c2e4 c7f832c0 08093000
       00001000 c75de000 08094000 c010c075 c75dffc4 c010bf4c 00000001 00000000
       00000000 00000000 0000005a bffffccc 000000bb 0000002b 0000002b 000000bb
Call Trace: [<c010c075>] [<c010bf4c>]
Code: 83 7a 04 00 0f 84 19 02 00 00 8b 54 24 18 8b 5a 1c 8b 72 20
>>EIP; c012e6d4 <sys_sendfile+a8/300>   <=====
Trace; c010c075 <error_code+2d/38>
Trace; c010bf4c <system_call+34/38>
Code;  c012e6d4 <sys_sendfile+a8/300>
00000000 <_EIP>:
Code;  c012e6d4 <sys_sendfile+a8/300>   <=====
   0:   83 7a 04 00               cmpl   $0x0,0x4(%edx)   <=====
Code;  c012e6d8 <sys_sendfile+ac/300>
   4:   0f 84 19 02 00 00         je     223 <_EIP+0x223> c012e8f7 <sys_sendfile+2cb/300>
Code;  c012e6de <sys_sendfile+b2/300>
   a:   8b 54 24 18               mov    0x18(%esp,1),%edx
Code;  c012e6e2 <sys_sendfile+b6/300>
   e:   8b 5a 1c                  mov    0x1c(%edx),%ebx
Code;  c012e6e5 <sys_sendfile+b9/300>
  11:   8b 72 20                  mov    0x20(%edx),%esi
I'm guessing this is probably a result of or related to the following
change in the diff between pre8 and 2.3.37:
@@ -1233,7 +1235,7 @@
 	in_inode = in_file->f_dentry->d_inode;
 	if (!in_inode)
 		goto fput_in;
-	if (!in_inode->i_op || !in_inode->i_op->readpage)
+	if (!in_inode->i_mapping->a_ops->readpage)
 		goto fput_in;
 	retval = locks_verify_area(FLOCK_VERIFY_READ, in_inode, in_file, in_file->f_pos, count);
 	if (retval)
Not sure how to fix it, but it's probably something silly/simple.
The "NETDEV WATCHDOG: eth0: transmit timed out" eepro100 problem I
reported before also still exists...it can be reproduced quite easily by
starting a ping flood ("ping -s 3000 -f foo") and waiting a second or so
for it to occur.
Simon-
[  Stormix Technologies Inc.  ][  NetNation Communcations Inc.  ]
[       sim@stormix.com       ][       sim@netnation.com        ]
[ Opinions expressed are not necessarily those of my employers. ]
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.rutgers.edu
Please read the FAQ at 
http://www.tux.org/lkml/