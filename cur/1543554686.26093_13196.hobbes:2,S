Date: Wed, 15 Nov 2000 19:04:13 -0200 (BRDT)
From: Rik van Riel <>
Subject: Re: shm swapping in 2.4 again
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2000/11/15/59

On 15 Nov 2000, Christoph Rohland wrote:
> On Wed, 15 Nov 2000, Rik van Riel wrote:
> > On 15 Nov 2000, Christoph Rohland wrote:
> >> 2) Integrating it into the global lru lists and/or the page cache. 
> >> 
> >> I think the second approach is the way to go but I do not
> >> understand the global lru list handling enough to do this and I
> >> do not know if we can do this in the short time.
> > 
> > Indeed, this is the way to go. However, for 2.4 ANY change
> > that makes the system work would be a good one ;)
> 
> That's what I think. But from my observations I get the impression
> that balancing the vm for big shm loads will not work. So the second
> approach is perhaps what we have to do to get it working.
> 
> Actually I would appreciate some hints, where I could hook into
> the vm if I implement a swap_shm_page() which could be called
> from the vm. Can I simply call add_to_lru_cache or do I need to
> add it to the page cache...
You really want to have it in the swap cache, so we have
a place for it allocated in cache, etc...
Basically, when we unmap it in try_to_swap_out(), we
should add the page to the swap cache, and when the
last user stops using the page, we should push the
page out to swap.
[I'll code up the same thing for normal swap pages]
regards,
Rik
--
"What you're running that piece of shit Gnome?!?!"
       -- Miguel de Icaza, UKUUG 2000
http://www.conectiva.com/
		
http://www.surriel.com/
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.kernel.org
Please read the FAQ at 
http://www.tux.org/lkml/