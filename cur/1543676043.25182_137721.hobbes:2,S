Date: Tue, 03 Jun 2003 18:29:19 -0600
From: Lou Langholtz <>
Subject: Re: 2.5.70 add_disk(disk) re-registering disk->queue->elevator.kobj (bug?!)
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2003/6/3/275

Andrew Morton wrote:
>Lou Langholtz <ldl@aros.net> wrote:
> 
>
>>Or perhaps the block 
>>handling logic was changed such that disks don't share the same 
>>request_queue anymore. If so, then a few drivers (like nbd) need to be 
>>updated to use a seperate request_queue per disk.
>> 
>>
>
>The ramdisk driver was recently changed to do exactly this.  From what
>you say it appears that nbd needs the same treatment.
> 
>
I noticed that too but thought surely that couldn't be why the rd driver 
was changes. Cause... then it would seem via 'grep blk_init_queue 
drivers/block/*.c' that most of the block drivers need to be changed. 
And having a request_queue structure for every disk that's often (in 
these drivers) every minor device, seems like a lot of unneeded memory 
usage too. I'm afraid to ask this, but are you sure that each disk 
really is supposed to have its own request queue now? That seems less 
sensible than inverting the kobject parenting logic so that the 
request_queue.elevator kobject is the parent of the disk kobject. After 
all, makes more sense for multiple gen_disk objects to belong to the 
same elevator than for multiple elevators to belong to the same gen_disk 
no???
Anyways.... thanks for setting me straight ;-)
Lou
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.kernel.org
More majordomo info at  
http://vger.kernel.org/majordomo-info.html
Please read the FAQ at  
http://www.tux.org/lkml/