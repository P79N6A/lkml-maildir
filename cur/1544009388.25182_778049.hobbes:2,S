Date: Mon,  8 Dec 2008 11:49:21 +0900 (JST)
From: KOSAKI Motohiro <>
Subject: Re: [PATCH] vmscan: improve reclaim throuput to bail out patch take2
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2008/12/7/263

I think my last explain was too poor.
> If this improved the throughput of direct-reclaim callers then one
> would expect it to make larger improvements for kswapd (assuming 
> that all other things are equal for those tasks, which they are not).
> 
> What is your direct-reclaim to kswapd-reclaim ratio for that workload?
> (grep pgscan /proc/vmstat)
> 
because that benchmark is direct reclaim torturess workload.
/proc/vmstat changing was
<before>
pgscan_kswapd_dma 1152
pgscan_kswapd_normal 2400
pgscan_kswapd_movable 0
pgscan_direct_dma 32
pgscan_direct_normal 512
pgscan_direct_movable 0
<after>
pgscan_kswapd_dma 3520
pgscan_kswapd_normal 12160
pgscan_kswapd_movable 0
pgscan_direct_dma 10048
pgscan_direct_normal 31904
pgscan_direct_movable 0
	-> kswapd:direct = 1 : 3.4
Why I test non typical extreame woakload?
I have two reason.
1. nobody want to regression although workload isn't typical.
2. if the patch can scale performance although extreme case,
   of cource it also can works well on light weight workload.
if my patch have any regression, it definityly is valueless.
my patch only solve extreme case.
but I don't think it has.
> Does that patch make any change to the amount of CPU time which kswapd
> consumed?
I don't mesure it yet.
but at least, top coomand didn't find any consumption increasing.
> 
> Or you can not bother doing this work ;) The patch looks sensible
> anyway.  It's just that the numbers look whacky.