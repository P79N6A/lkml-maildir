Date: Sun, 20 Aug 2006 22:43:28 +0200
From: Willy Tarreau <>
Subject: Re: [PATCH 2.4.34-pre1] gcc4 fix for UP sparc64
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2006/8/20/183

On Sun, Aug 20, 2006 at 10:18:10PM +0200, Mikael Pettersson wrote:
> This patch fixes an invalid-lvalue error when compiling a
> 2.4.34-pre1 kernel on sparc64 with gcc-4.1.1. The kernel
> must be configured with CONFIG_SMP=n for the error to trigger.
It's a fact that I only checked with SMP.
> (I didn't save the error message, sorry.)
No problem, it's self explained.
> A kernel compiled with gcc-4.1.1 boots fine on my Ultra5
> and can rebuild itself, and generally seems no less solid
> than the 2.4.33 I compiled with gcc-3.4.6.
> 
> Signed-off-by: Mikael Pettersson <mikpe@it.uu.se>
Thanks Mikael,
I'm queueing it in my gcc4 tree.
Davem CC'd.
Willy
> --- linux-2.4.34-pre1/arch/sparc64/mm/init.c.~1~	2004-11-17 18:36:41.000000000 +0100
> +++ linux-2.4.34-pre1/arch/sparc64/mm/init.c	2006-08-20 20:52:20.000000000 +0200
> @@ -95,7 +95,7 @@ int do_check_pgt_cache(int low, int high
>                                  if (page2)
>                                          page2->next_hash = page->next_hash;
>                                  else
> -                                        (struct page *)pgd_quicklist = page->next_hash;
> +                                        pgd_quicklist = (unsigned long *)page->next_hash;
>                                  page->next_hash = NULL;
>                                  page->pprev_hash = NULL;
>                                  pgd_cache_size -= 2;
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.kernel.org
More majordomo info at  
http://vger.kernel.org/majordomo-info.html
Please read the FAQ at  
http://www.tux.org/lkml/