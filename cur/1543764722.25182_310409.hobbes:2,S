Date: Sun, 10 Apr 2005 14:12:03 +0200
From: <>
Subject: PROBLEM: kernel 2.4 pdc202xx and kernel 2.6 pdc202xx_old Broken
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2005/4/10/48

Hello
please put me in CC
I'm using a pdc20262 promise utra66 controller to manage 4 HD's, all 30GB
and I put them in a software /dev/md/0 raid5 configuration
recently I upgraded my kernel to linux-2.6.11-gentoo-r4 and also
linux-2.6.11-gentoo-r5
and the raid array would go offline with dma timeouts when putting load to
it
Apr  9 23:30:15 vennen hde: DMA timeout error
Apr  9 23:30:15 vennen hde: dma timeout error: status=0x58 { DriveReady
SeekComplete DataRequest }
Apr  9 23:30:15 vennen 
Apr  9 23:30:15 vennen ide: failed opcode was: unknown
Apr  9 23:30:15 vennen hdh: dma_timer_expiry: dma status == 0x62
Apr  9 23:30:15 vennen hdh: DMA timeout error
Apr  9 23:30:15 vennen hdh: dma timeout error: status=0x58 { DriveReady
SeekComplete DataRequest }
Apr  9 23:30:15 vennen 
Apr  9 23:30:15 vennen ide: failed opcode was: unknown
Apr  9 23:30:15 vennen hdg: status timeout: status=0xd0 { Busy }
Apr  9 23:30:15 vennen 
Apr  9 23:30:15 vennen ide: failed opcode was: unknown
Apr  9 23:30:15 vennen hdg: DMA disabled
Apr  9 23:30:15 vennen PDC202XX: Secondary channel reset.
Apr  9 23:30:15 vennen PDC202XX: Primary channel reset.
in the beginning it was only with hde, so I suspected the disk, put it on
another controller, run a complete diskcheck on it (maxtor dos tool), no
problems found.
I attach it to the onboard motherboard controller and put it back in the
raid array
but again the raid array would fail, this time another disk.
If I boot again, and reinitialize the array, so that it starts building
again, it would fail quite fast
when not putting any load on the array it would just run fine
since I had installed the whole system from scratch I didn't know the exact
version of the previous kernel, so I went back to linux-2.4.20-gentoo-r33,
an here everything works
I also remember trying some more recent 2.4 kernel, but I do not recall the
exact version, there the same problem would manifest.
after some googling I found this thread: PDC202XX_OLD broken
http://www.ussg.iu.edu/hypermail/linux/kernel/0412.0/1277.html
this is almost the exact same behaviour
but in the thread it does not say if his problem is solved or not
the suggestion of  Bartlomiej Zolnierkiewicz  is present in my 2.6 kernel
images
same info is at 
http://users.pandora.be/gemma.joram/pdc202xx/pdc202xx.html
I also have sysinfo
http://users.pandora.be/gemma.joram/pdc202xx/pdc202xx_sysinfo.html
and log 
http://users.pandora.be/gemma.joram/pdc202xx/pdc202xx_log.html
hope this is enough.
I'l happily try more if you need more info.
greetings
joram
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.kernel.org
More majordomo info at  
http://vger.kernel.org/majordomo-info.html
Please read the FAQ at  
http://www.tux.org/lkml/