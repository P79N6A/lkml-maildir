Date: Tue, 02 Jan 2001 09:50:48 -0500
From: Paul Gortmaker <>
Subject: Memory detection wrong on old 386 (2.4.x)
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2001/1/2/13

I booted up 2.4.0-prerel on an old 386sx (just to see what would
break) and  memory detection comes up almost 1MB short.
It is an old sx16 Olivetti (M300-05) with 5MB & a MDA card, and
it remaps some of the 640kB->1MB region to top of RAM.
2.2.18 reports:
Memory: 3988k/5408k available (760k kernel code, 
                 416k reserved, 216k data, 28k init)
which would indicate to me that it remaps 5408-5120=288kB.
But 2.4.0-prerel gives:
BIOS-provided physical RAM map:
 BIOS-88: 000000000009f000 @ 0000000000000000 (usable)
 BIOS-88: 0000000000350000 @ 0000000000100000 (usable)
On node 0 totalpages: 1104
zone(0): 1104 pages.
zone(1): 0 pages.
zone(2): 0 pages.
[...]
Memory: 2804k/4416k available (892k kernel code, 
        1224k reserved, 42k data, 36k init, 0k highmem)
Booting same kernel with mem=5408k and everything is fine:
BIOS-provided physical RAM map:
 BIOS-88: 000000000009f000 @ 0000000000000000 (usable)
 BIOS-88: 0000000000350000 @ 0000000000100000 (usable)
On node 0 totalpages: 1352
zone(0): 1352 pages.
zone(1): 0 pages.
zone(2): 0 pages.
[...]
Memory: 3780k/5408k available (892k kernel code, 
        1240k reserved, 42k data, 36k init, 0k highmem)
Output from /proc/driver/nvram (i.e. CMOS 0x15->0x18)
   DOS base memory: 640 kB
   Extended memory: 4416 kB (configured), 4416 kB (tested)
Not a big panic, as the machine is useless anyway, but I thought
I'd mention it regardless. 
<insert your favourite quote from Alan about BIOS writers here...>
Paul.
_________________________________________________________
Do You Yahoo!?
Get your free @yahoo.com address at 
http://mail.yahoo.com
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.kernel.org
Please read the FAQ at 
http://www.tux.org/lkml/