Date: Mon, 17 Dec 2007 19:02:05 +0100
From: Patrick McHardy <>
Subject: Re: "ip neigh show" not showing arp cache entries?
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/2007/12/17/224

Chris Friesen wrote:
> The original "ip" command and the new one ("/tmp/ip") both give the same 
> results--some of the entries are missing.
> 
> root@typhoon-base-unit0:/root> ip neigh show all
> 172.24.137.0 dev bond0  FAILED
> 172.24.0.9 dev bond0 lladdr 00:07:e9:41:4b:b4 REACHABLE
> 10.41.18.101 dev eth6 lladdr 00:0e:0c:5e:95:bd REACHABLE
> 172.24.0.11 dev bond0 lladdr 00:03:cc:51:06:5e STALE
> 172.24.132.1 dev bond0 lladdr 00:01:af:14:e9:88 REACHABLE
> 172.24.0.15 dev bond0 lladdr 00:0e:0c:85:fd:d2 STALE
> 172.24.0.3 dev bond0 lladdr 00:01:af:14:c8:cc REACHABLE
> 172.24.0.5 dev bond0 lladdr 00:01:af:15:e0:6a STALE
> 
> root@typhoon-base-unit0:/root> /tmp/ip neigh show all
> 172.24.137.0 dev bond0  FAILED
> 172.24.0.9 dev bond0 lladdr 00:07:e9:41:4b:b4 REACHABLE
> 10.41.18.101 dev eth6 lladdr 00:0e:0c:5e:95:bd REACHABLE
> 172.24.0.11 dev bond0 lladdr 00:03:cc:51:06:5e STALE
> 172.24.132.1 dev bond0 lladdr 00:01:af:14:e9:88 REACHABLE
> 172.24.0.15 dev bond0 lladdr 00:0e:0c:85:fd:d2 STALE
> 172.24.0.3 dev bond0 lladdr 00:01:af:14:c8:cc REACHABLE
> 172.24.0.5 dev bond0 lladdr 00:01:af:15:e0:6a STALE
> 
> 
> However, if I specifically try to print out one of the missing entries, 
> it shows up:
> 
> root@typhoon-base-unit0:/root> /tmp/ip neigh show 192.168.24.81
> 192.168.24.81 dev bond2 lladdr 00:01:af:14:e9:8a REACHABLE
 From a kernel perspective there are only complete dumps, the
filtering is done by iproute. So the fact that it shows them
when querying specifically implies there is a bug in the
iproute neighbour filter. Does it work if you omit "all"
from the ip neigh show command?