Date: Mon, 20 Dec 1999 15:12:40 +0000 (GMT)
From: Tim Waugh <>
Subject: SCSI modules bug? (was Re: BUG iomega parport)
Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
X-Lkml-Link: https://lkml.org/lkml/1999/12/20/52

I've been trying to figure out why ppa and imm both fail to initialise
with 2.3.32pre4+.  I've traced it this far:
scsi_register_module -> scsi_register_host -> scan_scsis ->
scan_scsis_single -> scsi_wait_cmd -> down
In scsi_wait_cmd, we call scsi_do_cmd.  To prevent reentrancy, we set
host->host_busy and device->device_busy, and then we call
scsi_insert_special_cmd, and then q->request_fn (which I think is
scsi_request_fn in this case).  Unfortunately, scsi_request_fn finds
host_busy (and device_busy) non-zero, and so it returns.
Is this intended behaviour?  Is something supposed to kick the queue?  Or
should reentrancy be avoided some other way?
Tim.
*/
-
To unsubscribe from this list: send the line "unsubscribe linux-kernel" in
the body of a message to majordomo@vger.rutgers.edu
Please read the FAQ at 
http://www.tux.org/lkml/